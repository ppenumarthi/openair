cscope 15 $HOME/openAir/rel_0.1_26.10.2014/openair-cn/NAS/EURECOM-NAS               0001726665
	@src/MMEprocess.c

47 
	~"comm⁄Def.h
"

48 
	~"«s_log.h
"

49 
	~"«s_timî.h
"

51 
	~"√tw‹k_≠i.h
"

52 
	~"«s_√tw‹k.h
"

53 
	~"«s_∑r£r.h
"

55 
	~<°dlib.h
>

56 
	~<pﬁl.h
>

57 
	~<°rög.h
>

58 
	~<sig«l.h
>

59 
	~<±hªad.h
>

69 
	#NAS_SLEEP_TIMEOUT
 1000

	)

71 *
_«s_√tw‹k_mngr
(*);

73 
_«s_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)());

74 
	`_«s_sig«l_h™dÀr
(
sig«l
);

76 
	`_«s_˛ón
(
√t_fd
);

83 
	$maö
(
¨gc
, c⁄° *
¨gv
[])

88 i‡(
	`«s_∑r£r_gë_›ti⁄s
 (
¨gc
, 
¨gv
Ë!
RETURNok
) {

89 
	`«s_∑r£r_¥öt_ußge
 (
FIRMWARE_VERSION
);

90 
	`exô
 (
EXIT_FAILURE
);

96 
	`«s_log_öô
 (
	`«s_∑r£r_gë_åa˚_Àvñ
 ());

98 c⁄° *
nho°
 = 
	`«s_∑r£r_gë_√tw‹k_ho°
 ();

99 c⁄° *
≈‹t
 = 
	`«s_∑r£r_gë_√tw‹k_p‹t
 ();

101 
	`LOG_TRACE
 (
INFO
, "MME-MAIN - %†-nho° %†-≈‹à%†-åa˚ 0x%x", 
¨gv
[0],

102 
nho°
, 
≈‹t
,

103 
	`«s_∑r£r_gë_åa˚_Àvñ
 ());

108 i‡(
	`√tw‹k_≠i_öôülize
 (
nho°
, 
≈‹t
Ë!
RETURNok
) {

109 
	`LOG_TRACE
 (
ERROR
, "MME-MAIN -Çetwork_api_initialize() failed");

110 
	`exô
 (
EXIT_FAILURE
);

112 
√tw‹k_fd
 = 
	`√tw‹k_≠i_gë_fd
 ();

117 
	`«s_√tw‹k_öôülize
 ();

122 
	`«s_timî_öô
 ();

127 (Ë
	`_«s_£t_sig«l_h™dÀr
 (
SIGINT
, 
_«s_sig«l_h™dÀr
);

128 (Ë
	`_«s_£t_sig«l_h™dÀr
 (
SIGTERM
, 
_«s_sig«l_h™dÀr
);

130 
±hªad_©å_t
 
©å
;

131 
	`±hªad_©å_öô
 (&
©å
);

132 
	`±hªad_©å_£tsc›e
 (&
©å
, 
PTHREAD_SCOPE_SYSTEM
);

133 
	`±hªad_©å_£tdëach°©e
 (&
©å
, 
PTHREAD_CREATE_DETACHED
);

138 
±hªad_t
 
√tw‹k_mngr
;

139 i‡(
	`±hªad_¸óã
 (&
√tw‹k_mngr
, &
©å
, 
_«s_√tw‹k_mngr
,

140 &
√tw‹k_fd
) != 0) {

141 
	`LOG_TRACE
 (
ERROR
, "MME-MAIN - "

143 
	`√tw‹k_≠i_˛o£
 (
√tw‹k_fd
);

144 
	`exô
 (
EXIT_FAILURE
);

146 
	`±hªad_©å_de°roy
 (&
©å
);

152 
√tw‹k_fd
 != -1) {

153 
	`pﬁl
 (
NULL
, 0, 
NAS_SLEEP_TIMEOUT
);

154 
√tw‹k_fd
 = 
	`√tw‹k_≠i_gë_fd
 ();

158 
	`_«s_˛ón
 (
√tw‹k_fd
);

160 
LOG_TRACE


161 (
WARNING
, "MME-MAIN - NAS mainÖrocessÉxited");

162 
	}
}

183 *
	$_«s_√tw‹k_mngr
(*
¨gs
)

185 
LOG_FUNC_IN
;

187 
ªt_code
;

188 
√tw‹k_mesßge_id
;

189 
byãs
;

191 *
fd
 = (*Ë
¨gs
;

193 
	`LOG_TRACE
 (
INFO
, "MME-MAIN - Nëw‹k c⁄√˘i⁄ m™agî sèπed (%d)", *
fd
);

196 
TRUE
) {

198 
byãs
 = 
	`√tw‹k_≠i_ªad_d©a
 (*
fd
);

199 i‡(
byãs
 =
RETURNîr‹
) {

202 
	`LOG_TRACE
 (
ERROR
, "MME-MAIN - "

207 i‡(
byãs
 == 0) {

213 
√tw‹k_mesßge_id
 = 
	`√tw‹k_≠i_decode_d©a
 (
byãs
);

214 i‡(
√tw‹k_mesßge_id
 =
RETURNîr‹
) {

220 
ªt_code
 = 
	`«s_√tw‹k_¥o˚ss_d©a
 (
√tw‹k_mesßge_id
,

221 
	`√tw‹k_≠i_gë_d©a
 ());

222 i‡(
ªt_code
 !
RETURNok
) {

225 
LOG_TRACE


226 (
WARNING
, "MME-MAIN - "

228 
√tw‹k_mesßge_id
);

232  
	`LOG_TRACE
 (
WARNING
,

236 
	`LOG_FUNC_RETURN
(
NULL
);

237 
	}
}

253 
_«s_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)())

255 
LOG_FUNC_IN
;

257 
siga˘i⁄
 
a˘
;

260 (Ë
	`mem£t
 (&
a˘
, 0, (act));

261 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

262 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

263 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

264 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

265 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

266 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

267 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

268 #i‚de‡
LINUX


269 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

271 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

272 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

273 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

274 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

277 
a˘
.
ß_h™dÀr
 = 
h™dÀr
;

278 i‡(
	`siga˘i⁄
 (
sig«l
, &
a˘
, 0) < 0) {

279  
RETURNîr‹
;

282 
	`LOG_TRACE
 (
INFO
, "MME-MAIN - H™dÀ∏suc˚ssfuŒy së f‹ sig«»%d", 
sig«l
);

284 
	`LOG_FUNC_RETURN
(
RETURNok
);

285 
	}
}

300 
	$_«s_sig«l_h™dÀr
(
sig«l
)

302 
LOG_FUNC_IN
;

304 
	`LOG_TRACE
 (
WARNING
, "MME-MAIN - Sig«»%dÑe˚ived", 
sig«l
);

305 
	`_«s_˛ón
 (
	`√tw‹k_≠i_gë_fd
 ());

306 
	`exô
 (
EXIT_SUCCESS
);

308 
LOG_FUNC_OUT


310 
	}
}

325 
	$_«s_˛ón
(
√t_fd
)

327 
LOG_FUNC_IN
;

329 
	`LOG_TRACE
 (
INFO
, "MME-MAIN - Perform EMMánd ESM cleanup");

330 
	`«s_√tw‹k_˛ónup
 ();

332 
	`LOG_TRACE
 (
INFO
, "MME-MAIN - ClosögÇëw‹k c⁄√˘i⁄ %d", 
√t_fd
);

333 
	`√tw‹k_≠i_˛o£
 (
√t_fd
);

335 
LOG_FUNC_OUT


337 
	}
}

	@src/UEprocess.c

47 
	~"comm⁄Def.h
"

48 
	~"«s_log.h
"

49 
	~"«s_timî.h
"

51 
	~"u£r_≠i.h
"

52 
	~"√tw‹k_≠i.h
"

53 
	~"«s_u£r.h
"

54 
	~"«s_√tw‹k.h
"

55 
	~"«s_∑r£r.h
"

57 
	~<°dlib.h
>

58 
	~<pﬁl.h
>

59 
	~<°rög.h
>

60 
	~<sig«l.h
>

61 
	~<±hªad.h
>

71 
	#NAS_SLEEP_TIMEOUT
 1000

	)

73 *
_«s_u£r_mngr
(*);

74 *
_«s_√tw‹k_mngr
(*);

76 
_«s_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)());

77 
	`_«s_sig«l_h™dÀr
(
sig«l
);

79 
	`_«s_˛ón
(
u§_fd
, 
√t_fd
);

86 
	$maö
(
¨gc
, c⁄° *
¨gv
[])

91 i‡(
	`«s_∑r£r_gë_›ti⁄s
 (
¨gc
, 
¨gv
Ë!
RETURNok
) {

92 
	`«s_∑r£r_¥öt_ußge
 (
FIRMWARE_VERSION
);

93 
	`exô
 (
EXIT_FAILURE
);

99 
	`«s_log_öô
 (
	`«s_∑r£r_gë_åa˚_Àvñ
 ());

101 c⁄° *
uho°
 = 
	`«s_∑r£r_gë_u£r_ho°
 ();

102 c⁄° *
up‹t
 = 
	`«s_∑r£r_gë_u£r_p‹t
 ();

103 c⁄° *
dev∑th
 = 
	`«s_∑r£r_gë_devi˚_∑th
 ();

104 c⁄° *
dev∑øms
 = 
	`«s_∑r£r_gë_devi˚_∑øms
 ();

105 c⁄° *
nho°
 = 
	`«s_∑r£r_gë_√tw‹k_ho°
 ();

106 c⁄° *
≈‹t
 = 
	`«s_∑r£r_gë_√tw‹k_p‹t
 ();

108 
	`LOG_TRACE
 (
INFO
,

110 
¨gv
[0], 
	`«s_∑r£r_gë_ueid
 (), 
uho°
, 
up‹t
, 
nho°
, 
≈‹t
, 
dev∑th
, 
dev∑øms
,

111 
	`«s_∑r£r_gë_åa˚_Àvñ
 ());

116 i‡(
	`u£r_≠i_öôülize
 (
uho°
, 
up‹t
, 
dev∑th
, 
dev∑øms
Ë!
RETURNok
) {

117 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - user_api_initialize() failed");

118 
	`exô
 (
EXIT_FAILURE
);

120 
u£r_fd
 = 
	`u£r_≠i_gë_fd
 ();

125 i‡(
	`√tw‹k_≠i_öôülize
 (
nho°
, 
≈‹t
Ë!
RETURNok
) {

126 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN -Çetwork_api_initialize() failed");

127 
	`u£r_≠i_˛o£
 (
u£r_fd
);

128 
	`exô
 (
EXIT_FAILURE
);

130 
√tw‹k_fd
 = 
	`√tw‹k_≠i_gë_fd
 ();

135 
	`«s_u£r_öôülize
 (&
u£r_≠i_emm_ˇŒback
, &
u£r_≠i_esm_ˇŒback
,

136 
FIRMWARE_VERSION
);

137 
	`«s_√tw‹k_öôülize
 ();

142 
	`«s_timî_öô
 ();

147 (Ë
	`_«s_£t_sig«l_h™dÀr
 (
SIGINT
, 
_«s_sig«l_h™dÀr
);

148 (Ë
	`_«s_£t_sig«l_h™dÀr
 (
SIGTERM
, 
_«s_sig«l_h™dÀr
);

150 
±hªad_©å_t
 
©å
;

151 
	`±hªad_©å_öô
 (&
©å
);

152 
	`±hªad_©å_£tsc›e
 (&
©å
, 
PTHREAD_SCOPE_SYSTEM
);

153 
	`±hªad_©å_£tdëach°©e
 (&
©å
, 
PTHREAD_CREATE_DETACHED
);

158 
±hªad_t
 
u£r_mngr
;

159 i‡(
	`±hªad_¸óã
 (&
u£r_mngr
, &
©å
, 
_«s_u£r_mngr
, &
u£r_fd
) != 0) {

160 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

162 
	`u£r_≠i_˛o£
 (
u£r_fd
);

163 
	`√tw‹k_≠i_˛o£
 (
√tw‹k_fd
);

164 
	`exô
 (
EXIT_FAILURE
);

170 
±hªad_t
 
√tw‹k_mngr
;

171 i‡(
	`±hªad_¸óã
 (&
√tw‹k_mngr
, &
©å
, 
_«s_√tw‹k_mngr
,

172 &
√tw‹k_fd
) != 0) {

173 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

175 
	`u£r_≠i_˛o£
 (
u£r_fd
);

176 
	`√tw‹k_≠i_˛o£
 (
√tw‹k_fd
);

177 
	`exô
 (
EXIT_FAILURE
);

179 
	`±hªad_©å_de°roy
 (&
©å
);

185 (
u£r_fd
 !-1Ë&& (
√tw‹k_fd
 != -1)) {

186 
	`pﬁl
 (
NULL
, 0, 
NAS_SLEEP_TIMEOUT
);

187 
u£r_fd
 = 
	`u£r_≠i_gë_fd
 ();

188 
√tw‹k_fd
 = 
	`√tw‹k_≠i_gë_fd
 ();

192 
	`_«s_˛ón
 (
u£r_fd
, 
√tw‹k_fd
);

194 
LOG_TRACE


195 (
WARNING
, "UE-MAIN - NAS mainÖrocessÉxited");

196 
	}
}

217 *
	$_«s_u£r_mngr
(*
¨gs
)

219 
LOG_FUNC_IN
;

221 
exô_lo›
 = 
FALSE
;

223 *
fd
 = (*Ë
¨gs
;

225 
	`LOG_TRACE
 (
INFO
, "UE-MAIN - U£∏c⁄√˘i⁄ m™agî sèπed (%d)", *
fd
);

228 !
exô_lo›
) {

229 
exô_lo›
 = 
	`«s_u£r_ª˚ive_™d_¥o˚ss
(
fd
, 
NULL
);

233 
	`u£r_≠i_˛o£
 (*
fd
);

234 
	`LOG_TRACE
 (
WARNING
, "UE-MAIN - "

237 
	`LOG_FUNC_RETURN
(
NULL
);

238 
	}
}

255 *
	$_«s_√tw‹k_mngr
(*
¨gs
)

257 
LOG_FUNC_IN
;

259 
ªt_code
;

260 
√tw‹k_mesßge_id
;

261 
byãs
;

263 *
fd
 = (*Ë
¨gs
;

265 
	`LOG_TRACE
 (
INFO
, "UE-MAIN - Nëw‹k c⁄√˘i⁄ m™agî sèπed (%d)", *
fd
);

268 
TRUE
) {

270 
byãs
 = 
	`√tw‹k_≠i_ªad_d©a
 (*
fd
);

271 i‡(
byãs
 =
RETURNîr‹
) {

274 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

279 i‡(
byãs
 == 0) {

285 
√tw‹k_mesßge_id
 = 
	`√tw‹k_≠i_decode_d©a
 (
byãs
);

286 i‡(
√tw‹k_mesßge_id
 =
RETURNîr‹
) {

292 
ªt_code
 = 
	`«s_√tw‹k_¥o˚ss_d©a
 (
√tw‹k_mesßge_id
,

293 
	`√tw‹k_≠i_gë_d©a
 ());

294 i‡(
ªt_code
 !
RETURNok
) {

297 
LOG_TRACE


298 (
WARNING
, "UE-MAIN - "

300 
√tw‹k_mesßge_id
);

305 
	`√tw‹k_≠i_˛o£
 (*
fd
);

306 
	`LOG_TRACE
 (
WARNING
, "UE-MAIN - "

309 
	`LOG_FUNC_RETURN
(
NULL
);

310 
	}
}

326 
_«s_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)())

328 
LOG_FUNC_IN
;

330 
siga˘i⁄
 
a˘
;

333 (Ë
	`mem£t
 (&
a˘
, 0, (act));

334 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

335 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

336 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

337 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

338 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

339 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

340 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

341 #i‚de‡
LINUX


342 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

344 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

345 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

346 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

347 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

350 
a˘
.
ß_h™dÀr
 = 
h™dÀr
;

351 i‡(
	`siga˘i⁄
 (
sig«l
, &
a˘
, 0) < 0) {

352  
RETURNîr‹
;

355 
	`LOG_TRACE
 (
INFO
, "UE-MAIN - H™dÀ∏suc˚ssfuŒy së f‹ sig«»%d", 
sig«l
);

357 
	`LOG_FUNC_RETURN
(
RETURNok
);

358 
	}
}

373 
	$_«s_sig«l_h™dÀr
(
sig«l
)

375 
LOG_FUNC_IN
;

377 
	`LOG_TRACE
 (
WARNING
, "UE-MAIN - Sig«»%dÑe˚ived", 
sig«l
);

378 
	`_«s_˛ón
 (
	`u£r_≠i_gë_fd
 (), 
	`√tw‹k_≠i_gë_fd
 ());

379 
	`exô
 (
EXIT_SUCCESS
);

381 
LOG_FUNC_OUT


383 
	}
}

399 
	$_«s_˛ón
(
u§_fd
, 
√t_fd
)

401 
LOG_FUNC_IN
;

403 
	`LOG_TRACE
 (
INFO
, "UE-MAIN - Perform EMMánd ESM cleanup");

404 
	`«s_√tw‹k_˛ónup
 ();

406 
	`LOG_TRACE
 (
INFO
, "UE-MAIN - "

408 
u§_fd
, 
√t_fd
);

409 
	`u£r_≠i_˛o£
 (
u§_fd
);

410 
	`√tw‹k_≠i_˛o£
 (
√t_fd
);

412 
LOG_FUNC_OUT


414 
	}
}

	@src/api/mme/mme_api.c

47 #ifde‡
NAS_MME


49 
	~"mme_≠i.h
"

50 
	~"«s_log.h
"

51 
	~"as£πi⁄s.h
"

53 
	~<°rög.h
>

64 
	#MME_API_PDN_MAX
 10

	)

67 
	#MME_API_MME_GID
 0x0102

	)

70 
	#MME_API_MME_CODE
 0x12

	)

73 c⁄° 
O˘ëSåög
 
	gmme_≠i_deÁu…_≠n
 = {

76 15, (
uöt8_t
 *)("\x0e" "www.eurecom.fr")

78 35, (
uöt8_t
 *)("\x08" "internet"

88 c⁄° 
O˘ëSåög
 
	gmme_≠i_emîgícy_≠n
 = {

89 19, (
uöt8_t
 *)("\x12" "www.eurecom_sos.fr")

93 c⁄° 
∂mn_t
 
	gmme_≠i_∂mn
 = {0, 2, 0xf, 8, 0, 1};

96 
	#MME_API_NB_TACS
 4

	)

98 
	#MME_API_FIRST_TAC
 0x0001

	)

102 c⁄° 
UI¡8_t
 
	g_mme_≠i_ønd
[
AUTH_RAND_SIZE
] = {

108 c⁄° 
UI¡8_t
 
	g_mme_≠i_auä
[
AUTH_AUTN_SIZE
] = {

114 c⁄° 
UI¡8_t
 
	g_mme_≠i_xªs
[
AUTH_XRES_SIZE
] = {

119 
mme_≠i_ù_vîsi⁄_t
 
	g_mme_≠i_ù_ˇ∑bûôy
 = 
MME_API_IPV4V6_ADDR
;

122 
uöt8_t
 
	g_mme_≠i_ùv4_addr
[
MME_API_PDN_MAX
][4] = {

135 
uöt8_t
 
	g_mme_≠i_ùv6_addr
[
MME_API_PDN_MAX
][8] = {

158 
uöt8_t
 
	g_mme_≠i_ùv4v6_addr
[
MME_API_PDN_MAX
][12] = {

180 c⁄° 
O˘ëSåög
 
	g_mme_≠i_pdn_addr
[
MME_API_ADDR_MAX
][
MME_API_PDN_MAX
] = {

182 {4, 
_mme_≠i_ùv4_addr
[0]},

183 {4, 
_mme_≠i_ùv4_addr
[1]},

184 {4, 
_mme_≠i_ùv4_addr
[2]},

185 {4, 
_mme_≠i_ùv4_addr
[3]},

186 {4, 
_mme_≠i_ùv4_addr
[4]},

187 {4, 
_mme_≠i_ùv4_addr
[5]},

188 {4, 
_mme_≠i_ùv4_addr
[6]},

189 {4, 
_mme_≠i_ùv4_addr
[7]},

190 {4, 
_mme_≠i_ùv4_addr
[8]},

191 {4, 
_mme_≠i_ùv4_addr
[9]},

194 {8, 
_mme_≠i_ùv6_addr
[0]},

195 {8, 
_mme_≠i_ùv6_addr
[1]},

196 {8, 
_mme_≠i_ùv6_addr
[2]},

197 {8, 
_mme_≠i_ùv6_addr
[3]},

198 {8, 
_mme_≠i_ùv6_addr
[4]},

199 {8, 
_mme_≠i_ùv6_addr
[5]},

200 {8, 
_mme_≠i_ùv6_addr
[6]},

201 {8, 
_mme_≠i_ùv6_addr
[7]},

202 {8, 
_mme_≠i_ùv6_addr
[8]},

203 {8, 
_mme_≠i_ùv6_addr
[9]},

206 {12, 
_mme_≠i_ùv4v6_addr
[0]},

207 {12, 
_mme_≠i_ùv4v6_addr
[1]},

208 {12, 
_mme_≠i_ùv4v6_addr
[2]},

209 {12, 
_mme_≠i_ùv4v6_addr
[3]},

210 {12, 
_mme_≠i_ùv4v6_addr
[4]},

211 {12, 
_mme_≠i_ùv4v6_addr
[5]},

212 {12, 
_mme_≠i_ùv4v6_addr
[6]},

213 {12, 
_mme_≠i_ùv4v6_addr
[7]},

214 {12, 
_mme_≠i_ùv4v6_addr
[8]},

215 {12, 
_mme_≠i_ùv4v6_addr
[9]},

220 
	#MME_API_QCI
 3

	)

223 
	#MME_API_BIT_RATE_64K
 0x40

	)

224 
	#MME_API_BIT_RATE_128K
 0x48

	)

225 
	#MME_API_BIT_RATE_512K
 0x78

	)

226 
	#MME_API_BIT_RATE_1024K
 0x87

	)

229 
	g_mme_≠i_pdn_id
 = 0;

254 #i‡
deföed
(
EPC_BUILD
)

255 
	$mme_≠i_gë_emm_c⁄fig
(
mme_≠i_emm_c⁄fig_t
 *
c⁄fig
,

256 
mme_c⁄fig_t
 *
mme_c⁄fig_p
)

258 
	$mme_≠i_gë_emm_c⁄fig
(
mme_≠i_emm_c⁄fig_t
 *
c⁄fig
)

261 #i‡
	`deföed
(
EPC_BUILD
)

262 
i
;

264 
LOG_FUNC_IN
;

265 
	`As£πF©Æ
(
mme_c⁄fig_p
->
gummei
.
nb_∂mns
 >= 1, "No PLMN configured");

266 
	`As£πF©Æ
(
mme_c⁄fig_p
->
gummei
.
nb_mmec
 >= 1, "No MME Code configured");

267 
	`As£πF©Æ
(
mme_c⁄fig_p
->
gummei
.
nb_mme_gid
 >= 1, "No MME Group ID configured");

269 
c⁄fig
->
gummei
.
∂mn
.
MCCdigô1
 = (
mme_c⁄fig_p
->gummei.
∂mn_mcc
[0]/100)%10;

270 
c⁄fig
->
gummei
.
∂mn
.
MCCdigô2
 = (
mme_c⁄fig_p
->gummei.
∂mn_mcc
[0]/10)%10;

271 
c⁄fig
->
gummei
.
∂mn
.
MCCdigô3
 = 
mme_c⁄fig_p
->gummei.
∂mn_mcc
[0]%10;

272 i‡(
mme_c⁄fig_p
->
gummei
.
∂mn_mnc_Àn
[0] == 2) {

273 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô1
 = (
mme_c⁄fig_p
->gummei.
∂mn_mnc
[0]/10)%10;

274 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô2
 = 
mme_c⁄fig_p
->gummei.
∂mn_mnc
[0]%10;

275 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô3
 = 0xf;

276 } i‡(
mme_c⁄fig_p
->
gummei
.
∂mn_mnc_Àn
[0] == 3) {

277 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô1
 = (
mme_c⁄fig_p
->gummei.
∂mn_mnc
[0]/100)%10;

278 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô2
 = (
mme_c⁄fig_p
->gummei.
∂mn_mnc
[0]/10)%10;

279 
c⁄fig
->
gummei
.
∂mn
.
MNCdigô3
 = 
mme_c⁄fig_p
->gummei.
∂mn_mnc
[0]%10;

281 
	`As£πF©Æ
((
mme_c⁄fig_p
->
gummei
.
∂mn_mnc_Àn
[0] >= 2) &&

282 (
mme_c⁄fig_p
->
gummei
.
∂mn_mnc_Àn
[0] <= 3), "BAD MNCÜength for GUMMEI");

284 
c⁄fig
->
gummei
.
MMEgid
 = 
mme_c⁄fig_p
->gummei.
mme_gid
[0];

285 
c⁄fig
->
gummei
.
MMEcode
 = 
mme_c⁄fig_p
->gummei.
mmec
[0];

286 #i‡
	`deföed
(
EPC_BUILD
)

288 i‡(
mme_c⁄fig_p
->
emîgícy_©èch_suµ‹ãd
 != 0) {

289 
c⁄fig
->
„©uªs
 |
MME_API_EMERGENCY_ATTACH
;

291 i‡(
mme_c⁄fig_p
->
u«uthítiˇãd_imsi_suµ‹ãd
 != 0) {

292 
c⁄fig
->
„©uªs
 |
MME_API_UNAUTHENTICATED_IMSI
;

294 
i
 = 0 ; i < 8; i++) {

295 
c⁄fig
->
¥e„ªd_öãgrôy_Æg‹ôhm
[
i
] = 
mme_c⁄fig_p
->
«s_c⁄fig
.prefered_integrity_algorithm[i];

296 
c⁄fig
->
¥e„ªd_cùhîög_Æg‹ôhm
[
i
] = 
mme_c⁄fig_p
->
«s_c⁄fig
.prefered_ciphering_algorithm[i];

299 
c⁄fig
->
„©uªs
 = 
MME_API_EMERGENCY_ATTACH
 | 
MME_API_UNAUTHENTICATED_IMSI
;

302 
	`LOG_FUNC_RETURN
 (
RETURNok
);

303 
	}
}

320 
	$mme_≠i_gë_esm_c⁄fig
(
mme_≠i_esm_c⁄fig_t
 *
c⁄fig
)

322 
LOG_FUNC_IN
;

324 i‡(
_mme_≠i_ù_ˇ∑bûôy
 =
MME_API_IPV4_ADDR
) {

325 
c⁄fig
->
„©uªs
 = 
MME_API_IPV4
;

326 } i‡(
_mme_≠i_ù_ˇ∑bûôy
 =
MME_API_IPV6_ADDR
) {

327 
c⁄fig
->
„©uªs
 = 
MME_API_IPV6
;

328 } i‡(
_mme_≠i_ù_ˇ∑bûôy
 =
MME_API_IPV4V6_ADDR
) {

329 
c⁄fig
->
„©uªs
 = 
MME_API_IPV4
 | 
MME_API_IPV6
;

331 
c⁄fig
->
„©uªs
 = 0;

334 
	`LOG_FUNC_RETURN
 (
RETURNok
);

335 
	}
}

355 
	$mme_≠i_idítify_guti
(c⁄° 
GUTI_t
 *
guti
, 
auth_ve˘‹_t
 *
ve˘‹
)

357 
rc
 = 
RETURNîr‹
;

359 
LOG_FUNC_IN
;

361 
	`LOG_FUNC_RETURN
(
rc
);

362 
	}
}

382 
	$mme_≠i_idítify_imsi
(c⁄° 
imsi_t
 *
imsi
, 
auth_ve˘‹_t
 *
ve˘‹
)

384 
rc
 = 
RETURNok
;

386 
LOG_FUNC_IN
;

387 
	`As£πF©Æ
(0, "Hardcoded values");

389 
	`mem˝y
(
ve˘‹
->
ønd
, 
_mme_≠i_ønd
, 
AUTH_RAND_SIZE
);

390 
	`mem˝y
(
ve˘‹
->
auä
, 
_mme_≠i_auä
, 
AUTH_AUTN_SIZE
);

391 
	`mem˝y
(
ve˘‹
->
xªs
, 
_mme_≠i_xªs
, 
AUTH_XRES_SIZE
);

393 
	`LOG_FUNC_RETURN
(
rc
);

394 
	}
}

414 
	$mme_≠i_idítify_imei
(c⁄° 
imei_t
 *
imei
, 
auth_ve˘‹_t
 *
ve˘‹
)

416 
rc
 = 
RETURNîr‹
;

418 
LOG_FUNC_IN
;

420 
	`LOG_FUNC_RETURN
(
rc
);

421 
	}
}

445 
	$mme_≠i_√w_guti
(c⁄° 
imsi_t
 *
imsi
, 
GUTI_t
 *
guti
, 
èc_t
 *
èc
, *
n_ècs
)

447 
rc
 = 
RETURNok
;

449 
tmsi
 = 1;

451 
LOG_FUNC_IN
;

452 
	`As£πF©Æ
(0, "Hardcoded values");

454 
guti
->
gummei
.
∂mn
 = 
mme_≠i_∂mn
;

455 
guti
->
gummei
.
MMEgid
 = 
MME_API_MME_GID
;

456 
guti
->
gummei
.
MMEcode
 = 
MME_API_MME_CODE
;

457 
guti
->
m_tmsi
 = 
tmsi
++;

459 *
èc
 = 
MME_API_FIRST_TAC
;

460 *
n_ècs
 = 
MME_API_NB_TACS
;

462 
	`LOG_FUNC_RETURN
(
rc
);

463 
	}
}

491 
	$mme_≠i_subs¸ibe
(
O˘ëSåög
 *
≠n
, 
mme_≠i_ù_vîsi⁄_t
 
mme_pdn_ödex
, O˘ëSåög *
pdn_addr
,

492 
is_emîgícy
, 
mme_≠i_qos_t
 *
qos
)

494 
rc
 = 
RETURNok
;

496 
LOG_FUNC_IN
;

498 i‡–
≠n
 && (≠n->
Àngth
 == 0) ) {

500 i‡(
is_emîgícy
) {

501 
≠n
->
Àngth
 = 
mme_≠i_emîgícy_≠n
.length;

502 
≠n
->
vÆue
 = 
mme_≠i_emîgícy_≠n
.value;

504 
≠n
->
Àngth
 = 
mme_≠i_deÁu…_≠n
.length;

505 
≠n
->
vÆue
 = 
mme_≠i_deÁu…_≠n
.value;

510 i‡–
pdn_addr
 && (
_mme_≠i_pdn_id
 < 
MME_API_PDN_MAX
) ) {

511 
pdn_addr
->
Àngth
 =

512 
_mme_≠i_pdn_addr
[
mme_pdn_ödex
][
_mme_≠i_pdn_id
].
Àngth
;

513 
pdn_addr
->
vÆue
 =

514 
_mme_≠i_pdn_addr
[
mme_pdn_ödex
][
_mme_≠i_pdn_id
].
vÆue
;

516 
_mme_≠i_pdn_id
 += 1;

519 
rc
 = 
RETURNîr‹
;

523 i‡(
qos
) {

524 
qos
->
qci
 = 
MME_API_QCI
;

526 
qos
->
gbr
[
MME_API_UPLINK
] = 
MME_API_BIT_RATE_64K
;

527 
qos
->
mbr
[
MME_API_UPLINK
] = 
MME_API_BIT_RATE_128K
;

529 
qos
->
gbr
[
MME_API_DOWNLINK
] = 
MME_API_BIT_RATE_512K
;

530 
qos
->
mbr
[
MME_API_DOWNLINK
] = 
MME_API_BIT_RATE_1024K
;

532 
rc
 = 
RETURNîr‹
;

535 
	`LOG_FUNC_RETURN
(
rc
);

536 
	}
}

554 
	$mme_≠i_unsubs¸ibe
(
O˘ëSåög
 *
≠n
)

556 
LOG_FUNC_IN
;

558 
rc
 = 
RETURNok
;

561 
_mme_≠i_pdn_id
 -= 1;

563 
	`LOG_FUNC_RETURN
(
rc
);

564 
	}
}

	@src/api/mme/mme_api.h

46 #i‚de‡
__MME_API_H__


47 
	#__MME_API_H__


	)

49 #ifde‡
NAS_MME


50 #i‡
deföed
(
EPC_BUILD
)

51 
	~"mme_c⁄fig.h
"

53 
	~"comm⁄Def.h
"

54 
	~"£curôyDef.h
"

55 
	~"O˘ëSåög.h
"

63 
	#MME_API_NB_UE_MAX
 1

	)

65 #ifde‡
NAS_MME


68 
	emme_≠i_„©uª_s
 {

69 
	mMME_API_NO_FEATURE_SUPPORTED
 = 0,

70 
	mMME_API_EMERGENCY_ATTACH
 = (1<<0),

71 
	mMME_API_UNAUTHENTICATED_IMSI
 = (1<<1),

72 
	mMME_API_IPV4
 = (1<<2),

73 
	mMME_API_IPV6
 = (1<<3),

74 
	mMME_API_SINGLE_ADDR_BEARERS
 = (1<<4),

75 } 
	tmme_≠i_„©uª_t
;

78 
	emme_≠i_ù_vîsi⁄_e
 {

79 
	mMME_API_IPV4_ADDR
,

80 
	mMME_API_IPV6_ADDR
,

81 
	mMME_API_IPV4V6_ADDR
,

82 
	mMME_API_ADDR_MAX


83 } 
	tmme_≠i_ù_vîsi⁄_t
;

89 
	smme_≠i_emm_c⁄fig_s
 {

90 
mme_≠i_„©uª_t
 
	m„©uªs
;

91 
gummei_t
 
	mgummei
;

92 
uöt8_t
 
	m¥e„ªd_öãgrôy_Æg‹ôhm
[8];

93 
uöt8_t
 
	m¥e„ªd_cùhîög_Æg‹ôhm
[8];

94 } 
	tmme_≠i_emm_c⁄fig_t
;

100 
	smme_≠i_esm_c⁄fig_s
 {

101 
mme_≠i_„©uª_t
 
	m„©uªs
;

102 } 
	tmme_≠i_esm_c⁄fig_t
;

109 
	smme_≠i_qos_s
 {

110 
	#MME_API_UPLINK
 0

	)

111 
	#MME_API_DOWNLINK
 1

	)

112 
	#MME_API_DIRECTION
 2

	)

113 
	mgbr
[
MME_API_DIRECTION
];

114 
	mmbr
[
MME_API_DIRECTION
];

115 
	mqci
;

116 } 
	tmme_≠i_qos_t
;

119 
	smme_≠i_t·_s
 {

120 } 
	gmme_≠i_t·_t
;

130 #i‡
deföed
(
EPC_BUILD
)

131 
mme_≠i_gë_emm_c⁄fig
(
mme_≠i_emm_c⁄fig_t
 *
c⁄fig
,

132 
mme_c⁄fig_t
 *
mme_c⁄fig_p
);

134 
mme_≠i_gë_emm_c⁄fig
(
mme_≠i_emm_c⁄fig_t
 *
c⁄fig
);

136 
mme_≠i_gë_esm_c⁄fig
(
mme_≠i_esm_c⁄fig_t
 *
c⁄fig
);

138 
mme_≠i_idítify_guti
(c⁄° 
GUTI_t
 *
guti
, 
auth_ve˘‹_t
 *
ve˘‹
);

139 
mme_≠i_idítify_imsi
(c⁄° 
imsi_t
 *
imsi
, 
auth_ve˘‹_t
 *
ve˘‹
);

140 
mme_≠i_idítify_imei
(c⁄° 
imei_t
 *
imei
, 
auth_ve˘‹_t
 *
ve˘‹
);

141 
mme_≠i_√w_guti
(c⁄° 
imsi_t
 *
imsi
, 
GUTI_t
 *
guti
, 
èc_t
 *
èc
, *
n_ècs
);

143 
mme_≠i_subs¸ibe
(
O˘ëSåög
 *
≠n
, 
mme_≠i_ù_vîsi⁄_t
 
mme_pdn_ödex
, O˘ëSåög *
pdn_addr
,

144 
is_emîgícy
, 
mme_≠i_qos_t
 *
qos
);

145 
mme_≠i_unsubs¸ibe
(
O˘ëSåög
 *
≠n
);

	@src/api/network/as_message.c

49 
	~"as_mesßge.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~<°rög.h
>

54 
	~<°dlib.h
>

86 
	$as_mesßge_decode
(c⁄° * 
buf„r
, 
as_mesßge_t
* 
msg
, 
Àngth
)

88 
LOG_FUNC_IN
;

90 
byãs
;

91 
Byã_t
** 
d©a
 = 
NULL
;

94 
msg
->
msgID
 = *(
UI¡16_t
*)(
buf„r
);

95 
byãs
 = (
UI¡16_t
);

97 
msg
->
msgID
)

99 
AS_NAS_ESTABLISH_REQ
:

101 
byãs
 +(
«s_e°ablish_ªq_t
Ë- (
Byã_t
*);

102 
d©a
 = &
msg
->msg.
«s_e°ablish_ªq
.
öôülNasMsg
.data;

105 
AS_NAS_ESTABLISH_IND
:

107 
byãs
 +(
«s_e°ablish_öd_t
Ë- (
Byã_t
*);

108 
d©a
 = &
msg
->msg.
«s_e°ablish_öd
.
öôülNasMsg
.data;

111 
AS_NAS_ESTABLISH_RSP
:

113 
byãs
 +(
«s_e°ablish_r•_t
Ë- (
Byã_t
*);

114 
d©a
 = &
msg
->msg.
«s_e°ablish_r•
.
«sMsg
.data;

117 
AS_NAS_ESTABLISH_CNF
:

119 
byãs
 +(
«s_e°ablish_˙f_t
Ë- (
Byã_t
*);

120 
d©a
 = &
msg
->msg.
«s_e°ablish_˙f
.
«sMsg
.data;

123 
AS_UL_INFO_TRANSFER_REQ
:

125 
byãs
 +(
ul_öfo_å™s„r_ªq_t
Ë- (
Byã_t
*);

126 
d©a
 = &
msg
->msg.
ul_öfo_å™s„r_ªq
.
«sMsg
.data;

129 
AS_UL_INFO_TRANSFER_IND
:

131 
byãs
 +(
ul_öfo_å™s„r_öd_t
Ë- (
Byã_t
*);

132 
d©a
 = &
msg
->msg.
ul_öfo_å™s„r_öd
.
«sMsg
.data;

135 
AS_DL_INFO_TRANSFER_REQ
:

137 
byãs
 +(
dl_öfo_å™s„r_ªq_t
Ë- (
Byã_t
*);

138 
d©a
 = &
msg
->msg.
dl_öfo_å™s„r_ªq
.
«sMsg
.data;

141 
AS_DL_INFO_TRANSFER_IND
:

143 
byãs
 +(
dl_öfo_å™s„r_öd_t
Ë- (
Byã_t
*);

144 
d©a
 = &
msg
->msg.
dl_öfo_å™s„r_öd
.
«sMsg
.data;

147 
AS_BROADCAST_INFO_IND
:

148 
AS_CELL_INFO_REQ
:

149 
AS_CELL_INFO_CNF
:

150 
AS_CELL_INFO_IND
:

151 
AS_PAGING_REQ
:

152 
AS_PAGING_IND
:

153 
AS_NAS_RELEASE_REQ
:

154 
AS_UL_INFO_TRANSFER_CNF
:

155 
AS_DL_INFO_TRANSFER_CNF
:

156 
AS_NAS_RELEASE_IND
:

157 
AS_RAB_ESTABLISH_REQ
:

158 
AS_RAB_ESTABLISH_IND
:

159 
AS_RAB_ESTABLISH_RSP
:

160 
AS_RAB_ESTABLISH_CNF
:

161 
AS_RAB_RELEASE_REQ
:

162 
AS_RAB_RELEASE_IND
:

164 
byãs
 = 
Àngth
;

168 
byãs
 = 0;

169 
	`LOG_TRACE
(
WARNING
, "NET-API - AS message 0x%x isÇot valid",

170 
msg
->
msgID
);

174 i‡(
byãs
 > 0) {

175 i‡(
d©a
) {

177 *
d©a
 = (
Byã_t
*)(
buf„r
 + 
byãs
);

180 
	`mem˝y
(
msg
, (
as_mesßge_t
*)
buf„r
, 
byãs
);

181 
	`LOG_FUNC_RETURN
 (
msg
->
msgID
);

184 
	`LOG_TRACE
(
WARNING
, "NET-API - FailedÅo decode AS message 0x%x",

185 
msg
->
msgID
);

186 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

187 
	}
}

206 
	$as_mesßge_ícode
(* 
buf„r
, 
as_mesßge_t
* 
msg
, 
Àngth
)

208 
LOG_FUNC_IN
;

210 
byãs
 = (
msg
->
msgID
);

211 
as_«s_öfo_t
* 
«s_msg
 = 
NULL
;

213 
msg
->
msgID
)

215 
AS_BROADCAST_INFO_IND
:

217 
byãs
 +(
brﬂdˇ°_öfo_öd_t
);

220 
AS_CELL_INFO_REQ
:

222 
byãs
 +(
˚Œ_öfo_ªq_t
);

225 
AS_CELL_INFO_CNF
:

227 
byãs
 +(
˚Œ_öfo_˙f_t
);

230 
AS_CELL_INFO_IND
:

232 
byãs
 +(
˚Œ_öfo_öd_t
);

235 
AS_PAGING_REQ
:

237 
byãs
 +(
∑gög_ªq_t
);

240 
AS_PAGING_IND
:

242 
byãs
 +(
∑gög_öd_t
);

245 
AS_NAS_ESTABLISH_REQ
:

247 
byãs
 +(
«s_e°ablish_ªq_t
Ë- (
Byã_t
*);

248 
«s_msg
 = &
msg
->msg.
«s_e°ablish_ªq
.
öôülNasMsg
;

251 
AS_NAS_ESTABLISH_IND
:

253 
byãs
 +(
«s_e°ablish_öd_t
Ë- (
Byã_t
*);

254 
«s_msg
 = &
msg
->msg.
«s_e°ablish_öd
.
öôülNasMsg
;

257 
AS_NAS_ESTABLISH_RSP
:

259 
byãs
 +(
«s_e°ablish_r•_t
Ë- (
Byã_t
*);

260 
«s_msg
 = &
msg
->msg.
«s_e°ablish_r•
.
«sMsg
;

263 
AS_NAS_ESTABLISH_CNF
:

265 
byãs
 +(
«s_e°ablish_˙f_t
Ë- (
Byã_t
*);

266 
«s_msg
 = &
msg
->msg.
«s_e°ablish_˙f
.
«sMsg
;

269 
AS_NAS_RELEASE_REQ
:

271 
byãs
 +(
«s_ªÀa£_ªq_t
);

274 
AS_NAS_RELEASE_IND
:

276 
byãs
 +(
«s_ªÀa£_öd_t
);

279 
AS_UL_INFO_TRANSFER_REQ
:

281 
byãs
 +(
ul_öfo_å™s„r_ªq_t
Ë- (
Byã_t
*);

282 
«s_msg
 = &
msg
->msg.
ul_öfo_å™s„r_ªq
.
«sMsg
;

285 
AS_UL_INFO_TRANSFER_CNF
:

287 
byãs
 +(
ul_öfo_å™s„r_˙f_t
);

290 
AS_UL_INFO_TRANSFER_IND
:

292 
byãs
 +(
ul_öfo_å™s„r_öd_t
Ë- (
Byã_t
*);

293 
«s_msg
 = &
msg
->msg.
ul_öfo_å™s„r_öd
.
«sMsg
;

296 
AS_DL_INFO_TRANSFER_REQ
:

298 
byãs
 +(
dl_öfo_å™s„r_ªq_t
Ë- (
Byã_t
*);

299 
«s_msg
 = &
msg
->msg.
dl_öfo_å™s„r_ªq
.
«sMsg
;

302 
AS_DL_INFO_TRANSFER_CNF
:

304 
byãs
 +(
dl_öfo_å™s„r_˙f_t
);

307 
AS_DL_INFO_TRANSFER_IND
:

309 
byãs
 +(
dl_öfo_å™s„r_öd_t
Ë- (
Byã_t
*);

310 
«s_msg
 = &
msg
->msg.
dl_öfo_å™s„r_öd
.
«sMsg
;

313 
AS_RAB_ESTABLISH_REQ
:

315 
byãs
 +(
øb_e°ablish_ªq_t
);

318 
AS_RAB_ESTABLISH_IND
:

320 
byãs
 +(
øb_e°ablish_öd_t
);

323 
AS_RAB_ESTABLISH_RSP
:

325 
byãs
 +(
øb_e°ablish_r•_t
);

328 
AS_RAB_ESTABLISH_CNF
:

330 
byãs
 +(
øb_e°ablish_˙f_t
);

333 
AS_RAB_RELEASE_REQ
:

335 
byãs
 +(
øb_ªÀa£_ªq_t
);

338 
AS_RAB_RELEASE_IND
:

340 
byãs
 +(
øb_ªÀa£_öd_t
);

344 
	`LOG_TRACE
(
WARNING
, "NET-API - AS message 0x%x isÇot valid",

345 
msg
->
msgID
);

346 
byãs
 = 
Àngth
;

350 i‡(
Àngth
 > 
byãs
) {

352 
	`mem˝y
(
buf„r
, (*)
msg
, 
byãs
);

353 i‡–
«s_msg
 && («s_msg->
Àngth
 > 0) ) {

355 
	`mem˝y
(
buf„r
 + 
byãs
, 
«s_msg
->
d©a
,Ças_msg->
Àngth
);

356 
byãs
 +
«s_msg
->
Àngth
;

358 
	`‰ì
(
«s_msg
->
d©a
);

359 
«s_msg
->
Àngth
 = 0;

360 
«s_msg
->
d©a
 = 
NULL
;

362 
	`LOG_FUNC_RETURN
 (
byãs
);

365 
	`LOG_TRACE
(
WARNING
, "NET-API - FailedÅoÉncode AS message 0x%x",

366 
msg
->
msgID
);

367 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

368 
	}
}

	@src/api/network/l2_message.h

48 #i‚de‡
__AS_MESSAGE_H__


49 
	#__AS_MESSAGE_H__


	)

51 
	~"comm⁄Def.h
"

52 
	~"√tw‹kDef.h
"

59 
	#AS_REQUEST
 0x0100

	)

60 
	#AS_RESPONSE
 0x0200

	)

61 
	#AS_INDICATION
 0x0400

	)

62 
	#AS_CONFIRM
 0x0800

	)

70 
	#AS_CELL_INFO
 0x01

	)

71 
	#AS_CELL_INFO_REQ
 (
AS_CELL_INFO
 | 
AS_REQUEST
)

	)

72 
	#AS_CELL_INFO_RSP
 (
AS_CELL_INFO
 | 
AS_RESPONSE
)

	)

73 
	#AS_CELL_INFO_IND
 (
AS_CELL_INFO
 | 
AS_INDICATION
)

	)

76 
	#AS_SECURITY
 0x02

	)

77 
	#AS_SECURITY_REQ
 (
AS_SECURITY
 | 
AS_REQUEST
)

	)

78 
	#AS_SECURITY_RSP
 (
AS_SECURITY
 | 
AS_RESPONSE
)

	)

81 
	#AS_PAGING
 0x03

	)

82 
	#AS_PAGING_IND
 (
AS_PAGING
 | 
AS_INDICATION
)

	)

85 
	#AS_NAS_ESTABLISH
 0x04

	)

86 
	#AS_NAS_ESTABLISH_REQ
 (
AS_NAS_ESTABLISH
 | 
AS_REQUEST
)

	)

87 
	#AS_NAS_ESTABLISH_RSP
 (
AS_NAS_ESTABLISH
 | 
AS_RESPONSE
)

	)

90 
	#AS_NAS_RELEASE
 0x05

	)

91 
	#AS_NAS_RELEASE_REQ
 (
AS_NAS_RELEASE
 | 
AS_REQUEST
)

	)

92 
	#AS_NAS_RELEASE_IND
 (
AS_NAS_RELEASE
 | 
AS_INDICATION
)

	)

95 
	#AS_INFO_TRANSFER
 0x10

	)

96 
	#AS_UL_INFO_TRANSFER
 (
AS_INFO_TRANSFER
 | 
AS_REQUEST
)

	)

97 
	#AS_DL_INFO_TRANSFER
 (
AS_INFO_TRANSFER
 | 
AS_INDICATION
)

	)

110 
	#AS_GSM
 (1 << 
NET_ACCESS_GSM
)

	)

111 
	#AS_COMPACT
 (1 << 
NET_ACCESS_COMPACT
)

	)

112 
	#AS_UTRAN
 (1 << 
NET_ACCESS_UTRAN
)

	)

113 
	#AS_EGPRS
 (1 << 
NET_ACCESS_EGPRS
)

	)

114 
	#AS_HSDPA
 (1 << 
NET_ACCESS_HSDPA
)

	)

115 
	#AS_HSUPA
 (1 << 
NET_ACCESS_HSUPA
)

	)

116 
	#AS_HSDUPA
 (1 << 
NET_ACCESS_HSDUPA
)

	)

117 
	#AS_EUTRAN
 (1 << 
NET_ACCESS_EUTRAN
)

	)

125 
∂mn_t
 
	m∂mnID
;

126 
Byã_t
 
	møt
;

127 } 
	t˚Œ_öfo_ªq_t
;

135 
∂mn_t
 
	m∂mnID
;

136 
TAC_t
 
	mèc
;

137 
CI_t
 
	m˚ŒID
;

138 
AcT_t
 
	møt
;

139 } 
	t˚Œ_öfo_r•_t
;

147 
	#PLMN_LIST_MAX_SIZE
 6

	)

148 
PLMN_LIST_T
(
PLMN_LIST_MAX_SIZE
Ë
	m∂mnIDs
;

149 
Byã_t
 
	møt
[
PLMN_LIST_MAX_SIZE
];

150 
TAC_t
 
	mèc
;

151 
CI_t
 
	m˚ŒID
;

152 } 
	t˚Œ_öfo_öd_t
;

163 °ru˘ {} 
	g£curôy_ªq_t
;

169 °ru˘ {} 
	g£curôy_r•_t
;

181 °ru˘ {} 
	g∑gög_öd_t
;

190 
	#AS_CAUSE_EMERGENCY
 (
NET_ESTABLISH_CAUSE_EMERGENCY
)

	)

191 
	#AS_CAUSE_HIGH_PRIO
 (
NET_ESTABLISH_CAUSE_HIGH_PRIO
)

	)

192 
	#AS_CAUSE_MT_ACCESS
 (
NET_ESTABLISH_CAUSE_MT_ACCESS
)

	)

193 
	#AS_CAUSE_MO_SIGNAL
 (
NET_ESTABLISH_CAUSE_MO_SIGNAL
)

	)

194 
	#AS_CAUSE_MO_DATA
 (
NET_ESTABLISH_CAUSE_MO_DATA
)

	)

195 
	#AS_CAUSE_V1020
 (
NET_ESTABLISH_CAUSE_V1020
)

	)

198 
	#AS_TYPE_ORIGINATING_SIGNAL
 (
NET_ESTABLISH_TYPE_ORIGINATING_SIGNAL
)

	)

199 
	#AS_TYPE_EMERGENCY_CALLS
 (
NET_ESTABLISH_TYPE_EMERGENCY_CALLS
)

	)

200 
	#AS_TYPE_ORIGINATING_CALLS
 (
NET_ESTABLISH_TYPE_ORIGINATING_CALLS
)

	)

201 
	#AS_TYPE_TERMINATING_CALLS
 (
NET_ESTABLISH_TYPE_TERMINATING_CALLS
)

	)

202 
	#AS_TYPE_MO_CS_FALLBACK
 (
NET_ESTABLISH_TYPE_MO_CS_FALLBACK
)

	)

207 
UI¡8_t
 
	mMMEcode
;

208 
UI¡32_t
 
	mm_tmsi
;

209 } 
	tas_°msi_t
;

213 
UI¡32_t
 
	mÀngth
;

214 
Byã_t
* 
	md©a
;

215 } 
	tas_«s_öfo_t
;

223 
UI¡8_t
 
	mˇu£
;

224 
UI¡8_t
 
	mty≥
;

225 
∂mn_t
 
	m∂mnID
;

226 
as_°msi_t
 
	ms_tmsi
;

227 
as_«s_öfo_t
 
	möôülNasMsg
;

228 } 
	t«s_e°ablish_ªq_t
;

233 °ru˘ {} 
	g«s_e°ablish_r•_t
;

244 °ru˘ {} 
	g«s_ªÀa£_ªq_t
;

249 °ru˘ {} 
	g«s_ªÀa£_öd_t
;

262 
as_«s_öfo_t
 
	tdl_öfo_å™s„r_t
;

269 
as_«s_öfo_t
 
	tul_öfo_å™s„r_t
;

277 
UI¡16_t
 
	mmsgID
;

279 
˚Œ_öfo_ªq_t
 
	m˚Œ_öfo_ªq
;

280 
˚Œ_öfo_r•_t
 
	m˚Œ_öfo_r•
;

281 
˚Œ_öfo_öd_t
 
	m˚Œ_öfo_öd
;

282 
£curôy_ªq_t
 
	m£curôy_ªq
;

283 
£curôy_r•_t
 
	m£curôy_r•
;

284 
∑gög_öd_t
 
	m∑gög_öd
;

285 
«s_e°ablish_ªq_t
 
	m«s_e°ablish_ªq
;

286 
«s_e°ablish_r•_t
 
	m«s_e°ablish_r•
;

287 
«s_ªÀa£_ªq_t
 
	m«s_ªÀa£_ªq
;

288 
«s_ªÀa£_öd_t
 
	m«s_ªÀa£_öd
;

289 
ul_öfo_å™s„r_t
 
	mul_öfo_å™s„r
;

290 
dl_öfo_å™s„r_t
 
	mdl_öfo_å™s„r
;

291 } 
__©åibuã__
((
__∑cked__
)Ë
	mmsg
;

292 } 
	tas_mesßge_t
;

302 
as_mesßge_decode
(c⁄° * 
buf„r
, 
Àngth
, 
as_mesßge_t
* 
msg
);

304 
as_mesßge_ícode
(* 
buf„r
, 
Àngth
, c⁄° 
as_mesßge_t
* 
msg
);

307 
as_mesßge_£nd
(
as_mesßge_t
* 
as_msg
, c⁄° * 
«s_msg
);

	@src/api/network/nas_message.c

48 
	~"«s_mesßge.h
"

49 
	~"«s_log.h
"

51 
	~"TLVDecodî.h
"

52 
	~"TLVEncodî.h
"

54 
	~<°dlib.h
>

55 
	~<°rög.h
>

57 #i‡((
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

58 
	~"«s_ôti_mesßgög.h
"

60 
	~"£cu_defs.h
"

61 
	~"emmD©a.h
"

73 
_«s_mesßge_hódî_decode
(c⁄° * 
buf„r
,

74 
«s_mesßge_£curôy_hódî_t
* 
hódî
, 
Àngth
);

75 
_«s_mesßge_∂aö_decode
(c⁄° * 
buf„r
,

76 c⁄° 
«s_mesßge_£curôy_hódî_t
* 
hódî
,

77 
«s_mesßge_∂aö_t
* 
msg
, 
Àngth
);

78 
_«s_mesßge_¥Ÿe˘ed_decode
(c⁄° * 
buf„r
,

79 
«s_mesßge_£curôy_hódî_t
* 
hódî
,

80 
«s_mesßge_∂aö_t
* 
msg
, 
Àngth
,

81 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
);

84 
_«s_mesßge_hódî_ícode
(* 
buf„r
,

85 c⁄° 
«s_mesßge_£curôy_hódî_t
* 
hódî
, 
Àngth
);

86 
_«s_mesßge_∂aö_ícode
(* 
buf„r
,

87 c⁄° 
«s_mesßge_£curôy_hódî_t
* 
hódî
,

88 c⁄° 
«s_mesßge_∂aö_t
* 
msg
, 
Àngth
);

90 
_«s_mesßge_¥Ÿe˘ed_ícode
(

91 *
buf„r
,

92 c⁄° 
«s_mesßge_£curôy_¥Ÿe˘ed_t
 *
msg
,

93 
Àngth
,

94 *
£curôy
);

97 
_«s_mesßge_de¸y±
(

98 * 
de°
,

99 c⁄° * 
§c
,

100 
UI¡8_t
 
ty≥
,

101 
UI¡32_t
 
code
,

102 
UI¡8_t
 
£q
,

103 
Àngth
,

104 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
);

108 
_«s_mesßge_í¸y±
(

109 *
de°
,

110 c⁄° *
§c
,

111 
UI¡8_t
 
ty≥
,

112 
UI¡32_t
 
code
,

113 
UI¡8_t
 
£q
,

114 c⁄° 
dúe˘i⁄
,

115 
Àngth
,

116 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
);

119 
UI¡32_t
 
_«s_mesßge_gë_mac
(

120 c⁄° * c⁄° 
buf„r
,

121 c⁄° 
Àngth
,

122 c⁄° 
dúe˘i⁄
,

123 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
);

150 
	$«s_mesßge_í¸y±
(

151 c⁄° *
öbuf
,

152 *
outbuf
,

153 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

154 
Àngth
,

155 *
£curôy
)

157 
LOG_FUNC_IN
;

158 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = (emm_£curôy_c⁄ãxt_t*)
£curôy
;

159 
byãs
 = 
Àngth
;

162 
size
 = 
	`_«s_mesßge_hódî_ícode
(
outbuf
, 
hódî
, 
Àngth
);

164 i‡(
size
 < 0) {

165 
	`LOG_FUNC_RETURN
 (
TLV_ENCODE_BUFFER_TOO_SHORT
);

167 i‡(
size
 > 1) {

169 
byãs
 = 
	`_«s_mesßge_í¸y±
(
outbuf
 + 
size
, 
öbuf
,

170 
hódî
->
£curôy_hódî_ty≥
,

171 
hódî
->
mesßge_authítiˇti⁄_code
,

172 
hódî
->
£quí˚_numbî
,

173 #ifde‡
NAS_MME


174 
SECU_DIRECTION_DOWNLINK
,

176 
SECU_DIRECTION_UPLINK
,

178 
Àngth
 - 
size
,

179 
emm_£curôy_c⁄ãxt
);

181 i‡(
byãs
 > 0) {

183 
off£t
 = 
size
 - (
UI¡8_t
);

185 
UI¡32_t
 
mac
 = 
	`_«s_mesßge_gë_mac
(

186 
outbuf
 + 
off£t
,

187 
byãs
 + 
size
 - 
off£t
,

188 #ifde‡
NAS_MME


189 
SECU_DIRECTION_DOWNLINK
,

191 
SECU_DIRECTION_UPLINK
,

193 
emm_£curôy_c⁄ãxt
);

195 *(
UI¡32_t
*)(
outbuf
 + (
UI¡8_t
)Ë
	`ht⁄l
(
mac
);

200 
	`mem˝y
(
outbuf
, 
öbuf
, 
Àngth
);

203 #ifde‡
NAS_MME


215 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 += 1;

216 i‡–! 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
) {

217 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 += 1;

219 
	`LOG_TRACE
(
DEBUG
,

221 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
);

223 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 += 1;

224 i‡–! 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
) {

225 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 += 1;

227 
	`LOG_TRACE
(
DEBUG
,

229 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
);

232 i‡(
byãs
 < 0) {

233 
	`LOG_FUNC_RETURN
 (
byãs
);

235 i‡(
size
 > 1) {

236 
	`LOG_FUNC_RETURN
 (
size
 + 
byãs
);

238 
	`LOG_FUNC_RETURN
 (
byãs
);

239 
	}
}

261 
	$«s_mesßge_de¸y±
(

262 c⁄° *
öbuf
,

263 *
outbuf
,

264 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

265 
Àngth
,

266 *
£curôy
)

268 
LOG_FUNC_IN
;

270 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = (emm_£curôy_c⁄ãxt_t*)
£curôy
;

271 
byãs
 = 
Àngth
;

274 
size
 = 
	`_«s_mesßge_hódî_decode
(
öbuf
, 
hódî
, 
Àngth
);

276 i‡(
size
 < 0) {

277 
	`LOG_TRACE
(
DEBUG
, "MESSAGE TOO SHORT");

278 
	`LOG_FUNC_RETURN
 (
TLV_DECODE_BUFFER_TOO_SHORT
);

280 i‡(
size
 > 1) {

281 i‡(
emm_£curôy_c⁄ãxt
) {

282 #i‡
	`deföed
(
NAS_MME
)

283 i‡(
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 > 
hódî
->
£quí˚_numbî
) {

284 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 += 1;

286 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 = 
hódî
->
£quí˚_numbî
;

288 i‡(
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 > 
hódî
->
£quí˚_numbî
) {

289 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 += 1;

291 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 = 
hódî
->
£quí˚_numbî
;

295 
off£t
 = 
size
 - (
UI¡8_t
);

297 
UI¡32_t
 
mac
 = 
	`_«s_mesßge_gë_mac
(

298 
öbuf
 + 
off£t
,

299 
Àngth
 - 
off£t
,

300 #ifde‡
NAS_MME


301 
SECU_DIRECTION_UPLINK
,

303 
SECU_DIRECTION_DOWNLINK
,

305 
emm_£curôy_c⁄ãxt
);

309 i‡(
mac
 !
hódî
->
mesßge_authítiˇti⁄_code
) {

310 
	`LOG_TRACE
(
DEBUG
,

312 
hódî
->
mesßge_authítiˇti⁄_code
,

313 
hódî
->
mesßge_authítiˇti⁄_code
,

314 
mac
,

315 
mac
);

316 #i‡
	`deföed
(
NAS_MME
)

317 
	`LOG_FUNC_RETURN
 (
TLV_DECODE_MAC_MISMATCH
);

320 i‡(
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
öãgrôy
 !=

321 
NAS_SECURITY_ALGORITHMS_EIA0
) {

322 
	`LOG_FUNC_RETURN
 (
TLV_DECODE_MAC_MISMATCH
);

324 
	`LOG_TRACE
(
WARNING
,

329 
	`LOG_TRACE
(
DEBUG
, "Integrity: MAC Success");

333 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =

334 
	`_«s_mesßge_de¸y±
(
outbuf
, 
öbuf
 + 
size
,

335 
hódî
->
£curôy_hódî_ty≥
,

336 
hódî
->
mesßge_authítiˇti⁄_code
,

337 
hódî
->
£quí˚_numbî
,

338 
Àngth
 - 
size
,

339 
emm_£curôy_c⁄ãxt
);

340 
byãs
 = 
Àngth
 - 
size
;

343 
	`LOG_TRACE
(
DEBUG
, "Plain NAS message found");

345 
	`mem˝y
(
outbuf
, 
öbuf
, 
Àngth
);

348 
	`LOG_FUNC_RETURN
 (
byãs
);

349 
	}
}

369 
	$«s_mesßge_decode
(

370 c⁄° * c⁄° 
buf„r
,

371 
«s_mesßge_t
 *
msg
,

372 
Àngth
,

373 *
£curôy
)

375 
LOG_FUNC_IN
;

376 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = (emm_£curôy_c⁄ãxt_t*)
£curôy
;

377 
byãs
;

380 
size
 = 
	`_«s_mesßge_hódî_decode
(
buf„r
, &
msg
->
hódî
, 
Àngth
);

382 i‡(
size
 < 0) {

383 
	`LOG_FUNC_RETURN
 (
TLV_DECODE_BUFFER_TOO_SHORT
);

385 i‡(
size
 > 1) {

386 i‡(
emm_£curôy_c⁄ãxt
) {

387 #i‡
	`deföed
(
NAS_MME
)

388 i‡(
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 > 
msg
->
hódî
.
£quí˚_numbî
) {

389 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 += 1;

391 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 = 
msg
->
hódî
.
£quí˚_numbî
;

394 i‡(
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 > 
msg
->
hódî
.
£quí˚_numbî
) {

395 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 += 1;

397 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 = 
msg
->
hódî
.
£quí˚_numbî
;

401 
off£t
 = 
size
 - (
UI¡8_t
);

403 
UI¡32_t
 
mac
 = 
	`_«s_mesßge_gë_mac
(

404 
buf„r
 + 
off£t
,

405 
Àngth
 - 
off£t
,

406 #ifde‡
NAS_MME


407 
SECU_DIRECTION_UPLINK
,

409 
SECU_DIRECTION_DOWNLINK
,

411 
emm_£curôy_c⁄ãxt


415 i‡(
mac
 !
msg
->
hódî
.
mesßge_authítiˇti⁄_code
) {

416 
	`LOG_TRACE
(
DEBUG
,

418 
msg
->
hódî
.
mesßge_authítiˇti⁄_code
,

419 
mac
);

420 
	`LOG_FUNC_RETURN
 (
TLV_DECODE_MAC_MISMATCH
);

423 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

428 
byãs
 = 
	`_«s_mesßge_¥Ÿe˘ed_decode
(
buf„r
 + 
size
,

429 &
msg
->
hódî
,

430 &
msg
->
∂aö
,

431 
Àngth
 - 
size
,

432 
emm_£curôy_c⁄ãxt
);

436 
byãs
 = 
	`_«s_mesßge_∂aö_decode
(
buf„r
,

437 &
msg
->
hódî
,

438 &
msg
->
∂aö
,

439 
Àngth
);

442 i‡(
byãs
 < 0) {

443 
	`LOG_FUNC_RETURN
 (
byãs
);

445 i‡(
size
 > 1) {

446 
	`LOG_FUNC_RETURN
 (
size
 + 
byãs
);

448 
	`LOG_FUNC_RETURN
 (
byãs
);

449 
	}
}

468 
	$«s_mesßge_ícode
(

469 *
buf„r
,

470 c⁄° 
«s_mesßge_t
 *c⁄° 
msg
,

471 
Àngth
,

472 *
£curôy
)

474 
LOG_FUNC_IN
;

476 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = (emm_£curôy_c⁄ãxt_t*)
£curôy
;

477 
byãs
;

481 
size
 = 
	`_«s_mesßge_hódî_ícode
(
buf„r
, &
msg
->
hódî
, 
Àngth
);

483 i‡(
size
 < 0) {

484 
	`LOG_FUNC_RETURN
 (
TLV_ENCODE_BUFFER_TOO_SHORT
);

486 i‡(
size
 > 1) {

488 
byãs
 = 
	`_«s_mesßge_¥Ÿe˘ed_ícode
(

489 
buf„r
 + 
size
,

490 &
msg
->
£curôy_¥Ÿe˘ed
,

491 
Àngth
 - 
size
,

492 
emm_£curôy_c⁄ãxt
);

494 i‡(
byãs
 > 0) {

496 
off£t
 = 
size
 - (
UI¡8_t
);

498 
	`LOG_TRACE
(
DEBUG
,

500 
off£t
, 
size
, (
UI¡8_t
),

501 
size
, 
Àngth
, 
byãs
);

502 
UI¡32_t
 
mac
 = 
	`_«s_mesßge_gë_mac
(

503 
buf„r
 + 
off£t
,

504 
byãs
 + 
size
 - 
off£t
,

505 #ifde‡
NAS_MME


506 
SECU_DIRECTION_DOWNLINK
,

508 
SECU_DIRECTION_UPLINK
,

510 
emm_£curôy_c⁄ãxt
);

512 *(
UI¡32_t
*)(
buf„r
 + (
UI¡8_t
)Ë
	`ht⁄l
(
mac
);

514 i‡(
emm_£curôy_c⁄ãxt
) {

515 #ifde‡
NAS_MME


528 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 += 1;

529 i‡–! 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
) {

530 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 += 1;

532 
	`LOG_TRACE
(
DEBUG
,

534 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
);

536 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 += 1;

537 i‡–! 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
) {

538 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 += 1;

540 
	`LOG_TRACE
(
DEBUG
,

542 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
);

545 
	`LOG_TRACE
(
DEBUG
,

549 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

555 
byãs
 = 
	`_«s_mesßge_∂aö_ícode
(
buf„r
, &
msg
->
hódî
,

556 &
msg
->
∂aö
, 
Àngth
);

559 i‡(
byãs
 < 0) {

560 
	`LOG_FUNC_RETURN
 (
byãs
);

562 i‡(
size
 > 1) {

563 
	`LOG_FUNC_RETURN
 (
size
 + 
byãs
);

565 
	`LOG_FUNC_RETURN
 (
byãs
);

566 
	}
}

599 
	$_«s_mesßge_hódî_decode
(

600 c⁄° *
buf„r
,

601 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

602 
Àngth
)

604 
LOG_FUNC_IN
;

606 
size
 = 0;

610 
	`DECODE_U8
(
buf„r
, *(
UI¡8_t
*)(
hódî
), 
size
);

612 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

613 i‡(
hódî
->
£curôy_hódî_ty≥
 !
SECURITY_HEADER_TYPE_NOT_PROTECTED
)

615 i‡(
Àngth
 < 
NAS_MESSAGE_SECURITY_HEADER_SIZE
) {

617 
	`LOG_TRACE
(
WARNING
, "NET-API - The size ofÅhe header (%u) "

619 
NAS_MESSAGE_SECURITY_HEADER_SIZE
, 
Àngth
);

620 
	`LOG_FUNC_RETURN
 (-1);

623 
	`DECODE_U32
(
buf„r
+
size
, 
hódî
->
mesßge_authítiˇti⁄_code
, size);

625 
	`DECODE_U8
(
buf„r
+
size
, 
hódî
->
£quí˚_numbî
, size);

629 
	`LOG_FUNC_RETURN
 (
size
);

630 
	}
}

652 
	$_«s_mesßge_∂aö_decode
(

653 c⁄° *
buf„r
,

654 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

655 
«s_mesßge_∂aö_t
 *
msg
,

656 
Àngth
)

658 
LOG_FUNC_IN
;

660 
byãs
 = 
TLV_DECODE_PROTOCOL_NOT_SUPPORTED
;

662 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

664 
byãs
 = 
	`emm_msg_decode
(&
msg
->
emm
, (
uöt8_t
 *)
buf„r
, 
Àngth
);

666 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_SESSION_MANAGEMENT_MESSAGE
) {

668 
byãs
 = 
	`esm_msg_decode
(&
msg
->
esm
, (
uöt8_t
 *)
buf„r
, 
Àngth
);

672 
	`LOG_TRACE
(
WARNING
,"NET-API - Protocol discriminator 0x%x is "

673 "nŸ suµ‹ãd", 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

676 
	`LOG_FUNC_RETURN
 (
byãs
);

677 
	}
}

699 
	$_«s_mesßge_¥Ÿe˘ed_decode
(

700 c⁄° *
buf„r
,

701 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

702 
«s_mesßge_∂aö_t
 *
msg
,

703 
Àngth
,

704 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
)

706 
LOG_FUNC_IN
;

708 
byãs
 = 
TLV_DECODE_BUFFER_TOO_SHORT
;

710 * 
∂aö_msg
 = (*)
	`ˇŒoc
(1,
Àngth
);

711 i‡(
∂aö_msg
)

714 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =

715 
	`_«s_mesßge_de¸y±
(
∂aö_msg
,

716 
buf„r
,

717 
hódî
->
£curôy_hódî_ty≥
,

718 
hódî
->
mesßge_authítiˇti⁄_code
,

719 
hódî
->
£quí˚_numbî
,

720 
Àngth
,

721 
emm_£curôy_c⁄ãxt
);

723 
byãs
 = 
	`_«s_mesßge_∂aö_decode
(
∂aö_msg
, 
hódî
, 
msg
, 
Àngth
);

724 
	`‰ì
(
∂aö_msg
);

727 
	`LOG_FUNC_RETURN
 (
byãs
);

728 
	}
}

755 
	$_«s_mesßge_hódî_ícode
(

756 *
buf„r
,

757 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

758 
Àngth
)

760 
LOG_FUNC_IN
;

762 
size
 = 0;

766 
	`ENCODE_U8
(
buf„r
, *(
UI¡8_t
*)(
hódî
), 
size
);

768 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

769 i‡(
hódî
->
£curôy_hódî_ty≥
 !
SECURITY_HEADER_TYPE_NOT_PROTECTED
)

772 i‡(
Àngth
 < 
NAS_MESSAGE_SECURITY_HEADER_SIZE
) {

774 
	`LOG_TRACE
(
WARNING
, "NET-API - The size ofÅhe header (%u) "

776 
NAS_MESSAGE_SECURITY_HEADER_SIZE
, 
Àngth
);

777 
	`LOG_FUNC_RETURN
 (-1);

780 
	`ENCODE_U32
(
buf„r
+
size
, 
hódî
->
mesßge_authítiˇti⁄_code
, size);

782 
	`ENCODE_U8
(
buf„r
+
size
, 
hódî
->
£quí˚_numbî
, size);

788 
	`LOG_FUNC_RETURN
 (
size
);

789 
	}
}

810 
	$_«s_mesßge_∂aö_ícode
(

811 *
buf„r
,

812 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

813 c⁄° 
«s_mesßge_∂aö_t
 *
msg
,

814 
Àngth
)

816 
LOG_FUNC_IN
;

818 
byãs
 = 
TLV_ENCODE_PROTOCOL_NOT_SUPPORTED
;

820 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

822 
byãs
 = 
	`emm_msg_ícode
((
EMM_msg
*)(&
msg
->
emm
), (
uöt8_t
*)
buf„r
, 
Àngth
);

824 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_SESSION_MANAGEMENT_MESSAGE
) {

826 
byãs
 = 
	`esm_msg_ícode
((
ESM_msg
*)(&
msg
->
esm
), (
uöt8_t
*)
buf„r
, 
Àngth
);

830 
	`LOG_TRACE
(
WARNING
,"NET-API - Protocol discriminator 0x%x is "

831 "nŸ suµ‹ãd", 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

834 
	`LOG_FUNC_RETURN
 (
byãs
);

835 
	}
}

855 
	$_«s_mesßge_¥Ÿe˘ed_ícode
(

856 *
buf„r
,

857 c⁄° 
«s_mesßge_£curôy_¥Ÿe˘ed_t
 *
msg
,

858 
Àngth
,

859 *
£curôy
)

861 
LOG_FUNC_IN
;

863 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = (emm_£curôy_c⁄ãxt_t*)
£curôy
;

864 
byãs
 = 
TLV_ENCODE_BUFFER_TOO_SHORT
;

866 * 
∂aö_msg
 = (*)
	`ˇŒoc
(1,
Àngth
);

867 i‡(
∂aö_msg
) {

869 
size
 = 
	`_«s_mesßge_∂aö_ícode
(
∂aö_msg
, &
msg
->
hódî
,

870 &
msg
->
∂aö
, 
Àngth
);

871 i‡(
size
 > 0) {

874 
byãs
 = 
	`_«s_mesßge_í¸y±
(
buf„r
,

875 
∂aö_msg
,

876 
msg
->
hódî
.
£curôy_hódî_ty≥
,

877 
msg
->
hódî
.
mesßge_authítiˇti⁄_code
,

878 
msg
->
hódî
.
£quí˚_numbî
,

879 #ifde‡
NAS_MME


880 
SECU_DIRECTION_DOWNLINK
,

882 
SECU_DIRECTION_UPLINK
,

884 
size
,

885 
emm_£curôy_c⁄ãxt
);

889 
	`‰ì
(
∂aö_msg
);

892 
	`LOG_FUNC_RETURN
 (
byãs
);

893 
	}
}

920 
	$_«s_mesßge_de¸y±
(

921 *
de°
,

922 c⁄° *
§c
,

923 
UI¡8_t
 
£curôy_hódî_ty≥
,

924 
UI¡32_t
 
code
,

925 
UI¡8_t
 
£q
,

926 
Àngth
,

927 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
)

929 
«s_°ªam_cùhî_t
 
°ªam_cùhî
;

930 
uöt32_t
 
cou¡
;

931 
uöt8_t
 
dúe˘i⁄
;

933 
LOG_FUNC_IN
;

935 
size
 = 0;

936 
«s_mesßge_£curôy_hódî_t
 
hódî
;

938 #ifde‡
NAS_MME


939 
dúe˘i⁄
 = 
SECU_DIRECTION_UPLINK
;

941 
dúe˘i⁄
 = 
SECU_DIRECTION_DOWNLINK
;

944 
£curôy_hódî_ty≥
) {

945 
SECURITY_HEADER_TYPE_NOT_PROTECTED
:

946 
SECURITY_HEADER_TYPE_SERVICE_REQUEST
:

947 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED
:

948 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_NEW
:

949 
	`LOG_TRACE
(
DEBUG
,

951 
Àngth
, 
£curôy_hódî_ty≥
);

952 
	`mem˝y
(
de°
, 
§c
, 
Àngth
);

953 
	`LOG_FUNC_RETURN
 (
Àngth
);

956 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED
:

957 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED_NEW
:

958 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
) {

960 
NAS_SECURITY_ALGORITHMS_EEA1
: {

961 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

962 
cou¡
 = 0x00000000 ||

963 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

964 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

966 
cou¡
 = 0x00000000 ||

967 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

968 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

970 
	`LOG_TRACE
(
DEBUG
,

972 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

973 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

974 
cou¡
);

975 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_íc
.
vÆue
;

976 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

977 
°ªam_cùhî
.
cou¡
 = count;

978 
°ªam_cùhî
.
bóªr
 = 0x00;

979 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

980 
°ªam_cùhî
.
mesßge
 = 
§c
;

982 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

983 
	`«s_°ªam_í¸y±_ìa1
(&
°ªam_cùhî
, 
de°
);

986 
	`DECODE_U8
(
de°
, *(
UI¡8_t
*)(&
hódî
), 
size
);

988 
	`LOG_FUNC_RETURN
 (
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

992 
NAS_SECURITY_ALGORITHMS_EEA2
: {

993 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

994 
cou¡
 = 0x00000000 ||

995 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

996 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

998 
cou¡
 = 0x00000000 ||

999 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1000 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

1002 
	`LOG_TRACE
(
DEBUG
,

1004 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1005 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

1006 
cou¡
);

1007 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_íc
.
vÆue
;

1008 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

1009 
°ªam_cùhî
.
cou¡
 = count;

1010 
°ªam_cùhî
.
bóªr
 = 0x00;

1011 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

1012 
°ªam_cùhî
.
mesßge
 = 
§c
;

1014 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

1015 
	`«s_°ªam_í¸y±_ìa1
(&
°ªam_cùhî
, 
de°
);

1018 
	`DECODE_U8
(
de°
, *(
UI¡8_t
*)(&
hódî
), 
size
);

1020 
	`LOG_FUNC_RETURN
 (
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

1023 
NAS_SECURITY_ALGORITHMS_EEA0
:

1024 
	`LOG_TRACE
(
DEBUG
,

1026 
dúe˘i⁄
,

1027 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
,

1028 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
);

1029 
	`mem˝y
(
de°
, 
§c
, 
Àngth
);

1032 
	`DECODE_U8
(
de°
, *(
UI¡8_t
*)(&
hódî
), 
size
);

1034 
	`LOG_FUNC_RETURN
 (
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

1039 
	`LOG_TRACE
(
ERROR
,

1041 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
);

1042 
	`mem˝y
(
de°
, 
§c
, 
Àngth
);

1045 
	`DECODE_U8
(
de°
, *(
UI¡8_t
*)(&
hódî
), 
size
);

1047 
	`LOG_FUNC_RETURN
 (
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

1052 
	`LOG_TRACE
(
ERROR
,

1053 "Unknow¿£curôy hódîÅy≥ %u", 
£curôy_hódî_ty≥
);

1054 
	`LOG_FUNC_RETURN
 (0);

1057 
	}
}

1080 
	$_«s_mesßge_í¸y±
(

1081 *
de°
,

1082 c⁄° *
§c
,

1083 
UI¡8_t
 
£curôy_hódî_ty≥
,

1084 
UI¡32_t
 
code
,

1085 
UI¡8_t
 
£q
,

1086 c⁄° 
dúe˘i⁄
,

1087 
Àngth
,

1088 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
)

1090 
«s_°ªam_cùhî_t
 
°ªam_cùhî
;

1091 
uöt32_t
 
cou¡
;

1092 
LOG_FUNC_IN
;

1094 i‡(!
emm_£curôy_c⁄ãxt
) {

1095 
	`LOG_TRACE
(
ERROR
,

1097 
	`LOG_FUNC_RETURN
 (0);

1100 
£curôy_hódî_ty≥
) {

1101 
SECURITY_HEADER_TYPE_NOT_PROTECTED
:

1102 
SECURITY_HEADER_TYPE_SERVICE_REQUEST
:

1103 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED
:

1104 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_NEW
:

1105 
	`LOG_TRACE
(
DEBUG
,

1107 
£curôy_hódî_ty≥
);

1108 
	`mem˝y
(
de°
, 
§c
, 
Àngth
);

1109 
	`LOG_FUNC_RETURN
 (
Àngth
);

1112 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED
:

1113 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED_NEW
:

1114 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
) {

1116 
NAS_SECURITY_ALGORITHMS_EEA1
: {

1117 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

1118 
cou¡
 = 0x00000000 ||

1119 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1120 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

1122 
cou¡
 = 0x00000000 ||

1123 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1124 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

1126 
	`LOG_TRACE
(
DEBUG
,

1128 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1129 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

1130 
cou¡
);

1131 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_íc
.
vÆue
;

1132 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

1133 
°ªam_cùhî
.
cou¡
 = count;

1134 
°ªam_cùhî
.
bóªr
 = 0x00;

1135 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

1136 
°ªam_cùhî
.
mesßge
 = 
§c
;

1138 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

1139 
	`«s_°ªam_í¸y±_ìa1
(&
°ªam_cùhî
, 
de°
);

1141 
	`LOG_FUNC_RETURN
 (
Àngth
);

1145 
NAS_SECURITY_ALGORITHMS_EEA2
: {

1146 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

1147 
cou¡
 = 0x00000000 ||

1148 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1149 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

1151 
cou¡
 = 0x00000000 ||

1152 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1153 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

1155 
	`LOG_TRACE
(
DEBUG
,

1157 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1158 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

1159 
cou¡
);

1160 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_íc
.
vÆue
;

1161 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

1162 
°ªam_cùhî
.
cou¡
 = count;

1163 
°ªam_cùhî
.
bóªr
 = 0x00;

1164 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

1165 
°ªam_cùhî
.
mesßge
 = 
§c
;

1167 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

1168 
	`«s_°ªam_í¸y±_ìa2
(&
°ªam_cùhî
, 
de°
);

1170 
	`LOG_FUNC_RETURN
 (
Àngth
);

1174 
NAS_SECURITY_ALGORITHMS_EEA0
:

1175 
	`LOG_TRACE
(
DEBUG
,

1177 
dúe˘i⁄
,

1178 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
,

1179 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
);

1180 
	`mem˝y
(
de°
, 
§c
, 
Àngth
);

1181 
	`LOG_FUNC_RETURN
 (
Àngth
);

1186 
	`LOG_TRACE
(
ERROR
,

1188 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
);

1194 
	`LOG_TRACE
(
ERROR
,

1195 "Unknow¿£curôy hódîÅy≥ %u", 
£curôy_hódî_ty≥
);

1196 
	`LOG_FUNC_RETURN
 (0);

1198 
	`LOG_FUNC_RETURN
 (
Àngth
);

1199 
	}
}

1227 
UI¡32_t
 
	$_«s_mesßge_gë_mac
(

1228 c⁄° * c⁄° 
buf„r
,

1229 c⁄° 
Àngth
,

1230 c⁄° 
dúe˘i⁄
,

1231 c⁄° 
emm_£curôy_c⁄ãxt_t
 * c⁄° 
emm_£curôy_c⁄ãxt
)

1234 
LOG_FUNC_IN
;

1236 i‡(!
emm_£curôy_c⁄ãxt
) {

1237 
	`LOG_TRACE
(
DEBUG
,

1239 #i‡
	`deföed
(
EPC_BUILD
Ë|| deföed(
UE_BUILD
)

1240 
	`LOG_FUNC_RETURN
 (0);

1242 
	`LOG_FUNC_RETURN
 (0xabababab);

1246 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
öãgrôy
) {

1248 
NAS_SECURITY_ALGORITHMS_EIA1
: {

1249 
UI¡8_t
 
mac
[4];

1250 
«s_°ªam_cùhî_t
 
°ªam_cùhî
;

1251 
UI¡32_t
 
cou¡
;

1252 
UI¡32_t
 *
mac32
;

1254 
i
,
byãs
 = 0;

1256 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

1257 
cou¡
 = 0x00000000 ||

1258 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1259 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

1261 
cou¡
 = 0x00000000 ||

1262 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1263 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

1265 
	`LOG_TRACE
(
DEBUG
,

1267 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1268 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

1269 
cou¡
);

1271 
	`Ârötf
(
°dîr
, "\n[NAS]\t");

1273 
i
=0; i < 
Àngth
; i++)

1275 
	`Ârötf
(
°dîr
, "%.2hx ", (c⁄° Ë
buf„r
[
i
]);

1278 i‡–++
byãs
 > (16 - 1) ) {

1279 
byãs
 = 0;

1280 
	`Ârötf
(
°dîr
, "\n[NAS]\t");

1283 i‡(
byãs
 % 16) {

1284 
	`Ârötf
(
°dîr
, "\n");

1286 
	`Ârötf
(
°dîr
, "\n");

1287 
	`fÊush
(
°dîr
);

1289 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_öt
.
vÆue
;

1290 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_INT_SIZE
;

1291 
°ªam_cùhî
.
cou¡
 = count;

1292 
°ªam_cùhî
.
bóªr
 = 0x00;

1293 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

1294 
°ªam_cùhî
.
mesßge
 = 
buf„r
;

1296 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

1298 
	`«s_°ªam_í¸y±_eü1
(

1299 &
°ªam_cùhî
,

1300 
mac
);

1301 
	`LOG_TRACE
(
DEBUG
,

1303 
mac
[0], mac[1], mac[2],mac[3],

1304 *((
UI¡32_t
*)&
mac
),

1305 
Àngth
,

1306 
dúe˘i⁄
,

1307 
cou¡
);

1308 
mac32
 = (
UI¡32_t
*)&
mac
;

1309 
	`LOG_FUNC_RETURN
 (
	`¡ohl
(*
mac32
));

1312 
NAS_SECURITY_ALGORITHMS_EIA2
: {

1313 
UI¡8_t
 
mac
[4];

1314 
«s_°ªam_cùhî_t
 
°ªam_cùhî
;

1315 
UI¡32_t
 
cou¡
;

1316 
UI¡32_t
 *
mac32
;

1318 i‡(
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) {

1319 
cou¡
 = 0x00000000 ||

1320 ((
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1321 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
 & 0x000000FF);

1323 
cou¡
 = 0x00000000 ||

1324 ((
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
ovîÊow
 && 0x0000FFFF) << 8) ||

1325 (
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
 & 0x000000FF);

1327 
	`LOG_TRACE
(
DEBUG
,

1329 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1330 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num,

1331 
cou¡
);

1333 
°ªam_cùhî
.
key
 = 
emm_£curôy_c⁄ãxt
->
k«s_öt
.
vÆue
;

1334 
°ªam_cùhî
.
key_Àngth
 = 
AUTH_KNAS_INT_SIZE
;

1335 
°ªam_cùhî
.
cou¡
 = count;

1336 
°ªam_cùhî
.
bóªr
 = 0x00;

1337 
°ªam_cùhî
.
dúe˘i⁄
 = direction;

1338 
°ªam_cùhî
.
mesßge
 = 
buf„r
;

1340 
°ªam_cùhî
.
bÀngth
 = 
Àngth
 << 3;

1342 
	`«s_°ªam_í¸y±_eü2
(

1343 &
°ªam_cùhî
,

1344 
mac
);

1345 
	`LOG_TRACE
(
DEBUG
,

1347 
mac
[0], mac[1], mac[2],mac[3],

1348 *((
UI¡32_t
*)&
mac
),

1349 
Àngth
,

1350 
dúe˘i⁄
,

1351 
cou¡
);

1352 
mac32
 = (
UI¡32_t
*)&
mac
;

1353 
	`LOG_FUNC_RETURN
 (
	`¡ohl
(*
mac32
));

1356 
NAS_SECURITY_ALGORITHMS_EIA0
:

1357 
	`LOG_TRACE
(
DEBUG
,

1359 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
) ? "UPLINK":"DOWNLINK",

1360 (
dúe˘i⁄
 =
SECU_DIRECTION_UPLINK
Ë? 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
:emm_£curôy_c⁄ãxt->
dl_cou¡
.seq_num

1363 #i‡
	`deföed
(
EPC_BUILD
Ë|| deföed(
UE_BUILD
)

1364 
	`LOG_FUNC_RETURN
 (0);

1366 
	`LOG_FUNC_RETURN
 (0xabababab);

1371 
	`LOG_TRACE
(
ERROR
,

1373 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
öãgrôy
);

1376 
	`LOG_FUNC_RETURN
 (0);

1377 
	}
}

	@src/api/network/nas_message.h

47 #i‚de‡
__NAS_MESSAGE_H__


48 
	#__NAS_MESSAGE_H__


	)

50 
	~"comm⁄Def.h
"

51 
	~"emm_msg.h
"

52 #i‡
deföed
(
EPC_BUILD
)

53 
	~"emmD©a.h
"

55 
	~"esm_msg.h
"

61 
	#NAS_MESSAGE_SECURITY_HEADER_SIZE
 6

	)

69 #ifde‡
__LITTLE_ENDIAN_BITFIELD


70 
ïs_¥Ÿocﬁ_dis¸imö©‹_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

71 
UI¡8_t
 
	m£curôy_hódî_ty≥
:4;

73 #ifde‡
__BIG_ENDIAN_BITFIELD


74 
UI¡8_t
 
	m£curôy_hódî_ty≥
:4;

75 
UI¡8_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

77 
UI¡32_t
 
	mmesßge_authítiˇti⁄_code
;

78 
UI¡8_t
 
	m£quí˚_numbî
;

79 } 
	t«s_mesßge_£curôy_hódî_t
;

83 
EMM_msg
 
	memm
;

84 
ESM_msg
 
	mesm
;

85 } 
	t«s_mesßge_∂aö_t
;

89 
«s_mesßge_£curôy_hódî_t
 
	mhódî
;

90 
«s_mesßge_∂aö_t
 
	m∂aö
;

91 } 
	t«s_mesßge_£curôy_¥Ÿe˘ed_t
;

97 
«s_mesßge_£curôy_hódî_t
 
	mhódî
;

98 
«s_mesßge_£curôy_¥Ÿe˘ed_t
 
	m£curôy_¥Ÿe˘ed
;

99 
«s_mesßge_∂aö_t
 
	m∂aö
;

100 } 
	t«s_mesßge_t
;

110 
«s_mesßge_í¸y±
(

111 c⁄° *
öbuf
,

112 *
outbuf
,

113 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

114 
Àngth
,

115 *
£curôy
);

117 
«s_mesßge_de¸y±
(c⁄° *
öbuf
,

118 *
outbuf
,

119 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

120 
Àngth
,

121 *
£curôy
);

123 
«s_mesßge_decode
(

124 c⁄° * c⁄° 
buf„r
,

125 
«s_mesßge_t
 *
msg
,

126 
Àngth
,

127 *
£curôy
);

129 
«s_mesßge_ícode
(

130 *
buf„r
,

131 c⁄° 
«s_mesßge_t
 * c⁄° 
msg
,

132 
Àngth
,

133 *
£curôy
);

	@src/api/network/network_api.c

48 
	~"√tw‹k_≠i.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

51 
	~"sockë.h
"

53 
	~"as_mesßge.h
"

55 
	~<°rög.h
>

56 
	~<√tdb.h
>

57 
	~<î∫o.h
>

58 
	~<uni°d.h
>

83 * 
	mídpoöt
;

85 * (*
	m›í
) (, const *, const *);

86 (*
	mgëfd
)(const *);

87 
ssize_t
 (*
ªcv
Ë(*, *, 
	msize_t
);

88 
ssize_t
 (*
£nd
Ë(c⁄° *, c⁄° *, 
	msize_t
);

89 (*
	m˛o£
)(*);

90 } 
	g_√tw‹k_≠i_id
;

92 
	#NETWORK_API_OPEN
(
a
, 
b
, 
c
Ë
_√tw‹k_≠i_id
.
	`›í
◊, b, c)

	)

93 
	#NETWORK_API_GETFD
(Ë
_√tw‹k_≠i_id
.
	`gëfd
(_√tw‹k_≠i_id.
ídpoöt
)

	)

94 
	#NETWORK_API_RECV
(
a
, 
b
Ë
_√tw‹k_≠i_id
.
	`ªcv
(_√tw‹k_≠i_id.
ídpoöt
,á, b)

	)

95 
	#NETWORK_API_SEND
(
a
, 
b
Ë
_√tw‹k_≠i_id
.
	`£nd
(_√tw‹k_≠i_id.
ídpoöt
,á, b)

	)

96 
	#NETWORK_API_CLOSE
(Ë
_√tw‹k_≠i_id
.
	`˛o£
(_√tw‹k_≠i_id.
ídpoöt
)

	)

101 
	#NETWORK_API_RECV_BUFFER_SIZE
 4096

	)

102 
	g_√tw‹k_≠i_ªcv_buf„r
[
NETWORK_API_RECV_BUFFER_SIZE
];

107 
	#NETWORK_API_SEND_BUFFER_SIZE
 
NETWORK_API_RECV_BUFFER_SIZE


	)

108 
	g_√tw‹k_≠i_£nd_buf„r
[
NETWORK_API_SEND_BUFFER_SIZE
];

113 
as_mesßge_t
 
	g_as_d©a
 = {};

135 
	$√tw‹k_≠i_öôülize
(c⁄° * 
ho°
, c⁄° * 
p‹t
)

137 
LOG_FUNC_IN
;

140 
_√tw‹k_≠i_id
.
›í
 = 
sockë_udp_›í
;

141 
_√tw‹k_≠i_id
.
gëfd
 = 
sockë_gë_fd
;

142 
_√tw‹k_≠i_id
.
ªcv
 = 
sockë_ªcv
;

143 
_√tw‹k_≠i_id
.
£nd
 = 
sockë_£nd
;

144 
_√tw‹k_≠i_id
.
˛o£
 = 
sockë_˛o£
;

146 #ifde‡
NAS_UE


147 
_√tw‹k_≠i_id
.
ídpoöt
 = 
	`NETWORK_API_OPEN
(
SOCKET_CLIENT
, 
ho°
, 
p‹t
);

149 #ifde‡
NAS_MME


150 
_√tw‹k_≠i_id
.
ídpoöt
 = 
	`NETWORK_API_OPEN
(
SOCKET_SERVER
, 
NULL
, 
p‹t
);

152 i‡(
_√tw‹k_≠i_id
.
ídpoöt
 =
NULL
) {

153 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

154 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

155 
	`LOG_TRACE
(
ERROR
, "NET-API - FailedÅo open connectionÉndpoint, %s",

156 
îr‹
);

157 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

160 
	`gëho°«me
(
_√tw‹k_≠i_£nd_buf„r
, 
NETWORK_API_SEND_BUFFER_SIZE
);

161 
	`LOG_TRACE
(
INFO
, "NET-API - Network's UDP socket %d is BOUNDÅo %s/%s",

162 
	`√tw‹k_≠i_gë_fd
(), 
_√tw‹k_≠i_£nd_buf„r
, 
p‹t
);

164 
	`LOG_FUNC_RETURN
 (
RETURNok
);

165 
	}
}

182 
	$√tw‹k_≠i_gë_fd
()

184 
LOG_FUNC_IN
;

185 
	`LOG_FUNC_RETURN
 (
	`NETWORK_API_GETFD
());

186 
	}
}

203 c⁄° * 
	$√tw‹k_≠i_gë_d©a
()

205 
LOG_FUNC_IN
;

206 
	`LOG_FUNC_RETURN
 ((*)(&
_as_d©a
));

207 
	}
}

224 
	$√tw‹k_≠i_ªad_d©a
(
fd
)

226 
LOG_FUNC_IN
;

228 
rbyãs
;

231 
sfd
 = 
	`√tw‹k_≠i_gë_fd
();

232 i‡(
fd
 !
sfd
) {

233 
	`LOG_TRACE
(
ERROR
, "NET-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhê√tw‹k subœyî (%d)", 
fd
, 
sfd
);

234 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

237 
	`mem£t
(
_√tw‹k_≠i_ªcv_buf„r
, 0, 
NETWORK_API_RECV_BUFFER_SIZE
);

240 
rbyãs
 = 
	`NETWORK_API_RECV
(
_√tw‹k_≠i_ªcv_buf„r
,

241 
NETWORK_API_RECV_BUFFER_SIZE
);

242 i‡(
rbyãs
 =
RETURNîr‹
) {

243 
	`LOG_TRACE
(
ERROR
, "NET-API -Ñecv(ËÁûed, %s", 
	`°ªº‹
(
î∫o
));

244 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

246 i‡(
rbyãs
 == 0) {

247 
	`LOG_TRACE
(
WARNING
, "NET-API - A signal was caught");

250 
	`LOG_TRACE
(
INFO
, "NET-API - %d bytesÑeceived fromÅheÇetwork "

251 "subœyî", 
rbyãs
);

252 
	`LOG_DUMP
(
_√tw‹k_≠i_ªcv_buf„r
, 
rbyãs
);

255 
	`LOG_FUNC_RETURN
 (
rbyãs
);

256 
	}
}

274 
	$√tw‹k_≠i_£nd_d©a
(
fd
, 
Àngth
)

276 
LOG_FUNC_IN
;

278 
sbyãs
;

281 
sfd
 = 
	`√tw‹k_≠i_gë_fd
();

282 i‡(
fd
 !
sfd
) {

283 
	`LOG_TRACE
(
ERROR
, "NET-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhê√tw‹k subœyî (%d)", 
fd
, 
sfd
);

284 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

288 
sbyãs
 = 
	`NETWORK_API_SEND
(
_√tw‹k_≠i_£nd_buf„r
, 
Àngth
);

289 i‡(
sbyãs
 =
RETURNîr‹
) {

290 
	`LOG_TRACE
(
ERROR
, "NET-API - síd(ËÁûed, %s", 
	`°ªº‹
(
î∫o
));

291 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

293 i‡(
sbyãs
 == 0) {

294 
	`LOG_TRACE
(
WARNING
, "NET-API - A signal was caught");

297 
	`LOG_TRACE
(
INFO
, "NET-API - %d bytes sentÅoÅheÇetwork sublayer",

298 
sbyãs
);

299 
	`LOG_DUMP
(
_√tw‹k_≠i_£nd_buf„r
, 
sbyãs
);

302 
	`LOG_FUNC_RETURN
 (
sbyãs
);

303 
	}
}

321 
	$√tw‹k_≠i_˛o£
(
fd
)

323 
LOG_FUNC_IN
;

326 
sfd
 = 
	`√tw‹k_≠i_gë_fd
();

327 i‡(
fd
 !
sfd
) {

328 
	`LOG_TRACE
(
ERROR
, "NET-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhê√tw‹k subœyî (%d)", 
fd
, 
sfd
);

329 
LOG_FUNC_OUT
;

334 
	`NETWORK_API_CLOSE
();

335 
_√tw‹k_≠i_id
.
ídpoöt
 = 
NULL
;

337 
LOG_FUNC_OUT
;

338 
	}
}

356 
	$√tw‹k_≠i_decode_d©a
(
Àngth
)

358 
LOG_FUNC_IN
;

361 
as_id
 = 
	`as_mesßge_decode
(
_√tw‹k_≠i_ªcv_buf„r
, &
_as_d©a
, 
Àngth
);

363 i‡(
as_id
 !
RETURNîr‹
) {

364 
	`LOG_TRACE
(
INFO
, "NET-API - AS message id=0x%x successfully decoded",

365 
as_id
);

367 
	`LOG_FUNC_RETURN
 (
as_id
);

368 
	}
}

385 
	$√tw‹k_≠i_ícode_d©a
(* 
d©a
)

387 
LOG_FUNC_IN
;

390 
byãs
 = 
	`as_mesßge_ícode
(
_√tw‹k_≠i_£nd_buf„r
,

391 (
as_mesßge_t
*)(
d©a
),

392 
NETWORK_API_SEND_BUFFER_SIZE
);

394 i‡(
byãs
 !
RETURNîr‹
) {

395 
	`LOG_TRACE
(
INFO
, "NET-API - %d byã†ícoded", 
byãs
);

397 
	`LOG_FUNC_RETURN
 (
byãs
);

398 
	}
}

416 
	$as_mesßge_£nd
(
as_mesßge_t
* 
as_msg
)

418 
byãs
;

419 
LOG_FUNC_IN
;

421 
	`LOG_TRACE
(
INFO
, "NET-API - Send message 0x%.4xÅoÅhe Access Stratum "

422 "œyî", 
as_msg
->
msgID
);

425 
byãs
 = 
	`√tw‹k_≠i_ícode_d©a
(
as_msg
);

427 i‡(
byãs
 > 0) {

429 
fd
 = 
	`√tw‹k_≠i_gë_fd
();

430 i‡(
fd
 !
RETURNîr‹
) {

432 
byãs
 = 
	`√tw‹k_≠i_£nd_d©a
(
fd
, bytes);

436 
	`LOG_FUNC_RETURN
 (
byãs
);

437 
	}
}

	@src/api/network/network_api.h

47 #i‚de‡
__NETWORK_API_H__


48 
	#__NETWORK_API_H__


	)

66 
√tw‹k_≠i_öôülize
(c⁄° * 
ho°
, c⁄° * 
p‹t
);

68 
√tw‹k_≠i_gë_fd
();

69 c⁄° * 
√tw‹k_≠i_gë_d©a
();

71 
√tw‹k_≠i_ªad_d©a
(
fd
);

72 
√tw‹k_≠i_£nd_d©a
(
fd
, 
Àngth
);

73 
√tw‹k_≠i_˛o£
(
fd
);

75 
√tw‹k_≠i_decode_d©a
(
Àngth
);

76 
√tw‹k_≠i_ícode_d©a
(* 
d©a
);

	@src/api/user/at_command.c

48 
	~"©_comm™d.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 
	~"©_îr‹.h
"

54 
	~<˘y≥.h
>

55 
	~<°dlib.h
>

56 
	~<°rög.h
>

58 
	~<°d¨g.h
>

64 
©_ª•⁄£_f‹m©_v1
;

65 
©_îr‹_code_suµªssi⁄_q1
;

66 
©_îr‹_f‹m©_t
 
©_îr‹_f‹m©
;

73 
∑r£_e0
(c⁄° *, , 
©_comm™d_t
*);

74 
∑r£_e1
(c⁄° *, , 
©_comm™d_t
*);

75 
∑r£_q0
(c⁄° *, , 
©_comm™d_t
*);

76 
∑r£_q1
(c⁄° *, , 
©_comm™d_t
*);

77 
∑r£_v0
(c⁄° *, , 
©_comm™d_t
*);

78 
∑r£_v1
(c⁄° *, , 
©_comm™d_t
*);

79 
∑r£_cg¢
(c⁄° *, , 
©_comm™d_t
*);

80 
∑r£_cg¢_ã°
(c⁄° *, , 
©_comm™d_t
*);

81 
∑r£_cgmi
(c⁄° *, , 
©_comm™d_t
*);

82 
∑r£_cgmi_ã°
(c⁄° *, , 
©_comm™d_t
*);

83 
∑r£_cgmm
(c⁄° *, , 
©_comm™d_t
*);

84 
∑r£_cgmm_ã°
(c⁄° *, , 
©_comm™d_t
*);

85 
∑r£_cgmr
(c⁄° *, , 
©_comm™d_t
*);

86 
∑r£_cgmr_ã°
(c⁄° *, , 
©_comm™d_t
*);

87 
∑r£_cimi
(c⁄° *, , 
©_comm™d_t
*);

88 
∑r£_cimi_ã°
(c⁄° *, , 
©_comm™d_t
*);

89 
∑r£_cfun_£t
(c⁄° *, , 
©_comm™d_t
*);

90 
∑r£_cfun_gë
(c⁄° *, , 
©_comm™d_t
*);

91 
∑r£_cfun_ã°
(c⁄° *, , 
©_comm™d_t
*);

92 
∑r£_˝ö_£t
(c⁄° *, , 
©_comm™d_t
*);

93 
∑r£_˝ö_gë
(c⁄° *, , 
©_comm™d_t
*);

94 
∑r£_˝ö_ã°
(c⁄° *, , 
©_comm™d_t
*);

95 
∑r£_csq
(c⁄° *, , 
©_comm™d_t
*);

96 
∑r£_csq_ã°
(c⁄° *, , 
©_comm™d_t
*);

97 
∑r£_˚sq
(c⁄° *, , 
©_comm™d_t
*);

98 
∑r£_˚sq_ã°
(c⁄° *, , 
©_comm™d_t
*);

99 
∑r£_˛ac
(c⁄° *, , 
©_comm™d_t
*);

100 
∑r£_˛ac_ã°
(c⁄° *, , 
©_comm™d_t
*);

101 
∑r£_cmì_£t
(c⁄° *, , 
©_comm™d_t
*);

102 
∑r£_cmì_gë
(c⁄° *, , 
©_comm™d_t
*);

103 
∑r£_cmì_ã°
(c⁄° *, , 
©_comm™d_t
*);

104 
∑r£_˙um
(c⁄° *, , 
©_comm™d_t
*);

105 
∑r£_˙um_ã°
(c⁄° *, , 
©_comm™d_t
*);

106 
∑r£_˛ck_£t
(c⁄° *, , 
©_comm™d_t
*);

107 
∑r£_˛ck_ã°
(c⁄° *, , 
©_comm™d_t
*);

108 
∑r£_c›s_£t
(c⁄° *, , 
©_comm™d_t
*);

109 
∑r£_c›s_gë
(c⁄° *, , 
©_comm™d_t
*);

110 
∑r£_c›s_ã°
(c⁄° *, , 
©_comm™d_t
*);

111 
∑r£_¸eg_£t
(c⁄° *, , 
©_comm™d_t
*);

112 
∑r£_¸eg_gë
(c⁄° *, , 
©_comm™d_t
*);

113 
∑r£_¸eg_ã°
(c⁄° *, , 
©_comm™d_t
*);

114 
∑r£_cg©t_£t
(c⁄° *, , 
©_comm™d_t
*);

115 
∑r£_cg©t_gë
(c⁄° *, , 
©_comm™d_t
*);

116 
∑r£_cg©t_ã°
(c⁄° *, , 
©_comm™d_t
*);

117 
∑r£_cgªg_£t
(c⁄° *, , 
©_comm™d_t
*);

118 
∑r£_cgªg_gë
(c⁄° *, , 
©_comm™d_t
*);

119 
∑r£_cgªg_ã°
(c⁄° *, , 
©_comm™d_t
*);

120 
∑r£_˚ªg_£t
(c⁄° *, , 
©_comm™d_t
*);

121 
∑r£_˚ªg_gë
(c⁄° *, , 
©_comm™d_t
*);

122 
∑r£_˚ªg_ã°
(c⁄° *, , 
©_comm™d_t
*);

123 
∑r£_cgdc⁄t_£t
(c⁄° *, , 
©_comm™d_t
*);

124 
∑r£_cgdc⁄t_gë
(c⁄° *, , 
©_comm™d_t
*);

125 
∑r£_cgdc⁄t_ã°
(c⁄° *, , 
©_comm™d_t
*);

126 
∑r£_cga˘_£t
(c⁄° *, , 
©_comm™d_t
*);

127 
∑r£_cga˘_gë
(c⁄° *, , 
©_comm™d_t
*);

128 
∑r£_cga˘_ã°
(c⁄° *, , 
©_comm™d_t
*);

129 
∑r£_cg∑ddr_£t
(c⁄° *, , 
©_comm™d_t
*);

130 
∑r£_cg∑ddr_ã°
(c⁄° *, , 
©_comm™d_t
*);

134 *
	mcomm™d
;

135 (*
	mh™dÀr
)(c⁄° *, , 
	m©_comm™d_t
*);

136 
©_comm™d_ty≥_t
 
	mty≥
;

137 } 
	t©_comm™d_h™dÀr_t
;

139 c⁄° 
©_comm™d_h™dÀr_t
 
	g_©_comm™d_h™dÀr
[] = {

141 { "E0", 
∑r£_e0
, 
AT_COMMAND_ACT
 },

142 { "E1", 
∑r£_e1
, 
AT_COMMAND_ACT
 },

143 { "Q0", 
∑r£_q0
, 
AT_COMMAND_ACT
 },

144 { "Q1", 
∑r£_q1
, 
AT_COMMAND_ACT
 },

145 { "V0", 
∑r£_v0
, 
AT_COMMAND_ACT
 },

146 { "V1", 
∑r£_v1
, 
AT_COMMAND_ACT
 },

147 { "E0Q0V0", 
∑r£_v0
, 
AT_COMMAND_ACT
 },

148 { "E0Q0V1", 
∑r£_v1
, 
AT_COMMAND_ACT
 },

149 { "E1Q0V0", 
∑r£_v0
, 
AT_COMMAND_ACT
 },

150 { "E1Q0V1", 
∑r£_v1
, 
AT_COMMAND_ACT
 },

152 { "+CGSN", 
∑r£_cg¢
, 
AT_COMMAND_ACT
 },

153 { "+CGSN=?", 
∑r£_cg¢_ã°
, 
AT_COMMAND_TST
 },

155 { "+CGMI", 
∑r£_cgmi
, 
AT_COMMAND_ACT
 },

156 { "+CGMI=?", 
∑r£_cgmi_ã°
, 
AT_COMMAND_TST
 },

158 { "+CGMM", 
∑r£_cgmm
, 
AT_COMMAND_ACT
 },

159 { "+CGMM=?", 
∑r£_cgmm_ã°
, 
AT_COMMAND_TST
 },

161 { "+CGMR", 
∑r£_cgmr
, 
AT_COMMAND_ACT
 },

162 { "+CGMR=?", 
∑r£_cgmr_ã°
, 
AT_COMMAND_TST
 },

164 { "+CIMI", 
∑r£_cimi
, 
AT_COMMAND_ACT
 },

165 { "+CIMI=?", 
∑r£_cimi_ã°
, 
AT_COMMAND_TST
 },

167 { "+CFUN=", 
∑r£_cfun_£t
, 
AT_COMMAND_SET
 },

168 { "+CFUN?", 
∑r£_cfun_gë
, 
AT_COMMAND_GET
 },

169 { "+CFUN=?", 
∑r£_cfun_ã°
, 
AT_COMMAND_TST
 },

171 { "+CPIN=", 
∑r£_˝ö_£t
, 
AT_COMMAND_SET
 },

172 { "+CPIN?", 
∑r£_˝ö_gë
, 
AT_COMMAND_GET
 },

173 { "+CPIN=?", 
∑r£_˝ö_ã°
, 
AT_COMMAND_TST
 },

175 { "+CSQ", 
∑r£_csq
, 
AT_COMMAND_ACT
 },

176 { "+CSQ=?", 
∑r£_csq_ã°
, 
AT_COMMAND_TST
 },

178 { "+CESQ", 
∑r£_˚sq
, 
AT_COMMAND_ACT
 },

179 { "+CESQ=?", 
∑r£_˚sq_ã°
, 
AT_COMMAND_TST
 },

181 { "+CLAC", 
∑r£_˛ac
, 
AT_COMMAND_ACT
 },

182 { "+CLAC=?", 
∑r£_˛ac_ã°
, 
AT_COMMAND_TST
 },

184 { "+CMEE=", 
∑r£_cmì_£t
, 
AT_COMMAND_SET
 },

185 { "+CMEE?", 
∑r£_cmì_gë
, 
AT_COMMAND_GET
 },

186 { "+CMEE=?", 
∑r£_cmì_ã°
, 
AT_COMMAND_TST
 },

188 { "+CNUM", 
∑r£_˙um
, 
AT_COMMAND_ACT
 },

189 { "+CNUM=?", 
∑r£_˙um_ã°
, 
AT_COMMAND_TST
 },

191 { "+CLCK=", 
∑r£_˛ck_£t
, 
AT_COMMAND_SET
 },

192 { "+CLCK=?", 
∑r£_˛ck_ã°
, 
AT_COMMAND_TST
 },

194 { "+COPS=", 
∑r£_c›s_£t
, 
AT_COMMAND_SET
 },

195 { "+COPS?", 
∑r£_c›s_gë
, 
AT_COMMAND_GET
 },

196 { "+COPS=?", 
∑r£_c›s_ã°
, 
AT_COMMAND_TST
 },

198 { "+CREG=", 
∑r£_¸eg_£t
, 
AT_COMMAND_SET
 },

199 { "+CREG?", 
∑r£_¸eg_gë
, 
AT_COMMAND_GET
 },

200 { "+CREG=?", 
∑r£_¸eg_ã°
, 
AT_COMMAND_TST
 },

202 { "+CGATT=", 
∑r£_cg©t_£t
, 
AT_COMMAND_SET
 },

203 { "+CGATT?", 
∑r£_cg©t_gë
, 
AT_COMMAND_GET
 },

204 { "+CGATT=?", 
∑r£_cg©t_ã°
, 
AT_COMMAND_TST
 },

206 { "+CGREG=", 
∑r£_cgªg_£t
, 
AT_COMMAND_SET
 },

207 { "+CGREG?", 
∑r£_cgªg_gë
, 
AT_COMMAND_GET
 },

208 { "+CGREG=?", 
∑r£_cgªg_ã°
, 
AT_COMMAND_TST
 },

210 { "+CEREG=", 
∑r£_˚ªg_£t
, 
AT_COMMAND_SET
 },

211 { "+CEREG?", 
∑r£_˚ªg_gë
, 
AT_COMMAND_GET
 },

212 { "+CEREG=?", 
∑r£_˚ªg_ã°
, 
AT_COMMAND_TST
 },

214 { "+CGDCONT=", 
∑r£_cgdc⁄t_£t
, 
AT_COMMAND_SET
 },

215 { "+CGDCONT?", 
∑r£_cgdc⁄t_gë
, 
AT_COMMAND_GET
 },

216 { "+CGDCONT=?", 
∑r£_cgdc⁄t_ã°
, 
AT_COMMAND_TST
 },

218 { "+CGACT=", 
∑r£_cga˘_£t
, 
AT_COMMAND_SET
 },

219 { "+CGACT?", 
∑r£_cga˘_gë
, 
AT_COMMAND_GET
 },

220 { "+CGACT=?", 
∑r£_cga˘_ã°
, 
AT_COMMAND_TST
 },

222 { "+CGPADDR=", 
∑r£_cg∑ddr_£t
, 
AT_COMMAND_SET
 },

223 { "+CGPADDR=?", 
∑r£_cg∑ddr_ã°
, 
AT_COMMAND_TST
 },

225 { "nuŒ", 
NULL
 }

228 
P¨£Såög
(* 
©_°r
, 
©_comm™d_t
* 
©_comm™d
);

229 
P¨£Comm™d
(c⁄° *
°r
, c⁄° *
f‹m©
, ...);

230 
size_t
 
GøbSåög
(c⁄° *
°r
, **
ouçut
);

231 
NumbîOfP¨amëîs
(c⁄° * 
°r
);

232 
IsNumîic
(c⁄° * 
°r
, 
size_t
 
Àn
);

258 
	$©_comm™d_decode
(c⁄° * 
buf„r
, 
Àngth
, 
©_comm™d_t
* 
©_comm™d
)

260 
LOG_FUNC_IN
;

262 
rc
 = 
RETURNok
;

264 i‡(
Àngth
 < 3) {

266 
	`LOG_TRACE
(
ERROR
, "USR-API - Input is short of sizeÅo carryán AT command!");

267  
RETURNîr‹
;

268 } i‡(
	`°∫ˇ£cmp
(
buf„r
, "AT", 2) != 0) {

270 
	`LOG_TRACE
(
ERROR
, "USR-API - There isÇoÖroper initials (AT) in input!");

271  
RETURNîr‹
;

272 } i‡(
buf„r
[
Àngth
 - 1] != '\r') {

274 
	`LOG_TRACE
(
ERROR
, "USR-API - There isÇo Carriage ReturnátÅheÉnd!");

275  
RETURNîr‹
;

276 } i‡(
	`°rˇ£cmp
(
buf„r
, "AT\r") == 0) {

278 
©_comm™d
->
id
 = 0;

279 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

284 
i
;

285 * 
buf
 = 
	`°rdup
(
buf„r
+2);

286 * 
cmd
 = 
	`°πok
(
buf
, ";");

287 
i
=0; 
cmd
 && (
rc
 !
RETURNîr‹
); i++) {

288 
rc
 = 
	`P¨£Såög
(
cmd
, &
©_comm™d
[
i
]);

289 
cmd
 = 
	`°πok
(
NULL
, ";");

291 
	`‰ì
(
buf
);

293 i‡(
rc
 !
RETURNîr‹
) {

294 
	`LOG_FUNC_RETURN
 (
i
);

296 
	`LOG_FUNC_RETURN
 (
rc
);

297 
	}
}

318 
	$©_comm™d_gë_li°
(c⁄° ** 
buf„r
, 
n_max
)

320 
LOG_FUNC_IN
;

322 
h™dÀr_ödex
 = 0;

323  (
	`°rcmp
(
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].
comm™d
, "null") != 0) &&

324 (
h™dÀr_ödex
 < 
n_max
) )

326 *
buf„r
++ = 
_©_comm™d_h™dÀr
[
h™dÀr_ödex
++].
comm™d
;

329 
	`LOG_FUNC_RETURN
 (
h™dÀr_ödex
);

330 
	}
}

354 
	$P¨£Såög
(* 
©_°r
, 
©_comm™d_t
* 
©_comm™d
)

356 * 
ãrmöÆ_ch¨a˘î_ödex
 = 
NULL
;

357 
num_of_ch¨s_to_com∑ª
 = -1;

358 
h™dÀr_ödex
;

359 
h™dÀr_found
 = 
FALSE
;

360 
check_f‹_ˇºüge_ªtu∫_ödex
 = 0;

366 i‡((
ãrmöÆ_ch¨a˘î_ödex
 = 
	`°r°r
(
©_°r
, "=?")Ë!
NULL
) {

368 
num_of_ch¨s_to_com∑ª
 = 
ãrmöÆ_ch¨a˘î_ödex
 - 
©_°r
 + 2;

369 
check_f‹_ˇºüge_ªtu∫_ödex
 = 1;

370 
©_comm™d
->
ty≥
 = 
AT_COMMAND_TST
;

371 } i‡((
ãrmöÆ_ch¨a˘î_ödex
 = 
	`°rchr
(
©_°r
, '?')Ë!
NULL
) {

373 
num_of_ch¨s_to_com∑ª
 = 
ãrmöÆ_ch¨a˘î_ödex
 - 
©_°r
 + 1;

374 
check_f‹_ˇºüge_ªtu∫_ödex
 = 1;

375 
©_comm™d
->
ty≥
 = 
AT_COMMAND_GET
;

376 } i‡((
ãrmöÆ_ch¨a˘î_ödex
 = 
	`°rchr
(
©_°r
, '=')Ë!
NULL
) {

378 
num_of_ch¨s_to_com∑ª
 = 
ãrmöÆ_ch¨a˘î_ödex
 - 
©_°r
 + 1;

379 
©_comm™d
->
ty≥
 = 
AT_COMMAND_SET
;

380 } i‡((
ãrmöÆ_ch¨a˘î_ödex
 = 
	`°rchr
(
©_°r
, '\r')Ë!
NULL
) {

382 
num_of_ch¨s_to_com∑ª
 = 
ãrmöÆ_ch¨a˘î_ödex
 - 
©_°r
;

383 
check_f‹_ˇºüge_ªtu∫_ödex
 = 1;

384 
©_comm™d
->
ty≥
 = 
AT_COMMAND_ACT
;

387 
num_of_ch¨s_to_com∑ª
 = 
	`°rchr
(
©_°r
, '\0') -át_str;

388 
©_comm™d
->
ty≥
 = 
AT_COMMAND_ACT
;

396 i‡(
check_f‹_ˇºüge_ªtu∫_ödex
 == 1) {

397 i‡–(
©_°r
[
num_of_ch¨s_to_com∑ª
] != '\0') &&

398 (
©_°r
[
num_of_ch¨s_to_com∑ª
] != '\r') ) {

399 
	`LOG_TRACE
(
ERROR
, "USR-API - CarriageÑeturn isÇotát where it should be!");

400  
RETURNîr‹
;

405 
h™dÀr_ödex
=0;

406 
	`°rcmp
(
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].
comm™d
, "null") != 0;

407 
h™dÀr_ödex
++)

410 i‡(
©_comm™d
->
ty≥
 !
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].type)

413 i‡(
	`°æí
(
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].
comm™d
) !=

414 
num_of_ch¨s_to_com∑ª
) ;

416 i‡(
	`°∫ˇ£cmp
(
©_°r
, 
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].
comm™d
,

417 
num_of_ch¨s_to_com∑ª
) != 0) ;

418 
h™dÀr_found
 = 
TRUE
;

423 i‡(!
h™dÀr_found
) {

424 
	`LOG_TRACE
(
ERROR
, "USR-API - Unsupported or invalid command!");

425  
RETURNîr‹
;

428  
_©_comm™d_h™dÀr
[
h™dÀr_ödex
].
	`h™dÀr
(
©_°r
,

429 
num_of_ch¨s_to_com∑ª
,

430 
©_comm™d
);

431 
	}
}

449 
	$P¨£Comm™d
(c⁄° *
°r
, c⁄° *
f‹m©
, ...)

451 c⁄° *
fmt
 = (*Ë
f‹m©
;

452 c⁄° *
öp
 = (*Ë
°r
;

453 *
íd±r
;

454 *
out_us
;

455 *
buf„r
;

456 
size_t
 
Àngth
;

457 
size_t
 
°‹age_size
;

458 *
out_i
;

459 *
out_l
;

460 
va_li°
 
≠
;

461 
îr‹
 = 
RETURNok
;

463 
	`va_°¨t
(
≠
, 
f‹m©
);

464 *
fmt
) {

465 *
fmt
++)

468 i‡(*
fmt
 == 0) {

470 
	`LOG_TRACE
(
ERROR
, "USR-API - Invalid format string!");

471 
îr‹
 = 
RETURNîr‹
;

472 
íd
;

474 *
fmt
++)

477 
out_i
 = 
	`va_¨g
(
≠
, *);

478 *
out_i
 = 
	`°πﬁ
(
öp
, &
íd±r
, 10);

479 i‡(
íd±r
 =
öp
) {

480 
îr‹
 = 
RETURNîr‹
;

481 
íd
;

483 
öp
 = 
íd±r
;

486 
out_i
 = 
	`va_¨g
(
≠
, *);

487 *
out_i
 = 
	`°πﬁ
(
öp
, &
íd±r
, 10);

488 i‡(
íd±r
 =
öp
) {

491 
	`LOG_TRACE
(
WARNING
, "USR-API - NumberÉmpty!");

492 *
out_i
 = 0;

494 
öp
 = 
íd±r
;

498 
out_l
 = 
	`va_¨g
(
≠
, *);

499 *
out_l
 = 
	`°πﬁ
(
öp
, &
íd±r
, 10);

500 i‡(
íd±r
 =
öp
) {

501 
îr‹
 = 
RETURNîr‹
;

502 
íd
;

504 
öp
 = 
íd±r
;

507 
out_us
 = 
	`va_¨g
(
≠
, *);

508 
°‹age_size
 = 
	`va_¨g
(
≠
, 
size_t
);

509 
Àngth
 = 
	`GøbSåög
((*Ë
öp
, &
buf„r
);

510 i‡(
	`°æí
(
buf„r
Ë> 
°‹age_size
) {

511 
	`‰ì
(
buf„r
);

512 
îr‹
 = 
RETURNîr‹
;

513 
íd
;

515 
	`°r˝y
(
out_us
, 
buf„r
);

516 
	`‰ì
(
buf„r
);

517 
öp
 +
Àngth
;

520 i‡(*
öp
++ != '@') {

521 
îr‹
 = 
RETURNîr‹
;

522 
íd
;

527 
íd
;

530 
îr‹
 = 
RETURNîr‹
;

531 
íd
;

536 
	`is•a˚
(*
öp
))

537 
öp
++;

541 i‡(*
öp
++ !*(
fmt
 - 1)) {

542 
îr‹
 = 
RETURNîr‹
;

543 
íd
;

550 
	`is•a˚
(*
öp
))

551 
öp
++;

553 i‡(*
öp
 != 0) {

554 
îr‹
 = 
RETURNîr‹
;

555 
íd
;

558 
íd
: 
	`va_íd
(
≠
);

560  
îr‹
;

561 
	}
}

577 
size_t
 
	$GøbSåög
(c⁄° *
°r
, **
ouçut
)

579 
size_t
 
size
 = 4, 
posôi⁄
 = 0;

580 
öside_quŸes
 = 0;

583 *
ouçut
 = 
	`mÆloc
(
size
);

584 i‡(*
ouçut
 =
NULL
) {

588 
öside_quŸes
 || (*
°r
 != ',' && *str != ')' &&

589 *
°r
 != 0x0d && *str != 0x0a && *str != 0x00))

592 i‡(*
°r
 == '"') {

593 
öside_quŸes
 = !inside_quotes;

597 i‡(
posôi⁄
 + 2 > 
size
) {

598 
size
 += 10;

599 *
ouçut
 = 
	`ªÆloc
(*ouçut, 
size
);

600 i‡(*
ouçut
 =
NULL
) {

606 (*
ouçut
)[
posôi⁄
] = *
°r
;

607 
posôi⁄
++;

608 
°r
++;

611 (*
ouçut
)[
posôi⁄
] = 0;

614 i‡((*
ouçut
)[0] ='"' && (*ouçut)[
posôi⁄
 - 1]) {

615 
	`memmove
(*
ouçut
, (*ouçutË+ 1, 
posôi⁄
 - 2);

616 (*
ouçut
)[
posôi⁄
 - 2] = 0;

619  
posôi⁄
;

620 
	}
}

638 
	$NumbîOfP¨amëîs
(c⁄° * 
°r
)

640 i‡(*
°r
 == '\r')

643 
cou¡
 = 1;

644 *
°r
) {

645 i‡(*
°r
++ == ',') {

646 ++
cou¡
;

649  
cou¡
;

650 
	}
}

666 
	$IsNumîic
(c⁄° * 
°r
, 
size_t
 
Àn
)

668 
Àn
-- > 0) {

669 i‡(!
	`isdigô
(
°r
[
Àn
])) {

670  
FALSE
;

673  
TRUE
;

674 
	}
}

680 
	$∑r£_e0
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

683 
©_comm™d
->
id
 = 0;

684 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

685  
©_comm™d
->
id
;

686 
	}
}

688 
	$∑r£_e1
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

691 
©_comm™d
->
id
 = 0;

692 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

693  
©_comm™d
->
id
;

694 
	}
}

696 
	$∑r£_q0
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

699 
©_îr‹_code_suµªssi⁄_q1
 = 
FALSE
;

700 
©_comm™d
->
id
 = 0;

701 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

702  
©_comm™d
->
id
;

703 
	}
}

705 
	$∑r£_q1
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

708 
©_îr‹_code_suµªssi⁄_q1
 = 
TRUE
;

709 
©_comm™d
->
id
 = 0;

710 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

711  
©_comm™d
->
id
;

712 
	}
}

714 
	$∑r£_v0
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

717 
©_îr‹_f‹m©
 = 
AT_ERROR_NUMERIC
;

718 
©_ª•⁄£_f‹m©_v1
 = 
FALSE
;

719 
©_comm™d
->
id
 = 0;

720 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

721  
©_comm™d
->
id
;

722 
	}
}

724 
	$∑r£_v1
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

727 
©_îr‹_f‹m©
 = 
AT_ERROR_VERBOSE
;

728 
©_ª•⁄£_f‹m©_v1
 = 
TRUE
;

729 
©_comm™d
->
id
 = 0;

730 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

731  
©_comm™d
->
id
;

732 
	}
}

734 
	$∑r£_cg¢
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

737 
©_comm™d
->
id
 = 
AT_CGSN
;

738 
©_comm™d
->
mask
 = 
AT_COMMAND_CGSN_MASK
;

739  
©_comm™d
->
id
;

740 
	}
}

742 
	$∑r£_cg¢_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

745 
©_comm™d
->
id
 = 
AT_CGSN
;

746  
©_comm™d
->
id
;

747 
	}
}

749 
	$∑r£_cgmi
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

752 
©_comm™d
->
id
 = 
AT_CGMI
;

753 
©_comm™d
->
mask
 = 
AT_COMMAND_CGMI_MASK
;

754  
©_comm™d
->
id
;

755 
	}
}

757 
	$∑r£_cgmi_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

760 
©_comm™d
->
id
 = 
AT_CGMI
;

761  
©_comm™d
->
id
;

762 
	}
}

764 
	$∑r£_cgmm
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

767 
©_comm™d
->
id
 = 
AT_CGMM
;

768 
©_comm™d
->
mask
 = 
AT_COMMAND_CGMM_MASK
;

769  
©_comm™d
->
id
;

770 
	}
}

772 
	$∑r£_cgmm_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

775 
©_comm™d
->
id
 = 
AT_CGMM
;

776  
©_comm™d
->
id
;

777 
	}
}

779 
	$∑r£_cgmr
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

782 
©_comm™d
->
id
 = 
AT_CGMR
;

783 
©_comm™d
->
mask
 = 
AT_COMMAND_CGMR_MASK
;

784  
©_comm™d
->
id
;

785 
	}
}

787 
	$∑r£_cgmr_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

790 
©_comm™d
->
id
 = 
AT_CGMR
;

791  
©_comm™d
->
id
;

792 
	}
}

794 
	$∑r£_cimi
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

797 
©_comm™d
->
id
 = 
AT_CIMI
;

798 
©_comm™d
->
mask
 = 
AT_COMMAND_CIMI_MASK
;

799  
©_comm™d
->
id
;

800 
	}
}

802 
	$∑r£_cimi_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

805 
©_comm™d
->
id
 = 
AT_CIMI
;

806  
©_comm™d
->
id
;

807 
	}
}

809 
	$∑r£_cfun_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

812 
©_comm™d
->
id
 = 
AT_CFUN
;

813 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

816 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

819 
numbî_of_∑ømëîs
)

822 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CFUN= command succeed");

823 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

827 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

828 &
©_comm™d
->
comm™d
.
cfun
.
fun
Ë!
RETURNok
)

830 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CFUN=<fun> command failed");

831  
RETURNîr‹
;

833 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CFUN=<fun> comm™d suc˚ed (fun:%d)", 
©_comm™d
->
comm™d
.
cfun
.
fun
);

835 
©_comm™d
->
mask
 = 
AT_CFUN_FUN_MASK
;

839 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i",

840 &
©_comm™d
->
comm™d
.
cfun
.
fun
,

841 &
©_comm™d
->
comm™d
.
cfun
.
r°
Ë!
RETURNok
)

843 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CFUN=<fun>,<rst> command failed");

844  
RETURNîr‹
;

847 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CFUN=<fun>,<r°> comm™d suc˚ed (fun:%d,Ñ°:%d)", 
©_comm™d
->
comm™d
.
cfun
.
fun
,át_comm™d->comm™d.cfun.
r°
);

849 
©_comm™d
->
mask
 = 
AT_CFUN_FUN_MASK
 | 
AT_CFUN_RST_MASK
;

853 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

854  
RETURNîr‹
;

857  
©_comm™d
->
id
;

858 
	}
}

860 
	$∑r£_cfun_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

863 
©_comm™d
->
id
 = 
AT_CFUN
;

864  
©_comm™d
->
id
;

865 
	}
}

867 
	$∑r£_cfun_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

870 
©_comm™d
->
id
 = 
AT_CFUN
;

871  
©_comm™d
->
id
;

872 
	}
}

874 
	$∑r£_˝ö_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

877 
©_comm™d
->
id
 = 
AT_CPIN
;

878 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

881 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

884 
numbî_of_∑ømëîs
)

887 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@r",

888 
©_comm™d
->
comm™d
.
˝ö
.
pö
, 
AT_CPIN_SIZE
Ë!
RETURNok
)

890 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CPIN=<pin> command failed");

891  
RETURNîr‹
;

894 i‡(!
	`IsNumîic
(
©_comm™d
->
comm™d
.
˝ö
.
pö
, 
AT_CPIN_SIZE
))

896 
	`LOG_TRACE
(
ERROR
, "USR-API - IncomingÖarameter isÇotá valid PIN code!");

897  
RETURNîr‹
;

899 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CPIN=<pö> comm™d suc˚ed (pö:%s)", 
©_comm™d
->
comm™d
.
˝ö
.
pö
);

901 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

905 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@r,@r",

906 
©_comm™d
->
comm™d
.
˝ö
.
pö
, 
AT_CPIN_SIZE
,

907 
©_comm™d
->
comm™d
.
˝ö
.
√wpö
, 
AT_CPIN_SIZE
Ë!
RETURNok
)

909 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CPIN=<pin>,<newpin> command failed");

910  
RETURNîr‹
;

913 i‡(!
	`IsNumîic
(
©_comm™d
->
comm™d
.
˝ö
.
pö
, 
AT_CPIN_SIZE
) ||

914 !
	`IsNumîic
(
©_comm™d
->
comm™d
.
˝ö
.
√wpö
, 
AT_CPIN_SIZE
))

916 
	`LOG_TRACE
(
ERROR
, "USR-API - IncomingÖarameter isÇotá valid PIN code!");

917  
RETURNîr‹
;

919 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CPIN=<pö>,<√wpö> comm™d suc˚ed (pö:%s,Çewpö:%s)", 
©_comm™d
->
comm™d
.
˝ö
.
pö
,át_comm™d->comm™d.˝ö.
√wpö
);

921 
©_comm™d
->
mask
 = 
AT_CPIN_NEWPIN_MASK
;

925 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

926  
RETURNîr‹
;

929  
©_comm™d
->
id
;

930 
	}
}

932 
	$∑r£_˝ö_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

935 
©_comm™d
->
id
 = 
AT_CPIN
;

936  
©_comm™d
->
id
;

937 
	}
}

939 
	$∑r£_˝ö_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

942 
©_comm™d
->
id
 = 
AT_CPIN
;

943  
©_comm™d
->
id
;

944 
	}
}

946 
	$∑r£_csq
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

949 
©_comm™d
->
id
 = 
AT_CSQ
;

950 
©_comm™d
->
mask
 = 
AT_COMMAND_CSQ_MASK
;

951  
©_comm™d
->
id
;

952 
	}
}

954 
	$∑r£_csq_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

957 
©_comm™d
->
id
 = 
AT_CSQ
;

958  
©_comm™d
->
id
;

959 
	}
}

961 
	$∑r£_˚sq
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

964 
©_comm™d
->
id
 = 
AT_CESQ
;

965 
©_comm™d
->
mask
 = 
AT_COMMAND_CESQ_MASK
;

966  
©_comm™d
->
id
;

967 
	}
}

969 
	$∑r£_˚sq_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

972 
©_comm™d
->
id
 = 
AT_CESQ
;

973  
©_comm™d
->
id
;

974 
	}
}

976 
	$∑r£_˛ac
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

979 
©_comm™d
->
id
 = 
AT_CLAC
;

980 
©_comm™d
->
mask
 = 
AT_COMMAND_CLAC_MASK
;

981  
©_comm™d
->
id
;

982 
	}
}

984 
	$∑r£_˛ac_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

987 
©_comm™d
->
id
 = 
AT_CLAC
;

988  
©_comm™d
->
id
;

989 
	}
}

991 
	$∑r£_cmì_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

994 
©_comm™d
->
id
 = 
AT_CMEE
;

995 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

998 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1001 
numbî_of_∑ømëîs
)

1004 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CMEE= command succeed");

1005 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1009 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1010 &
©_comm™d
->
comm™d
.
cmì
.
n
Ë!
RETURNok
) {

1011 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CMEE=<n> failed");

1012  
RETURNîr‹
;

1014 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CMEE=<n> comm™d suc˚ed (n:%d)", 
©_comm™d
->
comm™d
.
cmì
.
n
);

1016 
©_comm™d
->
mask
 = 
AT_CMEE_N_MASK
;

1020 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1021  
RETURNîr‹
;

1024  
©_comm™d
->
id
;

1025 
	}
}

1027 
	$∑r£_cmì_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1030 
©_comm™d
->
id
 = 
AT_CMEE
;

1031  
©_comm™d
->
id
;

1032 
	}
}

1034 
	$∑r£_cmì_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1037 
©_comm™d
->
id
 = 
AT_CMEE
;

1038  
©_comm™d
->
id
;

1039 
	}
}

1041 
	$∑r£_˙um
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1044 
©_comm™d
->
id
 = 
AT_CNUM
;

1045 
©_comm™d
->
mask
 = 
AT_COMMAND_CNUM_MASK
;

1046  
©_comm™d
->
id
;

1047 
	}
}

1049 
	$∑r£_˙um_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1052 
©_comm™d
->
id
 = 
AT_CNUM
;

1053  
©_comm™d
->
id
;

1054 
	}
}

1056 
	$∑r£_˛ck_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1059 
©_comm™d
->
id
 = 
AT_CLCK
;

1060 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1063 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1065 
numbî_of_∑ømëîs
)

1068 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@r,@i",

1069 &
©_comm™d
->
comm™d
.
˛ck
.
Ác
, 
AT_CLCK_FAC_SIZE
,

1070 &
©_comm™d
->
comm™d
.
˛ck
.
mode
Ë!
RETURNok
)

1072 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CLCK=<fac>,<mode> "

1074  
RETURNîr‹
;

1076 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CLCK=<fac>,<mode> "

1078 
©_comm™d
->
comm™d
.
˛ck
.
Ác
,

1079 
©_comm™d
->
comm™d
.
˛ck
.
mode
);

1080 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1084 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@r,@i,@r",

1085 &
©_comm™d
->
comm™d
.
˛ck
.
Ác
, 
AT_CLCK_FAC_SIZE
,

1086 &
©_comm™d
->
comm™d
.
˛ck
.
mode
,

1087 &
©_comm™d
->
comm™d
.
˛ck
.
∑sswd
,

1088 
AT_CLCK_PASSWD_SIZE
Ë!
RETURNok
)

1090 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CLCK=<fac>,<mode>"

1092  
RETURNîr‹
;

1094 i‡(!
	`IsNumîic
(
©_comm™d
->
comm™d
.
˛ck
.
∑sswd
,
AT_CLCK_PASSWD_SIZE
))

1096 
	`LOG_TRACE
(
ERROR
, "USR-API - IncomingÖarameter isÇotá validÖassword!");

1097  
RETURNîr‹
;

1099 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CLCK=<fac>,<mode>"

1101 
©_comm™d
->
comm™d
.
˛ck
.
Ác
,

1102 
©_comm™d
->
comm™d
.
˛ck
.
mode
,

1103 
©_comm™d
->
comm™d
.
˛ck
.
∑sswd
);

1104 
©_comm™d
->
mask
 = 
AT_CLCK_PASSWD_MASK
;

1108 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1112  
©_comm™d
->
id
;

1113 
	}
}

1115 
	$∑r£_˛ck_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1118 
©_comm™d
->
id
 = 
AT_CLCK
;

1119  
©_comm™d
->
id
;

1120 
	}
}

1122 
	$∑r£_c›s_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1125 
©_comm™d
->
id
 = 
AT_COPS
;

1126 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1129 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1132 
›î_vÆue
[
AT_COPS_NUM_SIZE
];

1133 
numbî_of_∑ømëîs
)

1136 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+COPS= command succeed");

1137 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1141 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1142 &
©_comm™d
->
comm™d
.
c›s
.
mode
Ë!
RETURNok
)

1144 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode> command failed");

1145  
RETURNîr‹
;

1147 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+COPS=<mode> comm™d suc˚ed (mode:%d)", 
©_comm™d
->
comm™d
.
c›s
.
mode
);

1149 
©_comm™d
->
mask
 = 
AT_COPS_MODE_MASK
;

1153 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i",

1154 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1155 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
Ë!
RETURNok
)

1157 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format> command failed");

1158  
RETURNîr‹
;

1161 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+COPS=<mode>,<f‹m©> comm™d suc˚ed (mode:%d, f‹m©:%d)", 
©_comm™d
->
comm™d
.
c›s
.
mode
,át_comm™d->comm™d.c›s.
f‹m©
);

1163 
©_comm™d
->
mask
 = 
AT_COPS_MODE_MASK
 | 
AT_COPS_FORMAT_MASK
;

1167 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i,@r",

1168 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1169 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
,

1170 
›î_vÆue
, 
NET_FORMAT_MAX_SIZE
Ë!
RETURNok
)

1172 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper> command failed");

1173  
RETURNîr‹
;

1176 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+COPS=<mode>,<f‹m©>,<›î> comm™d suc˚ed (mode:%d, f‹m©:%d)", 
©_comm™d
->
comm™d
.
c›s
.
mode
,át_comm™d->comm™d.c›s.
f‹m©
);

1179 
©_comm™d
->
comm™d
.
c›s
.
f‹m©
)

1181 
AT_COPS_LONG
:

1182 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_l⁄g
,

1183 
›î_vÆue
, 
AT_COPS_LONG_SIZE
);

1184 
	`LOG_TRACE
(
INFO
, "USR-API - <›î>Ö¨amëî'†vÆuêi†'%s'", 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_l⁄g
);

1187 
AT_COPS_SHORT
:

1188 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_sh‹t
, 
›î_vÆue
, 
AT_COPS_SHORT_SIZE
);

1189 
	`LOG_TRACE
(
INFO
, "USR-API - <›î>Ö¨amëî'†vÆuêi†'%s'", 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_sh‹t
);

1192 
AT_COPS_NUM
:

1193 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
num
,

1194 
›î_vÆue
, 
AT_COPS_NUM_SIZE
);

1195 
	`LOG_TRACE
(
INFO
, "USR-API - <›î>Ö¨amëî'†vÆuêi†'%s'", 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
num
);

1199 
	`LOG_TRACE
(
ERROR
, "USR-API - Invalid format value (%d)",

1200 
©_comm™d
->
comm™d
.
c›s
.
f‹m©
);

1201  
RETURNîr‹
;

1204 
©_comm™d
->
mask
 = 
AT_COPS_MODE_MASK
 | 
AT_COPS_FORMAT_MASK
 | 
AT_COPS_OPER_MASK
;

1208 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i,@0",

1209 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1210 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
Ë!
RETURNok
)

1212 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format> command failed");

1213  
RETURNîr‹
;

1216 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+COPS=<mode>,<f‹m©>,<›î> comm™d suc˚ed (mode:%d, f‹m©:%d)", 
©_comm™d
->
comm™d
.
c›s
.
mode
,át_comm™d->comm™d.c›s.
f‹m©
);

1219 
©_comm™d
->
comm™d
.
c›s
.
f‹m©
)

1221 
AT_COPS_LONG
:

1222 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i,@r,@i",

1223 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1224 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
,

1225 
›î_vÆue
, 
AT_COPS_LONG_SIZE
,

1226 &
©_comm™d
->
comm™d
.
c›s
.
AcT
Ë!
RETURNok
)

1228 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper>,<AcT> command failed");

1229  
RETURNîr‹
;

1231 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_l⁄g
,

1232 
›î_vÆue
, 
AT_COPS_LONG_SIZE
);

1233 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+COPS=<mode>,<f‹m©>,<›î>,<AcT> comm™d suc˚ed (›î:%s, A˘:%d)", 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_l⁄g
,át_comm™d->comm™d.c›s.
AcT
);

1236 
AT_COPS_SHORT
:

1237 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i,@r,@i",

1238 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1239 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
,

1240 
›î_vÆue
, 
AT_COPS_SHORT_SIZE
,

1241 &
©_comm™d
->
comm™d
.
c›s
.
AcT
Ë!
RETURNok
)

1243 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper>,<AcT> command failed");

1244  
RETURNîr‹
;

1246 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_sh‹t
,

1247 
›î_vÆue
, 
AT_COPS_SHORT_SIZE
);

1248 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper>,<AcT> command succeed (oper:%s, Act:%d)",

1249 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
Æpha_sh‹t
,

1250 
©_comm™d
->
comm™d
.
c›s
.
AcT
);

1253 
AT_COPS_NUM
:

1254 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i,@r,@i",

1255 &
©_comm™d
->
comm™d
.
c›s
.
mode
,

1256 &
©_comm™d
->
comm™d
.
c›s
.
f‹m©
,

1257 
›î_vÆue
, 
AT_COPS_NUM_SIZE
,

1258 &
©_comm™d
->
comm™d
.
c›s
.
AcT
Ë!
RETURNok
)

1260 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper>,<AcT> command failed");

1261  
RETURNîr‹
;

1263 
	`°∫˝y
((*Ë
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
num
,

1264 
›î_vÆue
, 
AT_COPS_NUM_SIZE
);

1265 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+COPS=<mode>,<format>,<oper>,<AcT> command succeed (oper:%s, Act:%d)",

1266 
©_comm™d
->
comm™d
.
c›s
.
∂mn
.
id
.
num
,

1267 
©_comm™d
->
comm™d
.
c›s
.
AcT
);

1271 
	`LOG_TRACE
(
ERROR
, "USR-API - Invalid format value (%d)",

1272 
©_comm™d
->
comm™d
.
c›s
.
f‹m©
);

1273  
RETURNîr‹
;

1276 
©_comm™d
->
mask
 = 
AT_COPS_MODE_MASK
 | 
AT_COPS_FORMAT_MASK
 | 
AT_COPS_OPER_MASK
 | 
AT_COPS_ACT_MASK
;

1280 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1281  
RETURNîr‹
;

1284  
©_comm™d
->
id
;

1285 
	}
}

1287 
	$∑r£_c›s_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1290 
©_comm™d
->
id
 = 
AT_COPS
;

1291  
©_comm™d
->
id
;

1292 
	}
}

1294 
	$∑r£_c›s_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1297 
©_comm™d
->
id
 = 
AT_COPS
;

1298  
©_comm™d
->
id
;

1299 
	}
}

1301 
	$∑r£_¸eg_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1304 
©_comm™d
->
id
 = 
AT_CREG
;

1305 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1308 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1311 
numbî_of_∑ømëîs
)

1314 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CREG= command succeed");

1315 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1319 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1320 &
©_comm™d
->
comm™d
.
¸eg
.
n
Ë!
RETURNok
) {

1321 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CREG=<n> failed");

1322  
RETURNîr‹
;

1324 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CREG=<n> comm™d suc˚ed (n:%d)", 
©_comm™d
->
comm™d
.
¸eg
.
n
);

1326 
©_comm™d
->
mask
 = 
AT_CREG_N_MASK
;

1330 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1331  
RETURNîr‹
;

1334  
©_comm™d
->
id
;

1335 
	}
}

1337 
	$∑r£_¸eg_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1340 
©_comm™d
->
id
 = 
AT_CREG
;

1341  
©_comm™d
->
id
;

1342 
	}
}

1344 
	$∑r£_¸eg_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1347 
©_comm™d
->
id
 = 
AT_CREG
;

1348  
©_comm™d
->
id
;

1349 
	}
}

1351 
	$∑r£_cg©t_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1354 
©_comm™d
->
id
 = 
AT_CGATT
;

1355 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1358 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1361 
numbî_of_∑ømëîs
)

1364 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGATT= command succeed");

1365 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1369 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1370 &
©_comm™d
->
comm™d
.
cg©t
.
°©e
Ë!
RETURNok
) {

1371 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGATT=<state> failed");

1372  
RETURNîr‹
;

1374 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CGATT=<°©e> comm™d suc˚ed (°©e:%d)", 
©_comm™d
->
comm™d
.
cg©t
.
°©e
);

1376 
©_comm™d
->
mask
 = 
AT_CGATT_STATE_MASK
;

1380 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1381  
RETURNîr‹
;

1384  
©_comm™d
->
id
;

1385 
	}
}

1387 
	$∑r£_cg©t_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1390 
©_comm™d
->
id
 = 
AT_CGATT
;

1391  
©_comm™d
->
id
;

1392 
	}
}

1394 
	$∑r£_cg©t_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1397 
©_comm™d
->
id
 = 
AT_CGATT
;

1398  
©_comm™d
->
id
;

1399 
	}
}

1401 
	$∑r£_cgªg_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1404 
©_comm™d
->
id
 = 
AT_CGREG
;

1405 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1408 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1411 
numbî_of_∑ømëîs
)

1414 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGREG= command succeed");

1415 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1419 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1420 &
©_comm™d
->
comm™d
.
cgªg
.
n
Ë!
RETURNok
) {

1421 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGREG=<n> failed");

1422  
RETURNîr‹
;

1424 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CGREG=<n> comm™d suc˚ed (n:%d)", 
©_comm™d
->
comm™d
.
cgªg
.
n
);

1426 
©_comm™d
->
mask
 = 
AT_CGREG_N_MASK
;

1430 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1431  
RETURNîr‹
;

1434  
©_comm™d
->
id
;

1435 
	}
}

1437 
	$∑r£_cgªg_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1440 
©_comm™d
->
id
 = 
AT_CGREG
;

1441  
©_comm™d
->
id
;

1442 
	}
}

1444 
	$∑r£_cgªg_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1447 
©_comm™d
->
id
 = 
AT_CGREG
;

1448  
©_comm™d
->
id
;

1449 
	}
}

1451 
	$∑r£_˚ªg_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1454 
©_comm™d
->
id
 = 
AT_CEREG
;

1455 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1458 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1461 
numbî_of_∑ømëîs
)

1464 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CEREG= command succeed");

1465 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1469 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1470 &
©_comm™d
->
comm™d
.
˚ªg
.
n
Ë!
RETURNok
) {

1471 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CEREG=<n> failed");

1472  
RETURNîr‹
;

1474 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CEREG=<n> comm™d suc˚ed (n:%d)", 
©_comm™d
->
comm™d
.
˚ªg
.
n
);

1476 
©_comm™d
->
mask
 = 
AT_CEREG_N_MASK
;

1480 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1481  
RETURNîr‹
;

1484  
©_comm™d
->
id
;

1485 
	}
}

1487 
	$∑r£_˚ªg_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1490 
©_comm™d
->
id
 = 
AT_CEREG
;

1491  
©_comm™d
->
id
;

1492 
	}
}

1494 
	$∑r£_˚ªg_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1497 
©_comm™d
->
id
 = 
AT_CEREG
;

1498  
©_comm™d
->
id
;

1499 
	}
}

1501 
	$∑r£_cgdc⁄t_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1504 
©_comm™d
->
id
 = 
AT_CGDCONT
;

1505 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1508 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1511 
numbî_of_∑ømëîs
)

1514 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1515 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
Ë!
RETURNok
)

1517 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid> failed");

1518  
RETURNîr‹
;

1520 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CGDCONT=<cid> comm™d suc˚ed (cid:%d)", 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
);

1522 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
;

1526 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r",

1527 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1528 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
Ë!
RETURNok
)

1530 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type> failed");

1531  
RETURNîr‹
;

1533 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type> succeed (cid:%d,Ödp_type:%s)",

1534 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1535 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
);

1537 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
;

1541 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r",

1542 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1543 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1544 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
Ë!
RETURNok
)

1546 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN> failed");

1547  
RETURNîr‹
;

1549 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN> succeed (cid:%d,Ödp_type:%s,ápn:%s)",

1550 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1551 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1552 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
);

1554 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
;

1558 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r",

1559 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1560 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1561 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1562 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
Ë!
RETURNok
)

1564 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr> failed");

1565  
RETURNîr‹
;

1567 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s)",

1568 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1569 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1570 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1571 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
);

1573 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
;

1577 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i",

1578 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1579 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1580 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1581 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1582 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
Ë!
RETURNok
)

1584 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp> failed");

1585  
RETURNîr‹
;

1587 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d)",

1588 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1589 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1590 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1591 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1592 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
);

1594 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
;

1598 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i,@i",

1599 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1600 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1601 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1602 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1603 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1604 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
Ë!
RETURNok
)

1606 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp> failed");

1607  
RETURNîr‹
;

1609 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d, h_comp:%d)",

1610 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1611 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1612 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1613 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1614 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1615 
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
);

1617 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
 | 
AT_CGDCONT_H_COMP_MASK
;

1621 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i,@i,@i",

1622 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1623 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1624 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1625 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1626 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1627 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1628 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
Ë!
RETURNok
)

1630 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc> failed");

1631  
RETURNîr‹
;

1633 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d, h_comp:%d, ipv4addralloc:%d)",

1634 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1635 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1636 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1637 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1638 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1639 
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1640 
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
);

1642 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
 | 
AT_CGDCONT_H_COMP_MASK
 | 
AT_CGDCONT_IPV4ADDRALLOC_MASK
;

1646 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i,@i,@i,@i",

1647 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1648 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1649 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1650 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1651 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1652 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1653 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1654 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
Ë!
RETURNok
)

1656 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication> failed");

1657  
RETURNîr‹
;

1659 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d, h_comp:%d, ipv4addralloc:%d,Émergency_indication:%d)",

1660 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1661 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1662 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1663 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1664 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1665 
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1666 
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1667 
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
);

1669 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
 | 
AT_CGDCONT_H_COMP_MASK
 | 
AT_CGDCONT_IPV4ADDRALLOC_MASK
 | 
AT_CGDCONT_EMERGECY_INDICATION_MASK
;

1675 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i,@i,@i,@i,@i",

1676 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1677 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1678 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1679 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1680 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1681 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1682 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1683 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
,

1684 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
Ë!
RETURNok
)

1686 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication>,<P-CSCF_discovery> failed");

1687  
RETURNîr‹
;

1689 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication>,<P-CSCF_discovery> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d, h_comp:%d, ipv4addralloc:%d,Émergency_indication:%d,Ö_cscf_discovery:%d)",

1690 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1691 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1692 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1693 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1694 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1695 
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1696 
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1697 
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
,

1698 
©_comm™d
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
);

1700 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
 | 
AT_CGDCONT_H_COMP_MASK
 | 
AT_CGDCONT_IPV4ADDRALLOC_MASK
 | 
AT_CGDCONT_EMERGECY_INDICATION_MASK
 | 
AT_CGDCONT_P_CSCF_DISCOVERY_MASK
;

1706 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@r,@r,@r,@i,@i,@i,@i,@i,@i",

1707 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1708 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, 
AT_CGDCONT_PDP_SIZE
,

1709 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
, 
AT_CGDCONT_APN_SIZE
,

1710 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
, 
AT_CGDCONT_ADDR_SIZE
,

1711 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1712 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1713 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1714 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
,

1715 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
,

1716 &
©_comm™d
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
Ë!
RETURNok
)

1718 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication>,<P-CSCF_discovery>, <IM_CN_Signalling_Flag_Ind> failed");

1719  
RETURNîr‹
;

1721 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGDCONT=<cid>,<PDP_type>,<APN>,<PDP_addr>,<d_comp>,<h_comp>,<IPv4AddrAlloc>,<emergency¬†indication>,<P-CSCF_discovery>, <IM_CN_Signalling_Flag_Ind> succeed (cid:%d,Ödp_type:%s,ápn:%s,Ödp_addr:%s, d_comp:%d, h_comp:%d, ipv4addralloc:%d,Émergency_indication:%d,Ö_cscf_discovery:%d, im_cn_signalling_flag:%d)",

1722 
©_comm™d
->
comm™d
.
cgdc⁄t
.
cid
,

1723 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,

1724 
©_comm™d
->
comm™d
.
cgdc⁄t
.
APN
,

1725 
©_comm™d
->
comm™d
.
cgdc⁄t
.
PDP_addr
,

1726 
©_comm™d
->
comm™d
.
cgdc⁄t
.
d_comp
,

1727 
©_comm™d
->
comm™d
.
cgdc⁄t
.
h_comp
,

1728 
©_comm™d
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
,

1729 
©_comm™d
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
,

1730 
©_comm™d
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
,

1731 
©_comm™d
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
);

1733 
©_comm™d
->
mask
 = 
AT_CGDCONT_CID_MASK
 | 
AT_CGDCONT_PDP_TYPE_MASK
 | 
AT_CGDCONT_APN_MASK
 | 
AT_CGDCONT_PDP_ADDR_MASK
 | 
AT_CGDCONT_D_COMP_MASK
 | 
AT_CGDCONT_H_COMP_MASK
 | 
AT_CGDCONT_IPV4ADDRALLOC_MASK
 | 
AT_CGDCONT_EMERGECY_INDICATION_MASK
 | 
AT_CGDCONT_P_CSCF_DISCOVERY_MASK
 | 
AT_CGDCONT_IM_CN_SIGNALLING_FLAG_IND_MASK
;

1737 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1738  
RETURNîr‹
;

1741  
©_comm™d
->
id
;

1742 
	}
}

1744 
	$∑r£_cgdc⁄t_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1747 
©_comm™d
->
id
 = 
AT_CGDCONT
;

1748  
©_comm™d
->
id
;

1749 
	}
}

1751 
	$∑r£_cgdc⁄t_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1754 
©_comm™d
->
id
 = 
AT_CGDCONT
;

1755  
©_comm™d
->
id
;

1756 
	}
}

1758 
	$∑r£_cga˘_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1761 
©_comm™d
->
id
 = 
AT_CGACT
;

1762 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1765 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1767 
numbî_of_∑ømëîs
)

1770 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1771 &
©_comm™d
->
comm™d
.
cga˘
.
°©e
Ë!
RETURNok
)

1773 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGACT=<state> failed");

1774  
RETURNîr‹
;

1776 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CGACT=<°©e> suc˚ed (°©e:%d)", 
©_comm™d
->
comm™d
.
cga˘
.
°©e
);

1777 
©_comm™d
->
mask
 = 
AT_CGACT_STATE_MASK
;

1781 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i,@i",

1782 &
©_comm™d
->
comm™d
.
cga˘
.
°©e
,

1783 &
©_comm™d
->
comm™d
.
cga˘
.
cid
Ë!
RETURNok
)

1785 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGACT=<state>,<cid> failed");

1786  
RETURNîr‹
;

1788 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGACT=<state>,<cid> succeed (state:%d, cid:%d)",

1789 
©_comm™d
->
comm™d
.
cga˘
.
°©e
,

1790 
©_comm™d
->
comm™d
.
cga˘
.
cid
);

1792 
©_comm™d
->
mask
 = 
AT_CGACT_STATE_MASK
 | 
AT_CGACT_CID_MASK
;

1796 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1800  
©_comm™d
->
id
;

1801 
	}
}

1803 
	$∑r£_cga˘_gë
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1806 
©_comm™d
->
id
 = 
AT_CGACT
;

1807  
©_comm™d
->
id
;

1808 
	}
}

1810 
	$∑r£_cga˘_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1813 
©_comm™d
->
id
 = 
AT_CGACT
;

1814  
©_comm™d
->
id
;

1815 
	}
}

1817 
	$∑r£_cg∑ddr_£t
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1820 
©_comm™d
->
id
 = 
AT_CGPADDR
;

1821 * 
∑ømëî_°¨t_ödex
 = (*Ë
°rög
 + 
posôi⁄
;

1824 
numbî_of_∑ømëîs
 = 
	`NumbîOfP¨amëîs
(
∑ømëî_°¨t_ödex
);

1826 
numbî_of_∑ømëîs
)

1829 
	`LOG_TRACE
(
INFO
, "USR-API - Parsing of AT+CGPADDR= command succeed");

1830 
©_comm™d
->
mask
 = 
AT_COMMAND_NO_PARAM
;

1834 i‡(
	`P¨£Comm™d
(
∑ømëî_°¨t_ödex
, "@i",

1835 &
©_comm™d
->
comm™d
.
cg∑ddr
.
cid
Ë!
RETURNok
)

1837 
	`LOG_TRACE
(
ERROR
, "USR-API - Parsing of AT+CGPADDR=<state> failed");

1838  
RETURNîr‹
;

1840 
	`LOG_TRACE
(
INFO
, "USR-API - P¨sög o‡AT+CGPADDR=<cid> suc˚ed (cid:%d)", 
©_comm™d
->
comm™d
.
cg∑ddr
.
cid
);

1841 
©_comm™d
->
mask
 = 
AT_CGPADDR_CID_MASK
;

1845 
	`LOG_TRACE
(
ERROR
, "USR-API - InvÆidÇumbî o‡∑ømëî†(%d)", 
numbî_of_∑ømëîs
);

1849  
©_comm™d
->
id
;

1850 
	}
}

1852 
	$∑r£_cg∑ddr_ã°
(c⁄° * 
°rög
, 
posôi⁄
, 
©_comm™d_t
* 
©_comm™d
)

1855 
©_comm™d
->
id
 = 
AT_CGPADDR
;

1856  
©_comm™d
->
id
;

1857 
	}
}

	@src/api/user/at_command.h

47 #i‚de‡
__AT_COMMAND_H__


48 
	#__AT_COMMAND_H__


	)

50 
	~"u£rDef.h
"

51 
	~"√tw‹kDef.h
"

58 
	#AT_COMMAND_PARAM0
 0x0000

	)

59 
	#AT_COMMAND_PARAM1
 0x0001

	)

60 
	#AT_COMMAND_PARAM2
 0x0002

	)

61 
	#AT_COMMAND_PARAM3
 0x0004

	)

62 
	#AT_COMMAND_PARAM4
 0x0008

	)

63 
	#AT_COMMAND_PARAM5
 0x0010

	)

64 
	#AT_COMMAND_PARAM6
 0x0020

	)

65 
	#AT_COMMAND_PARAM7
 0x0040

	)

66 
	#AT_COMMAND_PARAM8
 0x0080

	)

67 
	#AT_COMMAND_PARAM9
 0x0100

	)

68 
	#AT_COMMAND_PARAM10
 0x0200

	)

69 
	#AT_COMMAND_PARAM11
 0x0400

	)

70 
	#AT_COMMAND_PARAM12
 0x0800

	)

71 
	#AT_COMMAND_PARAM13
 0x1000

	)

72 
	#AT_COMMAND_PARAM14
 0x2000

	)

73 
	#AT_COMMAND_PARAM15
 0x4000

	)

74 
	#AT_COMMAND_PARAM16
 0x8000

	)

77 
	#AT_COMMAND_NO_PARAM
 
AT_COMMAND_PARAM0


	)

93 
	mAT_CGSN
=1,

94 
	mAT_CGMI
,

95 
	mAT_CGMM
,

96 
	mAT_CGMR
,

97 
	mAT_CIMI
,

102 
	mAT_CFUN
,

103 
	mAT_CPIN
,

104 
	mAT_CSQ
,

105 
	mAT_CESQ
,

106 
	mAT_CLAC
,

111 
	mAT_CMEE
,

116 
	mAT_CNUM
,

117 
	mAT_CLCK
,

118 
	mAT_COPS
,

119 
	mAT_CREG
,

124 
	mAT_CGATT
,

125 
	mAT_CGREG
,

126 
	mAT_CEREG
,

127 
	mAT_CGDCONT
,

128 
	mAT_CGACT
,

129 
	mAT_CGPADDR
,

130 
	mAT_CGEV
,

131 
	mAT_COMMAND_ID_MAX


132 } 
	t©_comm™d_id_t
;

147 
	mAT_COMMAND_ACT
,

148 
	mAT_COMMAND_SET
,

149 
	mAT_COMMAND_GET
,

150 
	mAT_COMMAND_TST
,

151 
	mAT_COMMAND_TYPE_MAX


152 } 
	t©_comm™d_ty≥_t
;

169 
	#AT_COMMAND_CGSN_MASK
 
AT_COMMAND_NO_PARAM


	)

170 
	s©_cg¢_s
 {} 
	g©_cg¢_t
;

181 
	#AT_COMMAND_CGMI_MASK
 
AT_COMMAND_NO_PARAM


	)

182 
	s©_cgmi_s
 {} 
	g©_cgmi_t
;

193 
	#AT_COMMAND_CGMM_MASK
 
AT_COMMAND_NO_PARAM


	)

194 
	s©_cgmm_s
 {} 
	g©_cgmm_t
;

206 
	#AT_COMMAND_CGMR_MASK
 
AT_COMMAND_NO_PARAM


	)

207 
	s©_cgmr_s
 {} 
	g©_cgmr_t
;

219 
	#AT_COMMAND_CIMI_MASK
 
AT_COMMAND_NO_PARAM


	)

220 
	s©_cimi_s
 {} 
	g©_cimi_t
;

237 
	#AT_CFUN_MIN
 0

	)

238 
	#AT_CFUN_FULL
 1

	)

239 
	#AT_CFUN_SEND
 2

	)

240 
	#AT_CFUN_RECV
 3

	)

241 
	#AT_CFUN_BOTH
 4

	)

243 
	#AT_CFUN_MAX
 
AT_CFUN_BOTH


	)

246 
	#AT_CFUN_FUN_DEFAULT
 
AT_CFUN_MIN


	)

250 
	#AT_CFUN_NORST
 0

	)

253 
	#AT_CFUN_RST
 1

	)

255 
	#AT_CFUN_RST_DEFAULT
 
AT_CFUN_NORST


	)

259 
	#AT_CFUN_FUN_MASK
 
AT_COMMAND_PARAM1


	)

260 
	#AT_CFUN_RST_MASK
 
AT_COMMAND_PARAM2


	)

264 
	mfun
;

265 
	mr°
;

266 } 
	t©_cfun_t
;

279 
	#AT_CPIN_NEWPIN_MASK
 
AT_COMMAND_PARAM2


	)

283 
	#AT_CPIN_SIZE
 
USER_PIN_SIZE


	)

284 
	mpö
[
AT_CPIN_SIZE
+1];

285 
	m√wpö
[
AT_CPIN_SIZE
+1];

286 } 
	t©_˝ö_t
;

297 
	#AT_COMMAND_CSQ_MASK
 
AT_COMMAND_NO_PARAM


	)

298 
	s©_csq_s
 {} 
	g©_csq_t
;

308 
	#AT_COMMAND_CESQ_MASK
 
AT_COMMAND_NO_PARAM


	)

309 
	s©_˚sq_s
 {} 
	g©_˚sq_t
;

319 
	#AT_COMMAND_CLAC_MASK
 
AT_COMMAND_NO_PARAM


	)

320 
	s©_˛ac_s
 {} 
	g©_˛ac_t
;

341 
	#AT_CMEE_OFF
 0

	)

342 
	#AT_CMEE_NUMERIC
 1

	)

343 
	#AT_CMEE_VERBOSE
 2

	)

344 
	#AT_CMEE_N_MIN
 
AT_CMEE_OFF


	)

346 
	#AT_CMEE_N_MAX
 
AT_CMEE_VERBOSE


	)

348 
	#AT_CMEE_N_DEFAULT
 
AT_CMEE_OFF


	)

352 
	#AT_CMEE_N_MASK
 
AT_COMMAND_PARAM1


	)

356 
	mn
;

357 } 
	t©_cmì_t
;

372 
	#AT_COMMAND_CNUM_MASK
 
AT_COMMAND_NO_PARAM


	)

373 
	s©_˙um_s
 {} 
	g©_˙um_t
;

386 
	#AT_CLCK_SC
 "SC"

	)

389 
	#AT_CLCK_UNLOCK
 0

	)

390 
	#AT_CLCK_LOCK
 1

	)

391 
	#AT_CLCK_STATUS
 2

	)

394 
	#AT_CLCK_PASSWD_MASK
 
AT_COMMAND_PARAM3


	)

398 
	#AT_CLCK_FAC_SIZE
 2

	)

399 
	mÁc
[
AT_CLCK_FAC_SIZE
+1];

400 
	mmode
;

401 
	#AT_CLCK_PASSWD_SIZE
 
USER_PIN_SIZE


	)

402 
	m∑sswd
[
AT_CLCK_PASSWD_SIZE
+1];

403 } 
	t©_˛ck_t
;

418 
	#AT_COPS_AUTO
 0

	)

419 
	#AT_COPS_MANUAL
 1

	)

420 
	#AT_COPS_DEREG
 2

	)

421 
	#AT_COPS_FORMAT
 3

	)

422 
	#AT_COPS_MANAUTO
 4

	)

424 
	#AT_COPS_MODE_DEFAULT
 
AT_COPS_AUTO


	)

428 
	#AT_COPS_LONG
 
NET_FORMAT_LONG


	)

429 
	#AT_COPS_SHORT
 
NET_FORMAT_SHORT


	)

430 
	#AT_COPS_NUM
 
NET_FORMAT_NUM


	)

431 
	#AT_COPS_FORMAT_MIN
 
AT_COPS_LONG


	)

434 
	#AT_COPS_FORMAT_MAX
 
AT_COPS_NUM


	)

437 
	#AT_COPS_FORMAT_DEFAULT
 
AT_COPS_LONG


	)

441 
	#AT_COPS_GSM
 
NET_ACCESS_GSM


	)

442 
	#AT_COPS_COMPACT
 
NET_ACCESS_COMPACT


	)

443 
	#AT_COPS_UTRAN
 
NET_ACCESS_UTRAN


	)

444 
	#AT_COPS_EGPRS
 
NET_ACCESS_EGPRS


	)

445 
	#AT_COPS_HSDPA
 
NET_ACCESS_HSDPA


	)

446 
	#AT_COPS_HSUPA
 
NET_ACCESS_HSUPA


	)

447 
	#AT_COPS_HSDUPA
 
NET_ACCESS_HSDUPA


	)

448 
	#AT_COPS_EUTRAN
 
NET_ACCESS_EUTRAN


	)

449 
	#AT_COPS_ACT_MIN
 
AT_COPS_GSM


	)

452 
	#AT_COPS_ACT_MAX
 
AT_COPS_EUTRAN


	)

455 
	#AT_COPS_ACT_DEFAULT
 
AT_COPS_GSM


	)

460 
	#AT_COPS_MODE_MASK
 
AT_COMMAND_PARAM1


	)

461 
	#AT_COPS_FORMAT_MASK
 
AT_COMMAND_PARAM2


	)

462 
	#AT_COPS_OPER_MASK
 
AT_COMMAND_PARAM3


	)

463 
	#AT_COPS_ACT_MASK
 
AT_COMMAND_PARAM4


	)

467 
	mmode
;

468 
	mf‹m©
;

469 
	#AT_COPS_NUM_SIZE
 
NET_FORMAT_NUM_SIZE


	)

471 
	#AT_COPS_LONG_SIZE
 
NET_FORMAT_LONG_SIZE


	)

473 
	#AT_COPS_SHORT_SIZE
 
NET_FORMAT_SHORT_SIZE


	)

475 
√tw‹k_∂mn_t
 
	m∂mn
;

476 
	mAcT
;

477 } 
	t©_c›s_t
;

492 
	#AT_CREG_OFF
 0

	)

494 
	#AT_CREG_ON
 1

	)

496 
	#AT_CREG_BOTH
 2

	)

499 
	#AT_CREG_N_MIN
 
AT_CREG_OFF


	)

502 
	#AT_CREG_N_MAX
 
AT_CREG_BOTH


	)

505 
	#AT_CREG_N_DEFAULT
 
AT_CREG_OFF


	)

510 
	#AT_CREG_N_MASK
 
AT_COMMAND_PARAM1


	)

514 
	mn
;

515 } 
	t©_¸eg_t
;

531 
	#AT_CGATT_DETACHED
 0

	)

532 
	#AT_CGATT_ATTACHED
 1

	)

533 
	#AT_CGATT_STATE_MIN
 
AT_CGATT_DETACHED


	)

535 
	#AT_CGATT_STATE_MAX
 
AT_CGATT_ATTACHED


	)

539 
	#AT_CGATT_STATE_MASK
 
AT_COMMAND_PARAM1


	)

543 
	m°©e
;

544 } 
	t©_cg©t_t
;

559 
	#AT_CGREG_OFF
 0

	)

561 
	#AT_CGREG_ON
 1

	)

563 
	#AT_CGREG_BOTH
 2

	)

566 
	#AT_CGREG_N_MIN
 
AT_CGREG_OFF


	)

569 
	#AT_CGREG_N_MAX
 
AT_CGREG_BOTH


	)

572 
	#AT_CGREG_N_DEFAULT
 
AT_CGREG_OFF


	)

577 
	#AT_CGREG_N_MASK
 
AT_COMMAND_PARAM1


	)

581 
	mn
;

582 } 
	t©_cgªg_t
;

597 
	#AT_CEREG_OFF
 0

	)

599 
	#AT_CEREG_ON
 1

	)

601 
	#AT_CEREG_BOTH
 2

	)

604 
	#AT_CEREG_N_MIN
 
AT_CEREG_OFF


	)

607 
	#AT_CEREG_N_MAX
 
AT_CEREG_BOTH


	)

610 
	#AT_CEREG_N_DEFAULT
 
AT_CEREG_OFF


	)

615 
	#AT_CEREG_N_MASK
 
AT_COMMAND_PARAM1


	)

619 
	mn
;

620 } 
	t©_˚ªg_t
;

645 
	#AT_CGDCONT_CID_MIN
 1

	)

646 
	#AT_CGDCONT_CID_DEFAULT
 
AT_CGDCONT_CID_MIN


	)

648 
	#AT_CGDCONT_D_COMP_OFF
 0

	)

649 
	#AT_CGDCONT_D_COMP_ON
 1

	)

650 
	#AT_CGDCONT_D_COMP_V42B
 2

	)

651 
	#AT_CGDCONT_D_COMP_V44
 3

	)

652 
	#AT_CGDCONT_D_COMP_MIN
 
AT_CGDCONT_D_COMP_OFF


	)

653 
	#AT_CGDCONT_D_COMP_MAX
 
AT_CGDCONT_D_COMP_V44


	)

654 
	#AT_CGDCONT_D_COMP_DEFAULT
 
AT_CGDCONT_D_COMP_OFF


	)

656 
	#AT_CGDCONT_H_COMP_OFF
 0

	)

657 
	#AT_CGDCONT_H_COMP_ON
 1

	)

658 
	#AT_CGDCONT_H_COMP_1144
 2

	)

659 
	#AT_CGDCONT_H_COMP_2507
 3

	)

660 
	#AT_CGDCONT_H_COMP_3095
 4

	)

661 
	#AT_CGDCONT_H_COMP_MIN
 
AT_CGDCONT_H_COMP_OFF


	)

662 
	#AT_CGDCONT_H_COMP_MAX
 
AT_CGDCONT_H_COMP_3095


	)

663 
	#AT_CGDCONT_H_COMP_DEFAULT
 
AT_CGDCONT_H_COMP_OFF


	)

665 
	#AT_CGDCONT_IPV4_NAS
 0

	)

667 
	#AT_CGDCONT_IPV4_DHCP
 1

	)

668 
	#AT_CGDCONT_IPV4_MIN
 
AT_CGDCONT_IPV4_NAS


	)

669 
	#AT_CGDCONT_IPV4_MAX
 
AT_CGDCONT_IPV4_DHCP


	)

670 
	#AT_CGDCONT_IPV4_DEFAULT
 
AT_CGDCONT_IPV4_NAS


	)

672 
	#AT_CGDCONT_EBS_OFF
 0

	)

674 
	#AT_CGDCONT_EBS_ON
 1

	)

676 
	#AT_CGDCONT_EBS_MIN
 
AT_CGDCONT_EBS_OFF


	)

677 
	#AT_CGDCONT_EBS_MAX
 
AT_CGDCONT_EBS_ON


	)

678 
	#AT_CGDCONT_EBS_DEFAULT
 
AT_CGDCONT_EBS_OFF


	)

680 
	#AT_CGDCONT_PCSCF_OFF
 0

	)

682 
	#AT_CGDCONT_PCSCF_NAS
 1

	)

684 
	#AT_CGDCONT_PCSCF_DHCP
 2

	)

686 
	#AT_CGDCONT_PCSCF_MIN
 
AT_CGDCONT_PCSCF_OFF


	)

687 
	#AT_CGDCONT_PCSCF_MAX
 
AT_CGDCONT_PCSCF_DHCP


	)

688 
	#AT_CGDCONT_PCSCF_DEFAULT
 
AT_CGDCONT_PCSCF_OFF


	)

690 
	#AT_CGDCONT_IM_CN_OFF
 0

	)

693 
	#AT_CGDCONT_IM_CN_ON
 1

	)

696 
	#AT_CGDCONT_IM_CM_MIN
 
AT_CGDCONT_IM_CN_OFF


	)

697 
	#AT_CGDCONT_IM_CM_MAX
 
AT_CGDCONT_IM_CN_ON


	)

698 
	#AT_CGDCONT_IM_CM_DEFAULT
 
AT_CGDCONT_IM_CN_OFF


	)

701 
	#AT_CGDCONT_CID_MASK
 
AT_COMMAND_PARAM1


	)

702 
	#AT_CGDCONT_PDP_TYPE_MASK
 
AT_COMMAND_PARAM2


	)

703 
	#AT_CGDCONT_APN_MASK
 
AT_COMMAND_PARAM3


	)

704 
	#AT_CGDCONT_PDP_ADDR_MASK
 
AT_COMMAND_PARAM4


	)

705 
	#AT_CGDCONT_D_COMP_MASK
 
AT_COMMAND_PARAM5


	)

706 
	#AT_CGDCONT_H_COMP_MASK
 
AT_COMMAND_PARAM6


	)

707 
	#AT_CGDCONT_IPV4ADDRALLOC_MASK
 
AT_COMMAND_PARAM7


	)

708 
	#AT_CGDCONT_EMERGECY_INDICATION_MASK
 
AT_COMMAND_PARAM8


	)

709 
	#AT_CGDCONT_P_CSCF_DISCOVERY_MASK
 
AT_COMMAND_PARAM9


	)

710 
	#AT_CGDCONT_IM_CN_SIGNALLING_FLAG_IND_MASK
 
AT_COMMAND_PARAM10


	)

714 
	mcid
;

715 
	#AT_CGDCONT_PDP_SIZE
 6

	)

716 
	mPDP_ty≥
[
AT_CGDCONT_PDP_SIZE
+1];

717 
	#AT_CGDCONT_APN_SIZE
 100

	)

718 
	mAPN
[
AT_CGDCONT_APN_SIZE
+1];

719 
	#AT_CGDCONT_ADDR_SIZE
 63

	)

721 
	mPDP_addr
[
AT_CGDCONT_ADDR_SIZE
+1];

722 
	md_comp
;

723 
	mh_comp
;

724 
	mIPv4AddrAŒoc
;

725 
	memîgícy_ödiˇti⁄
;

726 
	mP_CSCF_discovîy
;

727 
	mIM_CN_Sig«Œög_Fœg_Ind
;

728 } 
	t©_cgdc⁄t_t
;

742 
	#AT_CGACT_CID_MIN
 1

	)

744 
	#AT_CGACT_DEACTIVATED
 0

	)

745 
	#AT_CGACT_ACTIVATED
 1

	)

746 
	#AT_CGACT_STATE_MIN
 
AT_CGACT_DEACTIVATED


	)

747 
	#AT_CGACT_STATE_MAX
 
AT_CGACT_ACTIVATED


	)

748 
	#AT_CGACT_STATE_DEFAULT
 
AT_CGACT_DEACTIVATED


	)

751 
	#AT_CGACT_STATE_MASK
 
AT_COMMAND_PARAM1


	)

752 
	#AT_CGACT_CID_MASK
 
AT_COMMAND_PARAM2


	)

756 
	m°©e
;

757 
	mcid
;

758 } 
	t©_cga˘_t
;

769 
	#AT_CGPADDR_CID_MIN
 1

	)

772 
	#AT_CGPADDR_CID_MASK
 
AT_COMMAND_PARAM1


	)

776 
	mcid
;

777 } 
	t©_cg∑ddr_t
;

787 
©_comm™d_id_t
 
	mid
;

788 
©_comm™d_ty≥_t
 
	mty≥
;

789 
	mmask
;

791 
©_cg¢_t
 
	mcg¢
;

792 
©_cgmm_t
 
	mcgmm
;

793 
©_cgmr_t
 
	mcgmr
;

794 
©_cimi_t
 
	mcimi
;

795 
©_cfun_t
 
	mcfun
;

796 
©_˝ö_t
 
	m˝ö
;

797 
©_csq_t
 
	mcsq
;

798 
©_˚sq_t
 
	m˚sq
;

799 
©_˛ac_t
 
	m˛ac
;

800 
©_cmì_t
 
	mcmì
;

801 
©_˙um_t
 
	m˙um
;

802 
©_˛ck_t
 
	m˛ck
;

803 
©_c›s_t
 
	mc›s
;

804 
©_cg©t_t
 
	mcg©t
;

805 
©_¸eg_t
 
	m¸eg
;

806 
©_cgªg_t
 
	mcgªg
;

807 
©_˚ªg_t
 
	m˚ªg
;

808 
©_cgdc⁄t_t
 
	mcgdc⁄t
;

809 
©_cga˘_t
 
	mcga˘
;

810 
©_cg∑ddr_t
 
	mcg∑ddr
;

811 } 
	mcomm™d
;

812 } 
	t©_comm™d_t
;

842 
©_comm™d_decode
(c⁄° * 
buf„r
, 
Àngth
, 
©_comm™d_t
* 
©_comm™d
);

863 
©_comm™d_gë_li°
(c⁄° ** 
buf„r
, 
n_max
);

	@src/api/user/at_error.c

48 
	~"©_îr‹.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 
	~<°rög.h
>

53 
	~<°dio.h
>

59 
©_ª•⁄£_f‹m©_v1
;

67 
	g©_îr‹_code_suµªssi⁄_q1
 = 
FALSE
;

73 
©_îr‹_f‹m©_t
 
	g©_îr‹_f‹m©
 = 
AT_ERROR_OFF
;

83 c⁄° * 
	g_©_îr‹_°r
[] = {

92 
NULL
,

93 
NULL
,

103 
NULL
,

112 
NULL
,

113 
NULL
,

117 
NULL
,

118 
NULL
,

119 
NULL
,

120 
NULL
,

121 
NULL
,

122 
NULL
,

123 
NULL
,

141 c⁄° * 
	g_©_îr‹_g¥s
[] = {

143 
NULL
,

144 
NULL
,

147 
NULL
,

148 
NULL
,

149 
NULL
,

153 
NULL
,

154 
NULL
,

155 
NULL
,

156 
NULL
,

157 
NULL
,

158 
NULL
,

159 
NULL
,

160 
NULL
,

161 
NULL
,

162 
NULL
,

163 
NULL
,

164 
NULL
,

165 
NULL
,

166 
NULL
,

167 
NULL
,

168 
NULL
,

169 
NULL
,

170 
NULL
,

174 
NULL
,

175 
NULL
,

176 
NULL
,

177 
NULL
,

178 
NULL
,

179 
NULL
,

180 
NULL
,

181 
NULL
,

182 
NULL
,

183 
NULL
,

184 
NULL
,

185 
NULL
,

186 
NULL
,

197 c⁄° * 
	g_©_îr‹_vbs
[] = {

216 c⁄° * 
_©_îr‹_to_°rög
(
îr‹
);

218 
_©_îr‹_ícode_ok
(* 
buf„r
);

219 
_©_îr‹_ícode_ko
(* 
buf„r
, 
©_îr‹_ty≥_t
 
ty≥
, 
îr‹
);

238 
	$©_îr‹_£t_f‹m©
(
©_îr‹_f‹m©_t
 
f‹m©
)

240 
LOG_FUNC_IN
;

242 
©_îr‹_f‹m©
 = 
f‹m©
;

244 
LOG_FUNC_OUT
;

245 
	}
}

260 
©_îr‹_f‹m©_t
 
	$©_îr‹_gë_f‹m©
()

262 
LOG_FUNC_IN
;

264 
	`LOG_FUNC_RETURN
 (
©_îr‹_f‹m©
);

265 
	}
}

286 
	$©_îr‹_ícode
(* 
buf„r
, 
©_îr‹_ty≥_t
 
ty≥
, 
îr‹
)

288 
LOG_FUNC_IN
;

290 
byãs
 = 0;

293 i‡(
©_îr‹_code_suµªssi⁄_q1
) {

294 
	`LOG_FUNC_RETURN
 (0);

297 i‡(
ty≥
 =
AT_ERROR_OK
) {

299 
byãs
 = 
	`_©_îr‹_ícode_ok
(
buf„r
);

303 
byãs
 = 
	`_©_îr‹_ícode_ko
(
buf„r
, 
ty≥
, 
îr‹
);

306 
	`LOG_FUNC_RETURN
 (
byãs
);

307 
	}
}

328 
	$_©_îr‹_ícode_ok
(* 
buf„r
)

330 
LOG_FUNC_IN
;

332 
off£t
 = 0;

334 i‡(
©_ª•⁄£_f‹m©_v1
) {

335 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

337 
off£t
 +
	`•rötf
(
buf„r
 + offset, "OK\r\n");

339 
	`LOG_FUNC_RETURN
 (
off£t
);

340 
	}
}

358 
	$_©_îr‹_ícode_ko
(* 
buf„r
, 
©_îr‹_ty≥_t
 
ty≥
, 
îr‹
)

360 
LOG_FUNC_IN
;

362 
off£t
 = 0;

364 i‡(
©_ª•⁄£_f‹m©_v1
) {

365 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

369 i‡(
©_îr‹_f‹m©
 =
AT_ERROR_OFF
) {

370 
off£t
 +
	`•rötf
(
buf„r
 + offset, "ERROR\r\n");

375 i‡(
ty≥
 =
AT_ERROR_CME
) {

376 
off£t
 +
	`•rötf
(
buf„r
 + offset, "+CME ERROR: ");

380 i‡(
©_îr‹_f‹m©
 =
AT_ERROR_NUMERIC
) {

381 
off£t
 +
	`•rötf
(
buf„r
 + off£t, "%d\r\n", 
îr‹
);

386 c⁄° * 
îr‹_°r
 = 
	`_©_îr‹_to_°rög
(
îr‹
);

387 i‡(
îr‹_°r
 !
NULL
) {

388 
off£t
 +
	`•rötf
(
buf„r
 + off£t, "%s\r\n", 
îr‹_°r
);

392 
off£t
 +
	`•rötf
(
buf„r
 + offset, "invalidÉrror code\r\n");

397 
	`LOG_FUNC_RETURN
 (
off£t
);

398 
	}
}

414 c⁄° * 
	$_©_îr‹_to_°rög
(
îr‹
)

416 i‡(
îr‹
 < 
AT_ERROR_LAST_GENERAL_ERROR
 + 1)

419 i‡(
îr‹
 > 
AT_ERROR_FIRST_GENERAL_ERROR
 - 1) {

420  
_©_îr‹_°r
[
îr‹
];

423  
NULL
;

426 i‡(
îr‹
 < 
AT_ERROR_LAST_GPRS_RELATED_ERROR
 + 1)

429 i‡(
îr‹
 > 
AT_ERROR_FIRST_GPRS_RELATED_ERROR
 - 1) {

430  
_©_îr‹_g¥s
[
îr‹
 - 
AT_ERROR_FIRST_GPRS_RELATED_ERROR
];

433  
NULL
;

436 i‡(
îr‹
 < 
AT_ERROR_LAST_VBS_RELATED_ERROR
 + 1)

439 i‡(
îr‹
 > 
AT_ERROR_FIRST_VBS_RELATED_ERROR
 - 1) {

440  
_©_îr‹_vbs
[
îr‹
 - 
AT_ERROR_FIRST_VBS_RELATED_ERROR
];

443  
NULL
;

447  
NULL
;

448 
	}
}

	@src/api/user/at_error.h

47 #i‚de‡
__AT_ERROR_H__


48 
	#__AT_ERROR_H__


	)

58 
	#AT_ERROR_SUCCESS
 (-1)

	)

64 
	#AT_ERROR_FIRST_GENERAL_ERROR
 
AT_ERROR_PHONE_FAILURE


	)

66 
	#AT_ERROR_PHONE_FAILURE
 0

	)

67 
	#AT_ERROR_NO_CONNECTION_TO_PHONE
 1

	)

68 
	#AT_ERROR_PHONE_ADAPTOR_LINK_RESERVED
 2

	)

69 
	#AT_ERROR_OPERATION_NOT_ALLOWED
 3

	)

70 
	#AT_ERROR_OPERATION_NOT_SUPPORTED
 4

	)

71 
	#AT_ERROR_PHSIM_PIN_REQUIRED
 5

	)

72 
	#AT_ERROR_PHFSIM_PIN_REQUIRED
 6

	)

73 
	#AT_ERROR_PHFSIM_PUK_REQUIRED
 7

	)

75 
	#AT_ERROR_SIM_NOT_INSERTED
 10

	)

76 
	#AT_ERROR_SIM_PIN_REQUIRED
 11

	)

77 
	#AT_ERROR_SIM_PUK_REQUIRED
 12

	)

78 
	#AT_ERROR_SIM_FAILURE
 13

	)

79 
	#AT_ERROR_SIM_BUSY
 14

	)

80 
	#AT_ERROR_SIM_WRONG
 15

	)

81 
	#AT_ERROR_INCORRECT_PASSWD
 16

	)

82 
	#AT_ERROR_SIM_PIN2_REQUIRED
 17

	)

83 
	#AT_ERROR_SIM_PUK2_REQUIRED
 18

	)

85 
	#AT_ERROR_MEMORY_FULL
 20

	)

86 
	#AT_ERROR_INVALID_INDEX
 21

	)

87 
	#AT_ERROR_NOT_FOUND
 22

	)

88 
	#AT_ERROR_MEMORY_FAILURE
 23

	)

89 
	#AT_ERROR_TEXT_STRING_TOO_LONG
 24

	)

90 
	#AT_ERROR_TEXT_STRING_INVALID_CHAR
 25

	)

91 
	#AT_ERROR_DIAL_STRING_TOO_LONG
 26

	)

92 
	#AT_ERROR_DIAL_STRING_INVALID_CHAR
 27

	)

94 
	#AT_ERROR_NO_NETWORK_SERVICE
 30

	)

95 
	#AT_ERROR_TIMEOUT
 31

	)

96 
	#AT_ERROR_NETWORK_NOT_ALLOWED
 32

	)

98 
	#AT_ERROR_NETWORK_PERSO_PIN_REQUIRED
 40

	)

99 
	#AT_ERROR_NETWORK_PERSO_PUK_REQUIRED
 41

	)

100 
	#AT_ERROR_NETWORK_SUBNET_PERSO_PIN_REQUIRED
 42

	)

101 
	#AT_ERROR_SUBNET_PERSO_PUK_REQUIRED
 43

	)

102 
	#AT_ERROR_PROVIDER_PERSO_PIN_REQUIRED
 44

	)

103 
	#AT_ERROR_PROVIDER_PERSO_PUK_REQUIRED
 45

	)

104 
	#AT_ERROR_CORPORATE_PERSO_PIN_REQUIRED
 46

	)

105 
	#AT_ERROR_CORPORATE_PERSO_PUK_REQUIRED
 47

	)

106 
	#AT_ERROR_HIDDEN_KEY_REQUIRED
 48

	)

107 
	#AT_ERROR_EAP_METHOD_NOT_SUPPORTED
 49

	)

108 
	#AT_ERROR_INCORRECT_PARAMETERS
 50

	)

110 
	#AT_ERROR_LAST_GENERAL_ERROR
 
AT_ERROR_INCORRECT_PARAMETERS


	)

112 
	#AT_ERROR_UNKNOWN
 100

	)

119 
	#AT_ERROR_FIRST_GPRS_RELATED_ERROR
 
AT_ERROR_ILLEGAL_MS


	)

121 
	#AT_ERROR_ILLEGAL_MS
 103

	)

122 
	#AT_ERROR_ILLEGAL_ME
 106

	)

123 
	#AT_ERROR_GPRS_NOT_ALLOWED
 107

	)

124 
	#AT_ERROR_PLMN_NOT_ALLOWED
 111

	)

125 
	#AT_ERROR_LOCATION_AREA_NOT_ALLOWED
 112

	)

126 
	#AT_ERROR_ROAMING_NOT_ALLOWED
 113

	)

128 
	#AT_ERROR_OPTION_NOT_SUPPORTED
 132

	)

129 
	#AT_ERROR_OPTION_NOT_SUBSCRIBED
 133

	)

130 
	#AT_ERROR_OPTION_TEMPORARILY_OUT_OF_ORDER
 134

	)

131 
	#AT_ERROR_PDP_AUTHENTICATION_FAILURE
 149

	)

133 
	#AT_ERROR_LAST_PDP_DISCONNECT_NOT_ALLOWED
 151

	)

135 
	#AT_ERROR_UNSPECIFIED_GPRS_ERROR
 148

	)

136 
	#AT_ERROR_INVALID_MOBILE_CLASS
 150

	)

138 
	#AT_ERROR_LAST_GPRS_RELATED_ERROR
 
AT_ERROR_LAST_PDP_DISCONNECT_NOT_ALLOWED


	)

144 
	#AT_ERROR_FIRST_VBS_RELATED_ERROR
 
AT_ERROR_NO_SERVICE_SUBSCRIPTION_ON_SIM


	)

147 
	#AT_ERROR_NO_SERVICE_SUBSCRIPTION_ON_SIM
 152

	)

148 
	#AT_ERROR_NO_SUBSCRIPTION_FOR_GROUP_ID
 153

	)

149 
	#AT_ERROR_GROUP_ID_NOT_ACTIVATED_ON_SIM
 154

	)

150 
	#AT_ERROR_NO_MATCHING_NOTIFICATION
 155

	)

151 
	#AT_ERROR_VBS_VGCS_CALL_ALREADY_PRESENT
 156

	)

152 
	#AT_ERROR_CONGESTION
 157

	)

153 
	#AT_ERROR_NETWORK_FAILURE
 158

	)

154 
	#AT_ERROR_UPLINK_BUSY
 159

	)

155 
	#AT_ERROR_NO_ACCESS_RIGHTS_FOR_SIM_FILE
 160

	)

156 
	#AT_ERROR_NO_SUBSCRIPTION_FOR_PRIORITY
 161

	)

157 
	#AT_ERROR_OPERATION_NOT_APPLICABLE_OR_NOT_POSSIBLE
 162

	)

158 
	#AT_ERROR_GROUP_ID_PREFIXES_NOT_SUPPORTED
 163

	)

159 
	#AT_ERROR_GROUP_ID_PREFIXES_NOT_USABLE_FOR_VBS
 164

	)

160 
	#AT_ERROR_GROUP_ID_PREFIX_VALUE_INVALID
 165

	)

162 
	#AT_ERROR_LAST_VBS_RELATED_ERROR
 
AT_ERROR_GROUP_ID_PREFIX_VALUE_INVALID


	)

172 
	mAT_ERROR_NONE
,

173 
	mAT_ERROR_OK
,

174 
	mAT_ERROR_SYNTAX
,

175 
	mAT_ERROR_CME
,

177 } 
	t©_îr‹_ty≥_t
;

183 
	mAT_ERROR_OFF
,

184 
	mAT_ERROR_NUMERIC
,

185 
	mAT_ERROR_VERBOSE
,

186 } 
	t©_îr‹_f‹m©_t
;

196 
©_îr‹_£t_f‹m©
(
©_îr‹_f‹m©_t
 
f‹m©
);

197 
©_îr‹_f‹m©_t
 
©_îr‹_gë_f‹m©
();

199 
©_îr‹_ícode
(* 
buf„r
, 
©_îr‹_ty≥_t
 
ty≥
, 
îr‹
);

	@src/api/user/at_response.c

48 
	~"©_ª•⁄£.h
"

49 
	~"«s_log.h
"

51 
	~<°dio.h
>

52 
	~<°rög.h
>

53 
	~<as£π.h
>

65 
	g©_ª•⁄£_f‹m©_v1
 = 
TRUE
;

71 
_©_ª•⁄£_ícode_cg¢
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

72 
_©_ª•⁄£_ícode_cgmi
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

73 
_©_ª•⁄£_ícode_cgmm
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

74 
_©_ª•⁄£_ícode_cgmr
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

75 
_©_ª•⁄£_ícode_cimi
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

76 
_©_ª•⁄£_ícode_cfun
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

77 
_©_ª•⁄£_ícode_˝ö
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

78 
_©_ª•⁄£_ícode_csq
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

79 
_©_ª•⁄£_ícode_˚sq
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

80 
_©_ª•⁄£_ícode_˛ac
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

81 
_©_ª•⁄£_ícode_cmì
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

82 
_©_ª•⁄£_ícode_˙um
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

83 
_©_ª•⁄£_ícode_˛ck
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

84 
_©_ª•⁄£_ícode_c›s
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

85 
_©_ª•⁄£_ícode_cg©t
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

86 
_©_ª•⁄£_ícode_¸eg
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

87 
_©_ª•⁄£_ícode_cgªg
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

88 
_©_ª•⁄£_ícode_˚ªg
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

89 
_©_ª•⁄£_ícode_cgdc⁄t
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

90 
_©_ª•⁄£_ícode_cga˘
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

91 
_©_ª•⁄£_ícode_cg∑ddr
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

92 
_©_ª•⁄£_ícode_cgev
 (* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
);

95 (*
	t_©_ª•⁄£_ícode_fun˘i⁄_t
Ë(* 
	tbuf„r
, c⁄° 
	t©_ª•⁄£_t
*);

97 
_©_ª•⁄£_ícode_fun˘i⁄_t
 
_©_ª•⁄£_ícode_fun˘i⁄
[
AT_RESPONSE_ID_MAX
] = {

98 
NULL
,

99 
_©_ª•⁄£_ícode_cg¢
,

100 
_©_ª•⁄£_ícode_cgmi
,

101 
_©_ª•⁄£_ícode_cgmm
,

102 
_©_ª•⁄£_ícode_cgmr
,

103 
_©_ª•⁄£_ícode_cimi
,

104 
_©_ª•⁄£_ícode_cfun
,

105 
_©_ª•⁄£_ícode_˝ö
,

106 
_©_ª•⁄£_ícode_csq
,

107 
_©_ª•⁄£_ícode_˚sq
,

108 
_©_ª•⁄£_ícode_˛ac
,

109 
_©_ª•⁄£_ícode_cmì
,

110 
_©_ª•⁄£_ícode_˙um
,

111 
_©_ª•⁄£_ícode_˛ck
,

112 
_©_ª•⁄£_ícode_c›s
,

113 
_©_ª•⁄£_ícode_¸eg
,

114 
_©_ª•⁄£_ícode_cg©t
,

115 
_©_ª•⁄£_ícode_cgªg
,

116 
_©_ª•⁄£_ícode_˚ªg
,

117 
_©_ª•⁄£_ícode_cgdc⁄t
,

118 
_©_ª•⁄£_ícode_cga˘
,

119 
_©_ª•⁄£_ícode_cg∑ddr
,

120 
_©_ª•⁄£_ícode_cgev
,

121 
	}
};

124 c⁄° * 
	g_©_ª•⁄£_evít_°r
[] = {

155 
	$©_ª•⁄£_ícode
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
©_ª•⁄£
)

157 
LOG_FUNC_IN
;

159 
byãs
 = 
RETURNîr‹
;

160 
_©_ª•⁄£_ícode_fun˘i⁄_t
 
ícode
;

162 i‡(
©_ª•⁄£
->
id
 < 
AT_RESPONSE_ID_MAX
)

165 
ícode
 = 
_©_ª•⁄£_ícode_fun˘i⁄
[
©_ª•⁄£
->
id
];

166 i‡(
ícode
 !
NULL
) {

167 
byãs
 = (*
ícode
)(
buf„r
, 
©_ª•⁄£
);

171 
byãs
 = 0;

175 
	`LOG_FUNC_RETURN
 (
byãs
);

176 
	}
}

197 
	$_©_ª•⁄£_ícode_cg¢
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

199 
LOG_FUNC_IN
;

201 
off£t
 = 0;

203 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

204 c⁄° 
©_cg¢_ª•_t
 * 
cg¢
 = &(
d©a
->
ª•⁄£
.cgsn);

205 i‡(
©_ª•⁄£_f‹m©_v1
) {

206 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

208 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGSN: %s\r\n", 
cg¢
->
¢
);

211 
	`LOG_FUNC_RETURN
 (
off£t
);

212 
	}
}

229 
	$_©_ª•⁄£_ícode_cgmi
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

231 
LOG_FUNC_IN
;

233 
off£t
 = 0;

235 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

236 c⁄° 
©_cgmi_ª•_t
 * 
cgmi
 = &(
d©a
->
ª•⁄£
.cgmi);

237 i‡(
©_ª•⁄£_f‹m©_v1
) {

238 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

240 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGMI: %s\r\n", 
cgmi
->
m™uÁ˘uªr
);

243 
	`LOG_FUNC_RETURN
 (
off£t
);

244 
	}
}

261 
	$_©_ª•⁄£_ícode_cgmm
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

263 
LOG_FUNC_IN
;

265 
off£t
 = 0;

267 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

268 c⁄° 
©_cgmm_ª•_t
 * 
cgmm
 = &(
d©a
->
ª•⁄£
.cgmm);

269 i‡(
©_ª•⁄£_f‹m©_v1
) {

270 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

272 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGMM: %s\r\n", 
cgmm
->
modñ
);

275 
	`LOG_FUNC_RETURN
 (
off£t
);

276 
	}
}

293 
	$_©_ª•⁄£_ícode_cgmr
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

295 
LOG_FUNC_IN
;

297 
off£t
 = 0;

299 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

300 c⁄° 
©_cgmr_ª•_t
 * 
cgmr
 = &(
d©a
->
ª•⁄£
.cgmr);

301 i‡(
©_ª•⁄£_f‹m©_v1
) {

302 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

304 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGMR: %s\r\n", 
cgmr
->
ªvisi⁄
);

307 
	`LOG_FUNC_RETURN
 (
off£t
);

308 
	}
}

325 
	$_©_ª•⁄£_ícode_cimi
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

327 
LOG_FUNC_IN
;

329 
off£t
 = 0;

331 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

332 c⁄° 
©_cimi_ª•_t
 * 
cimi
 = &(
d©a
->
ª•⁄£
.cimi);

333 i‡(
©_ª•⁄£_f‹m©_v1
) {

334 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

336 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CIMI: %s\r\n", 
cimi
->
IMSI
);

339 
	`LOG_FUNC_RETURN
 (
off£t
);

340 
	}
}

357 
	$_©_ª•⁄£_ícode_cfun
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

359 
LOG_FUNC_IN
;

361 c⁄° 
©_cfun_ª•_t
 * 
cfun
 = &(
d©a
->
ª•⁄£
.cfun);

362 
off£t
 = 0;

364 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
) {

365 i‡(
©_ª•⁄£_f‹m©_v1
) {

366 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

368 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CFUN: %d\r\n", 
cfun
->
fun
);

370 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
) {

371 i‡(
©_ª•⁄£_f‹m©_v1
) {

372 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

374 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CFUN: (%d-%d),(%d,%d)\r\n",

375 
AT_CFUN_MIN
, 
AT_CFUN_MAX
, 
AT_CFUN_NORST
, 
AT_CFUN_RST
);

378 
	`LOG_FUNC_RETURN
 (
off£t
);

379 
	}
}

396 
	$_©_ª•⁄£_ícode_˝ö
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

398 
LOG_FUNC_IN
;

400 
off£t
 = 0;

402 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
) {

403 c⁄° 
©_˝ö_ª•_t
 * 
˝ö
 = &(
d©a
->
ª•⁄£
.cpin);

404 i‡(
©_ª•⁄£_f‹m©_v1
) {

405 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

407 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CPIN: %s\r\n", 
˝ö
->
code
);

410 
	`LOG_FUNC_RETURN
 (
off£t
);

411 
	}
}

428 
	$_©_ª•⁄£_ícode_csq
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

430 
LOG_FUNC_IN
;

432 c⁄° 
©_csq_ª•_t
 * 
csq
 = &(
d©a
->
ª•⁄£
.csq);

433 
off£t
 = 0;

435 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

436 i‡(
©_ª•⁄£_f‹m©_v1
) {

437 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

439 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CSQ: %d,%d\r\n",

440 
csq
->
rssi
, csq->
bî
);

442 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
) {

443 i‡(
©_ª•⁄£_f‹m©_v1
) {

444 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

446 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CSQ: (%d-%d),(%d-%d)\r\n",

447 
AT_CSQ_RSSI_0
, 
AT_CSQ_RSSI_31
,

448 
AT_CSQ_BER_0
, 
AT_CSQ_BER_7
);

451 
	`LOG_FUNC_RETURN
 (
off£t
);

452 
	}
}

469 
	$_©_ª•⁄£_ícode_˚sq
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

471 
LOG_FUNC_IN
;

473 c⁄° 
©_˚sq_ª•_t
 * 
˚sq
 = &(
d©a
->
ª•⁄£
.cesq);

474 
off£t
 = 0;

476 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

477 i‡(
©_ª•⁄£_f‹m©_v1
) {

478 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

480 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CESQ: %d,%d,%d,%d,%d,%d\r\n",

481 
˚sq
->
rssi
, cesq->
bî
, cesq->
rs˝
,

482 
˚sq
->
e˙o
, cesq->
r§q
, cesq->
r§p
);

484 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
) {

485 i‡(
©_ª•⁄£_f‹m©_v1
) {

486 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

488 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CESQ: (%d-%d),(%d-%d),(%d-%d),"

490 
AT_CESQ_RSSI_0
, 
AT_CESQ_RSSI_31
,

491 
AT_CESQ_BER_0
, 
AT_CESQ_BER_7
,

492 
AT_CESQ_RSCP_0
, 
AT_CESQ_RSCP_96
,

493 
AT_CESQ_ECNO_0
, 
AT_CESQ_ECNO_49
,

494 
AT_CESQ_RSRQ_0
, 
AT_CESQ_RSRQ_34
,

495 
AT_CESQ_RSRP_0
, 
AT_CESQ_RSRP_97
);

498 
	`LOG_FUNC_RETURN
 (
off£t
);

499 
	}
}

516 
	$_©_ª•⁄£_ícode_˛ac
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

518 
LOG_FUNC_IN
;

520 c⁄° 
©_˛ac_ª•_t
 * 
˛ac
 = &(
d©a
->
ª•⁄£
.clac);

521 
off£t
 = 0;

522 
i
;

524 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

525 i‡(
˛ac
->
n_acs
 > 0) {

526 i‡(
©_ª•⁄£_f‹m©_v1
) {

527 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

529 
off£t
 +
	`•rötf
(
buf„r
+off£t, "%s", 
˛ac
->
ac
[0]);

530 
i
 = 1; i < 
˛ac
->
n_acs
; i++) {

531 
off£t
 +
	`•rötf
(
buf„r
+off£t, "\r\n%s", 
˛ac
->
ac
[
i
]);

536 
	`LOG_FUNC_RETURN
 (
off£t
);

537 
	}
}

554 
	$_©_ª•⁄£_ícode_˙um
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

556 
LOG_FUNC_IN
;

558 
off£t
 = 0;

560 i‡(
d©a
->
ty≥
 =
AT_COMMAND_ACT
) {

561 c⁄° 
©_˙um_ª•_t
 * 
˙um
 = &(
d©a
->
ª•⁄£
.cnum);

562 i‡(
©_ª•⁄£_f‹m©_v1
) {

563 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

565 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CNUM: ,%s,%u\r\n",

566 
˙um
->
numbî
, cnum->
ty≥
);

569 
	`LOG_FUNC_RETURN
 (
off£t
);

570 
	}
}

587 
	$_©_ª•⁄£_ícode_˛ck
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

589 
LOG_FUNC_IN
;

591 c⁄° 
©_˛ck_ª•_t
 * 
˛ck
 = &(
d©a
->
ª•⁄£
.clck);

592 
off£t
 = 0;

594 i‡(
d©a
->
ty≥
 =
AT_COMMAND_SET
) {

595 i‡(
©_ª•⁄£_f‹m©_v1
) {

596 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

598 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CLCK: %d\r\n", 
˛ck
->
°©us
);

600 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
) {

601 i‡(
©_ª•⁄£_f‹m©_v1
) {

602 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

604 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CLCK: %s\r\n", 
AT_CLCK_SC
);

607 
	`LOG_FUNC_RETURN
 (
off£t
);

608 
	}
}

625 
	$_©_ª•⁄£_ícode_c›s
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

627 
LOG_FUNC_IN
;

629 
off£t
 = 0;

631 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

633 c⁄° 
©_c›s_gë_t
 * 
c›s
 = &(
d©a
->
ª•⁄£
.c›s.
gë
);

634 i‡(
©_ª•⁄£_f‹m©_v1
) {

635 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

637 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+COPS: %d", 
c›s
->
mode
);

638 i‡(
d©a
->
mask
 & 
AT_COPS_RESP_OPER_MASK
)

641 
	`as£π
(
d©a
->
mask
 & 
AT_COPS_RESP_FORMAT_MASK
);

642 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%d", 
c›s
->
f‹m©
);

643 i‡(
c›s
->
f‹m©
 =
AT_COPS_LONG
) {

644 
off£t
 +
	`•rötf
(
buf„r
+offset, ",%s",

645 (*)
c›s
->
∂mn
.
id
.
Æpha_l⁄g
);

647 i‡(
c›s
->
f‹m©
 =
AT_COPS_SHORT
) {

648 
off£t
 +
	`•rötf
(
buf„r
+offset, ",%s",

649 (*)
c›s
->
∂mn
.
id
.
Æpha_sh‹t
);

651 i‡(
c›s
->
f‹m©
 =
AT_COPS_NUM
) {

652 
off£t
 +
	`•rötf
(
buf„r
+offset, ",%s",

653 (*)
c›s
->
∂mn
.
id
.
num
);

656 i‡(
d©a
->
mask
 & 
AT_COPS_RESP_ACT_MASK
) {

657 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%d", 
c›s
->
AcT
);

659 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

661 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

663 c⁄° 
©_c›s_t°_t
 * 
c›s
 = &(
d©a
->
ª•⁄£
.c›s.
t°
);

664 i‡(
©_ª•⁄£_f‹m©_v1
) {

665 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

667 
off£t
 +
	`•rötf
(
buf„r
+offset, "+COPS: ");

670 
	`°∫˝y
(
buf„r
+
off£t
, 
c›s
->
d©a
, c›s->
size
);

671 
off£t
 +
c›s
->
size
;

678 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

681 
	`LOG_FUNC_RETURN
 (
off£t
);

682 
	}
}

699 
	$_©_ª•⁄£_ícode_cg©t
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

701 
LOG_FUNC_IN
;

703 
off£t
 = 0;

705 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

707 c⁄° 
©_cg©t_ª•_t
 * 
cg©t
 = &(
d©a
->
ª•⁄£
.cgatt);

708 i‡(
©_ª•⁄£_f‹m©_v1
) {

709 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

711 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGATT: %d\r\n", 
cg©t
->
°©e
);

713 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

715 i‡(
©_ª•⁄£_f‹m©_v1
) {

716 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

718 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGATT: (%d,%d)\r\n",

719 
AT_CGATT_STATE_MIN
, 
AT_CGATT_STATE_MAX
);

722 
	`LOG_FUNC_RETURN
 (
off£t
);

723 
	}
}

740 
	$_©_ª•⁄£_ícode_¸eg
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

742 
LOG_FUNC_IN
;

744 
off£t
 = 0;

746 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

748 c⁄° 
©_¸eg_ª•_t
 * 
¸eg
 = &(
d©a
->
ª•⁄£
.creg);

749 i‡(
©_ª•⁄£_f‹m©_v1
) {

750 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

752 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CREG: %d,%d",

753 
¸eg
->
n
, cªg->
°©
);

754 i‡(
d©a
->
mask
 & 
AT_CREG_RESP_LAC_MASK
) {

755 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
¸eg
->
œc
);

757 i‡(
d©a
->
mask
 & 
AT_CREG_RESP_CI_MASK
) {

758 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
¸eg
->
ci
);

760 i‡(
d©a
->
mask
 & 
AT_CREG_RESP_ACT_MASK
) {

761 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%d", 
¸eg
->
AcT
);

763 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

765 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

767 i‡(
©_ª•⁄£_f‹m©_v1
) {

768 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

770 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CREG: (%d-%d)\r\n",

771 
AT_CREG_N_MIN
, 
AT_CREG_N_MAX
);

774 
	`LOG_FUNC_RETURN
 (
off£t
);

775 
	}
}

792 
	$_©_ª•⁄£_ícode_cgªg
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

794 
LOG_FUNC_IN
;

796 
off£t
 = 0;

798 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

800 c⁄° 
©_cgªg_ª•_t
 * 
cgªg
 = &(
d©a
->
ª•⁄£
.cgreg);

801 i‡(
©_ª•⁄£_f‹m©_v1
) {

802 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

804 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGREG: %d,%d",

805 
cgªg
->
n
, cgªg->
°©
);

806 i‡(
d©a
->
mask
 & 
AT_CGREG_RESP_LAC_MASK
) {

807 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
cgªg
->
œc
);

809 i‡(
d©a
->
mask
 & 
AT_CGREG_RESP_CI_MASK
) {

810 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
cgªg
->
ci
);

812 i‡(
d©a
->
mask
 & 
AT_CGREG_RESP_ACT_MASK
) {

813 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%d", 
cgªg
->
AcT
);

815 i‡(
d©a
->
mask
 & 
AT_CGREG_RESP_RAC_MASK
) {

816 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
cgªg
->
øc
);

818 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

820 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

822 i‡(
©_ª•⁄£_f‹m©_v1
) {

823 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

825 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGREG: (%d-%d)\r\n",

826 
AT_CGREG_N_MIN
, 
AT_CGREG_N_MAX
);

829 
	`LOG_FUNC_RETURN
 (
off£t
);

830 
	}
}

847 
	$_©_ª•⁄£_ícode_˚ªg
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

849 
LOG_FUNC_IN
;

851 
off£t
 = 0;

853 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

855 c⁄° 
©_˚ªg_ª•_t
 * 
˚ªg
 = &(
d©a
->
ª•⁄£
.cereg);

856 i‡(
©_ª•⁄£_f‹m©_v1
) {

857 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

859 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CEREG: %d,%d",

860 
˚ªg
->
n
, cîeg->
°©
);

861 i‡(
d©a
->
mask
 & 
AT_CEREG_RESP_TAC_MASK
) {

862 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
˚ªg
->
èc
);

864 i‡(
d©a
->
mask
 & 
AT_CEREG_RESP_CI_MASK
) {

865 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
˚ªg
->
ci
);

867 i‡(
d©a
->
mask
 & 
AT_CEREG_RESP_ACT_MASK
) {

868 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%d", 
˚ªg
->
AcT
);

870 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

872 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

874 i‡(
©_ª•⁄£_f‹m©_v1
) {

875 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

877 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CEREG: (%d-%d)\r\n",

878 
AT_CEREG_N_MIN
, 
AT_CEREG_N_MAX
);

881 
	`LOG_FUNC_RETURN
 (
off£t
);

882 
	}
}

899 
	$_©_ª•⁄£_ícode_cgdc⁄t
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

901 
LOG_FUNC_IN
;

903 
off£t
 = 0;

904 
i
;

906 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

908 c⁄° 
©_cgdc⁄t_gë_t
 * 
cgdc⁄t
 = &(
d©a
->
ª•⁄£
.cgdc⁄t.
gë
);

909 i‡(
©_ª•⁄£_f‹m©_v1
) {

910 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

914 
i
 = 0; i < 
cgdc⁄t
->
n_pdns
; i++) {

915 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGDCONT: %u", 
cgdc⁄t
->
cid
[
i
]);

916 i‡(
cgdc⁄t
->
PDP_ty≥
[
i
] =
NET_PDN_TYPE_IPV4
) {

917 
off£t
 +
	`•rötf
(
buf„r
+offset, ",IP");

919 i‡(
cgdc⁄t
->
PDP_ty≥
[
i
] =
NET_PDN_TYPE_IPV6
) {

920 
off£t
 +
	`•rötf
(
buf„r
+offset, ",IPV6");

922 i‡(
cgdc⁄t
->
PDP_ty≥
[
i
] =
NET_PDN_TYPE_IPV4V6
) {

923 
off£t
 +
	`•rötf
(
buf„r
+offset, ",IPV4V6");

925 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%s", 
cgdc⁄t
->
APN
[
i
]);

927 
off£t
 +
	`•rötf
(
buf„r
+offset, ",%u,%u\r\n",

928 
AT_CGDCONT_D_COMP_OFF
, 
AT_CGDCONT_H_COMP_OFF
);

931 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

933 c⁄° 
©_cgdc⁄t_t°_t
 * 
cgdc⁄t
 = &(
d©a
->
ª•⁄£
.cgdc⁄t.
t°
);

934 i‡(
©_ª•⁄£_f‹m©_v1
) {

935 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

939 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGDCONT: ");

940 
off£t
 +
	`•rötf
(
buf„r
+offset, "(1-%u),IP,,,(%u-%u),(%u-%u)",

941 
cgdc⁄t
->
n_cid
,

942 
AT_CGDCONT_D_COMP_MIN
, 
AT_CGDCONT_D_COMP_MAX
,

943 
AT_CGDCONT_H_COMP_MIN
, 
AT_CGDCONT_H_COMP_MAX
);

945 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n+CGDCONT: ");

946 
off£t
 +
	`•rötf
(
buf„r
+offset, "(1-%u),IPV6,,,(%u-%u),(%u-%u)",

947 
cgdc⁄t
->
n_cid
,

948 
AT_CGDCONT_D_COMP_MIN
, 
AT_CGDCONT_D_COMP_MAX
,

949 
AT_CGDCONT_H_COMP_MIN
, 
AT_CGDCONT_H_COMP_MAX
);

951 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n+CGDCONT: ");

952 
off£t
 +
	`•rötf
(
buf„r
+offset, "(1-%u),IPV4V6,,,(%u-%u),(%u-%u)",

953 
cgdc⁄t
->
n_cid
,

954 
AT_CGDCONT_D_COMP_MIN
, 
AT_CGDCONT_D_COMP_MAX
,

955 
AT_CGDCONT_H_COMP_MIN
, 
AT_CGDCONT_H_COMP_MAX
);

957 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

960 
	`LOG_FUNC_RETURN
 (
off£t
);

961 
	}
}

978 
	$_©_ª•⁄£_ícode_cga˘
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

980 
LOG_FUNC_IN
;

982 
off£t
 = 0;

983 
i
;

985 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

987 c⁄° 
©_cga˘_ª•_t
 * 
cga˘
 = &(
d©a
->
ª•⁄£
.cgact);

988 i‡(
©_ª•⁄£_f‹m©_v1
) {

989 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

992 
i
 = 0; i < 
cga˘
->
n_pdns
; i++) {

993 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGACT: %u,%u\r\n",

994 
cga˘
->
cid
[
i
], cga˘->
°©e
[i]);

997 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

999 i‡(
©_ª•⁄£_f‹m©_v1
) {

1000 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

1002 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGACT: (%d,%d)\r\n",

1003 
AT_CGACT_STATE_MIN
, 
AT_CGACT_STATE_MAX
);

1006 
	`LOG_FUNC_RETURN
 (
off£t
);

1007 
	}
}

1024 
	$_©_ª•⁄£_ícode_cg∑ddr
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

1026 
LOG_FUNC_IN
;

1028 
off£t
 = 0;

1029 c⁄° 
©_cg∑ddr_ª•_t
 * 
cg∑ddr
 = &(
d©a
->
ª•⁄£
.cgpaddr);

1030 
i
;

1032 i‡(
d©a
->
ty≥
 =
AT_COMMAND_SET
)

1034 i‡(
©_ª•⁄£_f‹m©_v1
) {

1035 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

1039 
i
 = 0; i < 
cg∑ddr
->
n_pdns
; i++) {

1040 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGPADDR: %u", 
cg∑ddr
->
cid
[
i
]);

1041 i‡(
cg∑ddr
->
PDP_addr_1
[
i
] !
NULL
) {

1043 
off£t
 +
	`•rötf
(
buf„r
+offset, ",%hhu.%hhu.%hhu.%hhu",

1044 
cg∑ddr
->
PDP_addr_1
[
i
][0],

1045 
cg∑ddr
->
PDP_addr_1
[
i
][1],

1046 
cg∑ddr
->
PDP_addr_1
[
i
][2],

1047 
cg∑ddr
->
PDP_addr_1
[
i
][3]);

1049 i‡(
cg∑ddr
->
PDP_addr_2
[
i
] !
NULL
) {

1051 
off£t
 +
	`•rötf
(
buf„r
+offset,

1055 
off£t
 +
	`•rötf
(
buf„r
+offset,

1057 
cg∑ddr
->
PDP_addr_2
[
i
][0],

1058 
cg∑ddr
->
PDP_addr_2
[
i
][1],

1059 
cg∑ddr
->
PDP_addr_2
[
i
][2],

1060 
cg∑ddr
->
PDP_addr_2
[
i
][3],

1061 
cg∑ddr
->
PDP_addr_2
[
i
][4],

1062 
cg∑ddr
->
PDP_addr_2
[
i
][5],

1063 
cg∑ddr
->
PDP_addr_2
[
i
][6],

1064 
cg∑ddr
->
PDP_addr_2
[
i
][7]);

1066 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

1069 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

1072 i‡(
cg∑ddr
->
n_pdns
 > 0) {

1073 i‡(
©_ª•⁄£_f‹m©_v1
) {

1074 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

1076 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CGPADDR: %u", 
cg∑ddr
->
cid
[0]);

1077 
i
 = 1; i < 
cg∑ddr
->
n_pdns
; i++) {

1078 
off£t
 +
	`•rötf
(
buf„r
+off£t, ",%u", 
cg∑ddr
->
cid
[
i
]);

1080 
off£t
 +
	`•rötf
(
buf„r
+offset, "\r\n");

1084 
	`LOG_FUNC_RETURN
 (
off£t
);

1085 
	}
}

1102 
	$_©_ª•⁄£_ícode_cmì
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

1104 
LOG_FUNC_IN
;

1106 
off£t
 = 0;

1108 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

1110 c⁄° 
©_cmì_ª•_t
 * 
cmì
 = &(
d©a
->
ª•⁄£
.cmee);

1111 i‡(
©_ª•⁄£_f‹m©_v1
) {

1112 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

1114 
off£t
 +
	`•rötf
(
buf„r
+off£t, "+CMEE: %d\r\n", 
cmì
->
n
);

1116 i‡(
d©a
->
ty≥
 =
AT_COMMAND_TST
)

1118 i‡(
©_ª•⁄£_f‹m©_v1
) {

1119 
off£t
 +
	`•rötf
(
buf„r
, "\r\n");

1121 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CMEE: (%d,%d)\r\n",

1122 
AT_CMEE_N_MIN
, 
AT_CMEE_N_MAX
);

1125 
	`LOG_FUNC_RETURN
 (
off£t
);

1126 
	}
}

1143 
	$_©_ª•⁄£_ícode_cgev
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
d©a
)

1145 
LOG_FUNC_IN
;

1147 
off£t
 = 0;

1149 i‡(
d©a
->
ty≥
 =
AT_COMMAND_GET
)

1151 c⁄° 
©_cgev_ª•_t
 * 
cgev
 = &(
d©a
->
ª•⁄£
.cgev);

1152 
off£t
 +
	`•rötf
(
buf„r
+offset, "+CGEV: %s %u\r\n",

1153 
_©_ª•⁄£_evít_°r
[
cgev
->
code
], cgev->
cid
);

1156 
	`LOG_FUNC_RETURN
 (
off£t
);

1157 
	}
}

	@src/api/user/at_response.h

47 #i‚de‡
__AT_RESPONSE_H__


48 
	#__AT_RESPONSE_H__


	)

50 
	~"©_comm™d.h
"

51 
	~"comm⁄Def.h
"

52 
	~"√tw‹kDef.h
"

61 
	#AT_RESPONSE_INFO_TEXT_SIZE
 2048

	)

67 
	#AT_RESPONSE_NO_PARAM
 
AT_COMMAND_PARAM0


	)

72 
	#AT_RESPONSE_ID_MAX
 
AT_COMMAND_ID_MAX


	)

94 
	#AT_RESPONSE_CGSN_MASK
 
AT_RESPONSE_NO_PARAM


	)

98 
	m¢
[
AT_RESPONSE_INFO_TEXT_SIZE
+1];

99 } 
	t©_cg¢_ª•_t
;

111 
	#AT_RESPONSE_CGMI_MASK
 
AT_RESPONSE_NO_PARAM


	)

115 
	mm™uÁ˘uªr
[
AT_RESPONSE_INFO_TEXT_SIZE
+1];

116 } 
	t©_cgmi_ª•_t
;

127 
	#AT_RESPONSE_CGMM_MASK
 
AT_RESPONSE_NO_PARAM


	)

131 
	mmodñ
[
AT_RESPONSE_INFO_TEXT_SIZE
+1];

132 } 
	t©_cgmm_ª•_t
;

144 
	#AT_RESPONSE_CGMR_MASK
 
AT_RESPONSE_NO_PARAM


	)

148 
	mªvisi⁄
[
AT_RESPONSE_INFO_TEXT_SIZE
+1];

149 } 
	t©_cgmr_ª•_t
;

163 
	#AT_RESPONSE_CIMI_MASK
 
AT_RESPONSE_NO_PARAM


	)

167 
	mIMSI
[
AT_RESPONSE_INFO_TEXT_SIZE
+1];

168 } 
	t©_cimi_ª•_t
;

186 
	#AT_RESPONSE_CFUN_MASK
 
AT_RESPONSE_NO_PARAM


	)

190 
	mfun
;

191 } 
	t©_cfun_ª•_t
;

203 
	#AT_RESPONSE_CPIN_MASK
 
AT_RESPONSE_NO_PARAM


	)

207 
	#AT_CPIN_RESP_SIZE
 16

	)

208 
	mcode
[
AT_CPIN_RESP_SIZE
+1];

209 } 
	t©_˝ö_ª•_t
;

222 
	#AT_CSQ_RSSI_0
 0

	)

223 
	#AT_CSQ_RSSI_31
 31

	)

224 
	#AT_CSQ_RSSI_UNKNOWN
 99

	)

227 
	#AT_CSQ_BER_0
 0

	)

228 
	#AT_CSQ_BER_1
 1

	)

229 
	#AT_CSQ_BER_2
 2

	)

230 
	#AT_CSQ_BER_3
 3

	)

231 
	#AT_CSQ_BER_4
 4

	)

232 
	#AT_CSQ_BER_5
 5

	)

233 
	#AT_CSQ_BER_6
 6

	)

234 
	#AT_CSQ_BER_7
 7

	)

235 
	#AT_CSQ_BER_UNKNOWN
 99

	)

238 
	#AT_RESPONSE_CSQ_MASK
 
AT_RESPONSE_NO_PARAM


	)

242 
	mrssi
;

243 
	mbî
;

244 } 
	t©_csq_ª•_t
;

260 
	#AT_CESQ_RSSI_0
 0

	)

261 
	#AT_CESQ_RSSI_31
 31

	)

262 
	#AT_CESQ_RSSI_UNKNOWN
 99

	)

265 
	#AT_CESQ_BER_0
 0

	)

266 
	#AT_CESQ_BER_1
 1

	)

267 
	#AT_CESQ_BER_2
 2

	)

268 
	#AT_CESQ_BER_3
 3

	)

269 
	#AT_CESQ_BER_4
 4

	)

270 
	#AT_CESQ_BER_5
 5

	)

271 
	#AT_CESQ_BER_6
 6

	)

272 
	#AT_CESQ_BER_7
 7

	)

273 
	#AT_CESQ_BER_UNKNOWN
 99

	)

276 
	#AT_CESQ_RSCP_0
 0

	)

277 
	#AT_CESQ_RSCP_96
 96

	)

278 
	#AT_CESQ_RSCP_UNKNOWN
 255

	)

281 
	#AT_CESQ_ECNO_0
 0

	)

282 
	#AT_CESQ_ECNO_49
 49

	)

283 
	#AT_CESQ_ECNO_UNKNOWN
 255

	)

286 
	#AT_CESQ_RSRQ_0
 0

	)

287 
	#AT_CESQ_RSRQ_34
 34

	)

288 
	#AT_CESQ_RSRQ_UNKNOWN
 255

	)

291 
	#AT_CESQ_RSRP_0
 0

	)

292 
	#AT_CESQ_RSRP_97
 97

	)

293 
	#AT_CESQ_RSRP_UNKNOWN
 255

	)

296 
	#AT_RESPONSE_CESQ_MASK
 
AT_RESPONSE_NO_PARAM


	)

300 
	mrssi
;

301 
	mbî
;

302 
	mrs˝
;

303 
	me˙o
;

304 
	mr§q
;

305 
	mr§p
;

306 } 
	t©_˚sq_ª•_t
;

317 
	#AT_RESPONSE_CLAC_MASK
 
AT_RESPONSE_NO_PARAM


	)

321 
	mn_acs
;

322 
	#AT_CLAC_RESP_SIZE
 100

	)

323 c⁄° * 
	mac
[
AT_CLAC_RESP_SIZE
];

324 } 
	t©_˛ac_ª•_t
;

342 
	#AT_RESPONSE_CMEE_MASK
 
AT_RESPONSE_NO_PARAM


	)

345 
©_cmì_t
 
	t©_cmì_ª•_t
;

363 
	#AT_RESPONSE_CNUM_MASK
 
AT_RESPONSE_NO_PARAM


	)

367 
	#AT_CNUM_NUMBER_SIZE
 
MSISDN_DIGIT_SIZE


	)

368 
	mnumbî
[
AT_CNUM_NUMBER_SIZE
];

369 
	mty≥
;

370 } 
	t©_˙um_ª•_t
;

380 
	#AT_CLCK_RESP_STATUS_NOT_ACTIVE
 0

	)

381 
	#AT_CLCK_RESP_STATUS_ACTIVE
 1

	)

384 
	#AT_RESPONSE_CLCK_MASK
 
AT_RESPONSE_NO_PARAM


	)

388 
	m°©us
;

389 } 
	t©_˛ck_ª•_t
;

410 
	#AT_COPS_RESP_FORMAT_MASK
 
AT_COMMAND_PARAM2


	)

411 
	#AT_COPS_RESP_OPER_MASK
 
AT_COMMAND_PARAM3


	)

412 
	#AT_COPS_RESP_ACT_MASK
 
AT_COMMAND_PARAM4


	)

416 c⁄° * 
	md©a
;

417 
	msize
;

418 } 
	t©_c›s_t°_t
;

421 
©_c›s_t
 
	t©_c›s_gë_t
;

425 
©_c›s_t°_t
 
	mt°
;

426 
©_c›s_gë_t
 
	mgë
;

427 } 
	t©_c›s_ª•_t
;

449 
	#AT_CREG_RESP_REG_OFF
 
NET_REG_STATE_OFF


	)

450 
	#AT_CREG_RESP_REG_HN
 
NET_REG_STATE_HN


	)

451 
	#AT_CREG_RESP_REG_ON
 
NET_REG_STATE_ON


	)

452 
	#AT_CREG_RESP_REG_DENIED
 
NET_REG_STATE_DENIED


	)

453 
	#AT_CREG_RESP_REG_UNKNOWN
 
NET_REG_STATE_UNKNOWN


	)

454 
	#AT_CREG_RESP_REG_SMS_HN
 
NET_REG_STATE_SMS_HN


	)

455 
	#AT_CREG_RESP_REG_SMS_ROAMING
 
NET_REG_STATE_SMS_ROAMING


	)

456 
	#AT_CREG_RESP_REG_ROAMING
 
NET_REG_STATE_ROAMING


	)

459 
	#AT_CREG_RESP_GSM
 
NET_ACCESS_GSM


	)

460 
	#AT_CREG_RESP_COMPACT
 
NET_ACCESS_COMPACT


	)

461 
	#AT_CREG_RESP_UTRAN
 
NET_ACCESS_UTRAN


	)

462 
	#AT_CREG_RESP_EGPRS
 
NET_ACCESS_EGPRS


	)

463 
	#AT_CREG_RESP_HSDPA
 
NET_ACCESS_HSDPA


	)

464 
	#AT_CREG_RESP_HSUPA
 
NET_ACCESS_HSUPA


	)

465 
	#AT_CREG_RESP_HSDUPA
 
NET_ACCESS_HSDUPA


	)

466 
	#AT_CREG_RESP_EUTRAN
 
NET_ACCESS_EUTRAN


	)

470 
	#AT_CREG_RESP_LAC_MASK
 
AT_COMMAND_PARAM3


	)

471 
	#AT_CREG_RESP_CI_MASK
 
AT_COMMAND_PARAM4


	)

472 
	#AT_CREG_RESP_ACT_MASK
 
AT_COMMAND_PARAM5


	)

476 
	mn
;

477 
	m°©
;

478 
	#AT_CREG_RESP_LAC_SIZE
 4

	)

479 
	mœc
[
AT_CREG_RESP_LAC_SIZE
+1];

480 
	#AT_CREG_RESP_CI_SIZE
 8

	)

481 
	mci
[
AT_CREG_RESP_CI_SIZE
+1];

482 
	mAcT
;

483 } 
	t©_¸eg_ª•_t
;

501 
	#AT_RESPONSE_CGATT_MASK
 
AT_RESPONSE_NO_PARAM


	)

505 
	m°©e
;

506 } 
	t©_cg©t_ª•_t
;

527 
	#AT_CGREG_RESP_REG_OFF
 
NET_REG_STATE_OFF


	)

528 
	#AT_CGREG_RESP_REG_HN
 
NET_REG_STATE_HN


	)

529 
	#AT_CGREG_RESP_REG_ON
 
NET_REG_STATE_ON


	)

530 
	#AT_CGREG_RESP_REG_DENIED
 
NET_REG_STATE_DENIED


	)

531 
	#AT_CGREG_RESP_REG_UNKNOWN
 
NET_REG_STATE_UNKNOWN


	)

532 
	#AT_CGREG_RESP_REG_ROAMING
 
NET_REG_STATE_ROAMING


	)

533 
	#AT_CGREG_RESP_REG_EMERGENCY
 
NET_REG_STATE_EMERGENCY


	)

536 
	#AT_CGREG_RESP_GSM
 
NET_ACCESS_GSM


	)

537 
	#AT_CGREG_RESP_COMPACT
 
NET_ACCESS_COMPACT


	)

538 
	#AT_CGREG_RESP_UTRAN
 
NET_ACCESS_UTRAN


	)

539 
	#AT_CGREG_RESP_EGPRS
 
NET_ACCESS_EGPRS


	)

540 
	#AT_CGREG_RESP_HSDPA
 
NET_ACCESS_HSDPA


	)

541 
	#AT_CGREG_RESP_HSUPA
 
NET_ACCESS_HSUPA


	)

542 
	#AT_CGREG_RESP_HSDUPA
 
NET_ACCESS_HSDUPA


	)

546 
	#AT_CGREG_RESP_LAC_MASK
 
AT_COMMAND_PARAM3


	)

547 
	#AT_CGREG_RESP_CI_MASK
 
AT_COMMAND_PARAM4


	)

548 
	#AT_CGREG_RESP_ACT_MASK
 
AT_COMMAND_PARAM5


	)

549 
	#AT_CGREG_RESP_RAC_MASK
 
AT_COMMAND_PARAM6


	)

553 
	mn
;

554 
	m°©
;

555 
	#AT_CGREG_RESP_LAC_SIZE
 4

	)

556 
	mœc
[
AT_CGREG_RESP_LAC_SIZE
+1];

557 
	#AT_CGREG_RESP_CI_SIZE
 8

	)

558 
	mci
[
AT_CGREG_RESP_CI_SIZE
+1];

559 
	mAcT
;

560 
	#AT_CGREG_RESP_RAC_SIZE
 2

	)

561 
	møc
[
AT_CGREG_RESP_RAC_SIZE
+1];

562 } 
	t©_cgªg_ª•_t
;

582 
	#AT_CEREG_RESP_REG_OFF
 
NET_REG_STATE_OFF


	)

583 
	#AT_CEREG_RESP_REG_HN
 
NET_REG_STATE_HN


	)

584 
	#AT_CEREG_RESP_REG_ON
 
NET_REG_STATE_ON


	)

585 
	#AT_CEREG_RESP_REG_DENIED
 
NET_REG_STATE_DENIED


	)

586 
	#AT_CEREG_RESP_REG_UNKNOWN
 
NET_REG_STATE_UNKNOWN


	)

587 
	#AT_CEREG_RESP_REG_ROAMING
 
NET_REG_STATE_ROAMING


	)

588 
	#AT_CEREG_RESP_REG_EMERGENCY
 
NET_REG_STATE_EMERGENCY


	)

591 
	#AT_CEREG_RESP_EUTRAN
 
NET_ACCESS_EUTRAN


	)

595 
	#AT_CEREG_RESP_TAC_MASK
 
AT_COMMAND_PARAM3


	)

596 
	#AT_CEREG_RESP_CI_MASK
 
AT_COMMAND_PARAM4


	)

597 
	#AT_CEREG_RESP_ACT_MASK
 
AT_COMMAND_PARAM5


	)

601 
	mn
;

602 
	m°©
;

603 
	#AT_CEREG_RESP_TAC_SIZE
 4

	)

604 
	mèc
[
AT_CEREG_RESP_TAC_SIZE
+1];

605 
	#AT_CEREG_RESP_CI_SIZE
 8

	)

606 
	mci
[
AT_CEREG_RESP_CI_SIZE
+1];

607 
	mAcT
;

608 } 
	t©_˚ªg_ª•_t
;

637 
	#AT_CGDCONT_RESP_IPV4ADDRALLOC_MASK
 
AT_COMMAND_PARAM7


	)

638 
	#AT_CGDCONT_RESP_EMERGECY_INDICATION_MASK
 
AT_COMMAND_PARAM8


	)

639 
	#AT_CGDCONT_RESP_P_CSCF_DISCOVERY_MASK
 
AT_COMMAND_PARAM9


	)

640 
	#AT_CGDCONT_RESP_IM_CN_SIGNALLING_FLAG_IND_MASK
 
AT_COMMAND_PARAM10


	)

644 
	#AT_CGDCONT_RESP_SIZE
 8

	)

645 
	mn_pdns
;

646 
	mcid
[
AT_CGDCONT_RESP_SIZE
];

647 
	mPDP_ty≥
[
AT_CGDCONT_RESP_SIZE
];

648 c⁄° * 
	mAPN
[
AT_CGDCONT_RESP_SIZE
];

649 
	md_comp
[
AT_CGDCONT_RESP_SIZE
];

650 
	mh_comp
[
AT_CGDCONT_RESP_SIZE
];

651 } 
	t©_cgdc⁄t_gë_t
;

655 
	mn_cid
;

656 } 
	t©_cgdc⁄t_t°_t
;

660 
©_cgdc⁄t_t°_t
 
	mt°
;

661 
©_cgdc⁄t_gë_t
 
	mgë
;

662 } 
	t©_cgdc⁄t_ª•_t
;

677 
	#AT_RESPONSE_CGACT_MASK
 
AT_RESPONSE_NO_PARAM


	)

681 
	#AT_CGACT_RESP_SIZE
 
AT_CGDCONT_RESP_SIZE


	)

682 
	mn_pdns
;

683 
	mcid
[
AT_CGACT_RESP_SIZE
];

684 
	m°©e
[
AT_CGACT_RESP_SIZE
];

685 } 
	t©_cga˘_ª•_t
;

699 
	#AT_RESPONSE_CGPADDR_MASK
 
AT_RESPONSE_NO_PARAM


	)

703 
	#AT_CGPADDR_RESP_SIZE
 
AT_CGDCONT_RESP_SIZE


	)

704 
	mn_pdns
;

705 
	mcid
[
AT_CGPADDR_RESP_SIZE
];

707 c⁄° * 
	mPDP_addr_1
[
AT_CGPADDR_RESP_SIZE
];

709 c⁄° * 
	mPDP_addr_2
[
AT_CGPADDR_RESP_SIZE
];

710 } 
	t©_cg∑ddr_ª•_t
;

723 
	#AT_RESPONSE_CGEV_MASK
 
AT_RESPONSE_NO_PARAM


	)

726 
	#AT_CGEV_RESP_NW_PDN_ACT
 (-1Ë

	)

727 
	#AT_CGEV_RESP_ME_PDN_ACT
 
NET_PDN_MT_DEFAULT_ACT


	)

728 
	#AT_CGEV_RESP_NW_PDN_DEACT
 
NET_PDN_NW_DEFAULT_DEACT


	)

729 
	#AT_CGEV_RESP_ME_PDN_DEACT
 
NET_PDN_MT_DEFAULT_DEACT


	)

730 
	#AT_CGEV_RESP_NW_ACT
 
NET_PDN_NW_DEDICATED_ACT


	)

731 
	#AT_CGEV_RESP_ME_ACT
 
NET_PDN_MT_DEDICATED_ACT


	)

732 
	#AT_CGEV_RESP_NW_DEACT
 
NET_PDN_NW_DEDICATED_DEACT


	)

733 
	#AT_CGEV_RESP_ME_DEACT
 
NET_PDN_MT_DEDICATED_DEACT


	)

737 
	mcode
;

738 
	mcid
;

739 } 
	t©_cgev_ª•_t
;

749 
©_comm™d_id_t
 
	mid
;

750 
©_comm™d_ty≥_t
 
	mty≥
;

751 
	mmask
;

752 
	mˇu£_code
;

754 
©_cg¢_ª•_t
 
	mcg¢
;

755 
©_cgmi_ª•_t
 
	mcgmi
;

756 
©_cgmm_ª•_t
 
	mcgmm
;

757 
©_cgmr_ª•_t
 
	mcgmr
;

758 
©_cimi_ª•_t
 
	mcimi
;

759 
©_cfun_ª•_t
 
	mcfun
;

760 
©_˝ö_ª•_t
 
	m˝ö
;

761 
©_csq_ª•_t
 
	mcsq
;

762 
©_˚sq_ª•_t
 
	m˚sq
;

763 
©_˛ac_ª•_t
 
	m˛ac
;

764 
©_cmì_ª•_t
 
	mcmì
;

765 
©_˙um_ª•_t
 
	m˙um
;

766 
©_˛ck_ª•_t
 
	m˛ck
;

767 
©_c›s_ª•_t
 
	mc›s
;

768 
©_cg©t_ª•_t
 
	mcg©t
;

769 
©_¸eg_ª•_t
 
	m¸eg
;

770 
©_cgªg_ª•_t
 
	mcgªg
;

771 
©_˚ªg_ª•_t
 
	m˚ªg
;

772 
©_cgdc⁄t_ª•_t
 
	mcgdc⁄t
;

773 
©_cga˘_ª•_t
 
	mcga˘
;

774 
©_cg∑ddr_ª•_t
 
	mcg∑ddr
;

775 
©_cgev_ª•_t
 
	mcgev
;

776 } 
	mª•⁄£
;

777 } 
	t©_ª•⁄£_t
;

787 
©_ª•⁄£_ícode
(* 
buf„r
, c⁄° 
©_ª•⁄£_t
* 
©_ª•⁄£
);

	@src/api/user/tst/at_parser.c

39 
	~<°dio.h
>

40 
	~<°rög.h
>

41 
	~<°dlib.h
>

43 
	~"©_comm™d.h
"

45 
	~"«s_log.h
"

47 
	$maö
() {

48 c⁄° * 
ßm∂e_©_comm™ds
[] = {

65 c⁄° * 
ßm∂e_Áu…y_©_comm™ds
[] = {

79 
©_comm™d_t
 
©_comm™d
;

80 
©_comm™d_ödex
;

85 
©_comm™d_ödex
 = 0;

86 
	`°∫cmp
(
ßm∂e_©_comm™ds
[
©_comm™d_ödex
], "null", 4) != 0) {

87 i‡(
	`©_comm™d_decode
(
ßm∂e_©_comm™ds
[
©_comm™d_ödex
],

88 
	`°æí
(
ßm∂e_©_comm™ds
[
©_comm™d_ödex
]),

89 &
©_comm™d
) > 0)

91 
	`¥ötf
("INFO: Fine,Öarser interpreted valid command %s\n",

92 
ßm∂e_©_comm™ds
[
©_comm™d_ödex
]);

94 
	`¥ötf
("ERROR: ParserÑejected valid command %s\n",

95 
ßm∂e_©_comm™ds
[
©_comm™d_ödex
]);

98 
©_comm™d_ödex
++;

102 
©_comm™d_ödex
 = 0;

103 
	`°∫cmp
(
ßm∂e_Áu…y_©_comm™ds
[
©_comm™d_ödex
], "null", 4) != 0)

105 i‡(
	`©_comm™d_decode
(
ßm∂e_Áu…y_©_comm™ds
[
©_comm™d_ödex
],

106 
	`°æí
(
ßm∂e_Áu…y_©_comm™ds
[
©_comm™d_ödex
]),

107 &
©_comm™d
) > 0)

109 
	`¥ötf
("ERROR: Parser interpreted invalid command %s\n",

110 
ßm∂e_Áu…y_©_comm™ds
[
©_comm™d_ödex
]);

112 
	`¥ötf
("INFO: Fine,ÖarserÑejectedÅhe command %s\n",

113 
ßm∂e_Áu…y_©_comm™ds
[
©_comm™d_ödex
]);

116 
©_comm™d_ödex
++;

122 
byãs_ªad
;

123 
size_t
 
öput_size
 = 100;

124 *
öput
;

126 
	`¥ötf
("Note 1: CarriageÑeturn will beáppendedÅoÉvery command by default\n");

127 
	`¥ötf
("Note 2: Enter 'quit'ÅoÉxit\n");

128 
	`¥ötf
("AT Command> ");

130 
öput
 = (*)
	`mÆloc
(
öput_size
 + 1);

132 
byãs_ªad
 = 
	`gëlöe
(&
öput
, &
öput_size
, 
°dö
);

134 
	`°∫cmp
(
öput
, "quit", 4) != 0)

136 i‡(
byãs_ªad
 == -1) {

137 
	`puts
("CannotÑead user input!\n");

140 
öput
[
byãs_ªad
 - 1] = '\r';

142 i‡(
	`©_comm™d_decode
(
öput
, 
byãs_ªad
, &
©_comm™d
) > 0)

143 
	`¥ötf
("INFO: P¨£∏öãΩªãd comm™d %s\n", 
öput
);

145 
	`¥ötf
("ERROR: P¨£∏ªje˘ed comm™d %s\n", 
öput
);

148 
	`¥ötf
("\nAT Command> ");

149 
	`mem£t
(
öput
, 0x00, 
öput_size
);

150 
byãs_ªad
 = 
	`gëlöe
(&
öput
, &
öput_size
, 
°dö
);

153 
	`‰ì
(
öput
);

155 
	`¥ötf
("Exiting...\n");

158 
	}
}

	@src/api/user/user_api.c

48 #ifde‡
NAS_UE


50 
	~"u£r_≠i.h
"

51 
	~"«s_log.h
"

52 
	~"sockë.h
"

53 
	~"devi˚.h
"

54 
	~"«s_u£r.h
"

56 
	~"©_comm™d.h
"

57 
	~"©_ª•⁄£.h
"

58 
	~"©_îr‹.h
"

60 
	~"u£r_ödiˇti⁄.h
"

62 
	~<°rög.h
>

63 
	~<√tdb.h
>

64 
	~<î∫o.h
>

65 
	~<°dio.h
>

66 
	~<uni°d.h
>

79 
_u£r_≠i_ªgi°øti⁄_h™dÀr
(
id
, c⁄° * 
d©a
, 
size_t
 
size
);

80 
_u£r_≠i_loˇti⁄_h™dÀr
(
id
, c⁄° * 
d©a
, 
size_t
 
size
);

81 
_u£r_≠i_√tw‹k_h™dÀr
(
id
, c⁄° * 
d©a
, 
size_t
 
size
);

82 
_u£r_≠i_pdn_c⁄√˘i⁄_h™dÀr
(
id
, c⁄° * 
d©a
, 
size_t
 
size
);

84 
_u£r_≠i_£nd
(
©_ª•⁄£_t
* 
d©a
);

101 * 
	mídpoöt
;

103 * (*
	m›í
) (, const *, const *);

104 (*
	mgëfd
)(const *);

105 
ssize_t
 (*
ªcv
Ë(*, *, 
	msize_t
);

106 
ssize_t
 (*
£nd
Ë(c⁄° *, c⁄° *, 
	msize_t
);

107 (*
	m˛o£
)(*);

108 } 
	g_u£r_≠i_id
;

110 
	#USER_API_OPEN
(
a
, 
b
, 
c
Ë
_u£r_≠i_id
.
	`›í
◊, b, c)

	)

111 
	#USER_API_GETFD
(Ë
_u£r_≠i_id
.
	`gëfd
(_u£r_≠i_id.
ídpoöt
)

	)

112 
	#USER_API_RECV
(
a
, 
b
Ë
_u£r_≠i_id
.
	`ªcv
(_u£r_≠i_id.
ídpoöt
,á, b)

	)

113 
	#USER_API_SEND
(
a
, 
b
Ë
_u£r_≠i_id
.
	`£nd
(_u£r_≠i_id.
ídpoöt
,á, b)

	)

114 
	#USER_API_CLOSE
(Ë
_u£r_≠i_id
.
	`˛o£
(_u£r_≠i_id.
ídpoöt
)

	)

119 
	#USER_API_RECV_BUFFER_SIZE
 4096

	)

120 
	g_u£r_≠i_ªcv_buf„r
[
USER_API_RECV_BUFFER_SIZE
];

125 
	#USER_API_SEND_BUFFER_SIZE
 
USER_API_RECV_BUFFER_SIZE


	)

126 
	g_u£r_≠i_£nd_buf„r
[
USER_API_SEND_BUFFER_SIZE
];

132 
	mn_cmd
;

133 
	#USER_DATA_MAX
 10

	)

134 
©_comm™d_t
 
	mcmd
[
USER_DATA_MAX
];

135 } 
	g_u£r_d©a
 = {};

158 
	$u£r_≠i_öôülize
(c⁄° * 
ho°
, c⁄° * 
p‹t
,

159 c⁄° * 
dev«me
, c⁄° * 
dev∑øms
)

161 
LOG_FUNC_IN
;

163 
	`gëho°«me
(
_u£r_≠i_£nd_buf„r
, 
USER_API_SEND_BUFFER_SIZE
);

165 i‡(
dev«me
 !
NULL
) {

167 
_u£r_≠i_id
.
›í
 = 
devi˚_›í
;

168 
_u£r_≠i_id
.
gëfd
 = 
devi˚_gë_fd
;

169 
_u£r_≠i_id
.
ªcv
 = 
devi˚_ªad
;

170 
_u£r_≠i_id
.
£nd
 = 
devi˚_wrôe
;

171 
_u£r_≠i_id
.
˛o£
 = 
devi˚_˛o£
;

174 
_u£r_≠i_id
.
ídpoöt
 = 
	`USER_API_OPEN
(
DEVICE
, 
dev«me
, 
dev∑øms
);

175 i‡(
_u£r_≠i_id
.
ídpoöt
 =
NULL
) {

176 
	`LOG_TRACE
(
ERROR
, "USR-API - FailedÅo open connectionÉndpoint, "

177 "%s", 
	`°ªº‹
(
î∫o
));

178 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

181 
	`LOG_TRACE
(
INFO
, "USR-API - User's communication device %d is OPENED "

182 "⁄ %s/%s", 
	`u£r_≠i_gë_fd
(), 
_u£r_≠i_£nd_buf„r
, 
dev«me
);

186 
_u£r_≠i_id
.
›í
 = 
sockë_udp_›í
;

187 
_u£r_≠i_id
.
gëfd
 = 
sockë_gë_fd
;

188 
_u£r_≠i_id
.
ªcv
 = 
sockë_ªcv
;

189 
_u£r_≠i_id
.
£nd
 = 
sockë_£nd
;

190 
_u£r_≠i_id
.
˛o£
 = 
sockë_˛o£
;

193 
_u£r_≠i_id
.
ídpoöt
 = 
	`USER_API_OPEN
(
SOCKET_SERVER
, 
ho°
, 
p‹t
);

194 i‡(
_u£r_≠i_id
.
ídpoöt
 =
NULL
) {

195 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

196 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

197 
	`LOG_TRACE
(
ERROR
, "USR-API - FailedÅo open connectionÉndpoint, "

198 "%s", 
îr‹
);

199 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

202 
	`LOG_TRACE
(
INFO
, "USR-API - User's UDP socket %d is BOUNDÅo %s/%s",

203 
	`u£r_≠i_gë_fd
(), 
_u£r_≠i_£nd_buf„r
, 
p‹t
);

207 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_REG
, 0, 
_u£r_≠i_ªgi°øti⁄_h™dÀr
Ë!
RETURNok
) {

208 
	`LOG_TRACE
(
WARNING
, "USR-API - "

211 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_LOC
, 0, 
_u£r_≠i_loˇti⁄_h™dÀr
Ë!
RETURNok
) {

212 
	`LOG_TRACE
(
WARNING
, "USR-API - "

215 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_PLMN
, 0, 
_u£r_≠i_√tw‹k_h™dÀr
Ë!
RETURNok
) {

216 
	`LOG_TRACE
(
WARNING
, "USR-API - "

219 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_PLMN
, 0, 
NULL
Ë!
RETURNok
) {

220 
	`LOG_TRACE
(
WARNING
, "USR-API - FailedÅoÉnableÇetworkÇotification");

222 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_PDN
, 0, 
_u£r_≠i_pdn_c⁄√˘i⁄_h™dÀr
Ë!
RETURNok
) {

223 
	`LOG_TRACE
(
WARNING
, "USR-API - "

226 i‡(
	`u£r_öd_ªgi°î
(
USER_IND_PDN
, 
AT_CGACT
, 
NULL
Ë!
RETURNok
) {

227 
	`LOG_TRACE
(
WARNING
, "USR-API - "

231 
	`LOG_TRACE
(
INFO
, "USR-API - "

235 
	`LOG_FUNC_RETURN
 (
RETURNok
);

236 
	}
}

254 
	$u£r_≠i_gë_fd
()

256 
LOG_FUNC_IN
;

257 
	`LOG_FUNC_RETURN
 (
	`USER_API_GETFD
());

258 
	}
}

276 c⁄° * 
	$u£r_≠i_gë_d©a
(
ödex
)

278 
LOG_FUNC_IN
;

279 i‡(
ödex
 < 
_u£r_d©a
.
n_cmd
) {

280 
	`LOG_FUNC_RETURN
 ((*)(&
_u£r_d©a
.
cmd
[
ödex
]));

282 
	`LOG_FUNC_RETURN
 (
NULL
);

283 
	}
}

300 
	$u£r_≠i_ªad_d©a
(
fd
)

302 
LOG_FUNC_IN
;

304 
rbyãs
;

307 
sfd
 = 
	`u£r_≠i_gë_fd
();

308 i‡(
fd
 !
sfd
) {

309 
	`LOG_TRACE
(
ERROR
, "USR-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhêu£∏≠∂iˇti⁄Üayî (%d)", 
fd
, 
sfd
);

310 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

313 
	`mem£t
(
_u£r_≠i_ªcv_buf„r
, 0, 
USER_API_RECV_BUFFER_SIZE
);

316 
rbyãs
 = 
	`USER_API_RECV
(
_u£r_≠i_ªcv_buf„r
, 
USER_API_RECV_BUFFER_SIZE
);

317 i‡(
rbyãs
 =
RETURNîr‹
) {

318 
	`LOG_TRACE
(
ERROR
, "USR-API -Ñecv(ËÁûed, %s", 
	`°ªº‹
(
î∫o
));

319 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

321 i‡(
rbyãs
 == 0) {

325 
	`LOG_TRACE
(
INFO
, "USR-API - %d bytesÑeceived "

326 "‰omÅhêu£∏≠∂iˇti⁄Üayî", 
rbyãs
);

327 
	`LOG_DUMP
(
_u£r_≠i_ªcv_buf„r
, 
rbyãs
);

330 
	`LOG_FUNC_RETURN
 (
rbyãs
);

331 
	}
}

346 
	$u£r_≠i_£t_d©a
(*
mesßge
)

348 
LOG_FUNC_IN
;

350 
rbyãs
;

352 
	`mem£t
(
_u£r_≠i_ªcv_buf„r
, 0, 
USER_API_RECV_BUFFER_SIZE
);

354 
	`°∫˝y
(
_u£r_≠i_ªcv_buf„r
, 
mesßge
, 
USER_API_RECV_BUFFER_SIZE
);

355 
rbyãs
 = 
	`°æí
(
_u£r_≠i_ªcv_buf„r
);

357 
	`LOG_TRACE
(
INFO
, "USR-API - %d byã†wrôe", 
rbyãs
);

358 
	`LOG_DUMP
(
_u£r_≠i_ªcv_buf„r
, 
rbyãs
);

360 
	`LOG_FUNC_RETURN
 (
rbyãs
);

361 
	}
}

379 
	$_u£r_≠i_£nd_d©a
(
Àngth
)

381 
sbyãs
 = 
	`USER_API_SEND
(
_u£r_≠i_£nd_buf„r
, 
Àngth
);

382 i‡(
sbyãs
 =
RETURNîr‹
) {

383 
	`LOG_TRACE
(
ERROR
, "USR-API - síd(ËÁûed, %s", 
	`°ªº‹
(
î∫o
));

384  
RETURNîr‹
;

386 i‡(
sbyãs
 == 0) {

387 
	`LOG_TRACE
(
WARNING
, "USR-API - A signal was caught");

390 
	`LOG_TRACE
(
INFO
, "USR-API - %d bytes sent "

391 "tÿthêu£∏≠∂iˇti⁄Üayî", 
sbyãs
);

392 
	`LOG_DUMP
(
_u£r_≠i_£nd_buf„r
, 
sbyãs
);

395  
sbyãs
;

396 
	}
}

397 
	$u£r_≠i_£nd_d©a
(
fd
, 
Àngth
)

399 
LOG_FUNC_IN
;

402 
sfd
 = 
	`u£r_≠i_gë_fd
();

403 i‡(
fd
 !
sfd
) {

404 
	`LOG_TRACE
(
ERROR
, "USR-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhêu£∏≠∂iˇti⁄Üayî (%d)", 
fd
, 
sfd
);

405 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

409 
sbyãs
 = 0;

410 i‡(
Àngth
 > 0) {

411 
sbyãs
 = 
	`_u£r_≠i_£nd_d©a
(
Àngth
);

413 
	`LOG_FUNC_RETURN
 (
sbyãs
);

414 
	}
}

432 
	$u£r_≠i_˛o£
(
fd
)

434 
LOG_FUNC_IN
;

437 
sfd
 = 
	`u£r_≠i_gë_fd
();

438 i‡(
fd
 !
sfd
) {

439 
	`LOG_TRACE
(
ERROR
, "USR-API - Endpoöà%d i†nŸÅhê⁄ê¸óãd f‹ communiˇti⁄ wôhÅhêu£∏≠∂iˇti⁄Üayî (%d)", 
fd
, 
sfd
);

440 
LOG_FUNC_OUT
;

445 
	`USER_API_CLOSE
();

446 
_u£r_≠i_id
.
ídpoöt
 = 
NULL
;

448 
LOG_FUNC_OUT
;

449 
	}
}

468 
	$u£r_≠i_decode_d©a
(
Àngth
)

470 
LOG_FUNC_IN
;

473 
	`LOG_TRACE
(
INFO
, "USR-API - Decodêu£∏d©a: %s", 
_u£r_≠i_ªcv_buf„r
);

474 
_u£r_d©a
.
n_cmd
 = 
	`©_comm™d_decode
(
_u£r_≠i_ªcv_buf„r
, 
Àngth
,

475 
_u£r_d©a
.
cmd
);

477 i‡(
_u£r_d©a
.
n_cmd
 > 0) {

480 
	`LOG_TRACE
(
INFO
, "USR-API - %d AT command%s ha%s been successfully "

481 "decoded", 
_u£r_d©a
.
n_cmd
,

482 (
_u£r_d©a
.
n_cmd
 > 1) ? "s" : "",

483 (
_u£r_d©a
.
n_cmd
 > 1) ? "ve" : "s");

487 
byãs
;

491 
	`LOG_TRACE
(
ERROR
, "USR-API - SyntaxÉrror: FailedÅo decode "

492 "AT comm™d d©®%s", 
_u£r_≠i_ªcv_buf„r
);

495 
byãs
 = 
	`©_îr‹_ícode
(
_u£r_≠i_£nd_buf„r
, 
AT_ERROR_SYNTAX
,

496 
AT_ERROR_OPERATION_NOT_SUPPORTED
);

499 (Ë
	`_u£r_≠i_£nd_d©a
(
byãs
);

502 
	`LOG_FUNC_RETURN
 (
_u£r_d©a
.
n_cmd
);

503 
	}
}

524 
	$u£r_≠i_ícode_d©a
(c⁄° * 
d©a
, 
suc˚ss_code
)

526 
LOG_FUNC_IN
;

528 c⁄° 
©_ª•⁄£_t
* 
u£r_d©a
 = (©_ª•⁄£_t*)(
d©a
);

529 
byãs
;

532 i‡(
u£r_d©a
->
ˇu£_code
 !
AT_ERROR_SUCCESS
)

534 
byãs
 = 
	`©_îr‹_ícode
(
_u£r_≠i_£nd_buf„r
, 
AT_ERROR_CME
,

535 
u£r_d©a
->
ˇu£_code
);

540 
byãs
 = 
	`©_ª•⁄£_ícode
(
_u£r_≠i_£nd_buf„r
, 
u£r_d©a
);

543 i‡–(
suc˚ss_code
Ë&& (
byãs
 !
RETURNîr‹
) ) {

544 
byãs
 +
	`©_îr‹_ícode
(&
_u£r_≠i_£nd_buf„r
[bytes],

545 
AT_ERROR_OK
, 0);

549 i‡(
byãs
 !
RETURNîr‹
) {

550 
	`LOG_TRACE
(
INFO
, "USR-API - %d byã†ícoded", 
byãs
);

553 
	`LOG_TRACE
(
ERROR
, "USR-API - SyntaxÉrror: FailedÅoÉncode AT "

554 "ª•⁄£ d©®(%d)", 
u£r_d©a
->
id
);

557 
	`LOG_FUNC_RETURN
 (
byãs
);

558 
	}
}

583 
	$u£r_≠i_emm_ˇŒback
(
Sèt_t
 
°©
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
AcT
,

584 c⁄° * 
d©a
, 
size_t
 
size
)

586 
LOG_FUNC_IN
;

588 
rc
 = 
RETURNok
;

590 i‡(
size
 > 1) {

595 
rc
 = 
	`u£r_öd_nŸify
(
USER_IND_PLMN
, (*)
d©a
, 
size
);

598 
u£r_ödiˇti⁄_t
 
öd
;

599 
öd
.
nŸifiˇti⁄
.
ªg
.
°©us
 = 
°©
;

600 i‡(
size
 > 0) {

602 
rc
 = 
	`u£r_öd_nŸify
(
USER_IND_REG
, (*)&
öd
, 0);

604 i‡(
rc
 !
RETURNîr‹
) {

608 
öd
.
nŸifiˇti⁄
.
loc
.
èc
 =Åac;

609 
öd
.
nŸifiˇti⁄
.
loc
.
ci
 = ci;

610 
öd
.
nŸifiˇti⁄
.
loc
.
AcT
 = AcT;

611 
rc
 = 
	`u£r_öd_nŸify
(
USER_IND_LOC
, (*)&
öd
, 0);

615 i‡(
rc
 !
RETURNîr‹
) {

616 
	`LOG_FUNC_RETURN
 (
RETURNok
);

619 
	`LOG_FUNC_RETURN
 (
rc
);

620 
	}
}

639 
	$u£r_≠i_esm_ˇŒback
(
cid
, 
√tw‹k_pdn_°©e_t
 
°©e
)

641 
LOG_FUNC_IN
;

643 
rc
 = 
RETURNok
;

645 
u£r_ödiˇti⁄_t
 
öd
;

646 
öd
.
nŸifiˇti⁄
.
pdn
.
cid
 = cid;

647 
öd
.
nŸifiˇti⁄
.
pdn
.
°©us
 = 
°©e
;

649 
rc
 = 
	`u£r_öd_nŸify
(
USER_IND_PDN
, (*)&
öd
, 0);

651 
	`LOG_FUNC_RETURN
 (
rc
);

652 
	}
}

672 
	$_u£r_≠i_£nd
(
©_ª•⁄£_t
* 
d©a
)

674 
LOG_FUNC_IN
;

677 
byãs
 = 
	`©_ª•⁄£_ícode
(
_u£r_≠i_£nd_buf„r
, 
d©a
);

680 i‡(
byãs
 !
RETURNîr‹
) {

681 
byãs
 = 
	`_u£r_≠i_£nd_d©a
(bytes);

684 
	`LOG_FUNC_RETURN
 (
byãs
);

685 
	}
}

708 
	$_u£r_≠i_ªgi°øti⁄_h™dÀr
(
id
, c⁄° * 
d©a
,

709 
size_t
 
size
)

711 
LOG_FUNC_IN
;

714 
u£r_öd_ªg_t
* 
ªg
 = (u£r_öd_ªg_t*)
d©a
;

717 
©_ª•⁄£_t
 
©_ª•⁄£
;

718 
©_ª•⁄£
.
id
 = id;

719 
©_ª•⁄£
.
ty≥
 = 
AT_COMMAND_GET
;

720 
©_ª•⁄£
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

721 
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
n
 = 
AT_CEREG_ON
;

722 
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
°©
 = 
ªg
->
°©us
;

725 
byãs
 = 
	`_u£r_≠i_£nd
(&
©_ª•⁄£
);

727 
	`LOG_FUNC_RETURN
 (
byãs
);

728 
	}
}

750 
	$_u£r_≠i_loˇti⁄_h™dÀr
(
id
, c⁄° * 
d©a
,

751 
size_t
 
size
)

753 
LOG_FUNC_IN
;

756 
u£r_öd_loc_t
* 
loc
 = (u£r_öd_loc_t*)
d©a
;

759 
©_ª•⁄£_t
 
©_ª•⁄£
;

760 
©_ª•⁄£
.
id
 = id;

761 
©_ª•⁄£
.
ty≥
 = 
AT_COMMAND_GET
;

762 
©_ª•⁄£
.
mask
 = (
AT_CEREG_RESP_TAC_MASK
 | 
AT_CEREG_RESP_CI_MASK
);

763 
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
n
 = 
AT_CEREG_BOTH
;

764 
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
°©
 = 
loc
->
°©us
;

765 
	`•rötf
(
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
èc
, "%.4x", 
loc
->tac);

766 
	`•rötf
(
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
ci
, "%.8x", 
loc
->ci);

767 i‡(
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
AcT
 !
NET_ACCESS_UNAVAILABLE
) {

768 
©_ª•⁄£
.
ª•⁄£
.
˚ªg
.
AcT
 = 
loc
->AcT;

769 
©_ª•⁄£
.
mask
 |
AT_CEREG_RESP_ACT_MASK
;

773 
byãs
 = 
	`_u£r_≠i_£nd
(&
©_ª•⁄£
);

775 
	`LOG_FUNC_RETURN
 (
byãs
);

776 
	}
}

796 
	$_u£r_≠i_√tw‹k_h™dÀr
(
id
, c⁄° * 
d©a
,

797 
size_t
 
size
)

799 
LOG_FUNC_IN
;

802 
©_ª•⁄£_t
 
©_ª•⁄£
;

803 
©_ª•⁄£
.
id
 = 
AT_COPS
;

804 
©_ª•⁄£
.
ty≥
 = 
AT_COMMAND_TST
;

805 
©_ª•⁄£
.
ª•⁄£
.
c›s
.
t°
.
d©a
 = (*)data;

806 
©_ª•⁄£
.
ª•⁄£
.
c›s
.
t°
.
size
 = size;

809 
byãs
 = 
	`_u£r_≠i_£nd
(&
©_ª•⁄£
);

811 
	`LOG_FUNC_RETURN
 (
byãs
);

812 
	}
}

834 
	$_u£r_≠i_pdn_c⁄√˘i⁄_h™dÀr
(
id
, c⁄° * 
d©a
,

835 
size_t
 
size
)

837 
LOG_FUNC_IN
;

840 
u£r_öd_pdn_t
* 
pdn
 = (u£r_öd_pdn_t*)
d©a
;

843 
©_ª•⁄£_t
 
©_ª•⁄£
;

844 
©_ª•⁄£
.
id
 = 
AT_CGEV
;

845 
©_ª•⁄£
.
ty≥
 = 
AT_COMMAND_GET
;

846 
©_ª•⁄£
.
mask
 = 
AT_RESPONSE_CGEV_MASK
;

847 
©_ª•⁄£
.
ª•⁄£
.
cgev
.
cid
 = 
pdn
->cid;

848 
©_ª•⁄£
.
ª•⁄£
.
cgev
.
code
 = 
pdn
->
°©us
;

851 
byãs
 = 
	`_u£r_≠i_£nd
(&
©_ª•⁄£
);

853 
	`LOG_FUNC_RETURN
 (
byãs
);

854 
	}
}

	@src/api/user/user_api.h

47 #i‚de‡
__USER_API_H__


48 
	#__USER_API_H__


	)

50 
	~"comm⁄Def.h
"

51 
	~"√tw‹kDef.h
"

69 
u£r_≠i_öôülize
(c⁄° * 
ho°
, c⁄° * 
p‹t
, c⁄° * 
dev«me
, c⁄° * 
dev∑øms
);

71 
u£r_≠i_emm_ˇŒback
(
Sèt_t
 
°©
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
AcT
, c⁄° * 
d©a
, 
size_t
 
size
);

72 
u£r_≠i_esm_ˇŒback
(
cid
, 
√tw‹k_pdn_°©e_t
 
°©e
);

74 
u£r_≠i_gë_fd
();

75 c⁄° * 
u£r_≠i_gë_d©a
(
ödex
);

77 
u£r_≠i_ªad_d©a
(
fd
);

78 
u£r_≠i_£t_d©a
(*
mesßge
);

79 
u£r_≠i_£nd_d©a
(
fd
, 
Àngth
);

80 
u£r_≠i_˛o£
(
fd
);

82 
u£r_≠i_decode_d©a
(
Àngth
);

83 
u£r_≠i_ícode_d©a
(c⁄° * 
d©a
, 
add_suc˚ss_code
);

	@src/api/user/user_indication.c

49 
	~"u£r_ödiˇti⁄.h
"

50 
	~"«s_log.h
"

62 
	mid
;

63 
	mmask
;

64 
u£r_öd_ˇŒback_t
 
	mˇŒback
[
USER_IND_MAX
];

65 } 
	g_u£r_öd_h™dÀr
 = {};

88 
	$u£r_öd_ªgi°î
(
u£r_öd_t
 
öd
, 
id
, 
u£r_öd_ˇŒback_t
 
cb
)

90 
LOG_FUNC_IN
;

92 
rc
 = 
RETURNîr‹
;

94 i‡(
öd
 < 
USER_IND_MAX
) {

96 i‡(
cb
 !
NULL
) {

97 
_u£r_öd_h™dÀr
.
ˇŒback
[
öd
] = 
cb
;

100 
_u£r_öd_h™dÀr
.
id
 = id;

101 
_u£r_öd_h™dÀr
.
mask
 |(1 << 
öd
);

103 
rc
 = 
RETURNok
;

106 
	`LOG_FUNC_RETURN
(
rc
);

107 
	}
}

124 
	$u£r_öd_dîegi°î
(
u£r_öd_t
 
öd
)

126 
LOG_FUNC_IN
;

128 
rc
 = 
RETURNîr‹
;

130 i‡(
öd
 < 
USER_IND_MAX
) {

131 
_u£r_öd_h™dÀr
.
mask
 &~(1 << 
öd
);

132 
rc
 = 
RETURNok
;

135 
	`LOG_FUNC_RETURN
(
rc
);

136 
	}
}

156 
	$u£r_öd_nŸify
(
u£r_öd_t
 
öd
, c⁄° * 
d©a
, 
size_t
 
size
)

158 
LOG_FUNC_IN
;

160 
rc
 = 
RETURNîr‹
;

162 i‡(
öd
 < 
USER_IND_MAX
) {

163 i‡(
_u£r_öd_h™dÀr
.
mask
 & (1 << 
öd
)) {

165 
u£r_öd_ˇŒback_t
 
nŸify
 = 
_u£r_öd_h™dÀr
.
ˇŒback
[
öd
];

166 i‡(
nŸify
 !
NULL
) {

167 
rc
 = (*
nŸify
)(
_u£r_öd_h™dÀr
.
id
, 
d©a
, 
size
);

172 
rc
 = 
RETURNok
;

176 
	`LOG_FUNC_RETURN
(
rc
);

177 
	}
}

	@src/api/user/user_indication.h

48 #i‚de‡
__USER_IND_H__


49 
	#__USER_IND_H__


	)

51 
	~"comm⁄Def.h
"

52 
	~"√tw‹kDef.h
"

62 
	mUSER_IND_REG
 = 0,

63 
	mUSER_IND_LOC
,

64 
	mUSER_IND_PLMN
,

65 
	mUSER_IND_PDN
,

66 
	mUSER_IND_MAX


67 } 
	tu£r_öd_t
;

74 
Sèt_t
 
	m°©us
;

75 } 
	tu£r_öd_ªg_t
;

82 
Sèt_t
 
	m°©us
;

83 
èc_t
 
	mèc
;

84 
ci_t
 
	mci
;

85 
AcT_t
 
	mAcT
;

86 } 
	tu£r_öd_loc_t
;

93 
UI¡8_t
 
	mcid
;

94 
√tw‹k_pdn_°©e_t
 
	m°©us
;

95 } 
	tu£r_öd_pdn_t
;

102 
u£r_öd_ªg_t
 
	mªg
;

103 
u£r_öd_loc_t
 
	mloc
;

104 
u£r_öd_pdn_t
 
	mpdn
;

105 } 
	mnŸifiˇti⁄
;

106 } 
	tu£r_ödiˇti⁄_t
;

111 (*
	tu£r_öd_ˇŒback_t
Ë(, c⁄° *, 
	tsize_t
);

125 
	`u£r_öd_ªgi°î
(
u£r_öd_t
 
öd
, 
id
, 
u£r_öd_ˇŒback_t
 
cb
);

126 
	`u£r_öd_dîegi°î
(
u£r_öd_t
 
öd
);

127 
	`u£r_öd_nŸify
(
u£r_öd_t
 
öd
, c⁄° * 
d©a
, 
size_t
 
size
);

	@src/api/usim/aka_functions.c

18 
	~"aka_fun˘i⁄s.h
"

19 
	~"«s_log.h
"

24 
u8
 
	gOP
[16] = {0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11,

37 
	$f1
 ( 
u8
 
k_pP
[16], u8 
ønd_pP
[16], u8 
sqn_pP
[6], u8 
amf_pP
[2],

38 
u8
 
mac_a_pP
[8] )

40 
u8
 
›_c
[16];

41 
u8
 
ãmp
[16];

42 
u8
 
ö1
[16];

43 
u8
 
out1
[16];

44 
u8
 
rijnd´lI≈ut
[16];

45 
u8
 
i
;

46 
	`Rijnd´lKeyScheduÀ
–
k_pP
 );

47 
	`CompuãOPc
–
›_c
 );

48 
i
=0; i<16; i++)

49 
rijnd´lI≈ut
[
i
] = 
ønd_pP
[i] ^ 
›_c
[i];

50 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
ãmp
 );

51 
i
=0; i<6; i++)

53 
ö1
[
i
] = 
sqn_pP
[i];

54 
ö1
[
i
+8] = 
sqn_pP
[i];

56 
i
=0; i<2; i++)

58 
ö1
[
i
+6] = 
amf_pP
[i];

59 
ö1
[
i
+14] = 
amf_pP
[i];

63 
i
=0; i<16; i++)

64 
rijnd´lI≈ut
[(
i
+8Ë% 16] = 
ö1
[i] ^ 
›_c
[i];

66 
i
=0; i<16; i++)

67 
rijnd´lI≈ut
[
i
] ^
ãmp
[i];

68 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out1
 );

69 
i
=0; i<16; i++)

70 
out1
[
i
] ^
›_c
[i];

71 
i
=0; i<8; i++)

72 
mac_a_pP
[
i
] = 
out1
[i];

74 
	}
}

84 
	$f2345
 ( 
u8
 
k_pP
[16], u8 
ønd_pP
[16],

85 
u8
 
ªs_pP
[8], u8 
ck_pP
[16], u8 
ik_pP
[16], u8 
ak_pP
[6] )

87 
u8
 
›_c
[16];

88 
u8
 
ãmp
[16];

89 
u8
 
out
[16];

90 
u8
 
rijnd´lI≈ut
[16];

91 
u8
 
i
;

93 
	`LOG_TRACE
(
DEBUG
,

95 
k_pP
[0],k_pP[1],k_pP[2], k_pP[3], k_pP[4], k_pP[5], k_pP[6], k_pP[7],

96 
k_pP
[8],k_pP[9],k_pP[10],k_pP[11],k_pP[12],k_pP[13],k_pP[14],k_pP[15]);

97 
	`LOG_TRACE
(
DEBUG
,

99 
ønd_pP
[0],rand_pP[1],rand_pP[2],Ñand_pP[3],Ñand_pP[4],Ñand_pP[5],Ñand_pP[6],Ñand_pP[7],

100 
ønd_pP
[8],rand_pP[9],rand_pP[10],rand_pP[11],rand_pP[12],rand_pP[13],rand_pP[14],rand_pP[15]);

102 
	`Rijnd´lKeyScheduÀ
–
k_pP
 );

103 
	`CompuãOPc
–
›_c
 );

104 
i
=0; i<16; i++)

105 
rijnd´lI≈ut
[
i
] = 
ønd_pP
[i] ^ 
›_c
[i];

106 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
ãmp
 );

110 
i
=0; i<16; i++)

111 
rijnd´lI≈ut
[
i
] = 
ãmp
[i] ^ 
›_c
[i];

112 
rijnd´lI≈ut
[15] ^= 1;

113 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out
 );

114 
i
=0; i<16; i++)

115 
out
[
i
] ^
›_c
[i];

116 
i
=0; i<8; i++)

117 
ªs_pP
[
i
] = 
out
[i+8];

118 
i
=0; i<6; i++)

119 
ak_pP
[
i
] = 
out
[i];

121 
	`LOG_TRACE
(
DEBUG
,

123 
ªs_pP
[0],res_pP[1],res_pP[2],Ñes_pP[3],Ñes_pP[4],Ñes_pP[5],Ñes_pP[6],Ñes_pP[7]);

124 
	`LOG_TRACE
(
DEBUG
,

126 
ak_pP
[0],ak_pP[1],ak_pP[2],ák_pP[3],ák_pP[4],ák_pP[5]);

131 
i
=0; i<16; i++)

132 
rijnd´lI≈ut
[(
i
+12Ë% 16] = 
ãmp
[i] ^ 
›_c
[i];

133 
rijnd´lI≈ut
[15] ^= 2;

134 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out
 );

135 
i
=0; i<16; i++)

136 
out
[
i
] ^
›_c
[i];

137 
i
=0; i<16; i++)

138 
ck_pP
[
i
] = 
out
[i];

139 
	`LOG_TRACE
(
DEBUG
,

141 
ck_pP
[0],ck_pP[1],ck_pP[2], ck_pP[3], ck_pP[4], ck_pP[5], ck_pP[6], ck_pP[7]);

145 
i
=0; i<16; i++)

146 
rijnd´lI≈ut
[(
i
+8Ë% 16] = 
ãmp
[i] ^ 
›_c
[i];

147 
rijnd´lI≈ut
[15] ^= 4;

148 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out
 );

149 
i
=0; i<16; i++)

150 
out
[
i
] ^
›_c
[i];

151 
i
=0; i<16; i++)

152 
ik_pP
[
i
] = 
out
[i];

153 
	`LOG_TRACE
(
DEBUG
,

155 
ik_pP
[0],ik_pP[1],ik_pP[2], ik_pP[3], ik_pP[4], ik_pP[5], ik_pP[6], ik_pP[7],

156 
ik_pP
[8],ik_pP[9],ik_pP[10],ik_pP[11],ik_pP[12],ik_pP[13],ik_pP[14],ik_pP[15]);

158 
	}
}

169 
	$f1°¨
–
u8
 
k_pP
[16], u8 
ønd_pP
[16], u8 
sqn_pP
[6], u8 
amf_pP
[2],

170 
u8
 
mac_s_pP
[8] )

172 
u8
 
›_c
[16];

173 
u8
 
ãmp
[16];

174 
u8
 
ö1
[16];

175 
u8
 
out1
[16];

176 
u8
 
rijnd´lI≈ut
[16];

177 
u8
 
i
;

178 
	`Rijnd´lKeyScheduÀ
–
k_pP
 );

179 
	`CompuãOPc
–
›_c
 );

180 
i
=0; i<16; i++)

181 
rijnd´lI≈ut
[
i
] = 
ønd_pP
[i] ^ 
›_c
[i];

182 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
ãmp
 );

183 
i
=0; i<6; i++)

185 
ö1
[
i
] = 
sqn_pP
[i];

186 
ö1
[
i
+8] = 
sqn_pP
[i];

188 
i
=0; i<2; i++)

190 
ö1
[
i
+6] = 
amf_pP
[i];

191 
ö1
[
i
+14] = 
amf_pP
[i];

195 
i
=0; i<16; i++)

196 
rijnd´lI≈ut
[(
i
+8Ë% 16] = 
ö1
[i] ^ 
›_c
[i];

198 
i
=0; i<16; i++)

199 
rijnd´lI≈ut
[
i
] ^
ãmp
[i];

200 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out1
 );

201 
i
=0; i<16; i++)

202 
out1
[
i
] ^
›_c
[i];

203 
i
=0; i<8; i++)

204 
mac_s_pP
[
i
] = 
out1
[i+8];

206 
	}
}

216 
	$f5°¨
–
u8
 
k_pP
[16], u8 
ønd_pP
[16],

217 
u8
 
ak_pP
[6] )

219 
u8
 
›_c
[16];

220 
u8
 
ãmp
[16];

221 
u8
 
out
[16];

222 
u8
 
rijnd´lI≈ut
[16];

223 
u8
 
i
;

224 
	`Rijnd´lKeyScheduÀ
–
k_pP
 );

225 
	`CompuãOPc
–
›_c
 );

226 
i
=0; i<16; i++)

227 
rijnd´lI≈ut
[
i
] = 
ønd_pP
[i] ^ 
›_c
[i];

228 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
ãmp
 );

232 
i
=0; i<16; i++)

233 
rijnd´lI≈ut
[(
i
+4Ë% 16] = 
ãmp
[i] ^ 
›_c
[i];

234 
rijnd´lI≈ut
[15] ^= 8;

235 
	`Rijnd´lEn¸y±
–
rijnd´lI≈ut
, 
out
 );

236 
i
=0; i<16; i++)

237 
out
[
i
] ^
›_c
[i];

238 
i
=0; i<6; i++)

239 
ak_pP
[
i
] = 
out
[i];

241 
	}
}

246 
	$CompuãOPc
–
u8
 
›_c_pP
[16] )

248 
u8
 
i
;

249 
	`LOG_TRACE
(
DEBUG
,

251 
OP
[0],OP[1],OP[2], OP[3], OP[4], OP[5], OP[6], OP[7],

252 
OP
[8],OP[9],OP[10],OP[11],OP[12],OP[13],OP[14],OP[15]);

253 
	`Rijnd´lEn¸y±
–
OP
, 
›_c_pP
 );

254 
i
=0; i<16; i++)

255 
›_c_pP
[
i
] ^
OP
[i];

257 
	}
}

259 
u8
 
	groundKeys
[11][4][4];

261 
u8
 
	gS
[256] = {

281 
u8
 
	gXtime
[256] = {

303 
	$Rijnd´lKeyScheduÀ
–
u8
 
key
[16] )

305 
u8
 
roundC⁄°
;

306 
i
, 
j
;

308 
i
=0; i<16; i++)

309 
roundKeys
[0][
i
 & 0x03][i>>2] = 
key
[i];

310 
roundC⁄°
 = 1;

312 
i
=1; i<11; i++)

314 
roundKeys
[
i
][0][0] = 
S
[roundKeys[i-1][1][3]]

315 ^ 
roundKeys
[
i
-1][0][0] ^ 
roundC⁄°
;

316 
roundKeys
[
i
][1][0] = 
S
[roundKeys[i-1][2][3]]

317 ^ 
roundKeys
[
i
-1][1][0];

318 
roundKeys
[
i
][2][0] = 
S
[roundKeys[i-1][3][3]]

319 ^ 
roundKeys
[
i
-1][2][0];

320 
roundKeys
[
i
][3][0] = 
S
[roundKeys[i-1][0][3]]

321 ^ 
roundKeys
[
i
-1][3][0];

322 
j
=0; j<4; j++)

324 
roundKeys
[
i
][
j
][1] =ÑoundKeys[i-1][j][1] ^ÑoundKeys[i][j][0];

325 
roundKeys
[
i
][
j
][2] =ÑoundKeys[i-1][j][2] ^ÑoundKeys[i][j][1];

326 
roundKeys
[
i
][
j
][3] =ÑoundKeys[i-1][j][3] ^ÑoundKeys[i][j][2];

329 
roundC⁄°
 = 
Xtime
[roundConst];

332 
	}
}

334 
	$KeyAdd
(
u8
 
°©e
[4][4], u8 
roundKeys
[11][4][4], 
round
)

336 
i
, 
j
;

337 
i
=0; i<4; i++)

338 
j
=0; j<4; j++)

339 
°©e
[
i
][
j
] ^
roundKeys
[
round
][i][j];

341 
	}
}

343 
	$ByãSub
(
u8
 
°©e
[4][4])

345 
i
, 
j
;

346 
i
=0; i<4; i++)

347 
j
=0; j<4; j++)

348 
°©e
[
i
][
j
] = 
S
[state[i][j]];

350 
	}
}

352 
	$Shi·Row
(
u8
 
°©e
[4][4])

354 
u8
 
ãmp
;

356 
ãmp
 = 
°©e
[1][0];

357 
°©e
[1][0] = state[1][1];

358 
°©e
[1][1] = state[1][2];

359 
°©e
[1][2] = state[1][3];

360 
°©e
[1][3] = 
ãmp
;

362 
ãmp
 = 
°©e
[2][0];

363 
°©e
[2][0] = state[2][2];

364 
°©e
[2][2] = 
ãmp
;

365 
ãmp
 = 
°©e
[2][1];

366 
°©e
[2][1] = state[2][3];

367 
°©e
[2][3] = 
ãmp
;

369 
ãmp
 = 
°©e
[3][0];

370 
°©e
[3][0] = state[3][3];

371 
°©e
[3][3] = state[3][2];

372 
°©e
[3][2] = state[3][1];

373 
°©e
[3][1] = 
ãmp
;

375 
	}
}

377 
	$MixCﬁumn
(
u8
 
°©e
[4][4])

379 
u8
 
ãmp
, 
tmp
, 
tmp0
;

380 
i
;

382 
i
=0; i<4;i++)

384 
ãmp
 = 
°©e
[0][
i
] ^ state[1][i] ^ state[2][i] ^ state[3][i];

385 
tmp0
 = 
°©e
[0][
i
];

387 
tmp
 = 
Xtime
[
°©e
[0][
i
] ^ state[1][i]];

388 
°©e
[0][
i
] ^
ãmp
 ^ 
tmp
;

389 
tmp
 = 
Xtime
[
°©e
[1][
i
] ^ state[2][i]];

390 
°©e
[1][
i
] ^
ãmp
 ^ 
tmp
;

391 
tmp
 = 
Xtime
[
°©e
[2][
i
] ^ state[3][i]];

392 
°©e
[2][
i
] ^
ãmp
 ^ 
tmp
;

393 
tmp
 = 
Xtime
[
°©e
[3][
i
] ^ 
tmp0
];

394 
°©e
[3][
i
] ^
ãmp
 ^ 
tmp
;

397 
	}
}

403 
	$Rijnd´lEn¸y±
–
u8
 
öput
[16], u8 
ouçut
[16] )

405 
u8
 
°©e
[4][4];

406 
i
, 
r
;

408 
i
=0; i<16; i++)

409 
°©e
[
i
 & 0x3][i>>2] = 
öput
[i];

411 
	`KeyAdd
(
°©e
, 
roundKeys
, 0);

413 
r
=1;Ñ<=9;Ñ++)

415 
	`ByãSub
(
°©e
);

416 
	`Shi·Row
(
°©e
);

417 
	`MixCﬁumn
(
°©e
);

418 
	`KeyAdd
(
°©e
, 
roundKeys
, 
r
);

421 
	`ByãSub
(
°©e
);

422 
	`Shi·Row
(
°©e
);

423 
	`KeyAdd
(
°©e
, 
roundKeys
, 
r
);

425 
i
=0; i<16; i++)

427 
ouçut
[
i
] = 
°©e
[i & 0x3][i>>2];

430 
	}
}

	@src/api/usim/aka_functions.h

29 
	tu8
;

32 
f1
 ( 
u8
 
k
[16], u8 
ønd
[16], u8 
sqn
[6], u8 
amf
[2],

33 
u8
 
mac_a
[8] );

34 
f2345
 ( 
u8
 
k
[16], u8 
ønd
[16],

35 
u8
 
ªs
[8], u8 
ck
[16], u8 
ik
[16], u8 
ak
[6] );

36 
f1°¨
–
u8
 
k
[16], u8 
ønd
[16], u8 
sqn
[6], u8 
amf
[2],

37 
u8
 
mac_s
[8] );

38 
f5°¨
–
u8
 
k
[16], u8 
ønd
[16],

39 
u8
 
ak
[6] );

40 
CompuãOPc
–
u8
 
›_c
[16] );

41 
Rijnd´lKeyScheduÀ
–
u8
 
key
[16] );

42 
Rijnd´lEn¸y±
–
u8
 
öput
[16], u8 
ouçut
[16] );

	@src/api/usim/usim_api.c

48 #ifde‡
NAS_UE


50 
	~"usim_≠i.h
"

51 
	~"«s_log.h
"

52 
	~"mem‹y.h
"

54 
	~"aka_fun˘i⁄s.h
"

55 
	~<°rög.h
>

56 
	~<°dlib.h
>

69 
	#USIM_API_NVRAM_FILENAME
 ".usim.nvøm"

	)

75 
	#USIM_API_NVRAM_DIRNAME
 "USIM_DIR"

	)

80 
	#USIM_API_K_SIZE
 16

	)

81 
	#USIM_API_K_VALUE
 "8BAF473F2F8FD09487CCCBD7097C6862"

	)

83 
UI¡8_t
 
	g_usim_≠i_k
[
USIM_API_K_SIZE
];

89 
	s_usim_≠i_d©a_s
 {

91 
UI¡32_t
 
	msqn_ms
;

93 
	#USIM_API_SQN_LIST_SIZE
 32

	)

94 
UI¡8_t
 
	mn_sqns
;

95 
UI¡32_t
 
	msqn
[
USIM_API_SQN_LIST_SIZE
];

96 } 
	g_usim_≠i_d©a
;

98 
UI¡8_t
 
_usim_≠i_hex_ch¨_to_hex_vÆue
 (
c
);

99 
_usim_≠i_hex_°rög_to_hex_vÆue
 (
UI¡8_t
 *
hex_vÆue
, c⁄° *
hex_°rög
, 
size
);

100 
_usim_≠i_check_sqn
(
UI¡32_t
 
£q
, 
UI¡8_t
 
öd
);

120 
	$usim_≠i_ªad
(
usim_d©a_t
* 
d©a
)

122 
LOG_FUNC_IN
;

125 * 
∑th
 = 
	`mem‹y_gë_∑th
(
USIM_API_NVRAM_DIRNAME
,

126 
USIM_API_NVRAM_FILENAME
);

127 i‡(
∑th
 =
NULL
) {

128 
	`LOG_TRACE
(
ERROR
, "USIM-API - FailedÅo get USIMÖathname");

129 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

133 i‡(
	`mem‹y_ªad
(
∑th
, 
d©a
, (
usim_d©a_t
)Ë!
RETURNok
) {

134 
	`LOG_TRACE
(
ERROR
, "USIM-API - %s file isÉitherÇot valid "

135 "‹ÇŸÖª£¡", 
∑th
);

136 
	`‰ì
(
∑th
);

137 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

141 
	`_usim_≠i_hex_°rög_to_hex_vÆue
(
_usim_≠i_k
, 
USIM_API_K_VALUE
, 
USIM_API_K_SIZE
);

143 
	`‰ì
(
∑th
);

144 
	`LOG_FUNC_RETURN
 (
RETURNok
);

145 
	}
}

161 
	$usim_≠i_wrôe
(c⁄° 
usim_d©a_t
* 
d©a
)

163 
LOG_FUNC_IN
;

166 * 
∑th
 = 
	`mem‹y_gë_∑th
(
USIM_API_NVRAM_DIRNAME
,

167 
USIM_API_NVRAM_FILENAME
);

168 i‡(
∑th
 =
NULL
) {

169 
	`LOG_TRACE
(
ERROR
, "USIM-API - FailedÅo get USIMÖathname");

170 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

174 i‡(
	`mem‹y_wrôe
(
∑th
, 
d©a
, (
usim_d©a_t
)Ë!
RETURNok
) {

176 
	`LOG_TRACE
(
ERROR
, "USIM-API - U«bÀÅÿwrôêUSIM fûê%s", 
∑th
);

177 
	`‰ì
(
∑th
);

178 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

181 
	`‰ì
(
∑th
);

182 
	`LOG_FUNC_RETURN
 (
RETURNok
);

183 
	}
}

216 
	$usim_≠i_authítiˇã
(c⁄° 
O˘ëSåög
* 
ønd_pP
, c⁄° O˘ëSåög* 
auä_pP
,

217 
O˘ëSåög
* 
auts_pP
, O˘ëSåög* 
ªs_pP
,

218 
O˘ëSåög
* 
ck_pP
, O˘ëSåög* 
ik_pP
)

220 
LOG_FUNC_IN
;

222 
rc
;

223 
i
;

225 
	`LOG_TRACE
(
DEBUG
, "USIM-API -Ñ™d :%s",
	`dump_o˘ë_°rög
(
ønd_pP
));

226 
	`LOG_TRACE
(
DEBUG
, "USIM-API -áuä :%s",
	`dump_o˘ë_°rög
(
auä_pP
));

232 
	#USIM_API_AK_SIZE
 6

	)

233 
u8
 
ak
[
USIM_API_AK_SIZE
];

234 
	`f2345
(
_usim_≠i_k
, 
ønd_pP
->
vÆue
,

235 
ªs_pP
->
vÆue
, 
ck_pP
->vÆue, 
ik_pP
->vÆue, 
ak
);

236 
	`LOG_TRACE
(
DEBUG
, "USIM-API -Ñes(f2Ë :%s",
	`dump_o˘ë_°rög
(
ªs_pP
));

237 
	`LOG_TRACE
(
DEBUG
, "USIM-API - ck(f3Ë :%s",
	`dump_o˘ë_°rög
(
ck_pP
));

238 
	`LOG_TRACE
(
DEBUG
, "USIM-API - ik(f4Ë :%s",
	`dump_o˘ë_°rög
(
ik_pP
));

239 
	`LOG_TRACE
(
DEBUG
, "USIM-API -ák(f5) : %02X%02X%02X%02X%02X%02X",

240 
ak
[0],ak[1],ak[2],ak[3],ak[4],ak[5]);

243 
	#USIM_API_SQN_SIZE
 
USIM_API_AK_SIZE


	)

244 
u8
 
sqn
[
USIM_API_SQN_SIZE
];

245 
i
 = 0; i < 
USIM_API_SQN_SIZE
; i++) {

246 
sqn
[
i
] = 
auä_pP
->
vÆue
[i] ^ 
ak
[i];

248 
	`LOG_TRACE
(
DEBUG
, "USIM-API - Retrieved SQN %02X%02X%02X%02X%02X%02X",

249 
sqn
[0],sqn[1],sqn[2],sqn[3],sqn[4],sqn[5]);

252 
	#USIM_API_XMAC_SIZE
 8

	)

253 
u8
 
xmac
[
USIM_API_XMAC_SIZE
];

254 
	`f1
(
_usim_≠i_k
, 
ønd_pP
->
vÆue
, 
sqn
, &
auä_pP
->vÆue[
USIM_API_SQN_SIZE
], 
xmac
);

255 
	`LOG_TRACE
(
DEBUG
,

257 
xmac
[0],xmac[1],xmac[2],xmac[3],

258 
xmac
[4],xmac[5],xmac[6],xmac[7]);

261 
	#USIM_API_AMF_SIZE
 2

	)

262 i‡–
	`memcmp
(
xmac
, &
auä_pP
->
vÆue
[
USIM_API_SQN_SIZE
 + 
USIM_API_AMF_SIZE
],

263 
USIM_API_XMAC_SIZE
) != 0 ) {

264 
	`LOG_TRACE
(
INFO
,

268 
	`LOG_TRACE
(
INFO
,

273 
rc
 = 
	`_usim_≠i_check_sqn
(*(
UI¡32_t
*)(
sqn
), sqn[
USIM_API_SQN_SIZE
 - 1]);

274 i‡(
rc
 !
RETURNok
) {

279 
	`f5°¨
(
_usim_≠i_k
, 
ønd_pP
->
vÆue
, 
ak
);

281 
	#USIM_API_SQNMS_SIZE
 
USIM_API_SQN_SIZE


	)

282 
u8
 
sqn_ms
[
USIM_API_SQNMS_SIZE
];

283 
	`mem£t
(
sqn_ms
, 0, 
USIM_API_SQNMS_SIZE
);

284 
	#USIM_API_SQN_MS_SIZE
 3

	)

285 
i
 = 0; i < 
USIM_API_SQN_MS_SIZE
; i++) {

287 
sqn_ms
[
USIM_API_SQNMS_SIZE
 - 
i
] =

288 ((
UI¡8_t
*)(
_usim_≠i_d©a
.
sqn_ms
))[
USIM_API_SQN_MS_SIZE
 - 
i
];

291 
u8
 
sqnms
[
USIM_API_SQNMS_SIZE
];

292 
i
 = 0; i < 
USIM_API_SQNMS_SIZE
; i++) {

293 
sqnms
[
i
] = 
sqn_ms
[i] ^ 
ak
[i];

295 
	`LOG_TRACE
(
DEBUG
, "USIM-API - SQNms %02X%02X%02X%02X%02X%02X",

296 
sqnms
[0],sqnms[1],sqnms[2],sqnms[3],sqnms[4],sqnms[5]);

300 
	#USIM_API_MACS_SIZE
 
USIM_API_XMAC_SIZE


	)

301 
u8
 
macs
[
USIM_API_MACS_SIZE
];

302 
	`f1°¨
(
_usim_≠i_k
, 
ønd_pP
->
vÆue
, 
sqn_ms
,

303 &
ønd_pP
->
vÆue
[
USIM_API_SQN_SIZE
], 
macs
);

304 
	`LOG_TRACE
(
DEBUG
, "USIM-API - MACS %02X%02X%02X%02X%02X%02X%02X%02X",

305 
macs
[0],macs[1],macs[2],macs[3],

306 
macs
[4],macs[5],macs[6],macs[7]);

310 
	`mem˝y
(&
auts_pP
->
vÆue
[0], 
sqnms
, 
USIM_API_SQNMS_SIZE
);

311 
	`mem˝y
(&
auts_pP
->
vÆue
[
USIM_API_SQNMS_SIZE
], 
macs
, 
USIM_API_MACS_SIZE
);

314 
	`LOG_FUNC_RETURN
 (
RETURNok
);

315 
	}
}

335 
UI¡8_t
 
	$_usim_≠i_hex_ch¨_to_hex_vÆue
 (
c
)

337 i‡(
c
 >= 'A')

340 
c
 &= ~('a' ^ 'A');

342  (
c
 - 'A' + 10);

346  (
c
 - '0');

348 
	}
}

366 
	$_usim_≠i_hex_°rög_to_hex_vÆue
 (
UI¡8_t
 *
hex_vÆue
, c⁄° *
hex_°rög
, 
size
)

368 
i
;

370 
i
=0; i < 
size
; i++)

372 
hex_vÆue
[
i
] = (
	`_usim_≠i_hex_ch¨_to_hex_vÆue
(
hex_°rög
[2 * i]) << 4) | _usim_api_hex_char_to_hex_value(hex_string[2 * i + 1]);

374 
	}
}

395 
	$_usim_≠i_check_sqn
(
UI¡32_t
 
£q
, 
UI¡8_t
 
öd
)

398  (
RETURNok
);

399 
	}
}

	@src/api/usim/usim_api.h

47 #i‚de‡
__USIM_API_H__


48 
	#__USIM_API_H__


	)

50 
	~"comm⁄Def.h
"

51 
	~"√tw‹kDef.h
"

52 
	~"O˘ëSåög.h
"

66 
	#USIM_TLV_T
(
SIZE
Ë°ru˘ {
UI¡8_t
 
ty≥
; UI¡8_à
Àngth
; 
Byã_t
 
vÆue
[SIZE];}

	)

76 
	#USIM_NAS_SIGNALLING_PRIORITY_TAG
 0x80U

	)

77 
USIM_TLV_T
(1Ë
	mNAS_Sig«ŒögPri‹ôy
;

80 
	#USIM_NMO_I_BEHAVIOUR_TAG
 0x81U

	)

81 
USIM_TLV_T
(1Ë
	mNMO_I_Behaviour
;

84 
	#USIM_ATTACH_WITH_IMSI_TAG
 0x82U

	)

85 
USIM_TLV_T
(1Ë
	mAâachWôhImsi
;

88 
	#USIM_MINIMUM_PERIODIC_SEARCH_TIMER_TAG
 0x83U

	)

89 
USIM_TLV_T
(1Ë
	mMöimumPîiodicSórchTimî
;

92 
	#USIM_EXTENDED_ACCESS_BARRING_TAG
 0x84U

	)

93 
USIM_TLV_T
(1Ë
	mExãndedAc˚ssB¨rög
;

96 
	#USIM_TIMER_T3245_BEHAVIOUR_TAG
 0x85U

	)

97 
USIM_TLV_T
(1Ë
	mTimî_T3245_Behaviour
;

98 } 
	tusim_«sc⁄fig_t
;

106 
	#USIM_KSI_MIN
 0b000

	)

107 
	#USIM_KSI_MAX
 0b110

	)

108 
	#USIM_KSI_NOT_AVAILABLE
 0b111

	)

109 
Byã_t
 
	mksi
;

111 
	#USIM_CK_SIZE
 16

	)

112 
Byã_t
 
	mck
[
USIM_CK_SIZE
];

114 
	#USIM_IK_SIZE
 16

	)

115 
Byã_t
 
	mik
[
USIM_IK_SIZE
];

116 } 
	tusim_keys_t
;

125 
	#USIM_EPS_NAS_SECURITY_CONTEXT_TAG
 0xA0U

	)

126 
UI¡8_t
 
	mÀngth
;

128 
	#USIM_KSI_ASME_TAG
 0x80U

	)

129 
USIM_TLV_T
(1Ë
	mKSIasme
;

131 
	#USIM_K_ASME_TAG
 0x81U

	)

132 
	#USIM_K_ASME_SIZE
 32

	)

133 
USIM_TLV_T
(
USIM_K_ASME_SIZE
Ë
	mKasme
;

135 
	#USIM_UL_NAS_COUNT_TAG
 0x82U

	)

136 
	#USIM_UL_NAS_COUNT_SIZE
 4

	)

137 
USIM_TLV_T
(
USIM_UL_NAS_COUNT_SIZE
Ë
	mulNAScou¡
;

139 
	#USIM_DL_NAS_COUNT_TAG
 0x83U

	)

140 
	#USIM_DL_NAS_COUNT_SIZE
 4

	)

141 
USIM_TLV_T
(
USIM_DL_NAS_COUNT_SIZE
Ë
	mdlNAScou¡
;

144 
	#USIM_INT_ENC_ALGORITHMS_TAG
 0x84U

	)

145 
	#USIM_INT_EIA0
 0x00

	)

146 
	#USIM_INT_EIA1
 0x01

	)

147 
	#USIM_INT_EIA2
 0x02

	)

148 
	#USIM_INT_EIA3
 0x03

	)

149 
	#USIM_INT_EIA4
 0x04

	)

150 
	#USIM_INT_EIA5
 0x05

	)

151 
	#USIM_INT_EIA6
 0x06

	)

152 
	#USIM_INT_EIA7
 0x07

	)

153 
	#USIM_ENC_EEA0
 0x00

	)

154 
	#USIM_ENC_EEA1
 0x10

	)

155 
	#USIM_ENC_EEA2
 0x20

	)

156 
	#USIM_ENC_EEA3
 0x30

	)

157 
	#USIM_ENC_EEA4
 0x40

	)

158 
	#USIM_ENC_EEA5
 0x50

	)

159 
	#USIM_ENC_EEA6
 0x60

	)

160 
	#USIM_ENC_EEA7
 0x70

	)

161 
USIM_TLV_T
(1Ë
	mÆg‹ôhmID
;

162 } 
	tusim_£curôy˘x_t
;

169 
Byã_t
 
	mÀngth
;

170 
msisdn_t
 
	mnumbî
;

171 
Byã_t
 
	mc⁄f1_ªc‹d_id
;

172 
Byã_t
 
	mext1_ªc‹d_id
;

173 } 
	tusim_msisdn_t
;

181 
	#USIM_PNN_FULLNAME_TAG
 0x43U

	)

182 
	#USIM_PNN_FULLNAME_SIZE
 
NET_FORMAT_LONG_SIZE


	)

183 
USIM_TLV_T
(
USIM_PNN_FULLNAME_SIZE
Ë
	mfuŒ«me
;

185 
	#USIM_PNN_SHORTNAME_TAG
 0x45U

	)

186 
	#USIM_PNN_SHORTNAME_SIZE
 
NET_FORMAT_SHORT_SIZE


	)

187 
USIM_TLV_T
(
USIM_PNN_SHORTNAME_SIZE
Ë
	msh‹äame
;

188 } 
	tusim_≤n_t
;

196 
∂mn_t
 
	m∂mn
;

197 
èc_t
 
	m°¨t
;

198 
èc_t
 
	míd
;

200 
UI¡8_t
 
	mªc‹d_id
;

201 } 
	tusim_›l_t
;

208 
∂mn_t
 
	m∂mn
;

209 
	#USIM_ACT_GSM
 0x8000

	)

210 
	#USIM_ACT_COMPACT
 0x4000

	)

211 
	#USIM_ACT_CDMA_HRPD
 0x2000

	)

212 
	#USIM_ACT_CDMA_1xRTT
 0x1000

	)

213 
	#USIM_ACT_UTRAN
 0x0080

	)

214 
	#USIM_ACT_EUTRAN
 0x0040

	)

215 
UI¡16_t
 
	mAcT
;

216 } 
	tusim_∂mn_a˘_t
;

223 
UI¡32_t
 
	mtmsi
;

224 
œi_t
 
	mœi
;

225 
Byã_t
 
	mª£rved
;

226 
	#USIM_LOCI_UPDATED
 0x00

	)

227 
	#USIM_LOCI_NOT_UPDATED
 0x01

	)

228 
	#USIM_LOCI_PLMN_NOT_ALLOWED
 0x02

	)

229 
	#USIM_LOCI_LA_NOT_ALLOWED
 0x03

	)

230 
Byã_t
 
	m°©us
;

231 } 
	tusim_loci_t
;

238 
UI¡32_t
 
	mp_tmsi
;

239 
Byã_t
 
	msig«tuª
[3];

240 
RAI_t
 
	møi
;

241 
	#USIM_PSLOCI_UPDATED
 0x00

	)

242 
	#USIM_PSLOCI_NOT_UPDATED
 0x01

	)

243 
	#USIM_PSLOCI_PLMN_NOT_ALLOWED
 0x02

	)

244 
	#USIM_PSLOCI_LA_NOT_ALLOWED
 0x03

	)

245 
Byã_t
 
	m°©us
;

246 } 
	tusim_p¶oci_t
;

253 
GUTI_t
 
	mguti
;

254 
èi_t
 
	mèi
;

255 
	#USIM_EPSLOCI_UPDATED
 0x00

	)

256 
	#USIM_EPSLOCI_NOT_UPDATED
 0x01

	)

257 
	#USIM_EPSLOCI_ROAMING_NOT_ALLOWED
 0x02

	)

258 
Byã_t
 
	m°©us
;

259 } 
	tusim_ï¶oci_t
;

276 
	#USIM_NORMAL_MODE
 0x00U

	)

277 
	#USIM_TYPE_APPROVAL_MODE
 0x80U

	)

278 
	#USIM_NORMAL_SPECIFIC_MODE
 0x01U

	)

279 
	#USIM_TYPE_APPROVAL_SPECIFIC_MODE
 0x81U

	)

280 
	#USIM_MAINTENANCE_MODE
 0x02U

	)

281 
	#USIM_CELL_TEST_MODE
 0x04U

	)

282 
Byã_t
 
	mUE_O≥øti⁄_Mode
;

283 
UI¡16_t
 
	mAddôi⁄Æ_Info
;

285 
Byã_t
 
	mMNC_Lígth
;

287 } 
	tusim_ad_t
;

300 
imsi_t
 
	mimsi
;

301 
usim_keys_t
 
	mkeys
;

302 
Byã_t
 
	mhµlmn
;

303 
	#USIM_FPLMN_MAX
 4

	)

304 
∂mn_t
 
	mÂlmn
[
USIM_FPLMN_MAX
];

305 
usim_loci_t
 
	mloci
;

306 
usim_p¶oci_t
 
	mp¶oci
;

307 
usim_ad_t
 
	mad
;

313 
usim_£curôy˘x_t
 
	m£curôy˘x
;

315 
usim_msisdn_t
 
	mmsisdn
;

317 
	#USIM_PNN_MAX
 8

	)

318 
usim_≤n_t
 
	m≤n
[
USIM_PNN_MAX
];

320 
	#USIM_OPL_MAX
 
USIM_PNN_MAX


	)

321 
usim_›l_t
 
	m›l
[
USIM_OPL_MAX
];

323 
	#USIM_EHPLMN_MAX
 2

	)

324 
∂mn_t
 
	meh∂mn
[
USIM_EHPLMN_MAX
];

326 
usim_∂mn_a˘_t
 
	mh∂mn
;

328 
	#USIM_PLMN_MAX
 8

	)

329 
usim_∂mn_a˘_t
 
	m∂mn
[
USIM_PLMN_MAX
];

331 
	#USIM_OPLMN_MAX
 8

	)

332 
usim_∂mn_a˘_t
 
	m›lmn
[
USIM_OPLMN_MAX
];

334 
usim_ï¶oci_t
 
	mï¶oci
;

336 
usim_«sc⁄fig_t
 
	m«sc⁄fig
;

337 } 
	tusim_d©a_t
;

347 
usim_≠i_ªad
(
usim_d©a_t
* 
d©a
);

349 
usim_≠i_wrôe
(c⁄° 
usim_d©a_t
* 
d©a
);

351 
usim_≠i_authítiˇã
(c⁄° 
O˘ëSåög
* 
ønd
, c⁄° O˘ëSåög* 
auä
,

352 
O˘ëSåög
* 
auts
, O˘ëSåög* 
ªs
,

353 
O˘ëSåög
* 
ck
, O˘ëSåög* 
ik
);

	@src/emm/Attach.c

63 
	~"emm_¥oc.h
"

64 
	~"√tw‹kDef.h
"

65 
	~"«s_log.h
"

66 
	~"«s_timî.h
"

68 
	~"emmD©a.h
"

70 
	~"emm_ßp.h
"

71 
	~"esm_ßp.h
"

72 
	~"emm_ˇu£.h
"

74 
	~"NasSecurôyAlg‹ôhms.h
"

76 #ifde‡
NAS_MME


77 
	~"mme_≠i.h
"

78 
	~"mme_c⁄fig.h
"

79 #i‡
deföed
(
EPC_BUILD
)

80 
	~"«s_ôti_mesßgög.h
"

84 
	~<°rög.h
>

85 
	~<°dlib.h
>

96 c⁄° *
	g_emm_©èch_ty≥_°r
[] = {

105 #ifde‡
NAS_UE


109 *
_emm_©èch_t3410_h™dÀr
(*);

110 *
_emm_©èch_t3411_h™dÀr
(*);

111 *
_emm_©èch_t3402_h™dÀr
(*);

116 
_emm_©èch_abn‹mÆ_ˇ£s_bcd
(
emm_ßp_t
 *);

122 
	#EMM_ATTACH_COUNTER_MAX
 5

	)

123 
	m©ãm±_cou¡
;

125 } 
	g_emm_©èch_d©a
 = {0};

133 #ifde‡
NAS_MME


137 *
_emm_©èch_t3450_h™dÀr
(*);

142 
_emm_©èch_idítify
(*);

143 
_emm_©èch_£curôy
(*);

144 
_emm_©èch
(*);

149 
_emm_©èch_ªÀa£
(*);

150 
_emm_©èch_ªje˘
(*);

151 
_emm_©èch_ab‹t
(*);

153 
_emm_©èch_have_ch™ged
(c⁄° 
emm_d©a_c⁄ãxt_t
 *
˘x
,

154 
emm_¥oc_©èch_ty≥_t
 
ty≥
, 
ksi
,

155 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
,

156 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

157 
umts_¥e£¡
, 
g¥s_¥e£¡
);

158 
_emm_©èch_upd©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ueid
,

159 
emm_¥oc_©èch_ty≥_t
 
ty≥
, 
ksi
,

160 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
,

161 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

162 
umts_¥e£¡
, 
g¥s_¥e£¡
,

163 c⁄° 
O˘ëSåög
 *
esm_msg
);

169 
	mueid
;

170 
	#ATTACH_COUNTER_MAX
 5

	)

171 
	mªå™smissi⁄_cou¡
;

172 
O˘ëSåög
 
	mesm_msg
;

174 } 
	t©èch_d©a_t
;

176 
_emm_©èch_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
emm_˘x
, 
©èch_d©a_t
 *
d©a
);

189 #ifde‡
NAS_UE


212 
	$emm_¥oc_©èch
(
emm_¥oc_©èch_ty≥_t
 
ty≥
)

214 
LOG_FUNC_IN
;

216 
emm_ßp_t
 
emm_ßp
;

217 
emm_as_e°ablish_t
 *
emm_as
 = &
emm_ßp
.
u
.emm_as.u.
e°ablish
;

218 
esm_ßp_t
 
esm_ßp
;

219 
rc
;

221 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttachÅype = %s (%d)",

222 
_emm_©èch_ty≥_°r
[
ty≥
],Åype);

225 i‡(
ty≥
 =
EMM_ATTACH_TYPE_EMERGENCY
) {

226 
_emm_d©a
.
is_emîgícy
 = 
TRUE
;

230 
emm_as
->
NASöfo
 = 
EMM_AS_NAS_INFO_ATTACH
;

232 
emm_as
->
ty≥
 =Åype;

234 i‡(
_emm_d©a
.
is_emîgícy
) {

235 
emm_as
->
RRCˇu£
 = 
NET_ESTABLISH_CAUSE_EMERGENCY
;

236 
emm_as
->
RRCty≥
 = 
NET_ESTABLISH_TYPE_EMERGENCY_CALLS
;

238 
emm_as
->
RRCˇu£
 = 
NET_ESTABLISH_CAUSE_MO_SIGNAL
;

239 
emm_as
->
RRCty≥
 = 
NET_ESTABLISH_TYPE_ORIGINATING_SIGNAL
;

242 
emm_as
->
∂mnID
 = &
_emm_d©a
.
•lmn
;

246 
emm_as
->
UEid
.
guti
 = 
NULL
;

247 
emm_as
->
UEid
.
èi
 = 
NULL
;

248 
emm_as
->
UEid
.
imsi
 = 
NULL
;

249 
emm_as
->
UEid
.
imei
 = 
NULL
;

251 i‡(
_emm_d©a
.
AâachWôhImsi
) {

254 i‡–(!
_emm_d©a
.
is_Ωlmn
Ë&& (!_emm_d©a.
is_ïlmn
) ) {

255 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttach with IMSI");

257 
emm_as
->
UEid
.
imsi
 = 
_emm_d©a
.imsi;

259 
	`LOG_TRACE
(
INFO
,

261 
_emm_d©a
.
is_Ωlmn
,

262 
_emm_d©a
.
is_ïlmn
);

264 } i‡(
_emm_d©a
.
guti
) {

265 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttach with GUTI");

267 
emm_as
->
UEid
.
guti
 = 
_emm_d©a
.guti;

268 
emm_as
->
UEid
.
èi
 = 
_emm_d©a
.tai;

269 } i‡(!
_emm_d©a
.
is_emîgícy
) {

270 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttach with IMSI cause isÇoÉmergencyándÇo GUTI");

272 
emm_as
->
UEid
.
imsi
 = 
_emm_d©a
.imsi;

276 i‡(
_emm_d©a
.
imsi
) {

278 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttach with IMSI cause isÉmergencyándÇo GUTI");

279 
emm_as
->
UEid
.
imsi
 = 
_emm_d©a
.imsi;

281 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPSáttach with IMSI cause isÉmergencyándÇo GUTIándÇo IMSI");

283 
emm_as
->
UEid
.
imei
 = 
_emm_d©a
.imei;

287 
	`emm_as_£t_£curôy_d©a
(&
emm_as
->
s˘x
, 
_emm_d©a
.
£curôy
, 
FALSE
, FALSE);

288 
emm_as
->
ksi
 = 
EMM_AS_NO_KEY_AVAILABLE
;

289 i‡(
_emm_d©a
.
£curôy
) {

290 i‡(
_emm_d©a
.
£curôy
->
ty≥
 !
EMM_KSI_NOT_AVAILABLE
) {

291 
emm_as
->
ksi
 = 
_emm_d©a
.
£curôy
->
eksi
;

293 
	`LOG_TRACE
(
INFO
, "EMM-PROC -Éps_í¸y±i⁄ 0x%X", 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_í¸y±i⁄
);

294 
	`LOG_TRACE
(
INFO
, "EMM-PROC -Éps_öãgrôy 0x%X", 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_öãgrôy
);

295 
emm_as
->
í¸y±i⁄
 = 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_í¸y±i⁄
;

296 
emm_as
->
öãgrôy
 = 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_öãgrôy
;

302 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REQ
;

303 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

304 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_deföed
 = 
TRUE
;

305 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
cid
 = 1;

307 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
pdn_ty≥
 = 
NET_PDN_TYPE_IPV4V6
;

308 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
≠n
 = 
NULL
;

309 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_emîgícy
 = 
_emm_d©a
.is_emergency;

310 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

312 i‡(
rc
 !
RETURNîr‹
) {

315 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
emm_¥oc_©èch_ªque°
,

316 
emm_¥oc_©èch_Áûuª
,

317 
emm_¥oc_©èch_ªÀa£
, 
NULL
);

318 i‡(
rc
 !
RETURNok
) {

319 
	`LOG_TRACE
(
WARNING
, "FailedÅo initialize EMMÖrocedure handler");

320 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

324 
T3410
.
id
 = 
	`«s_timî_°¨t
(T3410.
£c
, 
_emm_©èch_t3410_h™dÀr
, 
NULL
);

325 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3410 (%d)Éxpires in %ld seconds",

326 
T3410
.
id
, T3410.
£c
);

328 
T3402
.
id
 = 
	`«s_timî_°›
(T3402.id);

329 
T3411
.
id
 = 
	`«s_timî_°›
(T3411.id);

336 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_REQ
;

339 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
 = 
esm_ßp
.
£nd
;

340 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

343 
	`LOG_FUNC_RETURN
(
rc
);

344 
	}
}

362 
	$emm_¥oc_©èch_ªque°
(*
¨gs
)

364 
LOG_FUNC_IN
;

366 
emm_ßp_t
 
emm_ßp
;

367 
rc
;

372 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_REQ
;

373 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

375 
	`LOG_FUNC_RETURN
(
rc
);

376 
	}
}

409 
	$emm_¥oc_©èch_ac˚±
(
t3412
, 
t3402
, 
t3423
,

410 
n_èis
, 
èi_t
 *
èi
, 
GUTI_t
 *
guti
,

411 
n_ïlmns
, 
∂mn_t
 *
ïlmn
,

412 c⁄° 
O˘ëSåög
 *
esm_msg
)

414 
LOG_FUNC_IN
;

416 
emm_ßp_t
 
emm_ßp
;

417 
esm_ßp_t
 
esm_ßp
;

418 
rc
;

419 
i
;

420 
j
;

422 
	`LOG_TRACE
(
INFO
, "EMM-PROC - EPSáttacháccepted byÅheÇetwork");

425 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

426 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

429 
_emm_d©a
.
…ai
.
n_èis
 =Ç_tais;

430 
i
 = 0; (ò< 
n_èis
Ë&& (ò< 
EMM_DATA_TAI_MAX
); i++) {

431 
_emm_d©a
.
…ai
.
èi
[
i
] =Åai[i];

435 
T3412
.
£c
 = 
t3412
;

437 i‡–!(
t3402
 < 0) ) {

438 
T3402
.
£c
 = 
t3402
;

441 i‡–!(
t3423
 < 0) ) {

442 
T3423
.
£c
 = 
t3423
;

446 i‡(
guti
) {

447 *
_emm_d©a
.
guti
 = *guti;

451 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

452 i‡(
n_ïlmns
 > 0) {

453 
i
 = 0; (ò< 
n_ïlmns
Ë&& (ò< 
EMM_DATA_EPLMN_MAX
); i++) {

454 
is_f‹biddí
 = 
FALSE
;

455 i‡(!
_emm_d©a
.
is_emîgícy
) {

459 
j
 = 0; j < 
_emm_d©a
.
Âlmn
.
n_∂mns
; j++) {

460 i‡(
	`PLMNS_ARE_EQUAL
(
ïlmn
[
i
], 
_emm_d©a
.
Âlmn
.
∂mn
[
j
])) {

461 
is_f‹biddí
 = 
TRUE
;

466 i‡–!
is_f‹biddí
 ) {

467 
_emm_d©a
.
nvd©a
.
ïlmn
.
∂mn
[_emm_d©a.nvd©a.ïlmn.
n_∂mns
++] =

468 
ïlmn
[
i
];

472 i‡(
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 < 
EMM_DATA_EPLMN_MAX
) {

473 
_emm_d©a
.
nvd©a
.
ïlmn
.
∂mn
[_emm_d©a.nvd©a.ïlmn.
n_∂mns
++] =

474 
_emm_d©a
.
•lmn
;

481 
esm_ßp
.
¥imôive
 = 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REQ
;

482 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

483 
esm_ßp
.
ªcv
 = 
esm_msg
;

484 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

486 i‡–(
rc
 !
RETURNîr‹
Ë&& (
esm_ßp
.
îr
 =
ESM_SAP_SUCCESS
) ) {

489 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
emm_¥oc_©èch_com∂ëe
,

490 
emm_¥oc_©èch_Áûuª
,

491 
NULL
, NULL);

492 i‡(
rc
 !
RETURNok
) {

493 
	`LOG_TRACE
(
WARNING
,

495 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

502 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_REQ
;

503 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
guti
 = 
_emm_d©a
.guti;

504 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = 0;

506 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
d©a
.
s˘x
,

507 
_emm_d©a
.
£curôy
, 
FALSE
, 
TRUE
);

511 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASöfo
 = 
EMM_AS_NAS_DATA_ATTACH
;

512 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
 = 
esm_ßp
.
£nd
;

513 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

514 } i‡(
esm_ßp
.
îr
 !
ESM_SAP_DISCARDED
) {

521 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_INIT
;

522 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

528 
rc
 = 
RETURNok
;

531 
	`LOG_FUNC_RETURN
(
rc
);

532 
	}
}

555 
	$emm_¥oc_©èch_ªje˘
(
emm_ˇu£
, c⁄° 
O˘ëSåög
 *
esm_msg
)

557 
LOG_FUNC_IN
;

559 
emm_ßp_t
 
emm_ßp
;

560 
rc
;

562 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - EPSáttachÑejected byÅheÇetwork, "

563 "EMM cau£ = %d", 
emm_ˇu£
);

566 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

567 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

571 
emm_ˇu£
) {

572 
EMM_CAUSE_ILLEGAL_UE
:

573 
EMM_CAUSE_ILLEGAL_ME
:

574 
EMM_CAUSE_EPS_NOT_ALLOWED
:

575 
EMM_CAUSE_BOTH_NOT_ALLOWED
:

576 
EMM_CAUSE_PLMN_NOT_ALLOWED
:

577 
EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
:

578 
EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
:

579 
EMM_CAUSE_TA_NOT_ALLOWED
:

580 
EMM_CAUSE_ROAMING_NOT_ALLOWED
:

581 
EMM_CAUSE_NO_SUITABLE_CELLS
:

583 
_emm_d©a
.
°©us
 = 
EU3_ROAMING_NOT_ALLOWED
;

585 
_emm_d©a
.
guti
 = 
NULL
;

587 
_emm_d©a
.
èi
 = 
NULL
;

589 i‡(
_emm_d©a
.
£curôy
) {

590 
_emm_d©a
.
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

599 
emm_ˇu£
) {

600 
EMM_CAUSE_ILLEGAL_UE
:

601 
EMM_CAUSE_ILLEGAL_ME
:

602 
EMM_CAUSE_EPS_NOT_ALLOWED
:

603 
EMM_CAUSE_BOTH_NOT_ALLOWED
:

605 
_emm_d©a
.
usim_is_vÆid
 = 
FALSE
;

607 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

610 
EMM_CAUSE_PLMN_NOT_ALLOWED
:

611 
EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
:

612 
EMM_CAUSE_ROAMING_NOT_ALLOWED
:

614 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

616 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 0;

619 
EMM_CAUSE_TA_NOT_ALLOWED
:

620 
EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
:

621 
EMM_CAUSE_NO_SUITABLE_CELLS
:

623 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 0;

626 
EMM_CAUSE_ESM_FAILURE
:

628 i‡(
_emm_d©a
.
NAS_Sig«ŒögPri‹ôy
 != 1) {

631 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 
EMM_ATTACH_COUNTER_MAX
;

635 
EMM_CAUSE_SEMANTICALLY_INCORRECT
:

636 
EMM_CAUSE_INVALID_MANDATORY_INFO
:

637 
EMM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
:

638 
EMM_CAUSE_IE_NOT_IMPLEMENTED
:

639 
EMM_CAUSE_PROTOCOL_ERROR
:

642 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 
EMM_ATTACH_COUNTER_MAX
;

650 
emm_ˇu£
) {

651 
EMM_CAUSE_PLMN_NOT_ALLOWED
:

652 
EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
:

654 
_emm_d©a
.
Âlmn
.
∂mn
[_emm_d©a.Âlmn.
n_∂mns
++] = _emm_d©a.
•lmn
;

657 
EMM_CAUSE_TA_NOT_ALLOWED
:

660 
_emm_d©a
.
·ai
.
èi
[_emm_d©a.·ai.
n_èis
++] = *_emm_data.tai;

663 
EMM_CAUSE_ROAMING_NOT_ALLOWED
:

666 
_emm_d©a
.
·ai_rﬂmög
.
èi
[_emm_d©a.·ai_rﬂmög.
n_èis
++] = *_emm_data.tai;

669 
EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
:

672 
_emm_d©a
.
Âlmn_g¥s
.
∂mn
[_emm_d©a.Âlmn_g¥s.
n_∂mns
++] = _emm_d©a.
•lmn
;

680 
emm_ˇu£
) {

681 
EMM_CAUSE_ILLEGAL_UE
:

682 
EMM_CAUSE_ILLEGAL_ME
:

683 
EMM_CAUSE_EPS_NOT_ALLOWED
:

684 
EMM_CAUSE_BOTH_NOT_ALLOWED
:

688 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_REJ
;

691 
EMM_CAUSE_PLMN_NOT_ALLOWED
:

692 
EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
:

693 
EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
:

698 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_REQ
;

701 
EMM_CAUSE_TA_NOT_ALLOWED
:

702 
EMM_CAUSE_ROAMING_NOT_ALLOWED
:

703 
EMM_CAUSE_NO_SUITABLE_CELLS
:

709 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_REJ
;

712 
EMM_CAUSE_IMEI_NOT_ACCEPTED
:

713 i‡(
_emm_d©a
.
is_emîgícy
) {

718 
emm_ßp
.
¥imôive
 = 
EMMREG_NO_IMSI
;

726 
	`_emm_©èch_abn‹mÆ_ˇ£s_bcd
(&
emm_ßp
);

730 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

735 i‡(
esm_msg
 !
NULL
) {

736 
esm_ßp_t
 
esm_ßp
;

737 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REJ
;

738 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

739 
esm_ßp
.
ªcv
 = 
esm_msg
;

740 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

743 
	`LOG_FUNC_RETURN
(
rc
);

744 
	}
}

767 
	$emm_¥oc_©èch_com∂ëe
(*
¨gs
)

769 
LOG_FUNC_IN
;

771 
emm_ßp_t
 
emm_ßp
;

772 
esm_ßp_t
 
esm_ßp
;

773 
rc
;

775 
	`LOG_TRACE
(
INFO
, "EMM-PROC - EPSáttach complete");

778 (Ë
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

781 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 0;

785 
_emm_d©a
.
°©us
 = 
EU1_UPDATED
;

786 
_emm_d©a
.
is_©èched
 = 
TRUE
;

792 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_CNF
;

793 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

795 i‡(
rc
 !
RETURNîr‹
) {

801 
esm_ßp
.
¥imôive
 = 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_CNF
;

802 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

803 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

806 
	`LOG_FUNC_RETURN
(
rc
);

807 
	}
}

833 
	$emm_¥oc_©èch_Áûuª
(
is_öôül
, *
¨gs
)

835 
LOG_FUNC_IN
;

837 
rc
 = 
RETURNok
;

838 
esm_ßp_t
 
esm_ßp
;

840 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - EPSáttach failure");

843 (Ë
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

846 i‡(
T3410
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

847 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

848 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

851 i‡(
is_öôül
) {

857 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REJ
;

858 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

859 
esm_ßp
.
ªcv
 = 
NULL
;

866 
esm_ßp
.
¥imôive
 = 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REJ
;

867 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

868 
esm_ßp
.
ªcv
 = 
NULL
;

870 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

872 i‡(
rc
 !
RETURNîr‹
) {

874 
T3411
.
id
 = 
	`«s_timî_°¨t
(T3411.
£c
, 
_emm_©èch_t3411_h™dÀr
, 
NULL
);

875 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3411 (%d)Éxpires in %ld seconds",

876 
T3411
.
id
, T3411.
£c
);

879 
	`LOG_FUNC_RETURN
(
rc
);

880 
	}
}

901 
	$emm_¥oc_©èch_ªÀa£
(*
¨gs
)

903 
LOG_FUNC_IN
;

905 
emm_ßp_t
 
emm_ßp
;

906 
rc
;

908 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - NAS signalling connectionÑeleased");

911 
	`_emm_©èch_abn‹mÆ_ˇ£s_bcd
(&
emm_ßp
);

913 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

915 
	`LOG_FUNC_RETURN
(
rc
);

916 
	}
}

932 
	$emm_¥oc_©èch_ª°¨t
()

934 
LOG_FUNC_IN
;

936 
emm_ßp_t
 
emm_ßp
;

937 
rc
;

939 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Restart EPSáttachÖrocedure");

944 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_INIT
;

945 
emm_ßp
.
u
.
emm_ªg
.u.
©èch
.
is_emîgícy
 = 
_emm_d©a
.is_emergency;

946 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

948 
	`LOG_FUNC_RETURN
(
rc
);

949 
	}
}

965 
	$emm_¥oc_©èch_£t_emîgícy
()

967 
LOG_FUNC_IN
;

969 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - UE isÇowáttachedÅoÅheÇetwork for "

972 
_emm_d©a
.
is_emîgícy
 = 
TRUE
;

974 
	`LOG_FUNC_RETURN
(
RETURNok
);

975 
	}
}

992 
	$emm_¥oc_©èch_£t_dëach
()

994 
LOG_FUNC_IN
;

996 
rc
;

998 
	`LOG_TRACE
(
WARNING
,

1002 
_emm_d©a
.
is_©èched
 = 
FALSE
;

1006 
emm_ßp_t
 
emm_ßp
;

1007 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_CNF
;

1008 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1010 
	`LOG_FUNC_RETURN
(
rc
);

1011 
	}
}

1020 #ifde‡
NAS_MME


1055 
	$emm_¥oc_©èch_ªque°
(
ueid
, 
emm_¥oc_©èch_ty≥_t
 
ty≥
,

1056 
«tive_ksi
, 
ksi
, 
«tive_guti
,

1057 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
,

1058 
èi_t
 *
èi
,

1059 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

1060 
umts_¥e£¡
, 
g¥s_¥e£¡
,

1061 c⁄° 
O˘ëSåög
 *
esm_msg
)

1063 
LOG_FUNC_IN
;

1065 
rc
;

1066 
emm_d©a_c⁄ãxt_t
 
ue_˘x
;

1068 
	`LOG_TRACE
(
INFO
, "EMM-PROC - EPSáttachÅype = %s (%d)Ñequested (ueid=0x%08x)",

1069 
_emm_©èch_ty≥_°r
[
ty≥
],Åy≥, 
ueid
);

1070 
	`LOG_TRACE
(
INFO
, "EMM-PROC - umts_present = %u umts_present = %u",

1071 
umts_¥e£¡
, 
g¥s_¥e£¡
);

1074 
	`mem£t
(&
ue_˘x
, 0 , (
emm_d©a_c⁄ãxt_t
));

1075 
ue_˘x
.
is_dy«mic
 = 
FALSE
;

1076 
ue_˘x
.
ueid
 = ueid;

1078 #i‡!
	`deföed
(
EPC_BUILD
)

1080 i‡(
ueid
 >
EMM_DATA_NB_UE_MAX
) {

1081 
ue_˘x
.
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1083 
rc
 = 
	`_emm_©èch_ªje˘
(&
ue_˘x
);

1084 
	`LOG_FUNC_RETURN
(
rc
);

1093 i‡–!(
_emm_d©a
.
c⁄f
.
„©uªs
 & 
MME_API_EMERGENCY_ATTACH
) &&

1094 (
ty≥
 =
EMM_ATTACH_TYPE_EMERGENCY
) ) {

1095 
ue_˘x
.
emm_ˇu£
 = 
EMM_CAUSE_IMEI_NOT_ACCEPTED
;

1097 
rc
 = 
	`_emm_©èch_ªje˘
(&
ue_˘x
);

1098 
	`LOG_FUNC_RETURN
(
rc
);

1102 
emm_d©a_c⁄ãxt_t
 **
emm_˘x
 = 
NULL
;

1104 #i‡
	`deföed
(
EPC_BUILD
)

1105 
emm_d©a_c⁄ãxt_t
 *
ãmp
 = 
NULL
;

1107 
ãmp
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

1108 
emm_˘x
 = &
ãmp
;

1110 
emm_˘x
 = &
_emm_d©a
.
˘x
[
ueid
];

1113 i‡(*
emm_˘x
 !
NULL
) {

1115 i‡(
	`_emm_©èch_have_ch™ged
(*
emm_˘x
, 
ty≥
, 
ksi
, 
guti
, 
imsi
, 
imei
,

1116 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
, 
umts_¥e£¡
, 
g¥s_¥e£¡
)) {

1124 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - AttachÖarameters have changed");

1128 
emm_ßp_t
 
emm_ßp
;

1129 
emm_ßp
.
¥imôive
 = 
EMMREG_PROC_ABORT
;

1130 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1131 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = *
emm_˘x
;

1133 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1135 i‡(
rc
 !
RETURNîr‹
) {

1137 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - InitiateÇewáttachÖrocedure");

1138 
rc
 = 
	`emm_¥oc_©èch_ªque°
(
ueid
, 
ty≥
, 
«tive_ksi
, 
ksi
,

1139 
«tive_guti
, 
guti
, 
imsi
, 
imei
,

1140 
èi
, 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

1141 
umts_¥e£¡
, 
g¥s_¥e£¡
, 
esm_msg
);

1143 
	`LOG_FUNC_RETURN
(
rc
);

1146 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Received duplicated Attach Request");

1147 
	`LOG_FUNC_RETURN
(
RETURNok
);

1151 *
emm_˘x
 = (
emm_d©a_c⁄ãxt_t
 *)
	`ˇŒoc
(1, (emm_data_context_t));

1152 i‡(
emm_˘x
 =
NULL
) {

1153 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅo create EMM context");

1154 
ue_˘x
.
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1156 
rc
 = 
	`_emm_©èch_ªje˘
(&
ue_˘x
);

1157 
	`LOG_FUNC_RETURN
(
rc
);

1159 (*
emm_˘x
)->
is_dy«mic
 = 
TRUE
;

1160 (*
emm_˘x
)->
guti
 = 
NULL
;

1161 (*
emm_˘x
)->
ﬁd_guti
 = 
NULL
;

1162 (*
emm_˘x
)->
imsi
 = 
NULL
;

1163 (*
emm_˘x
)->
imei
 = 
NULL
;

1164 (*
emm_˘x
)->
£curôy
 = 
NULL
;

1165 (*
emm_˘x
)->
esm_msg
.
Àngth
 = 0;

1166 (*
emm_˘x
)->
esm_msg
.
vÆue
 = 
NULL
;

1167 (*
emm_˘x
)->
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

1168 (*
emm_˘x
)->
_emm_fsm_°©us
 = 
EMM_INVALID
;

1169 (*
emm_˘x
)->
ueid
 = ueid;

1171 
	`emm_fsm_£t_°©us
(
ueid
, *
emm_˘x
, 
EMM_DEREGISTERED
);

1172 #i‡
	`deföed
(
EPC_BUILD
)

1173 
	`emm_d©a_c⁄ãxt_add
(&
_emm_d©a
, *(
emm_˘x
));

1177 i‡(
èi
){

1178 
	`LOG_TRACE
(
WARNING
,

1180 
èi
->
èc
);

1181 (*
emm_˘x
)->
èc
 = 
èi
->tac;

1183 
	`LOG_TRACE
(
WARNING
,

1189 
rc
 = 
	`_emm_©èch_upd©e
(*
emm_˘x
, 
ueid
, 
ty≥
, 
ksi
, 
guti
, 
imsi
, 
imei
,

1190 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
, 
umts_¥e£¡
, 
g¥s_¥e£¡
, 
esm_msg
);

1191 i‡(
rc
 !
RETURNok
) {

1192 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅo update EMM context");

1194 (*
emm_˘x
)->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1195 
rc
 = 
	`_emm_©èch_ªje˘
(*
emm_˘x
);

1200 
rc
 = 
	`_emm_©èch_idítify
(*
emm_˘x
);

1203 
	`LOG_FUNC_RETURN
(
rc
);

1204 
	}
}

1225 
	$emm_¥oc_©èch_ªje˘
(
ueid
, 
emm_ˇu£
)

1227 
LOG_FUNC_IN
;

1229 
rc
;

1232 
emm_d©a_c⁄ãxt_t
 
ue_˘x
;

1233 
	`mem£t
(&
ue_˘x
, 0 , (
emm_d©a_c⁄ãxt_t
));

1234 
ue_˘x
.
is_dy«mic
 = 
FALSE
;

1235 
ue_˘x
.
ueid
 = ueid;

1238 #i‡
	`deföed
(
EPC_BUILD
)

1239 i‡(
ueid
 > 0)

1241 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
)

1244 
ue_˘x
.
emm_ˇu£
 =Émm_cause;

1246 
ue_˘x
.
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1250 
rc
 = 
	`_emm_©èch_ªje˘
(&
ue_˘x
);

1252 
	`LOG_FUNC_RETURN
(
rc
);

1253 
	}
}

1277 
	$emm_¥oc_©èch_com∂ëe
(
ueid
, c⁄° 
O˘ëSåög
 *
esm_msg
)

1279 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

1280 
rc
 = 
RETURNîr‹
;

1281 
emm_ßp_t
 
emm_ßp
;

1282 
esm_ßp_t
 
esm_ßp
;

1284 
LOG_FUNC_IN
;

1286 
	`LOG_TRACE
(
INFO
, "EMM-PROC - EPSáâach com∂ëê(ueid=%u)", 
ueid
);

1289 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3450 (%d)", 
T3450
.
id
);

1290 
T3450
.
id
 = 
	`«s_timî_°›
(T3450.id);

1293 
©èch_d©a_t
 *
d©a
 = (©èch_d©a_à*)(
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
));

1294 i‡(
d©a
) {

1295 i‡(
d©a
->
esm_msg
.
Àngth
 > 0) {

1296 
	`‰ì
(
d©a
->
esm_msg
.
vÆue
);

1298 
	`‰ì
(
d©a
);

1303 #i‡
	`deföed
(
EPC_BUILD
)

1304 i‡(
ueid
 > 0) {

1305 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

1308 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1309 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

1313 i‡(
emm_˘x
) {

1316 
emm_˘x
->
guti_is_√w
 = 
FALSE
;

1317 
emm_˘x
->
ﬁd_guti
 = 
NULL
;

1322 
esm_ßp
.
¥imôive
 = 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_CNF
;

1323 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

1324 
esm_ßp
.
ueid
 = ueid;

1325 
esm_ßp
.
ªcv
 = 
esm_msg
;

1326 
esm_ßp
.
˘x
 = 
emm_˘x
;

1327 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

1329 
	`LOG_TRACE
(
ERROR
, "EMM-PROC - No EMM contextÉxists");

1332 i‡–(
rc
 !
RETURNîr‹
Ë&& (
esm_ßp
.
îr
 =
ESM_SAP_SUCCESS
) ) {

1334 
emm_˘x
->
is_©èched
 = 
TRUE
;

1338 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_CNF
;

1339 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1340 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

1341 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1342 } i‡(
esm_ßp
.
îr
 !
ESM_SAP_DISCARDED
) {

1346 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_REJ
;

1347 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1348 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

1349 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1355 
rc
 = 
RETURNok
;

1358 
	`LOG_FUNC_RETURN
(
rc
);

1359 
	}
}

1367 #ifde‡
NAS_UE


1394 *
	$_emm_©èch_t3410_h™dÀr
(*
¨gs
)

1396 
LOG_FUNC_IN
;

1398 
emm_ßp_t
 
emm_ßp
;

1399 
rc
;

1401 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3410ÅimerÉxpired");

1404 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

1406 
	`_emm_©èch_abn‹mÆ_ˇ£s_bcd
(&
emm_ßp
);

1408 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1409 i‡(
rc
 !
RETURNîr‹
) {

1411 
_emm_d©a
.
ecm_°©us
 = 
ECM_IDLE
;

1414 
	`LOG_FUNC_RETURN
(
NULL
);

1415 
	}
}

1435 *
	$_emm_©èch_t3411_h™dÀr
(*
¨gs
)

1437 
LOG_FUNC_IN
;

1439 
emm_ßp_t
 
emm_ßp
;

1441 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3411ÅimerÉxpired");

1444 
T3411
.
id
 = 
	`«s_timî_°›
(T3411.id);

1449 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_INIT
;

1450 
emm_ßp
.
u
.
emm_ªg
.u.
©èch
.
is_emîgícy
 = 
_emm_d©a
.is_emergency;

1452 (Ë
	`emm_ßp_£nd
(&
emm_ßp
);

1454 
	`LOG_FUNC_RETURN
(
NULL
);

1455 
	}
}

1479 *
	$_emm_©èch_t3402_h™dÀr
(*
¨gs
)

1481 
LOG_FUNC_IN
;

1483 
emm_ßp_t
 
emm_ßp
;

1485 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3402ÅimerÉxpired");

1488 
T3402
.
id
 = 
	`«s_timî_°›
(T3402.id);

1490 
_emm_©èch_d©a
.
©ãm±_cou¡
 = 0;

1495 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_INIT
;

1496 
emm_ßp
.
u
.
emm_ªg
.u.
©èch
.
is_emîgícy
 = 
_emm_d©a
.is_emergency;

1498 (Ë
	`emm_ßp_£nd
(&
emm_ßp
);

1500 
	`LOG_FUNC_RETURN
(
NULL
);

1501 
	}
}

1530 
	$_emm_©èch_abn‹mÆ_ˇ£s_bcd
(
emm_ßp_t
 *
emm_ßp
)

1532 
LOG_FUNC_IN
;

1534 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Abnormal case,áttach counter = %d",

1535 
_emm_©èch_d©a
.
©ãm±_cou¡
);

1538 i‡(
T3410
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1539 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

1540 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

1543 i‡(
_emm_©èch_d©a
.
©ãm±_cou¡
 < 
EMM_ATTACH_COUNTER_MAX
) {

1545 
_emm_©èch_d©a
.
©ãm±_cou¡
 += 1;

1547 
T3411
.
id
 = 
	`«s_timî_°¨t
(T3411.
£c
, 
_emm_©èch_t3411_h™dÀr
, 
NULL
);

1548 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3411 (%d)Éxpires in %ld seconds",

1549 
T3411
.
id
, T3411.
£c
);

1555 
emm_ßp
->
¥imôive
 = 
EMMREG_ATTACH_FAILED
;

1558 
_emm_d©a
.
guti
 = 
NULL
;

1560 
_emm_d©a
.
…ai
.
n_èis
 = 0;

1562 
_emm_d©a
.
èi
 = 
NULL
;

1564 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

1566 i‡(
_emm_d©a
.
£curôy
) {

1567 
_emm_d©a
.
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

1570 
_emm_d©a
.
°©us
 = 
EU2_NOT_UPDATED
;

1573 
T3402
.
id
 = 
	`«s_timî_°¨t
(T3402.
£c
, 
_emm_©èch_t3402_h™dÀr
, 
NULL
);

1574 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3402 (%d)Éxpires in %ld seconds",

1575 
T3402
.
id
, T3402.
£c
);

1580 
emm_ßp
->
¥imôive
 = 
EMMREG_ATTACH_EXCEEDED
;

1583 
LOG_FUNC_OUT
;

1584 
	}
}

1587 #ifde‡
NAS_MME


1616 *
	$_emm_©èch_t3450_h™dÀr
(*
¨gs
)

1618 
LOG_FUNC_IN
;

1620 
rc
;

1622 
©èch_d©a_t
 *
d©a
 = (©èch_d©a_à*)(
¨gs
);

1625 
d©a
->
ªå™smissi⁄_cou¡
 += 1;

1627 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3450ÅimerÉxpired,Ñetransmission "

1628 "cou¡î = %d", 
d©a
->
ªå™smissi⁄_cou¡
);

1631 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

1633 #i‡
	`deföed
(
EPC_BUILD
)

1634 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
d©a
->
ueid
);

1636 
emm_˘x
 = 
_emm_d©a
.
˘x
[
d©a
->
ueid
];

1639 i‡(
d©a
->
ªå™smissi⁄_cou¡
 < 
ATTACH_COUNTER_MAX
) {

1641 
rc
 = 
	`_emm_©èch_ac˚±
(
emm_˘x
, 
d©a
);

1644 
rc
 = 
	`_emm_©èch_ab‹t
(
d©a
);

1647 
	`LOG_FUNC_RETURN
(
NULL
);

1648 
	}
}

1670 
	$_emm_©èch_ªÀa£
(*
¨gs
)

1672 
LOG_FUNC_IN
;

1674 
rc
 = 
RETURNîr‹
;

1676 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

1678 i‡(
emm_˘x
) {

1679 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Release UE context data (ueid=%u)",

1680 
emm_˘x
->
ueid
);

1682 
ueid
 = 
emm_˘x
->ueid;

1684 i‡(
emm_˘x
->
guti
) {

1685 
	`‰ì
(
emm_˘x
->
guti
);

1686 
emm_˘x
->
guti
 = 
NULL
;

1688 i‡(
emm_˘x
->
imsi
) {

1689 
	`‰ì
(
emm_˘x
->
imsi
);

1690 
emm_˘x
->
imsi
 = 
NULL
;

1692 i‡(
emm_˘x
->
imei
) {

1693 
	`‰ì
(
emm_˘x
->
imei
);

1694 
emm_˘x
->
imei
 = 
NULL
;

1696 i‡(
emm_˘x
->
esm_msg
.
Àngth
 > 0) {

1697 
	`‰ì
(
emm_˘x
->
esm_msg
.
vÆue
);

1698 
emm_˘x
->
esm_msg
.
vÆue
 = 
NULL
;

1701 i‡(
emm_˘x
->
£curôy
) {

1702 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
emm_˘x
->security;

1703 i‡(
£curôy
->
kasme
.
vÆue
) {

1704 
	`‰ì
(
£curôy
->
kasme
.
vÆue
);

1705 
£curôy
->
kasme
.
vÆue
 = 
NULL
;

1706 
£curôy
->
kasme
.
Àngth
 = 0;

1708 i‡(
£curôy
->
k«s_íc
.
vÆue
) {

1709 
	`‰ì
(
£curôy
->
k«s_íc
.
vÆue
);

1710 
£curôy
->
k«s_íc
.
vÆue
 = 
NULL
;

1711 
£curôy
->
k«s_íc
.
Àngth
 = 0;

1713 i‡(
£curôy
->
k«s_öt
.
vÆue
) {

1714 
	`‰ì
(
£curôy
->
k«s_öt
.
vÆue
);

1715 
£curôy
->
k«s_öt
.
vÆue
 = 
NULL
;

1716 
£curôy
->
k«s_öt
.
Àngth
 = 0;

1718 
	`‰ì
(
emm_˘x
->
£curôy
);

1719 
emm_˘x
->
£curôy
 = 
NULL
;

1722 #i‡
	`deföed
(
EPC_BUILD
)

1723 
	`emm_d©a_c⁄ãxt_ªmove
(&
_emm_d©a
, 
emm_˘x
);

1725 
	`‰ì
(
_emm_d©a
.
˘x
[
ueid
]);

1726 
_emm_d©a
.
˘x
[
ueid
] = 
NULL
;

1731 
emm_ßp_t
 
emm_ßp
;

1732 
emm_ßp
.
¥imôive
 = 
EMMREG_PROC_ABORT
;

1733 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1734 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

1735 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1738 
	`LOG_FUNC_RETURN
(
rc
);

1739 
	}
}

1760 
	$_emm_©èch_ªje˘
(*
¨gs
)

1762 
LOG_FUNC_IN
;

1764 
rc
 = 
RETURNîr‹
;

1766 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

1768 i‡(
emm_˘x
) {

1769 
emm_ßp_t
 
emm_ßp
;

1770 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - EMMáttachÖrocedureÇotáccepted "

1772 
emm_˘x
->
ueid
,Émm_˘x->
emm_ˇu£
);

1777 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_REJ
;

1778 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
ueid
 = 
emm_˘x
->ueid;

1779 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
UEid
.
guti
 = 
NULL
;

1780 i‡(
emm_˘x
->
emm_ˇu£
 =
EMM_CAUSE_SUCCESS
) {

1781 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1783 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
emm_ˇu£
 = 
emm_˘x
->emm_cause;

1784 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASöfo
 = 
EMM_AS_NAS_INFO_ATTACH
;

1785 i‡(
emm_˘x
->
emm_ˇu£
 !
EMM_CAUSE_ESM_FAILURE
) {

1786 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
Àngth
 = 0;

1787 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
vÆue
 = 
NULL
;

1788 } i‡(
emm_˘x
->
esm_msg
.
Àngth
 > 0) {

1789 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
 = 
emm_˘x
->
esm_msg
;

1791 
	`LOG_TRACE
(
ERROR
, "EMM-PROC - ESM message is missing");

1792 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1795 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
s˘x
,

1796 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

1797 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1801 i‡(
emm_˘x
->
is_dy«mic
) {

1802 
rc
 = 
	`_emm_©èch_ªÀa£
(
emm_˘x
);

1806 
	`LOG_FUNC_RETURN
(
rc
);

1807 
	}
}

1823 
	$_emm_©èch_ab‹t
(*
¨gs
)

1825 
rc
 = 
RETURNîr‹
;

1826 
emm_d©a_c⁄ãxt_t
 *
˘x
 = 
NULL
;

1827 
©èch_d©a_t
 *
d©a
;

1829 
LOG_FUNC_IN
;

1831 
d©a
 = (
©èch_d©a_t
 *)(
¨gs
);

1833 i‡(
d©a
) {

1834 
ueid
 = 
d©a
->ueid;

1835 
esm_ßp_t
 
esm_ßp
;

1837 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - AbortÅheáttachÖrocedure (ueid=%u)",

1838 
ueid
);

1841 i‡(
T3450
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1842 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3450 (%d)", 
T3450
.
id
);

1843 
T3450
.
id
 = 
	`«s_timî_°›
(T3450.id);

1846 i‡(
d©a
->
esm_msg
.
Àngth
 > 0) {

1847 
	`‰ì
(
d©a
->
esm_msg
.
vÆue
);

1849 
	`‰ì
(
d©a
);

1851 #i‡
	`deföed
(
EPC_BUILD
)

1852 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

1854 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

1861 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REJ
;

1862 
esm_ßp
.
ueid
 = ueid;

1863 
esm_ßp
.
˘x
 = ctx;

1864 
esm_ßp
.
ªcv
 = 
NULL
;

1865 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

1867 i‡(
rc
 !
RETURNîr‹
) {

1871 
emm_ßp_t
 
emm_ßp
;

1872 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_REJ
;

1873 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1874 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = ctx;

1875 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1876 i‡(
rc
 !
RETURNîr‹
) {

1878 
rc
 = 
	`_emm_©èch_ªÀa£
(
˘x
);

1883 
	`LOG_FUNC_RETURN
 (
rc
);

1884 
	}
}

1908 
	$_emm_©èch_idítify
(*
¨gs
)

1910 
rc
 = 
RETURNîr‹
;

1911 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

1912 
guti_ªÆloˇti⁄
 = 
FALSE
;

1914 
LOG_FUNC_IN
;

1916 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Identify incoming UE (ueid=0x%08x) using %s",

1917 
emm_˘x
->
ueid
, (emm_˘x->
imsi
)? "IMSI" : (emm_˘x->
guti
)? "GUTI" :

1918 (
emm_˘x
->
imei
)? "IMEI" : "none");

1924 i‡(
emm_˘x
->
imsi
) {

1926 #i‡
	`deföed
(
EPC_BUILD
)

1927 i‡(!
emm_˘x
->
£curôy
) {

1929 
	`«s_ôti_auth_öfo_ªq
(
emm_˘x
->
ueid
,Émm_˘x->
imsi
, 1, 
NULL
);

1931 
rc
 = 
RETURNok
;

1935 
rc
 = 
	`mme_≠i_idítify_imsi
(
emm_˘x
->
imsi
, &emm_˘x->
ve˘‹
);

1936 i‡(
rc
 !
RETURNok
) {

1937 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

1939 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1941 
guti_ªÆloˇti⁄
 = 
TRUE
;

1943 } i‡(
emm_˘x
->
guti
) {

1945 
rc
 = 
	`mme_≠i_idítify_guti
(
emm_˘x
->
guti
, &emm_˘x->
ve˘‹
);

1946 i‡(
rc
 !
RETURNok
) {

1947 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅo identifyÅhe UE using "

1948 "¥ovided GUTI (tmsi=%u)", 
emm_˘x
->
guti
->
m_tmsi
);

1954 
rc
 = 
	`emm_¥oc_idítifiˇti⁄
(
emm_˘x
->
ueid
,

1955 
emm_˘x
,

1956 
EMM_IDENT_TYPE_IMSI
,

1957 
_emm_©èch_idítify
,

1958 
_emm_©èch_ªÀa£
,

1959 
_emm_©èch_ªÀa£
);

1960 i‡(
rc
 !
RETURNok
) {

1962 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

1964 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1966 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

1970 
	`LOG_FUNC_RETURN
(
rc
);

1972 } i‡–(
emm_˘x
->
imei
Ë&& (emm_˘x->
is_emîgícy
) ) {

1975 
rc
 = 
	`mme_≠i_idítify_imei
(
emm_˘x
->
imei
, &emm_˘x->
ve˘‹
);

1976 i‡(
rc
 !
RETURNok
) {

1977 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

1979 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_IMEI_NOT_ACCEPTED
;

1982 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - UE's identity isÇotávailable");

1983 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

1990 i‡–(
rc
 !
RETURNîr‹
Ë&& 
guti_ªÆloˇti⁄
 ) {

1992 i‡(
emm_˘x
->
ﬁd_guti
) {

1993 
	`‰ì
(
emm_˘x
->
ﬁd_guti
);

1996 
emm_˘x
->
ﬁd_guti
 =Émm_˘x->
guti
;

1998 
emm_˘x
->
guti
 = (
GUTI_t
 *)
	`mÆloc
((GUTI_t));

2000 
rc
 = 
	`mme_≠i_√w_guti
(
emm_˘x
->
imsi
,Émm_˘x->
guti
,

2001 &
emm_˘x
->
èc
, &emm_˘x->
n_ècs
);

2002 i‡(
rc
 !
RETURNok
) {

2003 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoássignÇew GUTI");

2004 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

2006 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - New GUTIássignedÅoÅhe UE "

2007 "—msi=%u)", 
emm_˘x
->
guti
->
m_tmsi
);

2009 
emm_˘x
->
guti_is_√w
 = 
TRUE
;

2017 i‡(
rc
 !
RETURNîr‹
) {

2018 i‡(
emm_˘x
->
£curôy
) {

2022 
rc
 = 
	`_emm_©èch
(
emm_˘x
);

2023 } i‡–(
emm_˘x
->
is_emîgícy
) &&

2024 (
_emm_d©a
.
c⁄f
.
„©uªs
 & 
MME_API_UNAUTHENTICATED_IMSI
) ) {

2032 
rc
 = 
	`_emm_©èch_£curôy
(
emm_˘x
);

2034 #i‡!
	`deföed
(
EPC_BUILD
)

2041 
auth_ve˘‹_t
 *
auth
 = &
emm_˘x
->
ve˘‹
;

2042 c⁄° 
O˘ëSåög
 
loc_ønd
 = {
AUTH_RAND_SIZE
, (
uöt8_t
 *)
auth
->
ønd
};

2043 c⁄° 
O˘ëSåög
 
auä
 = {
AUTH_AUTN_SIZE
, (
uöt8_t
 *)
auth
->autn};

2044 
rc
 = 
	`emm_¥oc_authítiˇti⁄
(
emm_˘x
,Émm_˘x->
ueid
, 0,

2045 &
loc_ønd
, &
auä
,

2046 
_emm_©èch_£curôy
,

2047 
_emm_©èch_ªÀa£
,

2048 
_emm_©èch_ªÀa£
);

2049 i‡(
rc
 !
RETURNok
) {

2051 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

2053 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

2059 i‡(
rc
 !
RETURNok
) {

2061 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

2063 
	`LOG_FUNC_RETURN
 (
rc
);

2064 
	}
}

2080 #i‡
deföed
(
EPC_BUILD
)

2081 
	$emm_©èch_£curôy
(*
¨gs
)

2083  
	`_emm_©èch_£curôy
(
¨gs
);

2084 
	}
}

2087 
	$_emm_©èch_£curôy
(*
¨gs
)

2089 
LOG_FUNC_IN
;

2091 
rc
;

2092 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

2094 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Sëu∞NAS securôy (ueid=%u)", 
emm_˘x
->
ueid
);

2097 i‡(
emm_˘x
->
£curôy
 =
NULL
) {

2098 
emm_˘x
->
£curôy
 =

2099 (
emm_£curôy_c⁄ãxt_t
 *)
	`mÆloc
((emm_security_context_t));

2101 i‡(
emm_˘x
->
£curôy
) {

2102 
	`mem£t
(
emm_˘x
->
£curôy
, 0, (
emm_£curôy_c⁄ãxt_t
));

2103 
emm_˘x
->
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

2104 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
 = 
NAS_SECURITY_ALGORITHMS_EEA0
;

2105 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
 = 
NAS_SECURITY_ALGORITHMS_EIA0
;

2107 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅo create security context");

2108 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

2110 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

2111 
	`LOG_FUNC_RETURN
(
rc
);

2115 
rc
 = 
	`emm_¥oc_£curôy_mode_c⁄åﬁ
(
emm_˘x
->
ueid
, 0,

2116 
emm_˘x
->
ìa
,Émm_˘x->
eü
,emm_˘x->
ucs2
,

2117 
emm_˘x
->
uó
,Émm_˘x->
uü
,Émm_˘x->
gó
,

2118 
emm_˘x
->
umts_¥e£¡
,Émm_˘x->
g¥s_¥e£¡
,

2119 
_emm_©èch
, 
_emm_©èch_ªÀa£
,

2120 
_emm_©èch_ªÀa£
);

2121 i‡(
rc
 !
RETURNok
) {

2123 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

2125 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

2127 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

2130 
	`LOG_FUNC_RETURN
 (
rc
);

2131 
	}
}

2159 
	$_emm_©èch
(*
¨gs
)

2161 
LOG_FUNC_IN
;

2163 
esm_ßp_t
 
esm_ßp
;

2164 
rc
;

2166 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

2168 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Aâach UE (ueid=%u)", 
emm_˘x
->
ueid
);

2179 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REQ
;

2180 
esm_ßp
.
is_°™dÆ⁄e
 = 
FALSE
;

2181 
esm_ßp
.
ueid
 = 
emm_˘x
->ueid;

2182 
esm_ßp
.
˘x
 = 
emm_˘x
;

2183 
esm_ßp
.
ªcv
 = &
emm_˘x
->
esm_msg
;

2184 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

2186 i‡–(
rc
 !
RETURNîr‹
Ë&& (
esm_ßp
.
îr
 =
ESM_SAP_SUCCESS
) ) {

2196 
©èch_d©a_t
 *
d©a
 = (©èch_d©a_à*)
	`ˇŒoc
(1,(attach_data_t));

2198 i‡(
d©a
 !
NULL
) {

2200 
rc
 = 
	`emm_¥oc_comm⁄_öôülize
(
emm_˘x
->
ueid
, 
NULL
, NULL, NULL,

2201 
_emm_©èch_ab‹t
, 
d©a
);

2202 i‡(
rc
 !
RETURNok
) {

2203 
	`LOG_TRACE
(
WARNING
,

2205 
	`‰ì
(
d©a
);

2206 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2209 
d©a
->
ueid
 = 
emm_˘x
->ueid;

2211 
d©a
->
ªå™smissi⁄_cou¡
 = 0;

2212 #i‡
	`deföed
(
ORIGINAL_CODE
)

2214 
d©a
->
esm_msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(
esm_ßp
.
£nd
.
Àngth
);

2215 i‡(
d©a
->
esm_msg
.
vÆue
) {

2216 
d©a
->
esm_msg
.
Àngth
 = 
esm_ßp
.
£nd
.length;

2217 
	`mem˝y
(
d©a
->
esm_msg
.
vÆue
, 
esm_ßp
.
£nd
.value,

2218 
esm_ßp
.
£nd
.
Àngth
);

2220 
d©a
->
esm_msg
.
Àngth
 = 0;

2223 
rc
 = 
	`_emm_©èch_ac˚±
(
emm_˘x
, 
d©a
);

2224 i‡(
rc
 !
RETURNîr‹
) {

2225 i‡(
emm_˘x
->
guti_is_√w
 &&Émm_˘x->
ﬁd_guti
) {

2229 
emm_ßp_t
 
emm_ßp
;

2230 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REQ
;

2231 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = 
d©a
->ueid;

2232 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

2236 
rc
 = 
RETURNok
;

2239 } i‡(
esm_ßp
.
îr
 !
ESM_SAP_DISCARDED
) {

2243 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ESM_FAILURE
;

2246 i‡(
emm_˘x
->
esm_msg
.
Àngth
 > 0) {

2247 
	`‰ì
(
emm_˘x
->
esm_msg
.
vÆue
);

2249 
emm_˘x
->
esm_msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(
esm_ßp
.
£nd
.
Àngth
);

2250 i‡(
emm_˘x
->
esm_msg
.
vÆue
) {

2251 
emm_˘x
->
esm_msg
.
Àngth
 = 
esm_ßp
.
£nd
.length;

2252 
	`mem˝y
(
emm_˘x
->
esm_msg
.
vÆue
, 
esm_ßp
.
£nd
.value,

2253 
esm_ßp
.
£nd
.
Àngth
);

2255 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

2257 
emm_˘x
->
esm_msg
.
Àngth
 = 0;

2264 
rc
 = 
RETURNok
;

2267 i‡(
rc
 !
RETURNok
) {

2269 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoÑespondÅo Attach Request");

2270 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

2272 
rc
 = 
	`_emm_©èch_ªje˘
(
emm_˘x
);

2275 
	`LOG_FUNC_RETURN
 (
rc
);

2276 
	}
}

2278 
	$emm_˙_wøµî_©èch_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
emm_˘x
, *
d©a
)

2280  
	`_emm_©èch_ac˚±
(
emm_˘x
,(
©èch_d©a_t
 *)
d©a
);

2281 
	}
}

2296 
	$_emm_©èch_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
emm_˘x
, 
©èch_d©a_t
 *
d©a
)

2298 
LOG_FUNC_IN
;

2300 
emm_ßp_t
 
emm_ßp
;

2301 
rc
;

2308 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_CNF
;

2309 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
ueid
 = 
emm_˘x
->ueid;

2310 i‡(
emm_˘x
->
guti_is_√w
 &&Émm_˘x->
ﬁd_guti
) {

2313 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Implicit GUTIÑeallocation, includeÅheÇewássigned GUTI inÅhe Attach Accept message");

2314 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
UEid
.
guti
 = 
emm_˘x
->
ﬁd_guti
;

2315 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
√w_guti
 = 
emm_˘x
->
guti
;

2316 } i‡(
emm_˘x
->
guti_is_√w
 &&Émm_˘x->
guti
) {

2318 
	`LOG_TRACE
(
INFO
,"EMM-PROC - IncludeÅheÇewássigned GUTI inÅhe Attach Accept message");

2319 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
UEid
.
guti
 = 
emm_˘x
->guti;

2320 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
√w_guti
 = 
emm_˘x
->
guti
;

2322 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
UEid
.
guti
 = 
emm_˘x
->guti;

2324 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
√w_guti
 = 
emm_˘x
->
guti
;

2327 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
n_ècs
 = 
emm_˘x
->n_tacs;

2328 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
èc
 = 
emm_˘x
->tac;

2329 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASöfo
 = 
EMM_AS_NAS_INFO_ATTACH
;

2331 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
s˘x
,

2332 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

2334 
	`LOG_TRACE
(
INFO
,"EMM-PROC -Én¸y±i⁄ = 0x%X ", 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
í¸y±i⁄
);

2335 
	`LOG_TRACE
(
INFO
,"EMM-PROC - i¡egrôy = 0x%X ", 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
öãgrôy
);

2336 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
í¸y±i⁄
 = 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.encryption;

2337 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
öãgrôy
 = 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.integrity;

2338 
	`LOG_TRACE
(
INFO
,"EMM-PROC -Éncryption = 0x%X (0x%X)",

2339 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
í¸y±i⁄
,

2340 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
);

2341 
	`LOG_TRACE
(
INFO
,"EMM-PROC - integrity = 0x%X (0x%X)",

2342 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
öãgrôy
,

2343 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
);

2347 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
 = 
d©a
->
esm_msg
;

2348 
	`LOG_TRACE
(
INFO
,"EMM-PROC - NASmsg src size = %d NASmsg dst size = %d ",

2349 
d©a
->
esm_msg
.
Àngth
, 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.length);

2351 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

2353 i‡(
rc
 !
RETURNîr‹
) {

2354 i‡(
T3450
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

2356 
T3450
.
id
 = 
	`«s_timî_ª°¨t
(T3450.id);

2359 
T3450
.
id
 = 
	`«s_timî_°¨t
(T3450.
£c
, 
_emm_©èch_t3450_h™dÀr
, 
d©a
);

2361 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3450 (%d)Éxpires in %ld seconds",

2362 
T3450
.
id
, T3450.
£c
);

2365 
	`LOG_FUNC_RETURN
 (
rc
);

2366 
	}
}

2392 
	$_emm_©èch_have_ch™ged
(c⁄° 
emm_d©a_c⁄ãxt_t
 *
˘x
,

2393 
emm_¥oc_©èch_ty≥_t
 
ty≥
, 
ksi
,

2394 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
,

2395 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

2396 
umts_¥e£¡
, 
g¥s_¥e£¡
)

2398 
LOG_FUNC_IN
;

2400 i‡–(
ty≥
 =
EMM_ATTACH_TYPE_EMERGENCY
Ë!
˘x
->
is_emîgícy
) {

2401 
	`LOG_FUNC_RETURN
 (
TRUE
);

2404 i‡(
ksi
 !
˘x
->ksi) {

2405 
	`LOG_FUNC_RETURN
 (
TRUE
);

2408 i‡(
ìa
 !
˘x
->eea) {

2409 
	`LOG_FUNC_RETURN
 (
TRUE
);

2412 i‡(
eü
 !
˘x
->eia) {

2413 
	`LOG_FUNC_RETURN
 (
TRUE
);

2415 i‡(
umts_¥e£¡
 !
˘x
->umts_present){

2416 
	`LOG_FUNC_RETURN
 (
TRUE
);

2418 i‡(
˘x
->
umts_¥e£¡
){

2419 i‡(
ucs2
 !
˘x
->ucs2) {

2420 
	`LOG_FUNC_RETURN
 (
TRUE
);

2423 i‡(
uó
 !
˘x
->uea) {

2424 
	`LOG_FUNC_RETURN
 (
TRUE
);

2427 i‡(
uü
 !
˘x
->uia) {

2428 
	`LOG_FUNC_RETURN
 (
TRUE
);

2431 i‡(
g¥s_¥e£¡
 !
˘x
->gprs_present){

2432 
	`LOG_FUNC_RETURN
 (
TRUE
);

2434 i‡(
˘x
->
g¥s_¥e£¡
){

2435 i‡(
gó
 !
˘x
->gea) {

2436 
	`LOG_FUNC_RETURN
 (
TRUE
);

2441 i‡–(
guti
Ë&& (
˘x
->gutò=
NULL
) ) {

2442 
	`LOG_FUNC_RETURN
 (
TRUE
);

2444 i‡–(
guti
 =
NULL
Ë&& (
˘x
->guti) ) {

2445 
	`LOG_FUNC_RETURN
 (
TRUE
);

2447 i‡–(
guti
Ë&& (
˘x
->guti) ) {

2448 i‡(
guti
->
m_tmsi
 !
˘x
->guti->m_tmsi) {

2449 
	`LOG_FUNC_RETURN
 (
TRUE
);

2451 i‡–
	`memcmp
(&
guti
->
gummei
, &
˘x
->guti->gummei, (
gummei_t
)) != 0 ) {

2452 
	`LOG_FUNC_RETURN
 (
TRUE
);

2456 i‡–(
imsi
Ë&& (
˘x
->imsò=
NULL
) ) {

2457 
	`LOG_FUNC_RETURN
 (
TRUE
);

2459 i‡–(
imsi
 =
NULL
Ë&& (
˘x
->imsi) ) {

2460 
	`LOG_FUNC_RETURN
 (
TRUE
);

2462 i‡–(
imsi
Ë&& (
˘x
->imsi) ) {

2463 i‡–
	`memcmp
(
imsi
, 
˘x
->imsi, (
imsi_t
)) != 0 ) {

2464 
	`LOG_FUNC_RETURN
 (
TRUE
);

2468 i‡–(
imei
Ë&& (
˘x
->imeò=
NULL
) ) {

2469 
	`LOG_FUNC_RETURN
 (
TRUE
);

2471 i‡–(
imei
 =
NULL
Ë&& (
˘x
->imei) ) {

2472 
	`LOG_FUNC_RETURN
 (
TRUE
);

2474 i‡–(
imei
Ë&& (
˘x
->imei) ) {

2475 i‡–
	`memcmp
(
imei
, 
˘x
->imei, (
imei_t
)) != 0 ) {

2476 
	`LOG_FUNC_RETURN
 (
TRUE
);

2479 
	`LOG_FUNC_RETURN
 (
FALSE
);

2480 
	}
}

2506 
	$_emm_©èch_upd©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ueid
,

2507 
emm_¥oc_©èch_ty≥_t
 
ty≥
, 
ksi
,

2508 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
,

2509 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

2510 
umts_¥e£¡
, 
g¥s_¥e£¡
,

2511 c⁄° 
O˘ëSåög
 *
esm_msg
)

2513 
mnc_Àngth
;

2514 
LOG_FUNC_IN
;

2516 
˘x
->
ueid
 = ueid;

2518 
˘x
->
is_emîgícy
 = (
ty≥
 =
EMM_ATTACH_TYPE_EMERGENCY
);

2520 
˘x
->
ksi
 = ksi;

2522 
˘x
->
ìa
 =Éea;

2524 
˘x
->
eü
 =Éia;

2525 
˘x
->
ucs2
 = ucs2;

2526 
˘x
->
uó
 = uea;

2527 
˘x
->
uü
 = uia;

2528 
˘x
->
gó
 = gea;

2529 
˘x
->
umts_¥e£¡
 = umts_present;

2530 
˘x
->
g¥s_¥e£¡
 = gprs_present;

2533 i‡(
guti
) {

2534 
	`LOG_TRACE
(
INFO
, "EMM-PROC - GUTI NOT NULL");

2535 i‡(
˘x
->
guti
 =
NULL
) {

2536 
˘x
->
guti
 = (
GUTI_t
 *)
	`mÆloc
((GUTI_t));

2538 i‡(
˘x
->
guti
 !
NULL
) {

2539 
	`mem˝y
(
˘x
->
guti
, guti, (
GUTI_t
));

2541 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2544 i‡(
˘x
->
guti
 =
NULL
) {

2545 
˘x
->
guti
 = (
GUTI_t
 *)
	`ˇŒoc
(1, (GUTI_t));

2548 i‡((
˘x
->
guti
 !
NULL
Ë&& (
imsi
)) {

2549 
˘x
->
èc
 = 
mme_c⁄fig
.
gummei
.
∂mn_èc
[0];

2550 
˘x
->
guti
->
gummei
.
MMEcode
 = 
mme_c⁄fig
.gummei.
mmec
[0];

2551 
˘x
->
guti
->
gummei
.
MMEgid
 = 
mme_c⁄fig
.gummei.
mme_gid
[0];

2552 
˘x
->
guti
->
m_tmsi
 = (
uöt32_t
) ctx;

2554 
mnc_Àngth
 = 
	`mme_c⁄fig_föd_mnc_Àngth
(

2555 
imsi
->
u
.
num
.
digô1
,

2556 
imsi
->
u
.
num
.
digô2
,

2557 
imsi
->
u
.
num
.
digô3
,

2558 
imsi
->
u
.
num
.
digô4
,

2559 
imsi
->
u
.
num
.
digô5
,

2560 
imsi
->
u
.
num
.
digô6
);

2562 i‡((
mnc_Àngth
 == 2) || (mnc_length == 3)) {

2563 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô1
 = 
imsi
->
u
.
num
.
digô1
;

2564 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô2
 = 
imsi
->
u
.
num
.
digô2
;

2565 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô3
 = 
imsi
->
u
.
num
.
digô3
;

2566 i‡(
mnc_Àngth
 == 2) {

2567 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô1
 = 
imsi
->
u
.
num
.
digô4
;

2568 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô2
 = 
imsi
->
u
.
num
.
digô5
;

2569 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô3
 = 15;

2570 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Assign GUTI from IMSI %01X%01X%01X.%01X%01X.%04X.%02X.%08XÅoÉmm_data_context",

2571 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô1
,

2572 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô2
,

2573 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô3
,

2574 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô1
,

2575 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô2
,

2576 
˘x
->
guti
->
gummei
.
MMEgid
,

2577 
˘x
->
guti
->
gummei
.
MMEcode
,

2578 
˘x
->
guti
->
m_tmsi


2581 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô1
 = 
imsi
->
u
.
num
.
digô5
;

2582 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô2
 = 
imsi
->
u
.
num
.
digô6
;

2583 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô3
 = 
imsi
->
u
.
num
.
digô4
;

2584 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Assign GUTI from IMSI %01X%01X%01X.%01X%01X%01X.%04X.%02X.%08XÅoÉmm_data_context",

2585 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô1
,

2586 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô2
,

2587 
˘x
->
guti
->
gummei
.
∂mn
.
MCCdigô3
,

2588 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô1
,

2589 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô2
,

2590 
˘x
->
guti
->
gummei
.
∂mn
.
MNCdigô3
,

2591 
˘x
->
guti
->
gummei
.
MMEgid
,

2592 
˘x
->
guti
->
gummei
.
MMEcode
,

2593 
˘x
->
guti
->
m_tmsi


2596 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Set ctx->guti_is_newÅoÉmm_data_context");

2597 
˘x
->
guti_is_√w
 = 
TRUE
;

2599 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2602 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2606 i‡(
imsi
) {

2607 i‡(
˘x
->
imsi
 =
NULL
) {

2608 
˘x
->
imsi
 = (
imsi_t
 *)
	`mÆloc
((imsi_t));

2610 i‡(
˘x
->
imsi
 !
NULL
) {

2611 
	`mem˝y
(
˘x
->
imsi
, imsi, (
imsi_t
));

2613 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2617 i‡(
imei
) {

2618 i‡(
˘x
->
imei
 =
NULL
) {

2619 
˘x
->
imei
 = (
imei_t
 *)
	`mÆloc
((imei_t));

2621 i‡(
˘x
->
imei
 !
NULL
) {

2622 
	`mem˝y
(
˘x
->
imei
, imei, (
imei_t
));

2624 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2628 i‡(
esm_msg
->
Àngth
 > 0) {

2629 i‡(
˘x
->
esm_msg
.
Àngth
 == 0) {

2630 
˘x
->
esm_msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
”sm_msg->
Àngth
);

2632 i‡(
˘x
->
esm_msg
.
vÆue
 !
NULL
) {

2633 
	`°∫˝y
((*)
˘x
->
esm_msg
.
vÆue
,

2634 (*)
esm_msg
->
vÆue
,Ésm_msg->
Àngth
);

2636 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

2639 
˘x
->
esm_msg
.
Àngth
 =Ésm_msg->length;

2641 
˘x
->
is_©èched
 = 
FALSE
;

2643 
	`LOG_FUNC_RETURN
 (
RETURNok
);

2644 
	}
}

	@src/emm/Authentication.c

60 
	~<°dlib.h
>

61 
	~<°rög.h
>

62 
	~<¨∑/öë.h
>

64 
	~"emm_¥oc.h
"

65 
	~"«s_log.h
"

66 
	~"«s_timî.h
"

68 
	~"emmD©a.h
"

70 
	~"emm_ßp.h
"

71 
	~"emm_ˇu£.h
"

73 #ifde‡
NAS_UE


74 
	~"usim_≠i.h
"

75 
	~"£cu_defs.h
"

78 #ifde‡
NAS_MME


79 #i‡
deföed
(
EPC_BUILD
)

80 
	~"«s_ôti_mesßgög.h
"

88 #ifde‡
NAS_UE


92 *
_emm_©èch_t3410_h™dÀr
(*);

93 *
_emm_£rvi˚_t3417_h™dÀr
(*);

94 *
_emm_dëach_t3421_h™dÀr
(*);

95 *
_emm_èu_t3430_h™dÀr
(*);

107 #ifde‡
NAS_UE


111 *
_authítiˇti⁄_t3416_h™dÀr
(*);

112 *
_authítiˇti⁄_t3418_h™dÀr
(*);

113 *
_authítiˇti⁄_t3420_h™dÀr
(*);

119 
uöt8_t
 
	mønd
[
AUTH_RAND_SIZE
];

120 
uöt8_t
 
	mªs
[
AUTH_RES_SIZE
];

121 
uöt8_t
 
	mck
[
AUTH_CK_SIZE
];

122 
uöt8_t
 
	mik
[
AUTH_IK_SIZE
];

123 
	#AUTHENTICATION_T3410
 0x01

	)

124 
	#AUTHENTICATION_T3417
 0x02

	)

125 
	#AUTHENTICATION_T3421
 0x04

	)

126 
	#AUTHENTICATION_T3430
 0x08

	)

127 
	mtimîs
;

128 
	#AUTHENTICATION_COUNTER_MAX
 3

	)

129 
	mmac_cou¡
:2;

130 
	mumts_cou¡
:2;

131 
	msync_cou¡
:2;

132 } 
	g_authítiˇti⁄_d©a
;

137 
_authítiˇti⁄_abn‹mÆ_ˇ£s_cde
(
emm_ˇu£
,

138 c⁄° 
O˘ëSåög
 *
auts
);

139 
_authítiˇti⁄_abn‹mÆ_ˇ£_f
();

141 
_authítiˇti⁄_°›_timîs
();

142 
_authítiˇti⁄_°¨t_timîs
();

143 
_authítiˇti⁄_kasme
(c⁄° 
O˘ëSåög
 *
auä
,

144 c⁄° 
O˘ëSåög
 *
ck
, c⁄° O˘ëSåög *
ik
, c⁄° 
∂mn_t
 *
∂mn
,

145 
O˘ëSåög
 *
kasme
);

153 #ifde‡
NAS_MME


157 *
_authítiˇti⁄_t3460_h™dÀr
(*);

164 
_authítiˇti⁄_ab‹t
(*);

170 
	mueid
;

171 
	#AUTHENTICATION_COUNTER_MAX
 5

	)

172 
	mªå™smissi⁄_cou¡
;

173 
	mksi
;

174 
O˘ëSåög
 
	mønd
;

175 
O˘ëSåög
 
	mauä
;

176 
	mnŸify_Áûuª
;

179 } 
	tauthítiˇti⁄_d©a_t
;

181 
_authítiˇti⁄_ªque°
(
authítiˇti⁄_d©a_t
 *
d©a
);

182 
_authítiˇti⁄_ªje˘
(
ueid
);

194 #ifde‡
NAS_UE


222 
	$emm_¥oc_authítiˇti⁄_ªque°
(
«tive_ksi
, 
ksi
,

223 c⁄° 
O˘ëSåög
 *
ønd
,

224 c⁄° 
O˘ëSåög
 *
auä
)

226 
LOG_FUNC_IN
;

228 
rc
 = 
RETURNîr‹
;

230 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Authítiˇti⁄Ñeque°ed ksòty≥ = %s, ksò%d", 
«tive_ksi
 ? "«tive" : "m≠≥d", 
ksi
);

236 i‡(!
_emm_d©a
.
usim_is_vÆid
) {

237 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - USIM isÇotÖresent orÇot valid");

238 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

242 i‡(
T3418
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

243 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3418 (%d)", 
T3418
.
id
);

244 
T3418
.
id
 = 
	`«s_timî_°›
(T3418.id);

247 i‡(
T3420
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

248 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3420 (%d)", 
T3420
.
id
);

249 
T3420
.
id
 = 
	`«s_timî_°›
(T3420.id);

253 
O˘ëSåög
 
ck
 = {
AUTH_CK_SIZE
, 
_authítiˇti⁄_d©a
.ck};

254 
O˘ëSåög
 
ik
 = {
AUTH_IK_SIZE
, 
_authítiˇti⁄_d©a
.ik};

255 
O˘ëSåög
 
ªs
 = {
AUTH_RES_SIZE
, 
_authítiˇti⁄_d©a
.res};

257 i‡(
	`memcmp
(
_authítiˇti⁄_d©a
.
ønd
,Ñ™d->
vÆue
, 
AUTH_CK_SIZE
) != 0) {

263 
O˘ëSåög
 
auts
;

264 
auts
.
Àngth
 = 0;

265 
auts
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(
AUTH_AUTS_SIZE
);

266 i‡(
auts
.
vÆue
 =
NULL
) {

267 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoállocate AUTSÖarameter");

268 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

273 
sbô
 = 
	`AUTH_AMF_SEPARATION_BIT
(
auä
->
vÆue
[
AUTH_AMF_INDEX
]);

274 i‡(
sbô
 != 0) {

276 
ªs
.
Àngth
 = 8;

283 
rc
 = 
	`usim_≠i_authítiˇã
(
ønd
, 
auä
, &
auts
, &
ªs
, &
ck
, &
ik
);

285 i‡(
rc
 !
RETURNok
) {

289 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Networkáuthentication failed (%s)",

290 (
auts
.
Àngth
 > 0) ? "SQN failure" :

291 (
sbô
 == 0) ? "Non-EPSáuthentication unacceptable" :

294 (Ë
	`emm_¥oc_authítiˇti⁄_dñëe
();

296 i‡(
auts
.
Àngth
 > 0) {

299 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£s_cde
(

300 
EMM_CAUSE_SYNCH_FAILURE
, &
auts
);

301 } i‡(
sbô
 == 0) {

304 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£s_cde
(

305 
EMM_CAUSE_NON_EPS_AUTH_UNACCEPTABLE
, 
NULL
);

309 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£s_cde
(

310 
EMM_CAUSE_MAC_FAILURE
, 
NULL
);

313 
	`‰ì
(
auts
.
vÆue
);

314 
	`LOG_FUNC_RETURN
 (
rc
);

318 
	`‰ì
(
auts
.
vÆue
);

320 i‡(
ønd
->
Àngth
 <
AUTH_RAND_SIZE
) {

321 
	`mem˝y
(
_authítiˇti⁄_d©a
.
ønd
,Ñ™d->
vÆue
,Ñ™d->
Àngth
);

324 i‡(
T3416
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

325 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3416 (%d)", 
T3416
.
id
);

326 
T3416
.
id
 = 
	`«s_timî_°›
(T3416.id);

328 
T3416
.
id
 = 
	`«s_timî_°¨t
(T3416.
£c
, 
_authítiˇti⁄_t3416_h™dÀr
, 
NULL
);

329 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3416 (%d)Éxpires in %ld seconds",

330 
T3416
.
id
, T3416.
£c
);

339 
rc
 = 
	`_authítiˇti⁄_°¨t_timîs
();

340 i‡(
rc
 !
RETURNok
) {

341 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅo startÑetransmissionÅimers");

342 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

347 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

348 i‡(
rc
 !
RETURNok
) {

349 
	`LOG_TRACE
(
WARNING
,

351 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

358 
emm_ßp_t
 
emm_ßp
;

359 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_RES
;

360 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
_emm_d©a
.guti;

361 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 0;

362 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_AUTH
;

363 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

364 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ªs
 = &res;

366 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

367 
_emm_d©a
.
£curôy
, 
FALSE
, 
TRUE
);

368 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

370 i‡(
rc
 !
RETURNîr‹
) {

372 
_authítiˇti⁄_d©a
.
mac_cou¡
 = 0;

373 
_authítiˇti⁄_d©a
.
umts_cou¡
 = 0;

374 
_authítiˇti⁄_d©a
.
sync_cou¡
 = 0;

376 i‡(
_emm_d©a
.
n⁄_cuºít
 =
NULL
) {

377 
_emm_d©a
.
n⁄_cuºít
 =

378 (
emm_£curôy_c⁄ãxt_t
 *)
	`mÆloc
((emm_security_context_t));

380 i‡(
_emm_d©a
.
n⁄_cuºít
) {

381 
	`mem£t
(
_emm_d©a
.
n⁄_cuºít
, 0, (
emm_£curôy_c⁄ãxt_t
));

383 i‡(
«tive_ksi
) {

384 
_emm_d©a
.
n⁄_cuºít
->
ty≥
 = 
EMM_KSI_NATIVE
;

386 
_emm_d©a
.
n⁄_cuºít
->
ty≥
 = 
EMM_KSI_MAPPED
;

389 
_emm_d©a
.
n⁄_cuºít
->
eksi
 = 
ksi
;

392 
_emm_d©a
.
n⁄_cuºít
->
kasme
.
Àngth
 = 
AUTH_KASME_SIZE
;

393 
_emm_d©a
.
n⁄_cuºít
->
kasme
.
vÆue
 = 
	`mÆloc
(32);

394 
	`_authítiˇti⁄_kasme
(
auä
, &
ck
, &
ik
, &
_emm_d©a
.
•lmn
,

395 &
_emm_d©a
.
n⁄_cuºít
->
kasme
);

400 
	`LOG_FUNC_RETURN
 (
rc
);

401 
	}
}

425 
	$emm_¥oc_authítiˇti⁄_ªje˘
()

427 
LOG_FUNC_IN
;

429 
emm_ßp_t
 
emm_ßp
;

430 
rc
;

432 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - AuthenticationÇotáccepted byÅheÇetwork");

435 (Ë
	`emm_¥oc_authítiˇti⁄_dñëe
();

438 
_emm_d©a
.
°©us
 = 
EU3_ROAMING_NOT_ALLOWED
;

440 
_emm_d©a
.
guti
 = 
NULL
;

442 
_emm_d©a
.
…ai
.
n_èis
 = 0;

444 
_emm_d©a
.
èi
 = 
NULL
;

446 i‡(
_emm_d©a
.
£curôy
) {

447 
_emm_d©a
.
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

450 
_emm_d©a
.
usim_is_vÆid
 = 
FALSE
;

453 i‡(
T3410
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

454 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

455 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

458 i‡(
T3417
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

459 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3417 (%d)", 
T3417
.
id
);

460 
T3417
.
id
 = 
	`«s_timî_°›
(T3417.id);

463 i‡(
T3430
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

464 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3430 (%d)", 
T3430
.
id
);

465 
T3430
.
id
 = 
	`«s_timî_°›
(T3430.id);

470 
_authítiˇti⁄_d©a
.
timîs
 = 0x00;

475 
emm_ßp
.
¥imôive
 = 
EMMREG_AUTH_REJ
;

476 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

478 
	`LOG_FUNC_RETURN
 (
rc
);

479 
	}
}

503 
	$emm_¥oc_authítiˇti⁄_dñëe
()

505 
LOG_FUNC_IN
;

507 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Deleteáuthentication data RANDánd RES");

510 i‡(
T3416
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

511 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3416 (%d)", 
T3416
.
id
);

512 
T3416
.
id
 = 
	`«s_timî_°›
(T3416.id);

515 
	`mem£t
(
_authítiˇti⁄_d©a
.
ønd
, 0, 
AUTH_RAND_SIZE
);

516 
	`mem£t
(
_authítiˇti⁄_d©a
.
ªs
, 0, 
AUTH_RES_SIZE
);

518 
	`LOG_FUNC_RETURN
 (
RETURNok
);

519 
	}
}

527 #ifde‡
NAS_MME


560 
	$emm_¥oc_authítiˇti⁄
(*
˘x
, 
ueid
, 
ksi
,

561 c⁄° 
O˘ëSåög
 *
_ønd
, c⁄° O˘ëSåög *
auä
,

562 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

563 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

564 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
)

567 
rc
 = 
RETURNîr‹
;

568 
authítiˇti⁄_d©a_t
 *
d©a
;

570 
LOG_FUNC_IN
;

572 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Inôüãáuthítiˇti⁄ KSI = %d, ctx = %p", 
ksi
, 
˘x
);

575 
d©a
 = (
authítiˇti⁄_d©a_t
 *)
	`mÆloc
((authentication_data_t));

577 i‡(
d©a
 !
NULL
) {

579 
rc
 = 
	`emm_¥oc_comm⁄_öôülize
(
ueid
, 
suc˚ss
, 
ªje˘
, 
Áûuª
,

580 
_authítiˇti⁄_ab‹t
, 
d©a
);

581 i‡(
rc
 !
RETURNok
) {

582 
	`LOG_TRACE
(
WARNING
, "FailedÅo initialize EMM callback functions");

583 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

587 
d©a
->
ueid
 = ueid;

589 
d©a
->
ªå™smissi⁄_cou¡
 = 0;

591 
d©a
->
ksi
 = ksi;

593 i‡(
_ønd
->
Àngth
 > 0) {

594 
d©a
->
ønd
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(
_ønd
->
Àngth
);

595 
d©a
->
ønd
.
Àngth
 = 0;

596 i‡(
d©a
->
ønd
.
vÆue
) {

597 
	`mem˝y
(
d©a
->
ønd
.
vÆue
, 
_ønd
->vÆue, _ønd->
Àngth
);

598 
d©a
->
ønd
.
Àngth
 = 
_ønd
->length;

602 i‡(
auä
->
Àngth
 > 0) {

603 
d©a
->
auä
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
◊uä->
Àngth
);

604 
d©a
->
auä
.
Àngth
 = 0;

605 i‡(
d©a
->
auä
.
vÆue
) {

606 
	`mem˝y
(
d©a
->
auä
.
vÆue
,áuä->vÆue,áuä->
Àngth
);

607 
d©a
->
auä
.
Àngth
 =áutn->length;

611 
d©a
->
nŸify_Áûuª
 = 
FALSE
;

613 
rc
 = 
	`_authítiˇti⁄_ªque°
(
d©a
);

614 i‡(
rc
 !
RETURNîr‹
) {

618 
emm_ßp_t
 
emm_ßp
;

619 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REQ
;

620 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

621 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = ctx;

622 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

626 
	`LOG_FUNC_RETURN
 (
rc
);

627 
	}
}

652 
	$emm_¥oc_authítiˇti⁄_com∂ëe
(
ueid
, 
emm_ˇu£
,

653 c⁄° 
O˘ëSåög
 *
ªs
)

655 
rc
;

656 
emm_ßp_t
 
emm_ßp
;

658 
LOG_FUNC_IN
;

660 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Authentication complete (ueid=%u, cause=%d)",

661 
ueid
, 
emm_ˇu£
);

664 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3460 (%d)", 
T3460
.
id
);

665 
T3460
.
id
 = 
	`«s_timî_°›
(T3460.id);

668 
authítiˇti⁄_d©a_t
 *
d©a
 =

669 (
authítiˇti⁄_d©a_t
 *)(
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
));

670 i‡(
d©a
) {

671 i‡(
d©a
->
ønd
.
Àngth
 > 0) {

672 
	`‰ì
(
d©a
->
ønd
.
vÆue
);

674 i‡(
d©a
->
auä
.
Àngth
 > 0) {

675 
	`‰ì
(
d©a
->
auä
.
vÆue
);

677 
	`‰ì
(
d©a
);

681 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

683 #i‡
	`deföed
(
EPC_BUILD
)

684 i‡(
ueid
 > 0) {

685 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

688 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

689 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

693 i‡(
emm_ˇu£
 =
EMM_CAUSE_SUCCESS
) {

695 i‡–(
emm_˘x
 =
NULL
) ||

696 (
	`memcmp
(
ªs
->
vÆue
, &
emm_˘x
->
ve˘‹
.
xªs
,Ñes->
Àngth
) != 0) ) {

698 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoáuthentifyÅhe UE");

699 
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

701 
	`LOG_TRACE
(
DEBUG
, "EMM-PROC - SuccessÅoáuthentifyÅhe UE RESP XRES == XRES UE CONTEXT");

705 i‡(
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

706 
emm_ˇu£
) {

708 #i‡
	`deföed
(
EPC_BUILD
)

709 
EMM_CAUSE_SYNCH_FAILURE
:

713 
	`LOG_TRACE
(
DEBUG
, "EMM-PROC - USIM has detectedá mismatch in SQN Ask foráÇew vector");

714 
	`«s_ôti_auth_öfo_ªq
(
ueid
, 
emm_˘x
->
imsi
, 0, 
ªs
->
vÆue
);

716 
rc
 = 
RETURNok
;

717 
	`LOG_FUNC_RETURN
 (
rc
);

722 
	`LOG_TRACE
(
DEBUG
, "EMM-PROC - The MMEÑeceivedánáuthentication failure message orÅhe RES doesÇot matchÅhe XRESÖarameter computed byÅheÇetwork");

726 (Ë
	`_authítiˇti⁄_ªje˘
(
ueid
);

730 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

731 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

732 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

739 
	`LOG_TRACE
(
DEBUG
, "EMM-PROC - Notify EMMÅhatÅheáuthenticationÖrocedure successfully completed");

740 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_CNF
;

741 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

742 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

743 
emm_ßp
.
u
.
emm_ªg
.u.
comm⁄
.
is_©èched
 = 
emm_˘x
->is_attached;

746 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

748 
	`LOG_FUNC_RETURN
 (
rc
);

749 
	}
}

756 #ifde‡
NAS_UE


781 *
	$_authítiˇti⁄_t3416_h™dÀr
(*
¨gs
)

783 
LOG_FUNC_IN
;

785 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3416ÅimerÉxpired");

788 
T3416
.
id
 = 
	`«s_timî_°›
(T3416.id);

790 (Ë
	`emm_¥oc_authítiˇti⁄_dñëe
();

792 
	`LOG_FUNC_RETURN
 (
NULL
);

793 
	}
}

814 *
	$_authítiˇti⁄_t3418_h™dÀr
(*
¨gs
)

816 
LOG_FUNC_IN
;

818 
rc
;

820 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3418ÅimerÉxpired");

823 
T3418
.
id
 = 
	`«s_timî_°›
(T3418.id);

825 
_authítiˇti⁄_d©a
.
mac_cou¡
 = 0;

826 
_authítiˇti⁄_d©a
.
umts_cou¡
 = 0;

828 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£_f
();

829 i‡(
rc
 !
RETURNok
) {

830 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoÖroceedábnormal case f");

833 
	`LOG_FUNC_RETURN
 (
NULL
);

834 
	}
}

854 *
	$_authítiˇti⁄_t3420_h™dÀr
(*
¨gs
)

856 
LOG_FUNC_IN
;

858 
rc
;

860 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3420ÅimerÉxpired");

863 
T3420
.
id
 = 
	`«s_timî_°›
(T3420.id);

865 
_authítiˇti⁄_d©a
.
sync_cou¡
 = 0;

867 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£_f
();

868 i‡(
rc
 !
RETURNok
) {

869 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - FailedÅoÖroceedábnormal case f");

872 
	`LOG_FUNC_RETURN
 (
NULL
);

873 
	}
}

897 
	$_authítiˇti⁄_abn‹mÆ_ˇ£s_cde
(
emm_ˇu£
,

898 c⁄° 
O˘ëSåög
 *
auts
)

900 
LOG_FUNC_IN
;

902 
rc
;

904 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

906 
_authítiˇti⁄_d©a
.
mac_cou¡
, _authítiˇti⁄_d©a.
umts_cou¡
,

907 
_authítiˇti⁄_d©a
.
sync_cou¡
);

913 
emm_ßp_t
 
emm_ßp
;

914 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_RES
;

915 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
_emm_d©a
.guti;

916 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 0;

917 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_AUTH
;

918 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
emm_ˇu£
 =Émm_cause;

919 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
auts
 =áuts;

921 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

922 
_emm_d©a
.
£curôy
, 
FALSE
, 
TRUE
);

923 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

925 i‡(
rc
 !
RETURNîr‹
) {

929 
emm_ˇu£
) {

930 
EMM_CAUSE_MAC_FAILURE
:

933 
_authítiˇti⁄_d©a
.
mac_cou¡
 += 1;

935 
T3418
.
id
 = 
	`«s_timî_°¨t
(T3418.
£c
,

936 
_authítiˇti⁄_t3418_h™dÀr
, 
NULL
);

937 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3418 (%d)Éxpires in "

938 "%ld sec⁄ds", 
T3418
.
id
, T3418.
£c
);

941 
EMM_CAUSE_NON_EPS_AUTH_UNACCEPTABLE
:

944 
_authítiˇti⁄_d©a
.
umts_cou¡
 += 1;

946 
T3418
.
id
 = 
	`«s_timî_°¨t
(T3418.
£c
,

947 
_authítiˇti⁄_t3418_h™dÀr
, 
NULL
);

948 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3418 (%d)Éxpires in "

949 "%ld sec⁄ds", 
T3418
.
id
, T3418.
£c
);

952 
EMM_CAUSE_SYNCH_FAILURE
:

955 
_authítiˇti⁄_d©a
.
sync_cou¡
 += 1;

957 
T3420
.
id
 = 
	`«s_timî_°¨t
(T3420.
£c
,

958 
_authítiˇti⁄_t3420_h™dÀr
, 
NULL
);

959 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3420 (%d)Éxpires in "

960 "%ld sec⁄ds", 
T3420
.
id
, T3420.
£c
);

964 
	`LOG_TRACE
(
WARNING
, "EMM cause code isÇot valid (%d)",

965 
emm_ˇu£
);

966 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

971 
rc
 = 
	`_authítiˇti⁄_°›_timîs
();

972 i‡(
rc
 !
RETURNok
) {

973 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

975 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

980 
Áûuª_cou¡î
 = 0;

981 i‡(
emm_ˇu£
 =
EMM_CAUSE_MAC_FAILURE
) {

982 
Áûuª_cou¡î
 = 
_authítiˇti⁄_d©a
.
mac_cou¡


983 + 
_authítiˇti⁄_d©a
.
sync_cou¡
;

984 } i‡(
emm_ˇu£
 =
EMM_CAUSE_SYNCH_FAILURE
) {

985 
Áûuª_cou¡î
 = 
_authítiˇti⁄_d©a
.
mac_cou¡


986 + 
_authítiˇti⁄_d©a
.
umts_cou¡


987 + 
_authítiˇti⁄_d©a
.
sync_cou¡
;

989 i‡(
Áûuª_cou¡î
 >
AUTHENTICATION_COUNTER_MAX
) {

991 
rc
 = 
	`_authítiˇti⁄_abn‹mÆ_ˇ£_f
();

992 i‡(
rc
 !
RETURNok
) {

993 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

999 
	`LOG_FUNC_RETURN
 (
rc
);

1000 
	}
}

1018 
	$_authítiˇti⁄_abn‹mÆ_ˇ£_f
()

1020 
LOG_FUNC_IN
;

1022 
rc
;

1024 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Authenticationábnormal case f");

1030 
emm_ßp_t
 
emm_ßp
;

1031 
emm_ßp
.
¥imôive
 = 
EMMAS_RELEASE_REQ
;

1032 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
guti
 = 
_emm_d©a
.guti;

1033 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
ˇu£
 = 
EMM_AS_CAUSE_AUTHENTICATION
;

1034 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1036 i‡(
rc
 !
RETURNîr‹
) {

1041 
rc
 = 
	`_authítiˇti⁄_°¨t_timîs
();

1044 
	`LOG_FUNC_RETURN
 (
rc
);

1045 
	}
}

1069 
	$_authítiˇti⁄_°›_timîs
()

1071 
LOG_FUNC_IN
;

1074 i‡(
T3410
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1075 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3410 (%d)", 
T3410
.
id
);

1076 
T3410
.
id
 = 
	`«s_timî_°›
(T3410.id);

1077 
_authítiˇti⁄_d©a
.
timîs
 |
AUTHENTICATION_T3410
;

1080 i‡(
T3417
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1081 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3417 (%d)", 
T3417
.
id
);

1082 
T3417
.
id
 = 
	`«s_timî_°›
(T3417.id);

1083 
_authítiˇti⁄_d©a
.
timîs
 |
AUTHENTICATION_T3417
;

1086 i‡(
T3421
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1087 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3421 (%d)", 
T3421
.
id
);

1088 
T3421
.
id
 = 
	`«s_timî_°›
(T3421.id);

1089 
_authítiˇti⁄_d©a
.
timîs
 |
AUTHENTICATION_T3421
;

1092 i‡(
T3430
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1093 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3430 (%d)", 
T3430
.
id
);

1094 
T3430
.
id
 = 
	`«s_timî_°›
(T3430.id);

1095 
_authítiˇti⁄_d©a
.
timîs
 |
AUTHENTICATION_T3430
;

1098 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1099 
	}
}

1120 
	$_authítiˇti⁄_°¨t_timîs
()

1122 
LOG_FUNC_IN
;

1124 i‡(
_authítiˇti⁄_d©a
.
timîs
 & 
AUTHENTICATION_T3410
) {

1126 
T3410
.
id
 = 
	`«s_timî_°¨t
(T3410.
£c
, 
_emm_©èch_t3410_h™dÀr
, 
NULL
);

1127 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3410 (%d)Éxpires in "

1128 "%ld sec⁄ds", 
T3410
.
id
, T3410.
£c
);

1130 i‡(
_authítiˇti⁄_d©a
.
timîs
 & 
AUTHENTICATION_T3417
) {

1132 
T3417
.
id
 = 
	`«s_timî_°¨t
(T3417.
£c
, 
_emm_£rvi˚_t3417_h™dÀr
, 
NULL
);

1133 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3417 (%d)Éxpires in "

1134 "%ld sec⁄ds", 
T3417
.
id
, T3417.
£c
);

1136 i‡(
_authítiˇti⁄_d©a
.
timîs
 & 
AUTHENTICATION_T3421
) {

1138 
T3421
.
id
 = 
	`«s_timî_°¨t
(T3421.
£c
, 
_emm_dëach_t3421_h™dÀr
, 
NULL
);

1139 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3421 (%d)Éxpires in "

1140 "%ld sec⁄ds", 
T3421
.
id
, T3421.
£c
);

1142 i‡(
_authítiˇti⁄_d©a
.
timîs
 & 
AUTHENTICATION_T3430
) {

1144 
T3430
.
id
 = 
	`«s_timî_°¨t
(T3430.
£c
, 
_emm_èu_t3430_h™dÀr
, 
NULL
);

1145 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3430 (%d)Éxpires in "

1146 "%ld sec⁄ds", 
T3430
.
id
, T3430.
£c
);

1149 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1150 
	}
}

1172 
	$_authítiˇti⁄_kasme
(c⁄° 
O˘ëSåög
 *
auä
,

1173 c⁄° 
O˘ëSåög
 *
ck
, c⁄° O˘ëSåög *
ik
,

1174 c⁄° 
∂mn_t
 *
∂mn
, 
O˘ëSåög
 *
kasme
)

1176 
LOG_FUNC_IN
;

1178 
	`LOG_TRACE
(
INFO
,"EMM-PROC _authentication_kasme INPUT CK %s",

1179 
	`dump_o˘ë_°rög
(
ck
));

1180 
	`LOG_TRACE
(
INFO
,"EMM-PROC _authentication_kasme INPUT IK %s",

1181 
	`dump_o˘ë_°rög
(
ik
));

1182 
	`LOG_TRACE
(
INFO
,"EMM-PROC _authentication_kasme INPUT AUTN %s",

1183 
	`dump_o˘ë_°rög
(
auä
));

1184 
	`LOG_TRACE
(
INFO
,"EMM-PROC _authentication_kasme INPUT KASME LENGTH %u",

1185 
kasme
->
Àngth
);

1188 
UI¡8_t
 
key
[
ck
->
Àngth
 + 
ik
->length];

1189 
	`mem˝y
(
key
, 
ck
->
vÆue
, ck->
Àngth
);

1190 
	`mem˝y
(
key
 + 
ck
->
Àngth
, 
ik
->
vÆue
, ik->length);

1195 
UI¡8_t
 
öput_s
[16];

1196 
UI¡8_t
 
¢_id
[
AUTH_SNID_SIZE
];

1197 
UI¡16_t
 
Àngth
;

1198 
off£t
 = 0;

1199 
size_of_Àngth
 = (
Àngth
);

1202 
öput_s
[
off£t
] = 0x10;

1203 
off£t
 += 1;

1206 
Àngth
 = 
AUTH_SNID_SIZE
;

1207 
¢_id
[0] = (
∂mn
->
MCCdigô2
 << 4Ë|Ölmn->
MCCdigô1
;

1208 
¢_id
[1] = (
∂mn
->
MNCdigô3
 << 4Ë|Ölmn->
MCCdigô3
;

1209 
¢_id
[2] = (
∂mn
->
MNCdigô2
 << 4Ë|Ölmn->
MNCdigô1
;

1211 
	`mem˝y
(
öput_s
 + 
off£t
, 
¢_id
, 
Àngth
);

1212 
	`LOG_TRACE
(
INFO
,"EMM-PROC _authentication_kasme P0 MCC,MNC %02X %02X %02X",

1213 
öput_s
[
off£t
],

1214 
öput_s
[
off£t
+1],

1215 
öput_s
[
off£t
+2]);

1216 
off£t
 +
Àngth
;

1218 
Àngth
 = 
	`ht⁄s
(length);

1219 
	`mem˝y
(
öput_s
 + 
off£t
, &
Àngth
, 
size_of_Àngth
);

1220 
off£t
 +
size_of_Àngth
;

1223 
Àngth
 = 
AUTH_SQN_SIZE
;

1224 
	`mem˝y
(
öput_s
 + 
off£t
, 
auä
->
vÆue
, 
Àngth
);

1225 
off£t
 +
Àngth
;

1227 
Àngth
 = 
	`ht⁄s
(length);

1228 
	`mem˝y
(
öput_s
 + 
off£t
, &
Àngth
, 
size_of_Àngth
);

1229 
off£t
 +
size_of_Àngth
;

1231 
	`LOG_TRACE
(
INFO
,

1233 
off£t
,

1234 
öput_s
[0],input_s[1],input_s[2],input_s[3],

1235 
öput_s
[4],input_s[5],input_s[6],input_s[7],

1236 
öput_s
[8],input_s[9],input_s[10],input_s[11],

1237 
öput_s
[12],input_s[13]);

1240 
	`kdf
(
key
,

1241 
ck
->
Àngth
 + 
ik
->length ,

1242 
öput_s
,

1243 
off£t
,

1244 
kasme
->
vÆue
,

1245 
kasme
->
Àngth
);

1247 
	`LOG_TRACE
(
INFO
,"EMM-PROC KASME (l=%d)%s",

1248 
kasme
->
Àngth
,

1249 
	`dump_o˘ë_°rög
(
kasme
));

1251 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1252 
	}
}

1255 #ifde‡
NAS_MME


1283 *
	$_authítiˇti⁄_t3460_h™dÀr
(*
¨gs
)

1285 
LOG_FUNC_IN
;

1287 
rc
;

1289 
authítiˇti⁄_d©a_t
 *
d©a
 = (authítiˇti⁄_d©a_à*)(
¨gs
);

1292 
d©a
->
ªå™smissi⁄_cou¡
 += 1;

1294 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3460ÅimerÉxpired,Ñetransmission "

1295 "cou¡î = %d", 
d©a
->
ªå™smissi⁄_cou¡
);

1297 i‡(
d©a
->
ªå™smissi⁄_cou¡
 < 
AUTHENTICATION_COUNTER_MAX
) {

1299 
rc
 = 
	`_authítiˇti⁄_ªque°
(
d©a
);

1301 
ueid
 = 
d©a
->ueid;

1303 
d©a
->
nŸify_Áûuª
 = 
TRUE
;

1305 
rc
 = 
	`_authítiˇti⁄_ab‹t
(
d©a
);

1307 i‡(
rc
 !
RETURNîr‹
) {

1308 
emm_ßp_t
 
emm_ßp
;

1309 
emm_ßp
.
¥imôive
 = 
EMMAS_RELEASE_REQ
;

1310 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
guti
 = 
NULL
;

1311 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
ueid
 = ueid;

1312 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
ˇu£
 = 
EMM_AS_CAUSE_AUTHENTICATION
;

1313 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1317 
	`LOG_FUNC_RETURN
 (
NULL
);

1318 
	}
}

1340 
	$_authítiˇti⁄_ªque°
(
authítiˇti⁄_d©a_t
 *
d©a
)

1342 
LOG_FUNC_IN
;

1344 
emm_ßp_t
 
emm_ßp
;

1345 
rc
;

1346 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
;

1352 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_REQ
;

1353 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
NULL
;

1354 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 
d©a
->ueid;

1355 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_AUTH
;

1356 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ksi
 = 
d©a
->ksi;

1357 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ønd
 = &
d©a
->rand;

1358 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
auä
 = &
d©a
->autn;

1361 #i‡
	`deföed
(
EPC_BUILD
)

1362 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
d©a
->
ueid
);

1364 
emm_˘x
 = 
_emm_d©a
.
˘x
[
d©a
->
ueid
];

1368 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

1369 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

1370 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1372 i‡(
rc
 !
RETURNîr‹
) {

1373 i‡(
T3460
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1375 
T3460
.
id
 = 
	`«s_timî_ª°¨t
(T3460.id);

1378 
T3460
.
id
 = 
	`«s_timî_°¨t
(T3460.
£c
, 
_authítiˇti⁄_t3460_h™dÀr
,

1379 
d©a
);

1381 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3460 (%d)Éxpires in %ld seconds",

1382 
T3460
.
id
, T3460.
£c
);

1385 
	`LOG_FUNC_RETURN
 (
rc
);

1386 
	}
}

1402 
	$_authítiˇti⁄_ªje˘
(
ueid
)

1404 
LOG_FUNC_IN
;

1406 
emm_ßp_t
 
emm_ßp
;

1407 
rc
;

1408 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
;

1414 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_REJ
;

1415 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
NULL
;

1416 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = ueid;

1417 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_AUTH
;

1419 #i‡
	`deföed
(
EPC_BUILD
)

1420 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

1422 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

1425 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

1426 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

1427 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1429 
	`LOG_FUNC_RETURN
 (
rc
);

1430 
	}
}

1446 
	$_authítiˇti⁄_ab‹t
(*
¨gs
)

1448 
LOG_FUNC_IN
;

1450 
rc
 = 
RETURNîr‹
;

1452 
authítiˇti⁄_d©a_t
 *
d©a
 = (authítiˇti⁄_d©a_à*)(
¨gs
);

1454 i‡(
d©a
) {

1455 
ueid
 = 
d©a
->ueid;

1456 
nŸify_Áûuª
 = 
d©a
->notify_failure;

1458 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - AbortáuthenticationÖrocedure "

1459 "(ueid=%u)", 
ueid
);

1462 i‡(
T3460
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1463 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3460 (%d)", 
T3460
.
id
);

1464 
T3460
.
id
 = 
	`«s_timî_°›
(T3460.id);

1467 i‡(
d©a
->
ønd
.
Àngth
 > 0) {

1468 
	`‰ì
(
d©a
->
ønd
.
vÆue
);

1470 i‡(
d©a
->
auä
.
Àngth
 > 0) {

1471 
	`‰ì
(
d©a
->
auä
.
vÆue
);

1473 
	`‰ì
(
d©a
);

1478 i‡(
nŸify_Áûuª
) {

1479 
emm_ßp_t
 
emm_ßp
;

1480 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

1481 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1482 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1484 
rc
 = 
RETURNok
;

1488 
	`LOG_FUNC_RETURN
 (
rc
);

1489 
	}
}

	@src/emm/Detach.c

54 
	~"emm_¥oc.h
"

55 
	~"«s_log.h
"

56 
	~"«s_timî.h
"

58 
	~"emmD©a.h
"

60 
	~"emm_ßp.h
"

61 
	~"esm_ßp.h
"

63 
	~<°dlib.h
>

74 c⁄° *
	g_emm_dëach_ty≥_°r
[] = {

84 #ifde‡
NAS_UE


88 *
_emm_dëach_t3421_h™dÀr
(*);

93 
_emm_dëach_ab‹t
(
emm_¥oc_dëach_ty≥_t
 
ty≥
);

99 
	#EMM_DETACH_COUNTER_MAX
 5

	)

100 
	mcou¡
;

102 
	mswôch_off
;

103 
emm_¥oc_dëach_ty≥_t
 
	mty≥
;

105 } 
	g_emm_dëach_d©a
 = {0, 
FALSE
, 
EMM_DETACH_TYPE_RESERVED
};

113 #ifde‡
NAS_MME


125 #ifde‡
NAS_UE


149 
	$emm_¥oc_dëach
(
emm_¥oc_dëach_ty≥_t
 
ty≥
, 
swôch_off
)

151 
LOG_FUNC_IN
;

153 
emm_ßp_t
 
emm_ßp
;

154 
emm_as_d©a_t
 *
emm_as
 = &
emm_ßp
.
u
.emm_as.u.
d©a
;

155 
rc
;

157 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate EPS detachÅype = %s (%d)",

158 
_emm_dëach_ty≥_°r
[
ty≥
],Åype);

161 
_emm_dëach_d©a
.
cou¡
 = 0;

162 
_emm_dëach_d©a
.
swôch_off
 = switch_off;

163 
_emm_dëach_d©a
.
ty≥
 =Åype;

167 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
emm_¥oc_dëach_ªque°
,

168 
emm_¥oc_dëach_Áûuª
,

169 
emm_¥oc_dëach_ªÀa£
, 
NULL
);

170 i‡(
rc
 !
RETURNok
) {

171 
	`LOG_TRACE
(
WARNING
, "FailedÅo initialize EMMÖrocedure handler");

172 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

176 
emm_as
->
NASöfo
 = 
EMM_AS_NAS_INFO_DETACH
;

177 
emm_as
->
NASmsg
.
Àngth
 = 0;

178 
emm_as
->
NASmsg
.
vÆue
 = 
NULL
;

180 
emm_as
->
ty≥
 =Åype;

182 
emm_as
->
swôch_off
 = switch_off;

184 
emm_as
->
guti
 = 
_emm_d©a
.guti;

185 
emm_as
->
ueid
 = 0;

187 
	`emm_as_£t_£curôy_d©a
(&
emm_as
->
s˘x
, 
_emm_d©a
.
£curôy
, 
FALSE
, 
TRUE
);

193 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_REQ
;

194 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

196 
	`LOG_FUNC_RETURN
(
rc
);

197 
	}
}

215 
	$emm_¥oc_dëach_ªque°
(*
¨gs
)

217 
LOG_FUNC_IN
;

219 
emm_ßp_t
 
emm_ßp
;

220 
rc
;

222 i‡–!
_emm_dëach_d©a
.
swôch_off
 ) {

224 
T3421
.
id
 = 
	`«s_timî_°¨t
(T3421.
£c
, 
_emm_dëach_t3421_h™dÀr
, 
NULL
);

225 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3421 (%d)Éxpires in %ld seconds",

226 
T3421
.
id
, T3421.
£c
);

232 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_REQ
;

233 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

235 
	`LOG_FUNC_RETURN
(
rc
);

236 
	}
}

260 
	$emm_¥oc_dëach_ac˚±
()

262 
LOG_FUNC_IN
;

264 
rc
;

266 
	`LOG_TRACE
(
INFO
, "EMM-PROC - UE initiated detachÖrocedure completion");

269 (Ë
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

272 
T3421
.
id
 = 
	`«s_timî_°›
(T3421.id);

277 
esm_ßp_t
 
esm_ßp
;

278 
esm_ßp
.
¥imôive
 = 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
;

279 
esm_ßp
.
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
 = 
ESM_SAP_ALL_EBI
;

280 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

287 
	`LOG_FUNC_RETURN
(
rc
);

288 
	}
}

309 
	$emm_¥oc_dëach_Áûuª
(
is_öôül
, *
¨gs
)

311 
LOG_FUNC_IN
;

313 
emm_ßp_t
 
emm_ßp
;

314 
rc
;

316 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Network detach failure");

319 (Ë
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

322 
T3421
.
id
 = 
	`«s_timî_°›
(T3421.id);

327 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_INIT
;

328 
emm_ßp
.
u
.
emm_ªg
.u.
dëach
.
swôch_off
 = 
_emm_dëach_d©a
.switch_off;

329 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

331 
	`LOG_FUNC_RETURN
(
rc
);

332 
	}
}

353 
	$emm_¥oc_dëach_ªÀa£
(*
¨gs
)

355 
LOG_FUNC_IN
;

357 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - NAS signalling connectionÑeleased");

360 
rc
 = 
	`_emm_dëach_ab‹t
(
_emm_dëach_d©a
.
ty≥
);

362 
	`LOG_FUNC_RETURN
(
rc
);

363 
	}
}

371 #ifde‡
NAS_MME


395 
	$emm_¥oc_dëach
(
ueid
, 
emm_¥oc_dëach_ty≥_t
 
ty≥
)

397 
LOG_FUNC_IN
;

399 
rc
 = 
RETURNîr‹
;

401 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate detachÅype = %s (%d)",

402 
_emm_dëach_ty≥_°r
[
ty≥
],Åype);

406 
	`LOG_FUNC_RETURN
(
rc
);

407 
	}
}

445 
	$emm_¥oc_dëach_ªque°
(
ueid
, 
emm_¥oc_dëach_ty≥_t
 
ty≥
,

446 
swôch_off
, 
«tive_ksi
, 
ksi
,

447 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
, 
imei_t
 *
imei
)

449 
LOG_FUNC_IN
;

451 
rc
;

452 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

454 
	`LOG_TRACE
(
INFO
, "EMM-PROC - DetachÅype = %s (%d)Ñequested (ueid=%u)",

455 
_emm_dëach_ty≥_°r
[
ty≥
],Åy≥, 
ueid
);

458 #i‡
	`deföed
(
EPC_BUILD
)

459 i‡(
ueid
 > 0) {

460 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

463 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

464 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

468 i‡(
emm_˘x
 =
NULL
) {

469 
	`LOG_TRACE
(
WARNING
, "NÿEMM c⁄ãxàexi°†f‹ÅhêUE (ueid=%u)", 
ueid
);

470 
	`LOG_FUNC_RETURN
(
RETURNok
);

473 i‡(
swôch_off
) {

475 i‡(
emm_˘x
->
guti
) {

476 
	`‰ì
(
emm_˘x
->
guti
);

478 i‡(
emm_˘x
->
imsi
) {

479 
	`‰ì
(
emm_˘x
->
imsi
);

481 i‡(
emm_˘x
->
imei
) {

482 
	`‰ì
(
emm_˘x
->
imei
);

484 i‡(
emm_˘x
->
esm_msg
.
Àngth
 > 0) {

485 
	`‰ì
(
emm_˘x
->
esm_msg
.
vÆue
);

488 i‡(
emm_˘x
->
£curôy
) {

489 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
emm_˘x
->security;

490 i‡(
£curôy
->
kasme
.
vÆue
) {

491 
	`‰ì
(
£curôy
->
kasme
.
vÆue
);

493 i‡(
£curôy
->
k«s_íc
.
vÆue
) {

494 
	`‰ì
(
£curôy
->
k«s_íc
.
vÆue
);

496 i‡(
£curôy
->
k«s_öt
.
vÆue
) {

497 
	`‰ì
(
£curôy
->
k«s_öt
.
vÆue
);

499 
	`‰ì
(
emm_˘x
->
£curôy
);

502 #i‡
	`deföed
(
EPC_BUILD
)

503 
	`emm_d©a_c⁄ãxt_ªmove
(&
_emm_d©a
, 
emm_˘x
);

504 
	`‰ì
(
emm_˘x
);

506 
	`‰ì
(
_emm_d©a
.
˘x
[
ueid
]);

507 
_emm_d©a
.
˘x
[
ueid
] = 
NULL
;

509 
rc
 = 
RETURNok
;

512 
emm_ßp_t
 
emm_ßp
;

513 
emm_as_d©a_t
 *
emm_as
 = &
emm_ßp
.
u
.emm_as.u.
d©a
;

516 
emm_as
->
NASöfo
 = 
EMM_AS_NAS_INFO_DETACH
;

517 
emm_as
->
NASmsg
.
Àngth
 = 0;

518 
emm_as
->
NASmsg
.
vÆue
 = 
NULL
;

520 
emm_as
->
guti
 = 
NULL
;

521 
emm_as
->
ueid
 = ueid;

523 
	`emm_as_£t_£curôy_d©a
(&
emm_as
->
s˘x
, 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

528 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_REQ
;

529 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

532 i‡(
rc
 !
RETURNîr‹
) {

537 
esm_ßp_t
 
esm_ßp
;

538 
esm_ßp
.
¥imôive
 = 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
;

539 
esm_ßp
.
ueid
 = ueid;

540 
esm_ßp
.
˘x
 = 
emm_˘x
;

541 
esm_ßp
.
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
 = 
ESM_SAP_ALL_EBI
;

542 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

544 i‡(
rc
 !
RETURNîr‹
) {

545 
emm_ßp_t
 
emm_ßp
;

549 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_REQ
;

550 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

551 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

552 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

556 
	`LOG_FUNC_RETURN
(
rc
);

557 
	}
}

564 #ifde‡
NAS_UE


591 *
	$_emm_dëach_t3421_h™dÀr
(*
¨gs
)

593 
LOG_FUNC_IN
;

595 
rc
;

598 
_emm_dëach_d©a
.
cou¡
 += 1;

600 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3421ÅimerÉxpired, "

601 "ªå™smissi⁄ cou¡î = %d", 
_emm_dëach_d©a
.
cou¡
);

603 i‡(
_emm_dëach_d©a
.
cou¡
 < 
EMM_DETACH_COUNTER_MAX
) {

605 
emm_ßp_t
 
emm_ßp
;

606 
emm_as_d©a_t
 *
emm_as
 = &
emm_ßp
.
u
.emm_as.u.
d©a
;

609 
T3421
.
id
 = 
	`«s_timî_°›
(T3421.id);

612 
emm_as
->
NASöfo
 = 
EMM_AS_NAS_INFO_DETACH
;

613 
emm_as
->
NASmsg
.
Àngth
 = 0;

614 
emm_as
->
NASmsg
.
vÆue
 = 
NULL
;

616 
emm_as
->
ty≥
 = 
_emm_dëach_d©a
.type;

618 
emm_as
->
swôch_off
 = 
_emm_dëach_d©a
.switch_off;

620 
emm_as
->
guti
 = 
_emm_d©a
.guti;

621 
emm_as
->
ueid
 = 0;

623 
	`emm_as_£t_£curôy_d©a
(&
emm_as
->
s˘x
, 
_emm_d©a
.
£curôy
,

624 
FALSE
, 
TRUE
);

630 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_REQ
;

631 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

633 i‡(
rc
 !
RETURNîr‹
) {

635 
T3421
.
id
 = 
	`«s_timî_°¨t
(T3421.
£c
, 
_emm_dëach_t3421_h™dÀr
, 
NULL
);

636 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Timer T3421 (%d)Éxpires in %ld "

637 "£c⁄ds", 
T3421
.
id
, T3421.
£c
);

641 
rc
 = 
	`_emm_dëach_ab‹t
(
_emm_dëach_d©a
.
ty≥
);

644 
	`LOG_FUNC_RETURN
(
NULL
);

645 
	}
}

667 
	$_emm_dëach_ab‹t
(
emm_¥oc_dëach_ty≥_t
 
ty≥
)

669 
LOG_FUNC_IN
;

671 
emm_ßp_t
 
emm_ßp
;

672 
rc
 ;

674 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - AbortÅhe detachÖrocedure");

677 (Ë
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

680 
T3421
.
id
 = 
	`«s_timî_°›
(T3421.id);

685 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_FAILED
;

686 
emm_ßp
.
u
.
emm_ªg
.u.
dëach
.
ty≥
 =Åype;

687 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

689 
	`LOG_FUNC_RETURN
 (
rc
);

690 
	}
}

	@src/emm/EmmCommon.c

56 #ifde‡
NAS_MME


58 
	~"EmmComm⁄.h
"

60 
	~"comm⁄Def.h
"

61 
	~"«s_log.h
"

62 
	~"emmD©a.h
"

64 
	~<°dlib.h
>

65 
	~<°rög.h
>

66 
	~<as£π.h
>

68 #i‡
deföed
(
EPC_BUILD
)

69 
	~"as£πi⁄s.h
"

81 
_emm_comm⁄_˛ónup
(
ueid
);

84 
	semm_comm⁄_d©a_s
 {

85 
	mueid
;

86 
	mªf_cou¡
;

87 
emm_comm⁄_suc˚ss_ˇŒback_t
 
	msuc˚ss
;

88 
emm_comm⁄_ªje˘_ˇŒback_t
 
	mªje˘
;

89 
emm_comm⁄_Áûuª_ˇŒback_t
 
	mÁûuª
;

90 
emm_comm⁄_ab‹t_ˇŒback_t
 
	mab‹t
;

91 *
	m¨gs
;

93 #i‡
deföed
(
EPC_BUILD
)

94 
RB_ENTRY
(
emm_comm⁄_d©a_s
Ë
	míåõs
;

96 } 
	temm_comm⁄_d©a_t
;

98 #i‡
deföed
(
EPC_BUILD
)

99 
	semm_comm⁄_d©a_hód_s
 {

100 
RB_HEAD
(
emm_comm⁄_d©a_m≠
, 
emm_comm⁄_d©a_s
Ë
	memm_comm⁄_d©a_roŸ
;

101 } 
	temm_comm⁄_d©a_hód_t
;

103 
emm_comm⁄_d©a_hód_t
 
	gemm_comm⁄_d©a_hód
 = { 
RB_INITIALIZER
() };

105 
ölöe


106 
emm_comm⁄_d©a_com∑ª_ueid
(
emm_comm⁄_d©a_s
 *
p1
,

107 
emm_comm⁄_d©a_s
 *
p2
);

108 
emm_comm⁄_d©a_s
 *
emm_comm⁄_d©a_c⁄ãxt_gë
(

109 
emm_comm⁄_d©a_hód_s
 *
roŸ
, 
_ueid
);

111 
RB_PROTOTYPE
(
emm_comm⁄_d©a_m≠
, 
emm_comm⁄_d©a_s
, 
íåõs
,

112 
emm_comm⁄_d©a_com∑ª_ueid
);

115 
RB_GENERATE
(
emm_comm⁄_d©a_m≠
, 
emm_comm⁄_d©a_s
, 
íåõs
,

116 
emm_comm⁄_d©a_com∑ª_ueid
);

118 
ölöe


119 
	$emm_comm⁄_d©a_com∑ª_ueid
(
emm_comm⁄_d©a_s
 *
p1
,

120 
emm_comm⁄_d©a_s
 *
p2
)

122 i‡(
p1
->
ueid
 > 
p2
->ueid) {

125 i‡(
p1
->
ueid
 < 
p2
->ueid) {

130 
	}
}

132 
emm_comm⁄_d©a_s
 *
	$emm_comm⁄_d©a_c⁄ãxt_gë
(

133 
emm_comm⁄_d©a_hód_s
 *
roŸ
, 
_ueid
)

135 
emm_comm⁄_d©a_s
 
ª„ªn˚
;

137 
	`DevAs£π
(
roŸ
 !
NULL
);

138 
	`DevCheck
(
_ueid
 > 0, _ueid, 0, 0);

140 
	`mem£t
(&
ª„ªn˚
, 0, (
emm_comm⁄_d©a_s
));

141 
ª„ªn˚
.
ueid
 = 
_ueid
;

142  
	`RB_FIND
(
emm_comm⁄_d©a_m≠
, &
roŸ
->
emm_comm⁄_d©a_roŸ
, &
ª„ªn˚
);

143 
	}
}

145 
emm_comm⁄_d©a_t
 *
	g_emm_comm⁄_d©a
[
EMM_DATA_NB_UE_MAX
];

176 
	$emm_¥oc_comm⁄_öôülize
(
ueid
,

177 
emm_comm⁄_suc˚ss_ˇŒback_t
 
_suc˚ss
,

178 
emm_comm⁄_ªje˘_ˇŒback_t
 
_ªje˘
,

179 
emm_comm⁄_Áûuª_ˇŒback_t
 
_Áûuª
,

180 
emm_comm⁄_ab‹t_ˇŒback_t
 
_ab‹t
,

181 *
¨gs
)

183 
emm_comm⁄_d©a_s
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

184 
LOG_FUNC_IN
;

186 #i‡
	`deföed
(
EPC_BUILD
)

187 
	`as£π
(
ueid
 > 0);

188 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

190 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

193 i‡(
emm_comm⁄_d©a_˘x
 =
NULL
) {

194 
emm_comm⁄_d©a_˘x
 = (
emm_comm⁄_d©a_t
 *)
	`mÆloc
((emm_common_data_t));

195 
emm_comm⁄_d©a_˘x
->
ueid
 = ueid;

196 #i‡
	`deföed
(
EPC_BUILD
)

197 
	`RB_INSERT
(
emm_comm⁄_d©a_m≠
, &
emm_comm⁄_d©a_hód
.
emm_comm⁄_d©a_roŸ
,

198 
emm_comm⁄_d©a_˘x
);

200 i‡(
emm_comm⁄_d©a_˘x
) {

201 
emm_comm⁄_d©a_˘x
->
ªf_cou¡
 = 0;

204 i‡(
emm_comm⁄_d©a_˘x
) {

205 
emm_comm⁄_d©a_˘x
->
ªf_cou¡
 += 1;

206 
emm_comm⁄_d©a_˘x
->
suc˚ss
 = 
_suc˚ss
;

207 
emm_comm⁄_d©a_˘x
->
ªje˘
 = 
_ªje˘
;

208 
emm_comm⁄_d©a_˘x
->
Áûuª
 = 
_Áûuª
;

209 
emm_comm⁄_d©a_˘x
->
ab‹t
 = 
_ab‹t
;

210 
emm_comm⁄_d©a_˘x
->
¨gs
 =árgs;

211 
	`LOG_FUNC_RETURN
(
RETURNok
);

214 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

215 
	}
}

234 
	$emm_¥oc_comm⁄_suc˚ss
(
ueid
)

236 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

237 
emm_comm⁄_suc˚ss_ˇŒback_t
 
emm_ˇŒback
;

239 
rc
 = 
RETURNîr‹
;

241 
LOG_FUNC_IN
;

243 #i‡
	`deföed
(
EPC_BUILD
)

244 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

245 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

247 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

248 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

251 
	`as£π
(
emm_comm⁄_d©a_˘x
 !
NULL
);

253 
emm_ˇŒback
 = 
emm_comm⁄_d©a_˘x
->
suc˚ss
;

254 i‡(
emm_ˇŒback
) {

255 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

257 #i‡
	`deföed
(
EPC_BUILD
)

258 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

260 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

262 
rc
 = (*
emm_ˇŒback
)(
˘x
);

265 
	`_emm_comm⁄_˛ónup
(
ueid
);

267 
	`LOG_FUNC_RETURN
(
rc
);

268 
	}
}

287 
	$emm_¥oc_comm⁄_ªje˘
(
ueid
)

289 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

290 
rc
 = 
RETURNîr‹
;

291 
emm_comm⁄_ªje˘_ˇŒback_t
 
emm_ˇŒback
;

293 
LOG_FUNC_IN
;

295 #i‡
	`deföed
(
EPC_BUILD
)

296 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

297 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

299 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

300 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

303 
	`as£π
(
emm_comm⁄_d©a_˘x
 !
NULL
);

305 
emm_ˇŒback
 = 
emm_comm⁄_d©a_˘x
->
ªje˘
;

307 i‡(
emm_ˇŒback
) {

308 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

310 #i‡
	`deföed
(
EPC_BUILD
)

311 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

313 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

315 
rc
 = (*
emm_ˇŒback
)(
˘x
);

318 
	`_emm_comm⁄_˛ónup
(
ueid
);

320 
	`LOG_FUNC_RETURN
(
rc
);

321 
	}
}

341 
	$emm_¥oc_comm⁄_Áûuª
(
ueid
)

343 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

344 
emm_comm⁄_Áûuª_ˇŒback_t
 
emm_ˇŒback
;

346 
rc
 = 
RETURNîr‹
;

348 
LOG_FUNC_IN
;

350 #i‡
	`deföed
(
EPC_BUILD
)

351 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

352 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

354 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

355 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

357 
	`as£π
(
emm_comm⁄_d©a_˘x
 !
NULL
);

359 
emm_ˇŒback
 = 
emm_comm⁄_d©a_˘x
->
Áûuª
;

360 i‡(
emm_ˇŒback
) {

361 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

363 #i‡
	`deföed
(
EPC_BUILD
)

364 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

366 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

368 
rc
 = (*
emm_ˇŒback
)(
˘x
);

371 
	`_emm_comm⁄_˛ónup
(
ueid
);

373 
	`LOG_FUNC_RETURN
(
rc
);

374 
	}
}

393 
	$emm_¥oc_comm⁄_ab‹t
(
ueid
)

395 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

396 
emm_comm⁄_Áûuª_ˇŒback_t
 
emm_ˇŒback
;

398 
rc
 = 
RETURNîr‹
;

400 
LOG_FUNC_IN
;

402 #i‡
	`deföed
(
EPC_BUILD
)

403 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

404 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

406 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

407 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

409 
	`as£π
(
emm_comm⁄_d©a_˘x
 !
NULL
);

411 
emm_ˇŒback
 = 
emm_comm⁄_d©a_˘x
->
ab‹t
;

412 i‡(
emm_ˇŒback
) {

413 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

415 #i‡
	`deföed
(
EPC_BUILD
)

416 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

418 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

420 
rc
 = (*
emm_ˇŒback
)(
˘x
);

423 
	`_emm_comm⁄_˛ónup
(
ueid
);

425 
	`LOG_FUNC_RETURN
(
rc
);

426 
	}
}

444 *
	$emm_¥oc_comm⁄_gë_¨gs
(
ueid
)

446 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

447 
LOG_FUNC_IN
;

449 #i‡
	`deföed
(
EPC_BUILD
)

450 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

451 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

453 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

454 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

456 
	`as£π
(
emm_comm⁄_d©a_˘x
 !
NULL
);

458 
	`LOG_FUNC_RETURN
(
emm_comm⁄_d©a_˘x
->
¨gs
);

459 
	}
}

482 
	$_emm_comm⁄_˛ónup
(
ueid
)

484 
emm_comm⁄_d©a_t
 *
emm_comm⁄_d©a_˘x
 = 
NULL
;

486 #i‡
	`deföed
(
EPC_BUILD
)

487 
	`DevCheck
(
ueid
 > 0, ueid, 0, 0);

488 
emm_comm⁄_d©a_˘x
 = 
	`emm_comm⁄_d©a_c⁄ãxt_gë
(&
emm_comm⁄_d©a_hód
, 
ueid
);

490 
	`as£π
(
ueid
 < 
EMM_DATA_NB_UE_MAX
);

491 
emm_comm⁄_d©a_˘x
 = 
_emm_comm⁄_d©a
[
ueid
];

494 i‡(
emm_comm⁄_d©a_˘x
) {

495 
emm_comm⁄_d©a_˘x
->
ªf_cou¡
 -= 1;

496 i‡(
emm_comm⁄_d©a_˘x
->
ªf_cou¡
 == 0) {

498 #i‡
	`deföed
(
EPC_BUILD
)

499 
	`RB_REMOVE
(
emm_comm⁄_d©a_m≠
,

500 &
emm_comm⁄_d©a_hód
.
emm_comm⁄_d©a_roŸ
,

501 
emm_comm⁄_d©a_˘x
);

503 
	`‰ì
(
emm_comm⁄_d©a_˘x
);

504 
emm_comm⁄_d©a_˘x
 = 
NULL
;

507 
	}
}

	@src/emm/EmmCommon.h

55 #i‚de‡
__EMM_COMMON_H__


56 
	#__EMM_COMMON_H__


	)

75 (*
	temm_comm⁄_suc˚ss_ˇŒback_t
)(*);

76 (*
	temm_comm⁄_ªje˘_ˇŒback_t
) (*);

77 (*
	temm_comm⁄_Áûuª_ˇŒback_t
)(*);

85 (*
	temm_comm⁄_ab‹t_ˇŒback_t
)(*);

95 
	`emm_¥oc_comm⁄_öôülize
(
ueid
,

96 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

97 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

98 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
,

99 
emm_comm⁄_ab‹t_ˇŒback_t
 
ab‹t
,

100 *
¨gs
);

102 
	`emm_¥oc_comm⁄_suc˚ss
(
ueid
);

103 
	`emm_¥oc_comm⁄_ªje˘
(
ueid
);

104 
	`emm_¥oc_comm⁄_Áûuª
(
ueid
);

105 
	`emm_¥oc_comm⁄_ab‹t
(
ueid
);

107 *
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
);

	@src/emm/EmmStatusHdl.c

52 
	~"emm_¥oc.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~"emm_ˇu£.h
"

57 
	~"emmD©a.h
"

59 
	~"emm_ßp.h
"

93 
	$emm_¥oc_°©us_öd
(
ueid
, 
emm_ˇu£
)

95 
LOG_FUNC_IN
;

97 
rc
;

99 
	`LOG_TRACE
(
INFO
,"EMM-PROC - EMM statusÖrocedureÑequested (cause=%d)",

100 
emm_ˇu£
);

102 
	`LOG_TRACE
(
DEBUG
, "EMM-PROC - To be implemented");

105 
rc
 = 
RETURNok
;

107 
	`LOG_FUNC_RETURN
 (
rc
);

108 
	}
}

125 
	$emm_¥oc_°©us
(
ueid
, 
emm_ˇu£
)

127 
LOG_FUNC_IN
;

129 
rc
;

130 
emm_ßp_t
 
emm_ßp
;

132 
emm_£curôy_c⁄ãxt_t
 *
s˘x
 = 
NULL
;

133 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

135 
	`LOG_TRACE
(
INFO
,"EMM-PROC - EMM statusÖrocedureÑequested");

140 
emm_ßp
.
¥imôive
 = 
EMMAS_STATUS_IND
;

141 
emm_ßp
.
u
.
emm_as
.u.
°©us
.
emm_ˇu£
 =Émm_cause;

142 
emm_ßp
.
u
.
emm_as
.u.
°©us
.
ueid
 = ueid;

144 #ifde‡
NAS_UE


145 
emm_ßp
.
u
.
emm_as
.u.
°©us
.
guti
 = 
_emm_d©a
.guti;

146 
s˘x
 = 
_emm_d©a
.
£curôy
;

148 #ifde‡
NAS_MME


149 
emm_ßp
.
u
.
emm_as
.u.
°©us
.
guti
 = 
NULL
;

150 #i‡
	`deföed
(
EPC_BUILD
)

151 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

153 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

155 i‡(
˘x
) {

156 
s˘x
 = 
˘x
->
£curôy
;

160 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
°©us
.
s˘x
, sctx,

161 
FALSE
, 
TRUE
);

163 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

165 
	`LOG_FUNC_RETURN
 (
rc
);

166 
	}
}

	@src/emm/Identification.c

51 
	~"emm_¥oc.h
"

52 
	~"«s_log.h
"

53 
	~"«s_timî.h
"

55 
	~"emmD©a.h
"

57 
	~"emm_ßp.h
"

59 
	~<°dlib.h
>

60 
	~<°rög.h
>

71 c⁄° *
	g_emm_idítôy_ty≥_°r
[] = {

80 #ifde‡
NAS_UE


88 #ifde‡
NAS_MME


92 *
_idítifiˇti⁄_t3470_h™dÀr
(*);

99 
_idítifiˇti⁄_ab‹t
(*);

105 
	mueid
;

106 
	#IDENTIFICATION_COUNTER_MAX
 5

	)

107 
	mªå™smissi⁄_cou¡
;

108 
emm_¥oc_idítôy_ty≥_t
 
	mty≥
;

109 
	mnŸify_Áûuª
;

112 } 
	tidítifiˇti⁄_d©a_t
;

114 
_idítifiˇti⁄_ªque°
(
idítifiˇti⁄_d©a_t
 *
d©a
);

126 #ifde‡
NAS_UE


147 
	$emm_¥oc_idítifiˇti⁄_ªque°
(
emm_¥oc_idítôy_ty≥_t
 
ty≥
)

149 
LOG_FUNC_IN
;

151 
rc
;

152 
emm_ßp_t
 
emm_ßp
;

154 
	`LOG_TRACE
(
INFO
, "EMM-PROC - IdentificationÑequestedÅype = %s (%d)",

155 
_emm_idítôy_ty≥_°r
[
ty≥
],Åype);

159 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

160 i‡(
rc
 !
RETURNok
) {

161 
	`LOG_TRACE
(
WARNING
,

163 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

166 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
idítTy≥
 = 
EMM_IDENT_TYPE_NOT_AVAILABLE
;

168 
ty≥
) {

169 
EMM_IDENT_TYPE_IMSI
:

171 
imsi_t
 
modifõd_imsi
;

174 i‡(
_emm_d©a
.
imsi
) {

175 
	`mem˝y
 (&
modifõd_imsi
, 
_emm_d©a
.
imsi
,  (modified_imsi));

178 i‡(
modifõd_imsi
.
u
.
num
.
digô6
 == 0xF)

180 
modifõd_imsi
.
u
.
num
.
digô6
 = 0;

182 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
idítTy≥
 = 
EMM_IDENT_TYPE_IMSI
;

183 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
 = &
modifõd_imsi
;

185 
	`LOG_TRACE
(
INFO
, "EMM-PROC - IMSI = %u%u%u %u%u%u %u%u%u%u%x%x%x%x%x",

186 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô1
,

187 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô2
,

188 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô3
,

190 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô4
,

191 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô5
,

192 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô6
,

194 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô7
,

195 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô8
,

196 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô9
,

197 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô10
,

198 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô11
,

199 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô12
,

200 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô13
,

201 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô14
,

202 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imsi
->u.
num
.
digô15
);

207 
EMM_IDENT_TYPE_IMEI
:

209 i‡(
_emm_d©a
.
imei
) {

210 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
idítTy≥
 = 
EMM_IDENT_TYPE_IMEI
;

211 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
imei
 = 
_emm_d©a
.imei;

215 
EMM_IDENT_TYPE_TMSI
:

217 i‡(
_emm_d©a
.
guti
) {

218 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
idítTy≥
 = 
EMM_IDENT_TYPE_TMSI
;

219 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
tmsi
 = 
_emm_d©a
.
guti
->
m_tmsi
;

232 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_RES
;

233 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
_emm_d©a
.guti;

234 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 0;

235 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_IDENT
;

237 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

238 
_emm_d©a
.
£curôy
, 
FALSE
, 
TRUE
);

239 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

241 
	`LOG_FUNC_RETURN
 (
rc
);

242 
	}
}

250 #ifde‡
NAS_MME


280 
	$emm_¥oc_idítifiˇti⁄
(
ueid
,

281 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
,

282 
emm_¥oc_idítôy_ty≥_t
 
ty≥
,

283 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

284 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

285 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
)

287 
LOG_FUNC_IN
;

289 
rc
 = 
RETURNîr‹
;

291 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate identificationÅype = %s (%d), ctx = %p",

292 
_emm_idítôy_ty≥_°r
[
ty≥
],Åy≥, 
emm_˘x
);

295 
idítifiˇti⁄_d©a_t
 *
d©a
 =

296 (
idítifiˇti⁄_d©a_t
 *)
	`mÆloc
((identification_data_t));

298 i‡(
d©a
 !
NULL
) {

300 
rc
 = 
	`emm_¥oc_comm⁄_öôülize
(
ueid
, 
suc˚ss
, 
ªje˘
, 
Áûuª
,

301 
_idítifiˇti⁄_ab‹t
, 
d©a
);

302 i‡(
rc
 !
RETURNok
) {

303 
	`LOG_TRACE
(
WARNING
, "FailedÅo initialize EMM callback functions");

304 
	`‰ì
(
d©a
);

305 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

308 
d©a
->
ueid
 = ueid;

310 
d©a
->
ªå™smissi⁄_cou¡
 = 0;

312 
d©a
->
ty≥
 =Åype;

314 
d©a
->
nŸify_Áûuª
 = 
FALSE
;

316 
rc
 = 
	`_idítifiˇti⁄_ªque°
(
d©a
);

317 i‡(
rc
 !
RETURNîr‹
) {

321 
emm_ßp_t
 
emm_ßp
;

322 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REQ
;

323 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

324 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

325 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

329 
	`LOG_FUNC_RETURN
 (
rc
);

330 
	}
}

354 
	$emm_¥oc_idítifiˇti⁄_com∂ëe
(
ueid
, c⁄° 
imsi_t
 *
imsi
,

355 c⁄° 
imei_t
 *
imei
, 
UI¡32_t
 *
tmsi
)

357 
rc
 = 
RETURNîr‹
;

358 
emm_ßp_t
 
emm_ßp
;

360 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

362 
LOG_FUNC_IN
;

364 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Idítifiˇti⁄ com∂ëê(ueid=%u)", 
ueid
);

367 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3470 (%d)", 
T3470
.
id
);

368 
T3470
.
id
 = 
	`«s_timî_°›
(T3470.id);

371 
idítifiˇti⁄_d©a_t
 *
d©a
 =

372 (
idítifiˇti⁄_d©a_t
 *)(
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
));

373 i‡(
d©a
) {

374 
	`‰ì
(
d©a
);

378 #i‡
	`deföed
(
EPC_BUILD
)

379 i‡(
ueid
 > 0) {

380 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

383 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

384 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

388 i‡(
emm_˘x
) {

389 i‡(
imsi
) {

391 i‡(
emm_˘x
->
imsi
 =
NULL
) {

392 
emm_˘x
->
imsi
 = (
imsi_t
 *)
	`mÆloc
((imsi_t));

394 i‡(
emm_˘x
->
imsi
) {

395 
	`mem˝y
(
emm_˘x
->
imsi
, imsi, (
imsi_t
));

397 } i‡(
imei
) {

399 i‡(
emm_˘x
->
imei
 =
NULL
) {

400 
emm_˘x
->
imei
 = (
imei_t
 *)
	`mÆloc
((imei_t));

402 i‡(
emm_˘x
->
imei
) {

403 
	`mem˝y
(
emm_˘x
->
imei
, imei, (
imei_t
));

405 } i‡(
tmsi
) {

407 i‡(
emm_˘x
->
guti
 =
NULL
) {

408 
emm_˘x
->
guti
 = (
GUTI_t
 *)
	`mÆloc
((GUTI_t));

410 i‡(
emm_˘x
->
guti
) {

411 
	`mem˝y
(&
emm_˘x
->
guti
->
gummei
,

412 &
_emm_d©a
.
c⁄f
.
gummei
, (
gummei_t
));

413 
emm_˘x
->
guti
->
m_tmsi
 = *
tmsi
;

419 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_CNF
;

420 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

421 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

422 
emm_ßp
.
u
.
emm_ªg
.u.
comm⁄
.
is_©èched
 = 
emm_˘x
->is_attached;

424 
	`LOG_TRACE
(
ERROR
, "EMM-PROC - No EMM contextÉxists");

428 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

429 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

430 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

433 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

435 
	`LOG_FUNC_RETURN
 (
rc
);

436 
	}
}

444 #ifde‡
NAS_MME


471 *
	$_idítifiˇti⁄_t3470_h™dÀr
(*
¨gs
)

473 
LOG_FUNC_IN
;

475 
rc
;

477 
idítifiˇti⁄_d©a_t
 *
d©a
 = (idítifiˇti⁄_d©a_à*)(
¨gs
);

480 
d©a
->
ªå™smissi⁄_cou¡
 += 1;

482 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3470ÅimerÉxpired,Ñetransmission "

483 "cou¡î = %d", 
d©a
->
ªå™smissi⁄_cou¡
);

485 i‡(
d©a
->
ªå™smissi⁄_cou¡
 < 
IDENTIFICATION_COUNTER_MAX
) {

487 
rc
 = 
	`_idítifiˇti⁄_ªque°
(
d©a
);

490 
d©a
->
nŸify_Áûuª
 = 
TRUE
;

492 
rc
 = 
	`_idítifiˇti⁄_ab‹t
(
d©a
);

495 
	`LOG_FUNC_RETURN
 (
NULL
);

496 
	}
}

518 
	$_idítifiˇti⁄_ªque°
(
idítifiˇti⁄_d©a_t
 *
d©a
)

520 
emm_ßp_t
 
emm_ßp
;

521 
rc
;

523 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

525 
LOG_FUNC_IN
;

531 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_REQ
;

532 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
NULL
;

533 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 
d©a
->ueid;

534 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_IDENT
;

535 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
idítTy≥
 = 
d©a
->
ty≥
;

537 #i‡
	`deföed
(
EPC_BUILD
)

538 i‡(
d©a
->
ueid
 > 0) {

539 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
d©a
->
ueid
);

542 i‡(
d©a
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

543 
emm_˘x
 = 
_emm_d©a
.
˘x
[
d©a
->
ueid
];

547 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

548 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

549 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

551 i‡(
rc
 !
RETURNîr‹
) {

552 i‡(
T3470
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

554 
T3470
.
id
 = 
	`«s_timî_ª°¨t
(T3470.id);

557 
T3470
.
id
 = 
	`«s_timî_°¨t
(T3470.
£c
, 
_idítifiˇti⁄_t3470_h™dÀr
,

558 
d©a
);

560 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3470 (%d)Éxpires in %ld seconds",

561 
T3470
.
id
, T3470.
£c
);

564 
	`LOG_FUNC_RETURN
 (
rc
);

565 
	}
}

581 
	$_idítifiˇti⁄_ab‹t
(*
¨gs
)

583 
LOG_FUNC_IN
;

585 
rc
 = 
RETURNîr‹
;

587 
idítifiˇti⁄_d©a_t
 *
d©a
 = (idítifiˇti⁄_d©a_à*)(
¨gs
);

589 i‡(
d©a
) {

590 
ueid
 = 
d©a
->ueid;

591 
nŸify_Áûuª
 = 
d©a
->notify_failure;

593 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Abort identificationÖrocedure "

594 "(ueid=%u)", 
ueid
);

597 i‡(
T3470
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

598 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3470 (%d)", 
T3470
.
id
);

599 
T3470
.
id
 = 
	`«s_timî_°›
(T3470.id);

602 
	`‰ì
(
d©a
);

607 i‡(
nŸify_Áûuª
) {

608 
emm_ßp_t
 
emm_ßp
;

609 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

610 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

611 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

613 
rc
 = 
RETURNok
;

617 
	`LOG_FUNC_RETURN
(
rc
);

618 
	}
}

	@src/emm/IdleMode.c

66 #ifde‡
NAS_UE


68 
	~"emm_¥oc.h
"

69 
	~"«s_log.h
"

71 
	~"emm_ßp.h
"

73 
	~"IdÀMode.h
"

74 
	~"emmD©a.h
"

76 
	~<as£π.h
>

77 
	~<°dio.h
>

78 
	~<°rög.h
>

88 
_IdÀMode_∂mn_°r
(*
∂mn_°r
, c⁄° 
∂mn_t
 *
∂mn
);

89 
_IldlMode_gë_›¬_id
(c⁄° 
∂mn_t
 *
∂mn
);

90 
_IdÀMode_gë_suôabÀ_˚Œ
(
ödex
);

119 
	mn_∂mns
;

120 
	#EMM_PLMN_LIST_SIZE
 (
EMM_DATA_EPLMN_MAX
 + 
EMM_DATA_PLMN_MAX
 + \

121 
EMM_DATA_OPLMN_MAX
 + 2)

	)

122 
∂mn_t
 *
	m∂mn
[
EMM_PLMN_LIST_SIZE
];

123 
	mödex
;

124 
	mh∂mn
;

126 
	mÂlmn
;

127 
	m•lmn
;

128 
	mΩlmn
;

129 
	s∂mn_∑øm_t
 {

130 
	mfuŒ«me
[
NET_FORMAT_LONG_SIZE
+1];

131 
	msh‹äame
[
NET_FORMAT_SHORT_SIZE
+1];

132 
	mnum
[
NET_FORMAT_NUM_SIZE
+1];

133 
	m°©
;

134 
	mèc
;

135 
	mci
;

136 
	møt
;

137 } 
	m∑øm
[
EMM_PLMN_LIST_SIZE
];

138 } 
	g_emm_∂mn_li°
;

141 
IdÀMode_ˇŒback_t
 
	g_emm_ödiˇti⁄_nŸify
;

163 
	$IdÀMode_öôülize
(
IdÀMode_ˇŒback_t
 
cb
)

166 
_emm_∂mn_li°
.
n_∂mns
 = 0;

167 
_emm_∂mn_li°
.
ödex
 = 0;

168 
_emm_∂mn_li°
.
h∂mn
 = -1;

169 
_emm_∂mn_li°
.
Âlmn
 = -1;

170 
_emm_∂mn_li°
.
•lmn
 = -1;

171 
_emm_∂mn_li°
.
Ωlmn
 = -1;

174 
_emm_ödiˇti⁄_nŸify
 = *
cb
;

177 
	`emm_ßp_öôülize
();

178 
	}
}

201 
	$IdÀMode_gë_nb_∂mns
()

203  
_emm_∂mn_li°
.
n_∂mns
;

204 
	}
}

222 
	$IdÀMode_gë_h∂mn_ödex
()

224  
_emm_∂mn_li°
.
h∂mn
;

225 
	}
}

243 
	$IdÀMode_gë_Ωlmn_ödex
()

245  
_emm_∂mn_li°
.
Ωlmn
;

246 
	}
}

263 
	$IdÀMode_gë_•lmn_ödex
()

265  
_emm_∂mn_li°
.
•lmn
;

266 
	}
}

283 
	$IdÀMode_upd©e_∂mn_li°
(
i
)

285 
off£t
 = 0;

286 
n
 = 1;

288  (
i
 < 
_emm_∂mn_li°
.
n_∂mns
Ë&& (
off£t
 < 
EMM_DATA_BUFFER_SIZE
) ) {

289 
∂mn_∑øm_t
 *
∂mn
 = &(
_emm_∂mn_li°
.
∑øm
[
i
++]);

290 i‡(
n
++ > 1) {

291 
off£t
 +
	`¢¥ötf
(
_emm_d©a
.
∂i°
.
buf„r
 + offset,

292 
EMM_DATA_BUFFER_SIZE
 - 
off£t
, ",");

294 
off£t
 +
	`¢¥ötf
(
_emm_d©a
.
∂i°
.
buf„r
 + offset,

295 
EMM_DATA_BUFFER_SIZE
 - 
off£t
, "(%d,%s,%s,%s",

296 
∂mn
->
°©
,Ölmn->
fuŒ«me
,

297 
∂mn
->
sh‹äame
,Ölmn->
num
);

298 i‡(
∂mn
->
øt
 !
NET_ACCESS_UNAVAILABLE
) {

299 
off£t
 +
	`¢¥ötf
(
_emm_d©a
.
∂i°
.
buf„r
 + offset,

300 
EMM_DATA_BUFFER_SIZE
 - 
off£t
, ",%d",

301 
∂mn
->
øt
);

303 
off£t
 +
	`¢¥ötf
(
_emm_d©a
.
∂i°
.
buf„r
 + offset,

304 
EMM_DATA_BUFFER_SIZE
 - 
off£t
, ")");

307  (
off£t
);

308 
	}
}

327 c⁄° *
	$IdÀMode_gë_∂mn_fuŒ«me
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

328 
size_t
 *
Àn
)

330 i‡(
ödex
 < 
_emm_∂mn_li°
.
n_∂mns
) {

331 
	`as£π
–
	`PLMNS_ARE_EQUAL
(*
∂mn
, *
_emm_∂mn_li°
.∂mn[
ödex
]) );

332 *
Àn
 = 
	`°æí
(
_emm_∂mn_li°
.
∑øm
[
ödex
].
fuŒ«me
);

333  
_emm_∂mn_li°
.
∑øm
[
ödex
].
fuŒ«me
;

335  
NULL
;

336 
	}
}

355 c⁄° *
	$IdÀMode_gë_∂mn_sh‹äame
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

356 
size_t
 *
Àn
)

358 i‡(
ödex
 < 
_emm_∂mn_li°
.
n_∂mns
) {

359 
	`as£π
–
	`PLMNS_ARE_EQUAL
(*
∂mn
, *
_emm_∂mn_li°
.∂mn[
ödex
]) );

360 *
Àn
 = 
	`°æí
(
_emm_∂mn_li°
.
∑øm
[
ödex
].
sh‹äame
);

361  
_emm_∂mn_li°
.
∑øm
[
ödex
].
sh‹äame
;

363  
NULL
;

364 
	}
}

384 c⁄° *
	$IdÀMode_gë_∂mn_id
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
, 
size_t
 *
Àn
)

386 i‡(
ödex
 < 
_emm_∂mn_li°
.
n_∂mns
) {

387 
	`as£π
–
	`PLMNS_ARE_EQUAL
(*
∂mn
, *
_emm_∂mn_li°
.∂mn[
ödex
]) );

388 *
Àn
 = 
	`°æí
(
_emm_∂mn_li°
.
∑øm
[
ödex
].
num
);

389  
_emm_∂mn_li°
.
∑øm
[
ödex
].
num
;

391  
NULL
;

392 
	}
}

410 
	$IdÀMode_gë_∂mn_fuŒ«me_ödex
(c⁄° *
∂mn
)

412 
ödex
;

415 
ödex
 = 0; index < 
_emm_∂mn_li°
.
n_∂mns
; index++) {

416 i‡–
	`°∫cmp
(
∂mn
, 
_emm_∂mn_li°
.
∑øm
[
ödex
].
fuŒ«me
,

417 
NET_FORMAT_LONG_SIZE
) != 0 ) {

420  (
ödex
);

423 
	}
}

441 
	$IdÀMode_gë_∂mn_sh‹äame_ödex
(c⁄° *
∂mn
)

443 
ödex
;

446 
ödex
 = 0; index < 
_emm_∂mn_li°
.
n_∂mns
; index++) {

447 i‡–!
	`°∫cmp
(
∂mn
, 
_emm_∂mn_li°
.
∑øm
[
ödex
].
sh‹äame
,

448 
NET_FORMAT_SHORT_SIZE
) ) {

451  (
ödex
);

454 
	}
}

472 
	$IdÀMode_gë_∂mn_id_ödex
(c⁄° *
∂mn
)

474 
ödex
;

477 
ödex
 = 0; index < 
_emm_∂mn_li°
.
n_∂mns
; index++) {

478 i‡–!
	`°∫cmp
(
∂mn
, 
_emm_∂mn_li°
.
∑øm
[
ödex
].
num
,

479 
NET_FORMAT_LONG_SIZE
) ) {

482  (
ödex
);

485 
	}
}

508 
	$emm_¥oc_öôülize
()

510 
LOG_FUNC_IN
;

512 
emm_ßp_t
 
emm_ßp
;

513 
rc
;

514 
i
;

516 i‡(!
_emm_d©a
.
usim_is_vÆid
) {

518 
	`LOG_TRACE
(
WARNING
, "EMM-IDLE - USIM isÇot valid");

519 
emm_ßp
.
¥imôive
 = 
EMMREG_NO_IMSI
;

523 i‡(
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 > 0) {

524 
i
=0; i < 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
; i++) {

525 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] =

526 &
_emm_d©a
.
nvd©a
.
ïlmn
.
∂mn
[
i
];

528 } i‡–
	`PLMN_IS_VALID
(
_emm_d©a
.
nvd©a
.
Ωlmn
) ) {

529 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] =

530 &
_emm_d©a
.
nvd©a
.
Ωlmn
;

537 
_emm_∂mn_li°
.
h∂mn
 = _emm_∂mn_li°.
n_∂mns
 - 1;

542 i‡(
_emm_d©a
.
eh∂mn
.
n_∂mns
 > 0) {

543 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] =

544 &
_emm_d©a
.
eh∂mn
.
∂mn
[0];

546 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] = &
_emm_d©a
.
h∂mn
;

551 
i
=0; i < 
_emm_d©a
.
∂mn
.
n_∂mns
; i++) {

552 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] =

553 &
_emm_d©a
.
∂mn
.∂mn[
i
];

558 
i
=0; i < 
_emm_d©a
.
›lmn
.
n_∂mns
; i++) {

559 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
++] =

560 &
_emm_d©a
.
›lmn
.
∂mn
[
i
];

572 
i
=0; i < 
_emm_∂mn_li°
.
n_∂mns
; i++) {

573 
∂mn_∑øm_t
 *
∂mn
 = &(
_emm_∂mn_li°
.
∑øm
[
i
]);

574 
id
 = 
	`_IldlMode_gë_›¬_id
(
_emm_∂mn_li°
.
∂mn
[
i
]);

575 i‡(
id
 < 0) {

576 
∂mn
->
fuŒ«me
[0] = '\0';

577 
∂mn
->
sh‹äame
[0] = '\0';

579 
	`°∫˝y
(
∂mn
->
fuŒ«me
, 
_emm_d©a
.
›¬
[
id
].fullname,

580 
NET_FORMAT_LONG_SIZE
);

581 
	`°∫˝y
(
∂mn
->
sh‹äame
, 
_emm_d©a
.
›¬
[
id
].shortname,

582 
NET_FORMAT_SHORT_SIZE
);

584 ()
	`_IdÀMode_∂mn_°r
(
∂mn
->
num
, 
_emm_∂mn_li°
.∂mn[
i
]);

585 
∂mn
->
°©
 = 
NET_OPER_UNKNOWN
;

586 
∂mn
->
èc
 = 0;

587 
∂mn
->
ci
 = 0;

588 
∂mn
->
øt
 = 
NET_ACCESS_UNAVAILABLE
;

591 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - %d PLMNsávailable forÇetwork selection",

592 
_emm_∂mn_li°
.
n_∂mns
);

595 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_REQ
;

596 
emm_ßp
.
u
.
emm_ªg
.u.
ªgi°
.
ödex
 = 0;

599 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

601 
	`LOG_FUNC_RETURN
(
rc
);

604 
	}
}

630 
	$emm_¥oc_∂mn_£À˘i⁄
(
ödex
)

632 
LOG_FUNC_IN
;

634 
rc
 = 
RETURNok
;

636 i‡(
_emm_d©a
.
∂mn_mode
 !
EMM_DATA_PLMN_AUTO
) {

641 i‡(
ödex
 >
_emm_∂mn_li°
.
h∂mn
) {

645 i‡(
_emm_d©a
.
∂mn_ödex
 < 0) {

650 
ödex
 = -1;

651 
rc
 = 
	`emm_¥oc_√tw‹k_nŸify
(
_emm_∂mn_li°
.
h∂mn
);

652 i‡(
rc
 !
RETURNok
) {

653 
	`LOG_TRACE
(
WARNING
, "EMM-IDLE - FailedÅoÇotify "

660 
ödex
 = 
_emm_d©a
.
∂mn_ödex
;

665 i‡–!(
ödex
 < 0) ) {

673 
_emm_∂mn_li°
.
ödex
 = index;

674 
rc
 = 
	`_IdÀMode_gë_suôabÀ_˚Œ
(
ödex
);

677 
	`LOG_FUNC_RETURN
 (
rc
);

678 
	}
}

716 
	$emm_¥oc_∂mn_£À˘i⁄_íd
(
found
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
)

718 
LOG_FUNC_IN
;

720 
emm_ßp_t
 
emm_ßp
;

721 
rc
 = 
RETURNîr‹
;

722 
ödex
 = 
_emm_∂mn_li°
.index;

723 
£À˘_√xt_∂mn
 = 
FALSE
;

725 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - %s cell found for PLMN %d in %s mode",

726 (
found
)? "O√" : "No", 
ödex
,

727 (
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_AUTO
)? "Automatic" :

728 (
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_MANUAL
)? "Manual" :

731 i‡(
found
) {

732 
is_f‹biddí
 = 
FALSE
;

735 
_emm_d©a
.
•lmn
 = *
_emm_∂mn_li°
.
∂mn
[
ödex
];

738 
_emm_∂mn_li°
.
∑øm
[
ödex
].
èc
 =Åac;

739 
_emm_∂mn_li°
.
∑øm
[
ödex
].
ci
 = ci;

740 
_emm_∂mn_li°
.
∑øm
[
ödex
].
øt
 =Ñat;

743 
rc
 = 
	`emm_¥oc_loˇti⁄_nŸify
(
èc
, 
ci
 , 
øt
);

744 i‡(
rc
 !
RETURNok
) {

745 
	`LOG_TRACE
(
WARNING
, "EMM-IDLE - FailedÅoÇotifyÜocation update");

748 i‡(
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_AUTO
) {

753 
i
;

756 
i
 = 0; i < 
_emm_d©a
.
Âlmn
.
n_∂mns
; i++) {

757 i‡(
	`PLMNS_ARE_EQUAL
(
_emm_d©a
.
•lmn
, _emm_d©a.
Âlmn
.
∂mn
[
i
])) {

758 
is_f‹biddí
 = 
TRUE
;

762 i‡(!
is_f‹biddí
) {

763 
i
 = 0; i < 
_emm_d©a
.
Âlmn_g¥s
.
n_∂mns
; i++) {

764 i‡(
	`PLMNS_ARE_EQUAL
(
_emm_d©a
.
•lmn
,

765 
_emm_d©a
.
Âlmn_g¥s
.
∂mn
[
i
])) {

766 
is_f‹biddí
 = 
TRUE
;

773 
èi_t
 
èi
;

774 
èi
.
∂mn
 = 
_emm_d©a
.
•lmn
;

775 
èi
.
èc
 =Åac;

776 i‡(!
is_f‹biddí
) {

777 
i
 = 0; i < 
_emm_d©a
.
·ai
.
n_èis
; i++) {

778 i‡(
	`TAIS_ARE_EQUAL
(
èi
, 
_emm_d©a
.
·ai
.èi[
i
])) {

779 
is_f‹biddí
 = 
TRUE
;

784 i‡(!
is_f‹biddí
) {

785 
i
 = 0; i < 
_emm_d©a
.
·ai_rﬂmög
.
n_èis
; i++) {

786 i‡(
	`TAIS_ARE_EQUAL
(
èi
, 
_emm_d©a
.
·ai_rﬂmög
.èi[
i
])) {

787 
is_f‹biddí
 = 
TRUE
;

794 i‡(
is_f‹biddí
) {

797 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - UE may camp onÅhisácceptable cell ",

801 i‡(
_emm_∂mn_li°
.
Âlmn
 < 0) {

802 
_emm_∂mn_li°
.
Âlmn
 = 
ödex
;

804 
_emm_∂mn_li°
.
∑øm
[
ödex
].
°©
 = 
NET_OPER_FORBIDDEN
;

808 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - UE may camp onÅhis suitable cell ",

810 
_emm_∂mn_li°
.
Âlmn
 = -1;

811 
_emm_∂mn_li°
.
∑øm
[
ödex
].
°©
 = 
NET_OPER_CURRENT
;

812 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_CNF
;

816 
_emm_∂mn_li°
.
∂mn
[_emm_∂mn_li°.
n_∂mns
] = &
_emm_d©a
.
•lmn
;

819 i‡(
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_AUTO
) {

826 
ödex
 += 1;

827 
£À˘_√xt_∂mn
 = 
TRUE
;

830 i‡(
ödex
 =
_emm_∂mn_li°
.
•lmn
) {

831 
ödex
 += 1;

835 i‡(
_emm_d©a
.
∂mn_ödex
 < 0) {

842 
ödex
 += 1;

843 
£À˘_√xt_∂mn
 = 
TRUE
;

846 i‡(
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_MANUAL
) {

852 
emm_ßp
.
¥imôive
 = 
EMMREG_NO_CELL
;

862 
_emm_d©a
.
∂mn_mode
 = 
EMM_DATA_PLMN_AUTO
;

863 
ödex
 = 
_emm_∂mn_li°
.
h∂mn
;

864 
£À˘_√xt_∂mn
 = 
TRUE
;

870 i‡(
£À˘_√xt_∂mn
) {

871 
œ°_∂mn_ödex
 = 
_emm_∂mn_li°
.
n_∂mns
;

872 i‡(
_emm_∂mn_li°
.
•lmn
 != -1) {

874 
œ°_∂mn_ödex
 += 1;

876 i‡(
ödex
 < 
œ°_∂mn_ödex
) {

878 
_emm_∂mn_li°
.
ödex
 = index;

879 
rc
 = 
	`emm_¥oc_∂mn_£À˘i⁄
(
ödex
);

883 
£À˘_√xt_∂mn
 = 
FALSE
;

884 
emm_ßp
.
¥imôive
 = 
EMMREG_NO_CELL
;

891 i‡(!
£À˘_√xt_∂mn
) {

892 i‡(!(
_emm_∂mn_li°
.
Âlmn
) < 0) {

898 
ödex
 = 
_emm_∂mn_li°
.
Âlmn
;

899 
_emm_∂mn_li°
.
Âlmn
 = -1;

900 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_REJ
;

903 i‡(
_emm_∂mn_li°
.
•lmn
 != -1) {

904 
_emm_∂mn_li°
.
∑øm
[_emm_∂mn_li°.
•lmn
].
°©
 = 
NET_OPER_UNKNOWN
;

907 i‡(
emm_ßp
.
¥imôive
 !
EMMREG_NO_CELL
) {

908 
_emm_∂mn_li°
.
•lmn
 = 
ödex
;

910 
_emm_∂mn_li°
.
•lmn
 = -1;

915 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

917 i‡(
_emm_∂mn_li°
.
•lmn
 != -1) {

918 i‡(
_emm_∂mn_li°
.
•lmn
 =_emm_∂mn_li°.
Ωlmn
) {

920 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - The selected PLMN isÅheÑegistered PLMN");

921 
_emm_d©a
.
is_Ωlmn
 = 
TRUE
;

922 } i‡(
_emm_∂mn_li°
.
•lmn
 < _emm_∂mn_li°.
h∂mn
) {

924 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - The selected PLMN is inÅheÜist ofÉquivalent PLMNs");

925 
_emm_d©a
.
is_ïlmn
 = 
TRUE
;

931 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_INIT
;

932 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

936 
	`LOG_FUNC_RETURN
 (
rc
);

937 
	}
}

961 
	$emm_¥oc_ªgi°øti⁄_nŸify
(
Sèt_t
 
°©us
)

963 
LOG_FUNC_IN
;

965 
rc
 = 
RETURNok
;

968 i‡(
_emm_d©a
.
°©
 !
°©us
) {

969 
_emm_d©a
.
°©
 = 
°©us
;

971 
rc
 = (*
_emm_ödiˇti⁄_nŸify
)(1);

974 
	`LOG_FUNC_RETURN
 (
rc
);

975 
	}
}

995 
	$emm_¥oc_loˇti⁄_nŸify
(
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
)

997 
LOG_FUNC_IN
;

999 
rc
 = 
RETURNok
;

1002 i‡–(
_emm_d©a
.
èc
 !=Åac) ||

1003 (
_emm_d©a
.
ci
 != ci) ||

1004 (
_emm_d©a
.
øt
 !=Ñat) ) {

1005 
_emm_d©a
.
èc
 =Åac;

1006 
_emm_d©a
.
ci
 = ci;

1007 
_emm_d©a
.
øt
 =Ñat;

1009 
rc
 = (*
_emm_ödiˇti⁄_nŸify
)(0);

1012 
	`LOG_FUNC_RETURN
 (
rc
);

1013 
	}
}

1032 
	$emm_¥oc_√tw‹k_nŸify
(
ödex
)

1034 
LOG_FUNC_IN
;

1037 
size
 = 
	`IdÀMode_upd©e_∂mn_li°
(
ödex
);

1039 
rc
 = (*
_emm_ödiˇti⁄_nŸify
)(
size
);

1041 
	`LOG_FUNC_RETURN
 (
rc
);

1042 
	}
}

1050 #ifde‡
NAS_UE


1067 
	$_IdÀMode_∂mn_°r
(*
∂mn_°r
, c⁄° 
∂mn_t
 *
∂mn
)

1069 *
p
 = 
∂mn_°r
;

1070 i‡(
∂mn
 =
NULL
) {

1074 i‡(
∂mn
->
MCCdigô1
 != 0x0F) {

1075 
	`•rötf
(
p
++, "%u", 
∂mn
->
MCCdigô1
);

1077 i‡(
∂mn
->
MCCdigô2
 != 0x0F) {

1078 
	`•rötf
(
p
++, "%u", 
∂mn
->
MCCdigô2
);

1080 i‡(
∂mn
->
MCCdigô3
 != 0x0F) {

1081 
	`•rötf
(
p
++, "%u", 
∂mn
->
MCCdigô3
);

1083 i‡(
∂mn
->
MNCdigô1
 != 0x0F) {

1084 
	`•rötf
(
p
++, "%u", 
∂mn
->
MNCdigô1
);

1086 i‡(
∂mn
->
MNCdigô2
 != 0x0F) {

1087 
	`•rötf
(
p
++, "%u", 
∂mn
->
MNCdigô2
);

1089 i‡(
∂mn
->
MNCdigô3
 != 0x0F) {

1090 
	`•rötf
(
p
++, "%u", 
∂mn
->
MNCdigô3
);

1093  (
p
 - 
∂mn_°r
);

1094 
	}
}

1113 
	$_IldlMode_gë_›¬_id
(c⁄° 
∂mn_t
 *
∂mn
)

1115 
i
;

1117 
i
 = 0; i < 
_emm_d©a
.
n_›¬s
; i++) {

1118 i‡(
∂mn
->
MCCdigô1
 !
_emm_d©a
.
›¬
[
i
].plmn->MCCdigit1) {

1121 i‡(
∂mn
->
MCCdigô2
 !
_emm_d©a
.
›¬
[
i
].plmn->MCCdigit2) {

1124 i‡(
∂mn
->
MCCdigô3
 !
_emm_d©a
.
›¬
[
i
].plmn->MCCdigit3) {

1127 i‡(
∂mn
->
MNCdigô1
 !
_emm_d©a
.
›¬
[
i
].plmn->MNCdigit1) {

1130 i‡(
∂mn
->
MNCdigô2
 !
_emm_d©a
.
›¬
[
i
].plmn->MNCdigit2) {

1133 i‡(
∂mn
->
MNCdigô3
 !
_emm_d©a
.
›¬
[
i
].plmn->MNCdigit3) {

1137  (
i
);

1141 
	}
}

1159 
	$_IdÀMode_gë_suôabÀ_˚Œ
(
ödex
)

1161 
emm_ßp_t
 
emm_ßp
;

1162 c⁄° 
∂mn_t
 *
∂mn
 = 
_emm_∂mn_li°
.∂mn[
ödex
];

1164 
	`LOG_TRACE
(
INFO
, "EMM-IDLE - TryingÅo searchá suitable cell "

1165 "o‡PLMN %d i¿%†mode", 
ödex
,

1166 (
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_AUTO
)? "Automatic" :

1167 (
_emm_d©a
.
∂mn_mode
 =
EMM_DATA_PLMN_MANUAL
)? "Manual" :

1173 
emm_ßp
.
¥imôive
 = 
EMMAS_CELL_INFO_REQ
;

1174 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
∂mnIDs
.
n_∂mns
 = 1;

1175 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
∂mnIDs
.
∂mn
[0] = *plmn;

1176 i‡(
_emm_d©a
.
∂mn_øt
 !
NET_ACCESS_UNAVAILABLE
) {

1177 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
øt
 = (1 << 
_emm_d©a
.
∂mn_øt
);

1179 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
øt
 = 
NET_ACCESS_UNAVAILABLE
;

1182  
	`emm_ßp_£nd
(&
emm_ßp
);

1183 
	}
}

	@src/emm/IdleMode.h

47 #i‚de‡
__IDLEMODE_H__


48 
	#__IDLEMODE_H__


	)

50 
	~"comm⁄Def.h
"

60 (*
	tIdÀMode_ˇŒback_t
) ();

70 
	`IdÀMode_öôülize
(
IdÀMode_ˇŒback_t
 
cb
);

72 
	`IdÀMode_gë_nb_∂mns
();

73 
	`IdÀMode_gë_h∂mn_ödex
();

74 
	`IdÀMode_gë_Ωlmn_ödex
();

75 
	`IdÀMode_gë_•lmn_ödex
();

77 
	`IdÀMode_upd©e_∂mn_li°
(
ödex
);

79 c⁄° *
	`IdÀMode_gë_∂mn_fuŒ«me
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

80 
size_t
 *
Àn
);

81 c⁄° *
	`IdÀMode_gë_∂mn_sh‹äame
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

82 
size_t
 *
Àn
);

83 c⁄° *
	`IdÀMode_gë_∂mn_id
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
, 
size_t
 *
Àn
);

85 
	`IdÀMode_gë_∂mn_fuŒ«me_ödex
(c⁄° *
∂mn
);

86 
	`IdÀMode_gë_∂mn_sh‹äame_ödex
(c⁄° *
∂mn
);

87 
	`IdÀMode_gë_∂mn_id_ödex
(c⁄° *
∂mn
);

	@src/emm/LowerLayer.c

50 
	~"LowîLayî.h
"

51 
	~"comm⁄Def.h
"

52 
	~"«s_log.h
"

54 
	~"emmD©a.h
"

56 
	~"emm_ßp.h
"

57 
	~"esm_ßp.h
"

58 
	~"«s_log.h
"

60 
	~<°rög.h
>

70 #ifde‡
NAS_UE


76 
lowîœyî_suc˚ss_ˇŒback_t
 
	msuc˚ss
;

77 
lowîœyî_Áûuª_ˇŒback_t
 
	mÁûuª
;

78 
lowîœyî_ªÀa£_ˇŒback_t
 
	mªÀa£
;

79 *
	m¨gs
;

80 } 
	g_lowîœyî_d©a
;

108 
	$lowîœyî_suc˚ss
(
ueid
)

110 
LOG_FUNC_IN
;

112 
emm_ßp_t
 
emm_ßp
;

113 
rc
;

115 
emm_ßp
.
¥imôive
 = 
EMMREG_LOWERLAYER_SUCCESS
;

116 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

117 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

119 
	`LOG_FUNC_RETURN
 (
rc
);

120 
	}
}

137 
	$lowîœyî_Áûuª
(
ueid
)

139 
LOG_FUNC_IN
;

141 
emm_ßp_t
 
emm_ßp
;

142 
rc
;

144 
emm_ßp
.
¥imôive
 = 
EMMREG_LOWERLAYER_FAILURE
;

145 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

146 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

148 
	`LOG_FUNC_RETURN
 (
rc
);

149 
	}
}

167 
	$lowîœyî_e°ablish
()

169 
LOG_FUNC_IN
;

171 #ifde‡
NAS_UE


173 
_emm_d©a
.
ecm_°©us
 = 
ECM_CONNECTED
;

176 
	`LOG_FUNC_RETURN
 (
RETURNok
);

177 
	}
}

194 
	$lowîœyî_ªÀa£
(
ˇu£
)

196 
LOG_FUNC_IN
;

198 
emm_ßp_t
 
emm_ßp
;

199 
rc
;

201 #ifde‡
NAS_UE


203 
_emm_d©a
.
ecm_°©us
 = 
ECM_IDLE
;

206 
emm_ßp
.
¥imôive
 = 
EMMREG_LOWERLAYER_RELEASE
;

207 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = 0;

208 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

210 
	`LOG_FUNC_RETURN
 (
rc
);

211 
	}
}

229 
	$lowîœyî_d©a_öd
(
ueid
, c⁄° 
O˘ëSåög
 *
d©a
)

231 
esm_ßp_t
 
esm_ßp
;

232 
rc
;

233 #i‡
	`deföed
(
NAS_MME
)

234 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

237 
LOG_FUNC_IN
;

239 #i‡
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

240 i‡(
ueid
 > 0) {

241 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

245 
esm_ßp
.
¥imôive
 = 
ESM_UNITDATA_IND
;

246 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

247 
esm_ßp
.
ueid
 = ueid;

248 #i‡
	`deföed
(
NAS_MME
)

249 
esm_ßp
.
˘x
 = 
emm_˘x
;

251 
esm_ßp
.
ªcv
 = 
d©a
;

252 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

254 
	`LOG_FUNC_RETURN
 (
rc
);

255 
	}
}

273 
	$lowîœyî_d©a_ªq
(
ueid
, c⁄° 
O˘ëSåög
 *
d©a
)

275 
LOG_FUNC_IN
;

277 
rc
;

278 
emm_ßp_t
 
emm_ßp
;

279 
emm_£curôy_c⁄ãxt_t
 *
s˘x
 = 
NULL
;

280 
emm_d©a_c⁄ãxt_s
 *
˘x
 = 
NULL
;

282 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_REQ
;

283 #ifde‡
NAS_UE


284 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
guti
 = 
_emm_d©a
.guti;

285 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = 0;

286 
s˘x
 = 
_emm_d©a
.
£curôy
;

288 #ifde‡
NAS_MME


289 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
guti
 = 
NULL
;

290 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = ueid;

291 #i‡
	`deföed
(
EPC_BUILD
)

292 i‡(
ueid
 > 0) {

293 
˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

296 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

297 
˘x
 = 
_emm_d©a
.˘x[
ueid
];

300 i‡(
˘x
) {

301 
s˘x
 = 
˘x
->
£curôy
;

304 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASöfo
 = 0;

305 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = data->length;

306 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
vÆue
 = data->value;

308 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
d©a
.
s˘x
, s˘x, 
FALSE
, 
TRUE
);

309 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

311 
	`LOG_FUNC_RETURN
 (
rc
);

312 
	}
}

319 #ifde‡
NAS_UE


341 
	$emm_¥oc_lowîœyî_öôülize
(
lowîœyî_suc˚ss_ˇŒback_t
 
suc˚ss
,

342 
lowîœyî_Áûuª_ˇŒback_t
 
Áûuª
,

343 
lowîœyî_ªÀa£_ˇŒback_t
 
ªÀa£
,

344 *
¨gs
)

346 
LOG_FUNC_IN
;

348 
_lowîœyî_d©a
.
suc˚ss
 = success;

349 
_lowîœyî_d©a
.
Áûuª
 = failure;

350 
_lowîœyî_d©a
.
ªÀa£
 =Ñelease;

351 
_lowîœyî_d©a
.
¨gs
 =árgs;

353 
	`LOG_FUNC_RETURN
 (
RETURNok
);

354 
	}
}

372 
	$emm_¥oc_lowîœyî_suc˚ss
()

374 
LOG_FUNC_IN
;

376 
rc
 = 
RETURNok
;

378 
lowîœyî_suc˚ss_ˇŒback_t
 
emm_ˇŒback
 = 
_lowîœyî_d©a
.
suc˚ss
;

380 i‡(
emm_ˇŒback
) {

381 
rc
 = (*
emm_ˇŒback
)(
_lowîœyî_d©a
.
¨gs
);

382 
_lowîœyî_d©a
.
suc˚ss
 = 
NULL
;

385 
	`LOG_FUNC_RETURN
 (
rc
);

386 
	}
}

404 
	$emm_¥oc_lowîœyî_Áûuª
(
is_öôül
)

406 
LOG_FUNC_IN
;

408 
rc
 = 
RETURNok
;

410 
lowîœyî_Áûuª_ˇŒback_t
 
emm_ˇŒback
 = 
_lowîœyî_d©a
.
Áûuª
;

412 i‡(
emm_ˇŒback
) {

413 
rc
 = (*
emm_ˇŒback
)(
is_öôül
, 
_lowîœyî_d©a
.
¨gs
);

414 
_lowîœyî_d©a
.
Áûuª
 = 
NULL
;

417 
	`LOG_FUNC_RETURN
 (
rc
);

418 
	}
}

435 
	$emm_¥oc_lowîœyî_ªÀa£
()

437 
LOG_FUNC_IN
;

439 
rc
 = 
RETURNok
;

441 
lowîœyî_ªÀa£_ˇŒback_t
 
emm_ˇŒback
 = 
_lowîœyî_d©a
.
ªÀa£
;

443 i‡(
emm_ˇŒback
) {

444 
rc
 = (*
emm_ˇŒback
)(
_lowîœyî_d©a
.
¨gs
);

445 
_lowîœyî_d©a
.
ªÀa£
 = 
NULL
;

448 
	`LOG_FUNC_RETURN
 (
rc
);

449 
	}
}

471 
	$emm_as_£t_£curôy_d©a
(
emm_as_£curôy_d©a_t
 *
d©a
, c⁄° *
¨gs
,

472 
is_√w
, 
is_cùhîed
)

474 
LOG_FUNC_IN
;

476 c⁄° 
emm_£curôy_c⁄ãxt_t
 *
c⁄ãxt
 = (emm_£curôy_c⁄ãxt_à*)(
¨gs
);

478 
	`mem£t
(
d©a
, 0, (
emm_as_£curôy_d©a_t
));

480 i‡–
c⁄ãxt
 && (c⁄ãxt->
ty≥
 !
EMM_KSI_NOT_AVAILABLE
) ) {

486 
	`LOG_TRACE
(
INFO
,

488 
is_√w
,

489 
c⁄ãxt
->
eksi
,

490 
c⁄ãxt
->
ul_cou¡
.
£q_num
,

491 *(
UI¡32_t
 *)(&
c⁄ãxt
->
ul_cou¡
));

492 
	`LOG_TRACE
(
INFO
,

493 "k«s_öà%s",
	`dump_o˘ë_°rög
(&
c⁄ãxt
->
k«s_öt
));

494 
	`LOG_TRACE
(
INFO
,

495 "k«s_í¯%s",
	`dump_o˘ë_°rög
(&
c⁄ãxt
->
k«s_íc
));

496 
	`LOG_TRACE
(
INFO
,

497 "kasmê%s",
	`dump_o˘ë_°rög
(&
c⁄ãxt
->
kasme
));

499 
d©a
->
is_√w
 = is_new;

500 
d©a
->
ksi
 = 
c⁄ãxt
->
eksi
;

501 #i‡
	`deföed
 (
NAS_UE
)

502 
d©a
->
sqn
 = 
c⁄ãxt
->
ul_cou¡
.
£q_num
;

504 
d©a
->
cou¡
 = 0x00000000 | (
c⁄ãxt
->
ul_cou¡
.
ovîÊow
 << 8 ) | c⁄ãxt->ul_cou¡.
£q_num
;

506 
d©a
->
sqn
 = 
c⁄ãxt
->
dl_cou¡
.
£q_num
;

508 
d©a
->
cou¡
 = 0x00000000 | (
c⁄ãxt
->
dl_cou¡
.
ovîÊow
 << 8 ) | c⁄ãxt->dl_cou¡.
£q_num
;

513 
d©a
->
k_öt
 = &
c⁄ãxt
->
k«s_öt
;

514 i‡(
is_cùhîed
) {

522 
	`LOG_TRACE
(
WARNING
,

524 
d©a
->
k_íc
 = &
c⁄ãxt
->
k«s_íc
;

527 
	`LOG_TRACE
(
WARNING
, "EMM_AS_NO_KEY_AVAILABLE");

529 
d©a
->
ksi
 = 
EMM_AS_NO_KEY_AVAILABLE
;

532 
LOG_FUNC_OUT
;

533 
	}
}

	@src/emm/LowerLayer.h

49 #i‚de‡
__LOWERLAYER_H__


50 
	#__LOWERLAYER_H__


	)

52 
	~"O˘ëSåög.h
"

58 #ifde‡
NAS_UE


63 (*
	tlowîœyî_suc˚ss_ˇŒback_t
)(*);

69 (*
	tlowîœyî_Áûuª_ˇŒback_t
)(, *);

75 (*
	tlowîœyî_ªÀa£_ˇŒback_t
)(*);

90 
	`lowîœyî_suc˚ss
(
ueid
);

91 
	`lowîœyî_Áûuª
(
ueid
);

92 
	`lowîœyî_e°ablish
();

93 
	`lowîœyî_ªÀa£
(
ˇu£
);

95 
	`lowîœyî_d©a_öd
(
ueid
, c⁄° 
O˘ëSåög
 *
d©a
);

96 
	`lowîœyî_d©a_ªq
(
ueid
, c⁄° 
O˘ëSåög
 *
d©a
);

	@src/emm/SecurityModeControl.c

56 
	~<°dlib.h
>

57 
	~<°rög.h
>

58 
	~<öây≥s.h
>

60 
	~"emm_¥oc.h
"

61 
	~"«s_log.h
"

62 
	~"«s_timî.h
"

64 
	~"emmD©a.h
"

66 
	~"emm_ßp.h
"

67 
	~"emm_ˇu£.h
"

69 
	~"UeSecurôyC≠abûôy.h
"

71 #i‡
deföed
(
ENABLE_ITTI
)

72 
	~"as£πi⁄s.h
"

74 
	~"£cu_defs.h
"

89 #ifde‡
NAS_UE


90 
_£curôy_kdf
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
key
,

91 
UI¡8_t
 
Ægo_di°
, UI¡8_à
Ægo_id
);

93 
_£curôy_k«s_íc
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
k«s_íc
,

94 
UI¡8_t
 
eü
);

95 
_£curôy_k«s_öt
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
k«s_öt
,

96 
UI¡8_t
 
ìa
);

97 
_£curôy_kíb
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
kíb
,

98 
UI¡32_t
 
cou¡
);

104 
O˘ëSåög
 
	mkíb
;

105 } 
	g_£curôy_d©a
;

107 
_£curôy_ªÀa£
(
emm_£curôy_c⁄ãxt_t
 *
˘x
);

115 #ifde‡
NAS_MME


119 *
_£curôy_t3460_h™dÀr
(*);

126 
_£curôy_ab‹t
(*);

127 
_£curôy_£À˘_Æg‹ôhms
(

128 c⁄° 
ue_eüP
,

129 c⁄° 
ue_ìaP
,

130 * c⁄° 
mme_eüP
,

131 * c⁄° 
mme_ìaP
);

136 
	mueid
;

137 
	#SECURITY_COUNTER_MAX
 5

	)

138 
	mªå™smissi⁄_cou¡
;

139 
	mksi
;

140 
	mìa
;

141 
	meü
;

142 
	mucs2
;

143 
	muó
;

144 
	muü
;

145 
	mgó
;

146 
	mumts_¥e£¡
:1;

147 
	mg¥s_¥e£¡
:1;

148 
	m£À˘ed_ìa
;

149 
	m£À˘ed_eü
;

150 
	mnŸify_Áûuª
;

153 } 
	t£curôy_d©a_t
;

155 
_£curôy_ªque°
(
£curôy_d©a_t
 *
d©a
, 
is_√w
);

167 #ifde‡
NAS_UE


197 
	$emm_¥oc_£curôy_mode_comm™d
(
«tive_ksi
, 
ksi
,

198 
£ó
, 
£ü
, 
ªó
, 
ªü
)

200 
LOG_FUNC_IN
;

202 
rc
 = 
RETURNîr‹
;

203 
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

204 
£curôy_c⁄ãxt_is_√w
 = 
FALSE
;

206 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Security mode controlÑequested (ksi=%d)",

207 
ksi
);

210 (Ë
	`emm_¥oc_authítiˇti⁄_dñëe
();

215 
UI¡8_t
 
ìa
 = (0x80 >> 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_í¸y±i⁄
);

216 
UI¡8_t
 
eü
 = (0x80 >> 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_öãgrôy
);

217 i‡–(
ªó
 !
ìa
Ë|| (
ªü
 !
eü
) ) {

218 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Replayed UE security capabilities "

220 
emm_ˇu£
 = 
EMM_CAUSE_UE_SECURITY_MISMATCH
;

231 i‡(
_emm_d©a
.
n⁄_cuºít
 =
NULL
) {

232 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Non-current EPS security context "

234 
emm_ˇu£
 = 
EMM_CAUSE_SECURITY_MODE_REJECTED
;

240 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Upd©êthên⁄-cuºíàEPS securôy c⁄ãxà£ó=%u seü=%u", 
£ó
, 
£ü
);

245 
_emm_d©a
.
n⁄_cuºít
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
 = 
£ó
;

246 
_emm_d©a
.
n⁄_cuºít
->
£À˘ed_Æg‹ôhms
.
öãgrôy
 = 
£ü
;

249 i‡(
_emm_d©a
.
n⁄_cuºít
->
k«s_íc
.
vÆue
 =
NULL
) {

250 
_emm_d©a
.
n⁄_cuºít
->
k«s_íc
.
vÆue
 =

251 (
uöt8_t
 *)
	`ˇŒoc
(1,
AUTH_KNAS_ENC_SIZE
);

252 
_emm_d©a
.
n⁄_cuºít
->
k«s_íc
.
Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

254 i‡(
_emm_d©a
.
n⁄_cuºít
->
k«s_íc
.
vÆue
 !
NULL
) {

255 
	`LOG_TRACE
(
INFO
, "EMM-PROC - UpdateÅheÇon-current EPS security context knas_enc");

256 
rc
 = 
	`_£curôy_k«s_íc
(&
_emm_d©a
.
n⁄_cuºít
->
kasme
,

257 &
_emm_d©a
.
n⁄_cuºít
->
k«s_íc
, 
£ó
);

260 i‡(
_emm_d©a
.
n⁄_cuºít
->
k«s_öt
.
vÆue
 =
NULL
) {

261 
_emm_d©a
.
n⁄_cuºít
->
k«s_öt
.
vÆue
 =

262 (
uöt8_t
 *)
	`ˇŒoc
(1,
AUTH_KNAS_INT_SIZE
);

263 
_emm_d©a
.
n⁄_cuºít
->
k«s_öt
.
Àngth
 = 
AUTH_KNAS_INT_SIZE
;

265 i‡(
_emm_d©a
.
n⁄_cuºít
->
k«s_öt
.
vÆue
 !
NULL
) {

266 i‡(
rc
 !
RETURNîr‹
) {

267 
	`LOG_TRACE
(
INFO
, "EMM-PROC - UpdateÅheÇon-current EPS security context knas_int");

268 
rc
 = 
	`_£curôy_k«s_öt
(&
_emm_d©a
.
n⁄_cuºít
->
kasme
,

269 &
_emm_d©a
.
n⁄_cuºít
->
k«s_öt
, 
£ü
);

273 i‡(
_£curôy_d©a
.
kíb
.
vÆue
 =
NULL
) {

274 
_£curôy_d©a
.
kíb
.
vÆue
 = (
uöt8_t
 *)
	`ˇŒoc
(1,
AUTH_KENB_SIZE
);

275 
_£curôy_d©a
.
kíb
.
Àngth
 = 
AUTH_KENB_SIZE
;

277 i‡(
_£curôy_d©a
.
kíb
.
vÆue
 !
NULL
) {

278 i‡(
rc
 !
RETURNîr‹
) {

279 
	`LOG_TRACE
(
INFO
, "EMM-PROC - UpdateÅheÇon-current EPS security context kenb");

281 
rc
 = 
	`_£curôy_kíb
(&
_emm_d©a
.
n⁄_cuºít
->
kasme
,

282 &
_£curôy_d©a
.
kíb
,

283 *(
UI¡32_t
 *)(&
_emm_d©a
.
n⁄_cuºít
->
ul_cou¡
));

290 i‡(
rc
 !
RETURNîr‹
) {

291 
	`LOG_TRACE
(
INFO
, "EMM-PROC - NAS security mode commandáccepted byÅhe UE");

293 i‡–
«tive_ksi
 && (
_emm_d©a
.
£curôy
->
ty≥
 !
EMM_KSI_NATIVE
) ) {

298 i‡–(
_emm_d©a
.
n⁄_cuºít
->
ty≥
 =
EMM_KSI_NATIVE
) &&

299 (
_emm_d©a
.
n⁄_cuºít
->
eksi
 =
ksi
) ) {

305 
	`LOG_TRACE
(
INFO
,

308 
	`_£curôy_ªÀa£
(
_emm_d©a
.
£curôy
);

309 
_emm_d©a
.
£curôy
 = _emm_d©a.
n⁄_cuºít
;

311 
_emm_d©a
.
£curôy
->
ul_cou¡
.
ovîÊow
 = 0;

312 
_emm_d©a
.
£curôy
->
ul_cou¡
.
£q_num
 = 0;

314 
£curôy_c⁄ãxt_is_√w
 = 
TRUE
;

318 i‡–!
«tive_ksi
 && (
_emm_d©a
.
£curôy
->
ty≥
 !
EMM_KSI_NATIVE
) ) {

323 i‡(
ksi
 !
_emm_d©a
.
£curôy
->
eksi
) {

326 
	`LOG_TRACE
(
INFO
,

328 
_emm_d©a
.
£curôy
->
ul_cou¡
.
ovîÊow
 = 0;

329 
_emm_d©a
.
£curôy
->
ul_cou¡
.
£q_num
 = 0;

333 
_emm_d©a
.
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
 = 
£ó
;

334 
_emm_d©a
.
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
 = 
£ü
;

342 
emm_ˇu£
 = 
EMM_CAUSE_SECURITY_MODE_REJECTED
;

344 i‡(
_£curôy_d©a
.
kíb
.
vÆue
) {

345 
	`‰ì
(
_£curôy_d©a
.
kíb
.
vÆue
);

346 
_£curôy_d©a
.
kíb
.
vÆue
 = 
NULL
;

347 
_£curôy_d©a
.
kíb
.
Àngth
 = 0;

354 
rc
 = 
	`emm_¥oc_lowîœyî_öôülize
(
NULL
, NULL, NULL, NULL);

355 i‡(
rc
 !
RETURNok
) {

356 
	`LOG_TRACE
(
WARNING
,

358 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

365 
emm_ßp_t
 
emm_ßp
;

366 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_RES
;

367 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
_emm_d©a
.guti;

368 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 0;

369 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_SMC
;

370 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
emm_ˇu£
 =Émm_cause;

372 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

373 
_emm_d©a
.
£curôy
, 
£curôy_c⁄ãxt_is_√w
, 
TRUE
);

374 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

376 
	`LOG_FUNC_RETURN
 (
rc
);

377 
	}
}

385 #ifde‡
NAS_MME


421 
	$emm_¥oc_£curôy_mode_c⁄åﬁ
(
ueid
, 
ksi
,

422 
ìa
, 
eü
,
ucs2
, 
uó
, 
uü
, 
gó
, 
umts_¥e£¡
, 
g¥s_¥e£¡
,

423 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

424 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

425 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
)

427 
rc
 = 
RETURNîr‹
;

428 
£curôy_c⁄ãxt_is_√w
 = 
FALSE
;

429 
mme_ìa
 = 
NAS_SECURITY_ALGORITHMS_EEA0
;

430 
mme_eü
 = 
NAS_SECURITY_ALGORITHMS_EIA0
;

432 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

434 
LOG_FUNC_IN
;

436 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Initiate security mode controlÖrocedure "

438 
ksi
, 
ìa
, 
eü
);

440 #i‡
	`deföed
(
EPC_BUILD
)

441 i‡(
ueid
 > 0) {

442 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

445 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

446 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

450 i‡(
emm_˘x
 &&Émm_˘x->
£curôy
) {

451 i‡(
emm_˘x
->
£curôy
->
ty≥
 =
EMM_KSI_NOT_AVAILABLE
) {

455 
emm_˘x
->
£curôy
->
ty≥
 = 
EMM_KSI_NATIVE
;

456 
emm_˘x
->
£curôy
->
eksi
 = 
ksi
;

457 
emm_˘x
->
£curôy
->
dl_cou¡
.
ovîÊow
 = 0;

458 
emm_˘x
->
£curôy
->
dl_cou¡
.
£q_num
 = 0;

464 
	`FREE_OCTET_STRING
(
emm_˘x
->
£curôy
->
kasme
);

466 
emm_˘x
->
£curôy
->
kasme
.
vÆue
 = 
	`mÆloc
(32);

467 
	`mem˝y
(
emm_˘x
->
£curôy
->
kasme
.
vÆue
,

468 
emm_˘x
->
ve˘‹
.
kasme
,

470 
emm_˘x
->
£curôy
->
kasme
.
Àngth
 = 32;

472 
rc
 = 
	`_£curôy_£À˘_Æg‹ôhms
(

473 
eü
,

474 
ìa
,

475 &
mme_eü
,

476 &
mme_ìa
);

478 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
 = 
mme_ìa
;

479 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
 = 
mme_eü
;

481 i‡(
rc
 =
RETURNîr‹
) {

482 
	`LOG_TRACE
(
WARNING
,

484 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

487 i‡–! 
emm_˘x
->
£curôy
->
k«s_öt
.
vÆue
) {

488 
emm_˘x
->
£curôy
->
k«s_öt
.
vÆue
 = 
	`mÆloc
(
AUTH_KNAS_INT_SIZE
);

490 
	`LOG_TRACE
(
ERROR
,

492 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

494 
emm_˘x
->
£curôy
->
k«s_öt
.
Àngth
 = 
AUTH_KNAS_INT_SIZE
;

495 
	`dîive_key_«s
(

496 
NAS_INT_ALG
,

497 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
,

498 
emm_˘x
->
ve˘‹
.
kasme
,

499 
emm_˘x
->
£curôy
->
k«s_öt
.
vÆue
);

501 i‡–! 
emm_˘x
->
£curôy
->
k«s_íc
.
vÆue
) {

502 
emm_˘x
->
£curôy
->
k«s_íc
.
vÆue
 = 
	`mÆloc
(
AUTH_KNAS_ENC_SIZE
);

504 
	`LOG_TRACE
(
ERROR
,

506 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

508 
emm_˘x
->
£curôy
->
k«s_íc
.
Àngth
 = 
AUTH_KNAS_ENC_SIZE
;

509 
	`dîive_key_«s
(

510 
NAS_ENC_ALG
,

511 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
,

512 
emm_˘x
->
ve˘‹
.
kasme
,

513 
emm_˘x
->
£curôy
->
k«s_íc
.
vÆue
);

516 
£curôy_c⁄ãxt_is_√w
 = 
TRUE
;

519 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - No EPS security contextÉxists");

520 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

524 
£curôy_d©a_t
 *
d©a
 =

525 (
£curôy_d©a_t
 *)
	`mÆloc
((security_data_t));

527 i‡(
d©a
 !
NULL
) {

529 
rc
 = 
	`emm_¥oc_comm⁄_öôülize
(
ueid
, 
suc˚ss
, 
ªje˘
, 
Áûuª
,

530 
_£curôy_ab‹t
, 
d©a
);

531 i‡(
rc
 !
RETURNok
) {

532 
	`LOG_TRACE
(
WARNING
, "FailedÅo initialize EMM callback functions");

533 
	`‰ì
(
d©a
);

534 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

537 
d©a
->
ueid
 = ueid;

539 
d©a
->
ªå™smissi⁄_cou¡
 = 0;

541 
d©a
->
ksi
 = ksi;

543 
d©a
->
ìa
 =Éea;

545 
d©a
->
eü
 =Éia;

546 
d©a
->
ucs2
 = ucs2;

548 
d©a
->
uó
 = uea;

550 
d©a
->
uü
 = uia;

552 
d©a
->
gó
 = gea;

553 
d©a
->
umts_¥e£¡
 = umts_present;

554 
d©a
->
g¥s_¥e£¡
 = gprs_present;

556 
d©a
->
£À˘ed_ìa
 = 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
;

558 
d©a
->
£À˘ed_eü
 = 
emm_˘x
->
£curôy
->
£À˘ed_Æg‹ôhms
.
öãgrôy
;

560 
d©a
->
nŸify_Áûuª
 = 
FALSE
;

562 
rc
 = 
	`_£curôy_ªque°
(
d©a
, 
£curôy_c⁄ãxt_is_√w
);

563 i‡(
rc
 !
RETURNîr‹
) {

567 
emm_ßp_t
 
emm_ßp
;

568 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REQ
;

569 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

570 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

571 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

575 
	`LOG_FUNC_RETURN
 (
rc
);

576 
	}
}

600 
	$emm_¥oc_£curôy_mode_com∂ëe
(
ueid
)

602 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

604 
rc
 = 
RETURNîr‹
;

605 
emm_ßp_t
 
emm_ßp
;

607 
LOG_FUNC_IN
;

609 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Securôy modêcom∂ëê(ueid=%u)", 
ueid
);

612 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3460 (%d)", 
T3460
.
id
);

613 
T3460
.
id
 = 
	`«s_timî_°›
(T3460.id);

616 
£curôy_d©a_t
 *
d©a
 = (£curôy_d©a_à*)(
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
));

617 i‡(
d©a
) {

618 
	`‰ì
(
d©a
);

622 #i‡
	`deföed
(
EPC_BUILD
)

623 i‡(
ueid
 > 0) {

624 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

627 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

628 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

632 i‡(
emm_˘x
 &&Émm_˘x->
£curôy
) {

636 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_CNF
;

637 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

638 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

639 
emm_ßp
.
u
.
emm_ªg
.u.
comm⁄
.
is_©èched
 = 
emm_˘x
->is_attached;

641 
	`LOG_TRACE
(
ERROR
, "EMM-PROC - No EPS security contextÉxists");

645 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

646 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

647 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

650 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

652 
	`LOG_FUNC_RETURN
 (
rc
);

653 
	}
}

679 
	$emm_¥oc_£curôy_mode_ªje˘
(
ueid
)

681 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

682 
rc
 = 
RETURNîr‹
;

684 
LOG_FUNC_IN
;

686 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Security mode commandÇotáccepted byÅhe UE"

687 "(ueid=0x%08x)", 
ueid
);

690 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3460 (%d)", 
T3460
.
id
);

691 
T3460
.
id
 = 
	`«s_timî_°›
(T3460.id);

694 
£curôy_d©a_t
 *
d©a
 = (£curôy_d©a_à*)(
	`emm_¥oc_comm⁄_gë_¨gs
(
ueid
));

695 i‡(
d©a
) {

696 
	`‰ì
(
d©a
);

700 #i‡
	`deföed
(
EPC_BUILD
)

701 i‡(
ueid
 > 0) {

702 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

703 
	`DevAs£π
(
emm_˘x
 !
NULL
);

706 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

707 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

711 i‡(
emm_˘x
 &&Émm_˘x->
£curôy
) {

718 
emm_˘x
->
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

724 
emm_ßp_t
 
emm_ßp
;

725 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

726 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

727 
emm_ßp
.
u
.
emm_ªg
.
˘x
 = 
emm_˘x
;

728 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

730 
	`LOG_FUNC_RETURN
 (
rc
);

731 
	}
}

738 #ifde‡
NAS_UE


759 
	$_£curôy_ªÀa£
(
emm_£curôy_c⁄ãxt_t
 *
˘x
)

761 
LOG_FUNC_IN
;

763 i‡(
˘x
) {

765 i‡(
˘x
->
kasme
.
vÆue
) {

766 
	`‰ì
(
˘x
->
kasme
.
vÆue
);

767 
˘x
->
kasme
.
vÆue
 = 
NULL
;

768 
˘x
->
kasme
.
Àngth
 = 0;

771 i‡(
˘x
->
k«s_íc
.
vÆue
) {

772 
	`‰ì
(
˘x
->
k«s_íc
.
vÆue
);

773 
˘x
->
k«s_íc
.
vÆue
 = 
NULL
;

774 
˘x
->
k«s_íc
.
Àngth
 = 0;

777 i‡(
˘x
->
k«s_öt
.
vÆue
) {

778 
	`‰ì
(
˘x
->
k«s_öt
.
vÆue
);

779 
˘x
->
k«s_öt
.
vÆue
 = 
NULL
;

780 
˘x
->
k«s_öt
.
Àngth
 = 0;

783 
	`‰ì
(
˘x
);

786 
LOG_FUNC_OUT
;

787 
	}
}

807 
	$_£curôy_k«s_íc
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
k«s_íc
,

808 
UI¡8_t
 
ìa
)

810 
LOG_FUNC_IN
;

811 
	`LOG_TRACE
(
INFO
, "%† wôhálgÿdi° %dálgÿid %d", 
__FUNCTION__
,0x01, 
ìa
);

812 
	`LOG_FUNC_RETURN
 (
	`_£curôy_kdf
(
kasme
, 
k«s_íc
, 0x01, 
ìa
));

813 
	}
}

833 
	$_£curôy_k«s_öt
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
k«s_öt
,

834 
UI¡8_t
 
eü
)

836 
LOG_FUNC_IN
;

837 
	`LOG_TRACE
(
INFO
, "%† wôhálgÿdi° %dálgÿid %d", 
__FUNCTION__
,0x02, 
eü
);

838 
	`LOG_FUNC_RETURN
 (
	`_£curôy_kdf
(
kasme
, 
k«s_öt
, 0x02, 
eü
));

839 
	}
}

859 
	$_£curôy_kíb
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
kíb
,

860 
UI¡32_t
 
cou¡
)

865 
UI¡8_t
 
öput
[32];

866 
UI¡16_t
 
Àngth
 = 4;

867 
off£t
 = 0;

869 
	`LOG_TRACE
(
INFO
, "%† wôh cou¡%d", 
__FUNCTION__
, 
cou¡
);

870 
	`mem£t
(
öput
, 0, 32);

871 
öput
[0] = 0x11;

873 
öput
[1] = 
cou¡
 >> 24;

874 
öput
[2] = (
UI¡8_t
)(
cou¡
 >> 16);

875 
öput
[3] = (
UI¡8_t
)(
cou¡
 >> 8);

876 
öput
[4] = (
UI¡8_t
)
cou¡
;

878 
öput
[5] = 0;

879 
öput
[6] = 4;

881 
	`kdf
(
kasme
->
vÆue
, 32, 
öput
, 7, 
kíb
->value, 32);

882 
kíb
->
Àngth
 = 32;

883  (
RETURNok
);

884 
	}
}

906 
	$_£curôy_kdf
(c⁄° 
O˘ëSåög
 *
kasme
, O˘ëSåög *
key
,

907 
UI¡8_t
 
Ægo_di°
, UI¡8_à
Ægo_id
)

913 
UI¡8_t
 
öput
[32];

914 
UI¡8_t
 
ouçut
[32];

915 
	`LOG_TRACE
(
DEBUG
, "%s:%u output key mem %pÜenth %u",

916 
__FUNCTION__
, 
__LINE__
,

917 
key
->
vÆue
,

918 
key
->
Àngth
);

919 
	`mem£t
(
öput
, 0, 32);

921 
öput
[0] = 0x15;

923 
öput
[1] = 
Ægo_di°
;

925 
öput
[2] = 0x00;

926 
öput
[3] = 0x01;

928 
öput
[4] = 
Ægo_id
;

930 
öput
[5] = 0x00;

931 
öput
[6] = 0x01;

934 
	`kdf
(
kasme
->
vÆue
, kasme->
Àngth
, 
öput
, 7, 
ouçut
, 32);

935 
	`mem˝y
(
key
->
vÆue
, &
ouçut
[31 - key->
Àngth
 + 1], key->length);

936  (
RETURNok
);

937 
	}
}

940 #ifde‡
NAS_MME


967 *
	$_£curôy_t3460_h™dÀr
(*
¨gs
)

969 
LOG_FUNC_IN
;

971 
rc
;

973 
£curôy_d©a_t
 *
d©a
 = (£curôy_d©a_à*)(
¨gs
);

976 
d©a
->
ªå™smissi⁄_cou¡
 += 1;

978 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3460ÅimerÉxpired,Ñetransmission "

979 "cou¡î = %d", 
d©a
->
ªå™smissi⁄_cou¡
);

981 i‡(
d©a
->
ªå™smissi⁄_cou¡
 < 
SECURITY_COUNTER_MAX
) {

983 
rc
 = 
	`_£curôy_ªque°
(
d©a
, 
FALSE
);

986 
d©a
->
nŸify_Áûuª
 = 
TRUE
;

988 
rc
 = 
	`_£curôy_ab‹t
(
d©a
);

991 
	`LOG_FUNC_RETURN
 (
NULL
);

992 
	}
}

1016 
	$_£curôy_ªque°
(
£curôy_d©a_t
 *
d©a
, 
is_√w
)

1018 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

1020 
emm_ßp_t
 
emm_ßp
;

1021 
rc
;

1023 
LOG_FUNC_IN
;

1029 
emm_ßp
.
¥imôive
 = 
EMMAS_SECURITY_REQ
;

1030 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
guti
 = 
NULL
;

1031 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ueid
 = 
d©a
->ueid;

1032 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
msgTy≥
 = 
EMM_AS_MSG_TYPE_SMC
;

1033 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ksi
 = 
d©a
->ksi;

1034 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ìa
 = 
d©a
->eea;

1035 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
eü
 = 
d©a
->eia;

1036 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
ucs2
 = 
d©a
->ucs2;

1037 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
uó
 = 
d©a
->uea;

1038 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
uü
 = 
d©a
->uia;

1039 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
gó
 = 
d©a
->gea;

1040 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
umts_¥e£¡
 = 
d©a
->umts_present;

1041 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
g¥s_¥e£¡
 = 
d©a
->gprs_present;

1042 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
£À˘ed_ìa
 = 
d©a
->selected_eea;

1043 
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
£À˘ed_eü
 = 
d©a
->selected_eia;

1045 #i‡
	`deföed
(
EPC_BUILD
)

1046 i‡(
d©a
->
ueid
 > 0) {

1047 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
d©a
->
ueid
);

1050 i‡(
d©a
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1051 
emm_˘x
 = 
_emm_d©a
.
˘x
[
d©a
->
ueid
];

1056 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
£curôy
.
s˘x
,

1057 
emm_˘x
->
£curôy
, 
is_√w
, 
FALSE
);

1058 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1060 i‡(
rc
 !
RETURNîr‹
) {

1061 i‡(
T3460
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1063 
T3460
.
id
 = 
	`«s_timî_ª°¨t
(T3460.id);

1066 
T3460
.
id
 = 
	`«s_timî_°¨t
(T3460.
£c
, 
_£curôy_t3460_h™dÀr
, 
d©a
);

1068 
	`LOG_TRACE
(
INFO
,"EMM-PROC - Timer T3460 (%d)Éxpires in %ld seconds",

1069 
T3460
.
id
, T3460.
£c
);

1072 
	`LOG_FUNC_RETURN
 (
rc
);

1073 
	}
}

1090 
	$_£curôy_ab‹t
(*
¨gs
)

1092 
LOG_FUNC_IN
;

1094 
rc
 = 
RETURNîr‹
;

1096 
£curôy_d©a_t
 *
d©a
 = (£curôy_d©a_à*)(
¨gs
);

1098 i‡(
d©a
) {

1099 
ueid
 = 
d©a
->ueid;

1100 
nŸify_Áûuª
 = 
d©a
->notify_failure;

1102 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - Abort security mode controlÖrocedure "

1103 "(ueid=%u)", 
ueid
);

1106 i‡(
T3460
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

1107 
	`LOG_TRACE
(
INFO
, "EMM-PROC - St›Åimî T3460 (%d)", 
T3460
.
id
);

1108 
T3460
.
id
 = 
	`«s_timî_°›
(T3460.id);

1111 
	`‰ì
(
d©a
);

1116 i‡(
nŸify_Áûuª
) {

1117 
emm_ßp_t
 
emm_ßp
;

1118 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REJ
;

1119 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = ueid;

1120 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1122 
rc
 = 
RETURNok
;

1126 
	`LOG_FUNC_RETURN
 (
rc
);

1127 
	}
}

1147 
	$_£curôy_£À˘_Æg‹ôhms
(

1148 c⁄° 
ue_eüP
,

1149 c⁄° 
ue_ìaP
,

1150 * c⁄° 
mme_eüP
,

1151 * c⁄° 
mme_ìaP
)

1153 
LOG_FUNC_IN
;

1155 
rc
 = 
RETURNîr‹
;

1156 
¥e„ªn˚_ödex
;

1158 *
mme_eüP
 = 
NAS_SECURITY_ALGORITHMS_EIA0
;

1159 *
mme_ìaP
 = 
NAS_SECURITY_ALGORITHMS_EEA0
;

1161 
¥e„ªn˚_ödex
 = 0;Öreference_index < 8;Öreference_index++) {

1162 i‡(
ue_eüP
 & (0x80 >> 
_emm_d©a
.
c⁄f
.
¥e„ªd_öãgrôy_Æg‹ôhm
[
¥e„ªn˚_ödex
])) {

1163 
	`LOG_TRACE
(
DEBUG
,

1165 
_emm_d©a
.
c⁄f
.
¥e„ªd_öãgrôy_Æg‹ôhm
[
¥e„ªn˚_ödex
],

1166 
¥e„ªn˚_ödex
);

1167 *
mme_eüP
 = 
_emm_d©a
.
c⁄f
.
¥e„ªd_öãgrôy_Æg‹ôhm
[
¥e„ªn˚_ödex
];

1172 
¥e„ªn˚_ödex
 = 0;Öreference_index < 8;Öreference_index++) {

1173 i‡(
ue_ìaP
 & (0x80 >> 
_emm_d©a
.
c⁄f
.
¥e„ªd_cùhîög_Æg‹ôhm
[
¥e„ªn˚_ödex
])) {

1174 
	`LOG_TRACE
(
DEBUG
,

1176 
_emm_d©a
.
c⁄f
.
¥e„ªd_cùhîög_Æg‹ôhm
[
¥e„ªn˚_ödex
],

1177 
¥e„ªn˚_ödex
);

1178 *
mme_ìaP
 = 
_emm_d©a
.
c⁄f
.
¥e„ªd_cùhîög_Æg‹ôhm
[
¥e„ªn˚_ödex
];

1182 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1183 
	}
}

	@src/emm/ServiceRequestHdl.c

56 
	~"emm_¥oc.h
"

57 
	~"«s_log.h
"

58 
	~"«s_timî.h
"

60 
	~"emmD©a.h
"

62 
	~"emm_ßp.h
"

77 #ifde‡
NAS_UE


81 *
_emm_£rvi˚_t3417_h™dÀr
(*);

89 #ifde‡
NAS_MME


100 #ifde‡
NAS_UE


123 *
	$_emm_£rvi˚_t3417_h™dÀr
(*
¨gs
)

125 
LOG_FUNC_IN
;

127 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3417ÅimerÉxpired");

130 
T3417
.
id
 = 
	`«s_timî_°›
(T3417.id);

132 
	`LOG_FUNC_RETURN
(
NULL
);

133 
	}
}

	@src/emm/TrackingAreaUpdate.c

53 
	~"emm_¥oc.h
"

54 
	~"«s_log.h
"

55 
	~"«s_timî.h
"

57 
	~"emmD©a.h
"

59 
	~"emm_ßp.h
"

60 
	~"emm_ˇu£.h
"

62 
	~<°rög.h
>

77 #ifde‡
NAS_UE


81 *
_emm_èu_t3430_h™dÀr
(*);

89 #ifde‡
NAS_MME


90 
_emm_åackög_¨ó_upd©e_ªje˘
(*
¨gs
);

97 #ifde‡
NAS_MME


113 
	$emm_¥oc_åackög_¨ó_upd©e_ªje˘
(
ueid
, 
emm_ˇu£
)

115 
LOG_FUNC_IN
;

117 
rc
;

120 
emm_d©a_c⁄ãxt_t
 
ue_˘x
;

121 
	`mem£t
(&
ue_˘x
, 0 , (
emm_d©a_c⁄ãxt_t
));

122 
ue_˘x
.
is_dy«mic
 = 
FALSE
;

123 
ue_˘x
.
ueid
 = ueid;

126 #i‡
	`deföed
(
EPC_BUILD
)

127 i‡(
ueid
 > 0)

129 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
)

132 
ue_˘x
.
emm_ˇu£
 =Émm_cause;

134 
ue_˘x
.
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

138 
rc
 = 
	`_emm_åackög_¨ó_upd©e_ªje˘
(&
ue_˘x
);

140 
	`LOG_FUNC_RETURN
(
rc
);

141 
	}
}

148 #ifde‡
NAS_UE


171 *
	$_emm_èu_t3430_h™dÀr
(*
¨gs
)

173 
LOG_FUNC_IN
;

175 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - T3430ÅimerÉxpired");

178 
T3430
.
id
 = 
	`«s_timî_°›
(T3430.id);

180 
	`LOG_FUNC_RETURN
(
NULL
);

181 
	}
}

185 #ifde‡
NAS_MME


201 
	$_emm_åackög_¨ó_upd©e_ªje˘
(*
¨gs
)

203 
LOG_FUNC_IN
;

205 
rc
 = 
RETURNîr‹
;

207 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)(
¨gs
);

209 i‡(
emm_˘x
) {

210 
emm_ßp_t
 
emm_ßp
;

211 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - EMMÅrackingárea updateÖrocedureÇotáccepted "

213 
emm_˘x
->
ueid
,Émm_˘x->
emm_ˇu£
);

218 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_REJ
;

219 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
ueid
 = 
emm_˘x
->ueid;

220 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
UEid
.
guti
 = 
NULL
;

221 i‡(
emm_˘x
->
emm_ˇu£
 =
EMM_CAUSE_SUCCESS
) {

222 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

224 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
emm_ˇu£
 = 
emm_˘x
->emm_cause;

225 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASöfo
 = 
EMM_AS_NAS_INFO_TAU
;

226 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
Àngth
 = 0;

227 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
vÆue
 = 
NULL
;

230 
	`emm_as_£t_£curôy_d©a
(&
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
s˘x
,

231 
emm_˘x
->
£curôy
, 
FALSE
, 
TRUE
);

232 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

235 
	`LOG_FUNC_RETURN
(
rc
);

236 
	}
}

	@src/emm/emmData.h

46 #i‚de‡
__EMMDATA_H__


47 
	#__EMMDATA_H__


	)

49 
	~"comm⁄Def.h
"

50 
	~"√tw‹kDef.h
"

51 
	~"£curôyDef.h
"

53 
	~"O˘ëSåög.h
"

54 
	~"«s_timî.h
"

56 
	~"esmD©a.h
"

58 #ifde‡
NAS_MME


59 
	~"emm_fsm.h
"

60 
	~"mme_≠i.h
"

61 #i‡
deföed
(
EPC_BUILD
)

62 
	~"åì.h
"

70 #ifde‡
NAS_UE


75 
	#EMM_NVRAM_FILENAME
 ".ue_emm.nvøm"

	)

81 
	#EMM_NVRAM_DIRNAME
 "NVRAM_DIR"

	)

84 
	#EMM_DATA_PLMN_AUTO
 
NET_PLMN_AUTO


	)

85 
	#EMM_DATA_PLMN_MANUAL
 
NET_PLMN_MANUAL


	)

90 
	#MCCS_ARE_EQUAL
(
n1
, 
n2
Ë((“1).
MCCdigô1
 == (n2).MCCdigit1) && \

91 ((
n1
).
MCCdigô2
 =(
n2
).MCCdigit2) && \

92 ((
n1
).
MCCdigô3
 =(
n2
).MCCdigô3))

	)

95 
	#MNCS_ARE_EQUAL
(
n1
, 
n2
Ë((“1).
MNCdigô1
 == (n2).MNCdigit1) && \

96 ((
n1
).
MNCdigô2
 =(
n2
).MNCdigit2) && \

97 ((
n1
).
MNCdigô3
 =(
n2
).MNCdigô3))

	)

100 
	#PLMNS_ARE_EQUAL
(
p1
, 
p2
Ë((
	`MCCS_ARE_EQUAL
((p1),(p2))) && \

101 (
	`MNCS_ARE_EQUAL
((
p1
),(
p2
))))

	)

104 
	#TAIS_ARE_EQUAL
(
t1
, 
t2
Ë((
	`PLMNS_ARE_EQUAL
(—1).
∂mn
,(t2).plmn)) && \

105 ((
t1
).
èc
 =(
t2
).èc))

	)

119 
	mEMM_KSI_NOT_AVAILABLE
 = 0,

120 
	mEMM_KSI_NATIVE
,

121 
	mEMM_KSI_MAPPED


122 } 
	temm_ksi_t
;

126 
emm_ksi_t
 
	mty≥
;

127 
	meksi
;

128 
O˘ëSåög
 
	mkasme
;

130 
O˘ëSåög
 
	mk«s_íc
;

131 
O˘ëSåög
 
	mk«s_öt
;

133 
UI¡32_t
 
	m•¨e
:8;

134 
UI¡32_t
 
	movîÊow
:16;

135 
UI¡32_t
 
	m£q_num
:8;

136 } 
	mdl_cou¡
, 
	mul_cou¡
;

138 
UI¡8_t
 
	mïs_í¸y±i⁄
;

139 
UI¡8_t
 
	mïs_öãgrôy
;

140 
UI¡8_t
 
	mumts_í¸y±i⁄
;

141 
UI¡8_t
 
	mumts_öãgrôy
;

142 
UI¡8_t
 
	mg¥s_í¸y±i⁄
;

143 
UI¡8_t
 
	mumts_¥e£¡
:1;

144 
UI¡8_t
 
	mg¥s_¥e£¡
:1;

145 } 
	mˇ∑bûôy
;

147 
UI¡8_t
 
	mí¸y±i⁄
:4;

148 
UI¡8_t
 
	möãgrôy
:4;

149 } 
	m£À˘ed_Æg‹ôhms
;

150 } 
	temm_£curôy_c⁄ãxt_t
;

157 #ifde‡
NAS_UE


175 
	mEU1_UPDATED
,

176 
	mEU2_NOT_UPDATED
,

177 
	mEU3_ROAMING_NOT_ALLOWED


178 } 
	temm_ïs_upd©e_t
;

189 
	mECM_IDLE
,

190 
	mECM_CONNECTED


191 } 
	temm_ecm_°©e_t
;

209 
imsi_t
 
	mimsi
;

210 
∂mn_t
 
	mΩlmn
;

212 
	#EMM_DATA_EPLMN_MAX
 16

	)

213 
PLMN_LIST_T
(
EMM_DATA_EPLMN_MAX
Ë
	mïlmn
;

214 } 
	temm_nvd©a_t
;

221 
	musim_is_vÆid
;

223 
imei_t
 *
	mimei
;

224 c⁄° 
imsi_t
 *
	mimsi
;

225 
GUTI_t
 *
	mguti
;

226 
èi_t
 *
	mèi
;

228 
emm_ïs_upd©e_t
 
	m°©us
;

229 
emm_ecm_°©e_t
 
	mecm_°©us
;

230 
	mis_©èched
;

231 
	mis_emîgícy
;

239 
	#EMM_DATA_TAI_MAX
 16

	)

240 
TAI_LIST_T
(
EMM_DATA_TAI_MAX
Ë
	m…ai
;

242 
	m∂mn_mode
;

243 
	m∂mn_ödex
;

244 
	m∂mn_øt
;

246 
∂mn_t
 
	m•lmn
;

247 
	mis_Ωlmn
;

248 
	mis_ïlmn
;

249 
Sèt_t
 
	m°©
;

250 
èc_t
 
	mèc
;

251 
ci_t
 
	mci
;

252 
AcT_t
 
	møt
;

256 
	#EMM_DATA_BUFFER_SIZE
 2048

	)

257 
	mbuf„r
[
EMM_DATA_BUFFER_SIZE
+1];

258 } 
	m∂i°
;

264 
∂mn_t
 
	mh∂mn
;

271 
	#EMM_DATA_FPLMN_MAX
 4

	)

272 
PLMN_LIST_T
(
EMM_DATA_FPLMN_MAX
Ë
	mÂlmn
;

279 
	#EMM_DATA_FPLMN_GPRS_MAX
 4

	)

280 
PLMN_LIST_T
(
EMM_DATA_FPLMN_GPRS_MAX
Ë
	mÂlmn_g¥s
;

282 
	#EMM_DATA_EHPLMN_MAX
 4

	)

283 
PLMN_LIST_T
(
EMM_DATA_EHPLMN_MAX
Ë
	meh∂mn
;

285 
	#EMM_DATA_PLMN_MAX
 4

	)

286 
PLMN_LIST_T
(
EMM_DATA_PLMN_MAX
Ë
	m∂mn
;

287 
UI¡16_t
 
	mu£rAcT
[
EMM_DATA_PLMN_MAX
];

289 
	#EMM_DATA_OPLMN_MAX
 4

	)

290 
PLMN_LIST_T
(
EMM_DATA_OPLMN_MAX
Ë
	m›lmn
;

291 
UI¡16_t
 
	m›îAcT
[
EMM_DATA_OPLMN_MAX
];

293 
	#EMM_DATA_OPNN_MAX
 16

	)

294 
UI¡8_t
 
	mn_›¬s
;

296 c⁄° 
∂mn_t
 *
	m∂mn
;

297 c⁄° *
	mfuŒ«me
;

298 c⁄° *
	msh‹äame
;

299 } 
	m›¬
[
EMM_DATA_OPNN_MAX
];

309 
	#EMM_DATA_FTAI_MAX
 40

	)

310 
TAI_LIST_T
(
EMM_DATA_FTAI_MAX
Ë
	m·ai
;

316 
	#EMM_DATA_FTAI_ROAMING_MAX
 40

	)

317 
TAI_LIST_T
(
EMM_DATA_FTAI_ROAMING_MAX
Ë
	m·ai_rﬂmög
;

324 
Byã_t
 
	mNAS_Sig«ŒögPri‹ôy
;

325 
Byã_t
 
	mNMO_I_Behaviour
;

326 
Byã_t
 
	mAâachWôhImsi
;

327 
Byã_t
 
	mMöimumPîiodicSórchTimî
;

328 
Byã_t
 
	mExãndedAc˚ssB¨rög
;

329 
Byã_t
 
	mTimî_T3245_Behaviour
;

335 
emm_nvd©a_t
 
	mnvd©a
;

341 
emm_£curôy_c⁄ãxt_t
 *
	m£curôy
;

342 
emm_£curôy_c⁄ãxt_t
 *
	mn⁄_cuºít
;

344 } 
	temm_d©a_t
;

353 #ifde‡
NAS_MME


358 
	semm_d©a_c⁄ãxt_s
 {

359 #i‡
deföed
(
EPC_BUILD
)

360 
RB_ENTRY
(
emm_d©a_c⁄ãxt_s
Ë
	míåõs
;

363 
	mueid
;

364 
	mis_dy«mic
;

365 
	mis_©èched
;

366 
	mis_emîgícy
;

368 
imsi_t
 *
	mimsi
;

369 
imei_t
 *
	mimei
;

370 
	mguti_is_√w
;

371 
GUTI_t
 *
	mguti
;

372 
GUTI_t
 *
	mﬁd_guti
;

373 
	mn_ècs
;

375 
èc_t
 
	mèc
;

378 
	mksi
;

379 
	mìa
;

380 
	meü
;

381 
	mucs2
;

382 
	muó
;

383 
	muü
;

384 
	mgó
;

385 
	mumts_¥e£¡
;

386 
	mg¥s_¥e£¡
;

388 
auth_ve˘‹_t
 
	mve˘‹
;

389 
emm_£curôy_c⁄ãxt_t
 *
	m£curôy
;

390 
O˘ëSåög
 
	mesm_msg
;

391 
	memm_ˇu£
;

393 
emm_fsm_°©e_t
 
	m_emm_fsm_°©us
;

395 
esm_d©a_c⁄ãxt_t
 
	mesm_d©a_˘x
;

396 } 
	temm_d©a_c⁄ãxt_t
;

407 
mme_≠i_emm_c⁄fig_t
 
	mc⁄f
;

412 #i‡
deföed
(
EPC_BUILD
)

414 
RB_HEAD
(
emm_d©a_c⁄ãxt_m≠
, 
emm_d©a_c⁄ãxt_s
Ë
	m˘x_m≠
;

416 
	#EMM_DATA_NB_UE_MAX
 (
MME_API_NB_UE_MAX
 + 1)

	)

417 
emm_d©a_c⁄ãxt_t
 *
	m˘x
 [
EMM_DATA_NB_UE_MAX
];

419 } 
	temm_d©a_t
;

421 
emm_d©a_c⁄ãxt_s
 *
emm_d©a_c⁄ãxt_gë
(

422 
emm_d©a_t
 *
_emm_d©a
, 
_ueid
);

424 
emm_d©a_c⁄ãxt_s
 *
emm_d©a_c⁄ãxt_ªmove
(

425 
emm_d©a_t
 *
_emm_d©a
, 
emm_d©a_c⁄ãxt_s
 *
ñm
);

427 
emm_d©a_c⁄ãxt_add
(
emm_d©a_t
 *
emm_d©a
, 
emm_d©a_c⁄ãxt_s
 *
ñm
);

440 
emm_d©a_t
 
	g_emm_d©a
;

447 #ifde‡
NAS_UE


448 
	#T3402_DEFAULT_VALUE
 720

	)

449 
	#T3410_DEFAULT_VALUE
 15

	)

450 
	#T3411_DEFAULT_VALUE
 10

	)

451 
	#T3412_DEFAULT_VALUE
 3240

	)

452 
	#T3416_DEFAULT_VALUE
 30

	)

453 
	#T3417_DEFAULT_VALUE
 5

	)

454 
	#T3417ext_DEFAULT_VALUE
 10

	)

455 
	#T3418_DEFAULT_VALUE
 20

	)

456 
	#T3420_DEFAULT_VALUE
 15

	)

457 
	#T3421_DEFAULT_VALUE
 15

	)

458 
	#T3423_DEFAULT_VALUE
 
T3412_DEFAULT_VALUE


	)

459 
	#T3430_DEFAULT_VALUE
 15

	)

460 
	#T3440_DEFAULT_VALUE
 10

	)

462 
«s_timî_t
 
	gT3402
;

463 
«s_timî_t
 
	gT3410
;

464 
«s_timî_t
 
	gT3411
;

465 
«s_timî_t
 
	gT3412
;

466 
«s_timî_t
 
	gT3416
;

467 
«s_timî_t
 
	gT3417
;

468 
«s_timî_t
 
	gT3418
;

469 
«s_timî_t
 
	gT3420
;

470 
«s_timî_t
 
	gT3421
;

471 
«s_timî_t
 
	gT3430
;

473 
«s_timî_t
 
	gT3423
;

481 #ifde‡
NAS_MME


482 
	#T3450_DEFAULT_VALUE
 6

	)

483 
	#T3460_DEFAULT_VALUE
 6

	)

484 
	#T3470_DEFAULT_VALUE
 6

	)

486 
«s_timî_t
 
	gT3450
;

487 
«s_timî_t
 
	gT3460
;

488 
«s_timî_t
 
	gT3470
;

	@src/emm/emm_data_ctx.c

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

33 #i‡
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

34 
	~"as£πi⁄s.h
"

35 
	~"åì.h
"

36 
	~"emmD©a.h
"

37 
	~"«s_log.h
"

39 
ölöe


40 
emm_d©a_˘xt_com∑ª_ueid
(
emm_d©a_c⁄ãxt_s
 *
p1
,

41 
emm_d©a_c⁄ãxt_s
 *
p2
);

43 
RB_PROTOTYPE
(
emm_d©a_c⁄ãxt_m≠
, 
emm_d©a_c⁄ãxt_s
, 
íåõs
,

44 
emm_d©a_˘xt_com∑ª_ueid
);

47 
RB_GENERATE
(
emm_d©a_c⁄ãxt_m≠
, 
emm_d©a_c⁄ãxt_s
, 
íåõs
,

48 
emm_d©a_˘xt_com∑ª_ueid
);

50 
ölöe


51 
	$emm_d©a_˘xt_com∑ª_ueid
(
emm_d©a_c⁄ãxt_s
 *
p1
,

52 
emm_d©a_c⁄ãxt_s
 *
p2
)

54 i‡(
p1
->
ueid
 > 
p2
->ueid) {

57 i‡(
p1
->
ueid
 < 
p2
->ueid) {

62 
	}
}

64 
emm_d©a_c⁄ãxt_s
 *
	$emm_d©a_c⁄ãxt_gë
(

65 
emm_d©a_t
 *
emm_d©a
, 
_ueid
)

67 
emm_d©a_c⁄ãxt_s
 
ª„ªn˚
;

69 
	`DevAs£π
(
emm_d©a
 !
NULL
);

70 
	`DevCheck
(
_ueid
 > 0, _ueid, 0, 0);

72 
	`mem£t
(&
ª„ªn˚
, 0, (
emm_d©a_c⁄ãxt_s
));

73 
ª„ªn˚
.
ueid
 = 
_ueid
;

74  
	`RB_FIND
(
emm_d©a_c⁄ãxt_m≠
, &
emm_d©a
->
˘x_m≠
, &
ª„ªn˚
);

75 
	}
}

77 
emm_d©a_c⁄ãxt_s
 *
	$emm_d©a_c⁄ãxt_ªmove
(

78 
emm_d©a_t
 *
emm_d©a
, 
emm_d©a_c⁄ãxt_s
 *
ñm
)

80 
	`LOG_TRACE
(
INFO
, "EMM-CTX - Removêö c⁄ãxà%∞UE id %u", 
ñm
,Élm->
ueid
);

81  
	`RB_REMOVE
(
emm_d©a_c⁄ãxt_m≠
, &
emm_d©a
->
˘x_m≠
, 
ñm
);

82 
	}
}

84 
	$emm_d©a_c⁄ãxt_add
(
emm_d©a_t
 *
emm_d©a
, 
emm_d©a_c⁄ãxt_s
 *
ñm
)

86 
	`LOG_TRACE
(
INFO
, "EMM-CTX - Add i¿c⁄ãxà%∞UE id %u", 
ñm
,Élm->
ueid
);

87 
	`RB_INSERT
(
emm_d©a_c⁄ãxt_m≠
, &
emm_d©a
->
˘x_m≠
, 
ñm
);

88 
	}
}

	@src/emm/emm_main.c

47 
	~"emm_maö.h
"

48 
	~"«s_log.h
"

49 
	~"emmD©a.h
"

51 #ifde‡
NAS_UE


52 
	~"mem‹y.h
"

53 
	~"usim_≠i.h
"

54 
	~"IdÀMode.h
"

56 
	~<°rög.h
>

57 
	~<°dio.h
>

58 
	~<°dlib.h
>

61 #i‡
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

62 
	~"mme_c⁄fig.h
"

73 #ifde‡
NAS_UE


74 
_emm_maö_gë_imei
(
imei_t
 *
imei
, c⁄° *
imei_°r
);

76 
_emm_maö_imsi_cmp
(
imsi_t
 *
imsi1
, imsi_à*
imsi2
);

78 c⁄° *
_emm_maö_gë_∂mn
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

79 
f‹m©
, 
size_t
 *
size
);

81 
_emm_maö_gë_∂mn_ödex
(c⁄° *
∂mn
, 
f‹m©
);

86 
usim_d©a_t
 
	g_usim_d©a
;

92 
emm_ödiˇti⁄_ˇŒback_t
 
	g_emm_maö_u£r_ˇŒback
;

93 
_emm_maö_ˇŒback
();

100 #ifde‡
NAS_UE


117 
	$emm_maö_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
cb
, c⁄° *
imei
)

119 
LOG_FUNC_IN
;

122 
_emm_d©a
.
usim_is_vÆid
 = 
FALSE
;

124 
_emm_d©a
.
imei
 = (
imei_t
 *)
	`mÆloc
((imei_t));

125 
_emm_d©a
.
imei
->
Àngth
 = 
	`_emm_maö_gë_imei
(_emm_data.imei, imei);

127 
_emm_d©a
.
imsi
 = 
NULL
;

129 
_emm_d©a
.
guti
 = 
NULL
;

130 
_emm_d©a
.
èi
 = 
NULL
;

131 
_emm_d©a
.
…ai
.
n_èis
 = 0;

133 
_emm_d©a
.
ecm_°©us
 = 
ECM_IDLE
;

135 
_emm_d©a
.
∂mn_mode
 = 
EMM_DATA_PLMN_AUTO
;

137 
_emm_d©a
.
∂mn_ödex
 = -1;

139 
_emm_d©a
.
∂mn_øt
 = 
NET_ACCESS_UNAVAILABLE
;

141 
	`mem£t
(&
_emm_d©a
.
•lmn
, 0xFF, (
∂mn_t
));

142 
_emm_d©a
.
is_Ωlmn
 = 
FALSE
;

143 
_emm_d©a
.
is_ïlmn
 = 
FALSE
;

145 
_emm_d©a
.
øt
 = 
NET_ACCESS_UNAVAILABLE
;

147 
_emm_d©a
.
°©
 = 
NET_REG_STATE_OFF
;

148 
_emm_d©a
.
is_©èched
 = 
FALSE
;

149 
_emm_d©a
.
is_emîgícy
 = 
FALSE
;

151 
_emm_d©a
.
èc
 = 0;

153 
_emm_d©a
.
ci
 = 0;

155 
	`mem£t
(
_emm_d©a
.
∂i°
.
buf„r
, 0, 
EMM_DATA_BUFFER_SIZE
 + 1);

157 
	`mem£t
(&
_emm_d©a
.
h∂mn
, 0xFF, (
∂mn_t
));

159 
_emm_d©a
.
Âlmn
.
n_∂mns
 = 0;

161 
_emm_d©a
.
Âlmn_g¥s
.
n_∂mns
 = 0;

163 
_emm_d©a
.
eh∂mn
.
n_∂mns
 = 0;

165 
_emm_d©a
.
∂mn
.
n_∂mns
 = 0;

167 
_emm_d©a
.
›lmn
.
n_∂mns
 = 0;

169 
_emm_d©a
.
n_›¬s
 = 0;

171 
_emm_d©a
.
·ai
.
n_èis
 = 0;

173 
_emm_d©a
.
·ai_rﬂmög
.
n_èis
 = 0;

178 i‡–
	`usim_≠i_ªad
(&
_usim_d©a
Ë!
RETURNok
 ) {

180 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - FailedÅoÑead USIMápplication data");

182 
i
;

185 
	`LOG_TRACE
(
INFO
, "EMM-MAIN - USIMápplication data successfullyÑead");

186 
_emm_d©a
.
usim_is_vÆid
 = 
TRUE
;

189 
_emm_d©a
.
h∂mn
.
MCCdigô1
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô1
;

190 
_emm_d©a
.
h∂mn
.
MCCdigô2
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô2
;

191 
_emm_d©a
.
h∂mn
.
MCCdigô3
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô3
;

192 
_emm_d©a
.
h∂mn
.
MNCdigô1
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô4
;

193 
_emm_d©a
.
h∂mn
.
MNCdigô2
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô5
;

194 
_emm_d©a
.
h∂mn
.
MNCdigô3
 = 
_usim_d©a
.
imsi
.
u
.
num
.
digô6
;

197 
i
=0; (ò< 
EMM_DATA_FPLMN_MAX
Ë&& (ò< 
USIM_FPLMN_MAX
); i++) {

198 i‡–
	`PLMN_IS_VALID
(
_usim_d©a
.
Âlmn
[
i
]) ) {

199 
_emm_d©a
.
Âlmn
.
∂mn
[
i
] = 
_usim_d©a
.fplmn[i];

200 
_emm_d©a
.
Âlmn
.
n_∂mns
 += 1;

205 
i
=0; (ò< 
EMM_DATA_EHPLMN_MAX
Ë&& (ò< 
USIM_EHPLMN_MAX
); i++) {

206 i‡–
	`PLMN_IS_VALID
(
_usim_d©a
.
eh∂mn
[
i
]) ) {

207 
_emm_d©a
.
eh∂mn
.
∂mn
[
i
] = 
_usim_d©a
.ehplmn[i];

208 
_emm_d©a
.
eh∂mn
.
n_∂mns
 += 1;

213 
i
=0; (ò< 
EMM_DATA_PLMN_MAX
Ë&& (ò< 
USIM_PLMN_MAX
); i++) {

214 i‡–
	`PLMN_IS_VALID
(
_usim_d©a
.
∂mn
[
i
].plmn) ) {

215 
_emm_d©a
.
∂mn
.∂mn[
i
] = 
_usim_d©a
.plmn[i].plmn;

216 
_emm_d©a
.
u£rAcT
[
i
] = 
_usim_d©a
.
∂mn
[i].
AcT
;

217 
_emm_d©a
.
∂mn
.
n_∂mns
 += 1;

222 
i
=0; (ò< 
EMM_DATA_OPLMN_MAX
Ë&& (ò< 
USIM_OPLMN_MAX
); i++) {

223 i‡–
	`PLMN_IS_VALID
(
_usim_d©a
.
›lmn
[
i
].
∂mn
) ) {

224 
_emm_d©a
.
›lmn
.
∂mn
[
i
] = 
_usim_d©a
.oplmn[i].plmn;

225 
_emm_d©a
.
›îAcT
[
i
] = 
_usim_d©a
.
›lmn
[i].
AcT
;

226 
_emm_d©a
.
›lmn
.
n_∂mns
 += 1;

231 
i
=0; (ò< 
EMM_DATA_OPNN_MAX
Ë&& (ò< 
USIM_OPL_MAX
); i++) {

232 i‡–
	`PLMN_IS_VALID
(
_usim_d©a
.
›l
[
i
].
∂mn
) ) {

233 
≤n_id
 = 
_usim_d©a
.
›l
[
i
].
ªc‹d_id
;

234 
_emm_d©a
.
›¬
[
i
].
∂mn
 = &
_usim_d©a
.
›l
[i].plmn;

235 
_emm_d©a
.
›¬
[
i
].
fuŒ«me
 = (*)
_usim_d©a
.
≤n
[
≤n_id
].fuŒ«me.
vÆue
;

236 
_emm_d©a
.
›¬
[
i
].
sh‹äame
 = (*)
_usim_d©a
.
≤n
[
≤n_id
].sh‹äame.
vÆue
;

237 
_emm_d©a
.
n_›¬s
 += 1;

244 i‡(
	`PLMN_IS_VALID
(
_usim_d©a
.
ï¶oci
.
guti
.
gummei
.
∂mn
)) {

245 
_emm_d©a
.
guti
 = &
_usim_d©a
.
ï¶oci
.guti;

247 i‡(
	`TAI_IS_VALID
(
_usim_d©a
.
ï¶oci
.
èi
)) {

248 
_emm_d©a
.
èi
 = &
_usim_d©a
.
ï¶oci
.tai;

250 
_emm_d©a
.
°©us
 = 
_usim_d©a
.
ï¶oci
.status;

253 
_emm_d©a
.
NAS_Sig«ŒögPri‹ôy
 =

254 
_usim_d©a
.
«sc⁄fig
.
NAS_Sig«ŒögPri‹ôy
.
vÆue
[0];

255 
_emm_d©a
.
NMO_I_Behaviour
 = 
_usim_d©a
.
«sc⁄fig
.NMO_I_Behaviour.
vÆue
[0];

256 
_emm_d©a
.
AâachWôhImsi
 = 
_usim_d©a
.
«sc⁄fig
.AâachWôhImsi.
vÆue
[0];

257 
_emm_d©a
.
MöimumPîiodicSórchTimî
 =

258 
_usim_d©a
.
«sc⁄fig
.
MöimumPîiodicSórchTimî
.
vÆue
[0];

259 
_emm_d©a
.
ExãndedAc˚ssB¨rög
 =

260 
_usim_d©a
.
«sc⁄fig
.
ExãndedAc˚ssB¨rög
.
vÆue
[0];

261 
_emm_d©a
.
Timî_T3245_Behaviour
 =

262 
_usim_d©a
.
«sc⁄fig
.
Timî_T3245_Behaviour
.
vÆue
[0];

268 
_emm_d©a
.
£curôy
 =

269 (
emm_£curôy_c⁄ãxt_t
 *)
	`mÆloc
((emm_security_context_t));

270 i‡(
_emm_d©a
.
£curôy
 !
NULL
) {

271 
	`mem£t
(
_emm_d©a
.
£curôy
, 0, (
emm_£curôy_c⁄ãxt_t
));

273 i‡(
_usim_d©a
.
£curôy˘x
.
KSIasme
.
vÆue
[0] !=

274 
USIM_KSI_NOT_AVAILABLE
) {

275 
_emm_d©a
.
£curôy
->
ty≥
 = 
EMM_KSI_NATIVE
;

277 
_emm_d©a
.
£curôy
->
ty≥
 = 
EMM_KSI_NOT_AVAILABLE
;

280 
_emm_d©a
.
£curôy
->
eksi
 = 
_usim_d©a
.
£curôy˘x
.
KSIasme
.
vÆue
[0];

282 
_emm_d©a
.
£curôy
->
kasme
.
Àngth
 =

283 
_usim_d©a
.
£curôy˘x
.
Kasme
.
Àngth
;

284 
_emm_d©a
.
£curôy
->
kasme
.
vÆue
 =

285 (
uöt8_t
 *)
	`mÆloc
(
_emm_d©a
.
£curôy
->
kasme
.
Àngth
);

286 i‡(
_emm_d©a
.
£curôy
->
kasme
.
vÆue
) {

287 
	`mem˝y
(
_emm_d©a
.
£curôy
->
kasme
.
vÆue
,

288 
_usim_d©a
.
£curôy˘x
.
Kasme
.
vÆue
,

289 
_emm_d©a
.
£curôy
->
kasme
.
Àngth
);

292 i‡(
_usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
Àngth
 <(
UI¡32_t
)) {

293 
	`mem˝y
(&
_emm_d©a
.
£curôy
->
dl_cou¡
,

294 
_usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
vÆue
,

295 
_usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
Àngth
);

298 i‡(
_usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
Àngth
 <(
UI¡32_t
)) {

299 
	`mem˝y
(&
_emm_d©a
.
£curôy
->
ul_cou¡
,

300 
_usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
vÆue
,

301 
_usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
Àngth
);

304 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_í¸y±i⁄
 =

305 ((
_usim_d©a
.
£curôy˘x
.
Æg‹ôhmID
.
vÆue
[0] >> 4) & 0xf);

307 
_emm_d©a
.
£curôy
->
ˇ∑bûôy
.
ïs_öãgrôy
 =

308 (
_usim_d©a
.
£curôy˘x
.
Æg‹ôhmID
.
vÆue
[0] & 0xf);

311 
	`LOG_TRACE
(
WARNING
,

318 
	`mem£t
(&
_emm_d©a
.
nvd©a
.
Ωlmn
, 0xFF, (
∂mn_t
));

319 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

321 *
∑th
 = 
	`mem‹y_gë_∑th
(
EMM_NVRAM_DIRNAME
, 
EMM_NVRAM_FILENAME
);

322 i‡(
∑th
 =
NULL
) {

323 
	`LOG_TRACE
(
ERROR
, "EMM-MAIN - FailedÅo get EMM dataÖathname");

326 
rc
 = 
	`mem‹y_ªad
(
∑th
, &
_emm_d©a
.
nvd©a
, (
emm_nvd©a_t
));

327 i‡(
rc
 !
RETURNok
) {

328 
	`LOG_TRACE
(
ERROR
, "EMM-MAIN - FaûedÅÿªad %s", 
∑th
);

331 
	`LOG_TRACE
(
INFO
, "EMM-MAIN - EMM data successfullyÑead");

332 
_emm_d©a
.
imsi
 = &
_usim_d©a
.imsi;

333 
imsi_ok
 = 
	`_emm_maö_imsi_cmp
(&
_emm_d©a
.
nvd©a
.
imsi
,

334 &
_usim_d©a
.
imsi
);

335 i‡(!
imsi_ok
) {

336 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - IMSI checking failedÇvram: "

339 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[0],

340 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[1],

341 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[2],

342 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[3],

343 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[4],

344 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[5],

345 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[6],

346 
_emm_d©a
.
nvd©a
.
imsi
.
u
.
vÆue
[7],

347 
_usim_d©a
.
imsi
.
u
.
vÆue
[0],

348 
_usim_d©a
.
imsi
.
u
.
vÆue
[1],

349 
_usim_d©a
.
imsi
.
u
.
vÆue
[2],

350 
_usim_d©a
.
imsi
.
u
.
vÆue
[3],

351 
_usim_d©a
.
imsi
.
u
.
vÆue
[4],

352 
_usim_d©a
.
imsi
.
u
.
vÆue
[5],

353 
_usim_d©a
.
imsi
.
u
.
vÆue
[6],

354 
_usim_d©a
.
imsi
.
u
.
vÆue
[7]);

355 
	`mem£t
(&
_emm_d©a
.
nvd©a
.
Ωlmn
, 0xFF, (
∂mn_t
));

356 
_emm_d©a
.
nvd©a
.
ïlmn
.
n_∂mns
 = 0;

359 
	`‰ì
(
∑th
);

366 
T3410
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

367 
T3410
.
£c
 = 
T3410_DEFAULT_VALUE
;

368 
T3411
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

369 
T3411
.
£c
 = 
T3411_DEFAULT_VALUE
;

370 
T3402
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

371 
T3402
.
£c
 = 
T3402_DEFAULT_VALUE
;

372 
T3416
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

373 
T3416
.
£c
 = 
T3416_DEFAULT_VALUE
;

374 
T3417
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

375 
T3417
.
£c
 = 
T3417_DEFAULT_VALUE
;

376 
T3418
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

377 
T3418
.
£c
 = 
T3418_DEFAULT_VALUE
;

378 
T3420
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

379 
T3420
.
£c
 = 
T3420_DEFAULT_VALUE
;

380 
T3421
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

381 
T3421
.
£c
 = 
T3421_DEFAULT_VALUE
;

382 
T3423
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

383 
T3423
.
£c
 = 
T3423_DEFAULT_VALUE
;

384 
T3430
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

385 
T3430
.
£c
 = 
T3430_DEFAULT_VALUE
;

390 
_emm_maö_u£r_ˇŒback
 = *
cb
;

395 
	`IdÀMode_öôülize
(&
_emm_maö_ˇŒback
);

397 
LOG_FUNC_OUT
;

398 
	}
}

400 #ifde‡
NAS_MME


415 #i‡
deföed
(
EPC_BUILD
)

416 
	$emm_maö_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
)

418 
	$emm_maö_öôülize
()

421 
LOG_FUNC_IN
;

424 #i‡
	`deföed
(
EPC_BUILD
)

425 i‡(
	`mme_≠i_gë_emm_c⁄fig
(&
_emm_d©a
.
c⁄f
, 
mme_c⁄fig_p
Ë!
RETURNok
)

427 i‡(
	`mme_≠i_gë_emm_c⁄fig
(&
_emm_d©a
.
c⁄f
Ë!
RETURNok
)

430 
	`LOG_TRACE
(
ERROR
, "EMM-MAIN - FailedÅo get MME configuration data");

433 #i‡
	`deföed
(
EPC_BUILD
)

434 
	`RB_INIT
(&
_emm_d©a
.
˘x_m≠
);

440 
T3450
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

441 
T3450
.
£c
 = 
T3450_DEFAULT_VALUE
;

442 
T3460
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

443 
T3460
.
£c
 = 
T3460_DEFAULT_VALUE
;

444 
T3470
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

445 
T3470
.
£c
 = 
T3470_DEFAULT_VALUE
;

447 
LOG_FUNC_OUT
;

448 
	}
}

465 
	$emm_maö_˛ónup
()

467 
LOG_FUNC_IN
;

469 #ifde‡
NAS_UE


471 i‡(
_emm_d©a
.
usim_is_vÆid
) {

476 
i
;

478 
i
=0; (ò< 
_emm_d©a
.
Âlmn
.
n_∂mns
Ë&& (ò< 
USIM_FPLMN_MAX
); i++) {

479 
_usim_d©a
.
Âlmn
[
i
] = 
_emm_d©a
.Âlmn.
∂mn
[i];

482 
i
=0; (ò< 
_emm_d©a
.
eh∂mn
.
n_∂mns
Ë&& (ò< 
USIM_EHPLMN_MAX
); i++) {

483 
_usim_d©a
.
eh∂mn
[
i
] = 
_emm_d©a
.eh∂mn.
∂mn
[i];

486 i‡(
_emm_d©a
.
guti
) {

487 
_usim_d©a
.
ï¶oci
.
guti
 = *(
_emm_d©a
.guti);

490 i‡(
_emm_d©a
.
èi
) {

491 
_usim_d©a
.
ï¶oci
.
èi
 = *(
_emm_d©a
.tai);

494 
_usim_d©a
.
ï¶oci
.
°©us
 = 
_emm_d©a
.status;

496 i‡(
_emm_d©a
.
£curôy
 && (_emm_d©a.£curôy->
ty≥
 =
EMM_KSI_NATIVE
)) {

505 i‡–
	`usim_≠i_wrôe
(&
_usim_d©a
Ë!
RETURNok
 ) {

507 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - "

511 
	}
}

518 *
	g∑th
 = 
mem‹y_gë_∑th
(
EMM_NVRAM_DIRNAME
, 
EMM_NVRAM_FILENAME
);

519 i‡(
	g∑th
 =
NULL
) {

520 
LOG_TRACE
(
ERROR
, "EMM-MAIN - FailedÅo get EMM dataÖathname");

522 
	grc
 = 
mem‹y_wrôe
(
∑th
, &
_emm_d©a
.
nvd©a
, (
emm_nvd©a_t
));

523 i‡(
	grc
 !
RETURNok
) {

524 
LOG_TRACE
(
ERROR
, "EMM-MAIN - FaûedÅÿwrôê%s", 
∑th
);

529 i‡(
	g_emm_d©a
.
	gimei
) {

530 
‰ì
(
_emm_d©a
.
imei
);

531 
	g_emm_d©a
.
	gimei
 = 
NULL
;

533 i‡(
	g_emm_d©a
.
	g£curôy
) {

534 
emm_£curôy_c⁄ãxt_t
 *
	g£curôy
 = 
_emm_d©a
.
£curôy
;

535 i‡(
	g£curôy
->
	gkasme
.
	gvÆue
) {

536 
‰ì
(
£curôy
->
kasme
.
vÆue
);

537 
	g£curôy
->
	gkasme
.
	gvÆue
 = 
NULL
;

538 
	g£curôy
->
	gkasme
.
	gÀngth
 = 0;

540 i‡(
	g£curôy
->
	gk«s_íc
.
	gvÆue
) {

541 
‰ì
(
£curôy
->
k«s_íc
.
vÆue
);

542 
	g£curôy
->
	gk«s_íc
.
	gvÆue
 = 
NULL
;

543 
	g£curôy
->
	gk«s_íc
.
	gÀngth
 = 0;

545 i‡(
	g£curôy
->
	gk«s_öt
.
	gvÆue
) {

546 
‰ì
(
£curôy
->
k«s_öt
.
vÆue
);

547 
	g£curôy
->
	gk«s_öt
.
	gvÆue
 = 
NULL
;

548 
	g£curôy
->
	gk«s_öt
.
	gÀngth
 = 0;

550 
‰ì
(
_emm_d©a
.
£curôy
);

551 
	g_emm_d©a
.
	g£curôy
 = 
NULL
;

556 
	gLOG_FUNC_OUT
;

559 #ifde‡
NAS_UE


574 c⁄° 
imsi_t
 *
	$emm_maö_gë_imsi
()

576 
LOG_FUNC_IN
;

577 
	`LOG_FUNC_RETURN
 (&
_emm_d©a
.
nvd©a
.
imsi
);

578 
	}
}

594 c⁄° 
msisdn_t
 *
	$emm_maö_gë_msisdn
()

596 
LOG_FUNC_IN
;

597 
	`LOG_FUNC_RETURN
 (&
_usim_d©a
.
msisdn
.
numbî
);

598 
	}
}

621 
	$emm_maö_£t_∂mn_£À˘i⁄_mode
(
mode
, 
f‹m©
,

622 c⁄° 
√tw‹k_∂mn_t
 *
∂mn
, 
øt
)

624 
LOG_FUNC_IN
;

626 
ödex
;

628 
	`LOG_TRACE
(
INFO
, "EMM-MAIN - PLMN selection: mode=%d, format=%d,Ölmn=%s, "

629 "øt=%d", 
mode
, 
f‹m©
, (c⁄° *)&
∂mn
->
id
, 
øt
);

631 
_emm_d©a
.
∂mn_mode
 = 
mode
;

633 i‡(
mode
 !
EMM_DATA_PLMN_AUTO
) {

635 
ödex
 = 
	`_emm_maö_gë_∂mn_ödex
((c⁄° *)&
∂mn
->
id
, 
f‹m©
);

636 i‡(
ödex
 < 0) {

637 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - PLMN %sÇotávailable",

638 (c⁄° *)&
∂mn
->
id
);

641 
_emm_d©a
.
∂mn_ödex
 = 
ödex
;

642 
_emm_d©a
.
∂mn_øt
 = 
øt
;

650 
ödex
 = 
	`IdÀMode_gë_h∂mn_ödex
();

653 
	`LOG_FUNC_RETURN
 (
ödex
);

654 
	}
}

671 
	$emm_maö_gë_∂mn_£À˘i⁄_mode
()

673 
LOG_FUNC_IN
;

674 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
∂mn_mode
);

675 
	}
}

691 
	$emm_maö_gë_∂mn_li°
(c⁄° **
∂i°
)

693 
LOG_FUNC_IN
;

695 
size
 = 
	`IdÀMode_upd©e_∂mn_li°
(0);

696 *
∂i°
 = 
_emm_d©a
.∂i°.
buf„r
;

698 
	`LOG_FUNC_RETURN
 (
size
);

699 
	}
}

718 c⁄° *
	$emm_maö_gë_£À˘ed_∂mn
(
√tw‹k_∂mn_t
 *
∂mn
, 
f‹m©
)

720 
LOG_FUNC_IN
;

722 
size_t
 
size
 = 0;

726 
ödex
 = 
	`IdÀMode_gë_•lmn_ödex
();

727 i‡–!(
ödex
 < 0) ) {

728 c⁄° *
«me
 = 
	`_emm_maö_gë_∂mn
(&
_emm_d©a
.
•lmn
, 
ödex
,

729 
f‹m©
, &
size
);

730 i‡(
size
 > 0) {

731 
	`LOG_FUNC_RETURN
 ((*Ë
	`mem˝y
(&
∂mn
->
id
, 
«me
, 
size
));

735 
	`LOG_FUNC_RETURN
 (
NULL
);

736 
	}
}

755 c⁄° *
	$emm_maö_gë_ªgi°îed_∂mn
(
√tw‹k_∂mn_t
 *
∂mn
, 
f‹m©
)

757 
LOG_FUNC_IN
;

759 
size_t
 
size
 = 0;

764 
ödex
 = 
	`IdÀMode_gë_Ωlmn_ödex
();

765 i‡–!(
ödex
 < 0) ) {

766 c⁄° *
«me
 = 
	`_emm_maö_gë_∂mn
(&
_emm_d©a
.
nvd©a
.
Ωlmn
,

767 
ödex
, 
f‹m©
, &
size
);

768 i‡(
size
 > 0) {

769 
	`LOG_FUNC_RETURN
 ((*Ë
	`mem˝y
(&
∂mn
->
id
, 
«me
, 
size
));

773 
	`LOG_FUNC_RETURN
 (
NULL
);

774 
	}
}

792 
Sèt_t
 
	$emm_maö_gë_∂mn_°©us
()

794 
LOG_FUNC_IN
;

795 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
°©
);

796 
	}
}

813 
èc_t
 
	$emm_maö_gë_∂mn_èc
()

815 
LOG_FUNC_IN
;

816 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
èc
);

817 
	}
}

833 
ci_t
 
	$emm_maö_gë_∂mn_ci
()

835 
LOG_FUNC_IN
;

836 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
ci
);

837 
	}
}

855 
AcT_t
 
	$emm_maö_gë_∂mn_øt
()

857 
LOG_FUNC_IN
;

858 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
øt
);

859 
	}
}

877 
	$emm_maö_is_©èched
()

879 
LOG_FUNC_IN
;

880 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
is_©èched
);

881 
	}
}

900 
	$emm_maö_is_emîgícy
()

902 
LOG_FUNC_IN
;

903 
	`LOG_FUNC_RETURN
 (
_emm_d©a
.
is_©èched
 && _emm_d©a.
is_emîgícy
);

904 
	}
}

911 #ifde‡
NAS_UE


931 
	$_emm_maö_ˇŒback
(
size
)

933 
LOG_FUNC_IN
;

936 
rc
 = (*
_emm_maö_u£r_ˇŒback
)(
_emm_d©a
.
°©
, _emm_d©a.
èc
,

937 
_emm_d©a
.
ci
, _emm_d©a.
øt
,

938 
_emm_d©a
.
∂i°
.
buf„r
, 
size
);

940 
	`LOG_FUNC_RETURN
 (
rc
);

941 
	}
}

958 
	$_emm_maö_gë_imei
(
imei_t
 *
imei
, c⁄° *
imei_°r
)

960 
Àn
 = 
	`°æí
(
imei_°r
);

961 i‡(
Àn
 % 2) {

962 
imei
->
u
.
num
.
∑rôy
 = 
ODD_PARITY
;

964 
imei
->
u
.
num
.
∑rôy
 = 
EVEN_PARITY
;

966 
imei
->
u
.
num
.
digô1
 = 
imei_°r
[0] - '0';

967 
imei
->
u
.
num
.
digô2
 = 
imei_°r
[1] - '0';

968 
imei
->
u
.
num
.
digô3
 = 
imei_°r
[2] - '0';

969 
imei
->
u
.
num
.
digô4
 = 
imei_°r
[3] - '0';

970 
imei
->
u
.
num
.
digô5
 = 
imei_°r
[4] - '0';

971 
imei
->
u
.
num
.
digô6
 = 
imei_°r
[5] - '0';

972 
imei
->
u
.
num
.
digô7
 = 
imei_°r
[6] - '0';

973 
imei
->
u
.
num
.
digô8
 = 
imei_°r
[7] - '0';

974 
imei
->
u
.
num
.
digô9
 = 
imei_°r
[8] - '0';

975 
imei
->
u
.
num
.
digô10
 = 
imei_°r
[9] - '0';

976 
imei
->
u
.
num
.
digô11
 = 
imei_°r
[10] - '0';

977 
imei
->
u
.
num
.
digô12
 = 
imei_°r
[11] - '0';

978 
imei
->
u
.
num
.
digô13
 = 
imei_°r
[12] - '0';

979 
imei
->
u
.
num
.
digô14
 = 
imei_°r
[13] - '0';

980 
imei
->
u
.
num
.
digô15
 = 
imei_°r
[14] - '0';

981  (
Àn
);

982 
	}
}

1000 
	$_emm_maö_imsi_cmp
(
imsi_t
 *
imsi1
, imsi_à*
imsi2
)

1002 
i
;

1004 i‡(
imsi1
->
Àngth
 !
imsi2
->length) {

1005  
FALSE
;

1007 
i
 = 0; i < 
imsi1
->
Àngth
; i++) {

1008 i‡(
imsi1
->
u
.
vÆue
[
i
] !
imsi2
->u.value[i]) {

1009  
FALSE
;

1012  
TRUE
;

1013 
	}
}

1034 c⁄° *
	$_emm_maö_gë_∂mn
(c⁄° 
∂mn_t
 *
∂mn
, 
ödex
,

1035 
f‹m©
, 
size_t
 *
size
)

1037 i‡–
	`PLMN_IS_VALID
(*
∂mn
) ) {

1038 
f‹m©
) {

1039 
NET_FORMAT_LONG
:

1041  
	`IdÀMode_gë_∂mn_fuŒ«me
(
∂mn
, 
ödex
, 
size
);

1044 
NET_FORMAT_SHORT
:

1046  
	`IdÀMode_gë_∂mn_sh‹äame
(
∂mn
, 
ödex
, 
size
);

1049 
NET_FORMAT_NUM
:

1051  
	`IdÀMode_gë_∂mn_id
(
∂mn
, 
ödex
, 
size
);

1055 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - Format isÇot valid (%d)",

1056 
f‹m©
);

1057 *
size
 = 0;

1061  (
NULL
);

1062 
	}
}

1083 
	$_emm_maö_gë_∂mn_ödex
(c⁄° *
∂mn
, 
f‹m©
)

1085 
ödex
 = -1;

1086 
f‹m©
) {

1087 
NET_FORMAT_LONG
:

1089 
ödex
 = 
	`IdÀMode_gë_∂mn_fuŒ«me_ödex
(
∂mn
);

1092 
NET_FORMAT_SHORT
:

1094 
ödex
 = 
	`IdÀMode_gë_∂mn_sh‹äame_ödex
(
∂mn
);

1097 
NET_FORMAT_NUM
:

1099 
ödex
 = 
	`IdÀMode_gë_∂mn_id_ödex
(
∂mn
);

1103 
	`LOG_TRACE
(
WARNING
, "EMM-MAIN - F‹m© i†nŸ vÆid (%d)", 
f‹m©
);

1106  (
ödex
);

1107 
	}
}

	@src/emm/emm_main.h

46 #i‚de‡
__EMM_MAIN_H__


47 
	#__EMM_MAIN_H__


	)

49 #i‡
deföed
(
EPC_BUILD
)

50 
	~"mme_c⁄fig.h
"

53 
	~"comm⁄Def.h
"

54 
	~"√tw‹kDef.h
"

72 #ifde‡
NAS_UE


73 
emm_maö_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
cb
, c⁄° *
imei
);

75 #ifde‡
NAS_MME


76 #i‡
deföed
(
EPC_BUILD
)

77 
emm_maö_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
);

79 
emm_maö_öôülize
();

82 
emm_maö_˛ónup
();

84 #ifde‡
NAS_UE


87 c⁄° 
imsi_t
 *
emm_maö_gë_imsi
();

90 c⁄° 
msisdn_t
 *
emm_maö_gë_msisdn
();

93 
emm_maö_£t_∂mn_£À˘i⁄_mode
(
mode
, 
f‹m©
,

94 c⁄° 
√tw‹k_∂mn_t
 *
∂mn
, 
øt
);

95 
emm_maö_gë_∂mn_£À˘i⁄_mode
();

96 
emm_maö_gë_∂mn_li°
(c⁄° **
∂i°
);

97 c⁄° *
emm_maö_gë_£À˘ed_∂mn
(
√tw‹k_∂mn_t
 *
∂mn
, 
f‹m©
);

100 
Sèt_t
 
emm_maö_gë_∂mn_°©us
();

101 
èc_t
 
emm_maö_gë_∂mn_èc
();

102 
ci_t
 
emm_maö_gë_∂mn_ci
();

103 
AcT_t
 
emm_maö_gë_∂mn_øt
();

104 c⁄° *
emm_maö_gë_ªgi°îed_∂mn
(
√tw‹k_∂mn_t
 *
∂mn
, 
f‹m©
);

107 
emm_maö_is_©èched
();

108 
emm_maö_is_emîgícy
();

	@src/emm/emm_proc.h

46 #i‚de‡
__EMM_PROC_H__


47 
	#__EMM_PROC_H__


	)

49 
	~"comm⁄Def.h
"

50 
	~"O˘ëSåög.h
"

52 #ifde‡
NAS_MME


53 
	~"EmmComm⁄.h
"

54 
	~"emmD©a.h
"

57 #ifde‡
NAS_UE


58 
	~"LowîLayî.h
"

67 
	mEMM_ATTACH_TYPE_EPS
 = 0,

68 
	mEMM_ATTACH_TYPE_IMSI
,

69 
	mEMM_ATTACH_TYPE_EMERGENCY
,

70 
	mEMM_ATTACH_TYPE_RESERVED
,

71 } 
	temm_¥oc_©èch_ty≥_t
;

75 
	mEMM_DETACH_TYPE_EPS
 = 0,

76 
	mEMM_DETACH_TYPE_IMSI
,

77 
	mEMM_DETACH_TYPE_EPS_IMSI
,

78 
	mEMM_DETACH_TYPE_REATTACH
,

79 
	mEMM_DETACH_TYPE_NOT_REATTACH
,

80 
	mEMM_DETACH_TYPE_RESERVED
,

81 } 
	temm_¥oc_dëach_ty≥_t
;

85 
	mEMM_IDENT_TYPE_NOT_AVAILABLE
 = 0,

86 
	mEMM_IDENT_TYPE_IMSI
,

87 
	mEMM_IDENT_TYPE_IMEI
,

88 
	mEMM_IDENT_TYPE_IMEISV
,

89 
	mEMM_IDENT_TYPE_TMSI


90 } 
	temm_¥oc_idítôy_ty≥_t
;

109 
emm_¥oc_°©us_öd
(
ueid
, 
emm_ˇu£
);

110 
emm_¥oc_°©us
(
ueid
, 
emm_ˇu£
);

117 #ifde‡
NAS_UE


118 
emm_¥oc_lowîœyî_öôülize
(
lowîœyî_suc˚ss_ˇŒback_t
 
suc˚ss
,

119 
lowîœyî_Áûuª_ˇŒback_t
 
Áûuª
,

120 
lowîœyî_ªÀa£_ˇŒback_t
 
ªÀa£
,

121 *
¨gs
);

122 
emm_¥oc_lowîœyî_suc˚ss
();

123 
emm_¥oc_lowîœyî_Áûuª
(
is_öôül
);

124 
emm_¥oc_lowîœyî_ªÀa£
();

132 #ifde‡
NAS_UE


133 
emm_¥oc_öôülize
();

134 
emm_¥oc_∂mn_£À˘i⁄
(
ödex
);

135 
emm_¥oc_∂mn_£À˘i⁄_íd
(
found
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
);

143 #ifde‡
NAS_UE


144 
emm_¥oc_©èch
(
emm_¥oc_©èch_ty≥_t
 
ty≥
);

145 
emm_¥oc_©èch_ªque°
(*
¨gs
);

146 
emm_¥oc_©èch_ac˚±
(
T3412
, 
T3402
, 
T3423
, 
n_èis
,

147 
èi_t
 *
èi
, 
GUTI_t
 *
guti
, 
n_ïlmns
, 
∂mn_t
 *
ïlmn
,

148 c⁄° 
O˘ëSåög
 *
esm_msg
);

149 
emm_¥oc_©èch_ªje˘
(
emm_ˇu£
, c⁄° 
O˘ëSåög
 *
esm_msg
);

150 
emm_¥oc_©èch_com∂ëe
(*
¨gs
);

151 
emm_¥oc_©èch_Áûuª
(
is_öôül
, *
¨gs
);

152 
emm_¥oc_©èch_ªÀa£
(*
¨gs
);

153 
emm_¥oc_©èch_ª°¨t
();

155 
emm_¥oc_©èch_£t_emîgícy
();

156 
emm_¥oc_©èch_£t_dëach
();

159 #ifde‡
NAS_MME


160 
emm_¥oc_©èch_ªque°
(
ueid
, 
emm_¥oc_©èch_ty≥_t
 
ty≥
,

161 
«tive_ksi
, 
ksi
, 
«tive_guti
, 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
,

162 
imei_t
 *
imei
, 
èi_t
 *
èi
, 
ìa
, 
eü
, 
ucs2
, 
uó
, 
uü
, 
gó
,

163 
umts_¥e£¡
, 
g¥s_¥e£¡
, c⁄° 
O˘ëSåög
 *
esm_msg
);

164 
emm_¥oc_©èch_ªje˘
(
ueid
, 
emm_ˇu£
);

165 
emm_¥oc_©èch_com∂ëe
(
ueid
, c⁄° 
O˘ëSåög
 *
esm_msg
);

166 
emm_¥oc_åackög_¨ó_upd©e_ªje˘
(
ueid
, 
emm_ˇu£
);

174 #ifde‡
NAS_UE


175 
emm_¥oc_dëach
(
emm_¥oc_dëach_ty≥_t
 
ty≥
, 
swôch_off
);

176 
emm_¥oc_dëach_ªque°
(*
¨gs
);

177 
emm_¥oc_dëach_ac˚±
();

178 
emm_¥oc_dëach_Áûuª
(
is_öôül
, *
¨gs
);

179 
emm_¥oc_dëach_ªÀa£
(*
¨gs
);

182 #ifde‡
NAS_MME


183 
emm_¥oc_dëach
(
ueid
, 
emm_¥oc_dëach_ty≥_t
 
ty≥
);

184 
emm_¥oc_dëach_ªque°
(
ueid
, 
emm_¥oc_dëach_ty≥_t
 
ty≥
,

185 
swôch_off
, 
«tive_ksi
, 
ksi
, 
GUTI_t
 *
guti
, 
imsi_t
 *
imsi
,

186 
imei_t
 *
imei
);

194 #ifde‡
NAS_UE


195 
emm_¥oc_idítifiˇti⁄_ªque°
(
emm_¥oc_idítôy_ty≥_t
 
ty≥
);

198 #ifde‡
NAS_MME


199 
emm_¥oc_idítifiˇti⁄
(
ueid
,

200 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
,

201 
emm_¥oc_idítôy_ty≥_t
 
ty≥
,

202 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

203 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

204 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
);

205 
emm_¥oc_idítifiˇti⁄_com∂ëe
(
ueid
, c⁄° 
imsi_t
 *
imsi
,

206 c⁄° 
imei_t
 *
imei
, 
UI¡32_t
 *
tmsi
);

214 #ifde‡
NAS_UE


215 
emm_¥oc_authítiˇti⁄_ªque°
(
«tive_ksi
, 
ksi
,

216 c⁄° 
O˘ëSåög
 *
ønd
, c⁄° O˘ëSåög *
auä
);

217 
emm_¥oc_authítiˇti⁄_ªje˘
();

218 
emm_¥oc_authítiˇti⁄_dñëe
();

221 #ifde‡
NAS_MME


222 
emm_¥oc_authítiˇti⁄
(*
˘x
, 
ueid
, 
ksi
,

223 c⁄° 
O˘ëSåög
 *
_ønd
, c⁄° O˘ëSåög *
auä
,

224 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

225 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

226 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
);

227 
emm_¥oc_authítiˇti⁄_com∂ëe
(
ueid
, 
emm_ˇu£
,

228 c⁄° 
O˘ëSåög
 *
ªs
);

230 
emm_©èch_£curôy
(*
¨gs
);

238 #ifde‡
NAS_UE


239 
emm_¥oc_£curôy_mode_comm™d
(
«tive_ksi
, 
ksi
, 
£ó
, 
£ü
,

240 
ªó
, 
ªü
);

243 #ifde‡
NAS_MME


244 
emm_¥oc_£curôy_mode_c⁄åﬁ
(
ueid
, 
ksi
,

245 
ìa
, 
eü
,
ucs2
, 
uó
, 
uü
, 
gó
,

246 
umts_¥e£¡
, 
g¥s_¥e£¡
,

247 
emm_comm⁄_suc˚ss_ˇŒback_t
 
suc˚ss
,

248 
emm_comm⁄_ªje˘_ˇŒback_t
 
ªje˘
,

249 
emm_comm⁄_Áûuª_ˇŒback_t
 
Áûuª
);

250 
emm_¥oc_£curôy_mode_com∂ëe
(
ueid
);

251 
emm_¥oc_£curôy_mode_ªje˘
(
ueid
);

259 #ifde‡
NAS_UE


260 
emm_¥oc_ªgi°øti⁄_nŸify
(
Sèt_t
 
°©us
);

261 
emm_¥oc_loˇti⁄_nŸify
(
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
);

262 
emm_¥oc_√tw‹k_nŸify
(
ödex
);

	@src/emm/msg/AttachAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"AâachAc˚±.h
"

39 
	$decode_©èch_ac˚±
(
©èch_ac˚±_msg
 *
©èch_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ATTACH_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_ïs_©èch_ªsu…
(&
©èch_ac˚±
->
ïßâachªsu…
, 0, *(
buf„r
 + 
decoded
), 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52 i‡((
decoded_ªsu…
 = 
	`decode_g¥s_timî
(&
©èch_ac˚±
->
t3412vÆue
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

53  
decoded_ªsu…
;

55 
decoded
 +
decoded_ªsu…
;

57 i‡((
decoded_ªsu…
 = 
	`decode_åackög_¨ó_idítôy_li°
(&
©èch_ac˚±
->
èûi°
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

58  
decoded_ªsu…
;

60 
decoded
 +
decoded_ªsu…
;

62 i‡((
decoded_ªsu…
 = 
	`decode_esm_mesßge_c⁄èöî
(&
©èch_ac˚±
->
esmmesßgec⁄èöî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

63  
decoded_ªsu…
;

65 
decoded
 +
decoded_ªsu…
;

68 
Àn
 - 
decoded
 > 0)

70 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

72 i‡(
õiDecoded
 >= 0x80)

73 
õiDecoded
 = ieiDecoded & 0xf0;

74 
õiDecoded
)

76 
ATTACH_ACCEPT_GUTI_IEI
:

77 i‡((
decoded_ªsu…
 =

78 
	`decode_ïs_mobûe_idítôy
(&
©èch_ac˚±
->
guti
,

79 
ATTACH_ACCEPT_GUTI_IEI
, 
buf„r
 + 
decoded
, 
Àn
 - decoded))

81  
decoded_ªsu…
;

82 
decoded
 +
decoded_ªsu…
;

84 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_GUTI_PRESENT
;

86 
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
:

87 i‡((
decoded_ªsu…
 =

88 
	`decode_loˇti⁄_¨ó_idítifiˇti⁄
(&
©èch_ac˚±
->
loˇti⁄¨óidítifiˇti⁄
,

89 
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
, 
buf„r
 +

90 
decoded
, 
Àn
 - decoded)) <= 0)

91  
decoded_ªsu…
;

92 
decoded
 +
decoded_ªsu…
;

94 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
;

96 
ATTACH_ACCEPT_MS_IDENTITY_IEI
:

97 i‡((
decoded_ªsu…
 =

98 
	`decode_mobûe_idítôy
(&
©èch_ac˚±
->
msidítôy
,

99 
ATTACH_ACCEPT_MS_IDENTITY_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

100 
decoded
)) <= 0)

101  
decoded_ªsu…
;

102 
decoded
 +
decoded_ªsu…
;

104 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_MS_IDENTITY_PRESENT
;

106 
ATTACH_ACCEPT_EMM_CAUSE_IEI
:

107 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
©èch_ac˚±
->
emmˇu£
,

108 
ATTACH_ACCEPT_EMM_CAUSE_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

109 
decoded
)) <= 0)

110  
decoded_ªsu…
;

111 
decoded
 +
decoded_ªsu…
;

113 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_EMM_CAUSE_PRESENT
;

115 
ATTACH_ACCEPT_T3402_VALUE_IEI
:

116 i‡((
decoded_ªsu…
 =

117 
	`decode_g¥s_timî
(&
©èch_ac˚±
->
t3402vÆue
,

118 
ATTACH_ACCEPT_T3402_VALUE_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

119 
decoded
)) <= 0)

120  
decoded_ªsu…
;

121 
decoded
 +
decoded_ªsu…
;

123 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_T3402_VALUE_PRESENT
;

125 
ATTACH_ACCEPT_T3423_VALUE_IEI
:

126 i‡((
decoded_ªsu…
 =

127 
	`decode_g¥s_timî
(&
©èch_ac˚±
->
t3423vÆue
,

128 
ATTACH_ACCEPT_T3423_VALUE_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

129 
decoded
)) <= 0)

130  
decoded_ªsu…
;

131 
decoded
 +
decoded_ªsu…
;

133 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_T3423_VALUE_PRESENT
;

135 
ATTACH_ACCEPT_EQUIVALENT_PLMNS_IEI
:

136 i‡((
decoded_ªsu…
 =

137 
	`decode_∂mn_li°
(&
©èch_ac˚±
->
equivÆíçlmns
,

138 
ATTACH_ACCEPT_EQUIVALENT_PLMNS_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

139 
decoded
)) <= 0)

140  
decoded_ªsu…
;

141 
decoded
 +
decoded_ªsu…
;

143 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_EQUIVALENT_PLMNS_PRESENT
;

145 
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
:

146 i‡((
decoded_ªsu…
 =

147 
	`decode_emîgícy_numbî_li°
(&
©èch_ac˚±
->
emîgícynumbîli°
,

148 
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
, 
buf„r
 + 
decoded
,

149 
Àn
 - 
decoded
)) <= 0)

150  
decoded_ªsu…
;

151 
decoded
 +
decoded_ªsu…
;

153 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
;

155 
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
:

156 i‡((
decoded_ªsu…
 =

157 
	`decode_ïs_√tw‹k_„©uª_suµ‹t
(&
©èch_ac˚±
->
ï¢ëw‹k„©uªsuµ‹t
,

158 
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
, 
buf„r
 +

159 
decoded
, 
Àn
 - decoded)) <= 0)

160  
decoded_ªsu…
;

161 
decoded
 +
decoded_ªsu…
;

163 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
;

165 
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
:

166 i‡((
decoded_ªsu…
 =

167 
	`decode_addôi⁄Æ_upd©e_ªsu…
(&
©èch_ac˚±
->
addôi⁄Æupd©îesu…
,

168 
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
, 
buf„r
 +

169 
decoded
, 
Àn
 - decoded)) <= 0)

170  
decoded_ªsu…
;

171 
decoded
 +
decoded_ªsu…
;

173 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
;

176 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

177  
TLV_DECODE_UNEXPECTED_IEI
;

180  
decoded
;

181 
	}
}

183 
	$ícode_©èch_ac˚±
(
©èch_ac˚±_msg
 *
©èch_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

185 
ícoded
 = 0;

186 
ícode_ªsu…
 = 0;

188 
LOG_FUNC_IN
;

191 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ATTACH_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

193 *(
buf„r
 + 
ícoded
Ë(
	`ícode_u8_ïs_©èch_ªsu…
(&
©èch_ac˚±
->
ïßâachªsu…
) & 0x0f);

194 
ícoded
++;

196 
©èch_ac˚±
->
t3412vÆue
.
unô
 = 
GPRS_TIMER_UNIT_360S
;

197 
©èch_ac˚±
->
t3412vÆue
.
timîvÆue
 = 10;

198 i‡((
ícode_ªsu…
 = 
	`ícode_g¥s_timî
(&
©èch_ac˚±
->
t3412vÆue
, 0, 
buf„r


199 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

200 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_gprs_timer");

201 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

203 
ícoded
 +
ícode_ªsu…
;

205 i‡((
ícode_ªsu…
 =

206 
	`ícode_åackög_¨ó_idítôy_li°
(&
©èch_ac˚±
->
èûi°
, 0, 
buf„r


207 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

208 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_tracking_area_identity_list");

209 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

211 
ícoded
 +
ícode_ªsu…
;

213 i‡((
ícode_ªsu…
 =

214 
	`ícode_esm_mesßge_c⁄èöî
(&
©èch_ac˚±
->
esmmesßgec⁄èöî
, 0,

215 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

216 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_esm_message_container");

217 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

219 
ícoded
 +
ícode_ªsu…
;

221 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_GUTI_PRESENT
)

222 =
ATTACH_ACCEPT_GUTI_PRESENT
)

224 i‡((
ícode_ªsu…
 = 
	`ícode_ïs_mobûe_idítôy
(&
©èch_ac˚±
->
guti
,

225 
ATTACH_ACCEPT_GUTI_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

227 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_eps_mobile_identity");

228 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

230 
ícoded
 +
ícode_ªsu…
;

233 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
)

234 =
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
)

236 i‡((
ícode_ªsu…
 =

237 
	`ícode_loˇti⁄_¨ó_idítifiˇti⁄
(&
©èch_ac˚±
->
loˇti⁄¨óidítifiˇti⁄
,

238 
ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
, 
buf„r
 + 
ícoded
,

239 
Àn
 - 
ícoded
)) < 0) {

240 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_location_area_identification");

242 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

244 
ícoded
 +
ícode_ªsu…
;

247 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_MS_IDENTITY_PRESENT
)

248 =
ATTACH_ACCEPT_MS_IDENTITY_PRESENT
)

250 i‡((
ícode_ªsu…
 = 
	`ícode_mobûe_idítôy
(&
©èch_ac˚±
->
msidítôy
,

251 
ATTACH_ACCEPT_MS_IDENTITY_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) <

253 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_mobile_identity");

255 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

257 
ícoded
 +
ícode_ªsu…
;

260 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_EMM_CAUSE_PRESENT
)

261 =
ATTACH_ACCEPT_EMM_CAUSE_PRESENT
)

263 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
©èch_ac˚±
->
emmˇu£
,

264 
ATTACH_ACCEPT_EMM_CAUSE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) <

267 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

269 
ícoded
 +
ícode_ªsu…
;

273 
©èch_ac˚±
->
¥e£n˚mask
 |
ATTACH_ACCEPT_T3402_VALUE_PRESENT
;

274 
©èch_ac˚±
->
t3402vÆue
.
unô
 = 
GPRS_TIMER_UNIT_60S
;

275 
©èch_ac˚±
->
t3402vÆue
.
timîvÆue
 = 12;

276 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_T3402_VALUE_PRESENT
)

277 =
ATTACH_ACCEPT_T3402_VALUE_PRESENT
)

279 i‡((
ícode_ªsu…
 = 
	`ícode_g¥s_timî
(&
©èch_ac˚±
->
t3402vÆue
,

280 
ATTACH_ACCEPT_T3402_VALUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) <

282 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_gprs_timer");

284 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

286 
ícoded
 +
ícode_ªsu…
;

289 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_T3423_VALUE_PRESENT
)

290 =
ATTACH_ACCEPT_T3423_VALUE_PRESENT
)

292 i‡((
ícode_ªsu…
 = 
	`ícode_g¥s_timî
(&
©èch_ac˚±
->
t3423vÆue
,

293 
ATTACH_ACCEPT_T3423_VALUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) <

295 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_gprs_timer");

297 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

299 
ícoded
 +
ícode_ªsu…
;

302 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_EQUIVALENT_PLMNS_PRESENT
)

303 =
ATTACH_ACCEPT_EQUIVALENT_PLMNS_PRESENT
)

305 i‡((
ícode_ªsu…
 = 
	`ícode_∂mn_li°
(&
©èch_ac˚±
->
equivÆíçlmns
,

306 
ATTACH_ACCEPT_EQUIVALENT_PLMNS_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

307 
ícoded
)) < 0) {

308 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_plmn_list");

310 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

312 
ícoded
 +
ícode_ªsu…
;

315 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
)

316 =
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
)

318 i‡((
ícode_ªsu…
 =

319 
	`ícode_emîgícy_numbî_li°
(&
©èch_ac˚±
->
emîgícynumbîli°
,

320 
ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

321 
ícoded
)) < 0) {

322 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_emergency_number_list");

324 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

326 
ícoded
 +
ícode_ªsu…
;

329 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
)

330 =
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
)

332 i‡((
ícode_ªsu…
 =

333 
	`ícode_ïs_√tw‹k_„©uª_suµ‹t
(&
©èch_ac˚±
->
ï¢ëw‹k„©uªsuµ‹t
,

334 
ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
, 
buf„r
 + 
ícoded
,

335 
Àn
 - 
ícoded
)) < 0) {

336 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_eps_network_feature_support");

338 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

340 
ícoded
 +
ícode_ªsu…
;

343 i‡((
©èch_ac˚±
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
)

344 =
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
)

346 i‡((
ícode_ªsu…
 =

347 
	`ícode_addôi⁄Æ_upd©e_ªsu…
(&
©èch_ac˚±
->
addôi⁄Æupd©îesu…
,

348 
ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
, 
buf„r
 + 
ícoded
, 
Àn


349 - 
ícoded
)) < 0) {

350 
	`LOG_TRACE
(
WARNING
, "FailedÉncode_additional_update_result");

352 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

354 
ícoded
 +
ícode_ªsu…
;

357 
	`LOG_FUNC_RETURN
(
ícoded
);

358 
	}
}

	@src/emm/msg/AttachAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EpsAâachResu….h
"

37 
	~"G¥sTimî.h
"

38 
	~"TøckögAªaIdítôyLi°.h
"

39 
	~"EsmMesßgeC⁄èöî.h
"

40 
	~"EpsMobûeIdítôy.h
"

41 
	~"Loˇti⁄AªaIdítifiˇti⁄.h
"

42 
	~"MobûeIdítôy.h
"

43 
	~"EmmCau£.h
"

44 
	~"PlmnLi°.h
"

45 
	~"EmîgícyNumbîLi°.h
"

46 
	~"EpsNëw‹kFótuªSuµ‹t.h
"

47 
	~"Addôi⁄ÆUpd©eResu….h
"

49 #i‚de‡
ATTACH_ACCEPT_H_


50 
	#ATTACH_ACCEPT_H_


	)

53 
	#ATTACH_ACCEPT_MINIMUM_LENGTH
 ( \

54 
EPS_ATTACH_RESULT_MINIMUM_LENGTH
 + \

55 
GPRS_TIMER_MINIMUM_LENGTH
 + \

56 
TRACKING_AREA_IDENTITY_LIST_MINIMUM_LENGTH
 + \

57 
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 )

	)

60 
	#ATTACH_ACCEPT_MAXIMUM_LENGTH
 ( \

61 
EPS_ATTACH_RESULT_MAXIMUM_LENGTH
 + \

62 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

63 
TRACKING_AREA_IDENTITY_LIST_MAXIMUM_LENGTH
 + \

64 
ESM_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 + \

65 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

66 
LOCATION_AREA_IDENTIFICATION_MAXIMUM_LENGTH
 + \

67 
MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

68 
EMM_CAUSE_MAXIMUM_LENGTH
 + \

69 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

70 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

71 
PLMN_LIST_MAXIMUM_LENGTH
 + \

72 
EMERGENCY_NUMBER_LIST_MAXIMUM_LENGTH
 + \

73 
EPS_NETWORK_FEATURE_SUPPORT_MAXIMUM_LENGTH
 + \

74 
ADDITIONAL_UPDATE_RESULT_MAXIMUM_LENGTH
 )

	)

79 
	#ATTACH_ACCEPT_GUTI_PRESENT
 (1<<0)

	)

80 
	#ATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
 (1<<1)

	)

81 
	#ATTACH_ACCEPT_MS_IDENTITY_PRESENT
 (1<<2)

	)

82 
	#ATTACH_ACCEPT_EMM_CAUSE_PRESENT
 (1<<3)

	)

83 
	#ATTACH_ACCEPT_T3402_VALUE_PRESENT
 (1<<4)

	)

84 
	#ATTACH_ACCEPT_T3423_VALUE_PRESENT
 (1<<5)

	)

85 
	#ATTACH_ACCEPT_EQUIVALENT_PLMNS_PRESENT
 (1<<6)

	)

86 
	#ATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
 (1<<7)

	)

87 
	#ATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
 (1<<8)

	)

88 
	#ATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
 (1<<9)

	)

90 
	e©èch_ac˚±_õi_èg
 {

91 
	mATTACH_ACCEPT_GUTI_IEI
 = 0x50,

92 
	mATTACH_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
 = 0x13,

93 
	mATTACH_ACCEPT_MS_IDENTITY_IEI
 = 0x23,

94 
	mATTACH_ACCEPT_EMM_CAUSE_IEI
 = 0x53,

95 
	mATTACH_ACCEPT_T3402_VALUE_IEI
 = 0x17,

96 
	mATTACH_ACCEPT_T3423_VALUE_IEI
 = 0x59,

97 
	mATTACH_ACCEPT_EQUIVALENT_PLMNS_IEI
 = 0x4A,

98 
	mATTACH_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
 = 0x34,

99 
	mATTACH_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
 = 0x64,

100 
	mATTACH_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
 = 0xF0,

101 } 
	t©èch_ac˚±_õi
;

110 
	s©èch_ac˚±_msg_èg
 {

112 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

113 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

114 
MesßgeTy≥
 
	mmesßgëy≥
;

115 
EpsAâachResu…
 
	mïßâachªsu…
;

116 
G¥sTimî
 
	mt3412vÆue
;

117 
TøckögAªaIdítôyLi°
 
	mèûi°
;

118 
EsmMesßgeC⁄èöî
 
	mesmmesßgec⁄èöî
;

120 
uöt32_t
 
	m¥e£n˚mask
;

121 
EpsMobûeIdítôy
 
	mguti
;

122 
Loˇti⁄AªaIdítifiˇti⁄
 
	mloˇti⁄¨óidítifiˇti⁄
;

123 
MobûeIdítôy
 
	mmsidítôy
;

124 
EmmCau£
 
	memmˇu£
;

125 
G¥sTimî
 
	mt3402vÆue
;

126 
G¥sTimî
 
	mt3423vÆue
;

127 
PlmnLi°
 
	mequivÆíçlmns
;

128 
EmîgícyNumbîLi°
 
	memîgícynumbîli°
;

129 
EpsNëw‹kFótuªSuµ‹t
 
	mï¢ëw‹k„©uªsuµ‹t
;

130 
Addôi⁄ÆUpd©eResu…
 
	maddôi⁄Æupd©îesu…
;

131 } 
	t©èch_ac˚±_msg
;

133 
decode_©èch_ac˚±
(
©èch_ac˚±_msg
 *
©èchac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

135 
ícode_©èch_ac˚±
(
©èch_ac˚±_msg
 *
©èchac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AttachComplete.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"AâachCom∂ëe.h
"

39 
	$decode_©èch_com∂ëe
(
©èch_com∂ëe_msg
 *
©èch_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ATTACH_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_mesßge_c⁄èöî
(&
©èch_com∂ëe
->
esmmesßgec⁄èöî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_©èch_com∂ëe
(
©èch_com∂ëe_msg
 *
©èch_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ATTACH_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_esm_mesßge_c⁄èöî
(&
©èch_com∂ëe
->
esmmesßgec⁄èöî
, 0,

66 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/AttachComplete.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EsmMesßgeC⁄èöî.h
"

38 #i‚de‡
ATTACH_COMPLETE_H_


39 
	#ATTACH_COMPLETE_H_


	)

42 
	#ATTACH_COMPLETE_MINIMUM_LENGTH
 ( \

43 
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 )

	)

46 
	#ATTACH_COMPLETE_MAXIMUM_LENGTH
 ( \

47 
ESM_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 )

	)

57 
	s©èch_com∂ëe_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
EsmMesßgeC⁄èöî
 
	mesmmesßgec⁄èöî
;

63 } 
	t©èch_com∂ëe_msg
;

65 
decode_©èch_com∂ëe
(
©èch_com∂ëe_msg
 *
©èchcom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_©èch_com∂ëe
(
©èch_com∂ëe_msg
 *
©èchcom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AttachReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"AâachReje˘.h
"

39 
	$decode_©èch_ªje˘
(
©èch_ªje˘_msg
 *
©èch_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ATTACH_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
©èch_ªje˘
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_esm_mesßge_c⁄èöî
(&
©èch_ªje˘
->
esmmesßgec⁄èöî
,

65 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_IEI
, 
buf„r
 + 
decoded
,

66 
Àn
 - 
decoded
)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
©èch_ªje˘
->
¥e£n˚mask
 |
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_©èch_ªje˘
(
©èch_ªje˘_msg
 *
©èch_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ATTACH_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
©èch_ªje˘
->
emmˇu£
, 0, 
buf„r
 +

89 
ícoded
, 
Àn
 -Éncoded)) < 0)

90  
ícode_ªsu…
;

92 
ícoded
 +
ícode_ªsu…
;

94 i‡((
©èch_ªje˘
->
¥e£n˚mask
 & 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
)

95 =
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
)

97 i‡((
ícode_ªsu…
 =

98 
	`ícode_esm_mesßge_c⁄èöî
(&
©èch_ªje˘
->
esmmesßgec⁄èöî
,

99 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

100 
ícoded
)) < 0)

102  
ícode_ªsu…
;

104 
ícoded
 +
ícode_ªsu…
;

107  
ícoded
;

108 
	}
}

	@src/emm/msg/AttachReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

37 
	~"EsmMesßgeC⁄èöî.h
"

39 #i‚de‡
ATTACH_REJECT_H_


40 
	#ATTACH_REJECT_H_


	)

43 
	#ATTACH_REJECT_MINIMUM_LENGTH
 ( \

44 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

47 
	#ATTACH_REJECT_MAXIMUM_LENGTH
 ( \

48 
EMM_CAUSE_MAXIMUM_LENGTH
 + \

49 
ESM_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 )

	)

54 
	#ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
 (1<<0)

	)

56 
	e©èch_ªje˘_õi_èg
 {

57 
	mATTACH_REJECT_ESM_MESSAGE_CONTAINER_IEI
 = 0x78,

58 } 
	t©èch_ªje˘_õi
;

67 
	s©èch_ªje˘_msg_èg
 {

69 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

70 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

71 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
EmmCau£
 
	memmˇu£
;

74 
uöt32_t
 
	m¥e£n˚mask
;

75 
EsmMesßgeC⁄èöî
 
	mesmmesßgec⁄èöî
;

76 } 
	t©èch_ªje˘_msg
;

78 
decode_©èch_ªje˘
(
©èch_ªje˘_msg
 *
©èchªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

80 
ícode_©èch_ªje˘
(
©èch_ªje˘_msg
 *
©èchªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AttachRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

34 
	~"«s_log.h
"

36 
	~"TLVEncodî.h
"

37 
	~"TLVDecodî.h
"

38 
	~"AâachReque°.h
"

40 
	$decode_©èch_ªque°
(
©èch_ªque°_msg
 *
©èch_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

42 
uöt32_t
 
decoded
 = 0;

43 
decoded_ªsu…
 = 0;

45 
LOG_FUNC_IN
;

46 
	`LOG_TRACE
(
INFO
, "EMM -áttach_requestÜen = %d",

47 
Àn
);

49 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ATTACH_REQUEST_MINIMUM_LENGTH
, 
Àn
);

52 i‡((
decoded_ªsu…
 = 
	`decode_u8_ïs_©èch_ty≥
(&
©èch_ªque°
->
ïßâachty≥
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0) {

54 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

57 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
©èch_ªque°
->
«skey£tidítifõr
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0) {

59 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

62 
decoded
++;

64 i‡((
decoded_ªsu…
 = 
	`decode_ïs_mobûe_idítôy
(&
©èch_ªque°
->
ﬁdguti‹imsi
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0) {

66 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

69 
decoded
 +
decoded_ªsu…
;

71 i‡((
decoded_ªsu…
 = 
	`decode_ue_√tw‹k_ˇ∑bûôy
(&
©èch_ªque°
->
uíëw‹kˇ∑bûôy
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0) {

73 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

76 
decoded
 +
decoded_ªsu…
;

78 i‡((
decoded_ªsu…
 = 
	`decode_esm_mesßge_c⁄èöî
(&
©èch_ªque°
->
esmmesßgec⁄èöî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0) {

80 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

83 
decoded
 +
decoded_ªsu…
;

86 
Àn
 - 
decoded
 > 0)

88 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

90 i‡(
õiDecoded
 >= 0x80)

91 
õiDecoded
 = ieiDecoded & 0xf0;

92 
õiDecoded
)

94 
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_IEI
:

95 i‡((
decoded_ªsu…
 =

96 
	`decode_p_tmsi_sig«tuª
(&
©èch_ªque°
->
ﬁd±msisig«tuª
,

97 
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_IEI
, 
buf„r
 + 
decoded
,

98 
Àn
 - 
decoded
)) <= 0)

101 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

103 
decoded
 +
decoded_ªsu…
;

105 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
;

107 
ATTACH_REQUEST_ADDITIONAL_GUTI_IEI
:

108 i‡((
decoded_ªsu…
 =

109 
	`decode_ïs_mobûe_idítôy
(&
©èch_ªque°
->
addôi⁄Æguti
,

110 
ATTACH_REQUEST_ADDITIONAL_GUTI_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

111 
decoded
)) <= 0)

114 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

116 
decoded
 +
decoded_ªsu…
;

118 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_ADDITIONAL_GUTI_PRESENT
;

120 
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
:

121 i‡((
decoded_ªsu…
 =

122 
	`decode_åackög_¨ó_idítôy
(&
©èch_ªque°
->
œ°visôedªgi°îedèi
,

123 
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
, 
buf„r
 +

124 
decoded
, 
Àn
 - decoded)) <= 0)

127 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

129 
decoded
 +
decoded_ªsu…
;

131 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
;

133 
ATTACH_REQUEST_DRX_PARAMETER_IEI
:

134 i‡((
decoded_ªsu…
 =

135 
	`decode_drx_∑ømëî
(&
©èch_ªque°
->
drx∑ømëî
,

136 
ATTACH_REQUEST_DRX_PARAMETER_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

137 
decoded
)) <= 0)

140 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

142 
decoded
 +
decoded_ªsu…
;

144 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_DRX_PARAMETER_PRESENT
;

146 
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_IEI
:

147 i‡((
decoded_ªsu…
 =

148 
	`decode_ms_√tw‹k_ˇ∑bûôy
(&
©èch_ªque°
->
m¢ëw‹kˇ∑bûôy
,

149 
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_IEI
, 
buf„r
 + 
decoded
,

150 
Àn
 - 
decoded
)) <= 0)

153 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

155 
decoded
 +
decoded_ªsu…
;

157 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
;

159 
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
:

160 i‡((
decoded_ªsu…
 =

161 
	`decode_loˇti⁄_¨ó_idítifiˇti⁄
(&
©èch_ªque°
->
ﬁdloˇti⁄¨óidítifiˇti⁄
,

162 
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
, 
buf„r


163 + 
decoded
, 
Àn
 - decoded)) <= 0)

166 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

168 
decoded
 +
decoded_ªsu…
;

170 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
;

172 
ATTACH_REQUEST_TMSI_STATUS_IEI
:

173 i‡((
decoded_ªsu…
 =

174 
	`decode_tmsi_°©us
(&
©èch_ªque°
->
tmsi°©us
,

175 
ATTACH_REQUEST_TMSI_STATUS_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

176 
decoded
)) <= 0)

179 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

181 
decoded
 +
decoded_ªsu…
;

183 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_TMSI_STATUS_PRESENT
;

185 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
:

186 i‡((
decoded_ªsu…
 =

187 
	`decode_mobûe_°©i⁄_˛assm¨k_2
(&
©èch_ªque°
->
mobûe°©i⁄˛assm¨k2
,

188 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
, 
buf„r
 +

189 
decoded
, 
Àn
 - decoded)) <= 0)

192 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

194 
decoded
 +
decoded_ªsu…
;

196 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
;

198 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
:

199 i‡((
decoded_ªsu…
 =

200 
	`decode_mobûe_°©i⁄_˛assm¨k_3
(&
©èch_ªque°
->
mobûe°©i⁄˛assm¨k3
,

201 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
, 
buf„r
 +

202 
decoded
, 
Àn
 - decoded)) <= 0)

205 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

207 
decoded
 +
decoded_ªsu…
;

209 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
;

211 
ATTACH_REQUEST_SUPPORTED_CODECS_IEI
:

212 i‡((
decoded_ªsu…
 =

213 
	`decode_suµ‹ãd_codec_li°
(&
©èch_ªque°
->
suµ‹ãdcodecs
,

214 
ATTACH_REQUEST_SUPPORTED_CODECS_IEI
, 
buf„r
 + 
decoded
, 
Àn


215 - 
decoded
)) <= 0)

218 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

220 
decoded
 +
decoded_ªsu…
;

222 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_SUPPORTED_CODECS_PRESENT
;

224 
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
:

225 i‡((
decoded_ªsu…
 =

226 
	`decode_addôi⁄Æ_upd©e_ty≥
(&
©èch_ªque°
->
addôi⁄Æupd©ëy≥
,

227 
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
, 
buf„r
 +

228 
decoded
, 
Àn
 - decoded)) <= 0)

231 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

233 
decoded
 +
decoded_ªsu…
;

235 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
;

238 
ATTACH_REQUEST_OLD_GUTI_TYPE_IEI
:

239 i‡((
decoded_ªsu…
 =

240 
	`decode_guti_ty≥
(&
©èch_ªque°
->
ﬁdgutôy≥
,

241 
ATTACH_REQUEST_OLD_GUTI_TYPE_IEI
,

242 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

245 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

247 
decoded
 +
decoded_ªsu…
;

249 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
;

252 
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_IEI
:

253 i‡((
decoded_ªsu…
 =

254 
	`decode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(&
©èch_ªque°
->
voi˚domaö¥e„ªn˚™dueußge£âög
,

255 
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_IEI
,

256 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

259 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

261 
decoded
 +
decoded_ªsu…
;

263 
©èch_ªque°
->
¥e£n˚mask
 |
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_PRESENT
;

268 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

271 
	`LOG_FUNC_RETURN
(
TLV_DECODE_UNEXPECTED_IEI
);

276 
	`LOG_FUNC_RETURN
(
decoded
);

277 
	}
}

279 
	$ícode_©èch_ªque°
(
©èch_ªque°_msg
 *
©èch_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

281 
ícoded
 = 0;

282 
ícode_ªsu…
 = 0;

285 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ATTACH_REQUEST_MINIMUM_LENGTH
, 
Àn
);

287 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_«s_key_£t_idítifõr
(&
©èch_ªque°
->
«skey£tidítifõr
Ë& 0x0fË<< 4Ë| (
	`ícode_u8_ïs_©èch_ty≥
(&©èch_ªque°->
ïßâachty≥
) & 0x0f);

288 
ícoded
++;

290 i‡((
ícode_ªsu…
 =

291 
	`ícode_ïs_mobûe_idítôy
(&
©èch_ªque°
->
ﬁdguti‹imsi
, 0, 
buf„r
 +

292 
ícoded
, 
Àn
 -Éncoded)) < 0)

293  
ícode_ªsu…
;

295 
ícoded
 +
ícode_ªsu…
;

297 i‡((
ícode_ªsu…
 =

298 
	`ícode_ue_√tw‹k_ˇ∑bûôy
(&
©èch_ªque°
->
uíëw‹kˇ∑bûôy
, 0,

299 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

300  
ícode_ªsu…
;

302 
ícoded
 +
ícode_ªsu…
;

304 i‡((
ícode_ªsu…
 =

305 
	`ícode_esm_mesßge_c⁄èöî
(&
©èch_ªque°
->
esmmesßgec⁄èöî
, 0,

306 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

307  
ícode_ªsu…
;

309 
ícoded
 +
ícode_ªsu…
;

311 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
)

312 =
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
)

314 i‡((
ícode_ªsu…
 =

315 
	`ícode_p_tmsi_sig«tuª
(&
©èch_ªque°
->
ﬁd±msisig«tuª
,

316 
ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

317 
ícoded
)) < 0)

319  
ícode_ªsu…
;

321 
ícoded
 +
ícode_ªsu…
;

324 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_ADDITIONAL_GUTI_PRESENT
)

325 =
ATTACH_REQUEST_ADDITIONAL_GUTI_PRESENT
)

327 i‡((
ícode_ªsu…
 =

328 
	`ícode_ïs_mobûe_idítôy
(&
©èch_ªque°
->
addôi⁄Æguti
,

329 
ATTACH_REQUEST_ADDITIONAL_GUTI_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

330 
ícoded
)) < 0)

332  
ícode_ªsu…
;

334 
ícoded
 +
ícode_ªsu…
;

337 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
)

338 =
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
)

340 i‡((
ícode_ªsu…
 =

341 
	`ícode_åackög_¨ó_idítôy
(&
©èch_ªque°
->
œ°visôedªgi°îedèi
,

342 
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
, 
buf„r
 + 
ícoded
,

343 
Àn
 - 
ícoded
)) < 0)

345  
ícode_ªsu…
;

347 
ícoded
 +
ícode_ªsu…
;

350 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_DRX_PARAMETER_PRESENT
)

351 =
ATTACH_REQUEST_DRX_PARAMETER_PRESENT
)

353 i‡((
ícode_ªsu…
 = 
	`ícode_drx_∑ømëî
(&
©èch_ªque°
->
drx∑ømëî
,

354 
ATTACH_REQUEST_DRX_PARAMETER_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

355 
ícoded
)) < 0)

357  
ícode_ªsu…
;

359 
ícoded
 +
ícode_ªsu…
;

362 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
)

363 =
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
)

365 i‡((
ícode_ªsu…
 =

366 
	`ícode_ms_√tw‹k_ˇ∑bûôy
(&
©èch_ªque°
->
m¢ëw‹kˇ∑bûôy
,

367 
ATTACH_REQUEST_MS_NETWORK_CAPABILITY_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

368 
ícoded
)) < 0)

370  
ícode_ªsu…
;

372 
ícoded
 +
ícode_ªsu…
;

375 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
)

376 =
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
)

378 i‡((
ícode_ªsu…
 =

379 
	`ícode_loˇti⁄_¨ó_idítifiˇti⁄
(&
©èch_ªque°
->
ﬁdloˇti⁄¨óidítifiˇti⁄
,

380 
ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
, 
buf„r
 +

381 
ícoded
, 
Àn
 -Éncoded)) < 0)

383  
ícode_ªsu…
;

385 
ícoded
 +
ícode_ªsu…
;

388 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_TMSI_STATUS_PRESENT
)

389 =
ATTACH_REQUEST_TMSI_STATUS_PRESENT
)

391 i‡((
ícode_ªsu…
 = 
	`ícode_tmsi_°©us
(&
©èch_ªque°
->
tmsi°©us
,

392 
ATTACH_REQUEST_TMSI_STATUS_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded))

395  
ícode_ªsu…
;

397 
ícoded
 +
ícode_ªsu…
;

400 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
)

401 =
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
)

403 i‡((
ícode_ªsu…
 =

404 
	`ícode_mobûe_°©i⁄_˛assm¨k_2
(&
©èch_ªque°
->
mobûe°©i⁄˛assm¨k2
,

405 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
, 
buf„r
 + 
ícoded
,

406 
Àn
 - 
ícoded
)) < 0)

408  
ícode_ªsu…
;

410 
ícoded
 +
ícode_ªsu…
;

413 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
)

414 =
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
)

416 i‡((
ícode_ªsu…
 =

417 
	`ícode_mobûe_°©i⁄_˛assm¨k_3
(&
©èch_ªque°
->
mobûe°©i⁄˛assm¨k3
,

418 
ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
, 
buf„r
 + 
ícoded
,

419 
Àn
 - 
ícoded
)) < 0)

421  
ícode_ªsu…
;

423 
ícoded
 +
ícode_ªsu…
;

426 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_SUPPORTED_CODECS_PRESENT
)

427 =
ATTACH_REQUEST_SUPPORTED_CODECS_PRESENT
)

429 i‡((
ícode_ªsu…
 =

430 
	`ícode_suµ‹ãd_codec_li°
(&
©èch_ªque°
->
suµ‹ãdcodecs
,

431 
ATTACH_REQUEST_SUPPORTED_CODECS_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

432 
ícoded
)) < 0)

434  
ícode_ªsu…
;

436 
ícoded
 +
ícode_ªsu…
;

439 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
)

440 =
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
)

442 i‡((
ícode_ªsu…
 =

443 
	`ícode_addôi⁄Æ_upd©e_ty≥
(&
©èch_ªque°
->
addôi⁄Æupd©ëy≥
,

444 
ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

445 
ícoded
)) < 0)

447  
ícode_ªsu…
;

449 
ícoded
 +
ícode_ªsu…
;

452 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
)

453 =
ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
)

455 i‡((
ícode_ªsu…
 =

456 
	`ícode_guti_ty≥
(&
©èch_ªque°
->
ﬁdgutôy≥
,

457 
ATTACH_REQUEST_OLD_GUTI_TYPE_IEI
,

458 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

460  
ícode_ªsu…
;

462 
ícoded
 +
ícode_ªsu…
;

465 i‡((
©èch_ªque°
->
¥e£n˚mask
 & 
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_PRESENT
)

466 =
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_PRESENT
)

468 i‡((
ícode_ªsu…
 =

469 
	`ícode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(&
©èch_ªque°
->
voi˚domaö¥e„ªn˚™dueußge£âög
,

470 
ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_IEI
,

471 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

473  
ícode_ªsu…
;

475 
ícoded
 +
ícode_ªsu…
;

478  
ícoded
;

479 
	}
}

	@src/emm/msg/AttachRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EpsAâachTy≥.h
"

37 
	~"NasKeySëIdítifõr.h
"

38 
	~"EpsMobûeIdítôy.h
"

39 
	~"UeNëw‹kC≠abûôy.h
"

40 
	~"EsmMesßgeC⁄èöî.h
"

41 
	~"PTmsiSig«tuª.h
"

42 
	~"TøckögAªaIdítôy.h
"

43 
	~"DrxP¨amëî.h
"

44 
	~"MsNëw‹kC≠abûôy.h
"

45 
	~"Loˇti⁄AªaIdítifiˇti⁄.h
"

46 
	~"TmsiSètus.h
"

47 
	~"MobûeSèti⁄Cœssm¨k2.h
"

48 
	~"MobûeSèti⁄Cœssm¨k3.h
"

49 
	~"Suµ‹ãdCodecLi°.h
"

50 
	~"Addôi⁄ÆUpd©eTy≥.h
"

51 
	~"GutiTy≥.h
"

52 
	~"Voi˚DomaöPª„ªn˚AndUeUßgeSëtög.h
"

54 #i‚de‡
ATTACH_REQUEST_H_


55 
	#ATTACH_REQUEST_H_


	)

58 
	#ATTACH_REQUEST_MINIMUM_LENGTH
 ( \

59 
EPS_ATTACH_TYPE_MINIMUM_LENGTH
 + \

60 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

61 
EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
 + \

62 
UE_NETWORK_CAPABILITY_MINIMUM_LENGTH
 + \

63 
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 )

	)

66 
	#ATTACH_REQUEST_MAXIMUM_LENGTH
 ( \

67 
EPS_ATTACH_TYPE_MAXIMUM_LENGTH
 + \

68 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

69 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

70 
UE_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 + \

71 
ESM_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 + \

72 
P_TMSI_SIGNATURE_MAXIMUM_LENGTH
 + \

73 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

74 
TRACKING_AREA_IDENTITY_MAXIMUM_LENGTH
 + \

75 
DRX_PARAMETER_MAXIMUM_LENGTH
 + \

76 
MS_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 + \

77 
LOCATION_AREA_IDENTIFICATION_MAXIMUM_LENGTH
 + \

78 
TMSI_STATUS_MAXIMUM_LENGTH
 + \

79 
MOBILE_STATION_CLASSMARK_2_MAXIMUM_LENGTH
 + \

80 
MOBILE_STATION_CLASSMARK_3_MAXIMUM_LENGTH
 + \

81 
SUPPORTED_CODEC_LIST_MAXIMUM_LENGTH
 + \

82 
ADDITIONAL_UPDATE_TYPE_MAXIMUM_LENGTH
 + \

83 
GUTI_TYPE_MAXIMUM_LENGTH
 )

	)

88 
	#ATTACH_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
 (1<<0)

	)

89 
	#ATTACH_REQUEST_ADDITIONAL_GUTI_PRESENT
 (1<<1)

	)

90 
	#ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
 (1<<2)

	)

91 
	#ATTACH_REQUEST_DRX_PARAMETER_PRESENT
 (1<<3)

	)

92 
	#ATTACH_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
 (1<<4)

	)

93 
	#ATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
 (1<<5)

	)

94 
	#ATTACH_REQUEST_TMSI_STATUS_PRESENT
 (1<<6)

	)

95 
	#ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
 (1<<7)

	)

96 
	#ATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
 (1<<8)

	)

97 
	#ATTACH_REQUEST_SUPPORTED_CODECS_PRESENT
 (1<<9)

	)

98 
	#ATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
 (1<<10)

	)

99 
	#ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
 (1<<11)

	)

100 
	#ATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_PRESENT
 (1<<12)

	)

102 
	e©èch_ªque°_õi_èg
 {

103 
	mATTACH_REQUEST_OLD_PTMSI_SIGNATURE_IEI
 = 0x19,

104 
	mATTACH_REQUEST_ADDITIONAL_GUTI_IEI
 = 0x50,

105 
	mATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
 = 0x52,

106 
	mATTACH_REQUEST_DRX_PARAMETER_IEI
 = 0x5C,

107 
	mATTACH_REQUEST_MS_NETWORK_CAPABILITY_IEI
 = 0x31,

108 
	mATTACH_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
 = 0x13,

109 
	mATTACH_REQUEST_TMSI_STATUS_IEI
 = 0x90,

110 
	mATTACH_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
 = 0x11,

111 
	mATTACH_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
 = 0x20,

112 
	mATTACH_REQUEST_SUPPORTED_CODECS_IEI
 = 0x40,

113 
	mATTACH_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
 = 0xF0,

114 
	mATTACH_REQUEST_OLD_GUTI_TYPE_IEI
 = 0xE0,

115 
	mATTACH_REQUEST_VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_IEI
 = 0x5D,

116 } 
	t©èch_ªque°_õi
;

125 
	s©èch_ªque°_msg_èg
 {

127 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

128 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

129 
MesßgeTy≥
 
	mmesßgëy≥
;

130 
EpsAâachTy≥
 
	mïßâachty≥
;

131 
NasKeySëIdítifõr
 
	m«skey£tidítifõr
;

132 
EpsMobûeIdítôy
 
	mﬁdguti‹imsi
;

133 
UeNëw‹kC≠abûôy
 
	muíëw‹kˇ∑bûôy
;

134 
EsmMesßgeC⁄èöî
 
	mesmmesßgec⁄èöî
;

136 
uöt32_t
 
	m¥e£n˚mask
;

137 
PTmsiSig«tuª
 
	mﬁd±msisig«tuª
;

138 
EpsMobûeIdítôy
 
	maddôi⁄Æguti
;

139 
TøckögAªaIdítôy
 
	mœ°visôedªgi°îedèi
;

140 
DrxP¨amëî
 
	mdrx∑ømëî
;

141 
MsNëw‹kC≠abûôy
 
	mm¢ëw‹kˇ∑bûôy
;

142 
Loˇti⁄AªaIdítifiˇti⁄
 
	mﬁdloˇti⁄¨óidítifiˇti⁄
;

143 
TmsiSètus
 
	mtmsi°©us
;

144 
MobûeSèti⁄Cœssm¨k2
 
	mmobûe°©i⁄˛assm¨k2
;

145 
MobûeSèti⁄Cœssm¨k3
 
	mmobûe°©i⁄˛assm¨k3
;

146 
Suµ‹ãdCodecLi°
 
	msuµ‹ãdcodecs
;

147 
Addôi⁄ÆUpd©eTy≥
 
	maddôi⁄Æupd©ëy≥
;

148 
GutiTy≥
 
	mﬁdgutôy≥
;

149 
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 
	mvoi˚domaö¥e„ªn˚™dueußge£âög
;

150 } 
	t©èch_ªque°_msg
;

152 
decode_©èch_ªque°
(
©èch_ªque°_msg
 *
©èchªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

154 
ícode_©èch_ªque°
(
©èch_ªque°_msg
 *
©èchªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AuthenticationFailure.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Authítiˇti⁄Faûuª.h
"

39 
	$decode_authítiˇti⁄_Áûuª
(
authítiˇti⁄_Áûuª_msg
 *
authítiˇti⁄_Áûuª
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
AUTHENTICATION_FAILURE_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
authítiˇti⁄_Áûuª
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_authítiˇti⁄_Áûuª_∑ømëî
(&
authítiˇti⁄_Áûuª
->
authítiˇti⁄Áûuª∑ømëî
,

65 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
authítiˇti⁄_Áûuª
->
¥e£n˚mask
 |
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_authítiˇti⁄_Áûuª
(
authítiˇti⁄_Áûuª_msg
 *
authítiˇti⁄_Áûuª
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_FAILURE_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
authítiˇti⁄_Áûuª
->
emmˇu£
, 0,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

90  
ícode_ªsu…
;

92 
ícoded
 +
ícode_ªsu…
;

94 i‡((
authítiˇti⁄_Áûuª
->
¥e£n˚mask
 & 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
)

95 =
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
)

97 i‡((
ícode_ªsu…
 =

98 
	`ícode_authítiˇti⁄_Áûuª_∑ømëî
(&
authítiˇti⁄_Áûuª
->
authítiˇti⁄Áûuª∑ømëî
,

99 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_IEI
,

100 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

102  
ícode_ªsu…
;

104 
ícoded
 +
ícode_ªsu…
;

107  
ícoded
;

108 
	}
}

	@src/emm/msg/AuthenticationFailure.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

37 
	~"Authítiˇti⁄FaûuªP¨amëî.h
"

39 #i‚de‡
AUTHENTICATION_FAILURE_H_


40 
	#AUTHENTICATION_FAILURE_H_


	)

43 
	#AUTHENTICATION_FAILURE_MINIMUM_LENGTH
 ( \

44 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

47 
	#AUTHENTICATION_FAILURE_MAXIMUM_LENGTH
 ( \

48 
EMM_CAUSE_MAXIMUM_LENGTH
 + \

49 
AUTHENTICATION_FAILURE_PARAMETER_MAXIMUM_LENGTH
 )

	)

54 
	#AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
 (1<<0)

	)

56 
	eauthítiˇti⁄_Áûuª_õi_èg
 {

57 
	mAUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_IEI
 = 0x30,

58 } 
	tauthítiˇti⁄_Áûuª_õi
;

67 
	sauthítiˇti⁄_Áûuª_msg_èg
 {

69 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

70 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

71 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
EmmCau£
 
	memmˇu£
;

74 
uöt32_t
 
	m¥e£n˚mask
;

75 
Authítiˇti⁄FaûuªP¨amëî
 
	mauthítiˇti⁄Áûuª∑ømëî
;

76 } 
	tauthítiˇti⁄_Áûuª_msg
;

78 
decode_authítiˇti⁄_Áûuª
(
authítiˇti⁄_Áûuª_msg
 *
authítiˇti⁄Áûuª
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

80 
ícode_authítiˇti⁄_Áûuª
(
authítiˇti⁄_Áûuª_msg
 *
authítiˇti⁄Áûuª
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AuthenticationReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Authítiˇti⁄Reje˘.h
"

39 
	$decode_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
authítiˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

43 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
AUTHENTICATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

46  
decoded
;

47 
	}
}

49 
	$ícode_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
authítiˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

51 
ícoded
 = 0;

53 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

55  
ícoded
;

56 
	}
}

	@src/emm/msg/AuthenticationReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

37 #i‚de‡
AUTHENTICATION_REJECT_H_


38 
	#AUTHENTICATION_REJECT_H_


	)

41 
	#AUTHENTICATION_REJECT_MINIMUM_LENGTH
 (0)

	)

44 
	#AUTHENTICATION_REJECT_MAXIMUM_LENGTH
 (0)

	)

53 
	sauthítiˇti⁄_ªje˘_msg_èg
 {

55 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

56 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

57 
MesßgeTy≥
 
	mmesßgëy≥
;

58 } 
	tauthítiˇti⁄_ªje˘_msg
;

60 
decode_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
authítiˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

62 
ícode_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
authítiˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AuthenticationRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Authítiˇti⁄Reque°.h
"

39 
	$decode_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
authítiˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
AUTHENTICATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
authítiˇti⁄_ªque°
->
«skey£tidítifõøsme
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52 i‡((
decoded_ªsu…
 = 
	`decode_authítiˇti⁄_∑ømëî_ønd
(&
authítiˇti⁄_ªque°
->
authítiˇti⁄∑ømëîønd
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

53  
decoded_ªsu…
;

55 
decoded
 +
decoded_ªsu…
;

57 i‡((
decoded_ªsu…
 = 
	`decode_authítiˇti⁄_∑ømëî_auä
(&
authítiˇti⁄_ªque°
->
authítiˇti⁄∑ømëîauä
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

58  
decoded_ªsu…
;

60 
decoded
 +
decoded_ªsu…
;

62  
decoded
;

63 
	}
}

65 
	$ícode_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
authítiˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

67 
ícoded
 = 0;

68 
ícode_ªsu…
 = 0;

71 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

73 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_«s_key_£t_idítifõr
(&
authítiˇti⁄_ªque°
->
«skey£tidítifõøsme
) & 0x0f) << 4) | 0x00;

74 
ícoded
++;

75 i‡((
ícode_ªsu…
 =

76 
	`ícode_authítiˇti⁄_∑ømëî_ønd
(&
authítiˇti⁄_ªque°
->
authítiˇti⁄∑ømëîønd
,

77 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

82 i‡((
ícode_ªsu…
 =

83 
	`ícode_authítiˇti⁄_∑ømëî_auä
(&
authítiˇti⁄_ªque°
->
authítiˇti⁄∑ømëîauä
,

84 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

85  
ícode_ªsu…
;

87 
ícoded
 +
ícode_ªsu…
;

89  
ícoded
;

90 
	}
}

	@src/emm/msg/AuthenticationRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"NasKeySëIdítifõr.h
"

37 
	~"Authítiˇti⁄P¨amëîR™d.h
"

38 
	~"Authítiˇti⁄P¨amëîAuä.h
"

40 #i‚de‡
AUTHENTICATION_REQUEST_H_


41 
	#AUTHENTICATION_REQUEST_H_


	)

44 
	#AUTHENTICATION_REQUEST_MINIMUM_LENGTH
 ( \

45 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

46 
AUTHENTICATION_PARAMETER_RAND_MINIMUM_LENGTH
 + \

47 
AUTHENTICATION_PARAMETER_AUTN_MINIMUM_LENGTH
 )

	)

50 
	#AUTHENTICATION_REQUEST_MAXIMUM_LENGTH
 ( \

51 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

52 
AUTHENTICATION_PARAMETER_RAND_MAXIMUM_LENGTH
 + \

53 
AUTHENTICATION_PARAMETER_AUTN_MAXIMUM_LENGTH
 )

	)

63 
	sauthítiˇti⁄_ªque°_msg_èg
 {

65 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

66 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

67 
MesßgeTy≥
 
	mmesßgëy≥
;

68 
NasKeySëIdítifõr
 
	m«skey£tidítifõøsme
;

69 
Authítiˇti⁄P¨amëîR™d
 
	mauthítiˇti⁄∑ømëîønd
;

70 
Authítiˇti⁄P¨amëîAuä
 
	mauthítiˇti⁄∑ømëîauä
;

71 } 
	tauthítiˇti⁄_ªque°_msg
;

73 
decode_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
authítiˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

75 
ícode_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
authítiˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/AuthenticationResponse.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Authítiˇti⁄Re•⁄£.h
"

39 
	$decode_authítiˇti⁄_ª•⁄£
(
authítiˇti⁄_ª•⁄£_msg
 *
authítiˇti⁄_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
AUTHENTICATION_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_authítiˇti⁄_ª•⁄£_∑ømëî
(&
authítiˇti⁄_ª•⁄£
->
authítiˇti⁄ª•⁄£∑ømëî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_authítiˇti⁄_ª•⁄£
(
authítiˇti⁄_ª•⁄£_msg
 *
authítiˇti⁄_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_authítiˇti⁄_ª•⁄£_∑ømëî
(&
authítiˇti⁄_ª•⁄£
->
authítiˇti⁄ª•⁄£∑ømëî
,

66 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/AuthenticationResponse.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"Authítiˇti⁄Re•⁄£P¨amëî.h
"

38 #i‚de‡
AUTHENTICATION_RESPONSE_H_


39 
	#AUTHENTICATION_RESPONSE_H_


	)

42 
	#AUTHENTICATION_RESPONSE_MINIMUM_LENGTH
 ( \

43 
AUTHENTICATION_RESPONSE_PARAMETER_MINIMUM_LENGTH
 )

	)

46 
	#AUTHENTICATION_RESPONSE_MAXIMUM_LENGTH
 ( \

47 
AUTHENTICATION_RESPONSE_PARAMETER_MAXIMUM_LENGTH
 )

	)

57 
	sauthítiˇti⁄_ª•⁄£_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
Authítiˇti⁄Re•⁄£P¨amëî
 
	mauthítiˇti⁄ª•⁄£∑ømëî
;

63 } 
	tauthítiˇti⁄_ª•⁄£_msg
;

65 
decode_authítiˇti⁄_ª•⁄£
(
authítiˇti⁄_ª•⁄£_msg
 *
authítiˇti⁄ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_authítiˇti⁄_ª•⁄£
(
authítiˇti⁄_ª•⁄£_msg
 *
authítiˇti⁄ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/CsServiceNotification.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"CsSîvi˚NŸifiˇti⁄.h
"

39 
	$decode_cs_£rvi˚_nŸifiˇti⁄
(
cs_£rvi˚_nŸifiˇti⁄_msg
 *
cs_£rvi˚_nŸifiˇti⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
CS_SERVICE_NOTIFICATION_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_∑gög_idítôy
(&
cs_£rvi˚_nŸifiˇti⁄
->
∑gögidítôy
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
CS_SERVICE_NOTIFICATION_CLI_IEI
:

63 i‡((
decoded_ªsu…
 = 
	`decode_˛i
(&
cs_£rvi˚_nŸifiˇti⁄
->
˛i
,

64 
CS_SERVICE_NOTIFICATION_CLI_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

65 
decoded
)) <= 0)

66  
decoded_ªsu…
;

67 
decoded
 +
decoded_ªsu…
;

69 
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 |
CS_SERVICE_NOTIFICATION_CLI_PRESENT
;

71 
CS_SERVICE_NOTIFICATION_SS_CODE_IEI
:

72 i‡((
decoded_ªsu…
 =

73 
	`decode_ss_code
(&
cs_£rvi˚_nŸifiˇti⁄
->
sscode
,

74 
CS_SERVICE_NOTIFICATION_SS_CODE_IEI
, 
buf„r
 + 
decoded
, 
Àn


75 - 
decoded
)) <= 0)

76  
decoded_ªsu…
;

77 
decoded
 +
decoded_ªsu…
;

79 
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 |
CS_SERVICE_NOTIFICATION_SS_CODE_PRESENT
;

81 
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_IEI
:

82 i‡((
decoded_ªsu…
 =

83 
	`decode_lcs_ödiˇt‹
(&
cs_£rvi˚_nŸifiˇti⁄
->
lcsödiˇt‹
,

84 
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_IEI
, 
buf„r
 +

85 
decoded
, 
Àn
 - decoded)) <= 0)

86  
decoded_ªsu…
;

87 
decoded
 +
decoded_ªsu…
;

89 
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 |
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_PRESENT
;

91 
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_IEI
:

92 i‡((
decoded_ªsu…
 =

93 
	`decode_lcs_˛õ¡_idítôy
(&
cs_£rvi˚_nŸifiˇti⁄
->
lcs˛õ¡idítôy
,

94 
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_IEI
, 
buf„r
 +

95 
decoded
, 
Àn
 - decoded)) <= 0)

96  
decoded_ªsu…
;

97 
decoded
 +
decoded_ªsu…
;

99 
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 |
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_PRESENT
;

102 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

103  
TLV_DECODE_UNEXPECTED_IEI
;

106  
decoded
;

107 
	}
}

109 
	$ícode_cs_£rvi˚_nŸifiˇti⁄
(
cs_£rvi˚_nŸifiˇti⁄_msg
 *
cs_£rvi˚_nŸifiˇti⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

111 
ícoded
 = 0;

112 
ícode_ªsu…
 = 0;

115 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
CS_SERVICE_NOTIFICATION_MINIMUM_LENGTH
, 
Àn
);

117 i‡((
ícode_ªsu…
 =

118 
	`ícode_∑gög_idítôy
(&
cs_£rvi˚_nŸifiˇti⁄
->
∑gögidítôy
, 0,

119 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

120  
ícode_ªsu…
;

122 
ícoded
 +
ícode_ªsu…
;

124 i‡((
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 & 
CS_SERVICE_NOTIFICATION_CLI_PRESENT
)

125 =
CS_SERVICE_NOTIFICATION_CLI_PRESENT
)

127 i‡((
ícode_ªsu…
 = 
	`ícode_˛i
(&
cs_£rvi˚_nŸifiˇti⁄
->
˛i
,

128 
CS_SERVICE_NOTIFICATION_CLI_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded))

131  
ícode_ªsu…
;

133 
ícoded
 +
ícode_ªsu…
;

136 i‡((
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 & 
CS_SERVICE_NOTIFICATION_SS_CODE_PRESENT
)

137 =
CS_SERVICE_NOTIFICATION_SS_CODE_PRESENT
)

139 i‡((
ícode_ªsu…
 = 
	`ícode_ss_code
(&
cs_£rvi˚_nŸifiˇti⁄
->
sscode
,

140 
CS_SERVICE_NOTIFICATION_SS_CODE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

141 
ícoded
)) < 0)

143  
ícode_ªsu…
;

145 
ícoded
 +
ícode_ªsu…
;

148 i‡((
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 & 
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_PRESENT
)

149 =
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_PRESENT
)

151 i‡((
ícode_ªsu…
 =

152 
	`ícode_lcs_ödiˇt‹
(&
cs_£rvi˚_nŸifiˇti⁄
->
lcsödiˇt‹
,

153 
CS_SERVICE_NOTIFICATION_LCS_INDICATOR_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

154 
ícoded
)) < 0)

156  
ícode_ªsu…
;

158 
ícoded
 +
ícode_ªsu…
;

161 i‡((
cs_£rvi˚_nŸifiˇti⁄
->
¥e£n˚mask
 & 
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_PRESENT
)

162 =
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_PRESENT
)

164 i‡((
ícode_ªsu…
 =

165 
	`ícode_lcs_˛õ¡_idítôy
(&
cs_£rvi˚_nŸifiˇti⁄
->
lcs˛õ¡idítôy
,

166 
CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_IEI
, 
buf„r
 + 
ícoded
,

167 
Àn
 - 
ícoded
)) < 0)

169  
ícode_ªsu…
;

171 
ícoded
 +
ícode_ªsu…
;

174  
ícoded
;

175 
	}
}

	@src/emm/msg/CsServiceNotification.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"PagögIdítôy.h
"

37 
	~"Cli.h
"

38 
	~"SsCode.h
"

39 
	~"LcsIndiˇt‹.h
"

40 
	~"LcsClõ¡Idítôy.h
"

42 #i‚de‡
CS_SERVICE_NOTIFICATION_H_


43 
	#CS_SERVICE_NOTIFICATION_H_


	)

46 
	#CS_SERVICE_NOTIFICATION_MINIMUM_LENGTH
 ( \

47 
PAGING_IDENTITY_MINIMUM_LENGTH
 )

	)

50 
	#CS_SERVICE_NOTIFICATION_MAXIMUM_LENGTH
 ( \

51 
PAGING_IDENTITY_MAXIMUM_LENGTH
 + \

52 
CLI_MAXIMUM_LENGTH
 + \

53 
SS_CODE_MAXIMUM_LENGTH
 + \

54 
LCS_INDICATOR_MAXIMUM_LENGTH
 + \

55 
LCS_CLIENT_IDENTITY_MAXIMUM_LENGTH
 )

	)

60 
	#CS_SERVICE_NOTIFICATION_CLI_PRESENT
 (1<<0)

	)

61 
	#CS_SERVICE_NOTIFICATION_SS_CODE_PRESENT
 (1<<1)

	)

62 
	#CS_SERVICE_NOTIFICATION_LCS_INDICATOR_PRESENT
 (1<<2)

	)

63 
	#CS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_PRESENT
 (1<<3)

	)

65 
	ecs_£rvi˚_nŸifiˇti⁄_õi_èg
 {

66 
	mCS_SERVICE_NOTIFICATION_CLI_IEI
 = 0x60,

67 
	mCS_SERVICE_NOTIFICATION_SS_CODE_IEI
 = 0x61,

68 
	mCS_SERVICE_NOTIFICATION_LCS_INDICATOR_IEI
 = 0x62,

69 
	mCS_SERVICE_NOTIFICATION_LCS_CLIENT_IDENTITY_IEI
 = 0x63,

70 } 
	tcs_£rvi˚_nŸifiˇti⁄_õi
;

79 
	scs_£rvi˚_nŸifiˇti⁄_msg_èg
 {

81 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

82 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

83 
MesßgeTy≥
 
	mmesßgëy≥
;

84 
PagögIdítôy
 
	m∑gögidítôy
;

86 
uöt32_t
 
	m¥e£n˚mask
;

87 
Cli
 
	m˛i
;

88 
SsCode
 
	msscode
;

89 
LcsIndiˇt‹
 
	mlcsödiˇt‹
;

90 
LcsClõ¡Idítôy
 
	mlcs˛õ¡idítôy
;

91 } 
	tcs_£rvi˚_nŸifiˇti⁄_msg
;

93 
decode_cs_£rvi˚_nŸifiˇti⁄
(
cs_£rvi˚_nŸifiˇti⁄_msg
 *
cs£rvi˚nŸifiˇti⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

95 
ícode_cs_£rvi˚_nŸifiˇti⁄
(
cs_£rvi˚_nŸifiˇti⁄_msg
 *
cs£rvi˚nŸifiˇti⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/DetachAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"DëachAc˚±.h
"

39 
	$decode_dëach_ac˚±
(
dëach_ac˚±_msg
 *
dëach_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

43 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DETACH_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

46  
decoded
;

47 
	}
}

49 
	$ícode_dëach_ac˚±
(
dëach_ac˚±_msg
 *
dëach_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

51 
ícoded
 = 0;

53 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DETACH_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

55  
ícoded
;

56 
	}
}

	@src/emm/msg/DetachAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

37 #i‚de‡
DETACH_ACCEPT_H_


38 
	#DETACH_ACCEPT_H_


	)

41 
	#DETACH_ACCEPT_MINIMUM_LENGTH
 (0)

	)

44 
	#DETACH_ACCEPT_MAXIMUM_LENGTH
 (0)

	)

53 
	sdëach_ac˚±_msg_èg
 {

55 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

56 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

57 
MesßgeTy≥
 
	mmesßgëy≥
;

58 } 
	tdëach_ac˚±_msg
;

60 
decode_dëach_ac˚±
(
dëach_ac˚±_msg
 *
dëachac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

62 
ícode_dëach_ac˚±
(
dëach_ac˚±_msg
 *
dëachac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/DetachRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"DëachReque°.h
"

39 
	$decode_dëach_ªque°
(
dëach_ªque°_msg
 *
dëach_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DETACH_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_dëach_ty≥
(&
dëach_ªque°
->
dëachty≥
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
dëach_ªque°
->
«skey£tidítifõr
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

52  
decoded_ªsu…
;

54 
decoded
++;

55 i‡((
decoded_ªsu…
 = 
	`decode_ïs_mobûe_idítôy
(&
dëach_ªque°
->
guti‹imsi
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

56  
decoded_ªsu…
;

58 
decoded
 +
decoded_ªsu…
;

60  
decoded
;

61 
	}
}

63 
	$ícode_dëach_ªque°
(
dëach_ªque°_msg
 *
dëach_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

65 
ícoded
 = 0;

66 
ícode_ªsu…
 = 0;

69 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DETACH_REQUEST_MINIMUM_LENGTH
, 
Àn
);

71 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_«s_key_£t_idítifõr
(&
dëach_ªque°
->
«skey£tidítifõr
Ë<< 4Ë| (
	`ícode_u8_dëach_ty≥
(&dëach_ªque°->
dëachty≥
) & 0x0f));

72 
ícoded
++;

74 i‡((
ícode_ªsu…
 = 
	`ícode_ïs_mobûe_idítôy
(&
dëach_ªque°
->
guti‹imsi
,

75 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

76  
ícode_ªsu…
;

78 
ícoded
 +
ícode_ªsu…
;

80  
ícoded
;

81 
	}
}

	@src/emm/msg/DetachRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"DëachTy≥.h
"

37 
	~"NasKeySëIdítifõr.h
"

38 
	~"EpsMobûeIdítôy.h
"

40 #i‚de‡
DETACH_REQUEST_H_


41 
	#DETACH_REQUEST_H_


	)

44 
	#DETACH_REQUEST_MINIMUM_LENGTH
 ( \

45 
DETACH_TYPE_MINIMUM_LENGTH
 + \

46 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

47 
EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
 )

	)

50 
	#DETACH_REQUEST_MAXIMUM_LENGTH
 ( \

51 
DETACH_TYPE_MAXIMUM_LENGTH
 + \

52 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

53 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 )

	)

63 
	sdëach_ªque°_msg_èg
 {

65 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

66 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

67 
MesßgeTy≥
 
	mmesßgëy≥
;

68 
DëachTy≥
 
	mdëachty≥
;

69 
NasKeySëIdítifõr
 
	m«skey£tidítifõr
;

70 
EpsMobûeIdítôy
 
	mguti‹imsi
;

71 } 
	tdëach_ªque°_msg
;

73 
decode_dëach_ªque°
(
dëach_ªque°_msg
 *
dëachªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

75 
ícode_dëach_ªque°
(
dëach_ªque°_msg
 *
dëachªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/DownlinkNasTransport.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Dow∆ökNasTøn•‹t.h
"

39 
	$decode_dow∆ök_«s_å™•‹t
(
dow∆ök_«s_å™•‹t_msg
 *
dow∆ök_«s_å™•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DOWNLINK_NAS_TRANSPORT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_«s_mesßge_c⁄èöî
(&
dow∆ök_«s_å™•‹t
->
«smesßgec⁄èöî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_dow∆ök_«s_å™•‹t
(
dow∆ök_«s_å™•‹t_msg
 *
dow∆ök_«s_å™•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DOWNLINK_NAS_TRANSPORT_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_«s_mesßge_c⁄èöî
(&
dow∆ök_«s_å™•‹t
->
«smesßgec⁄èöî
,

66 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/DownlinkNasTransport.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"NasMesßgeC⁄èöî.h
"

38 #i‚de‡
DOWNLINK_NAS_TRANSPORT_H_


39 
	#DOWNLINK_NAS_TRANSPORT_H_


	)

42 
	#DOWNLINK_NAS_TRANSPORT_MINIMUM_LENGTH
 ( \

43 
NAS_MESSAGE_CONTAINER_MINIMUM_LENGTH
 )

	)

46 
	#DOWNLINK_NAS_TRANSPORT_MAXIMUM_LENGTH
 ( \

47 
NAS_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 )

	)

57 
	sdow∆ök_«s_å™•‹t_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
NasMesßgeC⁄èöî
 
	m«smesßgec⁄èöî
;

63 } 
	tdow∆ök_«s_å™•‹t_msg
;

65 
decode_dow∆ök_«s_å™•‹t
(
dow∆ök_«s_å™•‹t_msg
 *
dow∆ök«°øn•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_dow∆ök_«s_å™•‹t
(
dow∆ök_«s_å™•‹t_msg
 *
dow∆ök«°øn•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/EmmInformation.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"EmmInf‹m©i⁄.h
"

39 
	$decode_emm_öf‹m©i⁄
(
emm_öf‹m©i⁄_msg
 *
emm_öf‹m©i⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EMM_INFORMATION_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_√tw‹k_«me
(&
emm_öf‹m©i⁄
->
fuŒ«mef‹√tw‹k
,

60 
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_IEI
, 
buf„r
 +

61 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
emm_öf‹m©i⁄
->
¥e£n˚mask
 |
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_PRESENT
;

67 
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_IEI
:

68 i‡((
decoded_ªsu…
 =

69 
	`decode_√tw‹k_«me
(&
emm_öf‹m©i⁄
->
sh‹äamef‹√tw‹k
,

70 
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_IEI
, 
buf„r
 +

71 
decoded
, 
Àn
 - decoded)) <= 0)

72  
decoded_ªsu…
;

73 
decoded
 +
decoded_ªsu…
;

75 
emm_öf‹m©i⁄
->
¥e£n˚mask
 |
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_PRESENT
;

77 
EMM_INFORMATION_LOCAL_TIME_ZONE_IEI
:

78 i‡((
decoded_ªsu…
 =

79 
	`decode_time_z⁄e
(&
emm_öf‹m©i⁄
->
loˇ…imez⁄e
,

80 
EMM_INFORMATION_LOCAL_TIME_ZONE_IEI
, 
buf„r
 + 
decoded
, 
Àn


81 - 
decoded
)) <= 0)

82  
decoded_ªsu…
;

83 
decoded
 +
decoded_ªsu…
;

85 
emm_öf‹m©i⁄
->
¥e£n˚mask
 |
EMM_INFORMATION_LOCAL_TIME_ZONE_PRESENT
;

87 
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_IEI
:

88 i‡((
decoded_ªsu…
 =

89 
	`decode_time_z⁄e_™d_time
(&
emm_öf‹m©i⁄
->
univîß…imóndloˇ…imez⁄e
,

90 
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_IEI
,

91 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

92  
decoded_ªsu…
;

93 
decoded
 +
decoded_ªsu…
;

95 
emm_öf‹m©i⁄
->
¥e£n˚mask
 |
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_PRESENT
;

97 
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_IEI
:

98 i‡((
decoded_ªsu…
 =

99 
	`decode_daylight_ßvög_time
(&
emm_öf‹m©i⁄
->
√tw‹kdaylightßvögtime
,

100 
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_IEI
, 
buf„r
 +

101 
decoded
, 
Àn
 - decoded)) <= 0)

102  
decoded_ªsu…
;

103 
decoded
 +
decoded_ªsu…
;

105 
emm_öf‹m©i⁄
->
¥e£n˚mask
 |
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_PRESENT
;

108 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

109  
TLV_DECODE_UNEXPECTED_IEI
;

112  
decoded
;

113 
	}
}

115 
	$ícode_emm_öf‹m©i⁄
(
emm_öf‹m©i⁄_msg
 *
emm_öf‹m©i⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

117 
ícoded
 = 0;

118 
ícode_ªsu…
 = 0;

121 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EMM_INFORMATION_MINIMUM_LENGTH
, 
Àn
);

123 i‡((
emm_öf‹m©i⁄
->
¥e£n˚mask
 & 
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_PRESENT
)

124 =
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_PRESENT
)

126 i‡((
ícode_ªsu…
 =

127 
	`ícode_√tw‹k_«me
(&
emm_öf‹m©i⁄
->
fuŒ«mef‹√tw‹k
,

128 
EMM_INFORMATION_FULL_NAME_FOR_NETWORK_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

129 
ícoded
)) < 0)

131  
ícode_ªsu…
;

133 
ícoded
 +
ícode_ªsu…
;

136 i‡((
emm_öf‹m©i⁄
->
¥e£n˚mask
 & 
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_PRESENT
)

137 =
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_PRESENT
)

139 i‡((
ícode_ªsu…
 =

140 
	`ícode_√tw‹k_«me
(&
emm_öf‹m©i⁄
->
sh‹äamef‹√tw‹k
,

141 
EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_IEI
, 
buf„r
 + 
ícoded
, 
Àn


142 - 
ícoded
)) < 0)

144  
ícode_ªsu…
;

146 
ícoded
 +
ícode_ªsu…
;

149 i‡((
emm_öf‹m©i⁄
->
¥e£n˚mask
 & 
EMM_INFORMATION_LOCAL_TIME_ZONE_PRESENT
)

150 =
EMM_INFORMATION_LOCAL_TIME_ZONE_PRESENT
)

152 i‡((
ícode_ªsu…
 = 
	`ícode_time_z⁄e
(&
emm_öf‹m©i⁄
->
loˇ…imez⁄e
,

153 
EMM_INFORMATION_LOCAL_TIME_ZONE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

154 
ícoded
)) < 0)

156  
ícode_ªsu…
;

158 
ícoded
 +
ícode_ªsu…
;

161 i‡((
emm_öf‹m©i⁄
->
¥e£n˚mask
 & 
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_PRESENT
)

162 =
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_PRESENT
)

164 i‡((
ícode_ªsu…
 =

165 
	`ícode_time_z⁄e_™d_time
(&
emm_öf‹m©i⁄
->
univîß…imóndloˇ…imez⁄e
,

166 
EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_IEI
, 
buf„r
 +

167 
ícoded
, 
Àn
 -Éncoded)) < 0)

169  
ícode_ªsu…
;

171 
ícoded
 +
ícode_ªsu…
;

174 i‡((
emm_öf‹m©i⁄
->
¥e£n˚mask
 & 
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_PRESENT
)

175 =
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_PRESENT
)

177 i‡((
ícode_ªsu…
 =

178 
	`ícode_daylight_ßvög_time
(&
emm_öf‹m©i⁄
->
√tw‹kdaylightßvögtime
,

179 
EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_IEI
, 
buf„r
 +

180 
ícoded
, 
Àn
 -Éncoded)) < 0)

182  
ícode_ªsu…
;

184 
ícoded
 +
ícode_ªsu…
;

187  
ícoded
;

188 
	}
}

	@src/emm/msg/EmmInformation.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"Nëw‹kName.h
"

37 
	~"TimeZ⁄e.h
"

38 
	~"TimeZ⁄eAndTime.h
"

39 
	~"DaylightSavögTime.h
"

41 #i‚de‡
EMM_INFORMATION_H_


42 
	#EMM_INFORMATION_H_


	)

45 
	#EMM_INFORMATION_MINIMUM_LENGTH
 (0)

	)

48 
	#EMM_INFORMATION_MAXIMUM_LENGTH
 ( \

49 
NETWORK_NAME_MAXIMUM_LENGTH
 + \

50 
NETWORK_NAME_MAXIMUM_LENGTH
 + \

51 
TIME_ZONE_MAXIMUM_LENGTH
 + \

52 
TIME_ZONE_AND_TIME_MAXIMUM_LENGTH
 + \

53 
DAYLIGHT_SAVING_TIME_MAXIMUM_LENGTH
 )

	)

58 
	#EMM_INFORMATION_FULL_NAME_FOR_NETWORK_PRESENT
 (1<<0)

	)

59 
	#EMM_INFORMATION_SHORT_NAME_FOR_NETWORK_PRESENT
 (1<<1)

	)

60 
	#EMM_INFORMATION_LOCAL_TIME_ZONE_PRESENT
 (1<<2)

	)

61 
	#EMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_PRESENT
 (1<<3)

	)

62 
	#EMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_PRESENT
 (1<<4)

	)

64 
	eemm_öf‹m©i⁄_õi_èg
 {

65 
	mEMM_INFORMATION_FULL_NAME_FOR_NETWORK_IEI
 = 0x43,

66 
	mEMM_INFORMATION_SHORT_NAME_FOR_NETWORK_IEI
 = 0x45,

67 
	mEMM_INFORMATION_LOCAL_TIME_ZONE_IEI
 = 0x46,

68 
	mEMM_INFORMATION_UNIVERSAL_TIME_AND_LOCAL_TIME_ZONE_IEI
 = 0x47,

69 
	mEMM_INFORMATION_NETWORK_DAYLIGHT_SAVING_TIME_IEI
 = 0x49,

70 } 
	temm_öf‹m©i⁄_õi
;

79 
	semm_öf‹m©i⁄_msg_èg
 {

81 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

82 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

83 
MesßgeTy≥
 
	mmesßgëy≥
;

85 
uöt32_t
 
	m¥e£n˚mask
;

86 
Nëw‹kName
 
	mfuŒ«mef‹√tw‹k
;

87 
Nëw‹kName
 
	msh‹äamef‹√tw‹k
;

88 
TimeZ⁄e
 
	mloˇ…imez⁄e
;

89 
TimeZ⁄eAndTime
 
	munivîß…imóndloˇ…imez⁄e
;

90 
DaylightSavögTime
 
	m√tw‹kdaylightßvögtime
;

91 } 
	temm_öf‹m©i⁄_msg
;

93 
decode_emm_öf‹m©i⁄
(
emm_öf‹m©i⁄_msg
 *
emmöf‹m©i⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

95 
ícode_emm_öf‹m©i⁄
(
emm_öf‹m©i⁄_msg
 *
emmöf‹m©i⁄
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/EmmStatus.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"EmmSètus.h
"

39 
	$decode_emm_°©us
(
emm_°©us_msg
 *
emm_°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EMM_STATUS_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
emm_°©us
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_emm_°©us
(
emm_°©us_msg
 *
emm_°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EMM_STATUS_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
emm_°©us
->
emmˇu£
, 0, 
buf„r
 +

65 
ícoded
, 
Àn
 -Éncoded)) < 0)

66  
ícode_ªsu…
;

68 
ícoded
 +
ícode_ªsu…
;

70  
ícoded
;

71 
	}
}

	@src/emm/msg/EmmStatus.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

38 #i‚de‡
EMM_STATUS_H_


39 
	#EMM_STATUS_H_


	)

42 
	#EMM_STATUS_MINIMUM_LENGTH
 ( \

43 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

46 
	#EMM_STATUS_MAXIMUM_LENGTH
 ( \

47 
EMM_CAUSE_MAXIMUM_LENGTH
 )

	)

57 
	semm_°©us_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
EmmCau£
 
	memmˇu£
;

63 } 
	temm_°©us_msg
;

65 
decode_emm_°©us
(
emm_°©us_msg
 *
emm°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_emm_°©us
(
emm_°©us_msg
 *
emm°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/ExtendedServiceRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"ExãndedSîvi˚Reque°.h
"

39 
	$decode_exãnded_£rvi˚_ªque°
(
exãnded_£rvi˚_ªque°_msg
 *
exãnded_£rvi˚_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EXTENDED_SERVICE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_£rvi˚_ty≥
(&
exãnded_£rvi˚_ªque°
->
£rvi˚ty≥
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
exãnded_£rvi˚_ªque°
->
«skey£tidítifõr
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

52  
decoded_ªsu…
;

54 
decoded
++;

55 i‡((
decoded_ªsu…
 = 
	`decode_mobûe_idítôy
(&
exãnded_£rvi˚_ªque°
->
mtmsi
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

56  
decoded_ªsu…
;

58 
decoded
 +
decoded_ªsu…
;

60  
decoded
;

61 
	}
}

63 
	$ícode_exãnded_£rvi˚_ªque°
(
exãnded_£rvi˚_ªque°_msg
 *
exãnded_£rvi˚_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

65 
ícoded
 = 0;

66 
ícode_ªsu…
 = 0;

69 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EXTENDED_SERVICE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

71 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_£rvi˚_ty≥
(&
exãnded_£rvi˚_ªque°
->
£rvi˚ty≥
Ë& 0x0fË<< 4Ë| (
	`ícode_u8_«s_key_£t_idítifõr
(&exãnded_£rvi˚_ªque°->
«skey£tidítifõr
) & 0x0f);

72 
ícoded
++;

73 i‡((
ícode_ªsu…
 =

74 
	`ícode_mobûe_idítôy
(&
exãnded_£rvi˚_ªque°
->
mtmsi
, 0, 
buf„r
 +

75 
ícoded
, 
Àn
 -Éncoded)) < 0)

76  
ícode_ªsu…
;

78 
ícoded
 +
ícode_ªsu…
;

80 i‡((
ícode_ªsu…
 =

81 
	`ícode_csfb_ª•⁄£
(&
exãnded_£rvi˚_ªque°
->
csfbª•⁄£
, 0,

82 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

83  
ícode_ªsu…
;

85 
ícoded
 +
ícode_ªsu…
;

87  
ícoded
;

88 
	}
}

	@src/emm/msg/ExtendedServiceRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"Sîvi˚Ty≥.h
"

37 
	~"NasKeySëIdítifõr.h
"

38 
	~"MobûeIdítôy.h
"

39 
	~"CsfbRe•⁄£.h
"

41 #i‚de‡
EXTENDED_SERVICE_REQUEST_H_


42 
	#EXTENDED_SERVICE_REQUEST_H_


	)

45 
	#EXTENDED_SERVICE_REQUEST_MINIMUM_LENGTH
 ( \

46 
SERVICE_TYPE_MINIMUM_LENGTH
 + \

47 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

48 
MOBILE_IDENTITY_MINIMUM_LENGTH
 )

	)

51 
	#EXTENDED_SERVICE_REQUEST_MAXIMUM_LENGTH
 ( \

52 
SERVICE_TYPE_MAXIMUM_LENGTH
 + \

53 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

54 
MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

55 
CSFB_RESPONSE_MAXIMUM_LENGTH
 )

	)

65 
	sexãnded_£rvi˚_ªque°_msg_èg
 {

67 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

68 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

69 
MesßgeTy≥
 
	mmesßgëy≥
;

70 
Sîvi˚Ty≥
 
	m£rvi˚ty≥
;

71 
NasKeySëIdítifõr
 
	m«skey£tidítifõr
;

72 
MobûeIdítôy
 
	mmtmsi
;

74 
uöt32_t
 
	m¥e£n˚mask
;

75 
CsfbRe•⁄£
 
	mcsfbª•⁄£
;

76 } 
	texãnded_£rvi˚_ªque°_msg
;

78 
decode_exãnded_£rvi˚_ªque°
(
exãnded_£rvi˚_ªque°_msg
 *
exãnded£rvi˚ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

80 
ícode_exãnded_£rvi˚_ªque°
(
exãnded_£rvi˚_ªque°_msg
 *
exãnded£rvi˚ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/GutiReallocationCommand.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"GutiRóŒoˇti⁄Comm™d.h
"

39 
	$decode_guti_ªÆloˇti⁄_comm™d
(
guti_ªÆloˇti⁄_comm™d_msg
 *
guti_ªÆloˇti⁄_comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
GUTI_REALLOCATION_COMMAND_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_ïs_mobûe_idítôy
(&
guti_ªÆloˇti⁄_comm™d
->
guti
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
GUTI_REALLOCATION_COMMAND_TAI_LIST_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_åackög_¨ó_idítôy_li°
(&
guti_ªÆloˇti⁄_comm™d
->
èûi°
,

65 
GUTI_REALLOCATION_COMMAND_TAI_LIST_IEI
, 
buf„r
 + 
decoded
,

66 
Àn
 - 
decoded
)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
guti_ªÆloˇti⁄_comm™d
->
¥e£n˚mask
 |
GUTI_REALLOCATION_COMMAND_TAI_LIST_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_guti_ªÆloˇti⁄_comm™d
(
guti_ªÆloˇti⁄_comm™d_msg
 *
guti_ªÆloˇti⁄_comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
GUTI_REALLOCATION_COMMAND_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_ïs_mobûe_idítôy
(&
guti_ªÆloˇti⁄_comm™d
->
guti
, 0, 
buf„r


90 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
guti_ªÆloˇti⁄_comm™d
->
¥e£n˚mask
 & 
GUTI_REALLOCATION_COMMAND_TAI_LIST_PRESENT
)

96 =
GUTI_REALLOCATION_COMMAND_TAI_LIST_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_åackög_¨ó_idítôy_li°
(&
guti_ªÆloˇti⁄_comm™d
->
èûi°
,

100 
GUTI_REALLOCATION_COMMAND_TAI_LIST_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

101 
ícoded
)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/emm/msg/GutiReallocationCommand.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EpsMobûeIdítôy.h
"

37 
	~"TøckögAªaIdítôyLi°.h
"

39 #i‚de‡
GUTI_REALLOCATION_COMMAND_H_


40 
	#GUTI_REALLOCATION_COMMAND_H_


	)

43 
	#GUTI_REALLOCATION_COMMAND_MINIMUM_LENGTH
 ( \

44 
EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
 )

	)

47 
	#GUTI_REALLOCATION_COMMAND_MAXIMUM_LENGTH
 ( \

48 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

49 
TRACKING_AREA_IDENTITY_LIST_MAXIMUM_LENGTH
 )

	)

54 
	#GUTI_REALLOCATION_COMMAND_TAI_LIST_PRESENT
 (1<<0)

	)

56 
	eguti_ªÆloˇti⁄_comm™d_õi_èg
 {

57 
	mGUTI_REALLOCATION_COMMAND_TAI_LIST_IEI
 = 0x54,

58 } 
	tguti_ªÆloˇti⁄_comm™d_õi
;

67 
	sguti_ªÆloˇti⁄_comm™d_msg_èg
 {

69 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

70 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

71 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
EpsMobûeIdítôy
 
	mguti
;

74 
uöt32_t
 
	m¥e£n˚mask
;

75 
TøckögAªaIdítôyLi°
 
	mèûi°
;

76 } 
	tguti_ªÆloˇti⁄_comm™d_msg
;

78 
decode_guti_ªÆloˇti⁄_comm™d
(
guti_ªÆloˇti⁄_comm™d_msg
 *
gutúóŒoˇti⁄comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

80 
ícode_guti_ªÆloˇti⁄_comm™d
(
guti_ªÆloˇti⁄_comm™d_msg
 *
gutúóŒoˇti⁄comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/GutiReallocationComplete.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"GutiRóŒoˇti⁄Com∂ëe.h
"

39 
	$decode_guti_ªÆloˇti⁄_com∂ëe
(
guti_ªÆloˇti⁄_com∂ëe_msg
 *
guti_ªÆloˇti⁄_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

43 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
GUTI_REALLOCATION_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

46  
decoded
;

47 
	}
}

49 
	$ícode_guti_ªÆloˇti⁄_com∂ëe
(
guti_ªÆloˇti⁄_com∂ëe_msg
 *
guti_ªÆloˇti⁄_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

51 
ícoded
 = 0;

53 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
GUTI_REALLOCATION_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

55  
ícoded
;

56 
	}
}

	@src/emm/msg/GutiReallocationComplete.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

37 #i‚de‡
GUTI_REALLOCATION_COMPLETE_H_


38 
	#GUTI_REALLOCATION_COMPLETE_H_


	)

41 
	#GUTI_REALLOCATION_COMPLETE_MINIMUM_LENGTH
 (0)

	)

44 
	#GUTI_REALLOCATION_COMPLETE_MAXIMUM_LENGTH
 (0)

	)

53 
	sguti_ªÆloˇti⁄_com∂ëe_msg_èg
 {

55 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

56 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

57 
MesßgeTy≥
 
	mmesßgëy≥
;

58 } 
	tguti_ªÆloˇti⁄_com∂ëe_msg
;

60 
decode_guti_ªÆloˇti⁄_com∂ëe
(
guti_ªÆloˇti⁄_com∂ëe_msg
 *
gutúóŒoˇti⁄com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

62 
ícode_guti_ªÆloˇti⁄_com∂ëe
(
guti_ªÆloˇti⁄_com∂ëe_msg
 *
gutúóŒoˇti⁄com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/IdentityRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"IdítôyReque°.h
"

39 
	$decode_idítôy_ªque°
(
idítôy_ªque°_msg
 *
idítôy_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
IDENTITY_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_idítôy_ty≥_2
(&
idítôy_ªque°
->
idítôyty≥
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52  
decoded
;

53 
	}
}

55 
	$ícode_idítôy_ªque°
(
idítôy_ªque°_msg
 *
idítôy_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

57 
ícoded
 = 0;

60 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
IDENTITY_REQUEST_MINIMUM_LENGTH
, 
Àn
);

62 *(
buf„r
 + 
ícoded
Ë
	`ícode_u8_idítôy_ty≥_2
(&
idítôy_ªque°
->
idítôyty≥
) & 0x0f;

63 
ícoded
++;

64  
ícoded
;

65 
	}
}

	@src/emm/msg/IdentityRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"IdítôyTy≥2.h
"

38 #i‚de‡
IDENTITY_REQUEST_H_


39 
	#IDENTITY_REQUEST_H_


	)

42 
	#IDENTITY_REQUEST_MINIMUM_LENGTH
 ( \

43 
IDENTITY_TYPE_2_MINIMUM_LENGTH
 )

	)

46 
	#IDENTITY_REQUEST_MAXIMUM_LENGTH
 ( \

47 
IDENTITY_TYPE_2_MAXIMUM_LENGTH
 )

	)

57 
	sidítôy_ªque°_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
IdítôyTy≥2
 
	midítôyty≥
;

63 } 
	tidítôy_ªque°_msg
;

65 
decode_idítôy_ªque°
(
idítôy_ªque°_msg
 *
idítôyªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_idítôy_ªque°
(
idítôy_ªque°_msg
 *
idítôyªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/IdentityResponse.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"IdítôyRe•⁄£.h
"

39 
	$decode_idítôy_ª•⁄£
(
idítôy_ª•⁄£_msg
 *
idítôy_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
IDENTITY_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_mobûe_idítôy
(&
idítôy_ª•⁄£
->
mobûeidítôy
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_idítôy_ª•⁄£
(
idítôy_ª•⁄£_msg
 *
idítôy_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
IDENTITY_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_mobûe_idítôy
(&
idítôy_ª•⁄£
->
mobûeidítôy
, 0, 
buf„r
 +

66 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/IdentityResponse.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"MobûeIdítôy.h
"

38 #i‚de‡
IDENTITY_RESPONSE_H_


39 
	#IDENTITY_RESPONSE_H_


	)

42 
	#IDENTITY_RESPONSE_MINIMUM_LENGTH
 ( \

43 
MOBILE_IDENTITY_MINIMUM_LENGTH
 )

	)

46 
	#IDENTITY_RESPONSE_MAXIMUM_LENGTH
 ( \

47 
MOBILE_IDENTITY_MAXIMUM_LENGTH
 )

	)

57 
	sidítôy_ª•⁄£_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
MobûeIdítôy
 
	mmobûeidítôy
;

63 } 
	tidítôy_ª•⁄£_msg
;

65 
decode_idítôy_ª•⁄£
(
idítôy_ª•⁄£_msg
 *
idítôyª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_idítôy_ª•⁄£
(
idítôy_ª•⁄£_msg
 *
idítôyª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/NASSecurityModeCommand.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"NasSecurôyAlg‹ôhms.h
"

37 
	~"NasKeySëIdítifõr.h
"

38 
	~"UeSecurôyC≠abûôy.h
"

39 
	~"ImeisvReque°.h
"

40 
	~"N⁄˚.h
"

42 #i‚de‡
NAS_SECURITY_MODE_COMMAND_H_


43 
	#NAS_SECURITY_MODE_COMMAND_H_


	)

46 
	#SECURITY_MODE_COMMAND_MINIMUM_LENGTH
 ( \

47 
NAS_SECURITY_ALGORITHMS_MINIMUM_LENGTH
 + \

48 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

49 
UE_SECURITY_CAPABILITY_MINIMUM_LENGTH
 )

	)

52 
	#SECURITY_MODE_COMMAND_MAXIMUM_LENGTH
 ( \

53 
NAS_SECURITY_ALGORITHMS_MAXIMUM_LENGTH
 + \

54 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

55 
UE_SECURITY_CAPABILITY_MAXIMUM_LENGTH
 + \

56 
IMEISV_REQUEST_MAXIMUM_LENGTH
 + \

57 
NONCE_MAXIMUM_LENGTH
 + \

58 
NONCE_MAXIMUM_LENGTH
 )

	)

63 
	#SECURITY_MODE_COMMAND_IMEISV_REQUEST_PRESENT
 (1<<0)

	)

64 
	#SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_PRESENT
 (1<<1)

	)

65 
	#SECURITY_MODE_COMMAND_NONCEMME_PRESENT
 (1<<2)

	)

67 
	e£curôy_mode_comm™d_õi_èg
 {

68 
	mSECURITY_MODE_COMMAND_IMEISV_REQUEST_IEI
 = 0xC0,

69 
	mSECURITY_MODE_COMMAND_REPLAYED_NONCEUE_IEI
 = 0x55,

70 
	mSECURITY_MODE_COMMAND_NONCEMME_IEI
 = 0x56,

71 } 
	t£curôy_mode_comm™d_õi
;

80 
	s£curôy_mode_comm™d_msg_èg
 {

82 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

83 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

84 
MesßgeTy≥
 
	mmesßgëy≥
;

85 
NasSecurôyAlg‹ôhms
 
	m£À˘ed«s£curôyÆg‹ôhms
;

86 
NasKeySëIdítifõr
 
	m«skey£tidítifõr
;

87 
UeSecurôyC≠abûôy
 
	mª∂ayedue£curôyˇ∑bûôõs
;

89 
uöt32_t
 
	m¥e£n˚mask
;

90 
ImeisvReque°
 
	mimeisvªque°
;

91 
N⁄˚
 
	mª∂ayedn⁄˚ue
;

92 
N⁄˚
 
	mn⁄˚mme
;

93 } 
	t£curôy_mode_comm™d_msg
;

95 
decode_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
£curôymodecomm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

97 
ícode_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
£curôymodecomm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/NASSecurityModeComplete.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"MobûeIdítôy.h
"

38 #i‚de‡
SECURITY_MODE_COMPLETE_H_


39 
	#SECURITY_MODE_COMPLETE_H_


	)

42 
	#SECURITY_MODE_COMPLETE_MINIMUM_LENGTH
 (0)

	)

45 
	#SECURITY_MODE_COMPLETE_MAXIMUM_LENGTH
 ( \

46 
MOBILE_IDENTITY_MAXIMUM_LENGTH
 )

	)

51 
	#SECURITY_MODE_COMPLETE_IMEISV_PRESENT
 (1<<0)

	)

53 
	e£curôy_mode_com∂ëe_õi_èg
 {

54 
	mSECURITY_MODE_COMPLETE_IMEISV_IEI
 = 0x23,

55 } 
	t£curôy_mode_com∂ëe_õi
;

64 
	s£curôy_mode_com∂ëe_msg_èg
 {

66 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

67 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

68 
MesßgeTy≥
 
	mmesßgëy≥
;

70 
uöt32_t
 
	m¥e£n˚mask
;

71 
MobûeIdítôy
 
	mimeisv
;

72 } 
	t£curôy_mode_com∂ëe_msg
;

74 
decode_£curôy_mode_com∂ëe
(
£curôy_mode_com∂ëe_msg
 *
£curôymodecom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

76 
ícode_£curôy_mode_com∂ëe
(
£curôy_mode_com∂ëe_msg
 *
£curôymodecom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/SecurityModeCommand.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"NASSecurôyModeComm™d.h
"

39 
	$decode_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
£curôy_mode_comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SECURITY_MODE_COMMAND_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_«s_£curôy_Æg‹ôhms
(&
£curôy_mode_comm™d
->
£À˘ed«s£curôyÆg‹ôhms
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
£curôy_mode_comm™d
->
«skey£tidítifõr
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

54  
decoded_ªsu…
;

56 
decoded
++;

57 i‡((
decoded_ªsu…
 = 
	`decode_ue_£curôy_ˇ∑bûôy
(&
£curôy_mode_comm™d
->
ª∂ayedue£curôyˇ∑bûôõs
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

58  
decoded_ªsu…
;

60 
decoded
 +
decoded_ªsu…
;

63 
Àn
 - 
decoded
 > 0)

65 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

67 i‡(
õiDecoded
 >= 0x80)

68 
õiDecoded
 = ieiDecoded & 0xf0;

69 
õiDecoded
)

71 
SECURITY_MODE_COMMAND_IMEISV_REQUEST_IEI
:

72 i‡((
decoded_ªsu…
 =

73 
	`decode_imeisv_ªque°
(&
£curôy_mode_comm™d
->
imeisvªque°
,

74 
SECURITY_MODE_COMMAND_IMEISV_REQUEST_IEI
, 
buf„r
 + 
decoded
,

75 
Àn
 - 
decoded
)) <= 0)

76  
decoded_ªsu…
;

77 
decoded
 +
decoded_ªsu…
;

79 
£curôy_mode_comm™d
->
¥e£n˚mask
 |
SECURITY_MODE_COMMAND_IMEISV_REQUEST_PRESENT
;

81 
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_IEI
:

82 i‡((
decoded_ªsu…
 =

83 
	`decode_n⁄˚
(&
£curôy_mode_comm™d
->
ª∂ayedn⁄˚ue
,

84 
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_IEI
, 
buf„r
 +

85 
decoded
, 
Àn
 - decoded)) <= 0)

86  
decoded_ªsu…
;

87 
decoded
 +
decoded_ªsu…
;

89 
£curôy_mode_comm™d
->
¥e£n˚mask
 |
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_PRESENT
;

91 
SECURITY_MODE_COMMAND_NONCEMME_IEI
:

92 i‡((
decoded_ªsu…
 =

93 
	`decode_n⁄˚
(&
£curôy_mode_comm™d
->
n⁄˚mme
,

94 
SECURITY_MODE_COMMAND_NONCEMME_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

95 
decoded
)) <= 0)

96  
decoded_ªsu…
;

97 
decoded
 +
decoded_ªsu…
;

99 
£curôy_mode_comm™d
->
¥e£n˚mask
 |
SECURITY_MODE_COMMAND_NONCEMME_PRESENT
;

102 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

103  
TLV_DECODE_UNEXPECTED_IEI
;

106  
decoded
;

107 
	}
}

109 
	$ícode_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
£curôy_mode_comm™d
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

111 
ícoded
 = 0;

112 
ícode_ªsu…
 = 0;

115 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SECURITY_MODE_COMMAND_MINIMUM_LENGTH
, 
Àn
);

117 i‡((
ícode_ªsu…
 =

118 
	`ícode_«s_£curôy_Æg‹ôhms
(&
£curôy_mode_comm™d
->
£À˘ed«s£curôyÆg‹ôhms
,

119 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

120  
ícode_ªsu…
;

122 
ícoded
 +
ícode_ªsu…
;

124 *(
buf„r
 + 
ícoded
Ë(
	`ícode_u8_«s_key_£t_idítifõr
(&
£curôy_mode_comm™d
->
«skey£tidítifõr
) & 0x0f);

125 
ícoded
++;

126 i‡((
ícode_ªsu…
 =

127 
	`ícode_ue_£curôy_ˇ∑bûôy
(&
£curôy_mode_comm™d
->
ª∂ayedue£curôyˇ∑bûôõs
,

128 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

129  
ícode_ªsu…
;

131 
ícoded
 +
ícode_ªsu…
;

133 i‡((
£curôy_mode_comm™d
->
¥e£n˚mask
 & 
SECURITY_MODE_COMMAND_IMEISV_REQUEST_PRESENT
)

134 =
SECURITY_MODE_COMMAND_IMEISV_REQUEST_PRESENT
)

136 i‡((
ícode_ªsu…
 =

137 
	`ícode_imeisv_ªque°
(&
£curôy_mode_comm™d
->
imeisvªque°
,

138 
SECURITY_MODE_COMMAND_IMEISV_REQUEST_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

139 
ícoded
)) < 0)

141  
ícode_ªsu…
;

143 
ícoded
 +
ícode_ªsu…
;

146 i‡((
£curôy_mode_comm™d
->
¥e£n˚mask
 & 
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_PRESENT
)

147 =
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_PRESENT
)

149 i‡((
ícode_ªsu…
 =

150 
	`ícode_n⁄˚
(&
£curôy_mode_comm™d
->
ª∂ayedn⁄˚ue
,

151 
SECURITY_MODE_COMMAND_REPLAYED_NONCEUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn


152 - 
ícoded
)) < 0)

154  
ícode_ªsu…
;

156 
ícoded
 +
ícode_ªsu…
;

159 i‡((
£curôy_mode_comm™d
->
¥e£n˚mask
 & 
SECURITY_MODE_COMMAND_NONCEMME_PRESENT
)

160 =
SECURITY_MODE_COMMAND_NONCEMME_PRESENT
)

162 i‡((
ícode_ªsu…
 = 
	`ícode_n⁄˚
(&
£curôy_mode_comm™d
->
n⁄˚mme
,

163 
SECURITY_MODE_COMMAND_NONCEMME_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

164 
ícoded
)) < 0)

166  
ícode_ªsu…
;

168 
ícoded
 +
ícode_ªsu…
;

171  
ícoded
;

172 
	}
}

	@src/emm/msg/SecurityModeComplete.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"NASSecurôyModeCom∂ëe.h
"

39 
	$decode_£curôy_mode_com∂ëe
(
£curôy_mode_com∂ëe_msg
 *
£curôy_mode_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SECURITY_MODE_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
SECURITY_MODE_COMPLETE_IMEISV_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_mobûe_idítôy
(&
£curôy_mode_com∂ëe
->
imeisv
,

60 
SECURITY_MODE_COMPLETE_IMEISV_IEI
, 
buf„r
 + 
decoded
, 
Àn
 -

61 
decoded
)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
£curôy_mode_com∂ëe
->
¥e£n˚mask
 |
SECURITY_MODE_COMPLETE_IMEISV_PRESENT
;

68 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

69  
TLV_DECODE_UNEXPECTED_IEI
;

72  
decoded
;

73 
	}
}

75 
	$ícode_£curôy_mode_com∂ëe
(
£curôy_mode_com∂ëe_msg
 *
£curôy_mode_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

77 
ícoded
 = 0;

78 
ícode_ªsu…
 = 0;

81 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SECURITY_MODE_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

83 i‡((
£curôy_mode_com∂ëe
->
¥e£n˚mask
 & 
SECURITY_MODE_COMPLETE_IMEISV_PRESENT
)

84 =
SECURITY_MODE_COMPLETE_IMEISV_PRESENT
)

86 i‡((
ícode_ªsu…
 =

87 
	`ícode_mobûe_idítôy
(&
£curôy_mode_com∂ëe
->
imeisv
,

88 
SECURITY_MODE_COMPLETE_IMEISV_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

89 
ícoded
)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

96  
ícoded
;

97 
	}
}

	@src/emm/msg/SecurityModeReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"SecurôyModeReje˘.h
"

39 
	$decode_£curôy_mode_ªje˘
(
£curôy_mode_ªje˘_msg
 *
£curôy_mode_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SECURITY_MODE_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
£curôy_mode_ªje˘
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_£curôy_mode_ªje˘
(
£curôy_mode_ªje˘_msg
 *
£curôy_mode_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SECURITY_MODE_REJECT_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
£curôy_mode_ªje˘
->
emmˇu£
, 0,

65 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

66  
ícode_ªsu…
;

68 
ícoded
 +
ícode_ªsu…
;

70  
ícoded
;

71 
	}
}

	@src/emm/msg/SecurityModeReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

38 #i‚de‡
SECURITY_MODE_REJECT_H_


39 
	#SECURITY_MODE_REJECT_H_


	)

42 
	#SECURITY_MODE_REJECT_MINIMUM_LENGTH
 ( \

43 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

46 
	#SECURITY_MODE_REJECT_MAXIMUM_LENGTH
 ( \

47 
EMM_CAUSE_MAXIMUM_LENGTH
 )

	)

57 
	s£curôy_mode_ªje˘_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
EmmCau£
 
	memmˇu£
;

63 } 
	t£curôy_mode_ªje˘_msg
;

65 
decode_£curôy_mode_ªje˘
(
£curôy_mode_ªje˘_msg
 *
£curôymodîeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_£curôy_mode_ªje˘
(
£curôy_mode_ªje˘_msg
 *
£curôymodîeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/ServiceReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Sîvi˚Reje˘.h
"

39 
	$decode_£rvi˚_ªje˘
(
£rvi˚_ªje˘_msg
 *
£rvi˚_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SERVICE_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
£rvi˚_ªje˘
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_£rvi˚_ªje˘
(
£rvi˚_ªje˘_msg
 *
£rvi˚_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SERVICE_REJECT_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 = 
	`ícode_emm_ˇu£
(&
£rvi˚_ªje˘
->
emmˇu£
, 0, 
buf„r
 +

65 
ícoded
, 
Àn
 -Éncoded)) < 0)

66  
ícode_ªsu…
;

68 
ícoded
 +
ícode_ªsu…
;

70 i‡((
ícode_ªsu…
 = 
	`ícode_g¥s_timî
(&
£rvi˚_ªje˘
->
t3442vÆue
, 0,

71 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

72  
ícode_ªsu…
;

74 
ícoded
 +
ícode_ªsu…
;

76  
ícoded
;

77 
	}
}

	@src/emm/msg/ServiceReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

37 
	~"G¥sTimî.h
"

39 #i‚de‡
SERVICE_REJECT_H_


40 
	#SERVICE_REJECT_H_


	)

43 
	#SERVICE_REJECT_MINIMUM_LENGTH
 ( \

44 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

47 
	#SERVICE_REJECT_MAXIMUM_LENGTH
 ( \

48 
EMM_CAUSE_MAXIMUM_LENGTH
 + \

49 
GPRS_TIMER_MAXIMUM_LENGTH
 )

	)

59 
	s£rvi˚_ªje˘_msg_èg
 {

61 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

62 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

63 
MesßgeTy≥
 
	mmesßgëy≥
;

64 
EmmCau£
 
	memmˇu£
;

66 
uöt32_t
 
	m¥e£n˚mask
;

67 
G¥sTimî
 
	mt3442vÆue
;

68 } 
	t£rvi˚_ªje˘_msg
;

70 
decode_£rvi˚_ªje˘
(
£rvi˚_ªje˘_msg
 *
£rvi˚ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

72 
ícode_£rvi˚_ªje˘
(
£rvi˚_ªje˘_msg
 *
£rvi˚ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/ServiceRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Sîvi˚Reque°.h
"

39 
	$decode_£rvi˚_ªque°
(
£rvi˚_ªque°_msg
 *
£rvi˚_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

44 
LOG_FUNC_IN
;

46 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SERVICE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

49 i‡((
decoded_ªsu…
 = 
	`decode_ksi_™d_£quí˚_numbî
(&
£rvi˚_ªque°
->
ksünd£quí˚numbî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

50 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

52 
decoded
 +
decoded_ªsu…
;

54 i‡((
decoded_ªsu…
 = 
	`decode_sh‹t_mac
(&
£rvi˚_ªque°
->
mesßgóuthítiˇti⁄code
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

55 
	`LOG_FUNC_RETURN
(
decoded_ªsu…
);

57 
decoded
 +
decoded_ªsu…
;

59 
	`LOG_FUNC_RETURN
(
decoded
);

60 
	}
}

62 
	$ícode_£rvi˚_ªque°
(
£rvi˚_ªque°_msg
 *
£rvi˚_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

64 
ícoded
 = 0;

65 
ícode_ªsu…
 = 0;

67 
LOG_FUNC_IN
;

69 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SERVICE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

71 i‡((
ícode_ªsu…
 =

72 
	`ícode_ksi_™d_£quí˚_numbî
(&
£rvi˚_ªque°
->
ksünd£quí˚numbî
,

73 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

74 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

76 
ícoded
 +
ícode_ªsu…
;

78 i‡((
ícode_ªsu…
 =

79 
	`ícode_sh‹t_mac
(&
£rvi˚_ªque°
->
mesßgóuthítiˇti⁄code
, 0,

80 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

81 
	`LOG_FUNC_RETURN
(
ícode_ªsu…
);

83 
ícoded
 +
ícode_ªsu…
;

85 
	`LOG_FUNC_RETURN
(
ícoded
);

86 
	}
}

	@src/emm/msg/ServiceRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"KsiAndSequí˚Numbî.h
"

36 
	~"Sh‹tMac.h
"

38 #i‚de‡
SERVICE_REQUEST_H_


39 
	#SERVICE_REQUEST_H_


	)

42 
	#SERVICE_REQUEST_MINIMUM_LENGTH
 ( \

43 
KSI_AND_SEQUENCE_NUMBER_MINIMUM_LENGTH
 + \

44 
SHORT_MAC_MINIMUM_LENGTH
 )

	)

47 
	#SERVICE_REQUEST_MAXIMUM_LENGTH
 ( \

48 
KSI_AND_SEQUENCE_NUMBER_MAXIMUM_LENGTH
 + \

49 
SHORT_MAC_MAXIMUM_LENGTH
 )

	)

59 
	s£rvi˚_ªque°_msg_èg
 {

61 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

62 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

63 
KsiAndSequí˚Numbî
 
	mksünd£quí˚numbî
;

64 
Sh‹tMac
 
	mmesßgóuthítiˇti⁄code
;

65 } 
	t£rvi˚_ªque°_msg
;

67 
decode_£rvi˚_ªque°
(
£rvi˚_ªque°_msg
 *
£rvi˚ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

69 
ícode_£rvi˚_ªque°
(
£rvi˚_ªque°_msg
 *
£rvi˚ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/TrackingAreaUpdateAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"TøckögAªaUpd©eAc˚±.h
"

39 
	$decode_åackög_¨ó_upd©e_ac˚±
(
åackög_¨ó_upd©e_ac˚±_msg
 *
åackög_¨ó_upd©e_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
TRACKING_AREA_UPDATE_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_ïs_upd©e_ªsu…
(&
åackög_¨ó_upd©e_ac˚±
->
ïsupd©îesu…
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

53 
Àn
 - 
decoded
 > 0)

55 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

57 i‡(
õiDecoded
 >= 0x80)

58 
õiDecoded
 = ieiDecoded & 0xf0;

59 
õiDecoded
)

61 
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_IEI
:

62 i‡((
decoded_ªsu…
 =

63 
	`decode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3412vÆue
,

64 
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_IEI
, 
buf„r
 +

65 
decoded
, 
Àn
 - decoded)) <= 0)

66  
decoded_ªsu…
;

67 
decoded
 +
decoded_ªsu…
;

69 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_PRESENT
;

71 
TRACKING_AREA_UPDATE_ACCEPT_GUTI_IEI
:

72 i‡((
decoded_ªsu…
 =

73 
	`decode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ac˚±
->
guti
,

74 
TRACKING_AREA_UPDATE_ACCEPT_GUTI_IEI
, 
buf„r
 + 
decoded
, 
Àn


75 - 
decoded
)) <= 0)

76  
decoded_ªsu…
;

77 
decoded
 +
decoded_ªsu…
;

79 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_GUTI_PRESENT
;

81 
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_IEI
:

82 i‡((
decoded_ªsu…
 =

83 
	`decode_åackög_¨ó_idítôy_li°
(&
åackög_¨ó_upd©e_ac˚±
->
èûi°
,

84 
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_IEI
, 
buf„r
 + 
decoded
,

85 
Àn
 - 
decoded
)) <= 0)

86  
decoded_ªsu…
;

87 
decoded
 +
decoded_ªsu…
;

89 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_PRESENT
;

91 
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_IEI
:

92 i‡((
decoded_ªsu…
 =

93 
	`decode_ïs_bóªr_c⁄ãxt_°©us
(&
åackög_¨ó_upd©e_ac˚±
->
ïsbóªrc⁄ãxt°©us
,

94 
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_IEI
,

95 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

96  
decoded_ªsu…
;

97 
decoded
 +
decoded_ªsu…
;

99 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_PRESENT
;

101 
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
:

102 i‡((
decoded_ªsu…
 =

103 
	`decode_loˇti⁄_¨ó_idítifiˇti⁄
(&
åackög_¨ó_upd©e_ac˚±
->
loˇti⁄¨óidítifiˇti⁄
,

104 
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
,

105 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

106  
decoded_ªsu…
;

107 
decoded
 +
decoded_ªsu…
;

109 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
;

111 
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_IEI
:

112 i‡((
decoded_ªsu…
 =

113 
	`decode_mobûe_idítôy
(&
åackög_¨ó_upd©e_ac˚±
->
msidítôy
,

114 
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_IEI
, 
buf„r
 +

115 
decoded
, 
Àn
 - decoded)) <= 0)

116  
decoded_ªsu…
;

117 
decoded
 +
decoded_ªsu…
;

119 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_PRESENT
;

121 
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_IEI
:

122 i‡((
decoded_ªsu…
 =

123 
	`decode_emm_ˇu£
(&
åackög_¨ó_upd©e_ac˚±
->
emmˇu£
,

124 
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_IEI
, 
buf„r
 +

125 
decoded
, 
Àn
 - decoded)) <= 0)

126  
decoded_ªsu…
;

127 
decoded
 +
decoded_ªsu…
;

129 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_PRESENT
;

131 
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_IEI
:

132 i‡((
decoded_ªsu…
 =

133 
	`decode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3402vÆue
,

134 
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_IEI
, 
buf„r
 +

135 
decoded
, 
Àn
 - decoded)) <= 0)

136  
decoded_ªsu…
;

137 
decoded
 +
decoded_ªsu…
;

139 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_PRESENT
;

141 
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_IEI
:

142 i‡((
decoded_ªsu…
 =

143 
	`decode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3423vÆue
,

144 
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_IEI
, 
buf„r
 +

145 
decoded
, 
Àn
 - decoded)) <= 0)

146  
decoded_ªsu…
;

147 
decoded
 +
decoded_ªsu…
;

149 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_PRESENT
;

151 
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_IEI
:

152 i‡((
decoded_ªsu…
 =

153 
	`decode_∂mn_li°
(&
åackög_¨ó_upd©e_ac˚±
->
equivÆíçlmns
,

154 
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_IEI
, 
buf„r
 +

155 
decoded
, 
Àn
 - decoded)) <= 0)

156  
decoded_ªsu…
;

157 
decoded
 +
decoded_ªsu…
;

159 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_PRESENT
;

161 
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
:

162 i‡((
decoded_ªsu…
 =

163 
	`decode_emîgícy_numbî_li°
(&
åackög_¨ó_upd©e_ac˚±
->
emîgícynumbîli°
,

164 
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
,

165 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

166  
decoded_ªsu…
;

167 
decoded
 +
decoded_ªsu…
;

169 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
;

171 
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
:

172 i‡((
decoded_ªsu…
 =

173 
	`decode_ïs_√tw‹k_„©uª_suµ‹t
(&
åackög_¨ó_upd©e_ac˚±
->
ï¢ëw‹k„©uªsuµ‹t
,

174 
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
,

175 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

176  
decoded_ªsu…
;

177 
decoded
 +
decoded_ªsu…
;

179 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
;

181 
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
:

182 i‡((
decoded_ªsu…
 =

183 
	`decode_addôi⁄Æ_upd©e_ªsu…
(&
åackög_¨ó_upd©e_ac˚±
->
addôi⁄Æupd©îesu…
,

184 
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
,

185 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

186  
decoded_ªsu…
;

187 
decoded
 +
decoded_ªsu…
;

189 
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
;

192 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

193  
TLV_DECODE_UNEXPECTED_IEI
;

196  
decoded
;

197 
	}
}

199 
	$ícode_åackög_¨ó_upd©e_ac˚±
(
åackög_¨ó_upd©e_ac˚±_msg
 *
åackög_¨ó_upd©e_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

201 
ícoded
 = 0;

202 
ícode_ªsu…
 = 0;

205 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_UPDATE_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

207 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_ïs_upd©e_ªsu…
(&
åackög_¨ó_upd©e_ac˚±
->
ïsupd©îesu…
) & 0x0f) << 4) | 0x00;

208 
ícoded
++;

209 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_PRESENT
)

210 =
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_PRESENT
)

212 i‡((
ícode_ªsu…
 =

213 
	`ícode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3412vÆue
,

214 
TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn


215 - 
ícoded
)) < 0)

217  
ícode_ªsu…
;

219 
ícoded
 +
ícode_ªsu…
;

222 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_GUTI_PRESENT
)

223 =
TRACKING_AREA_UPDATE_ACCEPT_GUTI_PRESENT
)

225 i‡((
ícode_ªsu…
 =

226 
	`ícode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ac˚±
->
guti
,

227 
TRACKING_AREA_UPDATE_ACCEPT_GUTI_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

228 
ícoded
)) < 0)

230  
ícode_ªsu…
;

232 
ícoded
 +
ícode_ªsu…
;

235 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_PRESENT
)

236 =
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_PRESENT
)

238 i‡((
ícode_ªsu…
 =

239 
	`ícode_åackög_¨ó_idítôy_li°
(&
åackög_¨ó_upd©e_ac˚±
->
èûi°
,

240 
TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

241 
ícoded
)) < 0)

243  
ícode_ªsu…
;

245 
ícoded
 +
ícode_ªsu…
;

248 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_PRESENT
)

249 =
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_PRESENT
)

251 i‡((
ícode_ªsu…
 =

252 
	`ícode_ïs_bóªr_c⁄ãxt_°©us
(&
åackög_¨ó_upd©e_ac˚±
->
ïsbóªrc⁄ãxt°©us
,

253 
TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_IEI
, 
buf„r


254 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

256  
ícode_ªsu…
;

258 
ícoded
 +
ícode_ªsu…
;

261 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
)

262 =
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
)

264 i‡((
ícode_ªsu…
 =

265 
	`ícode_loˇti⁄_¨ó_idítifiˇti⁄
(&
åackög_¨ó_upd©e_ac˚±
->
loˇti⁄¨óidítifiˇti⁄
,

266 
TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
,

267 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

269  
ícode_ªsu…
;

271 
ícoded
 +
ícode_ªsu…
;

274 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_PRESENT
)

275 =
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_PRESENT
)

277 i‡((
ícode_ªsu…
 =

278 
	`ícode_mobûe_idítôy
(&
åackög_¨ó_upd©e_ac˚±
->
msidítôy
,

279 
TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_IEI
, 
buf„r
 + 
ícoded
, 
Àn


280 - 
ícoded
)) < 0)

282  
ícode_ªsu…
;

284 
ícoded
 +
ícode_ªsu…
;

287 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_PRESENT
)

288 =
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_PRESENT
)

290 i‡((
ícode_ªsu…
 =

291 
	`ícode_emm_ˇu£
(&
åackög_¨ó_upd©e_ac˚±
->
emmˇu£
,

292 
TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

293 
ícoded
)) < 0)

295  
ícode_ªsu…
;

297 
ícoded
 +
ícode_ªsu…
;

300 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_PRESENT
)

301 =
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_PRESENT
)

303 i‡((
ícode_ªsu…
 =

304 
	`ícode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3402vÆue
,

305 
TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn


306 - 
ícoded
)) < 0)

308  
ícode_ªsu…
;

310 
ícoded
 +
ícode_ªsu…
;

313 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_PRESENT
)

314 =
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_PRESENT
)

316 i‡((
ícode_ªsu…
 =

317 
	`ícode_g¥s_timî
(&
åackög_¨ó_upd©e_ac˚±
->
t3423vÆue
,

318 
TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn


319 - 
ícoded
)) < 0)

321  
ícode_ªsu…
;

323 
ícoded
 +
ícode_ªsu…
;

326 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_PRESENT
)

327 =
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_PRESENT
)

329 i‡((
ícode_ªsu…
 =

330 
	`ícode_∂mn_li°
(&
åackög_¨ó_upd©e_ac˚±
->
equivÆíçlmns
,

331 
TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_IEI
, 
buf„r
 +

332 
ícoded
, 
Àn
 -Éncoded)) < 0)

334  
ícode_ªsu…
;

336 
ícoded
 +
ícode_ªsu…
;

339 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
)

340 =
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
)

342 i‡((
ícode_ªsu…
 =

343 
	`ícode_emîgícy_numbî_li°
(&
åackög_¨ó_upd©e_ac˚±
->
emîgícynumbîli°
,

344 
TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
, 
buf„r
 +

345 
ícoded
, 
Àn
 -Éncoded)) < 0)

347  
ícode_ªsu…
;

349 
ícoded
 +
ícode_ªsu…
;

352 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
)

353 =
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
)

355 i‡((
ícode_ªsu…
 =

356 
	`ícode_ïs_√tw‹k_„©uª_suµ‹t
(&
åackög_¨ó_upd©e_ac˚±
->
ï¢ëw‹k„©uªsuµ‹t
,

357 
TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
,

358 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

360  
ícode_ªsu…
;

362 
ícoded
 +
ícode_ªsu…
;

365 i‡((
åackög_¨ó_upd©e_ac˚±
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
)

366 =
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
)

368 i‡((
ícode_ªsu…
 =

369 
	`ícode_addôi⁄Æ_upd©e_ªsu…
(&
åackög_¨ó_upd©e_ac˚±
->
addôi⁄Æupd©îesu…
,

370 
TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
, 
buf„r
 +

371 
ícoded
, 
Àn
 -Éncoded)) < 0)

373  
ícode_ªsu…
;

375 
ícoded
 +
ícode_ªsu…
;

378  
ícoded
;

379 
	}
}

	@src/emm/msg/TrackingAreaUpdateAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EpsUpd©eResu….h
"

37 
	~"G¥sTimî.h
"

38 
	~"EpsMobûeIdítôy.h
"

39 
	~"TøckögAªaIdítôyLi°.h
"

40 
	~"EpsBóªrC⁄ãxtSètus.h
"

41 
	~"Loˇti⁄AªaIdítifiˇti⁄.h
"

42 
	~"MobûeIdítôy.h
"

43 
	~"EmmCau£.h
"

44 
	~"PlmnLi°.h
"

45 
	~"EmîgícyNumbîLi°.h
"

46 
	~"EpsNëw‹kFótuªSuµ‹t.h
"

47 
	~"Addôi⁄ÆUpd©eResu….h
"

49 #i‚de‡
TRACKING_AREA_UPDATE_ACCEPT_H_


50 
	#TRACKING_AREA_UPDATE_ACCEPT_H_


	)

53 
	#TRACKING_AREA_UPDATE_ACCEPT_MINIMUM_LENGTH
 ( \

54 
EPS_UPDATE_RESULT_MINIMUM_LENGTH
 )

	)

57 
	#TRACKING_AREA_UPDATE_ACCEPT_MAXIMUM_LENGTH
 ( \

58 
EPS_UPDATE_RESULT_MAXIMUM_LENGTH
 + \

59 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

60 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

61 
TRACKING_AREA_IDENTITY_LIST_MAXIMUM_LENGTH
 + \

62 
EPS_BEARER_CONTEXT_STATUS_MAXIMUM_LENGTH
 + \

63 
LOCATION_AREA_IDENTIFICATION_MAXIMUM_LENGTH
 + \

64 
MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

65 
EMM_CAUSE_MAXIMUM_LENGTH
 + \

66 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

67 
GPRS_TIMER_MAXIMUM_LENGTH
 + \

68 
PLMN_LIST_MAXIMUM_LENGTH
 + \

69 
EMERGENCY_NUMBER_LIST_MAXIMUM_LENGTH
 + \

70 
EPS_NETWORK_FEATURE_SUPPORT_MAXIMUM_LENGTH
 + \

71 
ADDITIONAL_UPDATE_RESULT_MAXIMUM_LENGTH
 )

	)

76 
	#TRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_PRESENT
 (1<<0)

	)

77 
	#TRACKING_AREA_UPDATE_ACCEPT_GUTI_PRESENT
 (1<<1)

	)

78 
	#TRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_PRESENT
 (1<<2)

	)

79 
	#TRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_PRESENT
 (1<<3)

	)

80 
	#TRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_PRESENT
 (1<<4)

	)

81 
	#TRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_PRESENT
 (1<<5)

	)

82 
	#TRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_PRESENT
 (1<<6)

	)

83 
	#TRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_PRESENT
 (1<<7)

	)

84 
	#TRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_PRESENT
 (1<<8)

	)

85 
	#TRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_PRESENT
 (1<<9)

	)

86 
	#TRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_PRESENT
 (1<<10)

	)

87 
	#TRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_PRESENT
 (1<<11)

	)

88 
	#TRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_PRESENT
 (1<<12)

	)

90 
	eåackög_¨ó_upd©e_ac˚±_õi_èg
 {

91 
	mTRACKING_AREA_UPDATE_ACCEPT_T3412_VALUE_IEI
 = 0x5A,

92 
	mTRACKING_AREA_UPDATE_ACCEPT_GUTI_IEI
 = 0x50,

93 
	mTRACKING_AREA_UPDATE_ACCEPT_TAI_LIST_IEI
 = 0x54,

94 
	mTRACKING_AREA_UPDATE_ACCEPT_EPS_BEARER_CONTEXT_STATUS_IEI
 = 0x57,

95 
	mTRACKING_AREA_UPDATE_ACCEPT_LOCATION_AREA_IDENTIFICATION_IEI
 = 0x13,

96 
	mTRACKING_AREA_UPDATE_ACCEPT_MS_IDENTITY_IEI
 = 0x23,

97 
	mTRACKING_AREA_UPDATE_ACCEPT_EMM_CAUSE_IEI
 = 0x53,

98 
	mTRACKING_AREA_UPDATE_ACCEPT_T3402_VALUE_IEI
 = 0x17,

99 
	mTRACKING_AREA_UPDATE_ACCEPT_T3423_VALUE_IEI
 = 0x59,

100 
	mTRACKING_AREA_UPDATE_ACCEPT_EQUIVALENT_PLMNS_IEI
 = 0x4A,

101 
	mTRACKING_AREA_UPDATE_ACCEPT_EMERGENCY_NUMBER_LIST_IEI
 = 0x34,

102 
	mTRACKING_AREA_UPDATE_ACCEPT_EPS_NETWORK_FEATURE_SUPPORT_IEI
 = 0x64,

103 
	mTRACKING_AREA_UPDATE_ACCEPT_ADDITIONAL_UPDATE_RESULT_IEI
 = 0xF0,

104 } 
	tåackög_¨ó_upd©e_ac˚±_õi
;

113 
	såackög_¨ó_upd©e_ac˚±_msg_èg
 {

115 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

116 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

117 
MesßgeTy≥
 
	mmesßgëy≥
;

118 
EpsUpd©eResu…
 
	mïsupd©îesu…
;

120 
uöt32_t
 
	m¥e£n˚mask
;

121 
G¥sTimî
 
	mt3412vÆue
;

122 
EpsMobûeIdítôy
 
	mguti
;

123 
TøckögAªaIdítôyLi°
 
	mèûi°
;

124 
EpsBóªrC⁄ãxtSètus
 
	mïsbóªrc⁄ãxt°©us
;

125 
Loˇti⁄AªaIdítifiˇti⁄
 
	mloˇti⁄¨óidítifiˇti⁄
;

126 
MobûeIdítôy
 
	mmsidítôy
;

127 
EmmCau£
 
	memmˇu£
;

128 
G¥sTimî
 
	mt3402vÆue
;

129 
G¥sTimî
 
	mt3423vÆue
;

130 
PlmnLi°
 
	mequivÆíçlmns
;

131 
EmîgícyNumbîLi°
 
	memîgícynumbîli°
;

132 
EpsNëw‹kFótuªSuµ‹t
 
	mï¢ëw‹k„©uªsuµ‹t
;

133 
Addôi⁄ÆUpd©eResu…
 
	maddôi⁄Æupd©îesu…
;

134 } 
	tåackög_¨ó_upd©e_ac˚±_msg
;

136 
decode_åackög_¨ó_upd©e_ac˚±
(
åackög_¨ó_upd©e_ac˚±_msg
 *
åackög¨óupd©óc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

138 
ícode_åackög_¨ó_upd©e_ac˚±
(
åackög_¨ó_upd©e_ac˚±_msg
 *
åackög¨óupd©óc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/TrackingAreaUpdateComplete.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"TøckögAªaUpd©eCom∂ëe.h
"

39 
	$decode_åackög_¨ó_upd©e_com∂ëe
(
åackög_¨ó_upd©e_com∂ëe_msg
 *
åackög_¨ó_upd©e_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

43 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
TRACKING_AREA_UPDATE_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

46  
decoded
;

47 
	}
}

49 
	$ícode_åackög_¨ó_upd©e_com∂ëe
(
åackög_¨ó_upd©e_com∂ëe_msg
 *
åackög_¨ó_upd©e_com∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

51 
ícoded
 = 0;

53 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_UPDATE_COMPLETE_MINIMUM_LENGTH
, 
Àn
);

55  
ícoded
;

56 
	}
}

	@src/emm/msg/TrackingAreaUpdateComplete.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

37 #i‚de‡
TRACKING_AREA_UPDATE_COMPLETE_H_


38 
	#TRACKING_AREA_UPDATE_COMPLETE_H_


	)

41 
	#TRACKING_AREA_UPDATE_COMPLETE_MINIMUM_LENGTH
 (0)

	)

44 
	#TRACKING_AREA_UPDATE_COMPLETE_MAXIMUM_LENGTH
 (0)

	)

53 
	såackög_¨ó_upd©e_com∂ëe_msg_èg
 {

55 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

56 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

57 
MesßgeTy≥
 
	mmesßgëy≥
;

58 } 
	tåackög_¨ó_upd©e_com∂ëe_msg
;

60 
decode_åackög_¨ó_upd©e_com∂ëe
(
åackög_¨ó_upd©e_com∂ëe_msg
 *
åackög¨óupd©ecom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

62 
ícode_åackög_¨ó_upd©e_com∂ëe
(
åackög_¨ó_upd©e_com∂ëe_msg
 *
åackög¨óupd©ecom∂ëe
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/TrackingAreaUpdateReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"TøckögAªaUpd©eReje˘.h
"

39 
	$decode_åackög_¨ó_upd©e_ªje˘
(
åackög_¨ó_upd©e_ªje˘_msg
 *
åackög_¨ó_upd©e_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
TRACKING_AREA_UPDATE_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_emm_ˇu£
(&
åackög_¨ó_upd©e_ªje˘
->
emmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_åackög_¨ó_upd©e_ªje˘
(
åackög_¨ó_upd©e_ªje˘_msg
 *
åackög_¨ó_upd©e_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_UPDATE_REJECT_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_emm_ˇu£
(&
åackög_¨ó_upd©e_ªje˘
->
emmˇu£
, 0, 
buf„r
 +

66 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/TrackingAreaUpdateReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EmmCau£.h
"

38 #i‚de‡
TRACKING_AREA_UPDATE_REJECT_H_


39 
	#TRACKING_AREA_UPDATE_REJECT_H_


	)

42 
	#TRACKING_AREA_UPDATE_REJECT_MINIMUM_LENGTH
 ( \

43 
EMM_CAUSE_MINIMUM_LENGTH
 )

	)

46 
	#TRACKING_AREA_UPDATE_REJECT_MAXIMUM_LENGTH
 ( \

47 
EMM_CAUSE_MAXIMUM_LENGTH
 )

	)

57 
	såackög_¨ó_upd©e_ªje˘_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
EmmCau£
 
	memmˇu£
;

63 } 
	tåackög_¨ó_upd©e_ªje˘_msg
;

65 
decode_åackög_¨ó_upd©e_ªje˘
(
åackög_¨ó_upd©e_ªje˘_msg
 *
åackög¨óupd©îeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_åackög_¨ó_upd©e_ªje˘
(
åackög_¨ó_upd©e_ªje˘_msg
 *
åackög¨óupd©îeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/TrackingAreaUpdateRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"TøckögAªaUpd©eReque°.h
"

39 
	$decode_åackög_¨ó_upd©e_ªque°
(
åackög_¨ó_upd©e_ªque°_msg
 *
åackög_¨ó_upd©e_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
TRACKING_AREA_UPDATE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_ïs_upd©e_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
ïsupd©ëy≥
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 i‡((
decoded_ªsu…
 = 
	`decode_u8_«s_key_£t_idítifõr
(&
åackög_¨ó_upd©e_ªque°
->
«skey£tidítifõr
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

52  
decoded_ªsu…
;

54 
decoded
++;

55 i‡((
decoded_ªsu…
 = 
	`decode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdguti
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

56  
decoded_ªsu…
;

58 
decoded
 +
decoded_ªsu…
;

61 
Àn
 - 
decoded
 > 0)

63 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

65 i‡(
õiDecoded
 >= 0x80)

66 
õiDecoded
 = ieiDecoded & 0xf0;

67 
õiDecoded
)

69 
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_IEI
:

70 i‡((
decoded_ªsu…
 =

71 
	`decode_«s_key_£t_idítifõr
(&
åackög_¨ó_upd©e_ªque°
->
n⁄cuºíä©ivíaskey£tidítifõr
,

72 
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_IEI
,

73 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

74  
decoded_ªsu…
;

75 
decoded
 +
decoded_ªsu…
;

77 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_PRESENT
;

79 
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_IEI
:

80 i‡((
decoded_ªsu…
 =

81 
	`decode_cùhîög_key_£quí˚_numbî
(&
åackög_¨ó_upd©e_ªque°
->
g¥scùhîögkey£quí˚numbî
,

82 
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_IEI
,

83 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

84  
decoded_ªsu…
;

85 
decoded
 +
decoded_ªsu…
;

87 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_PRESENT
;

89 
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_IEI
:

90 i‡((
decoded_ªsu…
 =

91 
	`decode_p_tmsi_sig«tuª
(&
åackög_¨ó_upd©e_ªque°
->
ﬁd±msisig«tuª
,

92 
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_IEI
,

93 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

94  
decoded_ªsu…
;

95 
decoded
 +
decoded_ªsu…
;

97 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
;

99 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_IEI
:

100 i‡((
decoded_ªsu…
 =

101 
	`decode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
addôi⁄Æguti
,

102 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_IEI
, 
buf„r
 +

103 
decoded
, 
Àn
 - decoded)) <= 0)

104  
decoded_ªsu…
;

105 
decoded
 +
decoded_ªsu…
;

107 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_PRESENT
;

109 
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_IEI
:

110 i‡((
decoded_ªsu…
 =

111 
	`decode_n⁄˚
(&
åackög_¨ó_upd©e_ªque°
->
n⁄˚ue
,

112 
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_IEI
, 
buf„r
 + 
decoded
,

113 
Àn
 - 
decoded
)) <= 0)

114  
decoded_ªsu…
;

115 
decoded
 +
decoded_ªsu…
;

117 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_PRESENT
;

119 
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_IEI
:

120 i‡((
decoded_ªsu…
 =

121 
	`decode_ue_√tw‹k_ˇ∑bûôy
(&
åackög_¨ó_upd©e_ªque°
->
uíëw‹kˇ∑bûôy
,

122 
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_IEI
,

123 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

124  
decoded_ªsu…
;

125 
decoded
 +
decoded_ªsu…
;

127 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_PRESENT
;

129 
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
:

130 i‡((
decoded_ªsu…
 =

131 
	`decode_åackög_¨ó_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
œ°visôedªgi°îedèi
,

132 
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
,

133 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

134  
decoded_ªsu…
;

135 
decoded
 +
decoded_ªsu…
;

137 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
;

139 
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_IEI
:

140 i‡((
decoded_ªsu…
 =

141 
	`decode_drx_∑ømëî
(&
åackög_¨ó_upd©e_ªque°
->
drx∑ømëî
,

142 
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_IEI
, 
buf„r
 +

143 
decoded
, 
Àn
 - decoded)) <= 0)

144  
decoded_ªsu…
;

145 
decoded
 +
decoded_ªsu…
;

147 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_PRESENT
;

149 
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_IEI
:

150 i‡((
decoded_ªsu…
 =

151 
	`decode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(&
åackög_¨ó_upd©e_ªque°
->
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
,

152 
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_IEI
,

153 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

154  
decoded_ªsu…
;

155 
decoded
 +
decoded_ªsu…
;

157 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_PRESENT
;

159 
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_IEI
:

160 i‡((
decoded_ªsu…
 =

161 
	`decode_ïs_bóªr_c⁄ãxt_°©us
(&
åackög_¨ó_upd©e_ªque°
->
ïsbóªrc⁄ãxt°©us
,

162 
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_IEI
,

163 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

164  
decoded_ªsu…
;

165 
decoded
 +
decoded_ªsu…
;

167 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_PRESENT
;

169 
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_IEI
:

170 i‡((
decoded_ªsu…
 =

171 
	`decode_ms_√tw‹k_ˇ∑bûôy
(&
åackög_¨ó_upd©e_ªque°
->
m¢ëw‹kˇ∑bûôy
,

172 
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_IEI
,

173 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

174  
decoded_ªsu…
;

175 
decoded
 +
decoded_ªsu…
;

177 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
;

179 
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
:

180 i‡((
decoded_ªsu…
 =

181 
	`decode_loˇti⁄_¨ó_idítifiˇti⁄
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdloˇti⁄¨óidítifiˇti⁄
,

182 
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
,

183 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

184  
decoded_ªsu…
;

185 
decoded
 +
decoded_ªsu…
;

187 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
;

189 
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_IEI
:

190 i‡((
decoded_ªsu…
 =

191 
	`decode_tmsi_°©us
(&
åackög_¨ó_upd©e_ªque°
->
tmsi°©us
,

192 
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_IEI
, 
buf„r
 +

193 
decoded
, 
Àn
 - decoded)) <= 0)

194  
decoded_ªsu…
;

195 
decoded
 +
decoded_ªsu…
;

197 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_PRESENT
;

199 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
:

200 i‡((
decoded_ªsu…
 =

201 
	`decode_mobûe_°©i⁄_˛assm¨k_2
(&
åackög_¨ó_upd©e_ªque°
->
mobûe°©i⁄˛assm¨k2
,

202 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
,

203 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

204  
decoded_ªsu…
;

205 
decoded
 +
decoded_ªsu…
;

207 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
;

209 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
:

210 i‡((
decoded_ªsu…
 =

211 
	`decode_mobûe_°©i⁄_˛assm¨k_3
(&
åackög_¨ó_upd©e_ªque°
->
mobûe°©i⁄˛assm¨k3
,

212 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
,

213 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

214  
decoded_ªsu…
;

215 
decoded
 +
decoded_ªsu…
;

217 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
;

219 
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_IEI
:

220 i‡((
decoded_ªsu…
 =

221 
	`decode_suµ‹ãd_codec_li°
(&
åackög_¨ó_upd©e_ªque°
->
suµ‹ãdcodecs
,

222 
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_IEI
, 
buf„r
 +

223 
decoded
, 
Àn
 - decoded)) <= 0)

224  
decoded_ªsu…
;

225 
decoded
 +
decoded_ªsu…
;

227 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_PRESENT
;

229 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
:

230 i‡((
decoded_ªsu…
 =

231 
	`decode_addôi⁄Æ_upd©e_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
addôi⁄Æupd©ëy≥
,

232 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
,

233 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

234  
decoded_ªsu…
;

235 
decoded
 +
decoded_ªsu…
;

237 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
;

240 
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_IEI
:

241 i‡((
decoded_ªsu…
 =

242 
	`decode_guti_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdgutôy≥
,

243 
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_IEI
,

244 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

245  
decoded_ªsu…
;

246 
decoded
 +
decoded_ªsu…
;

248 
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 |
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_PRESENT
;

252 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

253  
TLV_DECODE_UNEXPECTED_IEI
;

256  
decoded
;

257 
	}
}

259 
	$ícode_åackög_¨ó_upd©e_ªque°
(
åackög_¨ó_upd©e_ªque°_msg
 *
åackög_¨ó_upd©e_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

261 
ícoded
 = 0;

262 
ícode_ªsu…
 = 0;

265 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_UPDATE_REQUEST_MINIMUM_LENGTH
, 
Àn
);

267 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_ïs_upd©e_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
ïsupd©ëy≥
Ë& 0x0fË<< 4Ë| (
	`ícode_u8_«s_key_£t_idítifõr
(&åackög_¨ó_upd©e_ªque°->
«skey£tidítifõr
) & 0x0f);

268 
ícoded
++;

269 i‡((
ícode_ªsu…
 =

270 
	`ícode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdguti
, 0,

271 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

272  
ícode_ªsu…
;

274 
ícoded
 +
ícode_ªsu…
;

276 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_PRESENT
)

277 =
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_PRESENT
)

279 i‡((
ícode_ªsu…
 =

280 
	`ícode_«s_key_£t_idítifõr
(&
åackög_¨ó_upd©e_ªque°
->
n⁄cuºíä©ivíaskey£tidítifõr
,

281 
TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_IEI
,

282 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

284  
ícode_ªsu…
;

286 
ícoded
 +
ícode_ªsu…
;

289 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_PRESENT
)

290 =
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_PRESENT
)

292 i‡((
ícode_ªsu…
 =

293 
	`ícode_cùhîög_key_£quí˚_numbî
(&
åackög_¨ó_upd©e_ªque°
->
g¥scùhîögkey£quí˚numbî
,

294 
TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_IEI
,

295 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

297  
ícode_ªsu…
;

299 
ícoded
 +
ícode_ªsu…
;

302 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
)

303 =
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
)

305 i‡((
ícode_ªsu…
 =

306 
	`ícode_p_tmsi_sig«tuª
(&
åackög_¨ó_upd©e_ªque°
->
ﬁd±msisig«tuª
,

307 
TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_IEI
, 
buf„r
 +

308 
ícoded
, 
Àn
 -Éncoded)) < 0)

310  
ícode_ªsu…
;

312 
ícoded
 +
ícode_ªsu…
;

315 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_PRESENT
)

316 =
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_PRESENT
)

318 i‡((
ícode_ªsu…
 =

319 
	`ícode_ïs_mobûe_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
addôi⁄Æguti
,

320 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_IEI
, 
buf„r
 +

321 
ícoded
, 
Àn
 -Éncoded)) < 0)

323  
ícode_ªsu…
;

325 
ícoded
 +
ícode_ªsu…
;

328 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_PRESENT
)

329 =
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_PRESENT
)

331 i‡((
ícode_ªsu…
 =

332 
	`ícode_n⁄˚
(&
åackög_¨ó_upd©e_ªque°
->
n⁄˚ue
,

333 
TRACKING_AREA_UPDATE_REQUEST_NONCEUE_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

334 
ícoded
)) < 0)

336  
ícode_ªsu…
;

338 
ícoded
 +
ícode_ªsu…
;

341 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_PRESENT
)

342 =
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_PRESENT
)

344 i‡((
ícode_ªsu…
 =

345 
	`ícode_ue_√tw‹k_ˇ∑bûôy
(&
åackög_¨ó_upd©e_ªque°
->
uíëw‹kˇ∑bûôy
,

346 
TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_IEI
, 
buf„r
 +

347 
ícoded
, 
Àn
 -Éncoded)) < 0)

349  
ícode_ªsu…
;

351 
ícoded
 +
ícode_ªsu…
;

354 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
)

355 =
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
)

357 i‡((
ícode_ªsu…
 =

358 
	`ícode_åackög_¨ó_idítôy
(&
åackög_¨ó_upd©e_ªque°
->
œ°visôedªgi°îedèi
,

359 
TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
,

360 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

362  
ícode_ªsu…
;

364 
ícoded
 +
ícode_ªsu…
;

367 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_PRESENT
)

368 =
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_PRESENT
)

370 i‡((
ícode_ªsu…
 =

371 
	`ícode_drx_∑ømëî
(&
åackög_¨ó_upd©e_ªque°
->
drx∑ømëî
,

372 
TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_IEI
, 
buf„r
 + 
ícoded
,

373 
Àn
 - 
ícoded
)) < 0)

375  
ícode_ªsu…
;

377 
ícoded
 +
ícode_ªsu…
;

380 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_PRESENT
)

381 =
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_PRESENT
)

383 i‡((
ícode_ªsu…
 =

384 
	`ícode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(&
åackög_¨ó_upd©e_ªque°
->
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
,

385 
TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_IEI
,

386 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

388  
ícode_ªsu…
;

390 
ícoded
 +
ícode_ªsu…
;

393 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_PRESENT
)

394 =
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_PRESENT
)

396 i‡((
ícode_ªsu…
 =

397 
	`ícode_ïs_bóªr_c⁄ãxt_°©us
(&
åackög_¨ó_upd©e_ªque°
->
ïsbóªrc⁄ãxt°©us
,

398 
TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_IEI
, 
buf„r


399 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

401  
ícode_ªsu…
;

403 
ícoded
 +
ícode_ªsu…
;

406 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
)

407 =
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
)

409 i‡((
ícode_ªsu…
 =

410 
	`ícode_ms_√tw‹k_ˇ∑bûôy
(&
åackög_¨ó_upd©e_ªque°
->
m¢ëw‹kˇ∑bûôy
,

411 
TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_IEI
, 
buf„r
 +

412 
ícoded
, 
Àn
 -Éncoded)) < 0)

414  
ícode_ªsu…
;

416 
ícoded
 +
ícode_ªsu…
;

419 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
)

420 =
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
)

422 i‡((
ícode_ªsu…
 =

423 
	`ícode_loˇti⁄_¨ó_idítifiˇti⁄
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdloˇti⁄¨óidítifiˇti⁄
,

424 
TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
,

425 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

427  
ícode_ªsu…
;

429 
ícoded
 +
ícode_ªsu…
;

432 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_PRESENT
)

433 =
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_PRESENT
)

435 i‡((
ícode_ªsu…
 =

436 
	`ícode_tmsi_°©us
(&
åackög_¨ó_upd©e_ªque°
->
tmsi°©us
,

437 
TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_IEI
, 
buf„r
 + 
ícoded
,

438 
Àn
 - 
ícoded
)) < 0)

440  
ícode_ªsu…
;

442 
ícoded
 +
ícode_ªsu…
;

445 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
)

446 =
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
)

448 i‡((
ícode_ªsu…
 =

449 
	`ícode_mobûe_°©i⁄_˛assm¨k_2
(&
åackög_¨ó_upd©e_ªque°
->
mobûe°©i⁄˛assm¨k2
,

450 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
,

451 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

453  
ícode_ªsu…
;

455 
ícoded
 +
ícode_ªsu…
;

458 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
)

459 =
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
)

461 i‡((
ícode_ªsu…
 =

462 
	`ícode_mobûe_°©i⁄_˛assm¨k_3
(&
åackög_¨ó_upd©e_ªque°
->
mobûe°©i⁄˛assm¨k3
,

463 
TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
,

464 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

466  
ícode_ªsu…
;

468 
ícoded
 +
ícode_ªsu…
;

471 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_PRESENT
)

472 =
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_PRESENT
)

474 i‡((
ícode_ªsu…
 =

475 
	`ícode_suµ‹ãd_codec_li°
(&
åackög_¨ó_upd©e_ªque°
->
suµ‹ãdcodecs
,

476 
TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_IEI
, 
buf„r
 +

477 
ícoded
, 
Àn
 -Éncoded)) < 0)

479  
ícode_ªsu…
;

481 
ícoded
 +
ícode_ªsu…
;

484 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
)

485 =
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
)

487 i‡((
ícode_ªsu…
 =

488 
	`ícode_addôi⁄Æ_upd©e_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
addôi⁄Æupd©ëy≥
,

489 
TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
, 
buf„r
 +

490 
ícoded
, 
Àn
 -Éncoded)) < 0)

492  
ícode_ªsu…
;

494 
ícoded
 +
ícode_ªsu…
;

497 i‡((
åackög_¨ó_upd©e_ªque°
->
¥e£n˚mask
 & 
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_PRESENT
)

498 =
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_PRESENT
)

500 i‡((
ícode_ªsu…
 =

501 
	`ícode_guti_ty≥
(&
åackög_¨ó_upd©e_ªque°
->
ﬁdgutôy≥
,

502 
TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_IEI
,

503 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

505  
ícode_ªsu…
;

507 
ícoded
 +
ícode_ªsu…
;

510  
ícoded
;

511 
	}
}

	@src/emm/msg/TrackingAreaUpdateRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"EpsUpd©eTy≥.h
"

37 
	~"NasKeySëIdítifõr.h
"

38 
	~"EpsMobûeIdítôy.h
"

39 
	~"CùhîögKeySequí˚Numbî.h
"

40 
	~"PTmsiSig«tuª.h
"

41 
	~"N⁄˚.h
"

42 
	~"UeNëw‹kC≠abûôy.h
"

43 
	~"TøckögAªaIdítôy.h
"

44 
	~"DrxP¨amëî.h
"

45 
	~"UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded.h
"

46 
	~"EpsBóªrC⁄ãxtSètus.h
"

47 
	~"MsNëw‹kC≠abûôy.h
"

48 
	~"Loˇti⁄AªaIdítifiˇti⁄.h
"

49 
	~"TmsiSètus.h
"

50 
	~"MobûeSèti⁄Cœssm¨k2.h
"

51 
	~"MobûeSèti⁄Cœssm¨k3.h
"

52 
	~"Suµ‹ãdCodecLi°.h
"

53 
	~"Addôi⁄ÆUpd©eTy≥.h
"

54 
	~"GutiTy≥.h
"

56 #i‚de‡
TRACKING_AREA_UPDATE_REQUEST_H_


57 
	#TRACKING_AREA_UPDATE_REQUEST_H_


	)

60 
	#TRACKING_AREA_UPDATE_REQUEST_MINIMUM_LENGTH
 ( \

61 
EPS_UPDATE_TYPE_MINIMUM_LENGTH
 + \

62 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 + \

63 
EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
 )

	)

66 
	#TRACKING_AREA_UPDATE_REQUEST_MAXIMUM_LENGTH
 ( \

67 
EPS_UPDATE_TYPE_MAXIMUM_LENGTH
 + \

68 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

69 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

70 
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 + \

71 
CIPHERING_KEY_SEQUENCE_NUMBER_MAXIMUM_LENGTH
 + \

72 
P_TMSI_SIGNATURE_MAXIMUM_LENGTH
 + \

73 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 + \

74 
NONCE_MAXIMUM_LENGTH
 + \

75 
UE_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 + \

76 
TRACKING_AREA_IDENTITY_MAXIMUM_LENGTH
 + \

77 
DRX_PARAMETER_MAXIMUM_LENGTH
 + \

78 
UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_MAXIMUM_LENGTH
 + \

79 
EPS_BEARER_CONTEXT_STATUS_MAXIMUM_LENGTH
 + \

80 
MS_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 + \

81 
LOCATION_AREA_IDENTIFICATION_MAXIMUM_LENGTH
 + \

82 
TMSI_STATUS_MAXIMUM_LENGTH
 + \

83 
MOBILE_STATION_CLASSMARK_2_MAXIMUM_LENGTH
 + \

84 
MOBILE_STATION_CLASSMARK_3_MAXIMUM_LENGTH
 + \

85 
SUPPORTED_CODEC_LIST_MAXIMUM_LENGTH
 + \

86 
ADDITIONAL_UPDATE_TYPE_MAXIMUM_LENGTH
 )

	)

91 
	#TRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_PRESENT
 (1<<0)

	)

92 
	#TRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_PRESENT
 (1<<1)

	)

93 
	#TRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_PRESENT
 (1<<2)

	)

94 
	#TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_PRESENT
 (1<<3)

	)

95 
	#TRACKING_AREA_UPDATE_REQUEST_NONCEUE_PRESENT
 (1<<4)

	)

96 
	#TRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_PRESENT
 (1<<5)

	)

97 
	#TRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
 (1<<6)

	)

98 
	#TRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_PRESENT
 (1<<7)

	)

99 
	#TRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_PRESENT
 (1<<8)

	)

100 
	#TRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_PRESENT
 (1<<9)

	)

101 
	#TRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_PRESENT
 (1<<10)

	)

102 
	#TRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_PRESENT
 (1<<11)

	)

103 
	#TRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_PRESENT
 (1<<12)

	)

104 
	#TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_PRESENT
 (1<<13)

	)

105 
	#TRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_PRESENT
 (1<<14)

	)

106 
	#TRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_PRESENT
 (1<<15)

	)

107 
	#TRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_PRESENT
 (1<<16)

	)

108 
	#TRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_PRESENT
 (1<<17)

	)

110 
	eåackög_¨ó_upd©e_ªque°_õi_èg
 {

111 
	mTRACKING_AREA_UPDATE_REQUEST_NONCURRENT_NATIVE_NAS_KEY_SET_IDENTIFIER_IEI
 = 0xB0,

112 
	mTRACKING_AREA_UPDATE_REQUEST_GPRS_CIPHERING_KEY_SEQUENCE_NUMBER_IEI
 = 0x80,

113 
	mTRACKING_AREA_UPDATE_REQUEST_OLD_PTMSI_SIGNATURE_IEI
 = 0x19,

114 
	mTRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_GUTI_IEI
 = 0x50,

115 
	mTRACKING_AREA_UPDATE_REQUEST_NONCEUE_IEI
 = 0x55,

116 
	mTRACKING_AREA_UPDATE_REQUEST_UE_NETWORK_CAPABILITY_IEI
 = 0x58,

117 
	mTRACKING_AREA_UPDATE_REQUEST_LAST_VISITED_REGISTERED_TAI_IEI
 = 0x52,

118 
	mTRACKING_AREA_UPDATE_REQUEST_DRX_PARAMETER_IEI
 = 0x5C,

119 
	mTRACKING_AREA_UPDATE_REQUEST_UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_IEI
 = 0xA0,

120 
	mTRACKING_AREA_UPDATE_REQUEST_EPS_BEARER_CONTEXT_STATUS_IEI
 = 0x57,

121 
	mTRACKING_AREA_UPDATE_REQUEST_MS_NETWORK_CAPABILITY_IEI
 = 0x31,

122 
	mTRACKING_AREA_UPDATE_REQUEST_OLD_LOCATION_AREA_IDENTIFICATION_IEI
 = 0x13,

123 
	mTRACKING_AREA_UPDATE_REQUEST_TMSI_STATUS_IEI
 = 0x90,

124 
	mTRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_2_IEI
 = 0x11,

125 
	mTRACKING_AREA_UPDATE_REQUEST_MOBILE_STATION_CLASSMARK_3_IEI
 = 0x20,

126 
	mTRACKING_AREA_UPDATE_REQUEST_SUPPORTED_CODECS_IEI
 = 0x40,

127 
	mTRACKING_AREA_UPDATE_REQUEST_ADDITIONAL_UPDATE_TYPE_IEI
 = 0xF0,

128 
	mTRACKING_AREA_UPDATE_REQUEST_OLD_GUTI_TYPE_IEI
 = 0xE0,

129 } 
	tåackög_¨ó_upd©e_ªque°_õi
;

138 
	såackög_¨ó_upd©e_ªque°_msg_èg
 {

140 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

141 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

142 
MesßgeTy≥
 
	mmesßgëy≥
;

143 
EpsUpd©eTy≥
 
	mïsupd©ëy≥
;

144 
NasKeySëIdítifõr
 
	m«skey£tidítifõr
;

145 
EpsMobûeIdítôy
 
	mﬁdguti
;

147 
uöt32_t
 
	m¥e£n˚mask
;

148 
NasKeySëIdítifõr
 
	mn⁄cuºíä©ivíaskey£tidítifõr
;

149 
CùhîögKeySequí˚Numbî
 
	mg¥scùhîögkey£quí˚numbî
;

150 
PTmsiSig«tuª
 
	mﬁd±msisig«tuª
;

151 
EpsMobûeIdítôy
 
	maddôi⁄Æguti
;

152 
N⁄˚
 
	mn⁄˚ue
;

153 
UeNëw‹kC≠abûôy
 
	muíëw‹kˇ∑bûôy
;

154 
TøckögAªaIdítôy
 
	mœ°visôedªgi°îedèi
;

155 
DrxP¨amëî
 
	mdrx∑ømëî
;

156 
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 
	muîadioˇ∑bûôyöf‹m©i⁄upd©íìded
;

157 
EpsBóªrC⁄ãxtSètus
 
	mïsbóªrc⁄ãxt°©us
;

158 
MsNëw‹kC≠abûôy
 
	mm¢ëw‹kˇ∑bûôy
;

159 
Loˇti⁄AªaIdítifiˇti⁄
 
	mﬁdloˇti⁄¨óidítifiˇti⁄
;

160 
TmsiSètus
 
	mtmsi°©us
;

161 
MobûeSèti⁄Cœssm¨k2
 
	mmobûe°©i⁄˛assm¨k2
;

162 
MobûeSèti⁄Cœssm¨k3
 
	mmobûe°©i⁄˛assm¨k3
;

163 
Suµ‹ãdCodecLi°
 
	msuµ‹ãdcodecs
;

164 
Addôi⁄ÆUpd©eTy≥
 
	maddôi⁄Æupd©ëy≥
;

165 
GutiTy≥
 
	mﬁdgutôy≥
;

166 } 
	tåackög_¨ó_upd©e_ªque°_msg
;

168 
decode_åackög_¨ó_upd©e_ªque°
(
åackög_¨ó_upd©e_ªque°_msg
 *
åackög¨óupd©îeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

170 
ícode_åackög_¨ó_upd©e_ªque°
(
åackög_¨ó_upd©e_ªque°_msg
 *
åackög¨óupd©îeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/UplinkNasTransport.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"U∂ökNasTøn•‹t.h
"

39 
	$decode_u∂ök_«s_å™•‹t
(
u∂ök_«s_å™•‹t_msg
 *
u∂ök_«s_å™•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
UPLINK_NAS_TRANSPORT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_«s_mesßge_c⁄èöî
(&
u∂ök_«s_å™•‹t
->
«smesßgec⁄èöî
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_u∂ök_«s_å™•‹t
(
u∂ök_«s_å™•‹t_msg
 *
u∂ök_«s_å™•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
UPLINK_NAS_TRANSPORT_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 =

65 
	`ícode_«s_mesßge_c⁄èöî
(&
u∂ök_«s_å™•‹t
->
«smesßgec⁄èöî
,

66 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

67  
ícode_ªsu…
;

69 
ícoded
 +
ícode_ªsu…
;

71  
ícoded
;

72 
	}
}

	@src/emm/msg/UplinkNasTransport.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"SecurôyHódîTy≥.h
"

35 
	~"MesßgeTy≥.h
"

36 
	~"NasMesßgeC⁄èöî.h
"

38 #i‚de‡
UPLINK_NAS_TRANSPORT_H_


39 
	#UPLINK_NAS_TRANSPORT_H_


	)

42 
	#UPLINK_NAS_TRANSPORT_MINIMUM_LENGTH
 ( \

43 
NAS_MESSAGE_CONTAINER_MINIMUM_LENGTH
 )

	)

46 
	#UPLINK_NAS_TRANSPORT_MAXIMUM_LENGTH
 ( \

47 
NAS_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 )

	)

57 
	su∂ök_«s_å™•‹t_msg_èg
 {

59 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

60 
SecurôyHódîTy≥
 
	m£curôyhódîty≥
:4;

61 
MesßgeTy≥
 
	mmesßgëy≥
;

62 
NasMesßgeC⁄èöî
 
	m«smesßgec⁄èöî
;

63 } 
	tu∂ök_«s_å™•‹t_msg
;

65 
decode_u∂ök_«s_å™•‹t
(
u∂ök_«s_å™•‹t_msg
 *
u∂ök«°øn•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

67 
ícode_u∂ök_«s_å™•‹t
(
u∂ök_«s_å™•‹t_msg
 *
u∂ök«°øn•‹t
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/emm_cause.h

47 #i‚de‡
__EMM_CAUSE_H__


48 
	#__EMM_CAUSE_H__


	)

58 
	#EMM_CAUSE_SUCCESS
 (-1)

	)

63 
	#EMM_CAUSE_IMSI_UNKNOWN_IN_HSS
 2

	)

64 
	#EMM_CAUSE_ILLEGAL_UE
 3

	)

65 
	#EMM_CAUSE_ILLEGAL_ME
 6

	)

66 
	#EMM_CAUSE_INVALID_UE
 9

	)

67 
	#EMM_CAUSE_IMPLICITLY_DETACHED
 10

	)

72 
	#EMM_CAUSE_IMEI_NOT_ACCEPTED
 5

	)

73 
	#EMM_CAUSE_EPS_NOT_ALLOWED
 7

	)

74 
	#EMM_CAUSE_BOTH_NOT_ALLOWED
 8

	)

75 
	#EMM_CAUSE_PLMN_NOT_ALLOWED
 11

	)

76 
	#EMM_CAUSE_TA_NOT_ALLOWED
 12

	)

77 
	#EMM_CAUSE_ROAMING_NOT_ALLOWED
 13

	)

78 
	#EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
 14

	)

79 
	#EMM_CAUSE_NO_SUITABLE_CELLS
 15

	)

80 
	#EMM_CAUSE_CSG_NOT_AUTHORIZED
 25

	)

81 
	#EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
 35

	)

82 
	#EMM_CAUSE_NO_EPS_BEARER_CTX_ACTIVE
 40

	)

88 
	#EMM_CAUSE_MSC_NOT_REACHABLE
 16

	)

89 
	#EMM_CAUSE_NETWORK_FAILURE
 17

	)

90 
	#EMM_CAUSE_CS_DOMAIN_NOT_AVAILABLE
 18

	)

91 
	#EMM_CAUSE_ESM_FAILURE
 19

	)

92 
	#EMM_CAUSE_MAC_FAILURE
 20

	)

93 
	#EMM_CAUSE_SYNCH_FAILURE
 21

	)

94 
	#EMM_CAUSE_CONGESTION
 22

	)

95 
	#EMM_CAUSE_UE_SECURITY_MISMATCH
 23

	)

96 
	#EMM_CAUSE_SECURITY_MODE_REJECTED
 24

	)

97 
	#EMM_CAUSE_NON_EPS_AUTH_UNACCEPTABLE
 26

	)

98 
	#EMM_CAUSE_CS_SERVICE_NOT_AVAILABLE
 39

	)

103 
	#EMM_CAUSE_SEMANTICALLY_INCORRECT
 95

	)

104 
	#EMM_CAUSE_INVALID_MANDATORY_INFO
 96

	)

105 
	#EMM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
 97

	)

106 
	#EMM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
 98

	)

107 
	#EMM_CAUSE_IE_NOT_IMPLEMENTED
 99

	)

108 
	#EMM_CAUSE_CONDITIONAL_IE_ERROR
 100

	)

109 
	#EMM_CAUSE_MESSAGE_NOT_COMPATIBLE
 101

	)

110 
	#EMM_CAUSE_PROTOCOL_ERROR
 111

	)

	@src/emm/msg/emm_msg.c

47 
	~"emm_msg.h
"

48 
	~"comm⁄Def.h
"

49 
	~"«s_log.h
"

51 
	~"TLVDecodî.h
"

52 
	~"TLVEncodî.h
"

54 #i‡((
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

55 
	~"«s_ôti_mesßgög.h
"

66 
_emm_msg_decode_hódî
(
emm_msg_hódî_t
 *
hódî
,

67 c⁄° 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

68 
_emm_msg_ícode_hódî
(c⁄° 
emm_msg_hódî_t
 *
hódî
,

69 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

93 
	$emm_msg_decode
(
EMM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

95 
LOG_FUNC_IN
;

97 
hódî_ªsu…
;

98 
decode_ªsu…
;

100 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

101 
uöt8_t
 *
buf„r_log
 = 
buf„r
;

102 
uöt32_t
 
Àn_log
 = 
Àn
;

103 
down_lök
;

105 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)))

106 
down_lök
 = 0;

108 
down_lök
 = 1;

113 
hódî_ªsu…
 = 
	`_emm_msg_decode_hódî
(&
msg
->
hódî
, 
buf„r
, 
Àn
);

114 i‡(
hódî_ªsu…
 < 0) {

115 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - FailedÅo decode EMM message header "

116 "(%d)", 
hódî_ªsu…
);

117 
	`LOG_FUNC_RETURN
(
hódî_ªsu…
);

120 
buf„r
 +
hódî_ªsu…
;

121 
Àn
 -
hódî_ªsu…
;

123 
	`LOG_TRACE
(
INFO
, "EMM-MSG - MesßgêTy≥ 0x%02x", 
msg
->
hódî
.
mesßge_ty≥
);

125 
msg
->
hódî
.
mesßge_ty≥
) {

126 
EMM_INFORMATION
:

127 
decode_ªsu…
 = 
	`decode_emm_öf‹m©i⁄
(&
msg
->
emm_öf‹m©i⁄
, 
buf„r
, 
Àn
);

129 
UPLINK_NAS_TRANSPORT
:

130 
decode_ªsu…
 = 
	`decode_u∂ök_«s_å™•‹t
(&
msg
->
u∂ök_«s_å™•‹t
, 
buf„r
,

131 
Àn
);

133 
AUTHENTICATION_REJECT
:

134 
decode_ªsu…
 = 
	`decode_authítiˇti⁄_ªje˘
(&
msg
->
authítiˇti⁄_ªje˘
,

135 
buf„r
, 
Àn
);

137 
AUTHENTICATION_FAILURE
:

138 
decode_ªsu…
 = 
	`decode_authítiˇti⁄_Áûuª
(&
msg
->
authítiˇti⁄_Áûuª
,

139 
buf„r
, 
Àn
);

141 
DETACH_ACCEPT
:

142 
decode_ªsu…
 = 
	`decode_dëach_ac˚±
(&
msg
->
dëach_ac˚±
, 
buf„r
, 
Àn
);

144 
SERVICE_REJECT
:

145 
decode_ªsu…
 = 
	`decode_£rvi˚_ªje˘
(&
msg
->
£rvi˚_ªje˘
, 
buf„r
, 
Àn
);

147 
AUTHENTICATION_REQUEST
:

148 
decode_ªsu…
 = 
	`decode_authítiˇti⁄_ªque°
(&
msg
->
authítiˇti⁄_ªque°
,

149 
buf„r
, 
Àn
);

151 
TRACKING_AREA_UPDATE_REQUEST
:

152 
decode_ªsu…
 = 
	`decode_åackög_¨ó_upd©e_ªque°
(

153 &
msg
->
åackög_¨ó_upd©e_ªque°
, 
buf„r
, 
Àn
);

155 
ATTACH_REQUEST
:

156 
decode_ªsu…
 = 
	`decode_©èch_ªque°
(&
msg
->
©èch_ªque°
, 
buf„r
, 
Àn
);

158 
EMM_STATUS
:

159 
decode_ªsu…
 = 
	`decode_emm_°©us
(&
msg
->
emm_°©us
, 
buf„r
, 
Àn
);

161 
IDENTITY_RESPONSE
:

162 
decode_ªsu…
 = 
	`decode_idítôy_ª•⁄£
(&
msg
->
idítôy_ª•⁄£
, 
buf„r
, 
Àn
);

164 
IDENTITY_REQUEST
:

165 
decode_ªsu…
 = 
	`decode_idítôy_ªque°
(&
msg
->
idítôy_ªque°
, 
buf„r
, 
Àn
);

167 
GUTI_REALLOCATION_COMMAND
:

168 
decode_ªsu…
 = 
	`decode_guti_ªÆloˇti⁄_comm™d
(&
msg
->
guti_ªÆloˇti⁄_comm™d
,

169 
buf„r
, 
Àn
);

171 
TRACKING_AREA_UPDATE_REJECT
:

172 
decode_ªsu…
 = 
	`decode_åackög_¨ó_upd©e_ªje˘
(

173 &
msg
->
åackög_¨ó_upd©e_ªje˘
, 
buf„r
, 
Àn
);

175 
ATTACH_ACCEPT
:

176 
decode_ªsu…
 = 
	`decode_©èch_ac˚±
(&
msg
->
©èch_ac˚±
, 
buf„r
, 
Àn
);

178 
SECURITY_MODE_COMPLETE
:

179 
decode_ªsu…
 = 
	`decode_£curôy_mode_com∂ëe
(&
msg
->
£curôy_mode_com∂ëe
,

180 
buf„r
, 
Àn
);

182 
TRACKING_AREA_UPDATE_ACCEPT
:

183 
decode_ªsu…
 = 
	`decode_åackög_¨ó_upd©e_ac˚±
(

184 &
msg
->
åackög_¨ó_upd©e_ac˚±
, 
buf„r
, 
Àn
);

186 
ATTACH_REJECT
:

187 
decode_ªsu…
 = 
	`decode_©èch_ªje˘
(&
msg
->
©èch_ªje˘
, 
buf„r
, 
Àn
);

189 
ATTACH_COMPLETE
:

190 
decode_ªsu…
 = 
	`decode_©èch_com∂ëe
(&
msg
->
©èch_com∂ëe
, 
buf„r
, 
Àn
);

192 
TRACKING_AREA_UPDATE_COMPLETE
:

193 
decode_ªsu…
 = 
	`decode_åackög_¨ó_upd©e_com∂ëe
(

194 &
msg
->
åackög_¨ó_upd©e_com∂ëe
, 
buf„r
, 
Àn
);

196 
CS_SERVICE_NOTIFICATION
:

197 
decode_ªsu…
 = 
	`decode_cs_£rvi˚_nŸifiˇti⁄
(&
msg
->
cs_£rvi˚_nŸifiˇti⁄
,

198 
buf„r
, 
Àn
);

200 
SECURITY_MODE_REJECT
:

201 
decode_ªsu…
 = 
	`decode_£curôy_mode_ªje˘
(&
msg
->
£curôy_mode_ªje˘
, 
buf„r
,

202 
Àn
);

204 
DETACH_REQUEST
:

205 
decode_ªsu…
 = 
	`decode_dëach_ªque°
(&
msg
->
dëach_ªque°
, 
buf„r
, 
Àn
);

207 
GUTI_REALLOCATION_COMPLETE
:

208 
decode_ªsu…
 = 
	`decode_guti_ªÆloˇti⁄_com∂ëe
(

209 &
msg
->
guti_ªÆloˇti⁄_com∂ëe
, 
buf„r
, 
Àn
);

211 
SECURITY_MODE_COMMAND
:

212 
decode_ªsu…
 = 
	`decode_£curôy_mode_comm™d
(&
msg
->
£curôy_mode_comm™d
,

213 
buf„r
, 
Àn
);

215 
DOWNLINK_NAS_TRANSPORT
:

216 
decode_ªsu…
 = 
	`decode_dow∆ök_«s_å™•‹t
(&
msg
->
dow∆ök_«s_å™•‹t
,

217 
buf„r
, 
Àn
);

219 
EXTENDED_SERVICE_REQUEST
:

220 
decode_ªsu…
 = 
	`decode_exãnded_£rvi˚_ªque°
(&
msg
->
exãnded_£rvi˚_ªque°
,

221 
buf„r
, 
Àn
);

223 
AUTHENTICATION_RESPONSE
:

224 
decode_ªsu…
 = 
	`decode_authítiˇti⁄_ª•⁄£
(&
msg
->
authítiˇti⁄_ª•⁄£
,

225 
buf„r
, 
Àn
);

228 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - Unexpected messageÅype: 0x%x",

229 
msg
->
hódî
.
mesßge_ty≥
);

230 
decode_ªsu…
 = 
TLV_DECODE_WRONG_MESSAGE_TYPE
;

234 i‡(
decode_ªsu…
 < 0) {

235 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - FailedÅo decode L3 EMM message 0x%x "

236 "(%d)", 
msg
->
hódî
.
mesßge_ty≥
, 
decode_ªsu…
);

237 
	`LOG_FUNC_RETURN
 (
decode_ªsu…
);

239 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

241 
	`«s_ôti_∂aö_msg
((*Ë
buf„r_log
, (
«s_mesßge_t
 *Ë
msg
, 
Àn_log
, 
down_lök
);

244 
	`LOG_FUNC_RETURN
 (
hódî_ªsu…
 + 
decode_ªsu…
);

245 
	}
}

264 
	$emm_msg_ícode
(
EMM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

266 
LOG_FUNC_IN
;

268 
hódî_ªsu…
;

269 
ícode_ªsu…
;

271 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

272 
uöt8_t
 *
buf„r_log
 = 
buf„r
;

273 
down_lök
;

275 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)))

276 
down_lök
 = 1;

278 
down_lök
 = 0;

283 
hódî_ªsu…
 = 
	`_emm_msg_ícode_hódî
(&
msg
->
hódî
, 
buf„r
, 
Àn
);

284 i‡(
hódî_ªsu…
 < 0) {

285 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - FailedÅoÉncode EMM message header "

286 "(%d)", 
hódî_ªsu…
);

287 
	`LOG_FUNC_RETURN
(
hódî_ªsu…
);

290 
buf„r
 +
hódî_ªsu…
;

291 
Àn
 -
hódî_ªsu…
;

293 
msg
->
hódî
.
mesßge_ty≥
) {

294 
EMM_INFORMATION
:

295 
ícode_ªsu…
 = 
	`ícode_emm_öf‹m©i⁄
(&
msg
->
emm_öf‹m©i⁄
, 
buf„r
, 
Àn
);

297 
UPLINK_NAS_TRANSPORT
:

298 
ícode_ªsu…
 = 
	`ícode_u∂ök_«s_å™•‹t
(&
msg
->
u∂ök_«s_å™•‹t
, 
buf„r
,

299 
Àn
);

301 
AUTHENTICATION_REJECT
:

302 
ícode_ªsu…
 = 
	`ícode_authítiˇti⁄_ªje˘
(&
msg
->
authítiˇti⁄_ªje˘
,

303 
buf„r
, 
Àn
);

305 
AUTHENTICATION_FAILURE
:

306 
ícode_ªsu…
 = 
	`ícode_authítiˇti⁄_Áûuª
(&
msg
->
authítiˇti⁄_Áûuª
,

307 
buf„r
, 
Àn
);

309 
DETACH_ACCEPT
:

310 
ícode_ªsu…
 = 
	`ícode_dëach_ac˚±
(&
msg
->
dëach_ac˚±
, 
buf„r
, 
Àn
);

312 
SERVICE_REJECT
:

313 
ícode_ªsu…
 = 
	`ícode_£rvi˚_ªje˘
(&
msg
->
£rvi˚_ªje˘
, 
buf„r
, 
Àn
);

315 
AUTHENTICATION_REQUEST
:

316 
ícode_ªsu…
 = 
	`ícode_authítiˇti⁄_ªque°
(&
msg
->
authítiˇti⁄_ªque°
,

317 
buf„r
, 
Àn
);

319 
TRACKING_AREA_UPDATE_REQUEST
:

320 
ícode_ªsu…
 = 
	`ícode_åackög_¨ó_upd©e_ªque°
(

321 &
msg
->
åackög_¨ó_upd©e_ªque°
, 
buf„r
, 
Àn
);

323 
ATTACH_REQUEST
:

324 
ícode_ªsu…
 = 
	`ícode_©èch_ªque°
(&
msg
->
©èch_ªque°
, 
buf„r
, 
Àn
);

326 
EMM_STATUS
:

327 
ícode_ªsu…
 = 
	`ícode_emm_°©us
(&
msg
->
emm_°©us
, 
buf„r
, 
Àn
);

329 
IDENTITY_RESPONSE
:

330 
ícode_ªsu…
 = 
	`ícode_idítôy_ª•⁄£
(&
msg
->
idítôy_ª•⁄£
, 
buf„r
, 
Àn
);

332 
IDENTITY_REQUEST
:

333 
ícode_ªsu…
 = 
	`ícode_idítôy_ªque°
(&
msg
->
idítôy_ªque°
, 
buf„r
, 
Àn
);

335 
GUTI_REALLOCATION_COMMAND
:

336 
ícode_ªsu…
 = 
	`ícode_guti_ªÆloˇti⁄_comm™d
(&
msg
->
guti_ªÆloˇti⁄_comm™d
,

337 
buf„r
, 
Àn
);

339 
TRACKING_AREA_UPDATE_REJECT
:

340 
ícode_ªsu…
 = 
	`ícode_åackög_¨ó_upd©e_ªje˘
(

341 &
msg
->
åackög_¨ó_upd©e_ªje˘
, 
buf„r
, 
Àn
);

343 
ATTACH_ACCEPT
:

344 
ícode_ªsu…
 = 
	`ícode_©èch_ac˚±
(&
msg
->
©èch_ac˚±
, 
buf„r
, 
Àn
);

346 
SECURITY_MODE_COMPLETE
:

347 
ícode_ªsu…
 = 
	`ícode_£curôy_mode_com∂ëe
(&
msg
->
£curôy_mode_com∂ëe
,

348 
buf„r
, 
Àn
);

350 
TRACKING_AREA_UPDATE_ACCEPT
:

351 
ícode_ªsu…
 = 
	`ícode_åackög_¨ó_upd©e_ac˚±
(

352 &
msg
->
åackög_¨ó_upd©e_ac˚±
, 
buf„r
, 
Àn
);

354 
ATTACH_REJECT
:

355 
ícode_ªsu…
 = 
	`ícode_©èch_ªje˘
(&
msg
->
©èch_ªje˘
, 
buf„r
, 
Àn
);

357 
ATTACH_COMPLETE
:

358 
ícode_ªsu…
 = 
	`ícode_©èch_com∂ëe
(&
msg
->
©èch_com∂ëe
, 
buf„r
, 
Àn
);

360 
TRACKING_AREA_UPDATE_COMPLETE
:

361 
ícode_ªsu…
 = 
	`ícode_åackög_¨ó_upd©e_com∂ëe
(

362 &
msg
->
åackög_¨ó_upd©e_com∂ëe
, 
buf„r
, 
Àn
);

364 
CS_SERVICE_NOTIFICATION
:

365 
ícode_ªsu…
 = 
	`ícode_cs_£rvi˚_nŸifiˇti⁄
(&
msg
->
cs_£rvi˚_nŸifiˇti⁄
,

366 
buf„r
, 
Àn
);

368 
SECURITY_MODE_REJECT
:

369 
ícode_ªsu…
 = 
	`ícode_£curôy_mode_ªje˘
(&
msg
->
£curôy_mode_ªje˘
, 
buf„r
,

370 
Àn
);

372 
DETACH_REQUEST
:

373 
ícode_ªsu…
 = 
	`ícode_dëach_ªque°
(&
msg
->
dëach_ªque°
, 
buf„r
, 
Àn
);

375 
GUTI_REALLOCATION_COMPLETE
:

376 
ícode_ªsu…
 = 
	`ícode_guti_ªÆloˇti⁄_com∂ëe
(

377 &
msg
->
guti_ªÆloˇti⁄_com∂ëe
, 
buf„r
, 
Àn
);

379 
SECURITY_MODE_COMMAND
:

380 
ícode_ªsu…
 = 
	`ícode_£curôy_mode_comm™d
(&
msg
->
£curôy_mode_comm™d
,

381 
buf„r
, 
Àn
);

383 
DOWNLINK_NAS_TRANSPORT
:

384 
ícode_ªsu…
 = 
	`ícode_dow∆ök_«s_å™•‹t
(&
msg
->
dow∆ök_«s_å™•‹t
,

385 
buf„r
, 
Àn
);

387 
EXTENDED_SERVICE_REQUEST
:

388 
ícode_ªsu…
 = 
	`ícode_exãnded_£rvi˚_ªque°
(&
msg
->
exãnded_£rvi˚_ªque°
,

389 
buf„r
, 
Àn
);

391 
AUTHENTICATION_RESPONSE
:

392 
ícode_ªsu…
 = 
	`ícode_authítiˇti⁄_ª•⁄£
(&
msg
->
authítiˇti⁄_ª•⁄£
,

393 
buf„r
, 
Àn
);

395 
SERVICE_REQUEST
:

396 
ícode_ªsu…
 = 
	`ícode_£rvi˚_ªque°
(&
msg
->
£rvi˚_ªque°
, 
buf„r
, 
Àn
);

399 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - Unexpected messageÅype: 0x%x",

400 
msg
->
hódî
.
mesßge_ty≥
);

401 
ícode_ªsu…
 = 
TLV_ENCODE_WRONG_MESSAGE_TYPE
;

405 i‡(
ícode_ªsu…
 < 0) {

406 
	`LOG_TRACE
(
ERROR
, "EMM-MSG - FailedÅoÉncode L3 EMM message 0x%x "

407 "(%d)", 
msg
->
hódî
.
mesßge_ty≥
, 
ícode_ªsu…
);

409 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

410 
	`«s_ôti_∂aö_msg
((*Ë
buf„r_log
, (
«s_mesßge_t
 *Ë
msg
, 
hódî_ªsu…
 + 
ícode_ªsu…
, 
down_lök
);

413 
	`LOG_FUNC_RETURN
 (
hódî_ªsu…
 + 
ícode_ªsu…
);

414 
	}
}

440 
	$_emm_msg_decode_hódî
(
emm_msg_hódî_t
 *
hódî
,

441 c⁄° 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

443 
size
 = 0;

446 i‡(
Àn
 < (
emm_msg_hódî_t
)) {

447  (
TLV_DECODE_BUFFER_TOO_SHORT
);

450 
	`DECODE_U8
(
buf„r
 + 
size
, *(
uöt8_t
 *)(
hódî
), size);

452 
	`DECODE_U8
(
buf„r
 + 
size
, 
hódî
->
mesßge_ty≥
, size);

455 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 !
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

456 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - UnexpectedÖrotocol discriminator: 0x%x",

457 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

458  (
TLV_DECODE_PROTOCOL_NOT_SUPPORTED
);

461  (
size
);

462 
	}
}

482 
	$_emm_msg_ícode_hódî
(c⁄° 
emm_msg_hódî_t
 *
hódî
,

483 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

485 
size
 = 0;

488 i‡(
Àn
 < (
emm_msg_hódî_t
)) {

489  (
TLV_ENCODE_BUFFER_TOO_SHORT
);

492 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 !
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

493 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - UnexpectedÖrotocol discriminator: 0x%x",

494 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

495  (
TLV_ENCODE_PROTOCOL_NOT_SUPPORTED
);

499 
	`ENCODE_U8
(
buf„r
 + 
size
, *(
uöt8_t
 *)(
hódî
), size);

501 
	`ENCODE_U8
(
buf„r
 + 
size
, 
hódî
->
mesßge_ty≥
, size);

503  (
size
);

504 
	}
}

	@src/emm/msg/emm_msg.h

46 #i‚de‡
__EMM_MSG_H__


47 
	#__EMM_MSG_H__


	)

49 
	~"emm_msgDef.h
"

51 
	~"AâachReque°.h
"

52 
	~"AâachAc˚±.h
"

53 
	~"AâachCom∂ëe.h
"

54 
	~"AâachReje˘.h
"

55 
	~"DëachReque°.h
"

56 
	~"DëachAc˚±.h
"

57 
	~"TøckögAªaUpd©eReque°.h
"

58 
	~"TøckögAªaUpd©eAc˚±.h
"

59 
	~"TøckögAªaUpd©eCom∂ëe.h
"

60 
	~"TøckögAªaUpd©eReje˘.h
"

61 
	~"ExãndedSîvi˚Reque°.h
"

62 
	~"Sîvi˚Reque°.h
"

63 
	~"Sîvi˚Reje˘.h
"

64 
	~"GutiRóŒoˇti⁄Comm™d.h
"

65 
	~"GutiRóŒoˇti⁄Com∂ëe.h
"

66 
	~"Authítiˇti⁄Reque°.h
"

67 
	~"Authítiˇti⁄Re•⁄£.h
"

68 
	~"Authítiˇti⁄Reje˘.h
"

69 
	~"Authítiˇti⁄Faûuª.h
"

70 
	~"IdítôyReque°.h
"

71 
	~"IdítôyRe•⁄£.h
"

72 
	~"NASSecurôyModeComm™d.h
"

73 
	~"NASSecurôyModeCom∂ëe.h
"

74 
	~"SecurôyModeReje˘.h
"

75 
	~"EmmSètus.h
"

76 
	~"EmmInf‹m©i⁄.h
"

77 
	~"Dow∆ökNasTøn•‹t.h
"

78 
	~"U∂ökNasTøn•‹t.h
"

79 
	~"CsSîvi˚NŸifiˇti⁄.h
"

81 
	~<°döt.h
>

96 
emm_msg_hódî_t
 
	mhódî
;

97 
©èch_ªque°_msg
 
	m©èch_ªque°
;

98 
©èch_ac˚±_msg
 
	m©èch_ac˚±
;

99 
©èch_com∂ëe_msg
 
	m©èch_com∂ëe
;

100 
©èch_ªje˘_msg
 
	m©èch_ªje˘
;

101 
dëach_ªque°_msg
 
	mdëach_ªque°
;

102 
dëach_ac˚±_msg
 
	mdëach_ac˚±
;

103 
åackög_¨ó_upd©e_ªque°_msg
 
	måackög_¨ó_upd©e_ªque°
;

104 
åackög_¨ó_upd©e_ac˚±_msg
 
	måackög_¨ó_upd©e_ac˚±
;

105 
åackög_¨ó_upd©e_com∂ëe_msg
 
	måackög_¨ó_upd©e_com∂ëe
;

106 
åackög_¨ó_upd©e_ªje˘_msg
 
	måackög_¨ó_upd©e_ªje˘
;

107 
exãnded_£rvi˚_ªque°_msg
 
	mexãnded_£rvi˚_ªque°
;

108 
£rvi˚_ªque°_msg
 
	m£rvi˚_ªque°
;

109 
£rvi˚_ªje˘_msg
 
	m£rvi˚_ªje˘
;

110 
guti_ªÆloˇti⁄_comm™d_msg
 
	mguti_ªÆloˇti⁄_comm™d
;

111 
guti_ªÆloˇti⁄_com∂ëe_msg
 
	mguti_ªÆloˇti⁄_com∂ëe
;

112 
authítiˇti⁄_ªque°_msg
 
	mauthítiˇti⁄_ªque°
;

113 
authítiˇti⁄_ª•⁄£_msg
 
	mauthítiˇti⁄_ª•⁄£
;

114 
authítiˇti⁄_ªje˘_msg
 
	mauthítiˇti⁄_ªje˘
;

115 
authítiˇti⁄_Áûuª_msg
 
	mauthítiˇti⁄_Áûuª
;

116 
idítôy_ªque°_msg
 
	midítôy_ªque°
;

117 
idítôy_ª•⁄£_msg
 
	midítôy_ª•⁄£
;

118 
£curôy_mode_comm™d_msg
 
	m£curôy_mode_comm™d
;

119 
£curôy_mode_com∂ëe_msg
 
	m£curôy_mode_com∂ëe
;

120 
£curôy_mode_ªje˘_msg
 
	m£curôy_mode_ªje˘
;

121 
emm_°©us_msg
 
	memm_°©us
;

122 
emm_öf‹m©i⁄_msg
 
	memm_öf‹m©i⁄
;

123 
dow∆ök_«s_å™•‹t_msg
 
	mdow∆ök_«s_å™•‹t
;

124 
u∂ök_«s_å™•‹t_msg
 
	mu∂ök_«s_å™•‹t
;

125 
cs_£rvi˚_nŸifiˇti⁄_msg
 
	mcs_£rvi˚_nŸifiˇti⁄
;

126 } 
	tEMM_msg
;

137 
emm_msg_decode
(
EMM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

139 
emm_msg_ícode
(
EMM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/emm/msg/emm_msgDef.h

43 #i‚de‡
__EMM_MSGDEF_H__


44 
	#__EMM_MSGDEF_H__


	)

46 
	~<°döt.h
>

47 
	~<asm/byã‹dî.h
>

54 
	#EMM_HEADER_LENGTH
 (
emm_msg_hódî_t
)

	)

55 
	#EMM_HEADER_MINIMUM_LENGTH
 
EMM_HEADER_LENGTH


	)

56 
	#EMM_HEADER_MAXIMUM_LENGTH
 
EMM_HEADER_LENGTH


	)

59 
	#SECURITY_HEADER_TYPE_NOT_PROTECTED
 0b0000

	)

60 
	#SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED
 0b0001

	)

61 
	#SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED
 0b0010

	)

62 
	#SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_NEW
 0b0011

	)

63 
	#SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED_NEW
 0b0100

	)

64 
	#SECURITY_HEADER_TYPE_SERVICE_REQUEST
 0b1100

	)

67 
	#ATTACH_REQUEST
 0b01000001

	)

68 
	#ATTACH_ACCEPT
 0b01000010

	)

69 
	#ATTACH_COMPLETE
 0b01000011

	)

70 
	#ATTACH_REJECT
 0b01000100

	)

71 
	#DETACH_REQUEST
 0b01000101

	)

72 
	#DETACH_ACCEPT
 0b01000110

	)

73 
	#TRACKING_AREA_UPDATE_REQUEST
 0b01001000

	)

74 
	#TRACKING_AREA_UPDATE_ACCEPT
 0b01001001

	)

75 
	#TRACKING_AREA_UPDATE_COMPLETE
 0b01001010

	)

76 
	#TRACKING_AREA_UPDATE_REJECT
 0b01001011

	)

77 
	#EXTENDED_SERVICE_REQUEST
 0b01001100

	)

78 
	#SERVICE_REJECT
 0b01001110

	)

79 
	#GUTI_REALLOCATION_COMMAND
 0b01010000

	)

80 
	#GUTI_REALLOCATION_COMPLETE
 0b01010001

	)

81 
	#AUTHENTICATION_REQUEST
 0b01010010

	)

82 
	#AUTHENTICATION_RESPONSE
 0b01010011

	)

83 
	#AUTHENTICATION_REJECT
 0b01010100

	)

84 
	#AUTHENTICATION_FAILURE
 0b01011100

	)

85 
	#IDENTITY_REQUEST
 0b01010101

	)

86 
	#IDENTITY_RESPONSE
 0b01010110

	)

87 
	#SECURITY_MODE_COMMAND
 0b01011101

	)

88 
	#SECURITY_MODE_COMPLETE
 0b01011110

	)

89 
	#SECURITY_MODE_REJECT
 0b01011111

	)

90 
	#EMM_STATUS
 0b01100000

	)

91 
	#EMM_INFORMATION
 0b01100001

	)

92 
	#DOWNLINK_NAS_TRANSPORT
 0b01100010

	)

93 
	#UPLINK_NAS_TRANSPORT
 0b01100011

	)

94 
	#CS_SERVICE_NOTIFICATION
 0b01100100

	)

100 
	#SERVICE_REQUEST
 0b01001101

	)

117 #ifde‡
__LITTLE_ENDIAN_BITFIELD


118 
uöt8_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

119 
uöt8_t
 
	m£curôy_hódî_ty≥
:4;

121 #ifde‡
__BIG_ENDIAN_BITFIELD


122 
uöt8_t
 
	m£curôy_hódî_ty≥
:4;

123 
uöt8_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

125 
uöt8_t
 
	mmesßge_ty≥
;

126 }
	t__©åibuã__
((
	t__∑cked__
)Ë
	temm_msg_hódî_t
;

	@src/emm/sap/EmmCommonProcedureInitiated.c

52 #ifde‡
NAS_MME


54 
	~"emm_fsm.h
"

55 
	~"comm⁄Def.h
"

56 
	~"«s_log.h
"

58 
	~"EmmComm⁄.h
"

60 
	~<as£π.h
>

91 
	$EmmComm⁄Pro˚duªInôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

93 
rc
 = 
RETURNîr‹
;

95 
LOG_FUNC_IN
;

97 
	`as£π
(
	`emm_fsm_gë_°©us
(
evt
->
ueid
,

98 
evt
->
˘x
Ë=
EMM_COMMON_PROCEDURE_INITIATED
);

100 
evt
->
¥imôive
) {

101 
_EMMREG_PROC_ABORT
:

105 
rc
 = 
	`emm_¥oc_comm⁄_ab‹t
(
evt
->
ueid
);

108 
_EMMREG_COMMON_PROC_CNF
:

112 i‡(
evt
->
u
.
comm⁄
.
is_©èched
) {

113 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_REGISTERED
);

115 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_DEREGISTERED
);

117 i‡(
rc
 !
RETURNîr‹
) {

118 
rc
 = 
	`emm_¥oc_comm⁄_suc˚ss
(
evt
->
ueid
);

122 
_EMMREG_COMMON_PROC_REJ
:

127 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_DEREGISTERED
);

128 i‡(
rc
 !
RETURNîr‹
) {

129 
rc
 = 
	`emm_¥oc_comm⁄_ªje˘
(
evt
->
ueid
);

133 
_EMMREG_ATTACH_CNF
:

139 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_REGISTERED
);

142 
_EMMREG_ATTACH_REJ
:

147 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_DEREGISTERED
);

150 
_EMMREG_LOWERLAYER_SUCCESS
:

154 
rc
 = 
RETURNok
;

157 
_EMMREG_LOWERLAYER_FAILURE
:

162 
rc
 = 
	`emm_¥oc_comm⁄_Áûuª
(
evt
->
ueid
);

163 i‡(
rc
 !
RETURNîr‹
) {

164 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_DEREGISTERED
);

169 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

170 
evt
->
¥imôive
);

174 
	`LOG_FUNC_RETURN
 (
rc
);

175 
	}
}

	@src/emm/sap/EmmDeregistered.c

58 
	~"emm_fsm.h
"

59 
	~"comm⁄Def.h
"

60 
	~"√tw‹kDef.h
"

61 
	~"«s_log.h
"

63 
	~"emm_¥oc.h
"

65 
	~<as£π.h
>

96 
	$EmmDîegi°îed
(c⁄° 
emm_ªg_t
 *
evt
)

98 
LOG_FUNC_IN
;

100 
rc
 = 
RETURNîr‹
;

102 #ifde‡
NAS_UE


103 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED
);

105 #ifde‡
NAS_MME


106 
	`as£π
(
	`emm_fsm_gë_°©us
(
evt
->
ueid
,Évt->
˘x
Ë=
EMM_DEREGISTERED
);

109 #ifde‡
NAS_UE


111 
rc
 = 
	`emm_¥oc_authítiˇti⁄_dñëe
();

112 i‡(
rc
 !
RETURNok
) {

113 
	`LOG_FUNC_RETURN
 (
rc
);

123 
evt
->
¥imôive
) {

125 #ifde‡
NAS_UE


126 
_EMMREG_NO_IMSI
:

130 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NO_IMSI
);

133 
_EMMREG_REGISTER_REQ
:

138 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_PLMN_SEARCH
);

139 i‡(
rc
 !
RETURNîr‹
) {

141 
rc
 = 
	`emm_fsm_¥o˚ss
(
evt
);

145 
_EMMREG_ATTACH_INIT
:

152 i‡(
evt
->
u
.
©èch
.
is_emîgícy
) {

153 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_LIMITED_SERVICE
);

155 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NORMAL_SERVICE
);

157 i‡(
rc
 !
RETURNîr‹
) {

159 
rc
 = 
	`emm_¥oc_©èch_ª°¨t
();

165 #ifde‡
NAS_MME


166 
_EMMREG_PROC_ABORT
:

170 
rc
 = 
RETURNok
;

173 
_EMMREG_COMMON_PROC_REQ
:

178 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_COMMON_PROCEDURE_INITIATED
);

181 
_EMMREG_ATTACH_CNF
:

187 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_REGISTERED
);

192 
_EMMREG_LOWERLAYER_SUCCESS
:

196 
rc
 = 
RETURNok
;

199 
_EMMREG_LOWERLAYER_FAILURE
:

203 
rc
 = 
RETURNok
;

207 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

208 
evt
->
¥imôive
);

212 #ifde‡
NAS_UE


221 
	`LOG_FUNC_RETURN
 (
rc
);

222 
	}
}

	@src/emm/sap/EmmDeregisteredAttachNeeded.c

53 #ifde‡
NAS_UE


55 
	~"emm_fsm.h
"

56 
	~"comm⁄Def.h
"

57 
	~"«s_log.h
"

59 
	~<as£π.h
>

88 
	$EmmDîegi°îedAâachNìded
(c⁄° 
emm_ªg_t
 *
evt
)

90 
LOG_FUNC_IN
;

92 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_ATTACH_NEEDED
);

96 
	`LOG_FUNC_RETURN
 (
RETURNok
);

97 
	}
}

	@src/emm/sap/EmmDeregisteredAttemptingToAttach.c

51 #ifde‡
NAS_UE


53 
	~"emm_fsm.h
"

54 
	~"comm⁄Def.h
"

55 
	~"«s_log.h
"

57 
	~"emm_¥oc.h
"

59 
	~<as£π.h
>

90 
	$EmmDîegi°îedAâem±ögToAâach
(c⁄° 
emm_ªg_t
 *
evt
)

92 
LOG_FUNC_IN
;

94 
rc
 = 
RETURNîr‹
;

96 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_ATTEMPTING_TO_ATTACH
);

98 
evt
->
¥imôive
) {

99 
_EMMREG_ATTACH_INIT
:

106 i‡(
evt
->
u
.
©èch
.
is_emîgícy
) {

107 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_LIMITED_SERVICE
);

109 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NORMAL_SERVICE
);

111 i‡(
rc
 !
RETURNîr‹
) {

113 
rc
 = 
	`emm_¥oc_©èch_ª°¨t
();

117 
_EMMREG_LOWERLAYER_SUCCESS
:

121 
rc
 = 
	`emm_¥oc_lowîœyî_suc˚ss
();

124 
_EMMREG_LOWERLAYER_FAILURE
:

128 
rc
 = 
	`emm_¥oc_lowîœyî_Áûuª
(
FALSE
);

132 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

133 
evt
->
¥imôive
);

137 
	`LOG_FUNC_RETURN
 (
rc
);

138 
	}
}

	@src/emm/sap/EmmDeregisteredInitiated.c

53 
	~"emm_fsm.h
"

54 
	~"comm⁄Def.h
"

55 
	~"«s_log.h
"

57 
	~"emm_¥oc.h
"

59 
	~<as£π.h
>

88 
	$EmmDîegi°îedInôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

90 
LOG_FUNC_IN
;

92 
rc
 = 
RETURNîr‹
;

94 #ifde‡
NAS_UE


95 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_INITIATED
);

97 #ifde‡
NAS_MME


98 
	`as£π
(
	`emm_fsm_gë_°©us
(
evt
->
ueid
,Évt->
˘x
Ë=
EMM_DEREGISTERED_INITIATED
);

101 
evt
->
¥imôive
) {

102 #ifde‡
NAS_UE


103 
_EMMREG_DETACH_CNF
:

109 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED
);

112 
_EMMREG_DETACH_FAILED
:

116 i‡(
evt
->
u
.
dëach
.
ty≥
 =
EMM_DETACH_TYPE_IMSI
) {

117 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_REGISTERED_NORMAL_SERVICE
);

119 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED
);

123 
_EMMREG_LOWERLAYER_SUCCESS
:

127 
rc
 = 
RETURNok
;

130 
_EMMREG_LOWERLAYER_FAILURE
:

131 
_EMMREG_LOWERLAYER_RELEASE
:

136 
rc
 = 
	`emm_¥oc_lowîœyî_ªÀa£
();

141 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

142 
evt
->
¥imôive
);

146 
	`LOG_FUNC_RETURN
 (
rc
);

147 
	}
}

	@src/emm/sap/EmmDeregisteredLimitedService.c

51 #ifde‡
NAS_UE


53 
	~"emm_fsm.h
"

54 
	~"comm⁄Def.h
"

55 
	~"√tw‹kDef.h
"

56 
	~"«s_log.h
"

58 
	~"emm_¥oc.h
"

60 
	~<as£π.h
>

94 
	$EmmDîegi°îedLimôedSîvi˚
(c⁄° 
emm_ªg_t
 *
evt
)

96 
LOG_FUNC_IN
;

98 
rc
 = 
RETURNîr‹
;

100 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_LIMITED_SERVICE
);

102 
evt
->
¥imôive
) {

103 
_EMMREG_REGISTER_REQ
:

107 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_PLMN_SEARCH
);

108 i‡(
rc
 !
RETURNîr‹
) {

110 
rc
 = 
	`emm_fsm_¥o˚ss
(
evt
);

114 
_EMMREG_ATTACH_INIT
:

118 
rc
 = 
	`emm_¥oc_©èch
(
EMM_ATTACH_TYPE_EMERGENCY
);

121 
_EMMREG_ATTACH_REQ
:

127 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_REGISTERED_INITIATED
);

130 
_EMMREG_LOWERLAYER_SUCCESS
:

135 
rc
 = 
	`emm_¥oc_lowîœyî_suc˚ss
();

138 
_EMMREG_LOWERLAYER_FAILURE
:

142 
rc
 = 
	`emm_¥oc_lowîœyî_Áûuª
(
TRUE
);

145 
_EMMREG_LOWERLAYER_RELEASE
:

149 
rc
 = 
	`emm_¥oc_lowîœyî_ªÀa£
();

153 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

154 
evt
->
¥imôive
);

158 
	`LOG_FUNC_RETURN
 (
rc
);

159 
	}
}

	@src/emm/sap/EmmDeregisteredNoCellAvailable.c

53 #ifde‡
NAS_UE


55 
	~"emm_fsm.h
"

56 
	~"comm⁄Def.h
"

57 
	~"√tw‹kDef.h
"

58 
	~"«s_log.h
"

60 
	~"emm_¥oc.h
"

62 
	~<as£π.h
>

95 
	$EmmDîegi°îedNoCñlAvaûabÀ
(c⁄° 
emm_ªg_t
 *
evt
)

97 
LOG_FUNC_IN
;

99 
rc
 = 
RETURNîr‹
;

101 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_NO_CELL_AVAILABLE
);

103 
evt
->
¥imôive
) {

108 
_EMMREG_REGISTER_REQ
:

112 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_PLMN_SEARCH
);

114 i‡(
rc
 !
RETURNîr‹
) {

119 
rc
 = 
	`emm_¥oc_ªgi°øti⁄_nŸify
(
NET_REG_STATE_ON
);

120 i‡(
rc
 !
RETURNok
) {

121 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - "

127 
rc
 = 
	`emm_¥oc_∂mn_£À˘i⁄
(
evt
->
u
.
ªgi°
.
ödex
);

132 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

133 
evt
->
¥imôive
);

137 
	`LOG_FUNC_RETURN
 (
rc
);

138 
	}
}

	@src/emm/sap/EmmDeregisteredNoImsi.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~<as£π.h
>

89 
	$EmmDîegi°îedNoImsi
(c⁄° 
emm_ªg_t
 *
evt
)

91 
LOG_FUNC_IN
;

93 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_NO_IMSI
);

95 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - USIM isÇotÖresent orÇot valid");

97 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

98 
	}
}

	@src/emm/sap/EmmDeregisteredNormalService.c

52 #ifde‡
NAS_UE


54 
	~"emm_fsm.h
"

55 
	~"comm⁄Def.h
"

56 
	~"√tw‹kDef.h
"

57 
	~"«s_log.h
"

59 
	~"emm_¥oc.h
"

61 
	~<as£π.h
>

94 
	$EmmDîegi°îedN‹mÆSîvi˚
(c⁄° 
emm_ªg_t
 *
evt
)

96 
LOG_FUNC_IN
;

98 
rc
 = 
RETURNîr‹
;

100 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_NORMAL_SERVICE
);

102 
evt
->
¥imôive
) {

103 
_EMMREG_REGISTER_REQ
:

107 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_PLMN_SEARCH
);

108 i‡(
rc
 !
RETURNîr‹
) {

110 
rc
 = 
	`emm_fsm_¥o˚ss
(
evt
);

114 
_EMMREG_ATTACH_INIT
:

118 
rc
 = 
	`emm_¥oc_©èch
(
EMM_ATTACH_TYPE_EPS
);

121 
_EMMREG_ATTACH_REQ
:

127 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_REGISTERED_INITIATED
);

130 
_EMMREG_LOWERLAYER_SUCCESS
:

135 
rc
 = 
	`emm_¥oc_lowîœyî_suc˚ss
();

138 
_EMMREG_LOWERLAYER_FAILURE
:

142 
rc
 = 
	`emm_¥oc_lowîœyî_Áûuª
(
TRUE
);

145 
_EMMREG_LOWERLAYER_RELEASE
:

149 
rc
 = 
	`emm_¥oc_lowîœyî_ªÀa£
();

152 
_EMMREG_ATTACH_CNF
:

158 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_REGISTERED
);

162 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

163 
evt
->
¥imôive
);

167 
	`LOG_FUNC_RETURN
 (
rc
);

168 
	}
}

	@src/emm/sap/EmmDeregisteredPlmnSearch.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"√tw‹kDef.h
"

55 
	~"«s_log.h
"

57 
	~"emm_¥oc.h
"

59 
	~<as£π.h
>

93 
	$EmmDîegi°îedPlmnSórch
(c⁄° 
emm_ªg_t
 *
evt
)

95 
LOG_FUNC_IN
;

97 
rc
 = 
RETURNîr‹
;

99 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_DEREGISTERED_PLMN_SEARCH
);

101 
evt
->
¥imôive
) {

102 
_EMMREG_NO_CELL
:

106 
rc
 = 
	`emm_¥oc_ªgi°øti⁄_nŸify
(
NET_REG_STATE_DENIED
);

107 i‡(
rc
 !
RETURNok
) {

108 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - "

111 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NO_CELL_AVAILABLE
);

114 
_EMMREG_REGISTER_REQ
:

121 
rc
 = 
	`emm_¥oc_ªgi°øti⁄_nŸify
(
NET_REG_STATE_ON
);

122 i‡(
rc
 !
RETURNok
) {

123 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - "

129 
rc
 = 
	`emm_¥oc_∂mn_£À˘i⁄
(
evt
->
u
.
ªgi°
.
ödex
);

132 
_EMMREG_REGISTER_REJ
:

137 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_LIMITED_SERVICE
);

140 
_EMMREG_REGISTER_CNF
:

144 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NORMAL_SERVICE
);

148 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

149 
evt
->
¥imôive
);

153 
	`LOG_FUNC_RETURN
 (
rc
);

154 
	}
}

	@src/emm/sap/EmmNull.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~"emm_¥oc.h
"

58 
	~<as£π.h
>

87 
	$EmmNuŒ
(c⁄° 
emm_ªg_t
 *
evt
)

89 
LOG_FUNC_IN
;

91 
rc
;

93 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_NULL
);

96 
rc
 = 
	`emm_¥oc_authítiˇti⁄_dñëe
();

97 i‡(
rc
 !
RETURNok
) {

98 
	`LOG_FUNC_RETURN
 (
rc
);

101 
evt
->
¥imôive
) {

102 
_EMMREG_S1_ENABLED
:

107 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED
);

113 i‡(
rc
 !
RETURNîr‹
) {

114 
rc
 = 
	`emm_¥oc_öôülize
();

119 
rc
 = 
RETURNîr‹
;

120 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

121 
evt
->
¥imôive
);

122 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - SetÖhone functionnalityÅo "

127 
	`LOG_FUNC_RETURN
 (
rc
);

128 
	}
}

	@src/emm/sap/EmmRegistered.c

55 
	~"emm_fsm.h
"

56 
	~"comm⁄Def.h
"

57 
	~"√tw‹kDef.h
"

58 
	~"«s_log.h
"

60 
	~"emm_¥oc.h
"

62 
	~<as£π.h
>

91 
	$EmmRegi°îed
(c⁄° 
emm_ªg_t
 *
evt
)

93 
LOG_FUNC_IN
;

95 
rc
 = 
RETURNîr‹
;

97 #ifde‡
NAS_UE


98 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED
);

100 #ifde‡
NAS_MME


101 
	`as£π
(
	`emm_fsm_gë_°©us
(
evt
->
ueid
,Évt->
˘x
Ë=
EMM_REGISTERED
);

104 
evt
->
¥imôive
) {

105 #ifde‡
NAS_UE


106 
_EMMREG_DETACH_INIT
:

110 
rc
 = 
	`emm_¥oc_dëach
(
EMM_DETACH_TYPE_EPS
, 
evt
->
u
.
dëach
.
swôch_off
);

113 
_EMMREG_DETACH_REQ
:

119 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_INITIATED
);

122 
_EMMREG_DETACH_CNF
:

127 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED
);

130 
_EMMREG_TAU_REQ
:

134 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Tracking Area UpdateÖrocedure "

138 
_EMMREG_SERVICE_REQ
:

142 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Service RequestÖrocedure "

146 
_EMMREG_LOWERLAYER_SUCCESS
:

150 
rc
 = 
	`emm_¥oc_lowîœyî_suc˚ss
();

153 
_EMMREG_LOWERLAYER_FAILURE
:

157 
rc
 = 
	`emm_¥oc_lowîœyî_Áûuª
(
FALSE
);

160 
_EMMREG_LOWERLAYER_RELEASE
:

164 
rc
 = 
	`emm_¥oc_lowîœyî_ªÀa£
();

168 #ifde‡
NAS_MME


169 
_EMMREG_DETACH_REQ
:

174 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_DEREGISTERED
);

177 
_EMMREG_COMMON_PROC_REQ
:

182 
rc
 = 
	`emm_fsm_£t_°©us
(
evt
->
ueid
,Évt->
˘x
, 
EMM_COMMON_PROCEDURE_INITIATED
);

185 
_EMMREG_TAU_REJ
:

189 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Tracking Area UpdateÖrocedure "

193 
_EMMREG_LOWERLAYER_SUCCESS
:

197 
rc
 = 
RETURNok
;

200 
_EMMREG_LOWERLAYER_FAILURE
:

204 
rc
 = 
RETURNok
;

209 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

210 
evt
->
¥imôive
);

214 
	`LOG_FUNC_RETURN
 (
rc
);

215 
	}
}

	@src/emm/sap/EmmRegisteredAttemptingToUpdate.c

55 #ifde‡
NAS_UE


57 
	~"emm_fsm.h
"

58 
	~"comm⁄Def.h
"

59 
	~"«s_log.h
"

61 
	~<as£π.h
>

90 
	$EmmRegi°îedAâem±ögToUpd©e
(c⁄° 
emm_ªg_t
 *
evt
)

92 
LOG_FUNC_IN
;

94 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_ATTEMPTING_TO_UPDATE
);

98 
	`LOG_FUNC_RETURN
 (
RETURNok
);

99 
	}
}

	@src/emm/sap/EmmRegisteredImsiDetachInitiated.c

54 #ifde‡
NAS_UE


56 
	~"emm_fsm.h
"

57 
	~"comm⁄Def.h
"

58 
	~"«s_log.h
"

60 
	~<as£π.h
>

89 
	$EmmRegi°îedImsiDëachInôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

91 
LOG_FUNC_IN
;

93 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_IMSI_DETACH_INITIATED
);

97 
	`LOG_FUNC_RETURN
 (
RETURNok
);

98 
	}
}

	@src/emm/sap/EmmRegisteredInitiated.c

51 #ifde‡
NAS_UE


53 
	~"emm_fsm.h
"

54 
	~"comm⁄Def.h
"

55 
	~"√tw‹kDef.h
"

56 
	~"«s_log.h
"

58 
	~"emm_¥oc.h
"

60 
	~<as£π.h
>

89 
	$EmmRegi°îedInôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

91 
LOG_FUNC_IN
;

93 
rc
 = 
RETURNîr‹
;

95 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_INITIATED
);

97 
evt
->
¥imôive
) {

98 
_EMMREG_ATTACH_INIT
:

105 i‡(
evt
->
u
.
©èch
.
is_emîgícy
) {

106 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_LIMITED_SERVICE
);

108 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NORMAL_SERVICE
);

110 i‡(
rc
 !
RETURNîr‹
) {

112 
rc
 = 
	`emm_¥oc_©èch_ª°¨t
();

116 
_EMMREG_ATTACH_FAILED
:

122 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_ATTEMPTING_TO_ATTACH
);

125 
_EMMREG_ATTACH_EXCEEDED
:

134 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_ATTEMPTING_TO_ATTACH
);

137 
_EMMREG_ATTACH_CNF
:

142 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_REGISTERED
);

144 i‡(
rc
 !
RETURNîr‹
) {

148 
rc
 = 
	`emm_¥oc_ªgi°øti⁄_nŸify
(
NET_REG_STATE_HN
);

149 i‡(
rc
 !
RETURNok
) {

150 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - "

156 
_EMMREG_AUTH_REJ
:

161 
_EMMREG_ATTACH_REJ
:

166 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED
);

168 i‡(
rc
 !
RETURNîr‹
) {

172 
rc
 = 
	`emm_¥oc_ªgi°øti⁄_nŸify
(
NET_REG_STATE_DENIED
);

173 i‡(
rc
 !
RETURNok
) {

174 
	`LOG_TRACE
(
WARNING
, "EMM-FSM - "

180 
_EMMREG_REGISTER_REQ
:

184 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_PLMN_SEARCH
);

185 i‡(
rc
 !
RETURNîr‹
) {

187 
rc
 = 
	`emm_fsm_¥o˚ss
(
evt
);

191 
_EMMREG_REGISTER_REJ
:

195 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_LIMITED_SERVICE
);

198 
_EMMREG_NO_IMSI
:

203 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_NO_IMSI
);

206 
_EMMREG_DETACH_INIT
:

210 
rc
 = 
	`emm_¥oc_dëach
(
EMM_DETACH_TYPE_EPS
, 
evt
->
u
.
dëach
.
swôch_off
);

213 
_EMMREG_DETACH_REQ
:

219 
rc
 = 
	`emm_fsm_£t_°©us
(
EMM_DEREGISTERED_INITIATED
);

222 
_EMMREG_LOWERLAYER_SUCCESS
:

229 
rc
 = 
	`emm_¥oc_lowîœyî_suc˚ss
();

232 
_EMMREG_LOWERLAYER_FAILURE
:

239 
rc
 = 
	`emm_¥oc_lowîœyî_Áûuª
(
FALSE
);

242 
_EMMREG_LOWERLAYER_RELEASE
:

248 
rc
 = 
	`emm_¥oc_lowîœyî_ªÀa£
();

252 
	`LOG_TRACE
(
ERROR
, "EMM-FSM - Primitive isÇot valid (%d)",

253 
evt
->
¥imôive
);

257 
	`LOG_FUNC_RETURN
 (
rc
);

258 
	}
}

	@src/emm/sap/EmmRegisteredLimitedService.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~<as£π.h
>

85 
	$EmmRegi°îedLimôedSîvi˚
(c⁄° 
emm_ªg_t
 *
evt
)

87 
LOG_FUNC_IN
;

89 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_LIMITED_SERVICE
);

93 
	`LOG_FUNC_RETURN
 (
RETURNok
);

94 
	}
}

	@src/emm/sap/EmmRegisteredNoCellAvailable.c

51 #ifde‡
NAS_UE


53 
	~"emm_fsm.h
"

54 
	~"comm⁄Def.h
"

55 
	~"«s_log.h
"

57 
	~<as£π.h
>

86 
	$EmmRegi°îedNoCñlAvaûabÀ
(c⁄° 
emm_ªg_t
 *
evt
)

88 
LOG_FUNC_IN
;

90 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_NO_CELL_AVAILABLE
);

94 
	`LOG_FUNC_RETURN
 (
RETURNok
);

95 
	}
}

	@src/emm/sap/EmmRegisteredNormalService.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~<as£π.h
>

85 
	$EmmRegi°îedN‹mÆSîvi˚
(c⁄° 
emm_ªg_t
 *
evt
)

87 
LOG_FUNC_IN
;

89 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_NORMAL_SERVICE
);

93 
	`LOG_FUNC_RETURN
 (
RETURNok
);

94 
	}
}

	@src/emm/sap/EmmRegisteredPlmnSearch.c

50 #ifde‡
NAS_UE


52 
	~"emm_fsm.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~<as£π.h
>

85 
	$EmmRegi°îedPlmnSórch
(c⁄° 
emm_ªg_t
 *
evt
)

87 
LOG_FUNC_IN
;

89 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_PLMN_SEARCH
);

93 
	`LOG_FUNC_RETURN
 (
RETURNok
);

94 
	}
}

112 
	$EmmRegi°îedPlmnSórch_xxx
(c⁄° 
emm_ªg_t
 *
evt
)

114 
LOG_FUNC_IN
;

116 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_PLMN_SEARCH
);

120 
	`LOG_FUNC_RETURN
 (
RETURNok
);

121 
	}
}

	@src/emm/sap/EmmRegisteredUpdateNeeded.c

56 #ifde‡
NAS_UE


58 
	~"emm_fsm.h
"

59 
	~"comm⁄Def.h
"

60 
	~"«s_log.h
"

62 
	~<as£π.h
>

91 
	$EmmRegi°îedUpd©eNìded
(c⁄° 
emm_ªg_t
 *
evt
)

93 
LOG_FUNC_IN
;

95 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_REGISTERED_UPDATE_NEEDED
);

99 
	`LOG_FUNC_RETURN
 (
RETURNok
);

100 
	}
}

	@src/emm/sap/EmmServiceRequestInitiated.c

52 #ifde‡
NAS_UE


54 
	~"emm_fsm.h
"

55 
	~"comm⁄Def.h
"

56 
	~"«s_log.h
"

58 
	~<as£π.h
>

87 
	$EmmSîvi˚Reque°Inôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

89 
LOG_FUNC_IN
;

91 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_SERVICE_REQUEST_INITIATED
);

95 
	`LOG_FUNC_RETURN
 (
RETURNok
);

96 
	}
}

	@src/emm/sap/EmmTrackingAreaUpdatingInitiated.c

52 #ifde‡
NAS_UE


54 
	~"emm_fsm.h
"

55 
	~"comm⁄Def.h
"

56 
	~"«s_log.h
"

58 
	~<as£π.h
>

87 
	$EmmTøckögAªaUpd©ögInôüãd
(c⁄° 
emm_ªg_t
 *
evt
)

89 
LOG_FUNC_IN
;

91 
	`as£π
(
	`emm_fsm_gë_°©us
(Ë=
EMM_TRACKING_AREA_UPDATING_INITIATED
);

95 
	`LOG_FUNC_RETURN
 (
RETURNok
);

96 
	}
}

	@src/emm/sap/emm_as.c

49 
	~"emm_as.h
"

50 
	~"emm_ªcv.h
"

51 
	~"emm_£nd.h
"

52 
	~"emmD©a.h
"

53 
	~"comm⁄Def.h
"

54 
	~"«s_log.h
"

56 
	~"TLVDecodî.h
"

57 
	~"as_mesßge.h
"

58 
	~"«s_mesßge.h
"

60 
	~"emm_ˇu£.h
"

61 
	~"LowîLayî.h
"

63 
	~<°rög.h
>

64 
	~<°dlib.h
>

66 #i‡(
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
))

67 
	~"«s_ôti_mesßgög.h
"

74 #ifde‡
NAS_UE


75 
emm_¥oc_∂mn_£À˘i⁄_íd
(
found
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
);

78 
emm_¥oc_°©us
(
ueid
, 
emm_ˇu£
);

87 c⁄° *
	g_emm_as_¥imôive_°r
[] = {

110 
_emm_as_ªcv
(
ueid
, c⁄° *
msg
, 
Àn
,

111 *
emm_ˇu£
);

113 #ifde‡
NAS_UE


114 
_emm_as_e°ablish_˙f
(c⁄° 
emm_as_e°ablish_t
 *
msg
, *
emm_ˇu£
);

115 
_emm_as_e°ablish_ªj
();

116 
_emm_as_ªÀa£_öd
(c⁄° 
emm_as_ªÀa£_t
 *
msg
);

117 
_emm_as_∑ge_öd
(c⁄° 
emm_as_∑ge_t
 *
msg
);

120 #ifde‡
NAS_MME


121 
_emm_as_e°ablish_ªq
(c⁄° 
emm_as_e°ablish_t
 *
msg
, *
emm_ˇu£
);

124 
_emm_as_˚Œ_öfo_ªs
(c⁄° 
emm_as_˚Œ_öfo_t
 *
msg
);

125 
_emm_as_˚Œ_öfo_öd
(c⁄° 
emm_as_˚Œ_öfo_t
 *
msg
);

127 
_emm_as_d©a_öd
(c⁄° 
emm_as_d©a_t
 *
msg
, *
emm_ˇu£
);

133 
EMM_msg
 *
_emm_as_£t_hódî
(
«s_mesßge_t
 *
msg
,

134 c⁄° 
emm_as_£curôy_d©a_t
 *
£curôy
);

136 
_emm_as_ícode
(

137 
as_«s_öfo_t
 *
öfo
,

138 
«s_mesßge_t
 *
msg
,

139 
Àngth
,

140 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
);

142 
_emm_as_í¸y±
(

143 
as_«s_öfo_t
 *
öfo
,

144 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

145 c⁄° *
buf„r
,

146 
Àngth
,

147 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
);

149 
_emm_as_£nd
(c⁄° 
emm_as_t
 *
msg
);

151 #ifde‡
NAS_UE


152 
_emm_as_£curôy_ªs
(c⁄° 
emm_as_£curôy_t
 *,

153 
ul_öfo_å™s„r_ªq_t
 *);

154 
_emm_as_e°ablish_ªq
(c⁄° 
emm_as_e°ablish_t
 *,

155 
«s_e°ablish_ªq_t
 *);

158 #ifde‡
NAS_MME


159 
_emm_as_£curôy_ªq
(c⁄° 
emm_as_£curôy_t
 *,

160 
dl_öfo_å™s„r_ªq_t
 *);

161 
_emm_as_£curôy_ªj
(c⁄° 
emm_as_£curôy_t
 *,

162 
dl_öfo_å™s„r_ªq_t
 *);

163 
_emm_as_e°ablish_˙f
(c⁄° 
emm_as_e°ablish_t
 *,

164 
«s_e°ablish_r•_t
 *);

165 
_emm_as_e°ablish_ªj
(c⁄° 
emm_as_e°ablish_t
 *,

166 
«s_e°ablish_r•_t
 *);

167 
_emm_as_∑ge_öd
(c⁄° 
emm_as_∑ge_t
 *, 
∑gög_ªq_t
 *);

170 
_emm_as_˚Œ_öfo_ªq
(c⁄° 
emm_as_˚Œ_öfo_t
 *, 
˚Œ_öfo_ªq_t
 *);

172 
_emm_as_d©a_ªq
(c⁄° 
emm_as_d©a_t
 *, 
ul_öfo_å™s„r_ªq_t
 *);

173 
_emm_as_°©us_öd
(c⁄° 
emm_as_°©us_t
 *, 
ul_öfo_å™s„r_ªq_t
 *);

174 
_emm_as_ªÀa£_ªq
(c⁄° 
emm_as_ªÀa£_t
 *, 
«s_ªÀa£_ªq_t
 *);

194 
	$emm_as_öôülize
()

196 
LOG_FUNC_IN
;

200 
LOG_FUNC_OUT
;

201 
	}
}

217 
	$emm_as_£nd
(c⁄° 
emm_as_t
 *
msg
)

219 
LOG_FUNC_IN
;

221 
rc
;

222 
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

223 
emm_as_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

225 
UI¡32_t
 
ueid
 = 0;

227 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - ReceivedÖrimitive %s (%d)",

228 
_emm_as_¥imôive_°r
[
¥imôive
 - 
_EMMAS_START
 - 1],Örimitive);

230 
¥imôive
) {

231 
_EMMAS_DATA_IND
:

232 
rc
 = 
	`_emm_as_d©a_öd
(&
msg
->
u
.
d©a
, &
emm_ˇu£
);

233 
ueid
 = 
msg
->
u
.
d©a
.ueid;

236 #ifde‡
NAS_UE


237 
_EMMAS_ESTABLISH_CNF
:

238 
rc
 = 
	`_emm_as_e°ablish_˙f
(&
msg
->
u
.
e°ablish
, &
emm_ˇu£
);

241 
_EMMAS_ESTABLISH_REJ
:

242 
rc
 = 
	`_emm_as_e°ablish_ªj
();

245 
_EMMAS_RELEASE_IND
:

246 
rc
 = 
	`_emm_as_ªÀa£_öd
(&
msg
->
u
.
ªÀa£
);

249 
_EMMAS_PAGE_IND
:

250 
rc
 = 
	`_emm_as_∑ge_öd
(&
msg
->
u
.
∑ge
);

253 #ifde‡
NAS_MME


254 
_EMMAS_ESTABLISH_REQ
:

255 
rc
 = 
	`_emm_as_e°ablish_ªq
(&
msg
->
u
.
e°ablish
, &
emm_ˇu£
);

256 
ueid
 = 
msg
->
u
.
e°ablish
.ueid;

259 
_EMMAS_CELL_INFO_RES
:

260 
rc
 = 
	`_emm_as_˚Œ_öfo_ªs
(&
msg
->
u
.
˚Œ_öfo
);

263 
_EMMAS_CELL_INFO_IND
:

264 
rc
 = 
	`_emm_as_˚Œ_öfo_öd
(&
msg
->
u
.
˚Œ_öfo
);

269 
rc
 = 
	`_emm_as_£nd
(
msg
);

270 i‡(
rc
 !
RETURNok
) {

271 
	`LOG_TRACE
(
ERROR
, "EMMAS-SAP - "

273 
_emm_as_¥imôive_°r
[
¥imôive
 - 
_EMMAS_START
 - 1],

274 
¥imôive
);

275 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

281 i‡(
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

284 i‡(
rc
 =
TLV_DECODE_BUFFER_TOO_SHORT
) {

285 
	`LOG_FUNC_RETURN
 (
RETURNok
);

289 i‡(
rc
 =
TLV_DECODE_PROTOCOL_NOT_SUPPORTED
) {

290 
	`LOG_FUNC_RETURN
 (
RETURNok
);

291 } i‡(
rc
 =
TLV_DECODE_WRONG_MESSAGE_TYPE
) {

292 
emm_ˇu£
 = 
EMM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
;

295 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Received EMM message isÇot valid "

296 "(ˇu£=%d)", 
emm_ˇu£
);

298 
rc
 = 
	`emm_¥oc_°©us
(
ueid
, 
emm_ˇu£
);

301 i‡(
rc
 !
RETURNok
) {

302 
	`LOG_TRACE
(
ERROR
, "EMMAS-SAP - FailedÅoÖrocessÖrimitive %s (%d)",

303 
_emm_as_¥imôive_°r
[
¥imôive
 - 
_EMMAS_START
 - 1],

304 
¥imôive
);

307 
	`LOG_FUNC_RETURN
 (
rc
);

308 
	}
}

338 
	$_emm_as_ªcv
(
ueid
, c⁄° *
msg
, 
Àn
,

339 *
emm_ˇu£
)

341 
LOG_FUNC_IN
;

343 
decodî_rc
;

344 
rc
 = 
RETURNîr‹
;

346 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Re˚ived EMM mesßgê÷ígth=%d)", 
Àn
);

348 
«s_mesßge_t
 
«s_msg
;

349 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

351 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

352 #i‡
	`deföed
(
NAS_MME
)

353 #i‡
	`deföed
(
EPC_BUILD
)

354 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

357 #i‡
	`deföed
(
EPC_BUILD
)

358 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
ueid
);

359 i‡(
emm_˘x
) {

360 
£curôy
 = 
emm_˘x
->security;

363 i‡(
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

364 
emm_˘x
 = 
_emm_d©a
.
˘x
[
ueid
];

365 i‡(
emm_˘x
) {

366 
£curôy
 = 
emm_˘x
->security;

371 
£curôy
 = 
_emm_d©a
.security;

375 
decodî_rc
 = 
	`«s_mesßge_decode
(
msg
, &
«s_msg
, 
Àn
, 
£curôy
);

377 i‡(
decodî_rc
 < 0) {

378 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - FailedÅo decode NAS message "

379 "”º=%d)", 
decodî_rc
);

380 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

381 
	`LOG_FUNC_RETURN
 (
decodî_rc
);

385 
EMM_msg
 *
emm_msg
 = &
«s_msg
.
∂aö
.
emm
;

386 
emm_msg
->
hódî
.
mesßge_ty≥
) {

387 
EMM_STATUS
:

388 
rc
 = 
	`emm_ªcv_°©us
(
ueid
, &
emm_msg
->
emm_°©us
, 
emm_ˇu£
);

391 #ifde‡
NAS_UE


392 
IDENTITY_REQUEST
:

393 
rc
 = 
	`emm_ªcv_idítôy_ªque°
(&
emm_msg
->
idítôy_ªque°
,

394 
emm_ˇu£
);

397 
AUTHENTICATION_REQUEST
:

398 
rc
 = 
	`emm_ªcv_authítiˇti⁄_ªque°
(

399 &
emm_msg
->
authítiˇti⁄_ªque°
,

400 
emm_ˇu£
);

403 
AUTHENTICATION_REJECT
:

404 
rc
 = 
	`emm_ªcv_authítiˇti⁄_ªje˘
(

405 &
emm_msg
->
authítiˇti⁄_ªje˘
,

406 
emm_ˇu£
);

409 
SECURITY_MODE_COMMAND
:

410 
rc
 = 
	`emm_ªcv_£curôy_mode_comm™d
(

411 &
emm_msg
->
£curôy_mode_comm™d
,

412 
emm_ˇu£
);

415 
DETACH_ACCEPT
:

416 
rc
 = 
	`emm_ªcv_dëach_ac˚±
(&
emm_msg
->
dëach_ac˚±
, 
emm_ˇu£
);

420 #ifde‡
NAS_UE


421 
TRACKING_AREA_UPDATE_ACCEPT
:

422 
TRACKING_AREA_UPDATE_REJECT
:

423 
SERVICE_REJECT
:

424 
GUTI_REALLOCATION_COMMAND
:

425 
EMM_INFORMATION
:

426 
DOWNLINK_NAS_TRANSPORT
:

427 
CS_SERVICE_NOTIFICATION
:

431 #ifde‡
NAS_MME


432 
ATTACH_REQUEST
:

433 
rc
 = 
	`emm_ªcv_©èch_ªque°
(

434 
ueid
,

435 &
emm_msg
->
©èch_ªque°
,

436 
emm_ˇu£
);

439 
IDENTITY_RESPONSE
:

440 
rc
 = 
	`emm_ªcv_idítôy_ª•⁄£
(

441 
ueid
,

442 &
emm_msg
->
idítôy_ª•⁄£
,

443 
emm_ˇu£
);

446 
AUTHENTICATION_RESPONSE
:

447 
rc
 = 
	`emm_ªcv_authítiˇti⁄_ª•⁄£
(

448 
ueid
,

449 &
emm_msg
->
authítiˇti⁄_ª•⁄£
,

450 
emm_ˇu£
);

453 
AUTHENTICATION_FAILURE
:

454 
rc
 = 
	`emm_ªcv_authítiˇti⁄_Áûuª
(

455 
ueid
,

456 &
emm_msg
->
authítiˇti⁄_Áûuª
,

457 
emm_ˇu£
);

460 
SECURITY_MODE_COMPLETE
:

461 
rc
 = 
	`emm_ªcv_£curôy_mode_com∂ëe
(

462 
ueid
,

463 &
emm_msg
->
£curôy_mode_com∂ëe
,

464 
emm_ˇu£
);

467 
SECURITY_MODE_REJECT
:

468 
rc
 = 
	`emm_ªcv_£curôy_mode_ªje˘
(
ueid
,

469 &
emm_msg
->
£curôy_mode_ªje˘
,

470 
emm_ˇu£
);

473 
ATTACH_COMPLETE
:

474 
rc
 = 
	`emm_ªcv_©èch_com∂ëe
(
ueid
, &
emm_msg
->
©èch_com∂ëe
,

475 
emm_ˇu£
);

478 
TRACKING_AREA_UPDATE_COMPLETE
:

479 
GUTI_REALLOCATION_COMPLETE
:

480 
UPLINK_NAS_TRANSPORT
:

484 
DETACH_REQUEST
:

485 
rc
 = 
	`emm_ªcv_dëach_ªque°
(
ueid
, &
emm_msg
->
dëach_ªque°
,

486 
emm_ˇu£
);

491 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - EMM message 0x%x isÇot valid",

492 
emm_msg
->
hódî
.
mesßge_ty≥
);

493 *
emm_ˇu£
 = 
EMM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

497 
	`LOG_FUNC_RETURN
 (
rc
);

498 
	}
}

517 
	$_emm_as_d©a_öd
(c⁄° 
emm_as_d©a_t
 *
msg
, *
emm_ˇu£
)

519 
LOG_FUNC_IN
;

521 
rc
 = 
RETURNîr‹
;

523 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS dataÅransfer indication "

524 "(ueid=%u, dñivîed=%s,Üígth=%d)", 
msg
->
ueid
,

525 (
msg
->
dñivîed
)? "TRUE" : "FALSE", msg->
NASmsg
.
Àngth
);

527 i‡(
msg
->
dñivîed
) {

528 i‡(
msg
->
NASmsg
.
Àngth
 > 0) {

530 *
∂aö_msg
 = (*)
	`mÆloc
(
msg
->
NASmsg
.
Àngth
);

531 i‡(
∂aö_msg
) {

532 
«s_mesßge_£curôy_hódî_t
 
hódî
;

533 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

535 
	`mem£t
(&
hódî
, 0, (header));

537 #i‡
	`deföed
(
NAS_MME
)

538 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

539 #i‡
	`deföed
(
EPC_BUILD
)

540 i‡(
msg
->
ueid
 > 0) {

541 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

542 i‡(
emm_˘x
) {

543 
£curôy
 = 
emm_˘x
->security;

547 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

548 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

549 i‡(
emm_˘x
) {

550 
£curôy
 = 
emm_˘x
->security;

555 
£curôy
 = 
_emm_d©a
.security;

557 
byãs
 = 
	`«s_mesßge_de¸y±
((*)(
msg
->
NASmsg
.
vÆue
),

558 
∂aö_msg
,

559 &
hódî
,

560 
msg
->
NASmsg
.
Àngth
,

561 
£curôy


563 i‡(
byãs
 < 0) {

565 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

566 
	`LOG_FUNC_RETURN
 (
byãs
);

567 } i‡(
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 ==

568 
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

570 
rc
 = 
	`_emm_as_ªcv
(
msg
->
ueid
, 
∂aö_msg
, 
byãs
, 
emm_ˇu£
);

571 } i‡(
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 ==

572 
EPS_SESSION_MANAGEMENT_MESSAGE
) {

573 c⁄° 
O˘ëSåög
 
d©a
 = {
byãs
, (
uöt8_t
 *)
∂aö_msg
};

575 
rc
 = 
	`lowîœyî_d©a_öd
(
msg
->
ueid
, &
d©a
);

577 
	`‰ì
(
∂aö_msg
);

581 
rc
 = 
	`lowîœyî_suc˚ss
(
msg
->
ueid
);

585 
rc
 = 
	`lowîœyî_Áûuª
(
msg
->
ueid
);

588 
	`LOG_FUNC_RETURN
 (
rc
);

589 
	}
}

591 #ifde‡
NAS_UE


609 
	$_emm_as_e°ablish_˙f
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

610 *
emm_ˇu£
)

612 
LOG_FUNC_IN
;

614 
decodî_rc
;

615 
rc
 = 
RETURNîr‹
;

617 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS connectionÉstablish confirm");

619 i‡(
msg
->
NASmsg
.
Àngth
 > 0) {

621 (Ë
	`lowîœyî_e°ablish
();

625 
rc
 = 
	`lowîœyî_suc˚ss
(0);

626 
	`LOG_FUNC_RETURN
 (
rc
);

629 
«s_mesßge_t
 
«s_msg
;

630 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

633 
decodî_rc
 = 
	`«s_mesßge_decode
((*)(
msg
->
NASmsg
.
vÆue
),

634 &
«s_msg
,

635 
msg
->
NASmsg
.
Àngth
,

636 
_emm_d©a
.
£curôy
);

638 i‡(
decodî_rc
 < 0) {

639 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - FailedÅo decode initial NAS message"

640 "”º=%d)", 
decodî_rc
);

641 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

642 
	`LOG_FUNC_RETURN
 (
decodî_rc
);

646 
EMM_msg
 *
emm_msg
 = &
«s_msg
.
∂aö
.
emm
;

647 
emm_msg
->
hódî
.
mesßge_ty≥
) {

648 
ATTACH_ACCEPT
:

649 
rc
 = 
	`emm_ªcv_©èch_ac˚±
(&
emm_msg
->
©èch_ac˚±
, 
emm_ˇu£
);

652 
ATTACH_REJECT
:

653 
rc
 = 
	`emm_ªcv_©èch_ªje˘
(&
emm_msg
->
©èch_ªje˘
, 
emm_ˇu£
);

656 
DETACH_ACCEPT
:

659 
TRACKING_AREA_UPDATE_ACCEPT
:

663 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Initial NAS message 0x%x is "

664 "nŸ vÆid", 
emm_msg
->
hódî
.
mesßge_ty≥
);

665 *
emm_ˇu£
 = 
EMM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

669 
	`LOG_FUNC_RETURN
 (
rc
);

670 
	}
}

689 
	$_emm_as_e°ablish_ªj
()

691 
LOG_FUNC_IN
;

693 
rc
;

695 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS initial NAS messageÅransmission "

699 
rc
 = 
	`lowîœyî_Áûuª
(0);

701 
	`LOG_FUNC_RETURN
 (
rc
);

702 
	}
}

721 
	$_emm_as_ªÀa£_öd
(c⁄° 
emm_as_ªÀa£_t
 *
msg
)

723 
LOG_FUNC_IN
;

725 
rc
 = 
RETURNok
;

727 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS connectionÑelease indication "

728 "(ˇu£=%d)", 
msg
->
ˇu£
);

731 
rc
 = 
	`lowîœyî_ªÀa£
(
msg
->
ˇu£
);

733 
	`LOG_FUNC_RETURN
 (
rc
);

734 
	}
}

752 
	$_emm_as_∑ge_öd
(c⁄° 
emm_as_∑ge_t
 *
msg
)

754 
LOG_FUNC_IN
;

756 
rc
 = 
RETURNok
;

758 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received ASÖaging data indication");

762 
	`LOG_FUNC_RETURN
 (
rc
);

763 
	}
}

767 #ifde‡
NAS_MME


788 
	$_emm_as_e°ablish_ªq
(c⁄° 
emm_as_e°ablish_t
 *
msg
, *
emm_ˇu£
)

790 
LOG_FUNC_IN
;

792 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

793 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

794 
decodî_rc
;

795 
rc
 = 
RETURNîr‹
;

797 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS connectionÉstablishÑequest");

799 
«s_mesßge_t
 
«s_msg
;

800 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

802 #i‡
	`deföed
(
NAS_MME
)

803 #i‡
	`deföed
(
EPC_BUILD
)

804 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

806 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

807 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

810 i‡(
emm_˘x
) {

811 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

814 
£curôy
 = 
_emm_d©a
.security;

819 
decodî_rc
 = 
	`«s_mesßge_decode
(

820 (*)(
msg
->
NASmsg
.
vÆue
),

821 &
«s_msg
,

822 
msg
->
NASmsg
.
Àngth
,

823 
emm_£curôy_c⁄ãxt
);

825 i‡(
decodî_rc
 < 
TLV_DECODE_FATAL_ERROR
) {

826 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

827 
	`LOG_FUNC_RETURN
 (
decodî_rc
);

828 } i‡(
decodî_rc
 =
TLV_DECODE_UNEXPECTED_IEI
) {

829 *
emm_ˇu£
 = 
EMM_CAUSE_IE_NOT_IMPLEMENTED
;

830 } i‡(
decodî_rc
 < 0) {

831 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

835 
EMM_msg
 *
emm_msg
 = &
«s_msg
.
∂aö
.
emm
;

836 
emm_msg
->
hódî
.
mesßge_ty≥
) {

837 
ATTACH_REQUEST
:

838 
rc
 = 
	`emm_ªcv_©èch_ªque°
(

839 
msg
->
ueid
,

840 &
emm_msg
->
©èch_ªque°
,

841 
emm_ˇu£
);

844 
DETACH_REQUEST
:

845 
rc
 = 
RETURNok
;

848 
TRACKING_AREA_UPDATE_REQUEST
:

849 
rc
 = 
	`emm_ªcv_åackög_¨ó_upd©e_ªque°
(

850 
msg
->
ueid
,

851 &
emm_msg
->
åackög_¨ó_upd©e_ªque°
,

852 
emm_ˇu£
);

855 
SERVICE_REQUEST
:

856 
rc
 = 
RETURNok
;

859 
EXTENDED_SERVICE_REQUEST
:

860 
rc
 = 
RETURNok
;

864 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Initial NAS message 0x%x is "

865 "nŸ vÆid", 
emm_msg
->
hódî
.
mesßge_ty≥
);

866 *
emm_ˇu£
 = 
EMM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

870 
	`LOG_FUNC_RETURN
 (
rc
);

871 
	}
}

895 
	$_emm_as_˚Œ_öfo_ªs
(c⁄° 
emm_as_˚Œ_öfo_t
 *
msg
)

897 
LOG_FUNC_IN
;

899 
rc
 = 
RETURNok
;

901 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS cell informationÑesponse");

903 #ifde‡
NAS_UE


904 
AcT
 = 
NET_ACCESS_EUTRAN
;

905 i‡(
msg
->
found
 =
TRUE
) {

907 
AcT
 !
NET_ACCESS_UNAVAILABLE
) {

908 i‡(
msg
->
øt
 & (1 << 
AcT
)) {

911 
AcT
 -= 1;

915 
rc
 = 
	`emm_¥oc_∂mn_£À˘i⁄_íd
(
msg
->
found
, msg->
èc
, msg->
˚ŒID
, 
AcT
);

918 
	`LOG_FUNC_RETURN
 (
rc
);

919 
	}
}

938 
	$_emm_as_˚Œ_öfo_öd
(c⁄° 
emm_as_˚Œ_öfo_t
 *
msg
)

940 
LOG_FUNC_IN
;

942 
rc
 = 
RETURNok
;

944 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received AS cell information indication");

948 
	`LOG_FUNC_RETURN
 (
rc
);

949 
	}
}

975 
EMM_msg
 *
	$_emm_as_£t_hódî
(
«s_mesßge_t
 *
msg
,

976 c⁄° 
emm_as_£curôy_d©a_t
 *
£curôy
)

978 
LOG_FUNC_IN
;

980 
msg
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 = 
EPS_MOBILITY_MANAGEMENT_MESSAGE
;

982 i‡–
£curôy
 && (£curôy->
ksi
 !
EMM_AS_NO_KEY_AVAILABLE
) ) {

984 i‡(
£curôy
->
is_√w
) {

986 i‡(
£curôy
->
k_öt
) {

987 i‡(
£curôy
->
k_íc
) {

989 
msg
->
hódî
.
£curôy_hódî_ty≥
 =

990 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED_NEW
;

993 
msg
->
hódî
.
£curôy_hódî_ty≥
 =

994 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_NEW
;

996 
	`LOG_FUNC_RETURN
 (&
msg
->
£curôy_¥Ÿe˘ed
.
∂aö
.
emm
);

998 } i‡(
£curôy
->
k_öt
) {

999 i‡(
£curôy
->
k_íc
) {

1001 
msg
->
hódî
.
£curôy_hódî_ty≥
 =

1002 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED_CYPHERED
;

1005 
msg
->
hódî
.
£curôy_hódî_ty≥
 =

1006 
SECURITY_HEADER_TYPE_INTEGRITY_PROTECTED
;

1008 
	`LOG_FUNC_RETURN
 (&
msg
->
£curôy_¥Ÿe˘ed
.
∂aö
.
emm
);

1011 
msg
->
hódî
.
£curôy_hódî_ty≥
 = 
SECURITY_HEADER_TYPE_NOT_PROTECTED
;

1012 
	`LOG_FUNC_RETURN
 (&
msg
->
∂aö
.
emm
);

1016 
msg
->
hódî
.
£curôy_hódî_ty≥
 = 
SECURITY_HEADER_TYPE_NOT_PROTECTED
;

1017 
	`LOG_FUNC_RETURN
 (&
msg
->
∂aö
.
emm
);

1022 
	`LOG_FUNC_RETURN
 (
NULL
);

1023 
	}
}

1042 
	$_emm_as_ícode
(

1043 
as_«s_öfo_t
 *
öfo
,

1044 
«s_mesßge_t
 *
msg
,

1045 
Àngth
,

1046 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
)

1048 
LOG_FUNC_IN
;

1050 
byãs
 = 0;

1052 i‡(
msg
->
hódî
.
£curôy_hódî_ty≥
 !
SECURITY_HEADER_TYPE_NOT_PROTECTED
)

1054 
emm_msg_hódî_t
 *
hódî
 = &
msg
->
£curôy_¥Ÿe˘ed
.
∂aö
.
emm
.header;

1056 
Àngth
 +
NAS_MESSAGE_SECURITY_HEADER_SIZE
;

1058 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 = 
EPS_MOBILITY_MANAGEMENT_MESSAGE
;

1059 
hódî
->
£curôy_hódî_ty≥
 = 
SECURITY_HEADER_TYPE_NOT_PROTECTED
;

1062 
öfo
->
d©a
 = (
Byã_t
 *)
	`mÆloc
(
Àngth
 * (Byte_t));

1063 i‡(
öfo
->
d©a
 !
NULL
) {

1065 
byãs
 = 
	`«s_mesßge_ícode
(

1066 (*)(
öfo
->
d©a
),

1067 
msg
,

1068 
Àngth
,

1069 
emm_£curôy_c⁄ãxt
);

1071 i‡(
byãs
 > 0) {

1072 
öfo
->
Àngth
 = 
byãs
;

1074 
	`‰ì
(
öfo
->
d©a
);

1075 
öfo
->
Àngth
 = 0;

1076 
öfo
->
d©a
 = 
NULL
;

1080 
	`LOG_FUNC_RETURN
 (
byãs
);

1081 
	}
}

1100 
	$_emm_as_í¸y±
(

1101 
as_«s_öfo_t
 *
öfo
,

1102 c⁄° 
«s_mesßge_£curôy_hódî_t
 *
hódî
,

1103 c⁄° *
msg
,

1104 
Àngth
,

1105 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
)

1107 
LOG_FUNC_IN
;

1109 
byãs
 = 0;

1111 i‡(
hódî
->
£curôy_hódî_ty≥
 !
SECURITY_HEADER_TYPE_NOT_PROTECTED
) {

1113 
Àngth
 +
NAS_MESSAGE_SECURITY_HEADER_SIZE
;

1116 
öfo
->
d©a
 = (
Byã_t
 *)
	`mÆloc
(
Àngth
 * (Byte_t));

1117 i‡(
öfo
->
d©a
 !
NULL
) {

1119 
byãs
 = 
	`«s_mesßge_í¸y±
(

1120 
msg
,

1121 (*)(
öfo
->
d©a
),

1122 
hódî
,

1123 
Àngth
,

1124 
emm_£curôy_c⁄ãxt
);

1126 i‡(
byãs
 > 0) {

1127 
öfo
->
Àngth
 = 
byãs
;

1129 
	`‰ì
(
öfo
->
d©a
);

1130 
öfo
->
Àngth
 = 0;

1131 
öfo
->
d©a
 = 
NULL
;

1135 
	`LOG_FUNC_RETURN
 (
byãs
);

1136 
	}
}

1154 
	$_emm_as_£nd
(c⁄° 
emm_as_t
 *
msg
)

1156 
LOG_FUNC_IN
;

1158 
as_mesßge_t
 
as_msg
;

1159 
	`mem£t
(&
as_msg
, 0 , (
as_mesßge_t
));

1161 
msg
->
¥imôive
) {

1162 
_EMMAS_DATA_REQ
:

1163 
as_msg
.
msgID
 = 
	`_emm_as_d©a_ªq
(

1164 &
msg
->
u
.
d©a
,

1165 &
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
);

1168 
_EMMAS_STATUS_IND
:

1169 
as_msg
.
msgID
 = 
	`_emm_as_°©us_öd
(

1170 &
msg
->
u
.
°©us
,

1171 &
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
);

1174 
_EMMAS_RELEASE_REQ
:

1175 
as_msg
.
msgID
 = 
	`_emm_as_ªÀa£_ªq
(

1176 &
msg
->
u
.
ªÀa£
,

1177 &
as_msg
.
msg
.
«s_ªÀa£_ªq
);

1180 #ifde‡
NAS_UE


1181 
_EMMAS_SECURITY_RES
:

1182 
as_msg
.
msgID
 = 
	`_emm_as_£curôy_ªs
(

1183 &
msg
->
u
.
£curôy
,

1184 &
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
);

1187 
_EMMAS_ESTABLISH_REQ
:

1188 
as_msg
.
msgID
 = 
	`_emm_as_e°ablish_ªq
(

1189 &
msg
->
u
.
e°ablish
,

1190 &
as_msg
.
msg
.
«s_e°ablish_ªq
);

1194 #ifde‡
NAS_MME


1195 
_EMMAS_SECURITY_REQ
:

1196 
as_msg
.
msgID
 = 
	`_emm_as_£curôy_ªq
(

1197 &
msg
->
u
.
£curôy
,

1198 &
as_msg
.
msg
.
dl_öfo_å™s„r_ªq
);

1201 
_EMMAS_SECURITY_REJ
:

1202 
as_msg
.
msgID
 = 
	`_emm_as_£curôy_ªj
(

1203 &
msg
->
u
.
£curôy
,

1204 &
as_msg
.
msg
.
dl_öfo_å™s„r_ªq
);

1207 
_EMMAS_ESTABLISH_CNF
:

1208 
as_msg
.
msgID
 = 
	`_emm_as_e°ablish_˙f
(

1209 &
msg
->
u
.
e°ablish
,

1210 &
as_msg
.
msg
.
«s_e°ablish_r•
);

1213 
_EMMAS_ESTABLISH_REJ
:

1214 
as_msg
.
msgID
 = 
	`_emm_as_e°ablish_ªj
(

1215 &
msg
->
u
.
e°ablish
,

1216 &
as_msg
.
msg
.
«s_e°ablish_r•
);

1219 
_EMMAS_PAGE_IND
:

1220 
as_msg
.
msgID
 = 
	`_emm_as_∑ge_öd
(&
msg
->
u
.
∑ge
,

1221 &
as_msg
.
msg
.
∑gög_ªq
);

1225 
_EMMAS_CELL_INFO_REQ
:

1226 
as_msg
.
msgID
 = 
	`_emm_as_˚Œ_öfo_ªq
(&
msg
->
u
.
˚Œ_öfo
,

1227 &
as_msg
.
msg
.
˚Œ_öfo_ªq
);

1235 
as_msg
.
msgID
 = 0;

1240 i‡(
as_msg
.
msgID
 > 0) {

1241 #i‡
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

1242 
	`LOG_TRACE
(
DEBUG
, "EMMAS-SAP - "

1244 
as_msg
.
msgID
,

1245 
_emm_as_¥imôive_°r
[
msg
->
¥imôive
 - 
_EMMAS_START
 - 1],

1246 
msg
->
¥imôive
);

1248 
as_msg
.
msgID
) {

1249 
AS_DL_INFO_TRANSFER_REQ
: {

1250 
	`«s_ôti_dl_d©a_ªq
(

1251 
as_msg
.
msg
.
dl_öfo_å™s„r_ªq
.
UEid
,

1252 
as_msg
.
msg
.
dl_öfo_å™s„r_ªq
.
«sMsg
.
d©a
,

1253 
as_msg
.
msg
.
dl_öfo_å™s„r_ªq
.
«sMsg
.
Àngth
);

1254 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1257 
AS_NAS_ESTABLISH_RSP
:

1258 
AS_NAS_ESTABLISH_CNF
: {

1259 i‡(
as_msg
.
msg
.
«s_e°ablish_r•
.
îrCode
 !
AS_SUCCESS
) {

1260 
	`«s_ôti_dl_d©a_ªq
(

1261 
as_msg
.
msg
.
«s_e°ablish_r•
.
UEid
,

1262 
as_msg
.
msg
.
«s_e°ablish_r•
.
«sMsg
.
d©a
,

1263 
as_msg
.
msg
.
«s_e°ablish_r•
.
«sMsg
.
Àngth
);

1264 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1266 
	`LOG_TRACE
(
DEBUG
, "EMMAS-SAP - "

1270 
as_msg
.
msg
.
«s_e°ablish_r•
.
UEid
,

1271 
as_msg
.
msg
.
«s_e°ablish_r•
.
£À˘ed_í¸y±i⁄_Æg‹ôhm
,

1272 
as_msg
.
msg
.
«s_e°ablish_r•
.
£À˘ed_öãgrôy_Æg‹ôhm
);

1274 
	`«s_ôti_e°ablish_˙f
(

1275 
as_msg
.
msg
.
«s_e°ablish_r•
.
UEid
,

1276 
as_msg
.
msg
.
«s_e°ablish_r•
.
îrCode
,

1277 
as_msg
.
msg
.
«s_e°ablish_r•
.
«sMsg
.
d©a
,

1278 
as_msg
.
msg
.
«s_e°ablish_r•
.
«sMsg
.
Àngth
,

1279 
as_msg
.
msg
.
«s_e°ablish_r•
.
£À˘ed_í¸y±i⁄_Æg‹ôhm
,

1280 
as_msg
.
msg
.
«s_e°ablish_r•
.
£À˘ed_öãgrôy_Æg‹ôhm
);

1281 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1289 #i‡
	`deföed
(
UE_BUILD
Ë&& deföed(
NAS_UE
)

1290 
	`LOG_TRACE
(
DEBUG
, "EMMAS-SAP - "

1292 
as_msg
.
msgID
,

1293 
_emm_as_¥imôive_°r
[
msg
->
¥imôive
 - 
_EMMAS_START
 - 1],

1294 
msg
->
¥imôive
);

1296 
as_msg
.
msgID
) {

1297 
AS_CELL_INFO_REQ
: {

1298 
	`«s_ôti_˚Œ_öfo_ªq
(

1299 
as_msg
.
msg
.
˚Œ_öfo_ªq
.
∂mnID
,

1300 
as_msg
.
msg
.
˚Œ_öfo_ªq
.
øt
);

1301 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1304 
AS_NAS_ESTABLISH_REQ
: {

1305 
	`«s_ôti_«s_e°ablish_ªq
(

1306 
as_msg
.
msg
.
«s_e°ablish_ªq
.
ˇu£
,

1307 
as_msg
.
msg
.
«s_e°ablish_ªq
.
ty≥
,

1308 
as_msg
.
msg
.
«s_e°ablish_ªq
.
s_tmsi
,

1309 
as_msg
.
msg
.
«s_e°ablish_ªq
.
∂mnID
,

1310 
as_msg
.
msg
.
«s_e°ablish_ªq
.
öôülNasMsg
.
d©a
,

1311 
as_msg
.
msg
.
«s_e°ablish_ªq
.
öôülNasMsg
.
Àngth
);

1312 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1315 
AS_UL_INFO_TRANSFER_REQ
: {

1316 
	`«s_ôti_ul_d©a_ªq
(

1317 
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
.
UEid
,

1318 
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
.
«sMsg
.
d©a
,

1319 
as_msg
.
msg
.
ul_öfo_å™s„r_ªq
.
«sMsg
.
Àngth
);

1320 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1323 
AS_RAB_ESTABLISH_RSP
: {

1324 
	`«s_ôti_øb_e°ablish_r•
(

1325 
as_msg
.
msg
.
øb_e°ablish_r•
.
s_tmsi
,

1326 
as_msg
.
msg
.
øb_e°ablish_r•
.
øbID
,

1327 
as_msg
.
msg
.
øb_e°ablish_r•
.
îrCode
);

1328 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1335 
byãs
 = 
	`as_mesßge_£nd
(&
as_msg
);

1336 i‡(
byãs
 > 0) {

1337 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1342 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1343 
	}
}

1362 
	$_emm_as_d©a_ªq
(c⁄° 
emm_as_d©a_t
 *
msg
,

1363 
ul_öfo_å™s„r_ªq_t
 *
as_msg
)

1365 
LOG_FUNC_IN
;

1367 
size
 = 0;

1368 
is_ícoded
 = 
FALSE
;

1370 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS dataÅransferÑequest");

1372 
«s_mesßge_t
 
«s_msg
;

1373 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1376 i‡(
msg
->
guti
) {

1377 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1378 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1380 
as_msg
->
UEid
 = 
msg
->
ueid
;

1384 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1387 i‡(
emm_msg
 !
NULL
Ë
msg
->
NASöfo
) {

1388 #ifde‡
NAS_UE


1389 
EMM_AS_NAS_DATA_ATTACH
:

1390 
size
 = 
	`emm_£nd_©èch_com∂ëe
(
msg
, &
emm_msg
->
©èch_com∂ëe
);

1393 
EMM_AS_NAS_DATA_DETACH
:

1394 
size
 = 
	`emm_£nd_dëach_ªque°
(
msg
, &
emm_msg
->
dëach_ªque°
);

1398 #ifde‡
NAS_MME


1399 
EMM_AS_NAS_DATA_DETACH
:

1400 
size
 = 
	`emm_£nd_dëach_ac˚±
(
msg
, &
emm_msg
->
dëach_ac˚±
);

1406 
size
 = 
msg
->
NASmsg
.
Àngth
;

1407 
is_ícoded
 = 
TRUE
;

1411 i‡(
size
 > 0) {

1412 
byãs
;

1413 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

1414 #i‡
	`deföed
(
NAS_MME
)

1415 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

1416 #i‡
	`deföed
(
EPC_BUILD
)

1417 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

1419 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1420 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

1423 i‡(
emm_˘x
) {

1424 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

1427 
emm_£curôy_c⁄ãxt
 = 
_emm_d©a
.
£curôy
;

1429 i‡(
emm_£curôy_c⁄ãxt
) {

1430 #ifde‡
NAS_MME


1431 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

1433 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
;

1435 
	`LOG_TRACE
(
DEBUG
,

1437 
«s_msg
.
hódî
.
£quí˚_numbî
);

1439 i‡(!
is_ícoded
) {

1441 
byãs
 = 
	`_emm_as_ícode
(&
as_msg
->
«sMsg
,

1442 &
«s_msg
,

1443 
size
,

1444 
emm_£curôy_c⁄ãxt
);

1447 
byãs
 = 
	`_emm_as_í¸y±
(&
as_msg
->
«sMsg
,

1448 &
«s_msg
.
hódî
,

1449 (*)(
msg
->
NASmsg
.
vÆue
),

1450 
size
,

1451 
emm_£curôy_c⁄ãxt
);

1453 i‡(
byãs
 > 0) {

1454 #ifde‡
NAS_UE


1455 
	`LOG_FUNC_RETURN
 (
AS_UL_INFO_TRANSFER_REQ
);

1457 #ifde‡
NAS_MME


1458 
	`LOG_FUNC_RETURN
 (
AS_DL_INFO_TRANSFER_REQ
);

1462 
	`LOG_FUNC_RETURN
 (0);

1463 
	}
}

1481 
	$_emm_as_°©us_öd
(c⁄° 
emm_as_°©us_t
 *
msg
,

1482 
ul_öfo_å™s„r_ªq_t
 *
as_msg
)

1484 
LOG_FUNC_IN
;

1486 
size
 = 0;

1488 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS status indication (cause=%d)",

1489 
msg
->
emm_ˇu£
);

1491 
«s_mesßge_t
 
«s_msg
;

1492 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1495 i‡(
msg
->
guti
) {

1496 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1497 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1499 
as_msg
->
UEid
 = 
msg
->
ueid
;

1503 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1506 i‡(
emm_msg
 !
NULL
) {

1507 
size
 = 
	`emm_£nd_°©us
(
msg
, &
emm_msg
->
emm_°©us
);

1510 i‡(
size
 > 0) {

1511 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

1512 #i‡
	`deföed
(
NAS_MME
)

1513 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

1514 #i‡
	`deföed
(
EPC_BUILD
)

1515 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

1517 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1518 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

1521 i‡(
emm_˘x
) {

1522 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

1525 
emm_£curôy_c⁄ãxt
 = 
_emm_d©a
.
£curôy
;

1527 i‡(
emm_£curôy_c⁄ãxt
) {

1528 #ifde‡
NAS_MME


1529 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

1531 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
;

1533 
	`LOG_TRACE
(
DEBUG
,

1535 
«s_msg
.
hódî
.
£quí˚_numbî
);

1538 
byãs
 = 
	`_emm_as_ícode
(

1539 &
as_msg
->
«sMsg
,

1540 &
«s_msg
,

1541 
size
,

1542 
emm_£curôy_c⁄ãxt
);

1544 i‡(
byãs
 > 0) {

1545 #ifde‡
NAS_UE


1546 
	`LOG_FUNC_RETURN
 (
AS_UL_INFO_TRANSFER_REQ
);

1548 #ifde‡
NAS_MME


1549 
	`LOG_FUNC_RETURN
 (
AS_DL_INFO_TRANSFER_REQ
);

1553 
	`LOG_FUNC_RETURN
 (0);

1554 
	}
}

1573 
	$_emm_as_ªÀa£_ªq
(c⁄° 
emm_as_ªÀa£_t
 *
msg
,

1574 
«s_ªÀa£_ªq_t
 *
as_msg
)

1576 
LOG_FUNC_IN
;

1578 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send ASÑeleaseÑequest");

1581 i‡(
msg
->
guti
) {

1582 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1583 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1585 
as_msg
->
UEid
 = 
msg
->
ueid
;

1588 i‡(
msg
->
ˇu£
 =
EMM_AS_CAUSE_AUTHENTICATION
) {

1589 
as_msg
->
ˇu£
 = 
AS_AUTHENTICATION_FAILURE
;

1590 } i‡(
msg
->
ˇu£
 =
EMM_AS_CAUSE_DETACH
) {

1591 
as_msg
->
ˇu£
 = 
AS_DETACH
;

1594 
	`LOG_FUNC_RETURN
 (
AS_NAS_RELEASE_REQ
);

1595 
	}
}

1597 #ifde‡
NAS_UE


1614 
	$_emm_as_£curôy_ªs
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1615 
ul_öfo_å™s„r_ªq_t
 *
as_msg
)

1617 
LOG_FUNC_IN
;

1619 
size
 = 0;

1621 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS securityÑesponse");

1623 
«s_mesßge_t
 
«s_msg
;

1624 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1627 i‡(
msg
->
guti
) {

1628 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1629 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1633 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1636 i‡(
emm_msg
 !
NULL
Ë
msg
->
msgTy≥
) {

1637 
EMM_AS_MSG_TYPE_IDENT
:

1638 
size
 = 
	`emm_£nd_idítôy_ª•⁄£
(

1639 
msg
,

1640 &
emm_msg
->
idítôy_ª•⁄£
);

1643 
EMM_AS_MSG_TYPE_AUTH
:

1644 i‡(
msg
->
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

1645 
size
 = 
	`emm_£nd_authítiˇti⁄_Áûuª
(

1646 
msg
,

1647 &
emm_msg
->
authítiˇti⁄_Áûuª
);

1649 
size
 = 
	`emm_£nd_authítiˇti⁄_ª•⁄£
(

1650 
msg
,

1651 &
emm_msg
->
authítiˇti⁄_ª•⁄£
);

1655 
EMM_AS_MSG_TYPE_SMC
:

1656 i‡(
msg
->
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

1657 
size
 = 
	`emm_£nd_£curôy_mode_ªje˘
(

1658 
msg
,

1659 &
emm_msg
->
£curôy_mode_ªje˘
);

1661 
size
 = 
	`emm_£nd_£curôy_mode_com∂ëe
(

1662 
msg
,

1663 &
emm_msg
->
£curôy_mode_com∂ëe
);

1668 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of NAS security "

1669 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
msgTy≥
);

1672 i‡(
size
 > 0) {

1674 
byãs
 = 
	`_emm_as_ícode
(&
as_msg
->
«sMsg
,

1675 &
«s_msg
,

1676 
size
,

1677 
_emm_d©a
.
£curôy
);

1679 i‡(
byãs
 > 0) {

1680 
	`LOG_FUNC_RETURN
 (
AS_UL_INFO_TRANSFER_REQ
);

1683 
	`LOG_FUNC_RETURN
 (0);

1684 
	}
}

1705 
	$_emm_as_e°ablish_ªq
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

1706 
«s_e°ablish_ªq_t
 *
as_msg
)

1708 
LOG_FUNC_IN
;

1710 
size
 = 0;

1712 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS connectionÉstablishÑequest");

1714 
«s_mesßge_t
 
«s_msg
;

1715 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1718 
as_msg
->
ˇu£
 = 
msg
->
RRCˇu£
;

1719 
as_msg
->
ty≥
 = 
msg
->
RRCty≥
;

1720 
as_msg
->
∂mnID
 = *
msg
->plmnID;

1722 i‡(
msg
->
UEid
.
guti
) {

1723 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
UEid
.
guti
->
gummei
.MMEcode;

1724 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
UEid
.
guti
->m_tmsi;

1728 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1731 i‡(
emm_msg
 !
NULL
Ë
msg
->
NASöfo
) {

1732 
EMM_AS_NAS_INFO_ATTACH
:

1733 
size
 = 
	`emm_£nd_©èch_ªque°
(
msg
, &
emm_msg
->
©èch_ªque°
);

1736 
EMM_AS_NAS_INFO_DETACH
:

1737 
size
 = 
	`emm_£nd_öôül_dëach_ªque°
(
msg
,

1738 &
emm_msg
->
dëach_ªque°
);

1741 
EMM_AS_NAS_INFO_TAU
:

1742 
size
 = 
	`emm_£nd_öôül_èu_ªque°
(
msg
,

1743 &
emm_msg
->
åackög_¨ó_upd©e_ªque°
);

1746 
EMM_AS_NAS_INFO_SR
:

1747 
size
 = 
	`emm_£nd_öôül_§_ªque°
(
msg
,

1748 &
emm_msg
->
£rvi˚_ªque°
);

1751 
EMM_AS_NAS_INFO_EXTSR
:

1752 
size
 = 
	`emm_£nd_öôül_ext§_ªque°
(
msg
,

1753 &
emm_msg
->
exãnded_£rvi˚_ªque°
);

1757 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of initial NAS "

1758 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
NASöfo
);

1762 i‡(
size
 > 0) {

1764 
byãs
 = 
	`_emm_as_ícode
(

1765 &
as_msg
->
öôülNasMsg
,

1766 &
«s_msg
,

1767 
size
,

1768 
_emm_d©a
.
£curôy
);

1770 i‡(
byãs
 > 0) {

1771 
	`LOG_FUNC_RETURN
 (
AS_NAS_ESTABLISH_REQ
);

1774 
	`LOG_FUNC_RETURN
 (0);

1775 
	}
}

1778 #ifde‡
NAS_MME


1795 
	$_emm_as_£curôy_ªq
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1796 
dl_öfo_å™s„r_ªq_t
 *
as_msg
)

1798 
LOG_FUNC_IN
;

1800 
size
 = 0;

1802 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS securityÑequest");

1804 
«s_mesßge_t
 
«s_msg
;

1805 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1808 i‡(
msg
->
guti
) {

1809 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1810 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1812 
as_msg
->
UEid
 = 
msg
->
ueid
;

1816 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1819 i‡(
emm_msg
 !
NULL
Ë
msg
->
msgTy≥
) {

1820 
EMM_AS_MSG_TYPE_IDENT
:

1821 
size
 = 
	`emm_£nd_idítôy_ªque°
(
msg
,

1822 &
emm_msg
->
idítôy_ªque°
);

1825 
EMM_AS_MSG_TYPE_AUTH
:

1826 
size
 = 
	`emm_£nd_authítiˇti⁄_ªque°
(
msg
,

1827 &
emm_msg
->
authítiˇti⁄_ªque°
);

1830 
EMM_AS_MSG_TYPE_SMC
:

1831 
size
 = 
	`emm_£nd_£curôy_mode_comm™d
(
msg
,

1832 &
emm_msg
->
£curôy_mode_comm™d
);

1836 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of NAS security "

1837 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
msgTy≥
);

1840 i‡(
size
 > 0) {

1841 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

1842 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

1843 #i‡
	`deföed
(
EPC_BUILD
)

1844 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

1846 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1847 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

1850 i‡(
emm_˘x
) {

1851 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

1852 i‡(
emm_£curôy_c⁄ãxt
) {

1853 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

1854 
	`LOG_TRACE
(
DEBUG
,

1856 
«s_msg
.
hódî
.
£quí˚_numbî
);

1861 
byãs
 = 
	`_emm_as_ícode
(

1862 &
as_msg
->
«sMsg
,

1863 &
«s_msg
,

1864 
size
,

1865 
emm_£curôy_c⁄ãxt
);

1867 i‡(
byãs
 > 0) {

1868 
	`LOG_FUNC_RETURN
 (
AS_DL_INFO_TRANSFER_REQ
);

1871 
	`LOG_FUNC_RETURN
 (0);

1872 
	}
}

1890 
	$_emm_as_£curôy_ªj
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1891 
dl_öfo_å™s„r_ªq_t
 *
as_msg
)

1893 
LOG_FUNC_IN
;

1895 
size
 = 0;

1897 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS securityÑeject");

1899 
«s_mesßge_t
 
«s_msg
;

1900 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1903 i‡(
msg
->
guti
) {

1904 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
guti
->
gummei
.MMEcode;

1905 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
guti
->m_tmsi;

1907 
as_msg
->
UEid
 = 
msg
->
ueid
;

1911 
EMM_msg
 *
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

1914 i‡(
emm_msg
 !
NULL
Ë
msg
->
msgTy≥
) {

1915 
EMM_AS_MSG_TYPE_AUTH
:

1916 
size
 = 
	`emm_£nd_authítiˇti⁄_ªje˘
(

1917 &
emm_msg
->
authítiˇti⁄_ªje˘
);

1921 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of NAS security "

1922 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
msgTy≥
);

1925 i‡(
size
 > 0) {

1926 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

1927 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

1928 #i‡
	`deföed
(
EPC_BUILD
)

1929 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

1931 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

1932 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

1935 i‡(
emm_˘x
) {

1936 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

1937 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

1938 
	`LOG_TRACE
(
DEBUG
,

1940 
«s_msg
.
hódî
.
£quí˚_numbî
);

1944 
byãs
 = 
	`_emm_as_ícode
(

1945 &
as_msg
->
«sMsg
,

1946 &
«s_msg
,

1947 
size
,

1948 
emm_£curôy_c⁄ãxt
);

1950 i‡(
byãs
 > 0) {

1951 
	`LOG_FUNC_RETURN
 (
AS_DL_INFO_TRANSFER_REQ
);

1954 
	`LOG_FUNC_RETURN
 (0);

1955 
	}
}

1974 
	$_emm_as_e°ablish_˙f
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

1975 
«s_e°ablish_r•_t
 *
as_msg
)

1977 
EMM_msg
 *
emm_msg
;

1978 
size
 = 0;

1980 
LOG_FUNC_IN
;

1982 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS connectionÉstablish confirmation");

1984 
«s_mesßge_t
 
«s_msg
;

1985 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

1988 
as_msg
->
UEid
 = 
msg
->
ueid
;

1989 i‡(
msg
->
UEid
.
guti
 =
NULL
) {

1990 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - GUTI is NULL...");

1991 
	`LOG_FUNC_RETURN
 (0);

1993 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
UEid
.
guti
->
gummei
.MMEcode;

1994 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
UEid
.
guti
->m_tmsi;

1997 
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

2000 i‡(
emm_msg
 !
NULL
Ë
msg
->
NASöfo
) {

2001 
EMM_AS_NAS_INFO_ATTACH
:

2002 
	`LOG_TRACE
(
WARNING
,

2004 
msg
->
NASmsg
.
Àngth
);

2005 
size
 = 
	`emm_£nd_©èch_ac˚±
(
msg
, &
emm_msg
->
©èch_ac˚±
);

2009 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of initial NAS "

2010 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
NASöfo
);

2014 i‡(
size
 > 0) {

2015 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

2016 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

2017 #i‡
	`deföed
(
EPC_BUILD
)

2018 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

2020 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

2021 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

2024 i‡(
emm_˘x
) {

2025 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

2026 i‡(
emm_£curôy_c⁄ãxt
) {

2027 
as_msg
->
«s_ul_cou¡
 = 0x00000000 |

2028 (
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
ovîÊow
 << 8) |

2029 
emm_£curôy_c⁄ãxt
->
ul_cou¡
.
£q_num
;

2030 
	`LOG_TRACE
(
DEBUG
, "EMMAS-SAP - NAS UL COUNT %8x",

2031 
as_msg
->
«s_ul_cou¡
);

2033 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

2034 
	`LOG_TRACE
(
DEBUG
,

2036 
«s_msg
.
hódî
.
£quí˚_numbî
);

2038 
as_msg
->
£À˘ed_í¸y±i⁄_Æg‹ôhm
 = 
	`ht⁄s
(0x8000 >> 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
);

2039 
as_msg
->
£À˘ed_öãgrôy_Æg‹ôhm
 = 
	`ht⁄s
(0x8000 >> 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
öãgrôy
);

2041 
	`LOG_TRACE
(
DEBUG
,

2043 
as_msg
->
£À˘ed_í¸y±i⁄_Æg‹ôhm
,

2044 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
í¸y±i⁄
);

2045 
	`LOG_TRACE
(
DEBUG
,

2047 
as_msg
->
£À˘ed_öãgrôy_Æg‹ôhm
,

2048 
emm_£curôy_c⁄ãxt
->
£À˘ed_Æg‹ôhms
.
öãgrôy
);

2053 
byãs
 = 
	`_emm_as_ícode
(

2054 &
as_msg
->
«sMsg
,

2055 &
«s_msg
,

2056 
size
,

2057 
emm_£curôy_c⁄ãxt
);

2059 i‡(
byãs
 > 0) {

2060 
as_msg
->
îrCode
 = 
AS_SUCCESS
;

2061 
	`LOG_FUNC_RETURN
 (
AS_NAS_ESTABLISH_CNF
);

2065 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Size <= 0");

2066 
	`LOG_FUNC_RETURN
 (0);

2067 
	}
}

2086 
	$_emm_as_e°ablish_ªj
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

2087 
«s_e°ablish_r•_t
 *
as_msg
)

2089 
EMM_msg
 *
emm_msg
;

2090 
size
 = 0;

2091 
«s_mesßge_t
 
«s_msg
;

2093 
LOG_FUNC_IN
;

2095 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS connectionÉstablishÑeject");

2097 
	`mem£t
(&
«s_msg
, 0 , (
«s_mesßge_t
));

2100 i‡(
msg
->
UEid
.
guti
) {

2101 
as_msg
->
s_tmsi
.
MMEcode
 = 
msg
->
UEid
.
guti
->
gummei
.MMEcode;

2102 
as_msg
->
s_tmsi
.
m_tmsi
 = 
msg
->
UEid
.
guti
->m_tmsi;

2104 
as_msg
->
UEid
 = 
msg
->
ueid
;

2108 
emm_msg
 = 
	`_emm_as_£t_hódî
(&
«s_msg
, &
msg
->
s˘x
);

2111 i‡(
emm_msg
 !
NULL
Ë
msg
->
NASöfo
) {

2112 
EMM_AS_NAS_INFO_ATTACH
:

2113 
size
 = 
	`emm_£nd_©èch_ªje˘
(
msg
, &
emm_msg
->
©èch_ªje˘
);

2116 
EMM_AS_NAS_INFO_TAU
:

2117 
size
 = 
	`emm_£nd_åackög_¨ó_upd©e_ªje˘
(
msg
,

2118 &
emm_msg
->
åackög_¨ó_upd©e_ªje˘
);

2122 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Type of initial NAS "

2123 "mesßgê0x%.2x i†nŸ vÆid", 
msg
->
NASöfo
);

2127 i‡(
size
 > 0) {

2128 
emm_d©a_c⁄ãxt_s
 *
emm_˘x
 = 
NULL
;

2129 
emm_£curôy_c⁄ãxt_t
 *
emm_£curôy_c⁄ãxt
 = 
NULL
;

2130 #i‡
	`deföed
(
EPC_BUILD
)

2131 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ueid
);

2133 i‡(
msg
->
ueid
 < 
EMM_DATA_NB_UE_MAX
) {

2134 
emm_˘x
 = 
_emm_d©a
.
˘x
[
msg
->
ueid
];

2137 i‡(
emm_˘x
) {

2138 
emm_£curôy_c⁄ãxt
 = 
emm_˘x
->
£curôy
;

2139 i‡(
emm_£curôy_c⁄ãxt
) {

2140 
«s_msg
.
hódî
.
£quí˚_numbî
 = 
emm_£curôy_c⁄ãxt
->
dl_cou¡
.
£q_num
;

2141 
	`LOG_TRACE
(
DEBUG
,

2143 
«s_msg
.
hódî
.
£quí˚_numbî
);

2147 
byãs
 = 
	`_emm_as_ícode
(

2148 &
as_msg
->
«sMsg
,

2149 &
«s_msg
,

2150 
size
,

2151 
emm_£curôy_c⁄ãxt
);

2152 i‡(
byãs
 > 0) {

2153 
as_msg
->
îrCode
 = 
AS_TERMINATED_NAS
;

2154 
	`LOG_FUNC_RETURN
 (
AS_NAS_ESTABLISH_RSP
);

2157 
	`LOG_FUNC_RETURN
 (0);

2158 
	}
}

2176 
	$_emm_as_∑ge_öd
(c⁄° 
emm_as_∑ge_t
 *
msg
, 
∑gög_ªq_t
 *
as_msg
)

2178 
LOG_FUNC_IN
;

2180 
byãs
 = 0;

2182 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS dataÖaging indication");

2186 i‡(
byãs
 > 0) {

2187 
	`LOG_FUNC_RETURN
 (
AS_PAGING_IND
);

2189 
	`LOG_FUNC_RETURN
 (0);

2190 
	}
}

2213 
	$_emm_as_˚Œ_öfo_ªq
(c⁄° 
emm_as_˚Œ_öfo_t
 *
msg
,

2214 
˚Œ_öfo_ªq_t
 *
as_msg
)

2216 
LOG_FUNC_IN
;

2218 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send AS cell informationÑequest");

2220 
as_msg
->
∂mnID
 = 
msg
->
∂mnIDs
.
∂mn
[0];

2221 
as_msg
->
øt
 = 
msg
->rat;

2223 
	`LOG_FUNC_RETURN
 (
AS_CELL_INFO_REQ
);

2224 
	}
}

	@src/emm/sap/emm_as.h

47 #i‚de‡
__EMM_AS_H__


48 
	#__EMM_AS_H__


	)

50 
	~"emm_asDef.h
"

68 
emm_as_öôülize
();

70 
emm_as_£nd
(c⁄° 
emm_as_t
 *
msg
);

	@src/emm/sap/emm_asDef.h

48 #i‚de‡
__EMM_ASDEF_H__


49 
	#__EMM_ASDEF_H__


	)

51 
	~"comm⁄Def.h
"

52 
	~"O˘ëSåög.h
"

62 
	m_EMMAS_START
 = 200,

63 
	m_EMMAS_SECURITY_REQ
,

64 
	m_EMMAS_SECURITY_IND
,

65 
	m_EMMAS_SECURITY_RES
,

66 
	m_EMMAS_SECURITY_REJ
,

67 
	m_EMMAS_ESTABLISH_REQ
,

68 
	m_EMMAS_ESTABLISH_CNF
,

69 
	m_EMMAS_ESTABLISH_REJ
,

70 
	m_EMMAS_RELEASE_REQ
,

71 
	m_EMMAS_RELEASE_IND
,

72 
	m_EMMAS_DATA_REQ
,

73 
	m_EMMAS_DATA_IND
,

74 
	m_EMMAS_PAGE_IND
,

75 
	m_EMMAS_STATUS_IND
,

76 
	m_EMMAS_CELL_INFO_REQ
,

77 
	m_EMMAS_CELL_INFO_RES
,

78 
	m_EMMAS_CELL_INFO_IND
,

79 
	m_EMMAS_END


80 } 
	temm_as_¥imôive_t
;

84 
UI¡8_t
 
	mis_√w
;

85 
	#EMM_AS_NO_KEY_AVAILABLE
 0xff

	)

86 
UI¡8_t
 
	mksi
;

87 
UI¡8_t
 
	msqn
;

88 
UI¡32_t
 
	mcou¡
;

89 c⁄° 
O˘ëSåög
 *
	mk_íc
;

90 c⁄° 
O˘ëSåög
 *
	mk_öt
;

91 } 
	temm_as_£curôy_d©a_t
;

102 
UI¡32_t
 
	mueid
;

103 c⁄° 
GUTI_t
 *
	mguti
;

104 
emm_as_£curôy_d©a_t
 
	ms˘x
;

105 
	memm_ˇu£
;

109 
UI¡8_t
 
	midítTy≥
;

110 c⁄° 
imsi_t
 *
	mimsi
;

111 c⁄° 
imei_t
 *
	mimei
;

112 
UI¡32_t
 
	mtmsi
;

116 
UI¡8_t
 
	mksi
;

117 c⁄° 
O˘ëSåög
 *
	mønd
;

118 c⁄° 
O˘ëSåög
 *
	mauä
;

119 c⁄° 
O˘ëSåög
 *
	mªs
;

120 c⁄° 
O˘ëSåög
 *
	mauts
;

124 
UI¡8_t
 
	mìa
;

125 
UI¡8_t
 
	meü
;

126 
UI¡8_t
 
	muó
;

127 
uöt8_t
 
	mucs2
;

128 
UI¡8_t
 
	muü
;

129 
UI¡8_t
 
	mgó
;

130 
UI¡8_t
 
	mumts_¥e£¡
;

131 
UI¡8_t
 
	mg¥s_¥e£¡
;

134 
UI¡8_t
 
	m£À˘ed_ìa
;

135 
UI¡8_t
 
	m£À˘ed_eü
;

137 
	#EMM_AS_MSG_TYPE_IDENT
 0x01

	)

138 
	#EMM_AS_MSG_TYPE_AUTH
 0x02

	)

139 
	#EMM_AS_MSG_TYPE_SMC
 0x03

	)

140 
UI¡8_t
 
	mmsgTy≥
;

141 } 
	temm_as_£curôy_t
;

148 c⁄° 
GUTI_t
 *
	mguti
;

149 c⁄° 
èi_t
 *
	mèi
;

151 c⁄° 
imsi_t
 *
	mimsi
;

152 c⁄° 
imei_t
 *
	mimei
;

153 } 
	temm_as_EPS_idítôy_t
;

156 
UI¡32_t
 
	mueid
;

157 
emm_as_EPS_idítôy_t
 
	mUEid
;

158 
emm_as_£curôy_d©a_t
 
	ms˘x
;

159 
	mswôch_off
;

160 
UI¡8_t
 
	mty≥
;

161 
UI¡8_t
 
	mRRCˇu£
;

162 
UI¡8_t
 
	mRRCty≥
;

163 c⁄° 
∂mn_t
 *
	m∂mnID
;

164 
UI¡8_t
 
	mksi
;

165 
UI¡8_t
 
	mí¸y±i⁄
:4;

166 
UI¡8_t
 
	möãgrôy
:4;

167 
	memm_ˇu£
;

168 c⁄° 
GUTI_t
 *
	m√w_guti
;

169 
	mn_ècs
;

171 
èc_t
 
	mèc
;

173 
	#EMM_AS_NAS_INFO_ATTACH
 0x01

	)

174 
	#EMM_AS_NAS_INFO_DETACH
 0x02

	)

175 
	#EMM_AS_NAS_INFO_TAU
 0x03

	)

176 
	#EMM_AS_NAS_INFO_SR
 0x04

	)

177 
	#EMM_AS_NAS_INFO_EXTSR
 0x05

	)

178 
UI¡8_t
 
	mNASöfo
;

179 
O˘ëSåög
 
	mNASmsg
;

181 } 
	temm_as_e°ablish_t
;

188 
UI¡32_t
 
	mueid
;

189 c⁄° 
GUTI_t
 *
	mguti
;

190 
	#EMM_AS_CAUSE_AUTHENTICATION
 0x01

	)

191 
	#EMM_AS_CAUSE_DETACH
 0x02

	)

192 
UI¡8_t
 
	mˇu£
;

193 } 
	temm_as_ªÀa£_t
;

200 
UI¡32_t
 
	mueid
;

201 c⁄° 
GUTI_t
 *
	mguti
;

202 
emm_as_£curôy_d©a_t
 
	ms˘x
;

203 
	mswôch_off
;

204 
UI¡8_t
 
	mty≥
;

205 
UI¡8_t
 
	mdñivîed
;

206 
	#EMM_AS_NAS_DATA_ATTACH
 0x01

	)

207 
	#EMM_AS_NAS_DATA_DETACH
 0x02

	)

208 
UI¡8_t
 
	mNASöfo
;

209 
O˘ëSåög
 
	mNASmsg
;

210 } 
	temm_as_d©a_t
;

216 °ru˘ {} 
	gemm_as_∑ge_t
;

223 
UI¡32_t
 
	mueid
;

224 c⁄° 
GUTI_t
 *
	mguti
;

225 
emm_as_£curôy_d©a_t
 
	ms˘x
;

226 
	memm_ˇu£
;

227 } 
	temm_as_°©us_t
;

234 
UI¡8_t
 
	mfound
;

235 
	#EMM_AS_PLMN_LIST_SIZE
 6

	)

236 
PLMN_LIST_T
(
EMM_AS_PLMN_LIST_SIZE
Ë
	m∂mnIDs
;

238 
Byã_t
 
	møt
;

239 
èc_t
 
	mèc
;

240 
ci_t
 
	m˚ŒID
;

241 } 
	temm_as_˚Œ_öfo_t
;

249 
emm_as_¥imôive_t
 
	m¥imôive
;

251 
emm_as_£curôy_t
 
	m£curôy
;

252 
emm_as_e°ablish_t
 
	me°ablish
;

253 
emm_as_ªÀa£_t
 
	mªÀa£
;

254 
emm_as_d©a_t
 
	md©a
;

255 
emm_as_∑ge_t
 
	m∑ge
;

256 
emm_as_°©us_t
 
	m°©us
;

257 
emm_as_˚Œ_öfo_t
 
	m˚Œ_öfo
;

258 } 
	mu
;

259 } 
	temm_as_t
;

273 
emm_as_£t_£curôy_d©a
(
emm_as_£curôy_d©a_t
 *
d©a
, c⁄° *
c⁄ãxt
,

274 
is_√w
, 
is_cùhîed
);

	@src/emm/sap/emm_cn.c

47 
	~<°rög.h
>

49 #i‡
deföed
(
EPC_BUILD
)

51 
	~"«s_log.h
"

52 
	~"comm⁄Def.h
"

54 
	~"emm_˙.h
"

55 
	~"emm_ßp.h
"

56 
	~"emm_¥oc.h
"

57 
	~"emm_ˇu£.h
"

59 
	~"esm_£nd.h
"

60 
	~"esm_¥oc.h
"

61 
	~"esm_ˇu£.h
"

62 
	~"as£πi⁄s.h
"

63 
	~"emmD©a.h
"

64 
	~"esm_ßp.h
"

65 
	~"EmmComm⁄.h
"

66 
emm_˙_wøµî_©èch_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
emm_˘x
, *
d©a
);

72 
	mueid
;

73 
	#ATTACH_COUNTER_MAX
 5

	)

74 
	mªå™smissi⁄_cou¡
;

75 
O˘ëSåög
 
	mesm_msg
;

77 } 
	t©èch_d©a_t
;

82 c⁄° *
	g_emm_˙_¥imôive_°r
[] = {

90 
	#EMM_CN_SAP_BUFFER_SIZE
 4096

	)

91 
	g_emm_˙_ßp_buf„r
[
EMM_CN_SAP_BUFFER_SIZE
];

93 
	$_emm_˙_authítiˇti⁄_ªs
(c⁄° 
emm_˙_auth_ªs_t
 *
msg
)

95 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = 
NULL
;

96 
rc
 = 
RETURNîr‹
;

97 
O˘ëSåög
 
loc_ønd
;

98 
O˘ëSåög
 
auä
;

102 
LOG_FUNC_IN
;

104 
emm_˘x
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg
->
ue_id
);

105 i‡(
emm_˘x
 =
NULL
) {

106 
	`LOG_TRACE
(
ERROR
, "EMM-PROC - "

107 "FaûedÅÿföd UEássocüãdÅÿid %u...", 
msg
->
ue_id
);

108 
	`LOG_FUNC_RETURN
 (
rc
);

112 
	`mem˝y
(
emm_˘x
->
ve˘‹
.
kasme
, 
msg
->ve˘‹.kasme, 
AUTH_KASME_SIZE
);

113 
	`mem˝y
(
emm_˘x
->
ve˘‹
.
auä
, 
msg
->ve˘‹.auä, 
AUTH_AUTN_SIZE
);

114 
	`mem˝y
(
emm_˘x
->
ve˘‹
.
ønd
, 
msg
->ve˘‹.ønd, 
AUTH_RAND_SIZE
);

115 
	`mem˝y
(
emm_˘x
->
ve˘‹
.
xªs
, 
msg
->ve˘‹.xªs.
d©a
, msg->ve˘‹.xªs.
size
);

117 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Re˚ived RAND ..: "
RAND_FORMAT
"\n",

118 
	`RAND_DISPLAY
(
msg
->
ve˘‹
.
ønd
));

119 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Re˚ived AUTN ..: "
AUTN_FORMAT
"\n",

120 
	`AUTN_DISPLAY
(
msg
->
ve˘‹
.
auä
));

121 
	`LOG_TRACE
(
INFO
, "EMM-PROC - Re˚ived KASME .: "
KASME_FORMAT
" "KASME_FORMAT"\n",

122 
	`KASME_DISPLAY_1
(
msg
->
ve˘‹
.
kasme
),

123 
	`KASME_DISPLAY_2
(
msg
->
ve˘‹
.
kasme
));

125 
loc_ønd
.
vÆue
 = 
emm_˘x
->
ve˘‹
.
ønd
;

126 
loc_ønd
.
Àngth
 = 
AUTH_RAND_SIZE
;

128 
auä
.
vÆue
 = 
emm_˘x
->
ve˘‹
.autn;

129 
auä
.
Àngth
 = 
AUTH_AUTN_SIZE
;

131 
emm_˘x
->
ve˘‹
.
xªs_size
 = 
msg
->ve˘‹.
xªs
.
size
;

138 
rc
 = 
	`emm_¥oc_authítiˇti⁄
(
emm_˘x
,

139 
emm_˘x
->
ueid
,

141 &
loc_ønd
,

142 &
auä
,

143 
emm_©èch_£curôy
,

144 
NULL
,

145 
NULL
);

146 i‡(
rc
 !
RETURNok
) {

148 
	`LOG_TRACE
(
WARNING
, "EMM-PROC - "

150 
emm_˘x
->
emm_ˇu£
 = 
EMM_CAUSE_ILLEGAL_UE
;

153 
	`LOG_FUNC_RETURN
 (
rc
);

154 
	}
}

156 
	$_emm_˙_authítiˇti⁄_Áû
(c⁄° 
emm_˙_auth_Áû_t
 *
msg
)

158 
rc
 = 
RETURNîr‹
;

160 
LOG_FUNC_IN
;

162 
rc
 = 
	`emm_¥oc_©èch_ªje˘
(
msg
->
ue_id
, msg->
ˇu£
);

164 
	`LOG_FUNC_RETURN
 (
rc
);

165 
	}
}

167 
	$_emm_˙_dîegi°î_ue
(c⁄° 
UI¡32_t
 
ue_id
)

169 
rc
 = 
RETURNok
;

171 
LOG_FUNC_IN
;

173 
	`LOG_FUNC_RETURN
 (
rc
);

174 
	}
}

176 
	$_emm_˙_pdn_c⁄√˘ivôy_ªs
(c⁄° 
emm_˙_pdn_ªs_t
 *
msg_pP
)

178 
rc
 = 
RETURNok
;

179 
emm_d©a_c⁄ãxt_s
 *
emm_˘x_p
 = 
NULL
;

180 
esm_¥oc_pdn_ty≥_t
 
esm_pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4
;

181 
esm_¥oc_d©a_t
 *
esm_¥oc_d©a_p
 = 
NULL
;

182 
ESM_msg
 
esm_msg
;

183 
EpsQuÆôyOfSîvi˚
 
qos
;

184 
O˘ëSåög
 
r•
 = { 0, 
NULL
};

185 
is_°™dÆ⁄e
 = 0;

186 
åiggîed_by_ue
 = 1;

187 
©èch_d©a_t
 *
d©a_p
 = 
NULL
;

188 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

189 
pid
 = 0;

190 
√w_ebi
 = 0;

192 
LOG_FUNC_IN
;

193 
emm_˘x_p
 = 
	`emm_d©a_c⁄ãxt_gë
(&
_emm_d©a
, 
msg_pP
->
ue_id
);

194 i‡(
emm_˘x_p
 =
NULL
) {

195 
	`LOG_TRACE
(
ERROR
, "EMMCN-SAP - "

196 "FaûedÅÿföd UEássocüãdÅÿid %u...", 
msg_pP
->
ue_id
);

197 
	`LOG_FUNC_RETURN
 (
rc
);

200 
	`mem£t
(&
esm_msg
, 0 , (
ESM_msg
));

202 
msg_pP
->
pdn_ty≥
) {

203 
IPv4
:

204 
	`LOG_TRACE
(
INFO
, "EMM -Ésm_pdn_type = ESM_PDN_TYPE_IPV4");

205 
esm_pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4
;

208 
IPv6
:

209 
	`LOG_TRACE
(
INFO
, "EMM -Ésm_pdn_type = ESM_PDN_TYPE_IPV6");

210 
esm_pdn_ty≥
 = 
ESM_PDN_TYPE_IPV6
;

213 
IPv4_AND_v6
:

214 
	`LOG_TRACE
(
INFO
, "EMM -Ésm_pdn_type = ESM_PDN_TYPE_IPV4V6");

215 
esm_pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4V6
;

219 
	`LOG_TRACE
(
INFO
, "EMM -Ésm_pdn_type = ESM_PDN_TYPE_IPV4 (forcedÅo default)");

220 
esm_pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4
;

223 
	`LOG_TRACE
(
INFO
, "EMM - qcò = %u ", 
msg_pP
->
qci
);

224 
	`LOG_TRACE
(
INFO
, "EMM - qos.qcò = %u ", 
msg_pP
->
qos
.
qci
);

225 
	`LOG_TRACE
(
INFO
, "EMM - qos.mbrUL = %u ", 
msg_pP
->
qos
.
mbrUL
);

226 
	`LOG_TRACE
(
INFO
, "EMM - qos.mbrDL = %u ", 
msg_pP
->
qos
.
mbrDL
);

227 
	`LOG_TRACE
(
INFO
, "EMM - qos.gbrUL = %u ", 
msg_pP
->
qos
.
gbrUL
);

228 
	`LOG_TRACE
(
INFO
, "EMM - qos.gbrDL = %u ", 
msg_pP
->
qos
.
gbrDL
);

229 
qos
.
bôR©esPª£¡
 = 0;

230 
qos
.
bôR©esExtPª£¡
 = 0;

232 
qos
.
qci
 = 
msg_pP
->qci;

233 
qos
.
bôR©es
.
maxBôR©eF‹UL
 = 0;

234 
qos
.
bôR©es
.
maxBôR©eF‹DL
 = 0;

235 
qos
.
bôR©es
.
gu¨BôR©eF‹UL
 = 0;

236 
qos
.
bôR©es
.
gu¨BôR©eF‹DL
 = 0;

238 
qos
.
bôR©esExt
.
maxBôR©eF‹UL
 = 0;

239 
qos
.
bôR©esExt
.
maxBôR©eF‹DL
 = 0;

240 
qos
.
bôR©esExt
.
gu¨BôR©eF‹UL
 = 0;

241 
qos
.
bôR©esExt
.
gu¨BôR©eF‹DL
 = 0;

248 
pid
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(

249 
emm_˘x_p
,

250 
msg_pP
->
±i
,

251 
msg_pP
->
ªque°_ty≥
,

252 &
msg_pP
->
≠n
,

253 
esm_pdn_ty≥
,

254 &
msg_pP
->
pdn_addr
,

255 
NULL
,

256 &
esm_ˇu£
);

257 
	`LOG_TRACE
(
INFO
, "EMM - APN = %†", (*)(
msg_pP
->
≠n
.
vÆue
));

259 i‡(
pid
 !
RETURNîr‹
) {

261 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt
(

262 
emm_˘x_p
,

263 
pid
,

264 &
√w_ebi
,

265 &
msg_pP
->
qos
,

266 &
esm_ˇu£
);

268 i‡(
rc
 !
RETURNîr‹
) {

269 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

272 
	`LOG_FUNC_RETURN
 (
rc
);

277 
	`LOG_TRACE
(
INFO
, "EMM - APN = %†", (*)(
msg_pP
->
≠n
.
vÆue
));

284 
rc
 = 
	`esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

285 
msg_pP
->
±i
,

286 
√w_ebi
,

287 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
,

288 &
msg_pP
->
≠n
,

289 
esm_pdn_ty≥
,

290 &
msg_pP
->
pdn_addr
,

291 &
qos
,

292 
ESM_CAUSE_SUCCESS
);

295 i‡(
rc
 !
RETURNîr‹
) {

297 
size
 = 
	`esm_msg_ícode
(&
esm_msg
, (
uöt8_t
 *)
_emm_˙_ßp_buf„r
,

298 
EMM_CN_SAP_BUFFER_SIZE
);

299 
	`LOG_TRACE
(
INFO
, "ESMÉncoded MSG sizê%d ", 
size
);

300 i‡(
size
 > 0) {

301 
r•
.
Àngth
 = 
size
;

302 
r•
.
vÆue
 = (
uöt8_t
 *)(
_emm_˙_ßp_buf„r
);

306 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

307 
is_°™dÆ⁄e
,

308 
emm_˘x_p
,

309 
√w_ebi
,

310 &
r•
,

311 
åiggîed_by_ue
);

312 i‡(
rc
 !
RETURNok
) {

314 
	`LOG_FUNC_RETURN
 (
rc
);

317 
	`LOG_TRACE
(
INFO
, "ESM sendáctivate_default_eps_bearer_context_request failed");

323 
	`LOG_TRACE
(
INFO
, "EMM - APN = %†", (*)(
msg_pP
->
≠n
.
vÆue
));

324 
d©a_p
 = (
©èch_d©a_t
 *)
	`emm_¥oc_comm⁄_gë_¨gs
(
msg_pP
->
ue_id
);

327 
d©a_p
->
esm_msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(
r•
.
Àngth
);

328 i‡(
d©a_p
->
esm_msg
.
vÆue
) {

329 
d©a_p
->
esm_msg
.
Àngth
 = 
r•
.length;

330 
	`LOG_TRACE
(
INFO
, "EMM - c›y ESM MSG %d byãs", 
d©a_p
->
esm_msg
.
Àngth
);

331 
	`mem˝y
(
d©a_p
->
esm_msg
.
vÆue
,

332 
r•
.
vÆue
,

333 
r•
.
Àngth
);

335 
d©a_p
->
esm_msg
.
Àngth
 = 0;

339 
rc
 = 
	`emm_˙_wøµî_©èch_ac˚±
(
emm_˘x_p
, 
d©a_p
);

340 i‡(
rc
 !
RETURNîr‹
) {

341 i‡(
emm_˘x_p
->
guti_is_√w
 &&Émm_˘x_p->
ﬁd_guti
) {

345 
emm_ßp_t
 
emm_ßp
;

346 
emm_ßp
.
¥imôive
 = 
EMMREG_COMMON_PROC_REQ
;

347 
emm_ßp
.
u
.
emm_ªg
.
ueid
 = 
msg_pP
->
ue_id
;

348 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

351 
	`LOG_TRACE
(
INFO
, "EMM - APN = %†", (*)(
msg_pP
->
≠n
.
vÆue
));

352 
	`LOG_FUNC_RETURN
 (
rc
);

353 
	}
}

355 
	$_emm_˙_pdn_c⁄√˘ivôy_Áû
(c⁄° 
emm_˙_pdn_Áû_t
 *
msg
)

357 
rc
 = 
RETURNok
;

359 
LOG_FUNC_IN
;

361 
	`LOG_FUNC_RETURN
 (
rc
);

362 
	}
}

364 
	$emm_˙_£nd
(c⁄° 
emm_˙_t
 *
msg
)

366 
rc
 = 
RETURNîr‹
;

367 
emm_˙_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

369 
LOG_FUNC_IN
;

371 
	`LOG_TRACE
(
INFO
, "EMMCN-SAP - ReceivedÖrimitive %s (%d)",

372 
_emm_˙_¥imôive_°r
[
¥imôive
 - 
_EMMCN_START
 - 1],Örimitive);

374 
¥imôive
) {

375 
_EMMCN_AUTHENTICATION_PARAM_RES
:

376 
rc
 = 
	`_emm_˙_authítiˇti⁄_ªs
(
msg
->
u
.
auth_ªs
);

379 
_EMMCN_AUTHENTICATION_PARAM_FAIL
:

380 
rc
 = 
	`_emm_˙_authítiˇti⁄_Áû
(
msg
->
u
.
auth_Áû
);

383 
EMMCN_DEREGISTER_UE
:

384 
rc
 = 
	`_emm_˙_dîegi°î_ue
(
msg
->
u
.
dîegi°î
.
UEid
);

387 
EMMCN_PDN_CONNECTIVITY_RES
:

388 
rc
 = 
	`_emm_˙_pdn_c⁄√˘ivôy_ªs
(
msg
->
u
.
emm_˙_pdn_ªs
);

391 
EMMCN_PDN_CONNECTIVITY_FAIL
:

392 
rc
 = 
	`_emm_˙_pdn_c⁄√˘ivôy_Áû
(
msg
->
u
.
emm_˙_pdn_Áû
);

397 
rc
 = 
RETURNîr‹
;

401 i‡(
rc
 !
RETURNok
) {

402 
	`LOG_TRACE
(
ERROR
, "EMMCN-SAP - FailedÅoÖrocessÖrimitive %s (%d)",

403 
_emm_˙_¥imôive_°r
[
¥imôive
 - 
_EMMCN_START
 - 1],

404 
¥imôive
);

407 
	`LOG_FUNC_RETURN
 (
rc
);

408 
	}
}

	@src/emm/sap/emm_cn.h

47 
	~"emm_˙Def.h
"

49 #i‚de‡
_EMM_CN_H_


50 
	#_EMM_CN_H_


	)

52 #i‡
deföed
(
EPC_BUILD
)

53 
emm_˙_£nd
(c⁄° 
emm_˙_t
 *
msg
);

	@src/emm/sap/emm_cnDef.h

47 #i‡
deföed
(
EPC_BUILD
)

48 
	~"öãπask_öãrÁ˚.h
"

51 #i‚de‡
__EMM_CNDEF_H__


52 
	#__EMM_CNDEF_H__


	)

54 
	eemm˙_¥imôive_s
 {

55 
	m_EMMCN_START
 = 400,

56 #i‡
deföed
(
EPC_BUILD
)

57 
	m_EMMCN_AUTHENTICATION_PARAM_RES
,

58 
	m_EMMCN_AUTHENTICATION_PARAM_FAIL
,

59 
	m_EMMCN_DEREGISTER_UE
,

60 
	m_EMMCN_PDN_CONNECTIVITY_RES
,

61 
	m_EMMCN_PDN_CONNECTIVITY_FAIL
,

63 
	m_EMMCN_END


64 } 
	temm_˙_¥imôive_t
;

66 #i‡
deföed
(
EPC_BUILD
)

67 
«s_auth_∑øm_r•_t
 
	temm_˙_auth_ªs_t
;

68 
«s_auth_∑øm_Áû_t
 
	temm_˙_auth_Áû_t
;

69 
«s_pdn_c⁄√˘ivôy_r•_t
 
	temm_˙_pdn_ªs_t
;

70 
«s_pdn_c⁄√˘ivôy_Áû_t
 
	temm_˙_pdn_Áû_t
;

72 
	semm_˙_dîegi°î_ue_s
 {

73 
UI¡32_t
 
	mUEid
;

74 } 
	temm_˙_dîegi°î_ue_t
;

76 
	semm_mme_ul_s
 {

77 
emm_˙_¥imôive_t
 
	m¥imôive
;

79 
emm_˙_auth_ªs_t
 *
	mauth_ªs
;

80 
emm_˙_auth_Áû_t
 *
	mauth_Áû
;

81 
emm_˙_dîegi°î_ue_t
 
	mdîegi°î
;

82 
emm_˙_pdn_ªs_t
 *
	memm_˙_pdn_ªs
;

83 
emm_˙_pdn_Áû_t
 *
	memm_˙_pdn_Áû
;

84 } 
	mu
;

85 } 
	temm_˙_t
;

	@src/emm/sap/emm_esm.c

49 
	~"emm_esm.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~"LowîLayî.h
"

55 #ifde‡
NAS_UE


56 
	~"emm_¥oc.h
"

70 c⁄° *
	g_emm_esm_¥imôive_°r
[] = {

71 #ifde‡
NAS_UE


99 
	$emm_esm_öôülize
()

101 
LOG_FUNC_IN
;

105 
LOG_FUNC_OUT
;

106 
	}
}

122 
	$emm_esm_£nd
(c⁄° 
emm_esm_t
 *
msg
)

124 
LOG_FUNC_IN
;

126 
rc
 = 
RETURNîr‹
;

127 
emm_esm_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

129 
	`LOG_TRACE
(
INFO
, "EMMESM-SAP - ReceivedÖrimitive %s (%d)",

130 
_emm_esm_¥imôive_°r
[
¥imôive
 - 
_EMMESM_START
 - 1],Örimitive);

132 
¥imôive
) {

133 #ifde‡
NAS_UE


134 
_EMMESM_ESTABLISH_REQ
:

137 
rc
 = 
	`emm_¥oc_©èch_ª°¨t
();

140 
_EMMESM_ESTABLISH_CNF
:

143 i‡(
msg
->
u
.
e°ablish
.
is_©èched
) {

144 i‡(
msg
->
u
.
e°ablish
.
is_emîgícy
) {

147 
rc
 = 
	`emm_¥oc_©èch_£t_emîgícy
();

151 
rc
 = 
	`emm_¥oc_©èch_£t_dëach
();

155 
_EMMESM_ESTABLISH_REJ
:

159 
_EMMESM_UNITDATA_REQ
:

161 
rc
 = 
	`lowîœyî_d©a_ªq
(
msg
->
ueid
, &msg->
u
.
d©a
.msg);

169 i‡(
rc
 !
RETURNok
) {

170 
	`LOG_TRACE
(
WARNING
, "EMMESM-SAP - FailedÅoÖrocessÖrimitive %s (%d)",

171 
_emm_esm_¥imôive_°r
[
¥imôive
 - 
_EMMESM_START
 - 1],

172 
¥imôive
);

175 
	`LOG_FUNC_RETURN
 (
rc
);

176 
	}
}

	@src/emm/sap/emm_esm.h

48 #i‚de‡
__EMM_ESM_H__


49 
	#__EMM_ESM_H__


	)

51 
	~"emm_esmDef.h
"

69 
emm_esm_öôülize
();

71 
emm_esm_£nd
(c⁄° 
emm_esm_t
 *
msg
);

	@src/emm/sap/emm_esmDef.h

48 #i‚de‡
__EMM_ESMDEF_H__


49 
	#__EMM_ESMDEF_H__


	)

51 
	~"O˘ëSåög.h
"

52 
	~"emmD©a.h
"

62 
	m_EMMESM_START
 = 100,

63 #ifde‡
NAS_UE


64 
	m_EMMESM_ESTABLISH_REQ
,

65 
	m_EMMESM_ESTABLISH_CNF
,

66 
	m_EMMESM_ESTABLISH_REJ
,

68 
	m_EMMESM_RELEASE_IND
,

69 
	m_EMMESM_UNITDATA_REQ
,

70 
	m_EMMESM_UNITDATA_IND
,

71 
	m_EMMESM_END


72 } 
	temm_esm_¥imôive_t
;

83 
	mis_emîgícy
;

85 
	mis_©èched
;

87 } 
	temm_esm_e°ablish_t
;

94 
O˘ëSåög
 
	mmsg
;

95 } 
	temm_esm_d©a_t
;

103 
emm_esm_¥imôive_t
 
	m¥imôive
;

104 
	mueid
;

105 #i‡
deföed
(
NAS_MME
)

106 
emm_d©a_c⁄ãxt_t
 *
	m˘x
;

109 
emm_esm_e°ablish_t
 
	me°ablish
;

110 
emm_esm_d©a_t
 
	md©a
;

111 } 
	mu
;

113 } 
	temm_esm_t
;

	@src/emm/sap/emm_fsm.c

48 
	~"emm_fsm.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 
	~"mme_≠i.h
"

53 
	~"emmD©a.h
"

55 #i‡
deföed
(
EPC_BUILD
)

56 
	~"as£πi⁄s.h
"

63 #ifde‡
NAS_UE


64 
	#EMM_FSM_NB_UE_MAX
 1

	)

66 #ifde‡
NAS_MME


67 
	#EMM_FSM_NB_UE_MAX
 (
MME_API_NB_UE_MAX
 + 1)

	)

81 c⁄° *
	g_emm_fsm_evít_°r
[] = {

82 #ifde‡
NAS_UE


96 #ifde‡
NAS_MME


120 c⁄° *
	g_emm_fsm_°©us_°r
[
EMM_STATE_MAX
] = {

122 #ifde‡
NAS_UE


128 #ifde‡
NAS_UE


148 #ifde‡
NAS_MME


160 (*
	temm_fsm_h™dÀr_t
)(c⁄° 
	temm_ªg_t
 *);

162 #ifde‡
NAS_UE


163 
	`EmmNuŒ
(c⁄° 
emm_ªg_t
 *);

165 
	`EmmDîegi°îed
(c⁄° 
emm_ªg_t
 *);

166 
	`EmmRegi°îed
(c⁄° 
emm_ªg_t
 *);

167 
	`EmmDîegi°îedInôüãd
(c⁄° 
emm_ªg_t
 *);

168 #ifde‡
NAS_UE


169 
	`EmmDîegi°îedN‹mÆSîvi˚
(c⁄° 
emm_ªg_t
 *);

170 
	`EmmDîegi°îedLimôedSîvi˚
(c⁄° 
emm_ªg_t
 *);

171 
	`EmmDîegi°îedAâem±ögToAâach
(c⁄° 
emm_ªg_t
 *);

172 
	`EmmDîegi°îedPlmnSórch
(c⁄° 
emm_ªg_t
 *);

173 
	`EmmDîegi°îedNoImsi
(c⁄° 
emm_ªg_t
 *);

174 
	`EmmDîegi°îedAâachNìded
(c⁄° 
emm_ªg_t
 *);

175 
	`EmmDîegi°îedNoCñlAvaûabÀ
(c⁄° 
emm_ªg_t
 *);

176 
	`EmmRegi°îedInôüãd
(c⁄° 
emm_ªg_t
 *);

177 
	`EmmRegi°îedN‹mÆSîvi˚
(c⁄° 
emm_ªg_t
 *);

178 
	`EmmRegi°îedAâem±ögToUpd©e
(c⁄° 
emm_ªg_t
 *);

179 
	`EmmRegi°îedLimôedSîvi˚
(c⁄° 
emm_ªg_t
 *);

180 
	`EmmRegi°îedPlmnSórch
(c⁄° 
emm_ªg_t
 *);

181 
	`EmmRegi°îedUpd©eNìded
(c⁄° 
emm_ªg_t
 *);

182 
	`EmmRegi°îedNoCñlAvaûabÀ
(c⁄° 
emm_ªg_t
 *);

183 
	`EmmRegi°îedAâem±ögToUpd©e
(c⁄° 
emm_ªg_t
 *);

184 
	`EmmRegi°îedImsiDëachInôüãd
(c⁄° 
emm_ªg_t
 *);

185 
	`EmmTøckögAªaUpd©ögInôüãd
(c⁄° 
emm_ªg_t
 *);

186 
	`EmmSîvi˚Reque°Inôüãd
(c⁄° 
emm_ªg_t
 *);

188 #ifde‡
NAS_MME


189 
	`EmmComm⁄Pro˚duªInôüãd
(c⁄° 
emm_ªg_t
 *);

193 c⁄° 
emm_fsm_h™dÀr_t
 
_emm_fsm_h™dÀrs
[
EMM_STATE_MAX
] = {

194 
NULL
,

195 #ifde‡
NAS_UE


196 
EmmNuŒ
,

198 
EmmDîegi°îed
,

199 
EmmRegi°îed
,

200 
EmmDîegi°îedInôüãd
,

201 #ifde‡
NAS_UE


202 
EmmDîegi°îedN‹mÆSîvi˚
,

203 
EmmDîegi°îedLimôedSîvi˚
,

204 
EmmDîegi°îedAâem±ögToAâach
,

205 
EmmDîegi°îedPlmnSórch
,

206 
EmmDîegi°îedNoImsi
,

207 
EmmDîegi°îedAâachNìded
,

208 
EmmDîegi°îedNoCñlAvaûabÀ
,

209 
EmmRegi°îedInôüãd
,

210 
EmmRegi°îedN‹mÆSîvi˚
,

211 
EmmRegi°îedAâem±ögToUpd©e
,

212 
EmmRegi°îedLimôedSîvi˚
,

213 
EmmRegi°îedPlmnSórch
,

214 
EmmRegi°îedUpd©eNìded
,

215 
EmmRegi°îedNoCñlAvaûabÀ
,

216 
EmmRegi°îedAâem±ögToUpd©e
,

217 
EmmRegi°îedImsiDëachInôüãd
,

218 
EmmTøckögAªaUpd©ögInôüãd
,

219 
EmmSîvi˚Reque°Inôüãd
,

221 #ifde‡
NAS_MME


222 
EmmComm⁄Pro˚duªInôüãd
,

224 
	}
};

232 #i‡!
deföed
(
EPC_BUILD
)

233 
emm_fsm_°©e_t
 
	g_emm_fsm_°©us
[
EMM_FSM_NB_UE_MAX
];

254 
	$emm_fsm_öôülize
()

256 
ueid
;

257 
LOG_FUNC_IN
;

259 #ifde‡
NAS_UE


260 
_emm_fsm_°©us
[0] = 
EMM_NULL
;

263 #i‡
	`deföed
(
NAS_MME
Ë&& !deföed(
EPC_BUILD
)

264 
ueid
 = 0; ueid < 
EMM_FSM_NB_UE_MAX
; ueid++) {

265 
_emm_fsm_°©us
[
ueid
] = 
EMM_DEREGISTERED
;

269 
LOG_FUNC_OUT
;

270 
	}
}

287 
emm_fsm_£t_°©us
(

288 #ifde‡
NAS_MME


289 
ueid
,

290 *
˘x
,

292 
emm_fsm_°©e_t
 
°©us
)

294 
	gLOG_FUNC_IN
;

296 #ifde‡
NAS_UE


297 
	gueid
 = 0;

300 #i‡
deföed
(
EPC_BUILD
)

301 
emm_d©a_c⁄ãxt_t
 *
	gemm_˘x
 = (emm_d©a_c⁄ãxt_à*)
˘x
;

303 
DevAs£π
(
emm_˘x
 !
NULL
);

305 i‡((
	g°©us
 < 
	gEMM_STATE_MAX
Ë&& (
	gueid
 > 0)) {

306 
LOG_TRACE
(
INFO
, "EMM-FSM - Status changed: %s ===> %s",

307 
_emm_fsm_°©us_°r
[
emm_˘x
->
_emm_fsm_°©us
],

308 
_emm_fsm_°©us_°r
[
°©us
]);

309 i‡(
	g°©us
 !
emm_˘x
->
_emm_fsm_°©us
) {

310 
emm_˘x
->
_emm_fsm_°©us
 = 
°©us
;

312 
LOG_FUNC_RETURN
 (
RETURNok
);

315 i‡–(
	g°©us
 < 
	gEMM_STATE_MAX
Ë&& (
	gueid
 < 
	gEMM_FSM_NB_UE_MAX
) ) {

316 
LOG_TRACE
(
INFO
, "EMM-FSM - Status changed: %s ===> %s",

317 
_emm_fsm_°©us_°r
[
_emm_fsm_°©us
[
ueid
]],

318 
_emm_fsm_°©us_°r
[
°©us
]);

319 i‡(
	g°©us
 !
_emm_fsm_°©us
[
ueid
]) {

320 
_emm_fsm_°©us
[
ueid
] = 
°©us
;

322 
LOG_FUNC_RETURN
 (
RETURNok
);

326 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

344 #ifde‡
NAS_UE


345 
emm_fsm_°©e_t
 
	$emm_fsm_gë_°©us
()

347  (
_emm_fsm_°©us
[0]);

348 
	}
}

351 #ifde‡
NAS_MME


352 
emm_fsm_°©e_t
 
	$emm_fsm_gë_°©us
(
ueid
, *
˘x
)

354 #i‡
	`deföed
(
EPC_BUILD
)

355 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)
˘x
;

357 i‡(
emm_˘x
 !
NULL
) {

358  
emm_˘x
->
_emm_fsm_°©us
;

361 i‡(
ueid
 < 
EMM_FSM_NB_UE_MAX
) {

362  (
_emm_fsm_°©us
[
ueid
]);

365  
EMM_STATE_MAX
;

366 
	}
}

383 
	$emm_fsm_¥o˚ss
(c⁄° 
emm_ªg_t
 *
evt
)

385 
rc
;

386 
emm_fsm_°©e_t
 
°©us
;

387 
emm_ªg_¥imôive_t
 
¥imôive
;

389 
LOG_FUNC_IN
;

391 
¥imôive
 = 
evt
->primitive;

393 #ifde‡
NAS_UE


394 
°©us
 = 
_emm_fsm_°©us
[0];

396 #ifde‡
NAS_MME


397 #i‡
	`deföed
(
EPC_BUILD
)

398 
emm_d©a_c⁄ãxt_t
 *
emm_˘x
 = (emm_d©a_c⁄ãxt_à*)
evt
->
˘x
;

400 
	`DevAs£π
(
emm_˘x
 !
NULL
);

402 
°©us
 = 
	`emm_fsm_gë_°©us
(0, 
emm_˘x
);

404 i‡(
evt
->
ueid
 >
EMM_FSM_NB_UE_MAX
) {

405 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

407 
°©us
 = 
_emm_fsm_°©us
[
evt
->
ueid
];

411 
	`LOG_TRACE
(
INFO
, "EMM-FSM - ReceivedÉvent %s (%d) in state %s",

412 
_emm_fsm_evít_°r
[
¥imôive
 - 
_EMMREG_START
 - 1],Örimitive,

413 
_emm_fsm_°©us_°r
[
°©us
]);

415 #i‡
	`deföed
(
EPC_BUILD
)

416 
	`DevAs£π
(
°©us
 !
EMM_INVALID
);

420 
rc
 = (
_emm_fsm_h™dÀrs
[
°©us
])(
evt
);

422 
	`LOG_FUNC_RETURN
 (
rc
);

423 
	}
}

	@src/emm/sap/emm_fsm.h

47 #i‚de‡
__EMM_FSM_H__


48 
	#__EMM_FSM_H__


	)

50 
	~"emm_ªgDef.h
"

67 
	mEMM_INVALID
,

68 #ifde‡
NAS_UE


69 
	mEMM_NULL
,

71 
	mEMM_DEREGISTERED
,

72 
	mEMM_REGISTERED
,

73 
	mEMM_DEREGISTERED_INITIATED
,

74 #ifde‡
NAS_UE


75 
	mEMM_DEREGISTERED_NORMAL_SERVICE
,

76 
	mEMM_DEREGISTERED_LIMITED_SERVICE
,

77 
	mEMM_DEREGISTERED_ATTEMPTING_TO_ATTACH
,

78 
	mEMM_DEREGISTERED_PLMN_SEARCH
,

79 
	mEMM_DEREGISTERED_NO_IMSI
,

80 
	mEMM_DEREGISTERED_ATTACH_NEEDED
,

81 
	mEMM_DEREGISTERED_NO_CELL_AVAILABLE
,

82 
	mEMM_REGISTERED_INITIATED
,

83 
	mEMM_REGISTERED_NORMAL_SERVICE
,

84 
	mEMM_REGISTERED_ATTEMPTING_TO_UPDATE
,

85 
	mEMM_REGISTERED_LIMITED_SERVICE
,

86 
	mEMM_REGISTERED_PLMN_SEARCH
,

87 
	mEMM_REGISTERED_UPDATE_NEEDED
,

88 
	mEMM_REGISTERED_NO_CELL_AVAILABLE
,

89 
	mEMM_REGISTERED_ATTEMPTING_TO_UPDATE_MM
,

90 
	mEMM_REGISTERED_IMSI_DETACH_INITIATED
,

91 
	mEMM_TRACKING_AREA_UPDATING_INITIATED
,

92 
	mEMM_SERVICE_REQUEST_INITIATED
,

94 #ifde‡
NAS_MME


95 
	mEMM_COMMON_PROCEDURE_INITIATED
,

97 
	mEMM_STATE_MAX


98 } 
	temm_fsm_°©e_t
;

108 
emm_fsm_öôülize
();

110 #ifde‡
NAS_UE


111 
emm_fsm_£t_°©us
(
emm_fsm_°©e_t
 
°©us
);

112 
emm_fsm_°©e_t
 
emm_fsm_gë_°©us
();

114 #ifde‡
NAS_MME


115 
	gemm_d©a_c⁄ãxt_t
;

116 
emm_fsm_£t_°©us
(
ueid
, *
˘x
, 
emm_fsm_°©e_t
 
°©us
);

117 
emm_fsm_°©e_t
 
emm_fsm_gë_°©us
(
ueid
, *
˘x
);

120 
emm_fsm_¥o˚ss
(c⁄° 
emm_ªg_t
 *
evt
);

	@src/emm/sap/emm_recv.c

49 
	~"emm_ªcv.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~"emm_msgDef.h
"

54 
	~"emm_ˇu£.h
"

55 
	~"emm_¥oc.h
"

57 
	~<°rög.h
>

95 
	$emm_ªcv_°©us
(
ueid
, 
emm_°©us_msg
 *
msg
, *
emm_ˇu£
)

97 
LOG_FUNC_IN
;

99 
rc
;

101 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received EMM Status message (cause=%d)",

102 
msg
->
emmˇu£
);

107 *
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

111 
rc
 = 
	`emm_¥oc_°©us_öd
(
ueid
, 
msg
->
emmˇu£
);

113 
	`LOG_FUNC_RETURN
 (
rc
);

114 
	}
}

121 #ifde‡
NAS_UE


136 
	$emm_ªcv_©èch_ac˚±
(
©èch_ac˚±_msg
 *
msg
, *
emm_ˇu£
)

138 
LOG_FUNC_IN
;

140 
rc
;

141 
i
;

143 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Attach Accept message");

148 i‡(
msg
->
èûi°
.
ty≥oÊi°
 !=

149 
TRACKING_AREA_IDENTITY_LIST_ONE_PLMN_CONSECUTIVE_TACS
) {

152 *
emm_ˇu£
 = 
EMM_CAUSE_IE_NOT_IMPLEMENTED
;

153 } i‡–(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_GUTI_PRESENT
) &&

154 (
msg
->
guti
.guti.
ty≥ofidítôy
 !
EPS_MOBILE_IDENTITY_GUTI
) ) {

156 *
emm_ˇu£
 = 
EMM_CAUSE_IE_NOT_IMPLEMENTED
;

159 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

160 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

167 
T3412
, 
T3402
 = -1, 
T3423
 = -1;

168 
T3412
 = 
	`g¥s_timî_vÆue
(&
msg
->
t3412vÆue
);

169 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_T3402_VALUE_PRESENT
) {

170 
T3402
 = 
	`g¥s_timî_vÆue
(&
msg
->
t3402vÆue
);

172 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_T3423_VALUE_PRESENT
) {

173 
T3423
 = 
	`g¥s_timî_vÆue
(&
msg
->
t3423vÆue
);

179 
n_èis
 = 
msg
->
èûi°
.
numbîo„Àmíts
 + 1;

180 
èi_t
 
èi
[
n_èis
];

181 
i
 = 0; i < 
n_èis
; i++) {

182 
èi
[
i
].
∂mn
.
MCCdigô1
 = 
msg
->
èûi°
.
mccdigô1
;

183 
èi
[
i
].
∂mn
.
MCCdigô2
 = 
msg
->
èûi°
.
mccdigô2
;

184 
èi
[
i
].
∂mn
.
MCCdigô3
 = 
msg
->
èûi°
.
mccdigô3
;

185 
èi
[
i
].
∂mn
.
MNCdigô1
 = 
msg
->
èûi°
.
mncdigô1
;

186 
èi
[
i
].
∂mn
.
MNCdigô2
 = 
msg
->
èûi°
.
mncdigô2
;

187 
èi
[
i
].
∂mn
.
MNCdigô3
 = 
msg
->
èûi°
.
mncdigô3
;

188 
èi
[
i
].
èc
 = 
msg
->
èûi°
.tac + i;

191 
GUTI_t
 *
pguti
 = 
NULL
;

192 
GUTI_t
 
guti
;

193 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_GUTI_PRESENT
) {

194 
pguti
 = &
guti
;

195 
guti
.
gummei
.
∂mn
.
MCCdigô1
 = 
msg
->guti.guti.
mccdigô1
;

196 
guti
.
gummei
.
∂mn
.
MCCdigô2
 = 
msg
->guti.guti.
mccdigô2
;

197 
guti
.
gummei
.
∂mn
.
MCCdigô3
 = 
msg
->guti.guti.
mccdigô3
;

198 
guti
.
gummei
.
∂mn
.
MNCdigô1
 = 
msg
->guti.guti.
mncdigô1
;

199 
guti
.
gummei
.
∂mn
.
MNCdigô2
 = 
msg
->guti.guti.
mncdigô2
;

200 
guti
.
gummei
.
∂mn
.
MNCdigô3
 = 
msg
->guti.guti.
mncdigô3
;

201 
guti
.
gummei
.
MMEgid
 = 
msg
->guti.guti.
mmegroupid
;

202 
guti
.
gummei
.
MMEcode
 = 
msg
->guti.guti.
mmecode
;

203 
guti
.
m_tmsi
 = 
msg
->guti.guti.
mtmsi
;

206 
n_ïlmns
 = 0;

207 
∂mn_t
 
ïlmn
;

208 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_EQUIVALENT_PLMNS_PRESENT
) {

209 
n_ïlmns
 = 1;

210 
ïlmn
.
MCCdigô1
 = 
msg
->
equivÆíçlmns
.
mccdigô1
;

211 
ïlmn
.
MCCdigô2
 = 
msg
->
equivÆíçlmns
.
mccdigô2
;

212 
ïlmn
.
MCCdigô3
 = 
msg
->
equivÆíçlmns
.
mccdigô3
;

213 
ïlmn
.
MNCdigô1
 = 
msg
->
equivÆíçlmns
.
mncdigô1
;

214 
ïlmn
.
MNCdigô2
 = 
msg
->
equivÆíçlmns
.
mncdigô2
;

215 
ïlmn
.
MNCdigô3
 = 
msg
->
equivÆíçlmns
.
mncdigô3
;

219 
rc
 = 
	`emm_¥oc_©èch_ac˚±
(
T3412
, 
T3402
, 
T3423
, 
n_èis
, 
èi
, 
pguti
,

220 
n_ïlmns
, &
ïlmn
,

221 &
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
);

223 
	`LOG_FUNC_RETURN
 (
rc
);

224 
	}
}

240 
	$emm_ªcv_©èch_ªje˘
(
©èch_ªje˘_msg
 *
msg
, *
emm_ˇu£
)

242 
LOG_FUNC_IN
;

244 
rc
;

246 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Attach Reject message (cause=%d)",

247 
msg
->
emmˇu£
);

252 i‡–(
msg
->
emmˇu£
 =
EMM_CAUSE_ESM_FAILURE
) &&

253 !(
msg
->
¥e£n˚mask
 & 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
) ) {

257 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

260 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

261 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

267 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
) {

269 
rc
 = 
	`emm_¥oc_©èch_ªje˘
(
msg
->
emmˇu£
,

270 &
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
);

273 
rc
 = 
	`emm_¥oc_©èch_ªje˘
(
msg
->
emmˇu£
, 
NULL
);

276 
	`LOG_FUNC_RETURN
 (
rc
);

277 
	}
}

293 
	$emm_ªcv_dëach_ac˚±
(
dëach_ac˚±_msg
 *
msg
, *
emm_ˇu£
)

295 
LOG_FUNC_IN
;

297 
rc
;

299 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Detach Accept message");

305 
rc
 = 
	`emm_¥oc_dëach_ac˚±
();

307 
	`LOG_FUNC_RETURN
 (
rc
);

308 
	}
}

324 
	$emm_ªcv_idítôy_ªque°
(
idítôy_ªque°_msg
 *
msg
, *
emm_ˇu£
)

326 
LOG_FUNC_IN
;

328 
rc
;

330 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Identity Request message");

336 
emm_¥oc_idítôy_ty≥_t
 
ty≥
;

337 i‡(
msg
->
idítôyty≥
 =
IDENTITY_TYPE_2_IMSI
) {

338 
ty≥
 = 
EMM_IDENT_TYPE_IMSI
;

339 } i‡(
msg
->
idítôyty≥
 =
IDENTITY_TYPE_2_IMEI
) {

340 
ty≥
 = 
EMM_IDENT_TYPE_IMEI
;

341 } i‡(
msg
->
idítôyty≥
 =
IDENTITY_TYPE_2_IMEISV
) {

342 
ty≥
 = 
EMM_IDENT_TYPE_IMEISV
;

343 } i‡(
msg
->
idítôyty≥
 =
IDENTITY_TYPE_2_TMSI
) {

344 
ty≥
 = 
EMM_IDENT_TYPE_TMSI
;

347 
ty≥
 = 
EMM_IDENT_TYPE_IMSI
;

351 
rc
 = 
	`emm_¥oc_idítifiˇti⁄_ªque°
(
ty≥
);

353 
	`LOG_FUNC_RETURN
 (
rc
);

354 
	}
}

370 
	$emm_ªcv_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
msg
,

371 *
emm_ˇu£
)

373 
LOG_FUNC_IN
;

375 
rc
;

377 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Authentication Request message");

382 i‡–(
msg
->
authítiˇti⁄∑ømëîønd
.
ønd
.
Àngth
 == 0) ||

383 (
msg
->
authítiˇti⁄∑ømëîauä
.
auä
.
Àngth
 == 0) ) {

385 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

388 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

389 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

395 
rc
 = 
	`emm_¥oc_authítiˇti⁄_ªque°
(

396 
msg
->
«skey£tidítifõøsme
.
tsc
 !
NAS_KEY_SET_IDENTIFIER_MAPPED
,

397 
msg
->
«skey£tidítifõøsme
.
«skey£tidítifõr
,

398 &
msg
->
authítiˇti⁄∑ømëîønd
.
ønd
,

399 &
msg
->
authítiˇti⁄∑ømëîauä
.
auä
);

401 
	`LOG_FUNC_RETURN
 (
rc
);

402 
	}
}

418 
	$emm_ªcv_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
msg
,

419 *
emm_ˇu£
)

421 
LOG_FUNC_IN
;

423 
rc
;

425 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Authentication Reject message");

431 
rc
 = 
	`emm_¥oc_authítiˇti⁄_ªje˘
();

433 
	`LOG_FUNC_RETURN
 (
rc
);

434 
	}
}

450 
	$emm_ªcv_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
msg
,

451 *
emm_ˇu£
)

453 
LOG_FUNC_IN
;

455 
rc
;

457 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Security Mode Command message");

463 
rc
 = 
	`emm_¥oc_£curôy_mode_comm™d
(

464 
msg
->
«skey£tidítifõr
.
tsc
 !
NAS_KEY_SET_IDENTIFIER_MAPPED
,

465 
msg
->
«skey£tidítifõr
.naskeysetidentifier,

466 
msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥ofcùhîögÆg‹ôhm
,

467 
msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥oföãgrôyÆg‹ôhm
,

468 
msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
ìa
,

469 
msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
eü
);

471 
	`LOG_FUNC_RETURN
 (
rc
);

472 
	}
}

481 #ifde‡
NAS_MME


497 
	$emm_ªcv_©èch_ªque°
(
ueid
, c⁄° 
©èch_ªque°_msg
 *
msg
,

498 *
emm_ˇu£
)

500 
rc
;

501 
emm_¥oc_©èch_ty≥_t
 
ty≥
;

503 
LOG_FUNC_IN
;

505 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Attach Request message");

510 #i‡!
	`deföed
(
UPDATE_RELEASE_9
)

512 i‡–(
msg
->
ﬁdguti‹imsi
.
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) &&

513 !(
msg
->
¥e£n˚mask
 & 
ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
) ) {

516 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

517 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - [%08x] - Received GUTI identity without "

518 "ﬁd GUTI IEI", 
ueid
);

521 i‡(
msg
->
uíëw‹kˇ∑bûôy
.
•¨e
 != 0b000) {

523 *
emm_ˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

524 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - [%08x] - Non zero spare bits is suspicious",

525 
ueid
);

528 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

531 
rc
 = 
	`emm_¥oc_©èch_ªje˘
(
ueid
, *
emm_ˇu£
);

532 *
emm_ˇu£
 = 
EMM_CAUSE_SUCCESS
;

533 
	`LOG_FUNC_RETURN
 (
rc
);

539 i‡(
msg
->
ïßâachty≥
 =
EPS_ATTACH_TYPE_EPS
) {

540 
ty≥
 = 
EMM_ATTACH_TYPE_EPS
;

541 } i‡(
msg
->
ïßâachty≥
 =
EPS_ATTACH_TYPE_IMSI
) {

542 
ty≥
 = 
EMM_ATTACH_TYPE_IMSI
;

543 } i‡(
msg
->
ïßâachty≥
 =
EPS_ATTACH_TYPE_EMERGENCY
) {

544 
ty≥
 = 
EMM_ATTACH_TYPE_EMERGENCY
;

545 } i‡(
msg
->
ïßâachty≥
 =
EPS_ATTACH_TYPE_RESERVED
) {

546 
ty≥
 = 
EMM_ATTACH_TYPE_RESERVED
;

549 
ty≥
 = 
EMM_ATTACH_TYPE_EPS
;

553 
GUTI_t
 
guti
, *
p_guti
 = 
NULL
;

554 
imsi_t
 
imsi
, *
p_imsi
 = 
NULL
;

555 
imei_t
 
imei
, *
p_imei
 = 
NULL
;

556 i‡(
msg
->
ﬁdguti‹imsi
.
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) {

558 
p_guti
 = &
guti
;

559 
guti
.
gummei
.
∂mn
.
MCCdigô1
 = 
msg
->
ﬁdguti‹imsi
.guti.
mccdigô1
;

560 
guti
.
gummei
.
∂mn
.
MCCdigô2
 = 
msg
->
ﬁdguti‹imsi
.guti.
mccdigô2
;

561 
guti
.
gummei
.
∂mn
.
MCCdigô3
 = 
msg
->
ﬁdguti‹imsi
.guti.
mccdigô3
;

562 
guti
.
gummei
.
∂mn
.
MNCdigô1
 = 
msg
->
ﬁdguti‹imsi
.guti.
mncdigô1
;

563 
guti
.
gummei
.
∂mn
.
MNCdigô2
 = 
msg
->
ﬁdguti‹imsi
.guti.
mncdigô2
;

564 
guti
.
gummei
.
∂mn
.
MNCdigô3
 = 
msg
->
ﬁdguti‹imsi
.guti.
mncdigô3
;

565 
guti
.
gummei
.
MMEgid
 = 
msg
->
ﬁdguti‹imsi
.guti.
mmegroupid
;

566 
guti
.
gummei
.
MMEcode
 = 
msg
->
ﬁdguti‹imsi
.guti.
mmecode
;

567 
guti
.
m_tmsi
 = 
msg
->
ﬁdguti‹imsi
.guti.
mtmsi
;

568 } i‡(
msg
->
ﬁdguti‹imsi
.
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

570 
p_imsi
 = &
imsi
;

571 
imsi
.
u
.
num
.
digô1
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit1;

572 
imsi
.
u
.
num
.
digô2
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit2;

573 
imsi
.
u
.
num
.
digô3
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit3;

574 
imsi
.
u
.
num
.
digô4
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit4;

575 
imsi
.
u
.
num
.
digô5
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit5;

576 
imsi
.
u
.
num
.
digô6
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit6;

577 
imsi
.
u
.
num
.
digô7
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit7;

578 
imsi
.
u
.
num
.
digô8
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit8;

579 
imsi
.
u
.
num
.
digô9
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit9;

580 
imsi
.
u
.
num
.
digô10
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit10;

581 
imsi
.
u
.
num
.
digô11
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit11;

582 
imsi
.
u
.
num
.
digô12
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit12;

583 
imsi
.
u
.
num
.
digô13
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit13;

584 
imsi
.
u
.
num
.
digô14
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit14;

585 
imsi
.
u
.
num
.
digô15
 = 
msg
->
ﬁdguti‹imsi
.imsi.digit15;

586 
imsi
.
u
.
num
.
∑rôy
 = 
msg
->
ﬁdguti‹imsi
.imsi.
oddeví
;

587 } i‡(
msg
->
ﬁdguti‹imsi
.
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
) {

589 
p_imei
 = &
imei
;

590 
imei
.
u
.
num
.
digô1
 = 
msg
->
ﬁdguti‹imsi
.imei.digit1;

591 
imei
.
u
.
num
.
digô2
 = 
msg
->
ﬁdguti‹imsi
.imei.digit2;

592 
imei
.
u
.
num
.
digô3
 = 
msg
->
ﬁdguti‹imsi
.imei.digit3;

593 
imei
.
u
.
num
.
digô4
 = 
msg
->
ﬁdguti‹imsi
.imei.digit4;

594 
imei
.
u
.
num
.
digô5
 = 
msg
->
ﬁdguti‹imsi
.imei.digit5;

595 
imei
.
u
.
num
.
digô6
 = 
msg
->
ﬁdguti‹imsi
.imei.digit6;

596 
imei
.
u
.
num
.
digô7
 = 
msg
->
ﬁdguti‹imsi
.imei.digit7;

597 
imei
.
u
.
num
.
digô8
 = 
msg
->
ﬁdguti‹imsi
.imei.digit8;

598 
imei
.
u
.
num
.
digô9
 = 
msg
->
ﬁdguti‹imsi
.imei.digit9;

599 
imei
.
u
.
num
.
digô10
 = 
msg
->
ﬁdguti‹imsi
.imei.digit10;

600 
imei
.
u
.
num
.
digô11
 = 
msg
->
ﬁdguti‹imsi
.imei.digit11;

601 
imei
.
u
.
num
.
digô12
 = 
msg
->
ﬁdguti‹imsi
.imei.digit12;

602 
imei
.
u
.
num
.
digô13
 = 
msg
->
ﬁdguti‹imsi
.imei.digit13;

603 
imei
.
u
.
num
.
digô14
 = 
msg
->
ﬁdguti‹imsi
.imei.digit14;

604 
imei
.
u
.
num
.
digô15
 = 
msg
->
ﬁdguti‹imsi
.imei.digit15;

605 
imei
.
u
.
num
.
∑rôy
 = 
msg
->
ﬁdguti‹imsi
.imei.
oddeví
;

610 
èi_t
 
èi
, *
p_èi
 = 
NULL
;

611 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
) {

612 
p_èi
 = &
èi
;

613 
èi
.
∂mn
.
MCCdigô1
 = 
msg
->
œ°visôedªgi°îedèi
.
mccdigô1
;

614 
èi
.
∂mn
.
MCCdigô2
 = 
msg
->
œ°visôedªgi°îedèi
.
mccdigô2
;

615 
èi
.
∂mn
.
MCCdigô3
 = 
msg
->
œ°visôedªgi°îedèi
.
mccdigô3
;

616 
èi
.
∂mn
.
MNCdigô1
 = 
msg
->
œ°visôedªgi°îedèi
.
mncdigô1
;

617 
èi
.
∂mn
.
MNCdigô2
 = 
msg
->
œ°visôedªgi°îedèi
.
mncdigô2
;

618 
èi
.
∂mn
.
MNCdigô3
 = 
msg
->
œ°visôedªgi°îedèi
.
mncdigô3
;

619 
èi
.
èc
 = 
msg
->
œ°visôedªgi°îedèi
.tac;

623 
rc
 = 
	`emm_¥oc_©èch_ªque°
(
ueid
, 
ty≥
,

624 
msg
->
«skey£tidítifõr
.
tsc
 !
NAS_KEY_SET_IDENTIFIER_MAPPED
,

625 
msg
->
«skey£tidítifõr
.naskeysetidentifier,

626 
msg
->
ﬁdgutôy≥
 !
GUTI_MAPPED
, 
p_guti
, 
p_imsi
, 
p_imei
, 
p_èi
,

627 
msg
->
uíëw‹kˇ∑bûôy
.
ìa
,

628 
msg
->
uíëw‹kˇ∑bûôy
.
eü
,

629 
msg
->
uíëw‹kˇ∑bûôy
.
ucs2
,

630 
msg
->
uíëw‹kˇ∑bûôy
.
uó
,

631 
msg
->
uíëw‹kˇ∑bûôy
.
uü
,

634 ((
msg
->
uíëw‹kˇ∑bûôy
.
csfb
 & 0x1) << 4) |

635 ((
msg
->
uíëw‹kˇ∑bûôy
.
Õp
 & 0x1) << 3) |

636 ((
msg
->
uíëw‹kˇ∑bûôy
.
lcs
 & 0x1) << 2) |

637 ((
msg
->
uíëw‹kˇ∑bûôy
.
§vcc
 & 0x1) << 1) |

638 (
msg
->
uíëw‹kˇ∑bûôy
.
nf
 & 0x1),

639 
msg
->
uíëw‹kˇ∑bûôy
.
umts_¥e£¡
,

640 
msg
->
uíëw‹kˇ∑bûôy
.
g¥s_¥e£¡
,

641 &
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
);

643 
	`LOG_FUNC_RETURN
 (
rc
);

644 
	}
}

661 
	$emm_ªcv_©èch_com∂ëe
(
ueid
, c⁄° 
©èch_com∂ëe_msg
 *
msg
,

662 *
emm_ˇu£
)

664 
LOG_FUNC_IN
;

666 
rc
;

668 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Attach Complete message");

671 
rc
 = 
	`emm_¥oc_©èch_com∂ëe
(
ueid
,

672 &
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
);

674 
	`LOG_FUNC_RETURN
 (
rc
);

675 
	}
}

692 
	$emm_ªcv_dëach_ªque°
(
ueid
, c⁄° 
dëach_ªque°_msg
 *
msg
,

693 *
emm_ˇu£
)

695 
LOG_FUNC_IN
;

697 
rc
;

699 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Detach Request message");

705 
emm_¥oc_dëach_ty≥_t
 
ty≥
;

706 i‡(
msg
->
dëachty≥
.
ty≥ofdëach
 =
DETACH_TYPE_EPS
) {

707 
ty≥
 = 
EMM_DETACH_TYPE_EPS
;

708 } i‡(
msg
->
dëachty≥
.
ty≥ofdëach
 =
DETACH_TYPE_IMSI
) {

709 
ty≥
 = 
EMM_DETACH_TYPE_IMSI
;

710 } i‡(
msg
->
dëachty≥
.
ty≥ofdëach
 =
DETACH_TYPE_EPS_IMSI
) {

711 
ty≥
 = 
EMM_DETACH_TYPE_EPS_IMSI
;

712 } i‡(
msg
->
dëachty≥
.
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_1
) {

713 
ty≥
 = 
EMM_DETACH_TYPE_RESERVED
;

714 } i‡(
msg
->
dëachty≥
.
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_2
) {

715 
ty≥
 = 
EMM_DETACH_TYPE_RESERVED
;

718 
ty≥
 = 
DETACH_TYPE_EPS_IMSI
;

722 
GUTI_t
 
guti
, *
p_guti
 = 
NULL
;

723 
imsi_t
 
imsi
, *
p_imsi
 = 
NULL
;

724 
imei_t
 
imei
, *
p_imei
 = 
NULL
;

725 i‡(
msg
->
guti‹imsi
.
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) {

727 
p_guti
 = &
guti
;

728 
guti
.
gummei
.
∂mn
.
MCCdigô1
 = 
msg
->
guti‹imsi
.guti.
mccdigô1
;

729 
guti
.
gummei
.
∂mn
.
MCCdigô2
 = 
msg
->
guti‹imsi
.guti.
mccdigô2
;

730 
guti
.
gummei
.
∂mn
.
MCCdigô3
 = 
msg
->
guti‹imsi
.guti.
mccdigô3
;

731 
guti
.
gummei
.
∂mn
.
MNCdigô1
 = 
msg
->
guti‹imsi
.guti.
mncdigô1
;

732 
guti
.
gummei
.
∂mn
.
MNCdigô2
 = 
msg
->
guti‹imsi
.guti.
mncdigô2
;

733 
guti
.
gummei
.
∂mn
.
MNCdigô3
 = 
msg
->
guti‹imsi
.guti.
mncdigô3
;

734 
guti
.
gummei
.
MMEgid
 = 
msg
->
guti‹imsi
.guti.
mmegroupid
;

735 
guti
.
gummei
.
MMEcode
 = 
msg
->
guti‹imsi
.guti.
mmecode
;

736 
guti
.
m_tmsi
 = 
msg
->
guti‹imsi
.guti.
mtmsi
;

737 } i‡(
msg
->
guti‹imsi
.
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

739 
p_imsi
 = &
imsi
;

740 
imsi
.
u
.
num
.
digô1
 = 
msg
->
guti‹imsi
.imsi.digit1;

741 
imsi
.
u
.
num
.
digô2
 = 
msg
->
guti‹imsi
.imsi.digit2;

742 
imsi
.
u
.
num
.
digô3
 = 
msg
->
guti‹imsi
.imsi.digit3;

743 
imsi
.
u
.
num
.
digô4
 = 
msg
->
guti‹imsi
.imsi.digit4;

744 
imsi
.
u
.
num
.
digô5
 = 
msg
->
guti‹imsi
.imsi.digit5;

745 
imsi
.
u
.
num
.
digô6
 = 
msg
->
guti‹imsi
.imsi.digit6;

746 
imsi
.
u
.
num
.
digô7
 = 
msg
->
guti‹imsi
.imsi.digit7;

747 
imsi
.
u
.
num
.
digô8
 = 
msg
->
guti‹imsi
.imsi.digit8;

748 
imsi
.
u
.
num
.
digô9
 = 
msg
->
guti‹imsi
.imsi.digit9;

749 
imsi
.
u
.
num
.
digô10
 = 
msg
->
guti‹imsi
.imsi.digit10;

750 
imsi
.
u
.
num
.
digô11
 = 
msg
->
guti‹imsi
.imsi.digit11;

751 
imsi
.
u
.
num
.
digô12
 = 
msg
->
guti‹imsi
.imsi.digit12;

752 
imsi
.
u
.
num
.
digô13
 = 
msg
->
guti‹imsi
.imsi.digit13;

753 
imsi
.
u
.
num
.
digô14
 = 
msg
->
guti‹imsi
.imsi.digit14;

754 
imsi
.
u
.
num
.
digô15
 = 
msg
->
guti‹imsi
.imsi.digit15;

755 
imsi
.
u
.
num
.
∑rôy
 = 
msg
->
guti‹imsi
.imsi.
oddeví
;

756 } i‡(
msg
->
guti‹imsi
.
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
) {

758 
p_imei
 = &
imei
;

759 
imei
.
u
.
num
.
digô1
 = 
msg
->
guti‹imsi
.imei.digit1;

760 
imei
.
u
.
num
.
digô2
 = 
msg
->
guti‹imsi
.imei.digit2;

761 
imei
.
u
.
num
.
digô3
 = 
msg
->
guti‹imsi
.imei.digit3;

762 
imei
.
u
.
num
.
digô4
 = 
msg
->
guti‹imsi
.imei.digit4;

763 
imei
.
u
.
num
.
digô5
 = 
msg
->
guti‹imsi
.imei.digit5;

764 
imei
.
u
.
num
.
digô6
 = 
msg
->
guti‹imsi
.imei.digit6;

765 
imei
.
u
.
num
.
digô7
 = 
msg
->
guti‹imsi
.imei.digit7;

766 
imei
.
u
.
num
.
digô8
 = 
msg
->
guti‹imsi
.imei.digit8;

767 
imei
.
u
.
num
.
digô9
 = 
msg
->
guti‹imsi
.imei.digit9;

768 
imei
.
u
.
num
.
digô10
 = 
msg
->
guti‹imsi
.imei.digit10;

769 
imei
.
u
.
num
.
digô11
 = 
msg
->
guti‹imsi
.imei.digit11;

770 
imei
.
u
.
num
.
digô12
 = 
msg
->
guti‹imsi
.imei.digit12;

771 
imei
.
u
.
num
.
digô13
 = 
msg
->
guti‹imsi
.imei.digit13;

772 
imei
.
u
.
num
.
digô14
 = 
msg
->
guti‹imsi
.imei.digit14;

773 
imei
.
u
.
num
.
digô15
 = 
msg
->
guti‹imsi
.imei.digit15;

774 
imei
.
u
.
num
.
∑rôy
 = 
msg
->
guti‹imsi
.imei.
oddeví
;

778 
rc
 = 
	`emm_¥oc_dëach_ªque°
(
ueid
, 
ty≥
,

779 
msg
->
dëachty≥
.
swôchoff
 !
DETACH_TYPE_NORMAL_DETACH
,

780 
msg
->
«skey£tidítifõr
.
tsc
 !
NAS_KEY_SET_IDENTIFIER_MAPPED
,

781 
msg
->
«skey£tidítifõr
.naskeysetidentifier,

782 
p_guti
, 
p_imsi
, 
p_imei
);

784 
	`LOG_FUNC_RETURN
 (
rc
);

785 
	}
}

802 
	$emm_ªcv_åackög_¨ó_upd©e_ªque°
(
ueid
,

803 c⁄° 
åackög_¨ó_upd©e_ªque°_msg
 *
msg
,

804 *
emm_ˇu£
)

806 
rc
 = 
RETURNok
;

808 
LOG_FUNC_IN
;

810 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Tracking Area Update Request message");

813 
rc
 = 
	`emm_¥oc_åackög_¨ó_upd©e_ªje˘
(
ueid
, 
EMM_CAUSE_IMPLICITLY_DETACHED
);

815 
	`LOG_FUNC_RETURN
 (
rc
);

816 
	}
}

833 
	$emm_ªcv_idítôy_ª•⁄£
(
ueid
, 
idítôy_ª•⁄£_msg
 *
msg
,

834 *
emm_ˇu£
)

836 
LOG_FUNC_IN
;

838 
rc
 = 
RETURNok
;

840 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Identity Response message");

846 
imsi_t
 
imsi
, *
p_imsi
 = 
NULL
;

847 
imei_t
 
imei
, *
p_imei
 = 
NULL
;

848 
	stmsi_°ru˘_t
 {

849 
uöt8_t
 
digô1
:4;

850 
uöt8_t
 
digô2
:4;

851 
uöt8_t
 
digô3
:4;

852 
uöt8_t
 
digô4
:4;

853 
uöt8_t
 
digô5
:4;

854 
uöt8_t
 
digô6
:4;

855 
uöt8_t
 
digô7
:4;

856 
uöt8_t
 
digô8
:4;

857 } 
tmsi
, *
p_tmsi
 = 
NULL
;

858 i‡(
msg
->
mobûeidítôy
.
imsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMSI
) {

860 
p_imsi
 = &
imsi
;

861 
imsi
.
u
.
num
.
digô1
 = 
msg
->
mobûeidítôy
.imsi.digit1;

862 
imsi
.
u
.
num
.
digô2
 = 
msg
->
mobûeidítôy
.imsi.digit2;

863 
imsi
.
u
.
num
.
digô3
 = 
msg
->
mobûeidítôy
.imsi.digit3;

864 
imsi
.
u
.
num
.
digô4
 = 
msg
->
mobûeidítôy
.imsi.digit4;

865 
imsi
.
u
.
num
.
digô5
 = 
msg
->
mobûeidítôy
.imsi.digit5;

866 
imsi
.
u
.
num
.
digô6
 = 
msg
->
mobûeidítôy
.imsi.digit6;

867 
imsi
.
u
.
num
.
digô7
 = 
msg
->
mobûeidítôy
.imsi.digit7;

868 
imsi
.
u
.
num
.
digô8
 = 
msg
->
mobûeidítôy
.imsi.digit8;

869 
imsi
.
u
.
num
.
digô9
 = 
msg
->
mobûeidítôy
.imsi.digit9;

870 
imsi
.
u
.
num
.
digô10
 = 
msg
->
mobûeidítôy
.imsi.digit10;

871 
imsi
.
u
.
num
.
digô11
 = 
msg
->
mobûeidítôy
.imsi.digit11;

872 
imsi
.
u
.
num
.
digô12
 = 
msg
->
mobûeidítôy
.imsi.digit12;

873 
imsi
.
u
.
num
.
digô13
 = 
msg
->
mobûeidítôy
.imsi.digit13;

874 
imsi
.
u
.
num
.
digô14
 = 
msg
->
mobûeidítôy
.imsi.digit14;

875 
imsi
.
u
.
num
.
digô15
 = 
msg
->
mobûeidítôy
.imsi.digit15;

876 
imsi
.
u
.
num
.
∑rôy
 = 
msg
->
mobûeidítôy
.imsi.
oddeví
;

877 } i‡((
msg
->
mobûeidítôy
.
imei
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEI
) ||

878 (
msg
->
mobûeidítôy
.
imeisv
.
ty≥ofidítôy
==
MOBILE_IDENTITY_IMEISV
)) {

880 
p_imei
 = &
imei
;

881 
imei
.
u
.
num
.
digô1
 = 
msg
->
mobûeidítôy
.imei.digit1;

882 
imei
.
u
.
num
.
digô2
 = 
msg
->
mobûeidítôy
.imei.digit2;

883 
imei
.
u
.
num
.
digô3
 = 
msg
->
mobûeidítôy
.imei.digit3;

884 
imei
.
u
.
num
.
digô4
 = 
msg
->
mobûeidítôy
.imei.digit4;

885 
imei
.
u
.
num
.
digô5
 = 
msg
->
mobûeidítôy
.imei.digit5;

886 
imei
.
u
.
num
.
digô6
 = 
msg
->
mobûeidítôy
.imei.digit6;

887 
imei
.
u
.
num
.
digô7
 = 
msg
->
mobûeidítôy
.imei.digit7;

888 
imei
.
u
.
num
.
digô8
 = 
msg
->
mobûeidítôy
.imei.digit8;

889 
imei
.
u
.
num
.
digô9
 = 
msg
->
mobûeidítôy
.imei.digit9;

890 
imei
.
u
.
num
.
digô10
 = 
msg
->
mobûeidítôy
.imei.digit10;

891 
imei
.
u
.
num
.
digô11
 = 
msg
->
mobûeidítôy
.imei.digit11;

892 
imei
.
u
.
num
.
digô12
 = 
msg
->
mobûeidítôy
.imei.digit12;

893 
imei
.
u
.
num
.
digô13
 = 
msg
->
mobûeidítôy
.imei.digit13;

894 
imei
.
u
.
num
.
digô14
 = 
msg
->
mobûeidítôy
.imei.digit14;

895 
imei
.
u
.
num
.
digô15
 = 
msg
->
mobûeidítôy
.imei.digit15;

896 
imei
.
u
.
num
.
∑rôy
 = 
msg
->
mobûeidítôy
.imei.
oddeví
;

897 } i‡(
msg
->
mobûeidítôy
.
tmsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMSI
) {

899 
p_tmsi
 = &
tmsi
;

900 
tmsi
.
digô1
 = 
msg
->
mobûeidítôy
.tmsi.
digô2
;

901 
tmsi
.
digô2
 = 
msg
->
mobûeidítôy
.tmsi.
digô3
;

902 
tmsi
.
digô3
 = 
msg
->
mobûeidítôy
.tmsi.
digô4
;

903 
tmsi
.
digô4
 = 
msg
->
mobûeidítôy
.tmsi.
digô5
;

904 
tmsi
.
digô5
 = 
msg
->
mobûeidítôy
.tmsi.
digô6
;

905 
tmsi
.
digô6
 = 
msg
->
mobûeidítôy
.tmsi.
digô7
;

906 
tmsi
.
digô7
 = 
msg
->
mobûeidítôy
.tmsi.
digô8
;

907 
tmsi
.
digô8
 = 
msg
->
mobûeidítôy
.tmsi.
digô9
;

911 
rc
 = 
	`emm_¥oc_idítifiˇti⁄_com∂ëe
(
ueid
, 
p_imsi
, 
p_imei
,

912 (
UI¡32_t
 *)(
p_tmsi
));

913 
	`LOG_FUNC_RETURN
 (
rc
);

914 
	}
}

931 
	$emm_ªcv_authítiˇti⁄_ª•⁄£
(
ueid
,

932 
authítiˇti⁄_ª•⁄£_msg
 *
msg
,

933 *
emm_ˇu£
)

935 
LOG_FUNC_IN
;

937 
rc
 = 
RETURNok
;

939 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Authentication Response message");

944 i‡(
msg
->
authítiˇti⁄ª•⁄£∑ømëî
.
ªs
.
Àngth
 == 0) {

946 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

949 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

950 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

956 
rc
 = 
	`emm_¥oc_authítiˇti⁄_com∂ëe
(
ueid
, 
EMM_CAUSE_SUCCESS
,

957 &
msg
->
authítiˇti⁄ª•⁄£∑ømëî
.
ªs
);

958 
	`LOG_FUNC_RETURN
 (
rc
);

959 
	}
}

976 
	$emm_ªcv_authítiˇti⁄_Áûuª
(
ueid
,

977 
authítiˇti⁄_Áûuª_msg
 *
msg
,

978 *
emm_ˇu£
)

980 
LOG_FUNC_IN
;

982 
rc
 = 
RETURNok
;

984 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Authentication Failure message");

989 i‡(
msg
->
emmˇu£
 =
EMM_CAUSE_SUCCESS
) {

990 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

991 } i‡–(
msg
->
emmˇu£
 =
EMM_CAUSE_SYNCH_FAILURE
) &&

992 !(
msg
->
¥e£n˚mask
 &

993 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
) ) {

995 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

998 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

999 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1005 
rc
 = 
	`emm_¥oc_authítiˇti⁄_com∂ëe
(
ueid
, 
msg
->
emmˇu£
,

1006 &
msg
->
authítiˇti⁄Áûuª∑ømëî
.
auts
);

1007 
	`LOG_FUNC_RETURN
 (
rc
);

1008 
	}
}

1026 
	$emm_ªcv_£curôy_mode_com∂ëe
(

1027 
ueid
,

1028 
£curôy_mode_com∂ëe_msg
 *
msg
,

1029 *
emm_ˇu£
)

1031 
LOG_FUNC_IN
;

1033 
rc
 = 
RETURNok
;

1035 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Security Mode Complete message");

1041 
rc
 = 
	`emm_¥oc_£curôy_mode_com∂ëe
(
ueid
);

1043 
	`LOG_FUNC_RETURN
 (
rc
);

1044 
	}
}

1061 
	$emm_ªcv_£curôy_mode_ªje˘
(
ueid
,

1062 
£curôy_mode_ªje˘_msg
 *
msg
,

1063 *
emm_ˇu£
)

1065 
LOG_FUNC_IN
;

1067 
rc
 = 
RETURNok
;

1069 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Received Security Mode Reject message "

1070 "(ˇu£=%d)", 
msg
->
emmˇu£
);

1075 i‡(
msg
->
emmˇu£
 =
EMM_CAUSE_SUCCESS
) {

1076 *
emm_ˇu£
 = 
EMM_CAUSE_INVALID_MANDATORY_INFO
;

1079 i‡(*
emm_ˇu£
 !
EMM_CAUSE_SUCCESS
) {

1080 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1087 
rc
 = 
	`emm_¥oc_£curôy_mode_ªje˘
(
ueid
);

1089 
	`LOG_FUNC_RETURN
 (
rc
);

1090 
	}
}

	@src/emm/sap/emm_recv.h

48 #i‚de‡
__EMM_RECV_H__


49 
	#__EMM_RECV_H__


	)

51 
	~"EmmSètus.h
"

53 
	~"DëachReque°.h
"

54 
	~"DëachAc˚±.h
"

56 #ifde‡
NAS_UE


57 
	~"AâachAc˚±.h
"

58 
	~"AâachReje˘.h
"

59 
	~"TøckögAªaUpd©eAc˚±.h
"

60 
	~"TøckögAªaUpd©eReje˘.h
"

61 
	~"Sîvi˚Reje˘.h
"

62 
	~"GutiRóŒoˇti⁄Comm™d.h
"

63 
	~"Authítiˇti⁄Reque°.h
"

64 
	~"Authítiˇti⁄Reje˘.h
"

65 
	~"IdítôyReque°.h
"

66 
	~"NASSecurôyModeComm™d.h
"

67 
	~"EmmInf‹m©i⁄.h
"

68 
	~"Dow∆ökNasTøn•‹t.h
"

69 
	~"CsSîvi˚NŸifiˇti⁄.h
"

72 #ifde‡
NAS_MME


73 
	~"AâachReque°.h
"

74 
	~"AâachCom∂ëe.h
"

75 
	~"TøckögAªaUpd©eReque°.h
"

76 
	~"TøckögAªaUpd©eCom∂ëe.h
"

77 
	~"Sîvi˚Reque°.h
"

78 
	~"ExãndedSîvi˚Reque°.h
"

79 
	~"GutiRóŒoˇti⁄Com∂ëe.h
"

80 
	~"Authítiˇti⁄Re•⁄£.h
"

81 
	~"Authítiˇti⁄Faûuª.h
"

82 
	~"IdítôyRe•⁄£.h
"

83 
	~"NASSecurôyModeCom∂ëe.h
"

84 
	~"SecurôyModeReje˘.h
"

85 
	~"U∂ökNasTøn•‹t.h
"

109 
emm_ªcv_°©us
(
ueid
, 
emm_°©us_msg
 *
msg
, *
emm_ˇu£
);

116 #ifde‡
NAS_UE


117 
emm_ªcv_©èch_ac˚±
(
©èch_ac˚±_msg
 *
msg
, *
emm_ˇu£
);

118 
emm_ªcv_©èch_ªje˘
(
©èch_ªje˘_msg
 *
msg
, *
emm_ˇu£
);

120 
emm_ªcv_dëach_ac˚±
(
dëach_ac˚±_msg
 *
msg
, *
emm_ˇu£
);

122 
emm_ªcv_idítôy_ªque°
(
idítôy_ªque°_msg
 *
msg
, *
emm_ˇu£
);

123 
emm_ªcv_authítiˇti⁄_ªque°
(
authítiˇti⁄_ªque°_msg
 *
msg
,

124 *
emm_ˇu£
);

125 
emm_ªcv_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
msg
,

126 *
emm_ˇu£
);

127 
emm_ªcv_£curôy_mode_comm™d
(
£curôy_mode_comm™d_msg
 *
msg
,

128 *
emm_ˇu£
);

136 #ifde‡
NAS_MME


137 
emm_ªcv_©èch_ªque°
(
ueid
, c⁄° 
©èch_ªque°_msg
 *
msg
,

138 *
emm_ˇu£
);

139 
emm_ªcv_©èch_com∂ëe
(
ueid
, c⁄° 
©èch_com∂ëe_msg
 *
msg
,

140 *
emm_ˇu£
);

142 
emm_ªcv_dëach_ªque°
(
ueid
, c⁄° 
dëach_ªque°_msg
 *
msg
,

143 *
emm_ˇu£
);

145 
emm_ªcv_åackög_¨ó_upd©e_ªque°
(
ueid
,

146 c⁄° 
åackög_¨ó_upd©e_ªque°_msg
 *
msg
,

147 *
emm_ˇu£
);

149 
emm_ªcv_idítôy_ª•⁄£
(
ueid
, 
idítôy_ª•⁄£_msg
 *
msg
,

150 *
emm_ˇu£
);

151 
emm_ªcv_authítiˇti⁄_ª•⁄£
(
ueid
,

152 
authítiˇti⁄_ª•⁄£_msg
 *
msg
, *
emm_ˇu£
);

153 
emm_ªcv_authítiˇti⁄_Áûuª
(
ueid
,

154 
authítiˇti⁄_Áûuª_msg
 *
msg
, *
emm_ˇu£
);

155 
emm_ªcv_£curôy_mode_com∂ëe
(
ueid
,

156 
£curôy_mode_com∂ëe_msg
 *
msg
, *
emm_ˇu£
);

157 
emm_ªcv_£curôy_mode_ªje˘
(
ueid
,

158 
£curôy_mode_ªje˘_msg
 *
msg
, *
emm_ˇu£
);

	@src/emm/sap/emm_reg.c

49 
	~"emm_ªg.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~"emm_fsm.h
"

55 
	~<as£π.h
>

83 
	$emm_ªg_öôülize
()

85 
LOG_FUNC_IN
;

88 
	`emm_fsm_öôülize
();

90 
LOG_FUNC_OUT
;

91 
	}
}

107 
	$emm_ªg_£nd
(c⁄° 
emm_ªg_t
 *
msg
)

109 
LOG_FUNC_IN
;

111 
rc
;

114 
emm_ªg_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

115 
	`as£π
–(
¥imôive
 > 
_EMMREG_START
Ë&& (¥imôivê< 
_EMMREG_END
));

118 
rc
 = 
	`emm_fsm_¥o˚ss
(
msg
);

120 
	`LOG_FUNC_RETURN
 (
rc
);

121 
	}
}

	@src/emm/sap/emm_reg.h

48 #i‚de‡
__EMM_REG_H__


49 
	#__EMM_REG_H__


	)

51 
	~"emm_ªgDef.h
"

69 
emm_ªg_öôülize
();

71 
emm_ªg_£nd
(c⁄° 
emm_ªg_t
 *
msg
);

	@src/emm/sap/emm_regDef.h

48 #i‚de‡
__EMM_REGDEF_H__


49 
	#__EMM_REGDEF_H__


	)

51 
	~"comm⁄Def.h
"

61 
	m_EMMREG_START
 = 0,

62 #ifde‡
NAS_UE


63 
	m_EMMREG_S1_ENABLED
,

64 
	m_EMMREG_S1_DISABLED
,

65 
	m_EMMREG_NO_IMSI
,

66 
	m_EMMREG_NO_CELL
,

67 
	m_EMMREG_REGISTER_REQ
,

68 
	m_EMMREG_REGISTER_CNF
,

69 
	m_EMMREG_REGISTER_REJ
,

70 
	m_EMMREG_ATTACH_INIT
,

71 
	m_EMMREG_ATTACH_REQ
,

72 
	m_EMMREG_ATTACH_FAILED
,

73 
	m_EMMREG_ATTACH_EXCEEDED
,

74 
	m_EMMREG_AUTH_REJ
,

76 #ifde‡
NAS_MME


77 
	m_EMMREG_COMMON_PROC_REQ
,

78 
	m_EMMREG_COMMON_PROC_CNF
,

79 
	m_EMMREG_COMMON_PROC_REJ
,

80 
	m_EMMREG_PROC_ABORT
,

82 
	m_EMMREG_ATTACH_CNF
,

83 
	m_EMMREG_ATTACH_REJ
,

84 
	m_EMMREG_DETACH_INIT
,

85 
	m_EMMREG_DETACH_REQ
,

86 
	m_EMMREG_DETACH_FAILED
,

87 
	m_EMMREG_DETACH_CNF
,

88 
	m_EMMREG_TAU_REQ
,

89 
	m_EMMREG_TAU_CNF
,

90 
	m_EMMREG_TAU_REJ
,

91 
	m_EMMREG_SERVICE_REQ
,

92 
	m_EMMREG_SERVICE_CNF
,

93 
	m_EMMREG_SERVICE_REJ
,

94 
	m_EMMREG_LOWERLAYER_SUCCESS
,

95 
	m_EMMREG_LOWERLAYER_FAILURE
,

96 
	m_EMMREG_LOWERLAYER_RELEASE
,

97 
	m_EMMREG_END


98 } 
	temm_ªg_¥imôive_t
;

104 #ifde‡
NAS_UE


110 
	mödex
;

112 } 
	temm_ªg_ªgi°î_t
;

120 
	mis_emîgícy
;

122 } 
	temm_ªg_©èch_t
;

129 
	mswôch_off
;

130 
	mty≥
;

131 } 
	temm_ªg_dëach_t
;

133 #ifde‡
NAS_MME


139 
	mis_©èched
;

140 } 
	temm_ªg_comm⁄_t
;

147 
emm_ªg_¥imôive_t
 
	m¥imôive
;

148 
	mueid
;

149 *
	m˘x
;

152 
emm_ªg_©èch_t
 
	m©èch
;

153 
emm_ªg_dëach_t
 
	mdëach
;

154 #ifde‡
NAS_UE


155 
emm_ªg_ªgi°î_t
 
	mªgi°
;

157 #ifde‡
NAS_MME


158 
emm_ªg_comm⁄_t
 
	mcomm⁄
;

160 } 
	mu
;

161 } 
	temm_ªg_t
;

	@src/emm/sap/emm_sap.c

49 
	~"emm_ßp.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~"emm_ªg.h
"

54 
	~"emm_esm.h
"

55 
	~"emm_as.h
"

56 
	~"emm_˙.h
"

84 
	$emm_ßp_öôülize
()

86 
LOG_FUNC_IN
;

88 
	`emm_ªg_öôülize
();

89 
	`emm_esm_öôülize
();

90 
	`emm_as_öôülize
();

92 
LOG_FUNC_OUT
;

93 
	}
}

109 
	$emm_ßp_£nd
(
emm_ßp_t
 *
msg
)

111 
rc
 = 
RETURNîr‹
;

113 
emm_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

115 
LOG_FUNC_IN
;

118 i‡–(
¥imôive
 > 
EMMREG_PRIMITIVE_MIN
) &&

119 (
¥imôive
 < 
EMMREG_PRIMITIVE_MAX
) ) {

121 
msg
->
u
.
emm_ªg
.
¥imôive
 =Örimitive;

122 
rc
 = 
	`emm_ªg_£nd
(&
msg
->
u
.
emm_ªg
);

123 } i‡–(
¥imôive
 > 
EMMESM_PRIMITIVE_MIN
) &&

124 (
¥imôive
 < 
EMMESM_PRIMITIVE_MAX
) ) {

126 
msg
->
u
.
emm_esm
.
¥imôive
 =Örimitive;

127 
rc
 = 
	`emm_esm_£nd
(&
msg
->
u
.
emm_esm
);

128 } i‡–(
¥imôive
 > 
EMMAS_PRIMITIVE_MIN
) &&

129 (
¥imôive
 < 
EMMAS_PRIMITIVE_MAX
) ) {

131 
msg
->
u
.
emm_as
.
¥imôive
 =Örimitive;

132 
rc
 = 
	`emm_as_£nd
(&
msg
->
u
.
emm_as
);

134 #i‡
	`deföed
(
EPC_BUILD
)

135 i‡–(
¥imôive
 > 
EMMCN_PRIMITIVE_MIN
) &&

136 (
¥imôive
 < 
EMMCN_PRIMITIVE_MAX
) ) {

138 
msg
->
u
.
emm_˙
.
¥imôive
 =Örimitive;

139 
rc
 = 
	`emm_˙_£nd
(&
msg
->
u
.
emm_˙
);

143 
	`LOG_TRACE
(
WARNING
, "EMM-SAP - Ouào‡øngê¥imôivê(%d)", 
¥imôive
);

146 
	`LOG_FUNC_RETURN
 (
rc
);

147 
	}
}

	@src/emm/sap/emm_sap.h

49 #i‚de‡
__EMM_SAP_H__


50 
	#__EMM_SAP_H__


	)

52 
	~"emmD©a.h
"

53 
	~"emm_ªgDef.h
"

54 
	~"emm_esmDef.h
"

55 
	~"emm_asDef.h
"

56 
	~"emm_˙Def.h
"

74 #ifde‡
NAS_UE


75 
	mEMMREG_S1_ENABLED
 = 
_EMMREG_S1_ENABLED
,

76 
	mEMMREG_S1_DISABLED
 = 
_EMMREG_S1_DISABLED
,

77 
	mEMMREG_NO_IMSI
 = 
_EMMREG_NO_IMSI
,

78 
	mEMMREG_NO_CELL
 = 
_EMMREG_NO_CELL
,

79 
	mEMMREG_REGISTER_REQ
 = 
_EMMREG_REGISTER_REQ
,

80 
	mEMMREG_REGISTER_CNF
 = 
_EMMREG_REGISTER_CNF
,

81 
	mEMMREG_REGISTER_REJ
 = 
_EMMREG_REGISTER_REJ
,

82 
	mEMMREG_ATTACH_INIT
 = 
_EMMREG_ATTACH_INIT
,

83 
	mEMMREG_ATTACH_REQ
 = 
_EMMREG_ATTACH_REQ
,

84 
	mEMMREG_ATTACH_FAILED
 = 
_EMMREG_ATTACH_FAILED
,

85 
	mEMMREG_ATTACH_EXCEEDED
 = 
_EMMREG_ATTACH_EXCEEDED
,

86 
	mEMMREG_AUTH_REJ
 = 
_EMMREG_AUTH_REJ
,

88 #ifde‡
NAS_MME


89 
	mEMMREG_COMMON_PROC_REQ
 = 
_EMMREG_COMMON_PROC_REQ
,

90 
	mEMMREG_COMMON_PROC_CNF
 = 
_EMMREG_COMMON_PROC_CNF
,

91 
	mEMMREG_COMMON_PROC_REJ
 = 
_EMMREG_COMMON_PROC_REJ
,

92 
	mEMMREG_PROC_ABORT
 = 
_EMMREG_PROC_ABORT
,

94 
	mEMMREG_ATTACH_CNF
 = 
_EMMREG_ATTACH_CNF
,

95 
	mEMMREG_ATTACH_REJ
 = 
_EMMREG_ATTACH_REJ
,

96 
	mEMMREG_DETACH_INIT
 = 
_EMMREG_DETACH_INIT
,

97 
	mEMMREG_DETACH_REQ
 = 
_EMMREG_DETACH_REQ
,

98 
	mEMMREG_DETACH_FAILED
 = 
_EMMREG_DETACH_FAILED
,

99 
	mEMMREG_DETACH_CNF
 = 
_EMMREG_DETACH_CNF
,

100 
	mEMMREG_TAU_REQ
 = 
_EMMREG_TAU_REQ
,

101 
	mEMMREG_TAU_CNF
 = 
_EMMREG_TAU_CNF
,

102 
	mEMMREG_TAU_REJ
 = 
_EMMREG_TAU_REJ
,

103 
	mEMMREG_SERVICE_REQ
 = 
_EMMREG_SERVICE_REQ
,

104 
	mEMMREG_SERVICE_CNF
 = 
_EMMREG_SERVICE_CNF
,

105 
	mEMMREG_SERVICE_REJ
 = 
_EMMREG_SERVICE_REJ
,

106 
	mEMMREG_LOWERLAYER_SUCCESS
 = 
_EMMREG_LOWERLAYER_SUCCESS
,

107 
	mEMMREG_LOWERLAYER_FAILURE
 = 
_EMMREG_LOWERLAYER_FAILURE
,

108 
	mEMMREG_LOWERLAYER_RELEASE
 = 
_EMMREG_LOWERLAYER_RELEASE
,

110 #ifde‡
NAS_UE


111 
	mEMMESM_ESTABLISH_REQ
 = 
_EMMESM_ESTABLISH_REQ
,

112 
	mEMMESM_ESTABLISH_CNF
 = 
_EMMESM_ESTABLISH_CNF
,

113 
	mEMMESM_ESTABLISH_REJ
 = 
_EMMESM_ESTABLISH_REJ
,

115 
	mEMMESM_RELEASE_IND
 = 
_EMMESM_RELEASE_IND
,

116 
	mEMMESM_UNITDATA_REQ
 = 
_EMMESM_UNITDATA_REQ
,

117 
	mEMMESM_UNITDATA_IND
 = 
_EMMESM_UNITDATA_IND
,

119 
	mEMMAS_SECURITY_REQ
 = 
_EMMAS_SECURITY_REQ
,

120 
	mEMMAS_SECURITY_IND
 = 
_EMMAS_SECURITY_IND
,

121 
	mEMMAS_SECURITY_RES
 = 
_EMMAS_SECURITY_RES
,

122 
	mEMMAS_SECURITY_REJ
 = 
_EMMAS_SECURITY_REJ
,

123 
	mEMMAS_ESTABLISH_REQ
 = 
_EMMAS_ESTABLISH_REQ
,

124 
	mEMMAS_ESTABLISH_CNF
 = 
_EMMAS_ESTABLISH_CNF
,

125 
	mEMMAS_ESTABLISH_REJ
 = 
_EMMAS_ESTABLISH_REJ
,

126 
	mEMMAS_RELEASE_REQ
 = 
_EMMAS_RELEASE_REQ
,

127 
	mEMMAS_RELEASE_IND
 = 
_EMMAS_RELEASE_IND
,

128 
	mEMMAS_DATA_REQ
 = 
_EMMAS_DATA_REQ
,

129 
	mEMMAS_DATA_IND
 = 
_EMMAS_DATA_IND
,

130 
	mEMMAS_PAGE_IND
 = 
_EMMAS_PAGE_IND
,

131 
	mEMMAS_STATUS_IND
 = 
_EMMAS_STATUS_IND
,

132 
	mEMMAS_CELL_INFO_REQ
 = 
_EMMAS_CELL_INFO_REQ
,

133 
	mEMMAS_CELL_INFO_RES
 = 
_EMMAS_CELL_INFO_RES
,

134 
	mEMMAS_CELL_INFO_IND
 = 
_EMMAS_CELL_INFO_IND
,

136 #ifde‡
EPC_BUILD


137 
	mEMMCN_AUTHENTICATION_PARAM_RES
 = 
_EMMCN_AUTHENTICATION_PARAM_RES
,

138 
	mEMMCN_AUTHENTICATION_PARAM_FAIL
 = 
_EMMCN_AUTHENTICATION_PARAM_FAIL
,

139 
	mEMMCN_DEREGISTER_UE
 = 
_EMMCN_DEREGISTER_UE
,

140 
	mEMMCN_PDN_CONNECTIVITY_RES
 = 
_EMMCN_PDN_CONNECTIVITY_RES
,

141 
	mEMMCN_PDN_CONNECTIVITY_FAIL
 = 
_EMMCN_PDN_CONNECTIVITY_FAIL


143 } 
	temm_¥imôive_t
;

148 
	#EMMREG_PRIMITIVE_MIN
 
_EMMREG_START


	)

149 
	#EMMESM_PRIMITIVE_MIN
 
_EMMESM_START


	)

150 
	#EMMAS_PRIMITIVE_MIN
 
_EMMAS_START


	)

151 
	#EMMCN_PRIMITIVE_MIN
 
_EMMCN_START


	)

156 
	#EMMREG_PRIMITIVE_MAX
 
_EMMREG_END


	)

157 
	#EMMESM_PRIMITIVE_MAX
 
_EMMESM_END


	)

158 
	#EMMAS_PRIMITIVE_MAX
 
_EMMAS_END


	)

159 
	#EMMCN_PRIMITIVE_MAX
 
_EMMCN_END


	)

169 
emm_¥imôive_t
 
	m¥imôive
;

171 
emm_ªg_t
 
	memm_ªg
;

172 
emm_esm_t
 
	memm_esm
;

173 
emm_as_t
 
	memm_as
;

174 #i‡
deföed
(
EPC_BUILD
)

175 
emm_˙_t
 
	memm_˙
;

177 } 
	mu
;

178 } 
	temm_ßp_t
;

188 
emm_ßp_öôülize
();

190 
emm_ßp_£nd
(
emm_ßp_t
 *
msg
);

	@src/emm/sap/emm_send.c

49 
	~"emm_£nd.h
"

50 
	~"comm⁄Def.h
"

51 
	~"«s_log.h
"

53 
	~"emm_msgDef.h
"

54 
	~"emm_¥oc.h
"

56 
	~<°rög.h
>

92 
	$emm_£nd_°©us
(c⁄° 
emm_as_°©us_t
 *
msg
, 
emm_°©us_msg
 *
emm_msg
)

94 
LOG_FUNC_IN
;

96 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

98 
	`LOG_TRACE
(
WARNING
, "EMMAS-SAP - Send EMM Status message (cause=%d)",

99 
msg
->
emm_ˇu£
);

102 
emm_msg
->
mesßgëy≥
 = 
EMM_STATUS
;

105 
size
 +
EMM_CAUSE_MAXIMUM_LENGTH
;

106 
emm_msg
->
emmˇu£
 = 
msg
->
emm_ˇu£
;

108 
	`LOG_FUNC_RETURN
 (
size
);

109 
	}
}

129 
	$emm_£nd_dëach_ac˚±
(c⁄° 
emm_as_d©a_t
 *
msg
,

130 
dëach_ac˚±_msg
 *
emm_msg
)

132 
LOG_FUNC_IN
;

134 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

136 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Detach Accept message");

139 
emm_msg
->
mesßgëy≥
 = 
DETACH_ACCEPT
;

141 
	`LOG_FUNC_RETURN
 (
size
);

142 
	}
}

149 #ifde‡
NAS_UE


167 
	$emm_£nd_©èch_ªque°
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

168 
©èch_ªque°_msg
 *
emm_msg
)

170 
LOG_FUNC_IN
;

172 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

174 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Request message");

177 
emm_msg
->
mesßgëy≥
 = 
ATTACH_REQUEST
;

180 
size
 +
EPS_ATTACH_TYPE_MAXIMUM_LENGTH
;

181 i‡(
msg
->
ty≥
 =
EMM_ATTACH_TYPE_EPS
) {

182 
emm_msg
->
ïßâachty≥
 = 
EPS_ATTACH_TYPE_EPS
;

183 } i‡(
msg
->
ty≥
 =
EMM_ATTACH_TYPE_IMSI
) {

184 
emm_msg
->
ïßâachty≥
 = 
EPS_ATTACH_TYPE_IMSI
;

185 } i‡(
msg
->
ty≥
 =
EMM_ATTACH_TYPE_EMERGENCY
) {

186 
emm_msg
->
ïßâachty≥
 = 
EPS_ATTACH_TYPE_EMERGENCY
;

187 } i‡(
msg
->
ty≥
 =
EMM_ATTACH_TYPE_RESERVED
) {

188 
emm_msg
->
ïßâachty≥
 = 
EPS_ATTACH_TYPE_RESERVED
;

191 
emm_msg
->
ïßâachty≥
 = 
EPS_ATTACH_TYPE_EPS
;

195 
size
 +
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
;

196 i‡(
msg
->
ksi
 !
EMM_AS_NO_KEY_AVAILABLE
) {

197 
emm_msg
->
«skey£tidítifõr
.«skey£tidítifõ∏
msg
->
ksi
;

199 
emm_msg
->
«skey£tidítifõr
.naskeysetidentifier =

200 
NAS_KEY_SET_IDENTIFIER_NOT_AVAILABLE
;

204 
size
 +
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
;

205 i‡(
msg
->
UEid
.
guti
) {

206 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Request message with GUTI");

208 
GutiEpsMobûeIdítôy_t
 *
guti
 = &
emm_msg
->
ﬁdguti‹imsi
.guti;

209 
guti
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_GUTI
;

210 
guti
->
oddeví
 = 
EPS_MOBILE_IDENTITY_EVEN
;

211 
guti
->
mmegroupid
 = 
msg
->
UEid
.guti->
gummei
.
MMEgid
;

212 
guti
->
mmecode
 = 
msg
->
UEid
.guti->
gummei
.
MMEcode
;

213 
guti
->
mtmsi
 = 
msg
->
UEid
.guti->
m_tmsi
;

214 
guti
->
mccdigô1
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô1
;

215 
guti
->
mccdigô2
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô2
;

216 
guti
->
mccdigô3
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô3
;

217 
guti
->
mncdigô1
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô1
;

218 
guti
->
mncdigô2
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô2
;

219 
guti
->
mncdigô3
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô3
;

220 } i‡(
msg
->
UEid
.
imsi
) {

221 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Request message with IMSI");

223 
ImsiEpsMobûeIdítôy_t
 *
imsi
 = &
emm_msg
->
ﬁdguti‹imsi
.imsi;

224 
imsi
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_IMSI
;

225 
imsi
->
oddeví
 = 
msg
->
UEid
.imsi->
u
.
num
.
∑rôy
;

226 
imsi
->
digô1
 = 
msg
->
UEid
.imsi->
u
.
num
.digit1;

227 
imsi
->
digô2
 = 
msg
->
UEid
.imsi->
u
.
num
.digit2;

228 
imsi
->
digô3
 = 
msg
->
UEid
.imsi->
u
.
num
.digit3;

229 
imsi
->
digô4
 = 
msg
->
UEid
.imsi->
u
.
num
.digit4;

230 
imsi
->
digô5
 = 
msg
->
UEid
.imsi->
u
.
num
.digit5;

231 
imsi
->
digô6
 = 
msg
->
UEid
.imsi->
u
.
num
.digit6;

232 
imsi
->
digô7
 = 
msg
->
UEid
.imsi->
u
.
num
.digit7;

233 
imsi
->
digô8
 = 
msg
->
UEid
.imsi->
u
.
num
.digit8;

234 
imsi
->
digô9
 = 
msg
->
UEid
.imsi->
u
.
num
.digit9;

235 
imsi
->
digô10
 = 
msg
->
UEid
.imsi->
u
.
num
.digit10;

236 
imsi
->
digô11
 = 
msg
->
UEid
.imsi->
u
.
num
.digit11;

237 
imsi
->
digô12
 = 
msg
->
UEid
.imsi->
u
.
num
.digit12;

238 
imsi
->
digô13
 = 
msg
->
UEid
.imsi->
u
.
num
.digit13;

239 
imsi
->
digô14
 = 
msg
->
UEid
.imsi->
u
.
num
.digit14;

240 
imsi
->
digô15
 = 
msg
->
UEid
.imsi->
u
.
num
.digit15;

241 } i‡(
msg
->
UEid
.
imei
) {

242 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Request message with IMEI");

244 
ImeiEpsMobûeIdítôy_t
 *
imei
 = &
emm_msg
->
ﬁdguti‹imsi
.imei;

245 
imei
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_IMEI
;

246 
imei
->
oddeví
 = 
msg
->
UEid
.imei->
u
.
num
.
∑rôy
;

247 
imei
->
digô1
 = 
msg
->
UEid
.imei->
u
.
num
.digit1;

248 
imei
->
digô2
 = 
msg
->
UEid
.imei->
u
.
num
.digit2;

249 
imei
->
digô3
 = 
msg
->
UEid
.imei->
u
.
num
.digit3;

250 
imei
->
digô4
 = 
msg
->
UEid
.imei->
u
.
num
.digit4;

251 
imei
->
digô5
 = 
msg
->
UEid
.imei->
u
.
num
.digit5;

252 
imei
->
digô6
 = 
msg
->
UEid
.imei->
u
.
num
.digit6;

253 
imei
->
digô7
 = 
msg
->
UEid
.imei->
u
.
num
.digit7;

254 
imei
->
digô8
 = 
msg
->
UEid
.imei->
u
.
num
.digit8;

255 
imei
->
digô9
 = 
msg
->
UEid
.imei->
u
.
num
.digit9;

256 
imei
->
digô10
 = 
msg
->
UEid
.imei->
u
.
num
.digit10;

257 
imei
->
digô11
 = 
msg
->
UEid
.imei->
u
.
num
.digit11;

258 
imei
->
digô12
 = 
msg
->
UEid
.imei->
u
.
num
.digit12;

259 
imei
->
digô13
 = 
msg
->
UEid
.imei->
u
.
num
.digit13;

260 
imei
->
digô14
 = 
msg
->
UEid
.imei->
u
.
num
.digit14;

261 
imei
->
digô15
 = 
msg
->
UEid
.imei->
u
.
num
.digit15;

265 
size
 +
UE_NETWORK_CAPABILITY_MAXIMUM_LENGTH
;

266 
emm_msg
->
uíëw‹kˇ∑bûôy
.
ìa
 = (0x80 >> 
msg
->
í¸y±i⁄
);

267 
emm_msg
->
uíëw‹kˇ∑bûôy
.
eü
 = (0x80 >> 
msg
->
öãgrôy
);

268 
emm_msg
->
uíëw‹kˇ∑bûôy
.
uó
 = 0;

269 
emm_msg
->
uíëw‹kˇ∑bûôy
.
ucs2
 = 0;

270 
emm_msg
->
uíëw‹kˇ∑bûôy
.
uü
 = 0;

271 
emm_msg
->
uíëw‹kˇ∑bûôy
.
csfb
 = 0;

272 
emm_msg
->
uíëw‹kˇ∑bûôy
.
Õp
 = 0;

273 
emm_msg
->
uíëw‹kˇ∑bûôy
.
lcs
 = 0;

274 
emm_msg
->
uíëw‹kˇ∑bûôy
.
§vcc
 = 0;

275 
emm_msg
->
uíëw‹kˇ∑bûôy
.
nf
 = 0;

278 
size
 +
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 + 
msg
->
NASmsg
.
Àngth
;

279 
emm_msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
 = 
msg
->
NASmsg
;

282 i‡(
msg
->
UEid
.
èi
) {

283 
size
 +
TRACKING_AREA_IDENTITY_MAXIMUM_LENGTH
;

284 
emm_msg
->
¥e£n˚mask
 |
ATTACH_REQUEST_LAST_VISITED_REGISTERED_TAI_PRESENT
;

285 
emm_msg
->
œ°visôedªgi°îedèi
.
mccdigô2
 =

286 
msg
->
UEid
.
èi
->
∂mn
.
MCCdigô2
;

287 
emm_msg
->
œ°visôedªgi°îedèi
.
mccdigô1
 =

288 
msg
->
UEid
.
èi
->
∂mn
.
MCCdigô1
;

289 
emm_msg
->
œ°visôedªgi°îedèi
.
mncdigô3
 =

290 
msg
->
UEid
.
èi
->
∂mn
.
MNCdigô3
;

291 
emm_msg
->
œ°visôedªgi°îedèi
.
mccdigô3
 =

292 
msg
->
UEid
.
èi
->
∂mn
.
MCCdigô3
;

293 
emm_msg
->
œ°visôedªgi°îedèi
.
mncdigô2
 =

294 
msg
->
UEid
.
èi
->
∂mn
.
MNCdigô2
;

295 
emm_msg
->
œ°visôedªgi°îedèi
.
mncdigô1
 =

296 
msg
->
UEid
.
èi
->
∂mn
.
MNCdigô1
;

297 
emm_msg
->
œ°visôedªgi°îedèi
.
èc
 = 
msg
->
UEid
.
èi
->tac;

301 i‡(
msg
->
UEid
.
guti
) {

302 
size
 +
GUTI_TYPE_MAXIMUM_LENGTH
;

303 
emm_msg
->
¥e£n˚mask
 |
ATTACH_REQUEST_OLD_GUTI_TYPE_PRESENT
;

304 
emm_msg
->
ﬁdgutôy≥
 = 
GUTI_NATIVE
;

307 
	`LOG_FUNC_RETURN
 (
size
);

308 
	}
}

327 
	$emm_£nd_©èch_com∂ëe
(c⁄° 
emm_as_d©a_t
 *
msg
,

328 
©èch_com∂ëe_msg
 *
emm_msg
)

330 
LOG_FUNC_IN
;

332 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

334 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Complete message");

337 
emm_msg
->
mesßgëy≥
 = 
ATTACH_COMPLETE
;

340 
size
 +
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 + 
msg
->
NASmsg
.
Àngth
;

341 
emm_msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
 = 
msg
->
NASmsg
;

343 
	`LOG_FUNC_RETURN
 (
size
);

344 
	}
}

363 
	$emm_£nd_öôül_dëach_ªque°
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

364 
dëach_ªque°_msg
 *
emm_msg
)

366 
LOG_FUNC_IN
;

368 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

370 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Detach Request message");

373 
emm_msg
->
mesßgëy≥
 = 
DETACH_REQUEST
;

376 
size
 +
DETACH_TYPE_MAXIMUM_LENGTH
;

377 i‡(
msg
->
swôch_off
) {

378 
emm_msg
->
dëachty≥
.
swôchoff
 = 
DETACH_TYPE_SWITCH_OFF
;

380 
emm_msg
->
dëachty≥
.
swôchoff
 = 
DETACH_TYPE_NORMAL_DETACH
;

382 i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_EPS
) {

383 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS
;

384 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_IMSI
) {

385 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_IMSI
;

386 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_EPS_IMSI
) {

387 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS_IMSI
;

388 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_RESERVED
) {

389 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_RESERVED_1
;

392 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS_IMSI
;

396 
size
 +
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
;

397 i‡(
msg
->
ksi
 !
EMM_AS_NO_KEY_AVAILABLE
) {

398 
emm_msg
->
«skey£tidítifõr
.«skey£tidítifõ∏
msg
->
ksi
;

400 
emm_msg
->
«skey£tidítifõr
.naskeysetidentifier =

401 
NAS_KEY_SET_IDENTIFIER_NOT_AVAILABLE
;

405 
size
 +
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
;

406 i‡(
msg
->
UEid
.
guti
) {

408 
GutiEpsMobûeIdítôy_t
 *
guti
 = &
emm_msg
->
guti‹imsi
.guti;

409 
guti
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_GUTI
;

410 
guti
->
oddeví
 = 
EPS_MOBILE_IDENTITY_EVEN
;

411 
guti
->
mmegroupid
 = 
msg
->
UEid
.guti->
gummei
.
MMEgid
;

412 
guti
->
mmecode
 = 
msg
->
UEid
.guti->
gummei
.
MMEcode
;

413 
guti
->
mtmsi
 = 
msg
->
UEid
.guti->
m_tmsi
;

414 
guti
->
mccdigô1
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô1
;

415 
guti
->
mccdigô2
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô2
;

416 
guti
->
mccdigô3
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MCCdigô3
;

417 
guti
->
mncdigô1
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô1
;

418 
guti
->
mncdigô2
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô2
;

419 
guti
->
mncdigô3
 = 
msg
->
UEid
.guti->
gummei
.
∂mn
.
MNCdigô3
;

420 } i‡(
msg
->
UEid
.
imsi
) {

422 
ImsiEpsMobûeIdítôy_t
 *
imsi
 = &
emm_msg
->
guti‹imsi
.imsi;

423 
imsi
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_IMSI
;

424 
imsi
->
oddeví
 = 
msg
->
UEid
.imsi->
u
.
num
.
∑rôy
;

425 
imsi
->
digô1
 = 
msg
->
UEid
.imsi->
u
.
num
.digit1;

426 
imsi
->
digô2
 = 
msg
->
UEid
.imsi->
u
.
num
.digit2;

427 
imsi
->
digô3
 = 
msg
->
UEid
.imsi->
u
.
num
.digit3;

428 
imsi
->
digô4
 = 
msg
->
UEid
.imsi->
u
.
num
.digit4;

429 
imsi
->
digô5
 = 
msg
->
UEid
.imsi->
u
.
num
.digit5;

430 
imsi
->
digô6
 = 
msg
->
UEid
.imsi->
u
.
num
.digit6;

431 
imsi
->
digô7
 = 
msg
->
UEid
.imsi->
u
.
num
.digit7;

432 
imsi
->
digô8
 = 
msg
->
UEid
.imsi->
u
.
num
.digit8;

433 
imsi
->
digô9
 = 
msg
->
UEid
.imsi->
u
.
num
.digit9;

434 
imsi
->
digô10
 = 
msg
->
UEid
.imsi->
u
.
num
.digit10;

435 
imsi
->
digô11
 = 
msg
->
UEid
.imsi->
u
.
num
.digit11;

436 
imsi
->
digô12
 = 
msg
->
UEid
.imsi->
u
.
num
.digit12;

437 
imsi
->
digô13
 = 
msg
->
UEid
.imsi->
u
.
num
.digit13;

438 
imsi
->
digô14
 = 
msg
->
UEid
.imsi->
u
.
num
.digit14;

439 
imsi
->
digô15
 = 
msg
->
UEid
.imsi->
u
.
num
.digit15;

440 } i‡(
msg
->
UEid
.
imei
) {

442 
ImeiEpsMobûeIdítôy_t
 *
imei
 = &
emm_msg
->
guti‹imsi
.imei;

443 
imei
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_IMEI
;

444 
imei
->
oddeví
 = 
msg
->
UEid
.imei->
u
.
num
.
∑rôy
;

445 
imei
->
digô1
 = 
msg
->
UEid
.imei->
u
.
num
.digit1;

446 
imei
->
digô2
 = 
msg
->
UEid
.imei->
u
.
num
.digit2;

447 
imei
->
digô3
 = 
msg
->
UEid
.imei->
u
.
num
.digit3;

448 
imei
->
digô4
 = 
msg
->
UEid
.imei->
u
.
num
.digit4;

449 
imei
->
digô5
 = 
msg
->
UEid
.imei->
u
.
num
.digit5;

450 
imei
->
digô6
 = 
msg
->
UEid
.imei->
u
.
num
.digit6;

451 
imei
->
digô7
 = 
msg
->
UEid
.imei->
u
.
num
.digit7;

452 
imei
->
digô8
 = 
msg
->
UEid
.imei->
u
.
num
.digit8;

453 
imei
->
digô9
 = 
msg
->
UEid
.imei->
u
.
num
.digit9;

454 
imei
->
digô10
 = 
msg
->
UEid
.imei->
u
.
num
.digit10;

455 
imei
->
digô11
 = 
msg
->
UEid
.imei->
u
.
num
.digit11;

456 
imei
->
digô12
 = 
msg
->
UEid
.imei->
u
.
num
.digit12;

457 
imei
->
digô13
 = 
msg
->
UEid
.imei->
u
.
num
.digit13;

458 
imei
->
digô14
 = 
msg
->
UEid
.imei->
u
.
num
.digit14;

459 
imei
->
digô15
 = 
msg
->
UEid
.imei->
u
.
num
.digit15;

462 
	`LOG_FUNC_RETURN
 (
size
);

463 
	}
}

482 
	$emm_£nd_dëach_ªque°
(c⁄° 
emm_as_d©a_t
 *
msg
,

483 
dëach_ªque°_msg
 *
emm_msg
)

485 
LOG_FUNC_IN
;

487 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

489 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Detach Request message");

492 
emm_msg
->
mesßgëy≥
 = 
DETACH_REQUEST
;

495 
size
 +
DETACH_TYPE_MAXIMUM_LENGTH
;

496 i‡(
msg
->
swôch_off
) {

497 
emm_msg
->
dëachty≥
.
swôchoff
 = 
DETACH_TYPE_SWITCH_OFF
;

499 
emm_msg
->
dëachty≥
.
swôchoff
 = 
DETACH_TYPE_NORMAL_DETACH
;

501 i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_EPS
) {

502 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS
;

503 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_IMSI
) {

504 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_IMSI
;

505 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_EPS_IMSI
) {

506 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS_IMSI
;

507 } i‡(
msg
->
ty≥
 =
EMM_DETACH_TYPE_RESERVED
) {

508 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_RESERVED_1
;

511 
emm_msg
->
dëachty≥
.
ty≥ofdëach
 = 
DETACH_TYPE_EPS_IMSI
;

515 
size
 +
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
;

516 i‡(
msg
->
s˘x
.
ksi
 !
EMM_AS_NO_KEY_AVAILABLE
) {

517 
emm_msg
->
«skey£tidítifõr
.«skey£tidítifõ∏
msg
->
s˘x
.
ksi
;

519 
emm_msg
->
«skey£tidítifõr
.naskeysetidentifier =

520 
NAS_KEY_SET_IDENTIFIER_NOT_AVAILABLE
;

524 
size
 +
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
;

525 i‡(
msg
->
guti
) {

527 
GutiEpsMobûeIdítôy_t
 *
guti
 = &
emm_msg
->
guti‹imsi
.guti;

528 
guti
->
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_GUTI
;

529 
guti
->
oddeví
 = 
EPS_MOBILE_IDENTITY_EVEN
;

530 
guti
->
mmegroupid
 = 
msg
->guti->
gummei
.
MMEgid
;

531 
guti
->
mmecode
 = 
msg
->guti->
gummei
.
MMEcode
;

532 
guti
->
mtmsi
 = 
msg
->guti->
m_tmsi
;

533 
guti
->
mccdigô1
 = 
msg
->guti->
gummei
.
∂mn
.
MCCdigô1
;

534 
guti
->
mccdigô2
 = 
msg
->guti->
gummei
.
∂mn
.
MCCdigô2
;

535 
guti
->
mccdigô3
 = 
msg
->guti->
gummei
.
∂mn
.
MCCdigô3
;

536 
guti
->
mncdigô1
 = 
msg
->guti->
gummei
.
∂mn
.
MNCdigô1
;

537 
guti
->
mncdigô2
 = 
msg
->guti->
gummei
.
∂mn
.
MNCdigô2
;

538 
guti
->
mncdigô3
 = 
msg
->guti->
gummei
.
∂mn
.
MNCdigô3
;

541 
	`LOG_FUNC_RETURN
 (
size
);

542 
	}
}

563 
	$emm_£nd_öôül_èu_ªque°
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

564 
åackög_¨ó_upd©e_ªque°_msg
 *
emm_msg
)

566 
LOG_FUNC_IN
;

568 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

570 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Tracking Area Update Request message");

573 
emm_msg
->
mesßgëy≥
 = 
TRACKING_AREA_UPDATE_REQUEST
;

575 
	`LOG_FUNC_RETURN
 (
size
);

576 
	}
}

596 
	$emm_£nd_öôül_§_ªque°
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

597 
£rvi˚_ªque°_msg
 *
emm_msg
)

599 
LOG_FUNC_IN
;

601 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

603 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Service Request message");

605 
	`LOG_FUNC_RETURN
 (
size
);

606 
	}
}

629 
	$emm_£nd_öôül_ext§_ªque°
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

630 
exãnded_£rvi˚_ªque°_msg
 *
emm_msg
)

632 
LOG_FUNC_IN
;

634 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

636 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Extended Service Request message");

639 
emm_msg
->
mesßgëy≥
 = 
EXTENDED_SERVICE_REQUEST
;

641 
	`LOG_FUNC_RETURN
 (
size
);

642 
	}
}

662 
	$emm_£nd_idítôy_ª•⁄£
(c⁄° 
emm_as_£curôy_t
 *
msg
,

663 
idítôy_ª•⁄£_msg
 *
emm_msg
)

665 
LOG_FUNC_IN
;

667 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

669 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Identity Response message");

672 
emm_msg
->
mesßgëy≥
 = 
IDENTITY_RESPONSE
;

675 
size
 +
MOBILE_IDENTITY_MAXIMUM_LENGTH
;

676 i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_IMSI
) {

677 i‡(
msg
->
imsi
) {

678 
ImsiMobûeIdítôy_t
 *
imsi
 = &
emm_msg
->
mobûeidítôy
.imsi;

679 
imsi
->
ty≥ofidítôy
 = 
MOBILE_IDENTITY_IMSI
;

680 
imsi
->
oddeví
 = 
msg
->imsi->
u
.
num
.
∑rôy
;

681 
imsi
->
digô1
 = 
msg
->imsi->
u
.
num
.digit1;

682 
imsi
->
digô2
 = 
msg
->imsi->
u
.
num
.digit2;

683 
imsi
->
digô3
 = 
msg
->imsi->
u
.
num
.digit3;

684 
imsi
->
digô4
 = 
msg
->imsi->
u
.
num
.digit4;

685 
imsi
->
digô5
 = 
msg
->imsi->
u
.
num
.digit5;

686 
imsi
->
digô6
 = 
msg
->imsi->
u
.
num
.digit6;

687 
imsi
->
digô7
 = 
msg
->imsi->
u
.
num
.digit7;

688 
imsi
->
digô8
 = 
msg
->imsi->
u
.
num
.digit8;

689 
imsi
->
digô9
 = 
msg
->imsi->
u
.
num
.digit9;

690 
imsi
->
digô10
 = 
msg
->imsi->
u
.
num
.digit10;

691 
imsi
->
digô11
 = 
msg
->imsi->
u
.
num
.digit11;

692 
imsi
->
digô12
 = 
msg
->imsi->
u
.
num
.digit12;

693 
imsi
->
digô13
 = 
msg
->imsi->
u
.
num
.digit13;

694 
imsi
->
digô14
 = 
msg
->imsi->
u
.
num
.digit14;

695 
imsi
->
digô15
 = 
msg
->imsi->
u
.
num
.digit15;

697 } i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_TMSI
) {

698 i‡(
msg
->
tmsi
) {

699 c⁄° *
p_tmsi
 = (*)(&
msg
->
tmsi
);

700 
TmsiMobûeIdítôy_t
 *
tmsi
 = &
emm_msg
->
mobûeidítôy
.tmsi;

701 
tmsi
->
ty≥ofidítôy
 = 
MOBILE_IDENTITY_TMSI
;

702 
tmsi
->
oddeví
 = 
MOBILE_IDENTITY_EVEN
;

703 
tmsi
->
digô1
 = 0xf;

704 
tmsi
->
digô2
 = (*
p_tmsi
 & 0xf);

705 
tmsi
->
digô3
 = ((*
p_tmsi
 >> 4) & 0xf);

706 
p_tmsi
++;

707 
tmsi
->
digô4
 = (*
p_tmsi
 & 0xf);

708 
tmsi
->
digô5
 = ((*
p_tmsi
 >> 4) & 0xf);

709 
p_tmsi
++;

710 
tmsi
->
digô6
 = (*
p_tmsi
 & 0xf);

711 
tmsi
->
digô7
 = ((*
p_tmsi
 >> 4) & 0xf);

712 
p_tmsi
++;

713 
tmsi
->
digô8
 = (*
p_tmsi
 & 0xf);

714 
tmsi
->
digô9
 = ((*
p_tmsi
 >> 4) & 0xf);

716 } i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_IMEI
) {

717 i‡(
msg
->
imei
) {

718 
ImeiMobûeIdítôy_t
 *
imei
 = &
emm_msg
->
mobûeidítôy
.imei;

719 
imei
->
ty≥ofidítôy
 = 
MOBILE_IDENTITY_IMEI
;

720 
imei
->
oddeví
 = 
msg
->imei->
u
.
num
.
∑rôy
;

721 
imei
->
digô1
 = 
msg
->imei->
u
.
num
.digit1;

722 
imei
->
digô2
 = 
msg
->imei->
u
.
num
.digit2;

723 
imei
->
digô3
 = 
msg
->imei->
u
.
num
.digit3;

724 
imei
->
digô4
 = 
msg
->imei->
u
.
num
.digit4;

725 
imei
->
digô5
 = 
msg
->imei->
u
.
num
.digit5;

726 
imei
->
digô6
 = 
msg
->imei->
u
.
num
.digit6;

727 
imei
->
digô7
 = 
msg
->imei->
u
.
num
.digit7;

728 
imei
->
digô8
 = 
msg
->imei->
u
.
num
.digit8;

729 
imei
->
digô9
 = 
msg
->imei->
u
.
num
.digit9;

730 
imei
->
digô10
 = 
msg
->imei->
u
.
num
.digit10;

731 
imei
->
digô11
 = 
msg
->imei->
u
.
num
.digit11;

732 
imei
->
digô12
 = 
msg
->imei->
u
.
num
.digit12;

733 
imei
->
digô13
 = 
msg
->imei->
u
.
num
.digit13;

734 
imei
->
digô14
 = 
msg
->imei->
u
.
num
.digit14;

735 
imei
->
digô15
 = 
msg
->imei->
u
.
num
.digit15;

737 } i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_NOT_AVAILABLE
) {

738 
NoMobûeIdítôy_t
 *
no_id
 = &
emm_msg
->
mobûeidítôy
.no_id;

739 
no_id
->
ty≥ofidítôy
 = 
MOBILE_IDENTITY_NOT_AVAILABLE
;

742 
	`LOG_FUNC_RETURN
 (
size
);

743 
	}
}

763 
	$emm_£nd_authítiˇti⁄_ª•⁄£
(c⁄° 
emm_as_£curôy_t
 *
msg
,

764 
authítiˇti⁄_ª•⁄£_msg
 *
emm_msg
)

766 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

768 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Authentication Response message");

771 
emm_msg
->
mesßgëy≥
 = 
AUTHENTICATION_RESPONSE
;

774 
size
 +
AUTHENTICATION_RESPONSE_PARAMETER_MAXIMUM_LENGTH
;

775 
emm_msg
->
authítiˇti⁄ª•⁄£∑ømëî
.
ªs
 = *
msg
->res;

777 
	`LOG_FUNC_RETURN
 (
size
);

778 
	}
}

798 
	$emm_£nd_authítiˇti⁄_Áûuª
(c⁄° 
emm_as_£curôy_t
 *
msg
,

799 
authítiˇti⁄_Áûuª_msg
 *
emm_msg
)

801 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

803 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Authentication Failure message (cause=%d)",

804 
msg
->
emm_ˇu£
);

807 
emm_msg
->
mesßgëy≥
 = 
AUTHENTICATION_FAILURE
;

810 
size
 +
EMM_CAUSE_MAXIMUM_LENGTH
;

811 
emm_msg
->
emmˇu£
 = 
msg
->
emm_ˇu£
;

814 i‡(
msg
->
auts
 && msg->auts->
Àngth
 > 0) {

815 
size
 +
AUTHENTICATION_RESPONSE_PARAMETER_MAXIMUM_LENGTH
;

816 
emm_msg
->
¥e£n˚mask
 |=

817 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
;

818 
emm_msg
->
authítiˇti⁄Áûuª∑ømëî
.
auts
 = *
msg
->auts;

821 
	`LOG_FUNC_RETURN
 (
size
);

822 
	}
}

842 
	$emm_£nd_£curôy_mode_com∂ëe
(c⁄° 
emm_as_£curôy_t
 *
msg
,

843 
£curôy_mode_com∂ëe_msg
 *
emm_msg
)

845 
LOG_FUNC_IN
;

847 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

849 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Security Mode Complete message");

852 
emm_msg
->
mesßgëy≥
 = 
SECURITY_MODE_COMPLETE
;

854 
	`LOG_FUNC_RETURN
 (
size
);

855 
	}
}

875 
	$emm_£nd_£curôy_mode_ªje˘
(c⁄° 
emm_as_£curôy_t
 *
msg
,

876 
£curôy_mode_ªje˘_msg
 *
emm_msg
)

878 
LOG_FUNC_IN
;

880 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

882 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Security Mode Reject message (cause=%d)",

883 
msg
->
emm_ˇu£
);

886 
emm_msg
->
mesßgëy≥
 = 
SECURITY_MODE_REJECT
;

889 
size
 +
EMM_CAUSE_MAXIMUM_LENGTH
;

890 
emm_msg
->
emmˇu£
 = 
msg
->
emm_ˇu£
;

892 
	`LOG_FUNC_RETURN
 (
size
);

893 
	}
}

902 #ifde‡
NAS_MME


921 
	$emm_£nd_©èch_ac˚±
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

922 
©èch_ac˚±_msg
 *
emm_msg
)

924 
LOG_FUNC_IN
;

926 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

928 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Accept message");

929 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - size = EMM_HEADER_MAXIMUM_LENGTH(%d)",

930 
size
);

933 
emm_msg
->
mesßgëy≥
 = 
ATTACH_ACCEPT
;

936 
size
 +
EPS_ATTACH_RESULT_MAXIMUM_LENGTH
;

937 
emm_msg
->
ïßâachªsu…
 = 
EPS_ATTACH_RESULT_EPS
;

940 
size
 +
GPRS_TIMER_MAXIMUM_LENGTH
;

941 
emm_msg
->
t3412vÆue
.
unô
 = 
GPRS_TIMER_UNIT_0S
;

942 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - size += GPRS_TIMER_MAXIMUM_LENGTH(%d) (%d)",

943 
GPRS_TIMER_MAXIMUM_LENGTH
, 
size
);

946 
size
 +
TRACKING_AREA_IDENTITY_LIST_MINIMUM_LENGTH
;

947 
emm_msg
->
èûi°
.
ty≥oÊi°
 =

948 
TRACKING_AREA_IDENTITY_LIST_ONE_PLMN_CONSECUTIVE_TACS
;

949 
emm_msg
->
èûi°
.
numbîo„Àmíts
 = 
msg
->
n_ècs
;

950 
emm_msg
->
èûi°
.
mccdigô1
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MCCdigô1
;

951 
emm_msg
->
èûi°
.
mccdigô2
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MCCdigô2
;

952 
emm_msg
->
èûi°
.
mccdigô3
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MCCdigô3
;

953 
emm_msg
->
èûi°
.
mncdigô1
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MNCdigô1
;

954 
emm_msg
->
èûi°
.
mncdigô2
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MNCdigô2
;

955 
emm_msg
->
èûi°
.
mncdigô3
 = 
msg
->
UEid
.
guti
->
gummei
.
∂mn
.
MNCdigô3
;

956 
emm_msg
->
èûi°
.
èc
 = 
msg
->tac;

957 
	`LOG_TRACE
(
INFO
,

960 
TRACKING_AREA_IDENTITY_LIST_MINIMUM_LENGTH
,

961 
size
);

964 
size
 +
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 + 
msg
->
NASmsg
.
Àngth
;

965 
emm_msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
 = 
msg
->
NASmsg
;

966 
	`LOG_TRACE
(
INFO
,

969 
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
,

970 
size
);

973 i‡(
msg
->
√w_guti
) {

974 
size
 +
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
;

975 
emm_msg
->
¥e£n˚mask
 |
ATTACH_ACCEPT_GUTI_PRESENT
;

976 
emm_msg
->
guti
.guti.
ty≥ofidítôy
 = 
EPS_MOBILE_IDENTITY_GUTI
;

977 
emm_msg
->
guti
.guti.
oddeví
 = 
EPS_MOBILE_IDENTITY_EVEN
;

978 
emm_msg
->
guti
.guti.
mmegroupid
 = 
msg
->
√w_guti
->
gummei
.
MMEgid
;

979 
emm_msg
->
guti
.guti.
mmecode
 = 
msg
->
√w_guti
->
gummei
.
MMEcode
;

980 
emm_msg
->
guti
.guti.
mtmsi
 = 
msg
->
√w_guti
->
m_tmsi
;

981 
emm_msg
->
guti
.guti.
mccdigô1
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MCCdigô1
;

982 
emm_msg
->
guti
.guti.
mccdigô2
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MCCdigô2
;

983 
emm_msg
->
guti
.guti.
mccdigô3
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MCCdigô3
;

984 
emm_msg
->
guti
.guti.
mncdigô1
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MNCdigô1
;

985 
emm_msg
->
guti
.guti.
mncdigô2
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MNCdigô2
;

986 
emm_msg
->
guti
.guti.
mncdigô3
 = 
msg
->
√w_guti
->
gummei
.
∂mn
.
MNCdigô3
;

987 
	`LOG_TRACE
(
INFO
,

990 
EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
,

991 
size
);

993 
	`LOG_FUNC_RETURN
 (
size
);

994 
	}
}

1014 
	$emm_£nd_©èch_ªje˘
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

1015 
©èch_ªje˘_msg
 *
emm_msg
)

1017 
LOG_FUNC_IN
;

1019 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1021 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Attach Reject message (cause=%d)",

1022 
msg
->
emm_ˇu£
);

1025 
emm_msg
->
mesßgëy≥
 = 
ATTACH_REJECT
;

1028 
size
 +
EMM_CAUSE_MAXIMUM_LENGTH
;

1029 
emm_msg
->
emmˇu£
 = 
msg
->
emm_ˇu£
;

1032 i‡(
msg
->
NASmsg
.
Àngth
 > 0) {

1033 
size
 +
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 + 
msg
->
NASmsg
.
Àngth
;

1034 
emm_msg
->
¥e£n˚mask
 |
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
;

1035 
emm_msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
 = 
msg
->
NASmsg
;

1038 
	`LOG_FUNC_RETURN
 (
size
);

1039 
	}
}

1059 
	$emm_£nd_åackög_¨ó_upd©e_ªje˘
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

1060 
åackög_¨ó_upd©e_ªje˘_msg
 *
emm_msg
)

1062 
LOG_FUNC_IN
;

1064 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1066 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Tracking Area Update Reject message (cause=%d)",

1067 
msg
->
emm_ˇu£
);

1070 
emm_msg
->
mesßgëy≥
 = 
TRACKING_AREA_UPDATE_REJECT
;

1073 
size
 +
EMM_CAUSE_MAXIMUM_LENGTH
;

1074 
emm_msg
->
emmˇu£
 = 
msg
->
emm_ˇu£
;

1076 
	`LOG_FUNC_RETURN
 (
size
);

1077 
	}
}

1097 
	$emm_£nd_idítôy_ªque°
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1098 
idítôy_ªque°_msg
 *
emm_msg
)

1100 
LOG_FUNC_IN
;

1102 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1104 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Identity Request message");

1107 
emm_msg
->
mesßgëy≥
 = 
IDENTITY_REQUEST
;

1110 
size
 +
IDENTITY_TYPE_2_MAXIMUM_LENGTH
;

1111 i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_IMSI
) {

1112 
emm_msg
->
idítôyty≥
 = 
IDENTITY_TYPE_2_IMSI
;

1113 } i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_TMSI
) {

1114 
emm_msg
->
idítôyty≥
 = 
IDENTITY_TYPE_2_TMSI
;

1115 } i‡(
msg
->
idítTy≥
 =
EMM_IDENT_TYPE_IMEI
) {

1116 
emm_msg
->
idítôyty≥
 = 
IDENTITY_TYPE_2_IMEI
;

1119 
emm_msg
->
idítôyty≥
 = 
IDENTITY_TYPE_2_IMSI
;

1122 
	`LOG_FUNC_RETURN
 (
size
);

1123 
	}
}

1142 
	$emm_£nd_authítiˇti⁄_ªque°
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1143 
authítiˇti⁄_ªque°_msg
 *
emm_msg
)

1145 
LOG_FUNC_IN
;

1147 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1149 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Authentication Request message");

1152 
emm_msg
->
mesßgëy≥
 = 
AUTHENTICATION_REQUEST
;

1155 
size
 +
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
;

1156 
emm_msg
->
«skey£tidítifõøsme
.
tsc
 = 
NAS_KEY_SET_IDENTIFIER_NATIVE
;

1157 
emm_msg
->
«skey£tidítifõøsme
.
«skey£tidítifõr
 = 
msg
->
ksi
;

1160 
size
 +
AUTHENTICATION_PARAMETER_RAND_MAXIMUM_LENGTH
;

1161 
emm_msg
->
authítiˇti⁄∑ømëîønd
.
ønd
 = *
msg
->rand;

1164 
size
 +
AUTHENTICATION_PARAMETER_AUTN_MAXIMUM_LENGTH
;

1165 
emm_msg
->
authítiˇti⁄∑ømëîauä
.
auä
 = *
msg
->autn;

1167 
	`LOG_FUNC_RETURN
 (
size
);

1168 
	}
}

1188 
	$emm_£nd_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *
emm_msg
)

1190 
LOG_FUNC_IN
;

1192 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1194 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Authentication Reject message");

1197 
emm_msg
->
mesßgëy≥
 = 
AUTHENTICATION_REJECT
;

1199 
	`LOG_FUNC_RETURN
 (
size
);

1200 
	}
}

1219 
	$emm_£nd_£curôy_mode_comm™d
(c⁄° 
emm_as_£curôy_t
 *
msg
,

1220 
£curôy_mode_comm™d_msg
 *
emm_msg
)

1222 
LOG_FUNC_IN
;

1224 
size
 = 
EMM_HEADER_MAXIMUM_LENGTH
;

1226 
	`LOG_TRACE
(
INFO
, "EMMAS-SAP - Send Security Mode Command message");

1229 
emm_msg
->
mesßgëy≥
 = 
SECURITY_MODE_COMMAND
;

1232 
size
 +
NAS_SECURITY_ALGORITHMS_MAXIMUM_LENGTH
;

1233 
emm_msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥ofcùhîögÆg‹ôhm
 =

1234 
msg
->
£À˘ed_ìa
;

1235 
emm_msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥oföãgrôyÆg‹ôhm
 =

1236 
msg
->
£À˘ed_eü
;

1239 
size
 +
NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
;

1240 
emm_msg
->
«skey£tidítifõr
.
tsc
 = 
NAS_KEY_SET_IDENTIFIER_NATIVE
;

1241 
emm_msg
->
«skey£tidítifõr
.«skey£tidítifõ∏
msg
->
ksi
;

1244 
size
 +
UE_SECURITY_CAPABILITY_MAXIMUM_LENGTH
;

1245 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
ìa
 = 
msg
->eea;

1246 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
eü
 = 
msg
->eia;

1247 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
umts_¥e£¡
 = 
msg
->umts_present;

1248 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
g¥s_¥e£¡
 = 
msg
->gprs_present;

1250 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
uó
 = 
msg
->uea;

1251 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
uü
 = 
msg
->uia;

1252 
emm_msg
->
ª∂ayedue£curôyˇ∑bûôõs
.
gó
 = 
msg
->gea;

1254 
	`LOG_FUNC_RETURN
 (
size
);

1255 
	}
}

	@src/emm/sap/emm_send.h

48 #i‚de‡
__EMM_SEND_H__


49 
	#__EMM_SEND_H__


	)

51 
	~"EmmSètus.h
"

53 
	~"DëachReque°.h
"

54 
	~"DëachAc˚±.h
"

56 #ifde‡
NAS_UE


57 
	~"AâachReque°.h
"

58 
	~"AâachCom∂ëe.h
"

59 
	~"TøckögAªaUpd©eReque°.h
"

60 
	~"TøckögAªaUpd©eCom∂ëe.h
"

61 
	~"Sîvi˚Reque°.h
"

62 
	~"ExãndedSîvi˚Reque°.h
"

63 
	~"GutiRóŒoˇti⁄Com∂ëe.h
"

64 
	~"Authítiˇti⁄Re•⁄£.h
"

65 
	~"Authítiˇti⁄Faûuª.h
"

66 
	~"IdítôyRe•⁄£.h
"

67 
	~"NASSecurôyModeCom∂ëe.h
"

68 
	~"SecurôyModeReje˘.h
"

69 
	~"U∂ökNasTøn•‹t.h
"

72 #ifde‡
NAS_MME


73 
	~"AâachAc˚±.h
"

74 
	~"AâachReje˘.h
"

75 
	~"TøckögAªaUpd©eAc˚±.h
"

76 
	~"TøckögAªaUpd©eReje˘.h
"

77 
	~"Sîvi˚Reje˘.h
"

78 
	~"GutiRóŒoˇti⁄Comm™d.h
"

79 
	~"Authítiˇti⁄Reque°.h
"

80 
	~"Authítiˇti⁄Reje˘.h
"

81 
	~"IdítôyReque°.h
"

82 
	~"NASSecurôyModeComm™d.h
"

83 
	~"EmmInf‹m©i⁄.h
"

84 
	~"Dow∆ökNasTøn•‹t.h
"

85 
	~"CsSîvi˚NŸifiˇti⁄.h
"

88 
	~"emm_asDef.h
"

111 
emm_£nd_°©us
(c⁄° 
emm_as_°©us_t
 *, 
emm_°©us_msg
 *);

113 
emm_£nd_dëach_ac˚±
(c⁄° 
emm_as_d©a_t
 *, 
dëach_ac˚±_msg
 *);

120 #ifde‡
NAS_UE


121 
emm_£nd_©èch_ªque°
(c⁄° 
emm_as_e°ablish_t
 *, 
©èch_ªque°_msg
 *);

122 
emm_£nd_©èch_com∂ëe
(c⁄° 
emm_as_d©a_t
 *, 
©èch_com∂ëe_msg
 *);

124 
emm_£nd_öôül_dëach_ªque°
(c⁄° 
emm_as_e°ablish_t
 *,

125 
dëach_ªque°_msg
 *);

126 
emm_£nd_dëach_ªque°
(c⁄° 
emm_as_d©a_t
 *, 
dëach_ªque°_msg
 *);

129 
emm_£nd_öôül_èu_ªque°
(c⁄° 
emm_as_e°ablish_t
 *,

130 
åackög_¨ó_upd©e_ªque°_msg
 *);

132 
emm_£nd_öôül_§_ªque°
(c⁄° 
emm_as_e°ablish_t
 *,

133 
£rvi˚_ªque°_msg
 *);

135 
emm_£nd_öôül_ext§_ªque°
(c⁄° 
emm_as_e°ablish_t
 *,

136 
exãnded_£rvi˚_ªque°_msg
 *);

138 
emm_£nd_idítôy_ª•⁄£
(c⁄° 
emm_as_£curôy_t
 *,

139 
idítôy_ª•⁄£_msg
 *);

140 
emm_£nd_authítiˇti⁄_ª•⁄£
(c⁄° 
emm_as_£curôy_t
 *,

141 
authítiˇti⁄_ª•⁄£_msg
 *);

142 
emm_£nd_authítiˇti⁄_Áûuª
(c⁄° 
emm_as_£curôy_t
 *,

143 
authítiˇti⁄_Áûuª_msg
 *);

144 
emm_£nd_£curôy_mode_com∂ëe
(c⁄° 
emm_as_£curôy_t
 *,

145 
£curôy_mode_com∂ëe_msg
 *);

146 
emm_£nd_£curôy_mode_ªje˘
(c⁄° 
emm_as_£curôy_t
 *,

147 
£curôy_mode_ªje˘_msg
 *);

155 #ifde‡
NAS_MME


156 
emm_£nd_©èch_ac˚±
(c⁄° 
emm_as_e°ablish_t
 *, 
©èch_ac˚±_msg
 *);

157 
emm_£nd_©èch_ªje˘
(c⁄° 
emm_as_e°ablish_t
 *, 
©èch_ªje˘_msg
 *);

159 
emm_£nd_åackög_¨ó_upd©e_ªje˘
(c⁄° 
emm_as_e°ablish_t
 *
msg
,

160 
åackög_¨ó_upd©e_ªje˘_msg
 *
emm_msg
);

162 
emm_£nd_idítôy_ªque°
(c⁄° 
emm_as_£curôy_t
 *, 
idítôy_ªque°_msg
 *);

163 
emm_£nd_authítiˇti⁄_ªque°
(c⁄° 
emm_as_£curôy_t
 *,

164 
authítiˇti⁄_ªque°_msg
 *);

165 
emm_£nd_authítiˇti⁄_ªje˘
(
authítiˇti⁄_ªje˘_msg
 *);

166 
emm_£nd_£curôy_mode_comm™d
(c⁄° 
emm_as_£curôy_t
 *,

167 
£curôy_mode_comm™d_msg
 *);

	@src/esm/DedicatedEpsBearerContextActivation.c

59 
	~"esm_¥oc.h
"

60 
	~"comm⁄Def.h
"

61 
	~"«s_log.h
"

63 
	~"esm_ˇu£.h
"

64 
	~"esm_ebr.h
"

65 
	~"esm_ebr_c⁄ãxt.h
"

67 
	~"emm_ßp.h
"

83 #ifde‡
NAS_MME


87 *
_dediˇãd_ïs_bóªr_a˘iv©e_t3485_h™dÀr
(*);

91 
	#DEDICATED_EPS_BEARER_ACTIVATE_COUNTER_MAX
 5

	)

93 
_dediˇãd_ïs_bóªr_a˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

94 c⁄° 
O˘ëSåög
 *
msg
);

106 #ifde‡
NAS_MME


130 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
,

131 *
ebi
,

132 *
deÁu…_ebi
,

133 c⁄° 
esm_¥oc_qos_t
 *
qos
,

134 c⁄° 
esm_¥oc_t·_t
 *
t·
,

135 *
esm_ˇu£
)

137 
LOG_FUNC_IN
;

139 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Dedicated EPS bearer contextáctivation "

140 "(ueid=%u,Öid=%d)", 
˘x
->
ueid
, 
pid
);

143 *
ebi
 = 
	`esm_ebr_assign
(
˘x
, 
ESM_EBI_UNASSIGNED
);

145 i‡(*
ebi
 !
ESM_EBI_UNASSIGNED
) {

147 *
deÁu…_ebi
 = 
	`esm_ebr_c⁄ãxt_¸óã
(
˘x
, 
pid
, *
ebi
, 
FALSE
, 
qos
, 
t·
);

148 i‡(*
deÁu…_ebi
 =
ESM_EBI_UNASSIGNED
) {

150 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo create dedicated EPS "

151 "bóª∏c⁄ãxà”bi=%d)", *
ebi
);

152 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

153 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

155 
	`LOG_FUNC_RETURN
 (
RETURNok
);

158 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoássignÇew EPS bearer context");

159 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

160 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

161 
	}
}

189 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
is_°™dÆ⁄e
,

190 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

191 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

193 
LOG_FUNC_IN
;

195 
rc
 = 
RETURNok
;

197 
	`LOG_TRACE
(
INFO
,"ESM-PROC - Initiate dedicated EPS bearer context "

198 "a˘iv©i⁄ (ueid=%d,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

202 
rc
 = 
	`_dediˇãd_ïs_bóªr_a˘iv©e
(
˘x
, 
ebi
, 
msg
);

204 i‡(
rc
 !
RETURNîr‹
) {

206 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_ACTIVE_PENDING
, 
ue_åiggîed
);

207 i‡(
rc
 !
RETURNok
) {

209 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wasálready ACTIVE PENDING",

210 
ebi
);

214 
	`LOG_FUNC_RETURN
 (
rc
);

215 
	}
}

239 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

240 *
esm_ˇu£
)

242 
LOG_FUNC_IN
;

244 
rc
;

246 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Dedicated EPS bearer contextáctivation "

247 "ac˚±ed byÅhêUE (ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

250 
rc
 = 
	`esm_ebr_°›_timî
(
˘x
, 
ebi
);

251 i‡(
rc
 !
RETURNîr‹
) {

253 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_ACTIVE
, 
FALSE
);

254 i‡(
rc
 !
RETURNok
) {

256 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady ACTIVE", 
ebi
);

257 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

261 
	`LOG_FUNC_RETURN
 (
rc
);

262 
	}
}

290 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

291 *
esm_ˇu£
)

293 
rc
;

295 
LOG_FUNC_IN
;

297 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Dedicated EPS bearer contextáctivation "

298 "nŸác˚±ed byÅhêUE (ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

301 
rc
 = 
	`esm_ebr_°›_timî
(
˘x
, 
ebi
);

302 i‡(
rc
 !
RETURNîr‹
) {

303 
pid
, 
bid
;

305 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
˘x
, 
TRUE
, 
ebi
,

306 &
pid
, &
bid
, 
NULL
);

307 i‡(
rc
 !
RETURNok
) {

309 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

313 
	`LOG_FUNC_RETURN
 (
rc
);

314 
	}
}

322 #ifde‡
NAS_UE


344 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
ebi
, 
deÁu…_ebi
,

345 c⁄° 
esm_¥oc_qos_t
 *
qos
,

346 c⁄° 
esm_¥oc_t·_t
 *
t·
,

347 *
esm_ˇu£
)

349 
LOG_FUNC_IN
;

351 
rc
 = 
RETURNîr‹
;

353 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Dedicated EPS bearer contextáctivation "

354 "ªque°ed byÅhê√tw‹k (ebi=%d)", 
ebi
);

357 
pid
 = 
	`esm_ebr_c⁄ãxt_gë_pid
(
deÁu…_ebi
);

358 i‡(
pid
 < 0) {

363 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo get PDN connectionÅhe "

364 "dediˇãd EPS bóª∏i†lökedÅÿ”bi=%d)", 
deÁu…_ebi
);

365 *
esm_ˇu£
 = 
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
;

366 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

370 
√w_ebi
 = 
	`esm_ebr_assign
(
ebi
, 
pid
+1, 
FALSE
);

371 i‡(
√w_ebi
 =
ESM_EBI_UNASSIGNED
) {

376 
ﬁd_pid
, 
ﬁd_bid
;

379 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
TRUE
, 
ebi
,

380 &
ﬁd_pid
, &
ﬁd_bid
);

381 i‡(
rc
 !
RETURNok
) {

383 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

386 
ebi
 = 
	`esm_ebr_assign
”bi, 
pid
+1, 
FALSE
);

390 i‡(
ebi
 !
ESM_EBI_UNASSIGNED
) {

392 
rc
 = 
	`esm_ebr_c⁄ãxt_check_t·
(
pid
, 
ebi
, 
t·
,

393 
ESM_EBR_CONTEXT_TFT_CREATE
);

394 i‡(
rc
 !
RETURNok
) {

396 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - SyntacticalÉrrors inÖacket "

398 *
esm_ˇu£
 = 
ESM_CAUSE_SYNTACTICAL_ERROR_IN_PACKET_FILTER
;

401 
deÁu…_ebi
 = 
	`esm_ebr_c⁄ãxt_¸óã
(
pid
, 
ebi
, 
FALSE
, 
qos
, 
t·
);

402 i‡(
deÁu…_ebi
 !
ESM_EBI_UNASSIGNED
) {

404 
rc
 = 
RETURNok
;

407 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo createÇew dedicated "

409 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

414 
	`LOG_FUNC_RETURN
 (
rc
);

415 
	}
}

441 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

442 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

444 
LOG_FUNC_IN
;

446 
rc
;

448 
	`LOG_TRACE
(
INFO
,"ESM-PROC - Dedicated EPS bearer contextáctivation "

449 "ac˚±ed byÅhêUE (ebi=%d)", 
ebi
);

451 
emm_ßp_t
 
emm_ßp
;

452 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

456 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

457 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

458 
emm_esm
->
msg
.
Àngth
 = msg->length;

459 
emm_esm
->
msg
.
vÆue
 = msg->value;

460 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

462 i‡(
rc
 !
RETURNîr‹
) {

464 
rc
 = 
	`esm_ebr_£t_°©us
(
ebi
, 
ESM_EBR_ACTIVE
, 
ue_åiggîed
);

465 i‡(
rc
 !
RETURNok
) {

467 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady ACTIVE", 
ebi
);

470 
	`LOG_FUNC_RETURN
 (
RETURNok
);

474 
	`LOG_FUNC_RETURN
 (
rc
);

475 
	}
}

500 
	$esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
is_°™dÆ⁄e
, 
ebi
,

501 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

503 
LOG_FUNC_IN
;

505 
rc
 = 
RETURNok
;

507 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Dedicated EPS bearer contextáctivation "

508 "nŸác˚±ed byÅhêUE (ebi=%d)", 
ebi
);

510 i‡–!
	`esm_ebr_is_nŸ_ö_u£
(
ebi
) ) {

512 
rc
 = 
	`esm_ebr_ªÀa£
(
ebi
);

515 i‡(
rc
 !
RETURNok
) {

516 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease EPS bearer data");

518 
emm_ßp_t
 
emm_ßp
;

519 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

523 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

524 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

525 
emm_esm
->
msg
.
Àngth
 = msg->length;

526 
emm_esm
->
msg
.
vÆue
 = msg->value;

527 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

530 
	`LOG_FUNC_RETURN
 (
rc
);

531 
	}
}

543 #ifde‡
NAS_MME


567 *
	$_dediˇãd_ïs_bóªr_a˘iv©e_t3485_h™dÀr
(*
¨gs
)

569 
LOG_FUNC_IN
;

571 
rc
;

574 
esm_ebr_timî_d©a_t
 *
d©a
 = (esm_ebr_timî_d©a_à*)(
¨gs
);

577 
d©a
->
cou¡
 += 1;

579 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - T3485ÅimerÉxpired (ueid=%d,Ébi=%d), "

581 
d©a
->
ueid
, d©a->
ebi
, d©a->
cou¡
);

583 i‡(
d©a
->
cou¡
 < 
DEDICATED_EPS_BEARER_ACTIVATE_COUNTER_MAX
) {

586 
rc
 = 
	`_dediˇãd_ïs_bóªr_a˘iv©e
(
d©a
->
˘x
, d©a->
ebi
, &d©a->
msg
);

592 
pid
, 
bid
;

594 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
d©a
->
˘x
, 
TRUE
,

595 
d©a
->
ebi
, &
pid
, &
bid
,

596 
NULL
);

597 i‡(
rc
 !
RETURNîr‹
) {

599 
rc
 = 
	`esm_ebr_°›_timî
(
d©a
->
˘x
, d©a->
ebi
);

603 
	`LOG_FUNC_RETURN
 (
NULL
);

604 
	}
}

629 
	$_dediˇãd_ïs_bóªr_a˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

630 c⁄° 
O˘ëSåög
 *
msg
)

632 
LOG_FUNC_IN
;

634 
emm_ßp_t
 
emm_ßp
;

635 
rc
;

641 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

642 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

643 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 
˘x
->ueid;

644 
emm_ßp
.
u
.
emm_esm
.
˘x
 = ctx;

645 
emm_esm
->
msg
 = *msg;

646 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

648 i‡(
rc
 !
RETURNîr‹
) {

650 
rc
 = 
	`esm_ebr_°¨t_timî
(
˘x
, 
ebi
, 
msg
, 
T3485_DEFAULT_VALUE
,

651 
_dediˇãd_ïs_bóªr_a˘iv©e_t3485_h™dÀr
);

654 
	`LOG_FUNC_RETURN
 (
rc
);

655 
	}
}

	@src/esm/DefaultEpsBearerContextActivation.c

55 
	~"esm_¥oc.h
"

56 
	~"comm⁄Def.h
"

57 
	~"«s_log.h
"

59 
	~"esm_ˇu£.h
"

60 
	~"esm_ebr.h
"

61 
	~"esm_ebr_c⁄ãxt.h
"

63 
	~"emm_ßp.h
"

79 #ifde‡
NAS_UE


81 
	mebi
;

83 } 
	g_deÁu…_ïs_bóªr_c⁄ãxt_d©a
 = {
ESM_EBI_UNASSIGNED
};

93 #ifde‡
NAS_MME


97 *
_deÁu…_ïs_bóªr_a˘iv©e_t3485_h™dÀr
(*);

101 
	#DEFAULT_EPS_BEARER_ACTIVATE_COUNTER_MAX
 5

	)

103 
_deÁu…_ïs_bóªr_a˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

104 c⁄° 
O˘ëSåög
 *
msg
);

116 #ifde‡
NAS_MME


137 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
,

138 *
ebi
,

139 c⁄° 
esm_¥oc_qos_t
 *
qos
,

140 *
esm_ˇu£
)

142 
LOG_FUNC_IN
;

144 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Default EPS bearer contextáctivation "

146 
˘x
->
ueid
,

147 
pid
,

148 
qos
->
gbrUL
,

149 
qos
->
gbrDL
,

150 
qos
->
mbrUL
,

151 
qos
->
mbrDL
,

152 
qos
->
qci
);

155 *
ebi
 = 
	`esm_ebr_assign
(
˘x
, 
ESM_EBI_UNASSIGNED
);

157 i‡(*
ebi
 !
ESM_EBI_UNASSIGNED
) {

159 *
ebi
 = 
	`esm_ebr_c⁄ãxt_¸óã
(
˘x
, 
pid
, *ebi, 
TRUE
, 
qos
, 
NULL
);

160 i‡(*
ebi
 =
ESM_EBI_UNASSIGNED
) {

162 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo createÇew default EPS "

163 "bóª∏c⁄ãxà”bi=%d)", *
ebi
);

164 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

165 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

167 
	`LOG_FUNC_RETURN
 (
RETURNok
);

170 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoássignÇew EPS bearer context");

171 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

172 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

173 
	}
}

204 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
is_°™dÆ⁄e
,

205 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

206 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

208 
rc
 = 
RETURNok
;

210 
LOG_FUNC_IN
;

213 i‡(
is_°™dÆ⁄e
) {

216 
	`LOG_TRACE
(
INFO
,"ESM-PROC - Initiate standalone default EPS bearer contextáctivation "

217 "(ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

218 
rc
 = 
	`_deÁu…_ïs_bóªr_a˘iv©e
(
˘x
, 
ebi
, 
msg
);

220 
	`LOG_TRACE
(
INFO
,"ESM-PROC - InitiateÇon standalone default EPS bearer contextáctivation "

221 "(ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

224 i‡(
rc
 !
RETURNîr‹
) {

226 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_ACTIVE_PENDING
, 
ue_åiggîed
);

227 i‡(
rc
 !
RETURNok
) {

229 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wasálready ACTIVE PENDING",

230 
ebi
);

234 
	`LOG_FUNC_RETURN
 (
rc
);

235 
	}
}

259 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

260 *
esm_ˇu£
)

262 
LOG_FUNC_IN
;

264 
rc
;

266 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Default EPS bearer contextáctivation "

267 "ac˚±ed byÅhêUE (ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

270 
rc
 = 
	`esm_ebr_°›_timî
(
˘x
, 
ebi
);

271 i‡(
rc
 !
RETURNîr‹
) {

273 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_ACTIVE
, 
FALSE
);

274 i‡(
rc
 !
RETURNok
) {

276 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady ACTIVE", 
ebi
);

277 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

281 
	`LOG_FUNC_RETURN
 (
rc
);

282 
	}
}

306 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

307 *
esm_ˇu£
)

309 
LOG_FUNC_IN
;

311 
rc
;

313 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Default EPS bearer contextáctivation "

314 "nŸác˚±ed byÅhêUE (ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

317 
rc
 = 
	`esm_ebr_°›_timî
(
˘x
, 
ebi
);

318 i‡(
rc
 !
RETURNîr‹
) {

319 
pid
, 
bid
;

321 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
˘x
, 
TRUE
, 
ebi
,

322 &
pid
, &
bid
, 
NULL
);

323 i‡(
rc
 !
RETURNok
) {

325 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

329 
	`LOG_FUNC_RETURN
 (
rc
);

330 
	}
}

356 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
(
emm_d©a_c⁄ãxt_t
 *
˘x
)

358 
rc
 = 
RETURNîr‹
;

359 
pid
;

361 
LOG_FUNC_IN
;

363 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Default EPS bearer contextáctivation "

364 "Áûuª (ueid=%u)", 
˘x
->
ueid
);

368 
ebi
 = 
	`esm_ebr_gë_≥ndög_ebi
(
˘x
, 
ESM_EBR_ACTIVE_PENDING
);

369 i‡(
ebi
 !
ESM_EBI_UNASSIGNED
) {

370 
bid
;

372 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
˘x
, 
TRUE
, 
ebi
,

373 &
pid
, &
bid
, 
NULL
);

376 i‡(
rc
 !
RETURNîr‹
) {

377 
	`LOG_FUNC_RETURN
 (
pid
);

379 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

380 
	}
}

389 #ifde‡
NAS_UE


408 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
pid
, 
ebi
,

409 c⁄° 
esm_¥oc_qos_t
 *
qos
,

410 *
esm_ˇu£
)

412 
LOG_FUNC_IN
;

414 
rc
 = 
RETURNîr‹
;

416 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Default EPS bearer contextáctivation "

417 "ªque°ed byÅhê√tw‹k (ebi=%d)", 
ebi
);

420 
√w_ebi
 = 
	`esm_ebr_assign
(
ebi
, 
pid
+1, 
TRUE
);

421 i‡(
√w_ebi
 =
ESM_EBI_UNASSIGNED
) {

426 
ﬁd_pid
, 
ﬁd_bid
;

429 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
TRUE
, 
ebi
,

430 &
ﬁd_pid
, &
ﬁd_bid
);

431 i‡(
rc
 !
RETURNok
) {

433 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

436 
ebi
 = 
	`esm_ebr_assign
”bi, 
pid
+1, 
TRUE
);

440 i‡(
ebi
 !
ESM_EBI_UNASSIGNED
) {

442 
ebi
 = 
	`esm_ebr_c⁄ãxt_¸óã
(
pid
,Ébi, 
TRUE
, 
qos
, 
NULL
);

443 i‡(
ebi
 !
ESM_EBI_UNASSIGNED
) {

445 
_deÁu…_ïs_bóªr_c⁄ãxt_d©a
.
ebi
 =Ébi;

446 
rc
 = 
RETURNok
;

449 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo createÇew default EPS "

451 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

455 
	`LOG_FUNC_RETURN
 (
rc
);

456 
	}
}

489 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

490 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

492 
LOG_FUNC_IN
;

494 
rc
 = 
RETURNok
;

496 
	`LOG_TRACE
(
INFO
,"ESM-PROC - Default EPS bearer contextáctivation "

497 "ac˚±ed byÅhêUE (ebi=%d)", 
ebi
);

499 i‡(
is_°™dÆ⁄e
) {

500 
emm_ßp_t
 
emm_ßp
;

501 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

505 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

506 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

507 
emm_esm
->
msg
.
Àngth
 = msg->length;

508 
emm_esm
->
msg
.
vÆue
 = msg->value;

509 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

512 i‡(
rc
 !
RETURNîr‹
) {

514 
rc
 = 
	`esm_ebr_£t_°©us
(
ebi
, 
ESM_EBR_ACTIVE
, 
ue_åiggîed
);

515 i‡(
rc
 !
RETURNok
) {

517 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady ACTIVE", 
ebi
);

520 
	`LOG_FUNC_RETURN
 (
RETURNok
);

524 
	`LOG_FUNC_RETURN
 (
rc
);

525 
	}
}

556 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
is_°™dÆ⁄e
, 
ebi
,

557 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

559 
LOG_FUNC_IN
;

561 
rc
 = 
RETURNok
;

563 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Default EPS bearer contextáctivation "

564 "nŸác˚±ed byÅhêUE (ebi=%d)", 
ebi
);

566 i‡–!
	`esm_ebr_is_nŸ_ö_u£
(
ebi
) ) {

568 
rc
 = 
	`esm_ebr_ªÀa£
(
ebi
);

571 i‡(
rc
 !
RETURNok
) {

572 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease EPS bearer data");

573 } i‡(
is_°™dÆ⁄e
) {

574 
emm_ßp_t
 
emm_ßp
;

575 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

579 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

580 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

581 
emm_esm
->
msg
.
Àngth
 = msg->length;

582 
emm_esm
->
msg
.
vÆue
 = msg->value;

583 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

589 
rc
 = 
RETURNîr‹
;

592 
	`LOG_FUNC_RETURN
 (
rc
);

593 
	}
}

613 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_com∂ëe
()

615 
LOG_FUNC_IN
;

617 
	`LOG_TRACE
(
INFO
,

621 
_deÁu…_ïs_bóªr_c⁄ãxt_d©a
.
ebi
 = 
ESM_EBI_UNASSIGNED
;

623 
	`LOG_FUNC_RETURN
 (
RETURNok
);

624 
	}
}

646 
	$esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
()

648 
LOG_FUNC_IN
;

650 
ebi
 = 
_deÁu…_ïs_bóªr_c⁄ãxt_d©a
.ebi;

651 
pid
, 
bid
;

653 
	`LOG_TRACE
(
WARNING
,

657 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
TRUE
, 
ebi
, &
pid
, &
bid
);

658 i‡(
rc
 !
RETURNîr‹
) {

660 
_deÁu…_ïs_bóªr_c⁄ãxt_d©a
.
ebi
 = 
ESM_EBI_UNASSIGNED
;

663 
	`LOG_FUNC_RETURN
 (
rc
);

664 
	}
}

676 #ifde‡
NAS_MME


699 *
	$_deÁu…_ïs_bóªr_a˘iv©e_t3485_h™dÀr
(*
¨gs
)

701 
LOG_FUNC_IN
;

703 
rc
;

706 
esm_ebr_timî_d©a_t
 *
d©a
 = (esm_ebr_timî_d©a_à*)(
¨gs
);

709 
d©a
->
cou¡
 += 1;

711 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - T3485ÅimerÉxpired (ueid=%d,Ébi=%d), "

713 
d©a
->
ueid
, d©a->
ebi
, d©a->
cou¡
);

715 i‡(
d©a
->
cou¡
 < 
DEFAULT_EPS_BEARER_ACTIVATE_COUNTER_MAX
) {

718 
rc
 = 
	`_deÁu…_ïs_bóªr_a˘iv©e
(
d©a
->
˘x
, d©a->
ebi
, &d©a->
msg
);

724 
pid
, 
bid
;

726 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
d©a
->
˘x
, 
TRUE
,

727 
d©a
->
ebi
, &
pid
, &
bid
,

728 
NULL
);

729 i‡(
rc
 !
RETURNîr‹
) {

731 
rc
 = 
	`esm_ebr_°›_timî
(
d©a
->
˘x
, d©a->
ebi
);

735 
	`LOG_FUNC_RETURN
 (
NULL
);

736 
	}
}

761 
	$_deÁu…_ïs_bóªr_a˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

762 c⁄° 
O˘ëSåög
 *
msg
)

764 
LOG_FUNC_IN
;

766 
emm_ßp_t
 
emm_ßp
;

767 
rc
;

773 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

774 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

775 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 
˘x
->ueid;

776 
emm_ßp
.
u
.
emm_esm
.
˘x
 = ctx;

777 
emm_esm
->
msg
 = *msg;

778 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

780 i‡(
rc
 !
RETURNîr‹
) {

782 
rc
 = 
	`esm_ebr_°¨t_timî
(
˘x
, 
ebi
, 
msg
, 
T3485_DEFAULT_VALUE
,

783 
_deÁu…_ïs_bóªr_a˘iv©e_t3485_h™dÀr
);

786 
	`LOG_FUNC_RETURN
 (
rc
);

787 
	}
}

	@src/esm/EpsBearerContextDeactivation.c

55 
	~"esm_¥oc.h
"

56 
	~"comm⁄Def.h
"

57 
	~"«s_log.h
"

59 
	~"emmD©a.h
"

60 
	~"esmD©a.h
"

61 
	~"esm_ˇu£.h
"

62 
	~"esm_ebr.h
"

63 
	~"esm_ebr_c⁄ãxt.h
"

65 #ifde‡
NAS_UE


66 
	~"esm_maö.h
"

69 
	~"emm_ßp.h
"

70 
	~"esm_ßp.h
"

86 #ifde‡
NAS_UE


87 
_ïs_bóªr_ªÀa£
(
ebi
, *
pid
, *
bid
);

96 #ifde‡
NAS_MME


100 *
_ïs_bóªr_dó˘iv©e_t3495_h™dÀr
(*);

104 
	#EPS_BEARER_DEACTIVATE_COUNTER_MAX
 5

	)

106 
_ïs_bóªr_dó˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

107 c⁄° 
O˘ëSåög
 *
msg
);

108 
_ïs_bóªr_ªÀa£
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, *
pid
, *
bid
);

121 #ifde‡
NAS_MME


150 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
is_loˇl
,

151 
ebi
, *
pid
, *
bid
,

152 *
esm_ˇu£
)

154 
rc
 = 
RETURNîr‹
;

156 
LOG_FUNC_IN
;

158 i‡(
is_loˇl
) {

159 i‡(
ebi
 !
ESM_SAP_ALL_EBI
) {

161 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
˘x
, 
ebi
, 
pid
, 
bid
);

162 } i‡(
˘x
 !
NULL
) {

164 *
bid
 = 0;

165 *
pid
 = 0; *pid < 
ESM_DATA_PDN_MAX
; (*pid)++) {

166 i‡(
˘x
->
esm_d©a_˘x
.
pdn
[*
pid
].
d©a
) {

167 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
˘x
, 
ESM_EBI_UNASSIGNED
,

168 
pid
, 
bid
);

169 i‡(
rc
 !
RETURNok
) {

175 
	`LOG_FUNC_RETURN
 (
rc
);

178 
	`LOG_TRACE
(
INFO
, "ESM-PROC - EPS bearer context deactivation "

179 "(ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

181 i‡((
˘x
 !
NULL
) &&

182 (*
pid
 < 
ESM_DATA_PDN_MAX
) ) {

183 i‡(
˘x
->
esm_d©a_˘x
.
pdn
[*
pid
].pid != *pid) {

184 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier %d "

185 "i†nŸ vÆid", *
pid
);

186 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

187 } i‡(
˘x
->
esm_d©a_˘x
.
pdn
[*
pid
].
d©a
 =
NULL
) {

188 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

189 "Æloˇãd", *
pid
);

190 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

191 } i‡(!
˘x
->
esm_d©a_˘x
.
pdn
[*
pid
].
is_a˘ive
) {

192 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection %d isÇotáctive",

193 *
pid
);

194 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

196 
i
;

197 
esm_pdn_t
 *
pdn
 = 
˘x
->
esm_d©a_˘x
.pdn[*
pid
].
d©a
;

199 *
esm_ˇu£
 = 
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
;

201 
i
 = 0; i < 
pdn
->
n_bóªrs
; i++) {

202 i‡(
pdn
->
bóªr
[
i
]->
ebi
 !=Ébi) {

206 
rc
 = 
RETURNok
;

211 
	`LOG_FUNC_RETURN
 (
rc
);

212 
	}
}

239 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
(
is_°™dÆ⁄e
,

240 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

241 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

243 
LOG_FUNC_IN
;

245 
rc
;

247 
	`LOG_TRACE
(
INFO
,"ESM-PROC - Initiate EPS bearer context deactivation "

248 "(ueid=%d,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

252 
rc
 = 
	`_ïs_bóªr_dó˘iv©e
(
˘x
, 
ebi
, 
msg
);

254 i‡(
rc
 !
RETURNîr‹
) {

256 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_INACTIVE_PENDING
,

257 
ue_åiggîed
);

258 i‡(
rc
 !
RETURNok
) {

260 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wasálready INACTIVE PENDING",

261 
ebi
);

265 
	`LOG_FUNC_RETURN
 (
rc
);

266 
	}
}

292 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

293 *
esm_ˇu£
)

295 
LOG_FUNC_IN
;

297 
rc
;

298 
pid
 = 
RETURNîr‹
;

300 
	`LOG_TRACE
(
INFO
, "ESM-PROC - EPS bearer context deactivation "

301 "ac˚±ed byÅhêUE (ueid=%u,Ébi=%d)", 
˘x
->
ueid
, 
ebi
);

304 
rc
 = 
	`esm_ebr_°›_timî
(
˘x
, 
ebi
);

305 i‡(
rc
 !
RETURNîr‹
) {

306 
bid
;

308 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
˘x
, 
ebi
, &
pid
, &
bid
);

309 i‡(
rc
 !
RETURNok
) {

311 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

312 
pid
 = 
RETURNîr‹
;

316 
	`LOG_FUNC_RETURN
 (
pid
);

317 
	}
}

326 #ifde‡
NAS_UE


352 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
is_loˇl
, 
ebi
,

353 *
pid
, *
bid
)

355 
LOG_FUNC_IN
;

357 
rc
 = 
RETURNîr‹
;

358 
i
;

360 i‡(
is_loˇl
) {

361 i‡(
ebi
 !
ESM_SAP_ALL_EBI
) {

363 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
ebi
, 
pid
, 
bid
);

366 *
bid
 = 0;

367 *
pid
 = 0; *pid < 
ESM_DATA_PDN_MAX
; (*pid)++) {

368 i‡(
_esm_d©a
.
pdn
[*
pid
].
d©a
) {

369 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
ESM_EBI_UNASSIGNED
, 
pid
, 
bid
);

370 i‡(
rc
 !
RETURNok
) {

376 
	`LOG_FUNC_RETURN
 (
rc
);

379 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EPS bearer context deactivation (ebi=%d)",

380 
ebi
);

382 i‡(*
pid
 < 
ESM_DATA_PDN_MAX
) {

383 i‡(
_esm_d©a
.
pdn
[*
pid
].pid != *pid) {

384 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier %d "

385 "i†nŸ vÆid", *
pid
);

386 } i‡(
_esm_d©a
.
pdn
[*
pid
].
d©a
 =
NULL
) {

387 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

388 "Æloˇãd", *
pid
);

389 } i‡(!
_esm_d©a
.
pdn
[*
pid
].
is_a˘ive
) {

390 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection %d isÇotáctive",

391 *
pid
);

393 
esm_pdn_t
 *
pdn
 = 
_esm_d©a
.pdn[*
pid
].
d©a
;

394 
i
 = 0; i < 
pdn
->
n_bóªrs
; i++) {

395 i‡(
pdn
->
bóªr
[
i
]->
ebi
 !=Ébi) {

399 
rc
 = 
RETURNok
;

404 
	`LOG_FUNC_RETURN
 (
rc
);

405 
	}
}

424 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
(
ebi
, *
esm_ˇu£
)

426 
LOG_FUNC_IN
;

428 
pid
, 
bid
;

429 
rc
 = 
RETURNok
;

431 
	`LOG_TRACE
(
INFO
, "ESM-PROC - EPS bearer context deactivation "

432 "ªque°ed byÅhê√tw‹k (ebi=%d)", 
ebi
);

435 i‡(
	`esm_ebr_c⁄ãxt_ªÀa£
(
ebi
, &
pid
, &
bid
Ë=
ESM_EBI_UNASSIGNED
) {

436 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease EPS bearer context");

437 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

438 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

441 i‡(
bid
 == 0) {

444 i‡(*
esm_ˇu£
 =
ESM_CAUSE_REACTIVATION_REQUESTED
) {

445 
esm_ßp_t
 
esm_ßp
;

446 
a˘ive
 = 
FALSE
;

453 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - TheÇetworkÑequests PDN "

457 
rc
 = 
	`esm_maö_gë_pdn
(
pid
 + 1, &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
pdn_ty≥
,

458 &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
≠n
,

459 &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_emîgícy
,

460 &
a˘ive
);

461 i‡(
rc
 !
RETURNîr‹
) {

462 i‡(
a˘ive
) {

463 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - ConnectivityÅo APN %s "

465 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
≠n
);

466 *
esm_ˇu£
 = 
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
;

467 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

472 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REQ
;

473 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

474 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_deföed
 = 
TRUE
;

475 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
cid
 = 
pid
 + 1;

476 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

481 
	`LOG_FUNC_RETURN
 (
rc
);

482 
	}
}

508 
	$esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

509 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

511 
LOG_FUNC_IN
;

513 
rc
 = 
RETURNok
;

515 
	`LOG_TRACE
(
INFO
,"ESM-PROC - EPS bearer context deactivationáccepted");

517 i‡(
is_°™dÆ⁄e
) {

518 
emm_ßp_t
 
emm_ßp
;

522 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

523 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

524 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
Àngth
 = msg->length;

525 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
vÆue
 = msg->value;

526 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

529 i‡(
rc
 !
RETURNîr‹
) {

531 
rc
 = 
	`esm_ebr_£t_°©us
(
ebi
, 
ESM_EBR_INACTIVE
, 
ue_åiggîed
);

532 i‡(
rc
 !
RETURNok
) {

534 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady INACTIVE", 
ebi
);

537 
	`LOG_FUNC_RETURN
 (
RETURNok
);

540 
rc
 = 
	`esm_ebr_ªÀa£
(
ebi
);

543 
	`LOG_FUNC_RETURN
 (
rc
);

544 
	}
}

557 #ifde‡
NAS_MME


580 *
	$_ïs_bóªr_dó˘iv©e_t3495_h™dÀr
(*
¨gs
)

582 
LOG_FUNC_IN
;

584 
rc
;

587 
esm_ebr_timî_d©a_t
 *
d©a
 = (esm_ebr_timî_d©a_à*)(
¨gs
);

590 
d©a
->
cou¡
 += 1;

592 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - T3495ÅimerÉxpired (ueid=%d,Ébi=%d), "

594 
d©a
->
ueid
, d©a->
ebi
, d©a->
cou¡
);

596 i‡(
d©a
->
cou¡
 < 
EPS_BEARER_DEACTIVATE_COUNTER_MAX
) {

598 
rc
 = 
	`_ïs_bóªr_dó˘iv©e
(
d©a
->
˘x
, d©a->
ebi
, &d©a->
msg
);

604 
pid
, 
bid
;

607 
rc
 = 
	`_ïs_bóªr_ªÀa£
(
d©a
->
˘x
, d©a->
ebi
, &
pid
, &
bid
);

608 i‡(
rc
 !
RETURNîr‹
) {

610 
rc
 = 
	`esm_ebr_°›_timî
(
d©a
->
˘x
, d©a->
ebi
);

614 
	`LOG_FUNC_RETURN
 (
NULL
);

615 
	}
}

624 #ifde‡
NAS_MME


642 
	$_ïs_bóªr_dó˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

643 c⁄° 
O˘ëSåög
 *
msg
)

645 
LOG_FUNC_IN
;

647 
emm_ßp_t
 
emm_ßp
;

648 
rc
;

654 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

655 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

656 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 
˘x
->ueid;

657 
emm_ßp
.
u
.
emm_esm
.
˘x
 = ctx;

658 
emm_esm
->
msg
 = *msg;

659 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

661 i‡(
rc
 !
RETURNîr‹
) {

663 
rc
 = 
	`esm_ebr_°¨t_timî
(
˘x
, 
ebi
, 
msg
, 
T3495_DEFAULT_VALUE
,

664 
_ïs_bóªr_dó˘iv©e_t3495_h™dÀr
);

667 
	`LOG_FUNC_RETURN
 (
rc
);

668 
	}
}

689 
	$_ïs_bóªr_ªÀa£
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, *
pid
, *
bid
)

691 
LOG_FUNC_IN
;

693 
rc
 = 
RETURNîr‹
;

696 
ebi
 = 
	`esm_ebr_c⁄ãxt_ªÀa£
(
˘x
,Ébi, 
pid
, 
bid
);

697 i‡(
ebi
 =
ESM_EBI_UNASSIGNED
) {

698 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease EPS bearer context");

701 
rc
 = 
	`esm_ebr_£t_°©us
(
˘x
, 
ebi
, 
ESM_EBR_INACTIVE
, 
FALSE
);

702 i‡(
rc
 !
RETURNok
) {

704 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady INACTIVE", 
ebi
);

707 
rc
 = 
	`esm_ebr_ªÀa£
(
˘x
, 
ebi
);

708 i‡(
rc
 !
RETURNok
) {

709 
	`LOG_TRACE
(
WARNING
,

715 
	`LOG_FUNC_RETURN
 (
rc
);

716 
	}
}

725 #ifde‡
NAS_UE


744 
	$_ïs_bóªr_ªÀa£
(
ebi
, *
pid
, *
bid
)

746 
LOG_FUNC_IN
;

748 
rc
 = 
RETURNîr‹
;

751 
ebi
 = 
	`esm_ebr_c⁄ãxt_ªÀa£
”bi, 
pid
, 
bid
);

752 i‡(
ebi
 =
ESM_EBI_UNASSIGNED
) {

753 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease EPS bearer context");

756 
rc
 = 
	`esm_ebr_£t_°©us
(
ebi
, 
ESM_EBR_INACTIVE
, 
FALSE
);

757 i‡(
rc
 !
RETURNok
) {

759 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - EBI %d wa†Æªady INACTIVE", 
ebi
);

762 
rc
 = 
	`esm_ebr_ªÀa£
(
ebi
);

763 i‡(
rc
 !
RETURNok
) {

764 
	`LOG_TRACE
(
WARNING
,

770 
	`LOG_FUNC_RETURN
 (
rc
);

771 
	}
}

	@src/esm/EsmStatusHdl.c

55 
	~"esm_¥oc.h
"

56 
	~"comm⁄Def.h
"

57 
	~"«s_log.h
"

59 
	~"esm_ˇu£.h
"

61 
	~"emm_ßp.h
"

99 
esm_¥oc_°©us_öd
(

100 #ifde‡
NAS_MME


101 
emm_d©a_c⁄ãxt_t
 *
˘x
,

103 
±i
, 
ebi
, *
esm_ˇu£
)

105 
	gLOG_FUNC_IN
;

107 
	grc
;

109 
LOG_TRACE
(
INFO
,"ESM-PROC - ESM statusÖrocedureÑequested (cause=%d)",

110 *
esm_ˇu£
);

112 
LOG_TRACE
(
DEBUG
, "ESM-PROC - To be implemented");

114 *
	gesm_ˇu£
) {

115 
	gESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
:

122 
rc
 = 
RETURNok
;

125 
	gESM_CAUSE_INVALID_PTI_VALUE
:

131 
rc
 = 
RETURNok
;

134 
	gESM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
:

140 
rc
 = 
RETURNok
;

149 
rc
 = 
RETURNok
;

153 
LOG_FUNC_RETURN
 (
rc
);

174 
esm_¥oc_°©us
(
is_°™dÆ⁄e
,

175 #ifde‡
NAS_MME


176 
emm_d©a_c⁄ãxt_t
 *
˘x
,

178 
ebi
, 
O˘ëSåög
 *
msg
,

179 
ue_åiggîed
)

181 
	gLOG_FUNC_IN
;

183 
	grc
;

184 
emm_ßp_t
 
	gemm_ßp
;

186 
LOG_TRACE
(
INFO
,"ESM-PROC - ESM statusÖrocedureÑequested");

191 
	gemm_ßp
.
	g¥imôive
 = 
EMMESM_UNITDATA_REQ
;

192 #ifde‡
NAS_UE


193 
	gemm_ßp
.
	gu
.
	gemm_esm
.
	gueid
 = 0;

195 #ifde‡
NAS_MME


196 
	gemm_ßp
.
	gu
.
	gemm_esm
.
	gueid
 = 
˘x
->
ueid
;

197 
	gemm_ßp
.
	gu
.
	gemm_esm
.
	g˘x
 = 
˘x
;

199 
	gemm_ßp
.
	gu
.
	gemm_esm
.u.
	gd©a
.
	gmsg
.
	gÀngth
 = 
msg
->
Àngth
;

200 
	gemm_ßp
.
	gu
.
	gemm_esm
.u.
	gd©a
.
	gmsg
.
	gvÆue
 = 
msg
->
vÆue
;

201 
	grc
 = 
emm_ßp_£nd
(&
emm_ßp
);

203 
LOG_FUNC_RETURN
 (
rc
);

	@src/esm/PdnConnectivity.c

57 
	~<°dlib.h
>

58 
	~<°rög.h
>

59 
	~<˘y≥.h
>

61 
	~"esm_¥oc.h
"

62 
	~"comm⁄Def.h
"

63 
	~"«s_log.h
"

65 
	~"esmD©a.h
"

66 
	~"esm_ˇu£.h
"

67 
	~"esm_±.h
"

69 #ifde‡
NAS_MME


70 
	~"mme_≠i.h
"

73 
	~"emm_ßp.h
"

75 #i‡
deföed
(
ENABLE_ITTI
)

76 
	~"as£πi⁄s.h
"

92 #ifde‡
NAS_UE


96 
_pdn_c⁄√˘ivôy_¸óã
(
pid
, c⁄° 
O˘ëSåög
 *
≠n
,

97 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
, 
is_emîgícy
);

98 
_pdn_c⁄√˘ivôy_upd©e
(
pid
, c⁄° 
O˘ëSåög
 *
≠n
,

99 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
, c⁄° 
O˘ëSåög
 *
pdn_addr
, 
esm_ˇu£
);

100 
_pdn_c⁄√˘ivôy_dñëe
(
pid
);

102 
_pdn_c⁄√˘ivôy_£t_±i
(
pid
, 
±i
);

103 
_pdn_c⁄√˘ivôy_föd_≠n
(c⁄° 
O˘ëSåög
 *
≠n
);

104 
_pdn_c⁄√˘ivôy_föd_pdn
(c⁄° 
O˘ëSåög
 *
≠n
,

105 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
);

110 *
_pdn_c⁄√˘ivôy_t3482_h™dÀr
(*);

113 
	#ESM_PDN_CONNECTIVITY_COUNTER_MAX
 5

	)

122 #ifde‡
NAS_MME


126 
_pdn_c⁄√˘ivôy_¸óã
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

127 
±i
,

128 c⁄° 
O˘ëSåög
 *
≠n
,

129 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

130 c⁄° 
O˘ëSåög
 *
pdn_addr
,

131 
is_emîgícy
);

132 
_pdn_c⁄√˘ivôy_dñëe
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
);

145 #ifde‡
NAS_UE


170 
	$esm_¥oc_pdn_c⁄√˘ivôy
(
cid
, 
is_to_deföe
,

171 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

172 c⁄° 
O˘ëSåög
 *
≠n
, 
is_emîgícy
,

173 *
±i
)

175 
LOG_FUNC_IN
;

177 
rc
 = 
RETURNîr‹
;

178 
pid
 = 
cid
 - 1;

180 i‡(!
is_to_deföe
) {

181 
	`LOG_TRACE
(
INFO
, "ESM-PROC - UndeföêPDN c⁄√˘i⁄ (cid=%d)", 
cid
);

183 
±i
 = 
	`_pdn_c⁄√˘ivôy_dñëe
(
pid
);

184 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

186 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

188 
	`LOG_FUNC_RETURN
(
rc
);

189 } i‡(
±i
 !
NULL
) {

190 
	`LOG_TRACE
(
INFO
, "ESM-PROC - AssignÇewÖrocedureÅransaction identity "

191 "(cid=%d)", 
cid
);

193 *
±i
 = 
	`esm_±_assign
();

194 i‡(*
±i
 =
ESM_PT_UNASSIGNED
) {

195 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoássignÇewÖrocedure "

197 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

200 
rc
 = 
	`_pdn_c⁄√˘ivôy_£t_±i
(
pid
, *
±i
);

201 i‡(
rc
 !
RETURNok
) {

202 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo update PDN connection");

204 
	`LOG_FUNC_RETURN
 (
rc
);

207 
	`LOG_TRACE
(
INFO
,"ESM-PROC - DefineÇew %s PDN connectionÅo APN %s (cid=%d)",

208 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV4
)? "IPv4" :

209 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV6
)? "IPv6" : "IPv4v6",

210 
≠n
->
vÆue
, 
cid
);

212 i‡(
is_emîgícy
 && 
_esm_d©a
.
emîgícy
) {

215 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection forÉmergency bearer "

217 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

218 } i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

219 i‡((
pid
 =
_esm_d©a
.
pdn
[pid].pidË&& (_esm_d©a.pdn[pid].
is_a˘ive
)) {

221 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection isáctive");

222 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

225 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection identifier isÇot valid");

226 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

229 i‡(
≠n
 &&á≤->
Àngth
 > 0) {

231 
pid
 = 
	`_pdn_c⁄√˘ivôy_föd_≠n
(
≠n
);

232 i‡–(
pid
 >0Ë&& 
_esm_d©a
.
pdn
[pid].
is_a˘ive
 ) {

234 i‡–(
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !
ESM_PDN_TYPE_IPV4V6
) &&

235 (
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !
pdn_ty≥
) ) {

238 i‡(!
_esm_d©a
.
pdn
[
pid
].
d©a
->
addr_ªÆloc
) {

241 i‡(
pdn_ty≥
 !
ESM_PDN_TYPE_IPV4V6
) {

242 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - %s PDN connectivityÅo "

244 (
pdn_ty≥
 !
ESM_PDN_TYPE_IPV4
)? "IPv6" :

245 "IPv4", 
≠n
->
vÆue
);

247 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - %s PDN connectionÅo %s "

249 (
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !=

250 
ESM_PDN_TYPE_IPV4
)? "IPv6" : "IPv4",

251 
≠n
->
vÆue
);

253 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

258 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - %s PDN connectionÅo %s "

260 (
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !
ESM_PDN_TYPE_IPV4
)?

261 (
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !
ESM_PDN_TYPE_IPV6
)?

262 "IPv4v6" : "IPv6" : "IPv4", 
≠n
->
vÆue
);

263 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

276 
rc
 = 
	`_pdn_c⁄√˘ivôy_¸óã
(
pid
, 
≠n
, 
pdn_ty≥
, 
is_emîgícy
);

277 
	`LOG_FUNC_RETURN
(
rc
);

278 
	}
}

307 
	$esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(
is_°™dÆ⁄e
, 
±i
,

308 
O˘ëSåög
 *
msg
, 
£¡_by_ue
)

310 
LOG_FUNC_IN
;

312 
rc
 = 
RETURNok
;

314 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Inôüã PDN c⁄√˘ivôy (±i=%d)", 
±i
);

316 i‡(
is_°™dÆ⁄e
) {

317 
emm_ßp_t
 
emm_ßp
;

318 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

322 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

323 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

324 
emm_esm
->
msg
.
Àngth
 = msg->length;

325 
emm_esm
->
msg
.
vÆue
 = msg->value;

326 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

328 i‡(
rc
 !
RETURNîr‹
) {

330 
rc
 = 
	`esm_±_°¨t_timî
(
±i
, 
msg
, 
T3482_DEFAULT_VALUE
,

331 
_pdn_c⁄√˘ivôy_t3482_h™dÀr
);

335 i‡(
rc
 !
RETURNîr‹
) {

337 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_PENDING
);

338 i‡(
rc
 !
RETURNok
) {

340 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wa†Æªady PENDING", 
±i
);

343 
	`LOG_FUNC_RETURN
(
rc
);

344 
	}
}

372 
	$esm_¥oc_pdn_c⁄√˘ivôy_ac˚±
(
±i
, 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

373 c⁄° 
O˘ëSåög
 *
pdn_addr
,

374 c⁄° 
O˘ëSåög
 *
≠n
, *
esm_ˇu£
)

376 
LOG_FUNC_IN
;

378 
rc
;

379 
pid
 = 
RETURNîr‹
;

380 
≠n_fú°_ch¨
[4];

382 i‡(
	`i•röt
(
≠n
->
vÆue
[0])) {

383 
≠n_fú°_ch¨
[0] = '\0';

385 
	`•rötf
 (
≠n_fú°_ch¨
, "%02X", 
≠n
->
vÆue
[0]);

388 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN connectivityáccepted byÅheÇetwork "

389 "’ti=%dËAPN = %s\"%s\", IPáddªs†%s", 
±i
, 
≠n_fú°_ch¨
, 
	`i•röt
(
≠n
->
vÆue
[0]) ? &apn->value[0] : &apn->value[1],

390 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV4
)? 
	`esm_d©a_gë_ùv4_addr
(
pdn_addr
) :

391 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV6
)? 
	`esm_d©a_gë_ùv6_addr
(
pdn_addr
) :

392 
	`esm_d©a_gë_ùv4v6_addr
(
pdn_addr
));

395 (Ë
	`esm_±_°›_timî
(
±i
);

397 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_INACTIVE
);

398 i‡(
rc
 !
RETURNok
) {

403 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %dÇëw‹kÑëønsmissi⁄", 
±i
);

404 *
esm_ˇu£
 = 
ESM_CAUSE_PTI_ALREADY_IN_USE
;

416 
pid
 = 
	`_pdn_c⁄√˘ivôy_föd_pdn
(
≠n
, 
pdn_ty≥
);

418 i‡(
pid
 < 0) {

421 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connectionÉntry for "

422 "APN \"%s\" (ty≥=%dËnŸ found", 
≠n
->
vÆue
, 
pdn_ty≥
);

423 *
esm_ˇu£
 = 
ESM_CAUSE_UNKNOWN_ACCESS_POINT_NAME
;

424 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

428 
rc
 = 
	`_pdn_c⁄√˘ivôy_upd©e
(
pid
, 
≠n
, 
pdn_ty≥
, 
pdn_addr
, *
esm_ˇu£
);

429 i‡(
rc
 !
RETURNok
) {

430 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo update PDN connection "

431 "’id=%d)", 
pid
);

432 *
esm_ˇu£
 = 
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
;

433 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

437 
	`LOG_FUNC_RETURN
 (
pid
);

438 
	}
}

462 
	$esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
(
±i
, *
esm_ˇu£
)

464 
LOG_FUNC_IN
;

466 
rc
;

468 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connectivityÑejected by "

469 "thê√tw‹k (±i=%d), ESM cau£ = %d", 
±i
, *
esm_ˇu£
);

472 (Ë
	`esm_±_°›_timî
(
±i
);

474 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_INACTIVE
);

475 i‡(
rc
 !
RETURNok
) {

477 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wa†Æªady INACTIVE", 
±i
);

478 *
esm_ˇu£
 = 
ESM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

481 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

482 i‡(
rc
 !
RETURNok
) {

483 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FaûedÅÿªÀa£ PTI %d", 
±i
);

484 *
esm_ˇu£
 = 
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
;

488 
	`LOG_FUNC_RETURN
(
rc
);

489 
	}
}

511 
	$esm_¥oc_pdn_c⁄√˘ivôy_com∂ëe
()

513 
LOG_FUNC_IN
;

515 
rc
 = 
RETURNîr‹
;

517 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN connectivity complete");

521 
±i
 = 
	`esm_±_gë_≥ndög_±i
(
ESM_PT_INACTIVE
);

522 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

524 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

527 
	`LOG_FUNC_RETURN
(
rc
);

528 
	}
}

551 
	$esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
is_≥ndög
)

553 
LOG_FUNC_IN
;

555 
rc
;

556 
±i
;

558 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connectivity failure in state %s",

559 (
is_≥ndög
)? "PENDING" : "INACTIVE");

561 i‡(
is_≥ndög
) {

564 
±i
 = 
	`esm_±_gë_≥ndög_±i
(
ESM_PT_PENDING
);

565 i‡(
±i
 =
ESM_PT_UNASSIGNED
) {

566 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - NoÖrocedureÅransaction is PENDING");

567  (
RETURNîr‹
);

570 (Ë
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_INACTIVE
);

574 
±i
 = 
	`esm_±_gë_≥ndög_±i
(
ESM_PT_INACTIVE
);

578 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

579 i‡(
rc
 !
RETURNok
) {

580 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FaûedÅÿªÀa£ PTI %d", 
±i
);

583 
	`LOG_FUNC_RETURN
(
rc
);

584 
	}
}

593 #ifde‡
NAS_MME


631 
	$esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
,

632 
esm_¥oc_pdn_ªque°_t
 
ªque°_ty≥
,

633 
O˘ëSåög
 *
≠n
,

634 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

635 
O˘ëSåög
 *
pdn_addr
,

636 
esm_¥oc_qos_t
 *
esm_qos
,

637 *
esm_ˇu£
)

639 
rc
 = 
RETURNîr‹
;

640 
pid
 = 
RETURNîr‹
;

642 
LOG_FUNC_IN
;

644 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN connectivityÑequested byÅhe UE "

645 "(ueid=%u,Öti=%dËPDNÅy≥ = %s, APN = %†pd¿add∏%s", 
˘x
->
ueid
, 
±i
,

646 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV4
)? "IPv4" :

647 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV6
)? "IPv6" : "IPv4v6",

648 (
≠n
Ë? (*)◊≤->
vÆue
) : "null",

649 (
pdn_addr
Ë? (*)’dn_addr->
vÆue
) : "null");

651 #i‡!
	`deföed
(
EPC_BUILD
)

653 i‡(
˘x
->
ueid
 >
ESM_DATA_NB_UE_MAX
) {

654 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Number of connected UEsÉxceeded");

655 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

662 *
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

663 
	`LOG_TRACE
(
INFO
, "ESM-PROC - _esm_d©a.c⁄f.„©uª†%08x", 
_esm_d©a
.
c⁄f
.
„©uªs
);

665 #i‡
	`deföed
(
ORIGINAL_CODE
)

666 
_esm_d©a
.
c⁄f
.
„©uªs
 & (
MME_API_IPV4
 | 
MME_API_IPV6
)) {

667 (
MME_API_IPV4
 | 
MME_API_IPV6
):

669 i‡–(
pdn_ty≥
 =
ESM_PDN_TYPE_IPV4V6
) &&

670 (
_esm_d©a
.
c⁄f
.
„©uªs
 & 
MME_API_SINGLE_ADDR_BEARERS
) ) {

672 *
esm_ˇu£
 = 
ESM_CAUSE_SINGLE_ADDRESS_BEARERS_ONLY_ALLOWED
;

674 
rc
 = 
RETURNok
;

677 
MME_API_IPV6
:

679 *
esm_ˇu£
 = 
ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
;

680 i‡(
pdn_ty≥
 !
ESM_PDN_TYPE_IPV4
) {

681 
rc
 = 
RETURNok
;

685 
MME_API_IPV4
:

687 *
esm_ˇu£
 = 
ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
;

688 i‡(
pdn_ty≥
 !
ESM_PDN_TYPE_IPV6
) {

689 
rc
 = 
RETURNok
;

694 
	`LOG_TRACE
(
ERROR
,

696 
_esm_d©a
.
c⁄f
.
„©uªs
);

699 
rc
 = 
RETURNok
;

701 i‡(
rc
 !
RETURNîr‹
) {

702 
is_emîgícy
 = (
ªque°_ty≥
 =
ESM_PDN_REQUEST_EMERGENCY
);

703 #i‡
	`deföed
(
ORIGINAL_CODE
)

704 
mme_≠i_ù_vîsi⁄_t
 
mme_pdn_ödex
;

705 
mme_≠i_qos_t
 
qos
;

707 
pdn_ty≥
)

709 
ESM_PDN_TYPE_IPV4
:

710 
mme_pdn_ödex
 = 
MME_API_IPV4_ADDR
;

713 
ESM_PDN_TYPE_IPV6
:

714 
mme_pdn_ödex
 = 
MME_API_IPV6_ADDR
;

717 
ESM_PDN_TYPE_IPV4V6
:

719 
mme_pdn_ödex
 = 
MME_API_IPV4V6_ADDR
;

724 
rc
 = 
	`mme_≠i_subs¸ibe
(
≠n
, 
mme_pdn_ödex
, 
pdn_addr
, 
is_emîgícy
, &
qos
);

726 i‡(
rc
 !
RETURNok
) {

727 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - ConnectivityÅoÅheÑequested PDN "

729 *
esm_ˇu£
 = 
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
;

730 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

735 
pid
 = 
	`_pdn_c⁄√˘ivôy_¸óã
(
˘x
, 
±i
, 
≠n
, 
pdn_ty≥
,

736 
pdn_addr
, 
is_emîgícy
);

737 #i‡
	`deföed
(
ORIGINAL_CODE
)

739 i‡(
esm_qos
) {

740 
esm_qos
->
gbrUL
 = 
qos
.
gbr
[
MME_API_UPLINK
];

741 
esm_qos
->
gbrDL
 = 
qos
.
gbr
[
MME_API_DOWNLINK
];

742 
esm_qos
->
mbrUL
 = 
qos
.
mbr
[
MME_API_UPLINK
];

743 
esm_qos
->
mbrDL
 = 
qos
.
mbr
[
MME_API_DOWNLINK
];

744 
esm_qos
->
qci
 = 
qos
.qci;

747 i‡(
pid
 < 0) {

748 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo create PDN connection");

749 *
esm_ˇu£
 = 
ESM_CAUSE_INSUFFICIENT_RESOURCES
;

750 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

754 
	`LOG_FUNC_RETURN
(
pid
);

755 
	}
}

784 
	$esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
(
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

785 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

787 
LOG_FUNC_IN
;

789 
rc
 = 
RETURNîr‹
;

791 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connectivityÇotáccepted byÅhe "

792 "√tw‹k (ueid=%d)", 
˘x
->
ueid
);

794 i‡(
is_°™dÆ⁄e
) {

795 
emm_ßp_t
 
emm_ßp
;

799 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

800 
emm_ßp
.
u
.
emm_esm
.
˘x
 = ctx;

801 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
Àngth
 = msg->length;

802 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
vÆue
 = msg->value;

803 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

809 
	`LOG_FUNC_RETURN
 (
rc
);

810 
	}
}

834 
	$esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
)

836 
±i
;

838 
LOG_FUNC_IN
;

840 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connectivity failure (ueid=%u,Öid=%d)",

841 
˘x
->
ueid
, 
pid
);

844 
±i
 = 
	`_pdn_c⁄√˘ivôy_dñëe
(
˘x
, 
pid
);

845 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

846 
	`LOG_FUNC_RETURN
 (
RETURNok
);

848 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

849 
	}
}

856 #ifde‡
NAS_UE


886 *
	$_pdn_c⁄√˘ivôy_t3482_h™dÀr
(*
¨gs
)

888 
LOG_FUNC_IN
;

890 
rc
;

893 
esm_±_timî_d©a_t
 *
d©a
 = (esm_±_timî_d©a_à*)(
¨gs
);

896 
d©a
->
cou¡
 += 1;

898 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - T3482ÅimerÉxpired (pti=%d), "

899 "ªå™smissi⁄ cou¡î = %d", 
d©a
->
±i
, d©a->
cou¡
);

901 i‡(
d©a
->
cou¡
 < 
ESM_PDN_CONNECTIVITY_COUNTER_MAX
) {

902 
emm_ßp_t
 
emm_ßp
;

903 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

908 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

909 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

910 
emm_esm
->
msg
.
Àngth
 = 
d©a
->msg.length;

911 
emm_esm
->
msg
.
vÆue
 = 
d©a
->msg.value;

912 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

914 i‡(
rc
 !
RETURNîr‹
) {

916 
rc
 = 
	`esm_±_°¨t_timî
(
d©a
->
±i
, &d©a->
msg
, 
T3482_DEFAULT_VALUE
,

917 
_pdn_c⁄√˘ivôy_t3482_h™dÀr
);

921 
rc
 = 
	`esm_±_£t_°©us
(
d©a
->
±i
, 
ESM_PT_INACTIVE
);

922 i‡(
rc
 !
RETURNok
) {

924 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wasálready INACTIVE",

925 
d©a
->
±i
);

928 
rc
 = 
	`esm_±_ªÀa£
(
d©a
->
±i
);

929 i‡(
rc
 !
RETURNok
) {

930 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease PTI %d",

931 
d©a
->
±i
);

936 
	`LOG_FUNC_RETURN
(
NULL
);

937 
	}
}

964 
	$_pdn_c⁄√˘ivôy_¸óã
(
pid
, c⁄° 
O˘ëSåög
 *
≠n
,

965 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

966 
is_emîgícy
)

968 
esm_pdn_t
 *
pdn
 = 
NULL
;

970 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Cª©ê√w PDN c⁄√˘i⁄ (pid=%d)", 
pid
);

972 i‡(
pid
 >
ESM_DATA_PDN_MAX
) {

973  (
RETURNîr‹
);

974 } i‡(
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

975 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection isáctive");

976  (
RETURNîr‹
);

979 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 !
NULL
) {

981 
pdn
 = 
_esm_d©a
.pdn[
pid
].
d©a
;

984 
pdn
 = (
esm_pdn_t
 *)
	`mÆloc
((esm_pdn_t));

985 i‡(
pdn
 =
NULL
) {

986 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - "

988  (
RETURNîr‹
);

990 
	`mem£t
(
pdn
, 0, (
esm_pdn_t
));

992 
_esm_d©a
.
n_pdns
 += 1;

994 
_esm_d©a
.
pdn
[
pid
].pid =Öid;

996 
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
 = 
FALSE
;

998 
_esm_d©a
.
pdn
[
pid
].
d©a
 =Ödn;

1002 
pdn
->
is_emîgícy
 = is_emergency;

1003 i‡–
≠n
 && (≠n->
Àngth
 > 0) ) {

1004 i‡(
pdn
->
≠n
.
Àngth
 > 0) {

1005 
	`‰ì
(
pdn
->
≠n
.
vÆue
);

1006 
pdn
->
≠n
.
Àngth
 = 0;

1008 
pdn
->
≠n
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
◊≤->
Àngth
 + 1);

1009 i‡(
pdn
->
≠n
.
vÆue
) {

1010 
pdn
->
≠n
.
Àngth
 =ápn->length;

1011 
	`mem˝y
(
pdn
->
≠n
.
vÆue
,á≤->vÆue,á≤->
Àngth
);

1012 
pdn
->
≠n
.
vÆue
[pdn->≠n.
Àngth
] = '\0';

1015 
pdn
->
ty≥
 = 
pdn_ty≥
;

1016 
pdn
->
addr_ªÆloc
 = 
FALSE
;

1018  (
RETURNok
);

1019 
	}
}

1038 
	$_pdn_c⁄√˘ivôy_upd©e
(
pid
, c⁄° 
O˘ëSåög
 *
≠n
,

1039 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

1040 c⁄° 
O˘ëSåög
 *
pdn_addr
,

1041 
esm_ˇu£
)

1043 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Upd©êPDN c⁄√˘i⁄ (pid=%d)", 
pid
);

1045 i‡(
pid
 >
ESM_DATA_PDN_MAX
) {

1046  (
RETURNîr‹
);

1047 } i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

1048 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier isÇot valid");

1049  (
RETURNîr‹
);

1050 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

1051 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection hasÇot beenállocated");

1052  (
RETURNîr‹
);

1053 } i‡(
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

1054 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - Active %s PDN connectionÅo %sálready "

1055 "exi°s", (
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 !
ESM_PDN_TYPE_IPV4
)?

1056 "IPv6" : "IPv4", 
_esm_d©a
.
pdn
[
pid
].
d©a
->
≠n
.
vÆue
);

1057  (
RETURNîr‹
);

1061 
esm_pdn_t
 *
pdn
 = 
_esm_d©a
.pdn[
pid
].
d©a
;

1063 i‡–
≠n
 && (≠n->
Àngth
 > 0) ) {

1064 i‡(
pdn
->
≠n
.
Àngth
 > 0) {

1065 
	`‰ì
(
pdn
->
≠n
.
vÆue
);

1066 
pdn
->
≠n
.
Àngth
 = 0;

1068 
pdn
->
≠n
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
◊≤->
Àngth
 + 1);

1069 i‡(
pdn
->
≠n
.
vÆue
) {

1070 
pdn
->
≠n
.
Àngth
 =ápn->length;

1071 
	`mem˝y
(
pdn
->
≠n
.
vÆue
,á≤->vÆue,á≤->
Àngth
);

1072 
pdn
->
≠n
.
vÆue
[pdn->≠n.
Àngth
] = '\0';

1076 i‡–
pdn_addr
 && (pdn_addr->
Àngth
 > 0) ) {

1077 
Àngth
 = ((
pdn_addr
->Àngth < 
ESM_DATA_IP_ADDRESS_SIZE
) ?

1078 
pdn_addr
->
Àngth
 : 
ESM_DATA_IP_ADDRESS_SIZE
);

1079 
	`mem˝y
(
pdn
->
ù_addr
, 
pdn_addr
->
vÆue
, 
Àngth
);

1080 
pdn
->
ty≥
 = 
pdn_ty≥
;

1086 i‡(
esm_ˇu£
 =
ESM_CAUSE_SINGLE_ADDRESS_BEARERS_ONLY_ALLOWED
) {

1093 
pdn
->
addr_ªÆloc
 = 
TRUE
;

1094 } i‡–(
esm_ˇu£
 =
ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
) ||

1095 (
esm_ˇu£
 =
ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
) ) {

1101 
pdn
->
addr_ªÆloc
 = 
FALSE
;

1102 } i‡(
pdn_ty≥
 !
ESM_PDN_TYPE_IPV4V6
) {

1103 
pdn
->
addr_ªÆloc
 = 
TRUE
;

1106  (
RETURNok
);

1107 
	}
}

1127 
	$_pdn_c⁄√˘ivôy_dñëe
(
pid
)

1129 
±i
 = 
ESM_PT_UNASSIGNED
;

1131 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

1132 i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

1133 
	`LOG_TRACE
(
ERROR
,

1135 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

1136 
	`LOG_TRACE
(
ERROR
,

1138 } i‡(
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

1139 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection isáctive");

1143 
±i
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->pti;

1147 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

1149 
_esm_d©a
.
n_pdns
 -= 1;

1151 
_esm_d©a
.
pdn
[
pid
].pid = -1;

1153 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
≠n
.
Àngth
 > 0) {

1154 
	`‰ì
(
_esm_d©a
.
pdn
[
pid
].
d©a
->
≠n
.
vÆue
);

1156 
	`‰ì
(
_esm_d©a
.
pdn
[
pid
].
d©a
);

1157 
_esm_d©a
.
pdn
[
pid
].
d©a
 = 
NULL
;

1158 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN c⁄√˘i⁄ %dÑñó£d", 
pid
);

1162  (
±i
);

1163 
	}
}

1181 
	$_pdn_c⁄√˘ivôy_£t_±i
(
pid
, 
±i
)

1183 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

1184 i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

1185 
	`LOG_TRACE
(
ERROR
,

1187 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

1188 
	`LOG_TRACE
(
ERROR
,

1190 } i‡(
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

1191 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection isáctive");

1195 
_esm_d©a
.
pdn
[
pid
].
d©a
->
±i
 =Öti;

1196  (
RETURNok
);

1200  (
RETURNîr‹
);

1201 
	}
}

1219 
	$_pdn_c⁄√˘ivôy_föd_≠n
(c⁄° 
O˘ëSåög
 *
≠n
)

1221 
i
;

1223 
i
 = 0; i < 
ESM_DATA_PDN_MAX
; i++) {

1224 i‡–(
_esm_d©a
.
pdn
[
i
].
pid
 !-1Ë&& _esm_d©a.pdn[i].
d©a
 ) {

1225 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
≠n
.
Àngth
 !=ápn->length) {

1228 i‡(
	`memcmp
(
_esm_d©a
.
pdn
[
i
].
d©a
->
≠n
.
vÆue
,

1229 
≠n
->
vÆue
,á≤->
Àngth
) != 0) {

1238  (
_esm_d©a
.
pdn
[
i
].
pid
);

1239 
	}
}

1258 
	$_pdn_c⁄√˘ivôy_föd_pdn
(c⁄° 
O˘ëSåög
 *
≠n
,

1259 c⁄° 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
)

1261 
i
;

1263 
i
 = 0; i < 
ESM_DATA_PDN_MAX
; i++) {

1264 i‡–(
_esm_d©a
.
pdn
[
i
].
pid
 !-1Ë&& _esm_d©a.pdn[i].
d©a
 ) {

1266 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
≠n
.
Àngth
 == 0) {

1270 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
≠n
.
Àngth
 !=ápn->length) {

1273 i‡(
	`memcmp
(
_esm_d©a
.
pdn
[
i
].
d©a
->
≠n
.
vÆue
,

1274 
≠n
->
vÆue
,á≤->
Àngth
) != 0) {

1277 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
ty≥
 =
ESM_PDN_TYPE_IPV4V6
) {

1280 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
ty≥
 =
pdn_ty≥
) {

1287  (
_esm_d©a
.
pdn
[
i
].
pid
);

1288 
	}
}

1291 #ifde‡
NAS_MME


1319 
	$_pdn_c⁄√˘ivôy_¸óã
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

1320 
±i
,

1321 c⁄° 
O˘ëSåög
 *
≠n
,

1322 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

1323 c⁄° 
O˘ëSåög
 *
pdn_addr
,

1324 
is_emîgícy
)

1326 
pid
 = 
ESM_DATA_PDN_MAX
;

1328 
	`LOG_TRACE
(
INFO
, "ESM-PROC - CreateÇew PDN connection "

1329 "’ti=%dËAPN = %s, IPáddªs†%†(ueid=%u)", 
±i
, 
≠n
->
vÆue
,

1330 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV4
)? 
	`esm_d©a_gë_ùv4_addr
(
pdn_addr
) :

1331 (
pdn_ty≥
 =
ESM_PDN_TYPE_IPV6
)? 
	`esm_d©a_gë_ùv6_addr
(
pdn_addr
) :

1332 
	`esm_d©a_gë_ùv4v6_addr
(
pdn_addr
), 
˘x
->
ueid
);

1335 
pid
 = 0;Öid < 
ESM_DATA_PDN_MAX
;Öid++) {

1336 i‡(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
 !
NULL
) {

1342 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

1344 
esm_pdn_t
 *
pdn
 = (esm_pdn_à*)
	`mÆloc
((esm_pdn_t));

1345 i‡(
pdn
 !
NULL
) {

1346 
	`mem£t
(
pdn
, 0, (
esm_pdn_t
));

1348 
˘x
->
esm_d©a_˘x
.
n_pdns
 += 1;

1350 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].pid =Öid;

1352 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
is_a˘ive
 = 
FALSE
;

1354 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
 =Ödn;

1357 
pdn
->
±i
 =Öti;

1359 
pdn
->
is_emîgícy
 = is_emergency;

1361 i‡–
≠n
 && (≠n->
Àngth
 > 0) ) {

1362 
pdn
->
≠n
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
◊≤->
Àngth
 + 1);

1363 i‡(
pdn
->
≠n
.
vÆue
) {

1364 
pdn
->
≠n
.
Àngth
 =ápn->length;

1365 
	`mem˝y
(
pdn
->
≠n
.
vÆue
,á≤->vÆue,á≤->
Àngth
);

1366 
pdn
->
≠n
.
vÆue
[pdn->≠n.
Àngth
] = '\0';

1370 i‡–
pdn_addr
 && (pdn_addr->
Àngth
 > 0) ) {

1371 
Àngth
 =

1372 ((
pdn_addr
->
Àngth
 < 
ESM_DATA_IP_ADDRESS_SIZE
) ?

1373 
pdn_addr
->
Àngth
 : 
ESM_DATA_IP_ADDRESS_SIZE
);

1374 
	`mem˝y
(
pdn
->
ù_addr
, 
pdn_addr
->
vÆue
, 
Àngth
);

1375 
pdn
->
ty≥
 = 
pdn_ty≥
;

1378  (
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].pid);

1380 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo createÇew PDN connection "

1381 "’id=%d)", 
pid
);

1385 
	}
}

1407 
	$_pdn_c⁄√˘ivôy_dñëe
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
)

1409 
±i
 = 
ESM_PT_UNASSIGNED
;

1411 i‡(
˘x
 =
NULL
) {

1412  
±i
;

1415 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

1416 i‡(
pid
 !
˘x
->
esm_d©a_˘x
.
pdn
[pid].pid) {

1417 
	`LOG_TRACE
(
ERROR
,

1419 } i‡(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
 =
NULL
) {

1420 
	`LOG_TRACE
(
ERROR
,

1422 } i‡(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
is_a˘ive
) {

1423 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection isáctive");

1427 
±i
 = 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
->pti;

1431 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

1433 
˘x
->
esm_d©a_˘x
.
n_pdns
 -= 1;

1435 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].pid = -1;

1437 i‡(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
->
≠n
.
Àngth
 > 0) {

1438 
	`‰ì
(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
->
≠n
.
vÆue
);

1440 
	`‰ì
(
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
);

1441 
˘x
->
esm_d©a_˘x
.
pdn
[
pid
].
d©a
 = 
NULL
;

1442 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN c⁄√˘i⁄ %dÑñó£d", 
pid
);

1446  (
±i
);

1447 
	}
}

	@src/esm/PdnDisconnect.c

53 
	~"esm_¥oc.h
"

54 
	~"comm⁄Def.h
"

55 
	~"«s_log.h
"

57 
	~"esmD©a.h
"

58 
	~"esm_ˇu£.h
"

59 
	~"esm_±.h
"

61 #ifde‡
NAS_UE


62 
	~"esm_ßp.h
"

65 
	~"emm_ßp.h
"

71 #ifde‡
NAS_MME


72 
_pdn_c⁄√˘ivôy_dñëe
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
);

84 #ifde‡
NAS_UE


88 
_pdn_disc⁄√˘_gë_deÁu…_ebi
(
±i
);

93 *
_pdn_disc⁄√˘_t3492_h™dÀr
(*);

96 
	#ESM_PDN_DISCONNECT_COUNTER_MAX
 5

	)

105 #ifde‡
NAS_MME


109 
_pdn_disc⁄√˘_gë_pid
(
esm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
);

122 #ifde‡
NAS_UE


143 
	$esm_¥oc_pdn_disc⁄√˘
(
cid
, *
±i
, *
ebi
)

145 
LOG_FUNC_IN
;

147 
rc
 = 
RETURNîr‹
;

148 
pid
 = 
cid
 - 1;

150 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

151 i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

152 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection identifier %d is "

153 "nŸ vÆid", 
pid
);

154 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

155 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

156 "Æloˇãd", 
pid
);

157 } i‡(!
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

158 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN connection isÇotáctive");

162 *
±i
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->pti;

165 *
ebi
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
bóªr
[0]->ebi;

166 
rc
 = 
RETURNok
;

170 
	`LOG_FUNC_RETURN
(
rc
);

171 
	}
}

197 
	$esm_¥oc_pdn_disc⁄√˘_ªque°
(
is_°™dÆ⁄e
, 
±i
,

198 
O˘ëSåög
 *
msg
, 
£¡_by_ue
)

200 
LOG_FUNC_IN
;

202 
rc
 = 
RETURNok
;

204 
	`LOG_TRACE
(
INFO
, "ESM-PROC - Inôüã PDN disc⁄√˘i⁄ (±i=%d)", 
±i
);

206 i‡(
is_°™dÆ⁄e
) {

207 
emm_ßp_t
 
emm_ßp
;

208 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

212 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

213 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

214 
emm_esm
->
msg
.
Àngth
 = msg->length;

215 
emm_esm
->
msg
.
vÆue
 = msg->value;

216 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

218 i‡(
rc
 !
RETURNîr‹
) {

220 
rc
 = 
	`esm_±_°¨t_timî
(
±i
, 
msg
, 
T3492_DEFAULT_VALUE
,

221 
_pdn_disc⁄√˘_t3492_h™dÀr
);

225 i‡(
rc
 !
RETURNîr‹
) {

227 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_PENDING
);

228 i‡(
rc
 !
RETURNok
) {

230 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wa†Æªady PENDING", 
±i
);

233 
	`LOG_FUNC_RETURN
(
rc
);

234 
	}
}

259 
	$esm_¥oc_pdn_disc⁄√˘_ac˚±
(
±i
, *
esm_ˇu£
)

261 
LOG_FUNC_IN
;

263 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN disconnectionáccepted byÅheÇetwork "

264 "’ti=%d)", 
±i
);

267 (Ë
	`esm_±_°›_timî
(
±i
);

269 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_INACTIVE
);

270 i‡(
rc
 !
RETURNok
) {

272 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wa†Æªady INACTIVE", 
±i
);

273 *
esm_ˇu£
 = 
ESM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

277 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

278 i‡(
rc
 !
RETURNok
) {

279 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FaûedÅÿªÀa£ PTI %d", 
±i
);

283 
	`LOG_FUNC_RETURN
 (
rc
);

284 
	}
}

309 
	$esm_¥oc_pdn_disc⁄√˘_ªje˘
(
±i
, *
esm_ˇu£
)

311 
LOG_FUNC_IN
;

313 
rc
;

315 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN disconnectionÑejected byÅheÇetwork "

316 "’ti=%d), ESM cau£ = %d", 
±i
, *
esm_ˇu£
);

319 (Ë
	`esm_±_°›_timî
(
±i
);

321 
rc
 = 
	`esm_±_£t_°©us
(
±i
, 
ESM_PT_INACTIVE
);

322 i‡(
rc
 !
RETURNok
) {

325 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wa†Æªady INACTIVE", 
±i
);

326 *
esm_ˇu£
 = 
ESM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
;

329 
rc
 = 
	`esm_±_ªÀa£
(
±i
);

330 i‡(
rc
 !
RETURNok
) {

331 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FaûedÅÿªÀa£ PTI %d", 
±i
);

332 *
esm_ˇu£
 = 
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
;

333 } i‡(*
esm_ˇu£
 !
ESM_CAUSE_LAST_PDN_DISCONNECTION_NOT_ALLOWED
) {

336 
ebi
 = 
	`_pdn_disc⁄√˘_gë_deÁu…_ebi
(
±i
);

337 i‡(
ebi
 < 0) {

338 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - No default EPS bearer found");

339 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

340 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

346 
esm_ßp_t
 
esm_ßp
;

347 
esm_ßp
.
¥imôive
 = 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
;

348 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

349 
esm_ßp
.
ªcv
 = 
NULL
;

350 
esm_ßp
.
£nd
.
Àngth
 = 0;

351 
esm_ßp
.
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
 =Ébi;

352 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

354 i‡(
rc
 !
RETURNok
) {

355 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

360 
	`LOG_FUNC_RETURN
(
rc
);

361 
	}
}

371 #ifde‡
NAS_MME


396 
	$esm_¥oc_pdn_disc⁄√˘_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, *
esm_ˇu£
)

398 
pid
 = 
RETURNîr‹
;

400 
LOG_FUNC_IN
;

402 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN disconnectÑequested byÅhe UE "

403 "(ueid=%d,Öti=%d)", 
˘x
->
ueid
, 
±i
);

406 i‡(
˘x
->
esm_d©a_˘x
.
n_pdns
 > 1) {

409 
pid
 = 
	`_pdn_disc⁄√˘_gë_pid
(&
˘x
->
esm_d©a_˘x
, 
±i
);

410 i‡(
pid
 < 0) {

411 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - No PDN connection found (pti=%d)",

412 
±i
);

413 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

414 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

419 *
esm_ˇu£
 = 
ESM_CAUSE_LAST_PDN_DISCONNECTION_NOT_ALLOWED
;

422 
	`LOG_FUNC_RETURN
(
pid
);

423 
	}
}

447 
	$esm_¥oc_pdn_disc⁄√˘_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
, *
esm_ˇu£
)

449 
LOG_FUNC_IN
;

451 
	`LOG_TRACE
(
INFO
, "ESM-PROC - PDN disconnectáccepted byÅhe UE "

452 "(ueid=%d,Öid=%d)", 
˘x
->
ueid
, 
pid
);

455 
rc
 = 
	`mme_≠i_unsubs¸ibe
(
NULL
);

456 i‡(
rc
 !
RETURNîr‹
) {

458 
±i
 = 
	`_pdn_c⁄√˘ivôy_dñëe
(
˘x
, 
pid
);

459 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

460 
	`LOG_FUNC_RETURN
 (
RETURNok
);

463 *
esm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

464 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

465 
	}
}

492 
	$esm_¥oc_pdn_disc⁄√˘_ªje˘
(
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

493 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
)

495 
LOG_FUNC_IN
;

497 
rc
;

498 
emm_ßp_t
 
emm_ßp
;

500 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PDN disconnectÇotáccepted byÅheÇetwork "

501 "(ueid=%d)", 
˘x
->
ueid
);

506 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

507 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 
˘x
->ueid;

508 
emm_ßp
.
u
.
emm_esm
.
˘x
 = ctx;

509 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
Àngth
 = msg->length;

510 
emm_ßp
.
u
.
emm_esm
.u.
d©a
.
msg
.
vÆue
 = msg->value;

511 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

513 
	`LOG_FUNC_RETURN
(
rc
);

514 
	}
}

527 #ifde‡
NAS_UE


552 *
	$_pdn_disc⁄√˘_t3492_h™dÀr
(*
¨gs
)

554 
LOG_FUNC_IN
;

556 
rc
;

559 
esm_±_timî_d©a_t
 *
d©a
 = (esm_±_timî_d©a_à*)(
¨gs
);

562 
d©a
->
cou¡
 += 1;

564 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - T3492ÅimerÉxpired (pti=%d), "

565 "ªå™smissi⁄ cou¡î = %d", 
d©a
->
±i
, d©a->
cou¡
);

567 i‡(
d©a
->
cou¡
 < 
ESM_PDN_DISCONNECT_COUNTER_MAX
) {

568 
emm_ßp_t
 
emm_ßp
;

569 
emm_esm_d©a_t
 *
emm_esm
 = &
emm_ßp
.
u
.emm_esm.u.
d©a
;

574 
emm_ßp
.
¥imôive
 = 
EMMESM_UNITDATA_REQ
;

575 
emm_ßp
.
u
.
emm_esm
.
ueid
 = 0;

576 
emm_esm
->
msg
.
Àngth
 = 
d©a
->msg.length;

577 
emm_esm
->
msg
.
vÆue
 = 
d©a
->msg.value;

578 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

580 i‡(
rc
 !
RETURNîr‹
) {

582 
rc
 = 
	`esm_±_°¨t_timî
(
d©a
->
±i
, &d©a->
msg
, 
T3492_DEFAULT_VALUE
,

583 
_pdn_disc⁄√˘_t3492_h™dÀr
);

587 
rc
 = 
	`esm_±_£t_°©us
(
d©a
->
±i
, 
ESM_PT_INACTIVE
);

588 i‡(
rc
 !
RETURNok
) {

590 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - PTI %d wasálready INACTIVE",

591 
d©a
->
±i
);

594 
rc
 = 
	`esm_±_ªÀa£
(
d©a
->
±i
);

595 i‡(
rc
 !
RETURNok
) {

596 
	`LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅoÑelease PTI %d",

597 
d©a
->
±i
);

602 
ebi
 = 
	`_pdn_disc⁄√˘_gë_deÁu…_ebi
(
d©a
->
±i
);

603 i‡(
ebi
 < 0) {

604 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - No default EPS bearer found");

605 
	`LOG_FUNC_RETURN
 (
NULL
);

611 
esm_ßp_t
 
esm_ßp
;

612 
esm_ßp
.
¥imôive
 = 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
;

613 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

614 
esm_ßp
.
ªcv
 = 
NULL
;

615 
esm_ßp
.
£nd
.
Àngth
 = 0;

616 
esm_ßp
.
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
 =Ébi;

617 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

622 
	`LOG_FUNC_RETURN
(
NULL
);

623 
	}
}

632 #ifde‡
NAS_UE


650 
	$_pdn_disc⁄√˘_gë_deÁu…_ebi
(
±i
)

652 
ebi
 = -1;

653 
i
;

655 
i
 = 0; i < 
ESM_DATA_PDN_MAX
; i++) {

656 i‡–(
_esm_d©a
.
pdn
[
i
].
pid
 !-1Ë&& _esm_d©a.pdn[i].
d©a
 ) {

657 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
±i
 !=Öti) {

661 i‡(
_esm_d©a
.
pdn
[
i
].
d©a
->
bóªr
[0] !
NULL
) {

664 
ebi
 = 
_esm_d©a
.
pdn
[
i
].
d©a
->
bóªr
[0]->ebi;

670  (
ebi
);

671 
	}
}

674 #ifde‡
NAS_MME


693 
	$_pdn_disc⁄√˘_gë_pid
(
esm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
)

695 
i
 = 
ESM_DATA_PDN_MAX
;

697 i‡(
˘x
 !
NULL
) {

698 
i
 = 0; i < 
ESM_DATA_PDN_MAX
; i++) {

699 i‡–(
˘x
->
pdn
[
i
].
pid
 != -1) &&

700 (
˘x
->
pdn
[
i
].
d©a
 !
NULL
) ) {

701 i‡(
˘x
->
pdn
[
i
].
d©a
->
±i
 !=Öti) {

711  (
˘x
->
pdn
[
i
].
pid
);

712 
	}
}

	@src/esm/esmData.h

46 
	~<°dio.h
>

48 
	~"√tw‹kDef.h
"

49 
	~"O˘ëSåög.h
"

50 
	~"EpsBóªrIdítôy.h
"

52 #ifde‡
NAS_MME


53 
	~"mme_≠i.h
"

56 #i‡
deföed
(
EPC_BUILD
)

57 
	~"åì.h
"

60 #i‚de‡
__ESMDATA_H__


61 
	#__ESMDATA_H__


	)

68 
	#ESM_DATA_EPS_BEARER_TOTAL
 11

	)

78 
	#ESM_EBI_MIN
 (
EPS_BEARER_IDENTITY_FIRST
)

	)

79 
	#ESM_EBI_MAX
 (
EPS_BEARER_IDENTITY_LAST
)

	)

83 
	mESM_EBR_INACTIVE
,

84 
	mESM_EBR_ACTIVE
,

86 #ifde‡
NAS_MME


87 
	mESM_EBR_INACTIVE_PENDING
,

89 
	mESM_EBR_MODIFY_PENDING
,

91 
	mESM_EBR_ACTIVE_PENDING
,

94 
	mESM_EBR_STATE_MAX


95 } 
	tesm_ebr_°©e
;

97 #ifde‡
NAS_MME


100 *
	m˘x
;

101 
	mueid
;

102 
	mebi
;

103 
	mcou¡
;

104 
O˘ëSåög
 
	mmsg
;

105 } 
	tesm_ebr_timî_d©a_t
;

114 
	mebi
;

115 
esm_ebr_°©e
 
	m°©us
;

116 #ifde‡
NAS_UE


117 
	mis_deÁu…_ebr
;

119 
	mcid
;

122 #ifde‡
NAS_MME


123 
«s_timî_t
 
	mtimî
;

124 
esm_ebr_timî_d©a_t
 *
	m¨gs
;

126 } 
	tesm_ebr_c⁄ãxt_t
;

129 
	mödex
;

131 
	#ESM_EBR_DATA_SIZE
 (
ESM_EBI_MAX
 - 
ESM_EBI_MIN
 + 1)

	)

132 
esm_ebr_c⁄ãxt_t
 *
	mc⁄ãxt
[
ESM_EBR_DATA_SIZE
 + 1];

133 } 
	tesm_ebr_d©a_t
;

151 
	mbid
;

152 
	mebi
;

153 
√tw‹k_qos_t
 
	mqos
;

154 
√tw‹k_t·_t
 
	mt·
;

155 } 
	tesm_bóªr_t
;

165 
	m±i
;

167 
	mis_emîgícy
;

168 
O˘ëSåög
 
	m≠n
;

169 
	mambr
;

170 
	mty≥
;

171 
	#ESM_DATA_IPV4_ADDRESS_SIZE
 4

	)

172 
	#ESM_DATA_IPV6_ADDRESS_SIZE
 8

	)

173 
	#ESM_DATA_IP_ADDRESS_SIZE
 (
ESM_DATA_IPV4_ADDRESS_SIZE
 + \

174 
ESM_DATA_IPV6_ADDRESS_SIZE
)

	)

176 
	mù_addr
[
ESM_DATA_IP_ADDRESS_SIZE
+1];

177 
	maddr_ªÆloc
;

181 
	mn_bóªrs
;

183 
	#ESM_DATA_EPS_BEARER_MAX
 4

	)

184 
esm_bóªr_t
 *
	mbóªr
[
ESM_DATA_EPS_BEARER_MAX
];

185 } 
	tesm_pdn_t
;

195 
	sesm_d©a_c⁄ãxt_s
 {

196 
	mue_id
;

198 
	mn_ebrs
;

199 
	mn_pdns
;

200 
	memîgícy
;

202 
	#ESM_DATA_PDN_MAX
 4

	)

204 
	mpid
;

205 
	mis_a˘ive
;

208 
esm_pdn_t
 *
	md©a
;

209 } 
	mpdn
[
ESM_DATA_PDN_MAX
+1];

211 
esm_ebr_d©a_t
 
	mebr
;

212 } 
	tesm_d©a_c⁄ãxt_t
;

219 #ifde‡
NAS_UE


224 
esm_d©a_c⁄ãxt_t
 
	tesm_d©a_t
;

232 #ifde‡
NAS_MME


242 
mme_≠i_esm_c⁄fig_t
 
	mc⁄f
;

247 #i‡
deföed
(
EPC_BUILD
)

249 
RB_HEAD
(
esm_d©a_c⁄ãxt_m≠
, 
esm_d©a_c⁄ãxt_s
Ë
	m˘x_m≠
;

251 
	#ESM_DATA_NB_UE_MAX
 (
MME_API_NB_UE_MAX
 + 1)

	)

252 
esm_d©a_c⁄ãxt_t
 *
	m˘x
[
ESM_DATA_NB_UE_MAX
];

254 } 
	tesm_d©a_t
;

256 #i‡
deföed
(
EPC_BUILD
)

257 
esm_d©a_c⁄ãxt_s
 *
esm_d©a_c⁄ãxt_gë
(

258 
esm_d©a_t
 *
esm_d©a
, 
_ueid
);

260 
esm_d©a_c⁄ãxt_s
 *
esm_d©a_c⁄ãxt_ªmove
(

261 
esm_d©a_t
 *
esm_d©a
, 
esm_d©a_c⁄ãxt_s
 *
ñm
);

263 
esm_d©a_c⁄ãxt_add
(
esm_d©a_t
 *
esm_d©a
, 
esm_d©a_c⁄ãxt_s
 *
ñm
);

277 
esm_d©a_t
 
	g_esm_d©a
;

283 
ù_addr_°r
[100];

285 
ölöe
 *
esm_d©a_gë_ùv4_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
);

287 
ölöe
 *
esm_d©a_gë_ùv6_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
);

289 
ölöe
 *
esm_d©a_gë_ùv4v6_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
);

	@src/esm/esm_ebr.c

47 
	~<°dlib.h
>

48 
	~<°rög.h
>

50 
	~"emmD©a.h
"

51 
	~"esm_ebr.h
"

52 
	~"comm⁄Def.h
"

53 
	~"«s_log.h
"

55 
	~"mme_≠i.h
"

61 #ifde‡
NAS_UE


62 
	#ESM_EBR_NB_UE_MAX
 1

	)

64 #ifde‡
NAS_MME


65 
	#ESM_EBR_NB_UE_MAX
 (
MME_API_NB_UE_MAX
 + 1)

	)

73 c⁄° *
	g_esm_ebr_°©e_°r
[
ESM_EBR_STATE_MAX
] = {

76 #ifde‡
NAS_MME


89 #i‡!
deföed
(
EPC_BUILD
)

90 
esm_ebr_d©a_t
 
	g_esm_ebr_d©a
[
ESM_EBR_NB_UE_MAX
];

98 #ifde‡
NAS_UE


101 
esm_ödiˇti⁄_ˇŒback_t
 
	g_esm_ebr_ˇŒback
;

103 c⁄° 
√tw‹k_pdn_°©e_t
 
	g_esm_ebr_pdn_°©e
[2][2][2] = {

107 {
NET_PDN_NW_DEDICATED_DEACT
, 
NET_PDN_NW_DEDICATED_ACT
},

109 {
NET_PDN_NW_DEFAULT_DEACT
, 0}

114 {
NET_PDN_MT_DEDICATED_DEACT
, 
NET_PDN_MT_DEDICATED_ACT
},

116 {
NET_PDN_MT_DEFAULT_DEACT
, 
NET_PDN_MT_DEFAULT_ACT
}

123 #ifde‡
NAS_MME


124 
_esm_ebr_gë_avaûabÀ_íåy
(
emm_d©a_c⁄ãxt_t
 *
˘x
);

126 #ifde‡
NAS_UE


127 
_esm_ebr_gë_avaûabÀ_íåy
(
ueid
);

148 
esm_ebr_öôülize
(

149 #ifde‡
NAS_UE


150 
esm_ödiˇti⁄_ˇŒback_t
 
cb


154 #i‡!
deföed
(
EPC_BUILD
)

155 
	gueid
, 
	gi
;

157 
	gLOG_FUNC_IN
;

159 
	gueid
 = 0; ueid < 
	gESM_EBR_NB_UE_MAX
; ueid++) {

160 
	g_esm_ebr_d©a
[
ueid
].
	gödex
 = 0;

162 
	gi
 = 0; i < 
	gESM_EBR_DATA_SIZE
 + 1; i++) {

163 
	g_esm_ebr_d©a
[
ueid
].
	gc⁄ãxt
[
i
] = 
NULL
;

166 #ifde‡
NAS_UE


168 
	g_esm_ebr_ˇŒback
 = *
cb
;

171 
	gLOG_FUNC_OUT
;

196 #ifde‡
NAS_UE


197 
	$esm_ebr_assign
(
ebi
, 
cid
, 
deÁu…_ebr
)

199 #ifde‡
NAS_MME


200 
	$esm_ebr_assign
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
)

203 
esm_ebr_c⁄ãxt_t
 *
ebr_˘x
 = 
NULL
;

204 
ueid
 = 0;

205 
i
;

207 
LOG_FUNC_IN
;

209 #i‡
	`deföed
(
NAS_UE
)

210 
ebr_˘x
 = 
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

212 
ebr_˘x
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

215 i‡(
ebi
 !
ESM_EBI_UNASSIGNED
) {

216 i‡–(
ebi
 < 
ESM_EBI_MIN
Ë|| (ebò> 
ESM_EBI_MAX
) ) {

217 
	`LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

218 } i‡(
ebr_˘x
 !
NULL
) {

219 
	`LOG_TRACE
(
WARNING
, "ESM-FSM - EPS bearer contextálready "

220 "assig√d (ebi=%d)", 
ebi
);

221 
	`LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

224 
i
 = 
ebi
 - 
ESM_EBI_MIN
;

227 #ifde‡
NAS_UE


228 
i
 = 
	`_esm_ebr_gë_avaûabÀ_íåy
(
ueid
);

230 
i
 = 
	`_esm_ebr_gë_avaûabÀ_íåy
(
˘x
);

232 i‡(
i
 < 0) {

233 
	`LOG_FUNC_RETURN
(
ESM_EBI_UNASSIGNED
);

236 
ebi
 = 
i
 + 
ESM_EBI_MIN
;

240 
ebr_˘x
 =

241 (
esm_ebr_c⁄ãxt_t
 *)
	`mÆloc
((esm_ebr_context_t));

242 i‡(
ebr_˘x
 =
NULL
) {

243 
	`LOG_FUNC_RETURN
(
ESM_EBI_UNASSIGNED
);

246 #i‡
	`deföed
(
EPC_BUILD
)

247 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] = 
ebr_˘x
;

249 
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] = 
ebr_˘x
;

253 #ifde‡
NAS_MME


254 
˘x
->
esm_d©a_˘x
.
ebr
.
ödex
 = 
i
 + 1;

256 
_esm_ebr_d©a
[
ueid
].
ödex
 = 
i
 + 1;

260 
ebr_˘x
->
ebi
 =Ébi;

262 
ebr_˘x
->
°©us
 = 
ESM_EBR_INACTIVE
;

263 #ifde‡
NAS_UE


265 
ebr_˘x
->
is_deÁu…_ebr
 = 
deÁu…_ebr
;

267 
ebr_˘x
->
cid
 = cid;

269 #ifde‡
NAS_MME


271 
ebr_˘x
->
timî
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

273 
ebr_˘x
->
¨gs
 = 
NULL
;

276 
	`LOG_TRACE
(
INFO
, "ESM-FSM - EPS bóª∏c⁄ãxà%dássig√d", 
ebi
);

277 
	`LOG_FUNC_RETURN
(
ebr_˘x
->
ebi
);

278 
	}
}

298 
esm_ebr_ªÀa£
(

299 #ifde‡
NAS_MME


300 
emm_d©a_c⁄ãxt_t
 *
˘x
,

302 
ebi
)

304 #ifde‡
NAS_UE


305 
	gueid
 = 0;

307 
esm_ebr_c⁄ãxt_t
 *
	gebr_˘x
;

309 
	gLOG_FUNC_IN
;

311 i‡–(
	gebi
 < 
	gESM_EBI_MIN
Ë|| (ebò> 
	gESM_EBI_MAX
) ) {

312 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

316 #i‡
deföed
(
NAS_MME
)

317 
	gebr_˘x
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

319 
	gebr_˘x
 = 
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

321 i‡–(
	gebr_˘x
 =
NULL
Ë|| (
ebr_˘x
->
ebi
 !=Ébi) ) {

323 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

326 i‡(
	gebr_˘x
->
	g°©us
 !
ESM_EBR_INACTIVE
) {

327 
LOG_TRACE
(
ERROR
, "ESM-FSM - EPS bearer context isÇot INACTIVE");

328 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

331 #ifde‡
NAS_MME


333 i‡(
	gebr_˘x
->
	gtimî
.
	gid
 !
NAS_TIMER_INACTIVE_ID
) {

334 
LOG_TRACE
(
INFO
, "ESM-FSM - StopÑetransmissionÅimer %d",

335 
ebr_˘x
->
timî
.
id
);

336 
	gebr_˘x
->
	gtimî
.
	gid
 = 
«s_timî_°›
(
ebr_˘x
->
timî
.
id
);

339 i‡(
	gebr_˘x
->
	g¨gs
) {

340 i‡(
	gebr_˘x
->
	g¨gs
->
	gmsg
.
	gÀngth
 > 0) {

341 
‰ì
(
ebr_˘x
->
¨gs
->
msg
.
vÆue
);

343 
‰ì
(
ebr_˘x
->
¨gs
);

344 
	gebr_˘x
->
	g¨gs
 = 
NULL
;

349 
‰ì
(
ebr_˘x
);

350 
	gebr_˘x
 = 
NULL
;

352 
LOG_TRACE
(
INFO
, "ESM-FSM - EPS bóª∏c⁄ãxà%dÑñó£d", 
ebi
);

353 
LOG_FUNC_RETURN
 (
RETURNok
);

356 #ifde‡
NAS_MME


378 
	$esm_ebr_°¨t_timî
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, c⁄° 
O˘ëSåög
 *
msg
,

379 
£c
, 
«s_timî_ˇŒback_t
 
cb
)

381 
esm_ebr_c⁄ãxt_t
 *
ebr_˘x
;

383 
LOG_FUNC_IN
;

385 i‡–(
ebi
 < 
ESM_EBI_MIN
Ë|| (ebò> 
ESM_EBI_MAX
) ) {

386 
	`LOG_TRACE
(
ERROR
, "ESM-FSM - RetransmissionÅimer badÉbi %d",

387 
ebi
);

388 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

392 
ebr_˘x
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

393 i‡–(
ebr_˘x
 =
NULL
Ë|| (ebr_˘x->
ebi
 !=Ébi) ) {

395 
	`LOG_TRACE
(
ERROR
, "ESM-FSM - EPS bearer contextÇotássigned");

396 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

399 i‡(
ebr_˘x
->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

400 i‡(
ebr_˘x
->
¨gs
) {

402 
ebr_˘x
->
timî
.
id
 = 
	`«s_timî_ª°¨t
(ebr_ctx->timer.id);

406 
ebr_˘x
->
¨gs
 = (
esm_ebr_timî_d©a_t
 *)
	`mÆloc
((esm_ebr_timer_data_t));

407 i‡(
ebr_˘x
->
¨gs
) {

409 
ebr_˘x
->
¨gs
->
ueid
 = 
˘x
->ueid;

411 
ebr_˘x
->
¨gs
->
ebi
 =Ébi;

413 
ebr_˘x
->
¨gs
->
cou¡
 = 0;

415 
ebr_˘x
->
¨gs
->
msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(msg->
Àngth
);

416 
ebr_˘x
->
¨gs
->
msg
.
Àngth
 = 0;

417 i‡(
ebr_˘x
->
¨gs
->
msg
.
vÆue
) {

418 
	`mem˝y
(
ebr_˘x
->
¨gs
->
msg
.
vÆue
, msg->vÆue, msg->
Àngth
);

419 
ebr_˘x
->
¨gs
->
msg
.
Àngth
 = msg->length;

423 
ebr_˘x
->
timî
.
id
 = 
	`«s_timî_°¨t
(
£c
, 
cb
,Ébr_˘x->
¨gs
);

424 
ebr_˘x
->
timî
.
£c
 = sec;

428 i‡–(
ebr_˘x
->
¨gs
 !
NULL
Ë&& (ebr_˘x->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) ) {

429 
	`LOG_TRACE
(
INFO
, "ESM-FSM - RetransmissionÅimer %dÉxpires in "

430 "%ld sec⁄ds", 
ebr_˘x
->
timî
.
id
,Ébr_˘x->timî.
£c
);

431 
	`LOG_FUNC_RETURN
 (
RETURNok
);

433 
	`LOG_TRACE
(
ERROR
, "ESM-FSM -Ébr_ctx->args == NULL(%p) orÉbr_ctx->timer.id == NAS_TIMER_INACTIVE_ID == -1 (%d)" ,

434 
ebr_˘x
->
¨gs
,

435 
ebr_˘x
->
timî
.
id
);

437 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

438 
	}
}

456 
	$esm_ebr_°›_timî
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
)

458 
esm_ebr_c⁄ãxt_t
 *
ebr_˘x
 ;

460 
LOG_FUNC_IN
;

462 i‡–(
ebi
 < 
ESM_EBI_MIN
Ë|| (ebò> 
ESM_EBI_MAX
) ) {

463 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

467 
ebr_˘x
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

468 i‡–(
ebr_˘x
 =
NULL
Ë|| (ebr_˘x->
ebi
 !=Ébi) ) {

470 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

474 i‡(
ebr_˘x
->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

475 
	`LOG_TRACE
(
INFO
, "ESM-FSM - StopÑetransmissionÅimer %d",

476 
ebr_˘x
->
timî
.
id
);

477 
ebr_˘x
->
timî
.
id
 = 
	`«s_timî_°›
(ebr_ctx->timer.id);

481 i‡(
ebr_˘x
->
¨gs
) {

482 i‡(
ebr_˘x
->
¨gs
->
msg
.
Àngth
 > 0) {

483 
	`‰ì
(
ebr_˘x
->
¨gs
->
msg
.
vÆue
);

485 
	`‰ì
(
ebr_˘x
->
¨gs
);

486 
ebr_˘x
->
¨gs
 = 
NULL
;

489 
	`LOG_FUNC_RETURN
 (
RETURNok
);

490 
	}
}

510 
	$esm_ebr_gë_≥ndög_ebi
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
esm_ebr_°©e
 
°©us
)

512 
i
;

514 
LOG_FUNC_IN
;

516 
i
 = 0; i < 
ESM_EBR_DATA_SIZE
; i++) {

517 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
i
] =
NULL
) {

520 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
i
]->
°©us
 != status) {

527 i‡(
i
 < 
ESM_EBR_DATA_SIZE
) {

528 
	`LOG_FUNC_RETURN
 (
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
i
]->
ebi
);

531 
	`LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

532 
	}
}

555 
esm_ebr_£t_°©us
(

556 #ifde‡
NAS_MME


557 
emm_d©a_c⁄ãxt_t
 *
˘x
,

559 
ebi
, 
esm_ebr_°©e
 
°©us
, 
ue_ªque°ed
)

561 
esm_ebr_c⁄ãxt_t
 *
	gebr_˘x
;

562 
esm_ebr_°©e
 
	gﬁd_°©us
;

564 
	gLOG_FUNC_IN
;

566 #ifde‡
NAS_UE


567 
	gueid
 = 0;

569 i‡(
	gueid
 >
ESM_EBR_NB_UE_MAX
) {

570 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

573 i‡(
	g˘x
 =
NULL
) {

574 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

577 i‡–(
	gebi
 < 
	gESM_EBI_MIN
Ë|| (ebò> 
	gESM_EBI_MAX
) ) {

578 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

582 #ifde‡
NAS_UE


583 
	gebr_˘x
 = 
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

585 
	gebr_˘x
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
];

587 i‡–(
	gebr_˘x
 =
NULL
Ë|| (
ebr_˘x
->
ebi
 !=Ébi) ) {

589 
LOG_TRACE
(
ERROR
, "ESM-FSM - EPS bearer contextÇotássigned "

590 "”bi=%d)", 
ebi
);

591 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

594 
	gﬁd_°©us
 = 
ebr_˘x
->
°©us
;

595 i‡(
	g°©us
 < 
	gESM_EBR_STATE_MAX
) {

596 
LOG_TRACE
(
INFO
, "ESM-FSM - Status of EPS bearer context %d changed:"

597 " %†===> %s", 
ebi
,

598 
_esm_ebr_°©e_°r
[
ﬁd_°©us
], _esm_ebr_°©e_°r[
°©us
]);

599 i‡(
	g°©us
 !
ﬁd_°©us
) {

600 
ebr_˘x
->
°©us
 = status;

601 #ifde‡
NAS_UE


605 (*
	g_esm_ebr_ˇŒback
)(
	gebr_˘x
->
	gcid
,

606 
	g_esm_ebr_pdn_°©e
[
ue_ªque°ed
][
ebr_˘x
->
is_deÁu…_ebr
][
°©us
]);

608 
LOG_FUNC_RETURN
 (
RETURNok
);

612 
LOG_FUNC_RETURN
 (
RETURNîr‹
);

632 #ifde‡
NAS_MME


633 
esm_ebr_°©e
 
	$esm_ebr_gë_°©us
(

634 
emm_d©a_c⁄ãxt_t
 *
˘x
,

635 
ebi
)

637 i‡–(
ebi
 < 
ESM_EBI_MIN
Ë|| (ebò> 
ESM_EBI_MAX
) ) {

638  (
ESM_EBR_INACTIVE
);

640 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] =
NULL
) {

642  (
ESM_EBR_INACTIVE
);

644 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->ebi !=Ébi) {

646  (
ESM_EBR_INACTIVE
);

648  (
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->
°©us
);

649 
	}
}

652 #ifde‡
NAS_UE


653 
esm_ebr_°©e
 
	$esm_ebr_gë_°©us
(

654 
ebi
)

656 
ueid
 = 0;

658 i‡–(
ebi
 < 
ESM_EBI_MIN
Ë|| (ebò> 
ESM_EBI_MAX
) ) {

659  (
ESM_EBR_INACTIVE
);

661 i‡(
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] =
NULL
) {

663  (
ESM_EBR_INACTIVE
);

665 i‡(
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->ebi !=Ébi) {

667  (
ESM_EBR_INACTIVE
);

669  (
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->
°©us
);

670 
	}
}

688 
	$esm_ebr_is_ª£rved
(
ebi
)

690  ( (
ebi
 !
ESM_EBI_UNASSIGNED
Ë&& (ebò< 
ESM_EBI_MIN
) );

691 
	}
}

709 
esm_ebr_is_nŸ_ö_u£
(

710 #ifde‡
NAS_MME


711 
emm_d©a_c⁄ãxt_t
 *
˘x
,

713 
ebi
)

715 #ifde‡
NAS_UE


716 
	gueid
 = 0;

718  ( (
	gebi
 =
ESM_EBI_UNASSIGNED
) ||

719 (
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] =
NULL
) ||

720 (
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->ebi) !=Ébi);

722  ( (
	gebi
 =
ESM_EBI_UNASSIGNED
) ||

723 (
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
] =
NULL
) ||

724 (
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
ebi
 - 
ESM_EBI_MIN
]->ebi) !=Ébi);

749 #ifde‡
NAS_MME


750 
	$_esm_ebr_gë_avaûabÀ_íåy
(
emm_d©a_c⁄ãxt_t
 *
˘x
)

752 
i
;

753 
i
 = 
˘x
->
esm_d©a_˘x
.
ebr
.
ödex
; i < 
ESM_EBR_DATA_SIZE
; i++) {

754 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
i
] !
NULL
) {

757  
i
;

759 
i
 = 0; i < 
˘x
->
esm_d©a_˘x
.
ebr
.
ödex
; i++) {

760 i‡(
˘x
->
esm_d©a_˘x
.
ebr
.
c⁄ãxt
[
i
] !
NULL
) {

763  
i
;

767 
	}
}

769 #ifde‡
NAS_UE


770 
	$_esm_ebr_gë_avaûabÀ_íåy
(
ueid
)

772 
i
;

773 
i
 = 
_esm_ebr_d©a
[
ueid
].
ödex
; i < 
ESM_EBR_DATA_SIZE
; i++) {

774 i‡(
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
i
] !
NULL
) {

777  
i
;

779 
i
 = 0; i < 
_esm_ebr_d©a
[
ueid
].
ödex
; i++) {

780 i‡(
_esm_ebr_d©a
[
ueid
].
c⁄ãxt
[
i
] !
NULL
) {

783  
i
;

787 
	}
}

	@src/esm/esm_ebr.h

46 #i‚de‡
__ESM_EBR_H__


47 
	#__ESM_EBR_H__


	)

49 
	~"O˘ëSåög.h
"

51 #ifde‡
NAS_UE


52 
	~"√tw‹kDef.h
"

55 
	~"«s_timî.h
"

62 
	#ESM_EBI_UNASSIGNED
 (
EPS_BEARER_IDENTITY_UNASSIGNED
)

	)

76 
esm_ebr_is_ª£rved
(
ebi
);

78 #ifde‡
NAS_UE


79 
esm_ebr_öôülize
(
esm_ödiˇti⁄_ˇŒback_t
 
cb
);

80 
esm_ebr_assign
(
ebi
, 
cid
, 
deÁu…_ebr
);

81 
esm_ebr_ªÀa£
(
ebi
);

83 
esm_ebr_£t_°©us
(
ebi
, 
esm_ebr_°©e
 
°©us
, 
ue_ªque°ed
);

84 
esm_ebr_°©e
 
esm_ebr_gë_°©us
(
ebi
);

86 
esm_ebr_is_nŸ_ö_u£
(
ebi
);

89 #ifde‡
NAS_MME


90 
esm_ebr_öôülize
();

91 
esm_ebr_assign
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
);

92 
esm_ebr_ªÀa£
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
);

94 
esm_ebr_°¨t_timî
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, c⁄° 
O˘ëSåög
 *
msg
,

95 
£c
, 
«s_timî_ˇŒback_t
 
cb
);

96 
esm_ebr_°›_timî
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
);

98 
esm_ebr_gë_≥ndög_ebi
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
esm_ebr_°©e
 
°©us
);

100 
esm_ebr_£t_°©us
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, 
esm_ebr_°©e
 
°©us
,

101 
ue_ªque°ed
);

102 
esm_ebr_°©e
 
esm_ebr_gë_°©us
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
);

104 
esm_ebr_is_nŸ_ö_u£
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
);

	@src/esm/esm_ebr_context.c

45 
	~<°dlib.h
>

46 
	~<°rög.h
>

48 
	~"comm⁄Def.h
"

49 
	~"«s_log.h
"

51 
	~"emmD©a.h
"

52 
	~"esm_ebr.h
"

54 
	~"esm_ebr_c⁄ãxt.h
"

56 
	~"emm_ßp.h
"

58 #i‡
deföed
(
ENABLE_ITTI
)

59 
	~"as£πi⁄s.h
"

63 #ifde‡
NAS_UE


64 
	~<sys/sockë.h
>

65 
	~<√töë/ö.h
>

66 
	~<¨∑/öë.h
>

78 #ifde‡
NAS_UE


79 
_esm_ebr_c⁄ãxt_check_idítifõrs
(c⁄° 
√tw‹k_t·_t
 *,

80 c⁄° 
√tw‹k_t·_t
 *);

81 
_esm_ebr_c⁄ãxt_check_¥e˚dí˚
(c⁄° 
√tw‹k_t·_t
 *,

82 c⁄° 
√tw‹k_t·_t
 *);

113 
esm_ebr_c⁄ãxt_¸óã
(

114 #ifde‡
NAS_MME


115 
emm_d©a_c⁄ãxt_t
 *
˘x
,

117 
pid
, 
ebi
, 
is_deÁu…
,

118 c⁄° 
√tw‹k_qos_t
 *
qos
, c⁄° 
√tw‹k_t·_t
 *
t·
)

120 
	gbid
 = 0;

121 
esm_d©a_c⁄ãxt_t
 *
	gesm_˘x
 = 
NULL
;

122 
esm_pdn_t
 *
	gpdn
 = 
NULL
;

123 
	gueid
 = 0;

125 
	gLOG_FUNC_IN
;

127 #ifde‡
NAS_UE


128 
	gesm_˘x
 = &
_esm_d©a
;

130 #ifde‡
NAS_MME


131 #i‡
deföed
(
EPC_BUILD
)

132 
	gesm_˘x
 = &
˘x
->
esm_d©a_˘x
;

134 i‡(
	gueid
 < 
	gESM_DATA_NB_UE_MAX
) {

135 
	g˘x
 = 
_esm_d©a
.
˘x
[
ueid
];

137 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

142 
	gbid
 = 
ESM_DATA_EPS_BEARER_MAX
;

144 
LOG_TRACE
(
INFO
, "ESM-PROC - CreateÇew %s EPS bearer context (ebi=%d) "

146 (
is_deÁu…
)? "deÁu…" : "dediˇãd", 
ebi
, 
pid
);

148 i‡(
	gpid
 < 
	gESM_DATA_PDN_MAX
) {

149 i‡(
	gpid
 !
esm_˘x
->
pdn
[
pid
].pid) {

150 
LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier %d is "

151 "nŸ vÆid", 
pid
);

152 } i‡(
	gesm_˘x
->
	gpdn
[
pid
].
	gd©a
 =
NULL
) {

153 
LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

154 "Æloˇãd", 
pid
);

157 i‡(
	gesm_˘x
->
	gn_ebrs
 > 
	gESM_DATA_EPS_BEARER_TOTAL
) {

158 
LOG_TRACE
(
WARNING
, "ESM-PROC - TheÅotalÇumber ofáctive EPS"

162 
	gpdn
 = 
esm_˘x
->
pdn
[
pid
].
d©a
;

163 i‡(
	gis_deÁu…
) {

165 
	gbid
 = 0;

166 i‡(
	gpdn
->
	gbóªr
[
bid
] !
NULL
) {

167 
LOG_TRACE
(
ERROR
, "ESM-PROC - A default EPS bearer context "

169 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

173 
	gbid
 = 1; bid < 
	gESM_DATA_EPS_BEARER_MAX
; bid++) {

174 i‡(
	gpdn
->
	gbóªr
[
bid
] !
NULL
) {

183 i‡(
	gbid
 < 
	gESM_DATA_EPS_BEARER_MAX
) {

185 
esm_bóªr_t
 *
	gebr
 = (esm_bóªr_à*)
mÆloc
((esm_bearer_t));

186 i‡(
	gebr
 !
NULL
) {

187 
mem£t
(
ebr
, 0 , (
esm_bóªr_t
));

189 
	gesm_˘x
->
	gn_ebrs
 += 1;

191 
	gpdn
->
	gn_bóªrs
 += 1;

193 
	gpdn
->
	gbóªr
[
bid
] = 
ebr
;

194 
	gebr
->
	gbid
 = 
bid
;

195 
	gebr
->
	gebi
 = 
ebi
;

196 i‡(
	gqos
 !
NULL
) {

198 
ebr
->
qos
 = *qos;

200 i‡–(
	gt·
 !
NULL
Ë&& (
t·
->
n_pkfs
 < 
NET_PACKET_FILTER_MAX
) ) {

201 
i
;

203 
	gi
 = 0; i < 
	gt·
->
	gn_pkfs
; i++) {

204 
	gebr
->
	gt·
.
	gpkf
[
i
] =

205 (
√tw‹k_pkf_t
 *)
mÆloc
((network_pkf_t));

206 i‡(
	gebr
->
	gt·
.
	gpkf
[
i
] !
NULL
) {

207 *(
ebr
->
t·
.
pkf
[
i
]) = *(tft->pkf[i]);

208 
	gebr
->
	gt·
.
	gn_pkfs
 += 1;

213 i‡(
	gis_deÁu…
) {

215 
	gesm_˘x
->
	gpdn
[
pid
].
	gis_a˘ive
 = 
TRUE
;

217 i‡(
	gpdn
->
	gis_emîgícy
) {

218 
	gesm_˘x
->
	gemîgícy
 = 
TRUE
;

220 #ifde‡
NAS_UE


223 *
	gtmp
 = 
NULL
;

224 
	gùv4_addr
[
INET_ADDRSTRLEN
];

225 
	gùv6_addr
[
INET6_ADDRSTRLEN
];

226 *
	g√tmask
 = 
NULL
;

227 
	gbrﬂdˇ°
[
INET_ADDRSTRLEN
];

228 
ö_addr
 
	gö_addr
;

229 
	gcomm™d_löe
[128];

230 
	gªs
;

232 
	gpdn
->
	gty≥
) {

233 
	gNET_PDN_TYPE_IPV4V6
:

234 
ùv6_addr
[0] = 
pdn
->
ù_addr
[4];

236 
	gNET_PDN_TYPE_IPV4
:

237 
ö_addr
.
s_addr
 = 
pdn
->
ù_addr
[0] << 24;

238 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[1] << 16;

239 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[2] << 8;

240 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[3] ;

242 
	gtmp
 = 
öë_¡ﬂ
(
ö_addr
);

246 
°r˝y
(
ùv4_addr
, 
tmp
);

248 i‡(
IN_CLASSA
(
ö_addr
.
s_addr
)) {

249 
	g√tmask
 = "255.0.0.0";

250 
	gö_addr
.
	gs_addr
 = 
pdn
->
ù_addr
[0] << 24;

251 
	gö_addr
.
	gs_addr
 |= 255 << 16;

252 
	gö_addr
.
	gs_addr
 |= 255 << 8;

253 
	gö_addr
.
	gs_addr
 |= 255 ;

254 
	gtmp
 = 
öë_¡ﬂ
(
ö_addr
);

258 
°r˝y
(
brﬂdˇ°
, 
tmp
);

259 } i‡(
IN_CLASSB
(
ö_addr
.
s_addr
)) {

260 
	g√tmask
 = "255.255.0.0";

261 
	gö_addr
.
	gs_addr
 = 
pdn
->
ù_addr
[0] << 24;

262 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[1] << 16;

263 
	gö_addr
.
	gs_addr
 |= 255 << 8;

264 
	gö_addr
.
	gs_addr
 |= 255 ;

265 
	gtmp
 = 
öë_¡ﬂ
(
ö_addr
);

269 
°r˝y
(
brﬂdˇ°
, 
tmp
);

270 } i‡(
IN_CLASSC
(
ö_addr
.
s_addr
)) {

271 
	g√tmask
 = "255.255.255.0";

272 
	gö_addr
.
	gs_addr
 = 
pdn
->
ù_addr
[0] << 24;

273 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[1] << 16;

274 
	gö_addr
.
	gs_addr
 |
pdn
->
ù_addr
[2] << 8;

275 
	gö_addr
.
	gs_addr
 |= 255 ;

276 
	gtmp
 = 
öë_¡ﬂ
(
ö_addr
);

280 
°r˝y
(
brﬂdˇ°
, 
tmp
);

282 
	g√tmask
 = "255.255.255.255";

283 
°r˝y
(
brﬂdˇ°
, 
ùv4_addr
);

285 
	gªs
 = 
•rötf
(
comm™d_löe
,

287 
ùv4_addr
, 
√tmask
, 
brﬂdˇ°
);

290 
LOG_TRACE
(
INFO
, "ESM-PROC -Éxecuting %s ",

291 
comm™d_löe
);

292 
sy°em
(
comm™d_löe
);

294 
	gNET_PDN_TYPE_IPV6
:

306 
LOG_FUNC_RETURN
 (
pdn
->
bóªr
[0]->
ebi
);

308 
LOG_TRACE
(
WARNING
, "ESM-PROC - FailedÅo createÇew EPS bearer "

309 "c⁄ãxà”bi=%d)", 
ebi
);

312 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

336 
esm_ebr_c⁄ãxt_ªÀa£
(

337 #ifde‡
NAS_MME


338 
emm_d©a_c⁄ãxt_t
 *
˘x
,

340 
ebi
, *
pid
, *
bid
)

342 
	gfound
 = 
FALSE
;

343 
esm_pdn_t
 *
	gpdn
 = 
NULL
;

344 
esm_d©a_c⁄ãxt_t
 *
	gesm_˘x
;

346 
	gueid
 = 0;

348 
	gLOG_FUNC_IN
;

350 #ifde‡
NAS_UE


351 
	gesm_˘x
 = &
_esm_d©a
;

354 #ifde‡
NAS_MME


355 #i‡
deföed
(
EPC_BUILD
)

356 
	gesm_˘x
 = &
˘x
->
esm_d©a_˘x
;

358 i‡(
	gueid
 < 
	gESM_DATA_NB_UE_MAX
) {

359 
	g˘x
 = &
_esm_d©a
.
˘x
[
ueid
];

361 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

366 i‡(
	gebi
 !
ESM_EBI_UNASSIGNED
) {

374 *
pid
 = 0; *
	gpid
 < 
	gESM_DATA_PDN_MAX
; (*pid)++) {

375 i‡–!
	gesm_˘x
->
	gpdn
[*
pid
].
	gis_a˘ive
 ) {

379 i‡(
	gesm_˘x
->
	gpdn
[*
pid
].
	gd©a
 !
NULL
) {

380 
pdn
 = 
esm_˘x
->pdn[*
pid
].
d©a
;

382 *
	gbid
 = 0; *bid < 
	gpdn
->
	gn_bóªrs
; (*bid)++) {

383 i‡(
	gpdn
->
	gbóªr
[*
bid
] !
NULL
) {

384 i‡(
pdn
->
bóªr
[*
bid
]->
ebi
 !=Ébi) {

388 
	gfound
 = 
TRUE
;

393 i‡(
	gfound
) {

406 i‡(*
	gpid
 < 
	gESM_DATA_PDN_MAX
) {

407 i‡(*
	gpid
 !
esm_˘x
->
pdn
[*
pid
].pid) {

408 
LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier %d "

409 "i†nŸ vÆid", *
pid
);

410 } i‡(!
	gesm_˘x
->
	gpdn
[*
pid
].
	gis_a˘ive
) {

411 
LOG_TRACE
(
WARNING
,"ESM-PROC - PDN connection %d isÇotáctive",

412 *
pid
);

413 } i‡(
	gesm_˘x
->
	gpdn
[*
pid
].
	gd©a
 =
NULL
) {

414 
LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

415 "Æloˇãd", *
pid
);

417 
	gpdn
 = 
esm_˘x
->
pdn
[*
pid
].
d©a
;

418 i‡(
	gpdn
->
	gbóªr
[*
bid
] !
NULL
) {

419 
ebi
 = 
pdn
->
bóªr
[*
bid
]->ebi;

420 
	gfound
 = 
TRUE
;

426 i‡(
	gfound
) {

427 
	gi
, 
	gj
;

431 i‡(
	gpdn
->
	gbóªr
[*
bid
]->
	gbid
 != *bid) {

432 
LOG_TRACE
(
ERROR
, "ESM-PROC - EPS bearer identifier %d is "

433 "nŸ vÆid", *
bid
);

434 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

437 
LOG_TRACE
(
WARNING
, "ESM-PROC - Release EPS bearer context "

438 "”bi=%d)", 
ebi
);

441 
	gi
 = 0; i < 
	gpdn
->
	gbóªr
[*
bid
]->
	gt·
.
	gn_pkfs
; i++) {

442 
‰ì
(
pdn
->
bóªr
[*
bid
]->
t·
.
pkf
[
i
]);

445 
‰ì
(
pdn
->
bóªr
[*
bid
]);

446 
	gpdn
->
	gbóªr
[*
bid
] = 
NULL
;

449 
	gpdn
->
	gn_bóªrs
 -= 1;

451 
	gesm_˘x
->
	gn_ebrs
 -= 1;

453 i‡(*
	gbid
 == 0) {

459 
i
 = 1; 
	gpdn
->
	gn_bóªrs
 > 0; 
	gi
++) {

460 i‡(
	gpdn
->
	gbóªr
[
i
]) {

462 
LOG_TRACE
(
WARNING
, "ESM-PROC - Release EPS bearer context "

463 "”bi=%d)", 
pdn
->
bóªr
[
i
]->
ebi
);

466 
	gj
 = 0; j < 
	gpdn
->
	gbóªr
[
i
]->
	gt·
.
	gn_pkfs
; j++) {

467 
‰ì
(
pdn
->
bóªr
[
i
]->
t·
.
pkf
[
j
]);

470 #ifde‡
NAS_UE


471 (Ë
esm_ebr_£t_°©us
(
pdn
->
bóªr
[
i
]->
ebi
,

472 
ESM_EBR_INACTIVE
, 
TRUE
);

474 #ifde‡
NAS_MME


475 (Ë
esm_ebr_£t_°©us
(
˘x
, 
pdn
->
bóªr
[
i
]->
ebi
,

476 
ESM_EBR_INACTIVE
, 
TRUE
);

479 #ifde‡
NAS_UE


480 (Ë
esm_ebr_ªÀa£
(
pdn
->
bóªr
[
i
]->
ebi
);

482 #ifde‡
NAS_MME


483 (Ë
esm_ebr_ªÀa£
(
˘x
, 
pdn
->
bóªr
[
i
]->
ebi
);

487 
‰ì
(
pdn
->
bóªr
[
i
]);

488 
	gpdn
->
	gbóªr
[
i
] = 
NULL
;

491 
	gpdn
->
	gn_bóªrs
 -= 1;

493 
	gesm_˘x
->
	gn_ebrs
 -= 1;

497 
	gesm_˘x
->
	gpdn
[*
pid
].
	gis_a˘ive
 = 
FALSE
;

499 i‡(
	gpdn
->
	gis_emîgícy
) {

500 
	gesm_˘x
->
	gemîgícy
 = 
FALSE
;

504 #ifde‡
NAS_UE


509 i‡(
	gesm_˘x
->
	gn_ebrs
 == 0) {

510 
emm_ßp_t
 
emm_ßp
;

511 
	gemm_ßp
.
	g¥imôive
 = 
EMMESM_ESTABLISH_CNF
;

512 
	gemm_ßp
.
	gu
.
	gemm_esm
.u.
	ge°ablish
.
	gis_©èched
 = 
FALSE
;

513 (Ë
emm_ßp_£nd
(&
emm_ßp
);

521 i‡(
	gesm_˘x
->
	gemîgícy
 && (esm_˘x->
	gn_ebrs
 == 1) ) {

522 
emm_ßp_t
 
emm_ßp
;

523 
	gemm_ßp
.
	g¥imôive
 = 
EMMESM_ESTABLISH_CNF
;

524 
	gemm_ßp
.
	gu
.
	gemm_esm
.u.
	ge°ablish
.
	gis_©èched
 = 
TRUE
;

525 
	gemm_ßp
.
	gu
.
	gemm_esm
.u.
	ge°ablish
.
	gis_emîgícy
 = 
TRUE
;

526 (Ë
emm_ßp_£nd
(&
emm_ßp
);

529 #ifde‡
NAS_MME


530 i‡(
	gesm_˘x
->
	gn_ebrs
 == 0) {

536 
LOG_FUNC_RETURN
 (
ebi
);

539 
LOG_FUNC_RETURN
 (
ESM_EBI_UNASSIGNED
);

542 #ifde‡
NAS_UE


562 
	$esm_ebr_c⁄ãxt_gë_pid
(
ebi
)

564 
LOG_FUNC_IN
;

566 
pid
;

568 
pid
 = 0;Öid < 
ESM_DATA_PDN_MAX
;Öid++) {

569 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

572 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
bóªr
[0] =
NULL
) {

575 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
bóªr
[0]->
ebi
 ==Ébi) {

580 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

581 
	`LOG_FUNC_RETURN
 (
pid
);

583 
	`LOG_FUNC_RETURN
 (-1);

584 
	}
}

609 
	$esm_ebr_c⁄ãxt_check_t·
(
pid
, 
ebi
,

610 c⁄° 
√tw‹k_t·_t
 *
t·
,

611 
esm_ebr_c⁄ãxt_t·_t
 
›î©i⁄
)

613 
LOG_FUNC_IN
;

615 
rc
 = 
RETURNîr‹
;

616 
i
;

618 i‡(
pid
 < 
ESM_DATA_PDN_MAX
) {

619 i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

620 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection identifier %d "

621 "i†nŸ vÆid", 
pid
);

622 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

623 
	`LOG_TRACE
(
ERROR
, "ESM-PROC - PDN connection %d hasÇot been "

624 "Æloˇãd", 
pid
);

625 } i‡(
›î©i⁄
 =
ESM_EBR_CONTEXT_TFT_CREATE
) {

626 
esm_pdn_t
 *
pdn
 = 
_esm_d©a
.pdn[
pid
].
d©a
;

628 
i
 = 0; i < 
pdn
->
n_bóªrs
; i++) {

629 i‡(
pdn
->
bóªr
[
i
]) {

630 i‡(
pdn
->
bóªr
[
i
]->
ebi
 ==Ébi) {

632 
rc
 = 
	`_esm_ebr_c⁄ãxt_check_idítifõrs
(
t·
,

633 &
pdn
->
bóªr
[
i
]->
t·
);

634 i‡(
rc
 !
RETURNok
) {

639 
rc
 = 
	`_esm_ebr_c⁄ãxt_check_¥e˚dí˚
(
t·
,

640 &
pdn
->
bóªr
[
i
]->
t·
);

641 i‡(
rc
 !
RETURNok
) {

649 
	`LOG_FUNC_RETURN
 (
rc
);

650 
	}
}

657 #ifde‡
NAS_UE


677 
	$_esm_ebr_c⁄ãxt_check_idítifõrs
(c⁄° 
√tw‹k_t·_t
 *
t·1
,

678 c⁄° 
√tw‹k_t·_t
 *
t·2
)

680 
i
;

681 
j
;

683 i‡–(
t·1
 =
NULL
Ë|| (
t·2
 == NULL) ) {

684  (
RETURNok
);

686 
i
 = 0; i < 
t·1
->
n_pkfs
; i++) {

687 
j
 = 0; j < 
t·2
->
n_pkfs
; j++) {

689 i‡(
t·1
->
pkf
[
i
]->
id
 =
t·2
->pkf[i]->id) {

692  (
RETURNîr‹
);

696  (
RETURNok
);

697 
	}
}

717 
	$_esm_ebr_c⁄ãxt_check_¥e˚dí˚
(c⁄° 
√tw‹k_t·_t
 *
t·1
,

718 c⁄° 
√tw‹k_t·_t
 *
t·2
)

720 
i
;

721 
j
;

723 i‡–(
t·1
 =
NULL
Ë|| (
t·2
 == NULL) ) {

724  (
RETURNok
);

726 
i
 = 0; i < 
t·1
->
n_pkfs
; i++) {

727 
j
 = 0; j < 
t·2
->
n_pkfs
; j++) {

729 i‡(
t·1
->
pkf
[
i
]->
¥e˚dí˚
 =
t·2
->pkf[i]->precedence) {

735  (
RETURNîr‹
);

739  (
RETURNok
);

740 
	}
}

	@src/esm/esm_ebr_context.h

45 #i‚de‡
__ESM_EBR_CONTEXT_H__


46 
	#__ESM_EBR_CONTEXT_H__


	)

48 
	~"√tw‹kDef.h
"

58 #ifde‡
NAS_UE


61 
	mESM_EBR_CONTEXT_TFT_CREATE
,

62 
	mESM_EBR_CONTEXT_TFT_DELETE
,

63 
	mESM_EBR_CONTEXT_TFT_ADD_PACKET
,

64 
	mESM_EBR_CONTEXT_TFT_REPLACE_PACKET
,

65 
	mESM_EBR_CONTEXT_TFT_DELETE_PACKET
,

66 } 
	tesm_ebr_c⁄ãxt_t·_t
;

77 #ifde‡
NAS_UE


78 
esm_ebr_c⁄ãxt_¸óã
(
pid
, 
ebi
, 
is_deÁu…
,

79 c⁄° 
√tw‹k_qos_t
 *
qos
, c⁄° 
√tw‹k_t·_t
 *
t·
);

81 
esm_ebr_c⁄ãxt_ªÀa£
(
ebi
, *
pid
, *
bid
);

83 
esm_ebr_c⁄ãxt_gë_pid
(
ebi
);

85 
esm_ebr_c⁄ãxt_check_t·
(
pid
, 
ebi
, c⁄° 
√tw‹k_t·_t
 *
t·
,

86 
esm_ebr_c⁄ãxt_t·_t
 
›î©i⁄
);

89 #ifde‡
NAS_MME


90 
esm_ebr_c⁄ãxt_¸óã
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
, 
ebi
, 
is_deÁu…
,

91 c⁄° 
√tw‹k_qos_t
 *
qos
, c⁄° 
√tw‹k_t·_t
 *
t·
);

93 
esm_ebr_c⁄ãxt_ªÀa£
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, *
pid
, *
bid
);

	@src/esm/esm_ip.c

29 
	~"emmD©a.h
"

30 
	~"esmD©a.h
"

32 
	gù_addr_°r
[100];

34 
ölöe
 *
	$esm_d©a_gë_ùv4_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
)

36 i‡(
ù_addr
->
Àngth
 > 0) {

37 
	`•rötf
(
ù_addr_°r
, "%u.%u.%u.%u",

38 
ù_addr
->
vÆue
[0], ip_addr->value[1],

39 
ù_addr
->
vÆue
[2], ip_addr->value[3]);

40  
ù_addr_°r
;

42  (
NULL
);

43 
	}
}

45 
ölöe
 *
	$esm_d©a_gë_ùv6_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
)

47 i‡(
ù_addr
->
Àngth
 > 0) {

48 
	`•rötf
(
ù_addr_°r
, "%x%.2x:%x%.2x:%x%.2x:%x%.2x",

49 
ù_addr
->
vÆue
[0], ip_addr->value[1],

50 
ù_addr
->
vÆue
[2], ip_addr->value[3],

51 
ù_addr
->
vÆue
[4], ip_addr->value[5],

52 
ù_addr
->
vÆue
[6], ip_addr->value[7]);

53  
ù_addr_°r
;

55  (
NULL
);

56 
	}
}

58 
ölöe
 *
	$esm_d©a_gë_ùv4v6_addr
(c⁄° 
O˘ëSåög
 *
ù_addr
)

60 i‡(
ù_addr
->
Àngth
 > 0) {

61 
	`•rötf
(
ù_addr_°r
, "%u.%u.%u.%u / %x%.2x:%x%.2x:%x%.2x:%x%.2x",

62 
ù_addr
->
vÆue
[0], ip_addr->value[1],

63 
ù_addr
->
vÆue
[2], ip_addr->value[3],

64 
ù_addr
->
vÆue
[4], ip_addr->value[5],

65 
ù_addr
->
vÆue
[6], ip_addr->value[7],

66 
ù_addr
->
vÆue
[8], ip_addr->value[9],

67 
ù_addr
->
vÆue
[10], ip_addr->value[11]);

68  
ù_addr_°r
;

70  (
NULL
);

71 
	}
}

	@src/esm/esm_main.c

47 
	~"esm_maö.h
"

48 
	~"comm⁄Def.h
"

49 
	~"«s_log.h
"

51 
	~"emmD©a.h
"

52 
	~"esmD©a.h
"

53 
	~"esm_±.h
"

54 
	~"esm_ebr.h
"

68 #ifde‡
NAS_UE


83 
	$esm_maö_öôülize
(
esm_ödiˇti⁄_ˇŒback_t
 
cb
)

85 
LOG_FUNC_IN
;

87 
i
;

90 
_esm_d©a
.
n_ebrs
 = 0;

92 
_esm_d©a
.
n_pdns
 = 0;

93 
i
 = 0; i < 
ESM_DATA_PDN_MAX
 + 1; i++) {

94 
_esm_d©a
.
pdn
[
i
].
pid
 = -1;

95 
_esm_d©a
.
pdn
[
i
].
is_a˘ive
 = 
FALSE
;

96 
_esm_d©a
.
pdn
[
i
].
d©a
 = 
NULL
;

99 
_esm_d©a
.
emîgícy
 = 
FALSE
;

102 
	`esm_±_öôülize
();

105 
	`esm_ebr_öôülize
(
cb
);

107 
LOG_FUNC_OUT
;

108 
	}
}

110 #ifde‡
NAS_MME


125 
	$esm_maö_öôülize
()

127 
i
;

129 
LOG_FUNC_IN
;

132 i‡(
	`mme_≠i_gë_esm_c⁄fig
(&
_esm_d©a
.
c⁄f
Ë!
RETURNok
) {

133 
	`LOG_TRACE
(
ERROR
, "ESM-MAIN - FailedÅo get MME configuration data");

135 #i‡!
	`deföed
(
EPC_BUILD
)

137 
i
 = 0; i < 
ESM_DATA_NB_UE_MAX
; i++) {

138 
_esm_d©a
.
˘x
[
i
] = 
NULL
;

143 
	`esm_ebr_öôülize
();

145 
LOG_FUNC_OUT
;

146 
	}
}

163 
	$esm_maö_˛ónup
()

165 
LOG_FUNC_IN
;

167 #ifde‡
NAS_UE


169 
i
;

170 
pid
;

171 
bid
;

174 
pid
 = 0;Öid < 
ESM_DATA_PDN_MAX
;Öid++) {

175 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
) {

176 
esm_pdn_t
 *
pdn
 = 
_esm_d©a
.pdn[
pid
].
d©a
;

177 i‡(
pdn
->
≠n
.
Àngth
 > 0) {

178 
	`‰ì
(
pdn
->
≠n
.
vÆue
);

181 
bid
 = 0; bid < 
pdn
->
n_bóªrs
; bid++) {

182 i‡(
pdn
->
bóªr
[
bid
]) {

183 
	`LOG_TRACE
(
WARNING
, "ESM-MAIN - Release EPS bearer "

184 "c⁄ãxà”bi=%d)", 
pdn
->
bóªr
[
bid
]->
ebi
);

186 
i
 = 0; i < 
pdn
->
bóªr
[
bid
]->
t·
.
n_pkfs
; i++) {

187 i‡(
pdn
->
bóªr
[
bid
]->
t·
.
pkf
[
i
]) {

188 
	`‰ì
(
pdn
->
bóªr
[
bid
]->
t·
.
pkf
[
i
]);

191 
	`‰ì
(
pdn
->
bóªr
[
bid
]);

195 
	`‰ì
(
_esm_d©a
.
pdn
[
pid
].
d©a
);

201 
LOG_FUNC_OUT
;

202 
	}
}

204 #ifde‡
NAS_UE


221 
	$esm_maö_gë_nb_pdns_max
()

223 
LOG_FUNC_IN
;

225 
	`LOG_FUNC_RETURN
 (
ESM_DATA_PDN_MAX
);

226 
	}
}

242 
	$esm_maö_gë_nb_pdns
()

244 
LOG_FUNC_IN
;

246 
	`LOG_FUNC_RETURN
 (
_esm_d©a
.
n_pdns
);

247 
	}
}

265 
	$esm_maö_has_emîgícy
()

267 
LOG_FUNC_IN
;

269 
	`LOG_FUNC_RETURN
 (
_esm_d©a
.
emîgícy
);

270 
	}
}

290 
	$esm_maö_gë_pdn_°©us
(
cid
, *
°©e
)

292 
LOG_FUNC_IN
;

294 
pid
 = 
cid
 - 1;

296 i‡(
pid
 >
ESM_DATA_PDN_MAX
) {

297  (
FALSE
);

298 } i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

299 
	`LOG_TRACE
(
WARNING
, "ESM-MAIN - PDN c⁄√˘i⁄ %d i†nŸ deföed", 
cid
);

300  (
FALSE
);

301 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

302 
	`LOG_TRACE
(
ERROR
, "ESM-MAIN - PDN connection %d hasÇot beenállocated",

303 
cid
);

304  (
FALSE
);

307 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
bóªr
[0] !
NULL
) {

310 
ebi
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
bóªr
[0]->ebi;

311 *
°©e
 = (
	`esm_ebr_gë_°©us
(
ebi
Ë=
ESM_EBR_ACTIVE
);

314 
	`LOG_FUNC_RETURN
 (
TRUE
);

315 
	}
}

334 
	$esm_maö_gë_pdn
(
cid
, *
ty≥
, c⁄° **
≠n
,

335 *
is_emîgícy
, *
is_a˘ive
)

337 
LOG_FUNC_IN
;

339 
pid
 = 
cid
 - 1;

341 i‡(
pid
 >
ESM_DATA_PDN_MAX
) {

342  (
RETURNîr‹
);

343 } i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

344 
	`LOG_TRACE
(
WARNING
, "ESM-MAIN - PDN c⁄√˘i⁄ %d i†nŸ deföed", 
cid
);

345  (
RETURNîr‹
);

346 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

347 
	`LOG_TRACE
(
ERROR
, "ESM-MAIN - PDN connection %d hasÇot beenállocated",

348 
cid
);

349  (
RETURNîr‹
);

353 *
ty≥
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->type;

355 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
≠n
.
Àngth
 > 0) {

356 *
≠n
 = (*)(
_esm_d©a
.
pdn
[
pid
].
d©a
->≠n.
vÆue
);

358 *
≠n
 = 
NULL
;

361 *
is_emîgícy
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->is_emergency;

363 *
is_a˘ive
 = 
_esm_d©a
.
pdn
[
pid
].is_active;

365 
	`LOG_FUNC_RETURN
 (
RETURNok
);

366 
	}
}

384 
	$esm_maö_gë_pdn_addr
(
cid
, c⁄° **
ùv4addr
, c⁄° **
ùv6addr
)

386 
LOG_FUNC_IN
;

388 
pid
 = 
cid
 - 1;

390 i‡(
pid
 >
ESM_DATA_PDN_MAX
) {

391  (
RETURNîr‹
);

392 } i‡(
pid
 !
_esm_d©a
.
pdn
[pid].pid) {

393 
	`LOG_TRACE
(
WARNING
, "ESM-MAIN - PDN c⁄√˘i⁄ %d i†nŸ deföed", 
cid
);

394  (
RETURNîr‹
);

395 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
 =
NULL
) {

396 
	`LOG_TRACE
(
ERROR
, "ESM-MAIN - PDN connection %d hasÇot beenállocated",

397 
cid
);

398  (
RETURNîr‹
);

399 } i‡(!
_esm_d©a
.
pdn
[
pid
].
is_a˘ive
) {

401  (
RETURNok
);

404 i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 =
NET_PDN_TYPE_IPV4
) {

406 *
ùv4addr
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
ù_addr
;

407 } i‡(
_esm_d©a
.
pdn
[
pid
].
d©a
->
ty≥
 =
NET_PDN_TYPE_IPV6
) {

409 *
ùv6addr
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
ù_addr
;

412 *
ùv4addr
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
ù_addr
;

413 *
ùv6addr
 = 
_esm_d©a
.
pdn
[
pid
].
d©a
->
ù_addr
+
ESM_DATA_IPV4_ADDRESS_SIZE
;

416 
	`LOG_FUNC_RETURN
 (
RETURNok
);

417 
	}
}

	@src/esm/esm_main.h

47 #i‚de‡
__ESM_MAIN_H__


48 
	#__ESM_MAIN_H__


	)

50 
	~"√tw‹kDef.h
"

68 #ifde‡
NAS_UE


69 
esm_maö_öôülize
(
esm_ödiˇti⁄_ˇŒback_t
 
cb
);

71 #ifde‡
NAS_MME


72 
esm_maö_öôülize
();

74 
esm_maö_˛ónup
();

76 #ifde‡
NAS_UE


79 
esm_maö_gë_nb_pdns_max
();

80 
esm_maö_gë_nb_pdns
();

81 
esm_maö_has_emîgícy
();

82 
esm_maö_gë_pdn_°©us
(
cid
, *
°©e
);

83 
esm_maö_gë_pdn
(
cid
, *
ty≥
, c⁄° **
≠n
, *
is_emîgícy
,

84 *
is_a˘ive
);

85 
esm_maö_gë_pdn_addr
(
cid
, c⁄° **
ùv4addr
, c⁄° **
ùv6addr
);

	@src/esm/esm_proc.h

46 #i‚de‡
__ESM_PROC_H__


47 
	#__ESM_PROC_H__


	)

49 
	~"√tw‹kDef.h
"

50 
	~"O˘ëSåög.h
"

51 
	~"emmD©a.h
"

61 #ifde‡
NAS_UE


62 
	#T3482_DEFAULT_VALUE
 8

	)

63 
	#T3492_DEFAULT_VALUE
 6

	)

66 #ifde‡
NAS_MME


67 
	#T3485_DEFAULT_VALUE
 8

	)

68 
	#T3495_DEFAULT_VALUE
 8

	)

73 
	mESM_PDN_TYPE_IPV4
 = 
NET_PDN_TYPE_IPV4
,

74 
	mESM_PDN_TYPE_IPV6
 = 
NET_PDN_TYPE_IPV6
,

75 
	mESM_PDN_TYPE_IPV4V6
 = 
NET_PDN_TYPE_IPV4V6


76 } 
	tesm_¥oc_pdn_ty≥_t
;

80 
	mESM_PDN_REQUEST_INITIAL
 = 1,

81 
	mESM_PDN_REQUEST_HANDOVER
,

82 
	mESM_PDN_REQUEST_EMERGENCY


83 } 
	tesm_¥oc_pdn_ªque°_t
;

93 #ifde‡
NAS_UE


94 (*
	tesm_¥oc_¥o˚duª_t
Ë(, , 
	tO˘ëSåög
 *, );

96 #ifde‡
NAS_MME


97 (*
	tesm_¥oc_¥o˚duª_t
Ë(, 
	temm_d©a_c⁄ãxt_t
 *, , 
	tO˘ëSåög
 *, );

101 
√tw‹k_qos_t
 
	tesm_¥oc_qos_t
;

104 
√tw‹k_t·_t
 
	tesm_¥oc_t·_t
;

108 
O˘ëSåög
 
≠n
;

109 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
;

110 
O˘ëSåög
 
pdn_addr
;

111 
esm_¥oc_qos_t
 
qos
;

112 
esm_¥oc_t·_t
 
t·
;

113 } 
	tesm_¥oc_d©a_t
;

128 #ifde‡
NAS_UE


129 
	`esm_¥oc_°©us_öd
(
±i
, 
ebi
, *
esm_ˇu£
);

130 
	`esm_¥oc_°©us
(
is_°™dÆ⁄e
, 
±i
, 
O˘ëSåög
 *
msg
,

131 
£¡_by_ue
);

134 #ifde‡
NAS_MME


135 
	`esm_¥oc_°©us_öd
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
, *
esm_ˇu£
);

136 
	`esm_¥oc_°©us
(
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
,

137 
O˘ëSåög
 *
msg
, 
£¡_by_ue
);

146 #ifde‡
NAS_UE


147 
	`esm_¥oc_pdn_c⁄√˘ivôy
(
cid
, 
to_deföe
,

148 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
, c⁄° 
O˘ëSåög
 *
≠n
, 
is_emîgícy
,

149 *
±i
);

150 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(
is_°™dÆ⁄e
, 
±i
,

151 
O˘ëSåög
 *
msg
, 
£¡_by_ue
);

152 
	`esm_¥oc_pdn_c⁄√˘ivôy_ac˚±
(
±i
, 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
,

153 c⁄° 
O˘ëSåög
 *
pdn_addªss
, c⁄° O˘ëSåög *
≠n
, *
esm_ˇu£
);

154 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
(
±i
, *
esm_ˇu£
);

155 
	`esm_¥oc_pdn_c⁄√˘ivôy_com∂ëe
();

156 
	`esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
is_≥ndög
);

159 #ifde‡
NAS_MME


160 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
,

161 
esm_¥oc_pdn_ªque°_t
 
ªque°_ty≥
, 
O˘ëSåög
 *
≠n
,

162 
esm_¥oc_pdn_ty≥_t
 
pdn_ty≥
, 
O˘ëSåög
 *
pdn_addr
, 
esm_¥oc_qos_t
 *
esm_qos
,

163 *
esm_ˇu£
);

165 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
(
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

166 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

167 
	`esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
);

175 #ifde‡
NAS_UE


176 
	`esm_¥oc_pdn_disc⁄√˘
(
cid
, *
±i
, *
ebi
);

177 
	`esm_¥oc_pdn_disc⁄√˘_ªque°
(
is_°™dÆ⁄e
, 
±i
,

178 
O˘ëSåög
 *
msg
, 
£¡_by_ue
);

180 
	`esm_¥oc_pdn_disc⁄√˘_ac˚±
(
±i
, *
esm_ˇu£
);

181 
	`esm_¥oc_pdn_disc⁄√˘_ªje˘
(
±i
, *
esm_ˇu£
);

184 #ifde‡
NAS_MME


185 
	`esm_¥oc_pdn_disc⁄√˘_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, *
esm_ˇu£
);

187 
	`esm_¥oc_pdn_disc⁄√˘_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
, *
esm_ˇu£
);

188 
	`esm_¥oc_pdn_disc⁄√˘_ªje˘
(
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

189 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

197 #ifde‡
NAS_MME


198 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
,

199 *
ebi
, c⁄° 
esm_¥oc_qos_t
 *
esm_qos
, *
esm_ˇu£
);

200 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
is_°™dÆ⁄e
,

201 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

202 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
(
emm_d©a_c⁄ãxt_t
 *
˘x
);

204 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

205 *
esm_ˇu£
);

206 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

207 *
esm_ˇu£
);

210 #ifde‡
NAS_UE


211 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
pid
, 
ebi
,

212 c⁄° 
esm_¥oc_qos_t
 *
esm_qos
, *
esm_ˇu£
);

213 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_com∂ëe
();

214 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
();

216 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

217 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

218 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
is_°™dÆ⁄e
, 
ebi
,

219 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

227 #ifde‡
NAS_MME


228 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
pid
,

229 *
ebi
, *
deÁu…_ebi
, c⁄° 
esm_¥oc_qos_t
 *
qos
,

230 c⁄° 
esm_¥oc_t·_t
 *
t·
, *
esm_ˇu£
);

231 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
is_°™dÆ⁄e
,

232 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

234 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

235 *
esm_ˇu£
);

236 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

237 *
esm_ˇu£
);

240 #ifde‡
NAS_UE


241 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
ebi
, 
deÁu…_ebi
,

242 c⁄° 
esm_¥oc_qos_t
 *
qos
, c⁄° 
esm_¥oc_t·_t
 *
t·
, *
esm_ˇu£
);

244 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

245 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

246 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
is_°™dÆ⁄e
, 
ebi
,

247 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

255 #ifde‡
NAS_MME


256 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
is_loˇl
,

257 
ebi
, *
pid
, *
bid
,

258 *
esm_ˇu£
);

259 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
(
is_°™dÆ⁄e
,

260 
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
, 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

261 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
ebi
,

262 *
esm_ˇu£
);

265 #ifde‡
NAS_UE


266 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
is_loˇl
, 
ebi
, *
pid
,

267 *
bid
);

268 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
(
ebi
, *
esm_ˇu£
);

270 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
(
is_°™dÆ⁄e
, 
ebi
,

271 
O˘ëSåög
 *
msg
, 
ue_åiggîed
);

	@src/esm/esm_pt.c

46 
	~"esm_±.h
"

48 #ifde‡
NAS_UE


49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 
	~<°dlib.h
>

53 
	~<°rög.h
>

65 
	#ESM_PTI_MIN
 (
PROCEDURE_TRANSACTION_IDENTITY_FIRST
)

	)

66 
	#ESM_PTI_MAX
 (
PROCEDURE_TRANSACTION_IDENTITY_LAST
)

	)

72 #ifde‡
NAS_UE


74 c⁄° *
	g_esm_±_°©e_°r
[
ESM_PT_STATE_MAX
] = {

85 
	m±i
;

86 
esm_±_°©e
 
	m°©us
;

87 
«s_timî_t
 
	mtimî
;

88 
esm_±_timî_d©a_t
 *
	m¨gs
;

89 } 
	tesm_±_c⁄ãxt_t
;

97 
	mödex
;

99 
	#ESM_PT_DATA_SIZE
 (
ESM_PTI_MAX
 - 
ESM_PTI_MIN
 + 1)

	)

100 
esm_±_c⁄ãxt_t
 *
	mc⁄ãxt
[
ESM_PT_DATA_SIZE
 + 1];

101 } 
	g_esm_±_d©a
;

105 
_esm_±_gë_avaûabÀ_íåy
();

112 #ifde‡
NAS_UE


127 
	$esm_±_öôülize
()

129 
LOG_FUNC_IN
;

131 
i
;

133 
_esm_±_d©a
.
ödex
 = 0;

134 
i
 = 0; i < 
ESM_PT_DATA_SIZE
 + 1; i++) {

135 
_esm_±_d©a
.
c⁄ãxt
[
i
] = 
NULL
;

138 
LOG_FUNC_OUT
;

139 
	}
}

157 
	$esm_±_assign
()

159 
LOG_FUNC_IN
;

162 
i
 = 
	`_esm_±_gë_avaûabÀ_íåy
();

163 i‡(
i
 < 0) {

164 
	`LOG_FUNC_RETURN
 (
ESM_PT_UNASSIGNED
);

168 
_esm_±_d©a
.
c⁄ãxt
[
i
] =

169 (
esm_±_c⁄ãxt_t
 *)
	`mÆloc
((esm_pt_context_t));

170 i‡(
_esm_±_d©a
.
c⁄ãxt
[
i
] =
NULL
) {

171 
	`LOG_FUNC_RETURN
 (
ESM_PT_UNASSIGNED
);

175 
_esm_±_d©a
.
ödex
 = 
i
 + 1;

178 
_esm_±_d©a
.
c⁄ãxt
[
i
]->
±i
 = i + 
ESM_PTI_MIN
;

180 
_esm_±_d©a
.
c⁄ãxt
[
i
]->
°©us
 = 
ESM_PT_INACTIVE
;

182 
_esm_±_d©a
.
c⁄ãxt
[
i
]->
timî
.
id
 = 
NAS_TIMER_INACTIVE_ID
;

184 
_esm_±_d©a
.
c⁄ãxt
[
i
]->
¨gs
 = 
NULL
;

186 
	`LOG_TRACE
(
INFO
, "ESM-FSM - ProcedureÅransaction identity %dássigned",

187 
_esm_±_d©a
.
c⁄ãxt
[
i
]->
±i
);

188 
	`LOG_FUNC_RETURN
 (
_esm_±_d©a
.
c⁄ãxt
[
i
]->
±i
);

189 
	}
}

208 
	$esm_±_ªÀa£
(
±i
)

210 
LOG_FUNC_IN
;

212 i‡–(
±i
 < 
ESM_PTI_MIN
Ë|| (±ò> 
ESM_PTI_MAX
) ) {

213 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

217 
esm_±_c⁄ãxt_t
 *
˘x
 = 
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
];

218 i‡–(
˘x
 =
NULL
Ë|| (˘x->
±i
 !=Öti) ) {

220 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

223 i‡(
˘x
->
°©us
 !
ESM_PT_INACTIVE
) {

224 
	`LOG_TRACE
(
ERROR
, "ESM-FSM - ProcedureÅransaction isÇot INACTIVE");

225 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

229 i‡(
˘x
->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

230 
	`LOG_TRACE
(
INFO
, "ESM-FSM - StopÑetransmissionÅimer %d",

231 
˘x
->
timî
.
id
);

232 
˘x
->
timî
.
id
 = 
	`«s_timî_°›
(ctx->timer.id);

235 i‡(
˘x
->
¨gs
) {

236 i‡(
˘x
->
¨gs
->
msg
.
Àngth
 > 0) {

237 
	`‰ì
(
˘x
->
¨gs
->
msg
.
vÆue
);

239 
	`‰ì
(
˘x
->
¨gs
);

240 
˘x
->
¨gs
 = 
NULL
;

244 
	`‰ì
(
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
]);

245 
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
] = 
NULL
;

247 
	`LOG_TRACE
(
INFO
, "ESM-FSM - Pro˚duªÅønß˘i⁄ %dÑñó£d", 
±i
);

249 
	`LOG_FUNC_RETURN
 (
RETURNok
);

250 
	}
}

272 
	$esm_±_°¨t_timî
(
±i
, c⁄° 
O˘ëSåög
 *
msg
,

273 
£c
, 
«s_timî_ˇŒback_t
 
cb
)

275 
LOG_FUNC_IN
;

277 i‡–(
±i
 < 
ESM_PTI_MIN
Ë|| (±ò> 
ESM_PTI_MAX
) ) {

278 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

282 
esm_±_c⁄ãxt_t
 *
˘x
 = 
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
];

283 i‡–(
˘x
 =
NULL
Ë|| (˘x->
±i
 !=Öti) ) {

285 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

288 i‡(
˘x
->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

289 i‡(
˘x
->
¨gs
) {

291 
˘x
->
timî
.
id
 = 
	`«s_timî_ª°¨t
(ctx->timer.id);

295 
˘x
->
¨gs
 = (
esm_±_timî_d©a_t
 *)
	`mÆloc
((esm_pt_timer_data_t));

296 i‡(
˘x
->
¨gs
) {

298 
˘x
->
¨gs
->
±i
 =Öti;

300 
˘x
->
¨gs
->
cou¡
 = 0;

302 
˘x
->
¨gs
->
msg
.
vÆue
 = (
uöt8_t
 *)
	`mÆloc
(msg->
Àngth
);

303 
˘x
->
¨gs
->
msg
.
Àngth
 = 0;

304 i‡(
˘x
->
¨gs
->
msg
.
vÆue
) {

305 
	`mem˝y
(
˘x
->
¨gs
->
msg
.
vÆue
, msg->vÆue, msg->
Àngth
);

306 
˘x
->
¨gs
->
msg
.
Àngth
 = msg->length;

310 
˘x
->
timî
.
id
 = 
	`«s_timî_°¨t
(
£c
, 
cb
, ctx->
¨gs
);

311 
˘x
->
timî
.
£c
 = sec;

315 i‡–(
˘x
->
¨gs
 !
NULL
Ë&& (˘x->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) ) {

316 
	`LOG_TRACE
(
INFO
, "ESM-FSM - RetransmissionÅimer %dÉxpires in "

317 "%ld sec⁄ds", 
˘x
->
timî
.
id
, ctx->timî.
£c
);

318 
	`LOG_FUNC_RETURN
 (
RETURNok
);

320 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

321 
	}
}

338 
	$esm_±_°›_timî
(
±i
)

340 
LOG_FUNC_IN
;

342 i‡–(
±i
 < 
ESM_PTI_MIN
Ë|| (±ò> 
ESM_PTI_MAX
) ) {

343 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

347 
esm_±_c⁄ãxt_t
 *
˘x
 = 
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
];

348 i‡–(
˘x
 =
NULL
Ë|| (˘x->
±i
 !=Öti) ) {

350 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

354 i‡(
˘x
->
timî
.
id
 !
NAS_TIMER_INACTIVE_ID
) {

355 
	`LOG_TRACE
(
INFO
, "ESM-FSM - StopÑetransmissionÅimer %d",

356 
˘x
->
timî
.
id
);

357 
˘x
->
timî
.
id
 = 
	`«s_timî_°›
(ctx->timer.id);

361 i‡(
˘x
->
¨gs
) {

362 i‡(
˘x
->
¨gs
->
msg
.
Àngth
 > 0) {

363 
	`‰ì
(
˘x
->
¨gs
->
msg
.
vÆue
);

365 
	`‰ì
(
˘x
->
¨gs
);

366 
˘x
->
¨gs
 = 
NULL
;

369 
	`LOG_FUNC_RETURN
 (
RETURNok
);

370 
	}
}

388 
	$esm_±_£t_°©us
(
±i
, 
esm_±_°©e
 
°©us
)

390 
LOG_FUNC_IN
;

392 
esm_±_°©e
 
ﬁd_°©us
;

394 i‡–(
±i
 < 
ESM_PTI_MIN
Ë|| (±ò> 
ESM_PTI_MAX
) ) {

395 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

399 
esm_±_c⁄ãxt_t
 *
˘x
 = 
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
];

400 i‡–(
˘x
 =
NULL
Ë|| (˘x->
±i
 !=Öti) ) {

402 
	`LOG_TRACE
(
ERROR
, "ESM-FSM - ProcedureÅransactionÇotássigned "

403 "’ti=%d)", 
±i
);

404 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

407 
ﬁd_°©us
 = 
˘x
->
°©us
;

408 i‡(
°©us
 < 
ESM_PT_STATE_MAX
) {

409 
	`LOG_TRACE
(
INFO
, "ESM-FSM - Status ofÖrocedureÅransaction %d changed:"

410 " %†===> %s", 
±i
,

411 
_esm_±_°©e_°r
[
ﬁd_°©us
], _esm_±_°©e_°r[
°©us
]);

412 i‡(
°©us
 !
ﬁd_°©us
) {

413 
˘x
->
°©us
 = status;

414 
	`LOG_FUNC_RETURN
 (
RETURNok
);

418 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

419 
	}
}

437 
esm_±_°©e
 
	$esm_±_gë_°©us
(
±i
)

439 i‡–(
±i
 < 
ESM_PTI_MIN
Ë|| (±ò> 
ESM_PTI_MAX
) ) {

440  (
ESM_PT_INACTIVE
);

442 i‡(
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
] =
NULL
) {

444  (
ESM_PT_INACTIVE
);

446 i‡(
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
]->pti !=Öti) {

448  (
ESM_PT_INACTIVE
);

450  (
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
]->
°©us
);

451 
	}
}

471 
	$esm_±_gë_≥ndög_±i
(
esm_±_°©e
 
°©us
)

473 
LOG_FUNC_IN
;

475 
i
;

476 
i
 = 0; i < 
ESM_PT_DATA_SIZE
; i++) {

477 i‡(
_esm_±_d©a
.
c⁄ãxt
[
i
] =
NULL
) {

480 i‡(
_esm_±_d©a
.
c⁄ãxt
[
i
]->
°©us
 != status) {

487 i‡(
i
 < 
ESM_PT_DATA_SIZE
) {

488 
	`LOG_FUNC_RETURN
 (
_esm_±_d©a
.
c⁄ãxt
[
i
]->
±i
);

491 
	`LOG_FUNC_RETURN
 (
ESM_PT_UNASSIGNED
);

492 
	}
}

509 
	$esm_±_is_nŸ_ö_u£
(
±i
)

511  ( (
±i
 =
ESM_PT_UNASSIGNED
) ||

512 (
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
] =
NULL
) ||

513 (
_esm_±_d©a
.
c⁄ãxt
[
±i
 - 
ESM_PTI_MIN
]->pti) !=Öti);

514 
	}
}

532 
	$esm_±_is_ª£rved
(
±i
)

534  ( (
±i
 !
ESM_PT_UNASSIGNED
Ë&& (±ò> 
ESM_PTI_MAX
) );

535 
	}
}

541 #ifde‡
NAS_UE


559 
	$_esm_±_gë_avaûabÀ_íåy
()

561 
i
;

562 
i
 = 
_esm_±_d©a
.
ödex
; i < 
ESM_PT_DATA_SIZE
; i++) {

563 i‡(
_esm_±_d©a
.
c⁄ãxt
[
i
] !
NULL
) {

566  
i
;

568 
i
 = 0; i < 
_esm_±_d©a
.
ödex
; i++) {

569 i‡(
_esm_±_d©a
.
c⁄ãxt
[
i
] !
NULL
) {

572  
i
;

576 
	}
}

	@src/esm/esm_pt.h

45 #i‚de‡
__ESM_PT_H__


46 
	#__ESM_PT_H__


	)

48 #ifde‡
NAS_UE


49 
	~"O˘ëSåög.h
"

50 
	~"«s_timî.h
"

53 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

60 
	#ESM_PT_UNASSIGNED
 (
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
)

	)

66 #ifde‡
NAS_UE


69 
	mESM_PT_INACTIVE
,

70 
	mESM_PT_PENDING
,

72 
	mESM_PT_STATE_MAX


73 } 
	tesm_±_°©e
;

77 
	m±i
;

78 
	mcou¡
;

79 
O˘ëSåög
 
	mmsg
;

80 } 
	tesm_±_timî_d©a_t
;

91 
esm_±_is_ª£rved
(
±i
);

93 #ifde‡
NAS_UE


94 
esm_±_öôülize
();

96 
esm_±_assign
();

97 
esm_±_ªÀa£
(
±i
);

99 
esm_±_°¨t_timî
(
±i
, c⁄° 
O˘ëSåög
 *
msg
, 
£c
,

100 
«s_timî_ˇŒback_t
 
cb
);

101 
esm_±_°›_timî
(
±i
);

103 
esm_±_£t_°©us
(
±i
, 
esm_±_°©e
 
°©us
);

104 
esm_±_°©e
 
esm_±_gë_°©us
(
±i
);

105 
esm_±_gë_≥ndög_±i
(
esm_±_°©e
 
°©us
);

107 
esm_±_is_nŸ_ö_u£
(
±i
);

	@src/esm/msg/ActivateDedicatedEpsBearerContextAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtAc˚±.h
"

39 
	$decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

60 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

61 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

68 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

69  
TLV_DECODE_UNEXPECTED_IEI
;

72  
decoded
;

73 
	}
}

75 
	$ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

77 
ícoded
 = 0;

78 
ícode_ªsu…
 = 0;

81 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

83 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

84 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

86 i‡((
ícode_ªsu…
 =

87 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

88 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

96  
ícoded
;

97 
	}
}

	@src/esm/msg/ActivateDedicatedEpsBearerContextAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

39 #i‚de‡
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_H_


40 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_H_


	)

43 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
 (0)

	)

46 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_MAXIMUM_LENGTH
 ( \

47 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

52 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

54 
	ea˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_õi_èg
 {

55 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

56 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_õi
;

65 
	sa˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg_èg
 {

67 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

68 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

69 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

70 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
uöt32_t
 
	m¥e£n˚mask
;

73 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

74 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
;

76 
decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

78 
ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ActivateDedicatedEpsBearerContextReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReje˘.h
"

39 
	$decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
,

90 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/ActivateDedicatedEpsBearerContextReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_H_


41 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_H_


	)

44 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	ea˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_õi_èg
 {

58 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_õi
;

68 
	sa˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
;

80 
decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ActivateDedicatedEpsBearerContextRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReque°.h
"

39 
	$decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_löked_ïs_bóªr_idítôy
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
lökedïsbóªridítôy
, 0, *(
buf„r
 + 
decoded
), 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52 i‡((
decoded_ªsu…
 = 
	`decode_ïs_quÆôy_of_£rvi˚
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
ïsqos
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

53  
decoded_ªsu…
;

55 
decoded
 +
decoded_ªsu…
;

57 i‡((
decoded_ªsu…
 = 
	`decode_åaffic_Êow_ãm∂©e
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
t·
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

58  
decoded_ªsu…
;

60 
decoded
 +
decoded_ªsu…
;

63 
Àn
 - 
decoded
 > 0)

65 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

67 i‡(
õiDecoded
 >= 0x80)

68 
õiDecoded
 = ieiDecoded & 0xf0;

69 
õiDecoded
)

71 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
:

72 i‡((
decoded_ªsu…
 =

73 
	`decode_å™ß˘i⁄_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
å™ß˘i⁄idítifõr
,

74 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
,

75 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

76  
decoded_ªsu…
;

77 
decoded
 +
decoded_ªsu…
;

79 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
;

81 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
:

82 i‡((
decoded_ªsu…
 =

83 
	`decode_quÆôy_of_£rvi˚
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdqos
,

84 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
,

85 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

86  
decoded_ªsu…
;

87 
decoded
 +
decoded_ªsu…
;

89 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
;

91 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
:

92 i‡((
decoded_ªsu…
 =

93 
	`decode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

94 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
,

95 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

96  
decoded_ªsu…
;

97 
decoded
 +
decoded_ªsu…
;

99 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
;

101 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
:

102 i‡((
decoded_ªsu…
 =

103 
	`decode_ødio_¥i‹ôy
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

104 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
,

105 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

106  
decoded_ªsu…
;

107 
decoded
 +
decoded_ªsu…
;

109 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
;

111 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
:

112 i‡((
decoded_ªsu…
 =

113 
	`decode_∑ckë_Êow_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

114 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

115 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

116  
decoded_ªsu…
;

117 
decoded
 +
decoded_ªsu…
;

119 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
;

121 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

122 i‡((
decoded_ªsu…
 =

123 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

124 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

125 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

126  
decoded_ªsu…
;

127 
decoded
 +
decoded_ªsu…
;

129 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

132 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

133  
TLV_DECODE_UNEXPECTED_IEI
;

136  
decoded
;

137 
	}
}

139 
	$ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

141 
ícoded
 = 0;

142 
ícode_ªsu…
 = 0;

145 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

147 *(
buf„r
 + 
ícoded
Ë
	`ícode_u8_löked_ïs_bóªr_idítôy
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
lökedïsbóªridítôy
) & 0x0f;

148 
ícoded
++;

149 i‡((
ícode_ªsu…
 =

150 
	`ícode_ïs_quÆôy_of_£rvi˚
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
ïsqos
,

151 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

152  
ícode_ªsu…
;

154 
ícoded
 +
ícode_ªsu…
;

156 i‡((
ícode_ªsu…
 =

157 
	`ícode_åaffic_Êow_ãm∂©e
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
t·
,

158 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

159  
ícode_ªsu…
;

161 
ícoded
 +
ícode_ªsu…
;

163 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
)

164 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
)

166 i‡((
ícode_ªsu…
 =

167 
	`ícode_å™ß˘i⁄_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
å™ß˘i⁄idítifõr
,

168 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
,

169 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

171  
ícode_ªsu…
;

173 
ícoded
 +
ícode_ªsu…
;

176 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
)

177 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
)

179 i‡((
ícode_ªsu…
 =

180 
	`ícode_quÆôy_of_£rvi˚
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdqos
,

181 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
,

182 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

184  
ícode_ªsu…
;

186 
ícoded
 +
ícode_ªsu…
;

189 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

190 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

192 i‡((
ícode_ªsu…
 =

193 
	`ícode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

194 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
,

195 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

197  
ícode_ªsu…
;

199 
ícoded
 +
ícode_ªsu…
;

202 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

203 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

205 i‡((
ícode_ªsu…
 =

206 
	`ícode_ødio_¥i‹ôy
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

207 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
,

208 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

210  
ícode_ªsu…
;

212 
ícoded
 +
ícode_ªsu…
;

215 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

216 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

218 i‡((
ícode_ªsu…
 =

219 
	`ícode_∑ckë_Êow_idítifõr
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

220 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

221 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

223  
ícode_ªsu…
;

225 
ícoded
 +
ícode_ªsu…
;

228 i‡((
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

229 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

231 i‡((
ícode_ªsu…
 =

232 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

233 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

234 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

236  
ícode_ªsu…
;

238 
ícoded
 +
ícode_ªsu…
;

241  
ícoded
;

242 
	}
}

	@src/esm/msg/ActivateDedicatedEpsBearerContextRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"LökedEpsBóªrIdítôy.h
"

38 
	~"EpsQuÆôyOfSîvi˚.h
"

39 
	~"TøfficFlowTem∂©e.h
"

40 
	~"Tønß˘i⁄Idítifõr.h
"

41 
	~"QuÆôyOfSîvi˚.h
"

42 
	~"LlcSîvi˚Ac˚ssPoötIdítifõr.h
"

43 
	~"RadioPri‹ôy.h
"

44 
	~"PackëFlowIdítifõr.h
"

45 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

47 #i‚de‡
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_H_


48 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_H_


	)

51 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
 ( \

52 
EPS_QUALITY_OF_SERVICE_MINIMUM_LENGTH
 + \

53 
TRAFFIC_FLOW_TEMPLATE_MINIMUM_LENGTH
 )

	)

56 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_MAXIMUM_LENGTH
 ( \

57 
EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

58 
TRAFFIC_FLOW_TEMPLATE_MAXIMUM_LENGTH
 + \

59 
TRANSACTION_IDENTIFIER_MAXIMUM_LENGTH
 + \

60 
QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

61 
LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MAXIMUM_LENGTH
 + \

62 
RADIO_PRIORITY_MAXIMUM_LENGTH
 + \

63 
PACKET_FLOW_IDENTIFIER_MAXIMUM_LENGTH
 + \

64 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
)

	)

69 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
 (1<<0)

	)

70 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
 (1<<1)

	)

71 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
 (1<<2)

	)

72 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
 (1<<3)

	)

73 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
 (1<<4)

	)

74 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<5)

	)

76 
	ea˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_õi_èg
 {

77 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
 = 0x5D,

78 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
 = 0x30,

79 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
 = 0x32,

80 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
 = 0x80,

81 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
 = 0x34,

82 
	mACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

83 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_õi
;

92 
	sa˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg_èg
 {

94 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

95 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

96 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

97 
MesßgeTy≥
 
	mmesßgëy≥
;

98 
LökedEpsBóªrIdítôy
 
	mlökedïsbóªridítôy
;

99 
EpsQuÆôyOfSîvi˚
 
	mïsqos
;

100 
TøfficFlowTem∂©e
 
	mt·
;

102 
uöt32_t
 
	m¥e£n˚mask
;

103 
Tønß˘i⁄Idítifõr
 
	må™ß˘i⁄idítifõr
;

104 
QuÆôyOfSîvi˚
 
	m√gŸüãdqos
;

105 
LlcSîvi˚Ac˚ssPoötIdítifõr
 
	m√gŸüãdŒcßpi
;

106 
RadioPri‹ôy
 
	mødi›ri‹ôy
;

107 
PackëFlowIdítifõr
 
	m∑ckëÊowidítifõr
;

108 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

109 } 
	ta˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
;

111 
decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

113 
ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©edediˇãdïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ActivateDefaultEpsBearerContextAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtAc˚±.h
"

39 
	$decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

60 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

61 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

68 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

69  
TLV_DECODE_UNEXPECTED_IEI
;

72  
decoded
;

73 
	}
}

75 
	$ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

77 
ícoded
 = 0;

78 
ícode_ªsu…
 = 0;

81 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

83 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

84 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

86 i‡((
ícode_ªsu…
 =

87 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

88 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

96  
ícoded
;

97 
	}
}

	@src/esm/msg/ActivateDefaultEpsBearerContextAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

39 #i‚de‡
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_H_


40 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_H_


	)

43 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
 (0)

	)

46 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_MAXIMUM_LENGTH
 ( \

47 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

52 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

54 
	ea˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_õi_èg
 {

55 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

56 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_õi
;

65 
	sa˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg_èg
 {

67 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

68 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

69 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

70 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
uöt32_t
 
	m¥e£n˚mask
;

73 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

74 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
;

76 
decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

78 
ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ActivateDefaultEpsBearerContextReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReje˘.h
"

39 
	$decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
,

90 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/ActivateDefaultEpsBearerContextReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_H_


41 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_H_


	)

44 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	ea˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_õi_èg
 {

58 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_õi
;

68 
	sa˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
;

80 
decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ActivateDefaultEpsBearerContextRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReque°.h
"

39 
	$decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_ïs_quÆôy_of_£rvi˚
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ïsqos
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53 i‡((
decoded_ªsu…
 = 
	`decode_ac˚ss_poöt_«me
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ac˚s•oöäame
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

54  
decoded_ªsu…
;

56 
decoded
 +
decoded_ªsu…
;

58 i‡((
decoded_ªsu…
 = 
	`decode_pdn_addªss
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
pd«ddªss
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

59  
decoded_ªsu…
;

61 
decoded
 +
decoded_ªsu…
;

64 
Àn
 - 
decoded
 > 0)

66 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

68 i‡(
õiDecoded
 >= 0x80)

69 
õiDecoded
 = ieiDecoded & 0xf0;

70 
õiDecoded
)

72 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
:

73 i‡((
decoded_ªsu…
 =

74 
	`decode_å™ß˘i⁄_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
å™ß˘i⁄idítifõr
,

75 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
,

76 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

77  
decoded_ªsu…
;

78 
decoded
 +
decoded_ªsu…
;

80 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
;

82 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
:

83 i‡((
decoded_ªsu…
 =

84 
	`decode_quÆôy_of_£rvi˚
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdqos
,

85 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
,

86 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

87  
decoded_ªsu…
;

88 
decoded
 +
decoded_ªsu…
;

90 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
;

92 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
:

93 i‡((
decoded_ªsu…
 =

94 
	`decode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

95 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
,

96 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

97  
decoded_ªsu…
;

98 
decoded
 +
decoded_ªsu…
;

100 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
;

102 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
:

103 i‡((
decoded_ªsu…
 =

104 
	`decode_ødio_¥i‹ôy
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

105 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
,

106 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

107  
decoded_ªsu…
;

108 
decoded
 +
decoded_ªsu…
;

110 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
;

112 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
:

113 i‡((
decoded_ªsu…
 =

114 
	`decode_∑ckë_Êow_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

115 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

116 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

117  
decoded_ªsu…
;

118 
decoded
 +
decoded_ªsu…
;

120 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
;

122 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
:

123 i‡((
decoded_ªsu…
 =

124 
	`decode_≠n_aggªg©e_maximum_bô_øã
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
≠«mbr
,

125 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
,

126 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

127  
decoded_ªsu…
;

128 
decoded
 +
decoded_ªsu…
;

130 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
;

132 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_IEI
:

133 i‡((
decoded_ªsu…
 =

134 
	`decode_esm_ˇu£
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
esmˇu£
,

135 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_IEI
,

136 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

137  
decoded_ªsu…
;

138 
decoded
 +
decoded_ªsu…
;

140 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
;

142 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

143 i‡((
decoded_ªsu…
 =

144 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

145 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

146 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

147  
decoded_ªsu…
;

148 
decoded
 +
decoded_ªsu…
;

150 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

153 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

154  
TLV_DECODE_UNEXPECTED_IEI
;

157  
decoded
;

158 
	}
}

160 
	$ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

162 
ícoded
 = 0;

163 
ícode_ªsu…
 = 0;

166 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

168 i‡((
ícode_ªsu…
 =

169 
	`ícode_ïs_quÆôy_of_£rvi˚
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ïsqos
,

170 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

171 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÉpsqos");

172  
ícode_ªsu…
;

174 
ícoded
 +
ícode_ªsu…
;

176 i‡((
ícode_ªsu…
 =

177 
	`ícode_ac˚ss_poöt_«me
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ac˚s•oöäame
,

178 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

179 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEáccesspointname");

180  
ícode_ªsu…
;

182 
ícoded
 +
ícode_ªsu…
;

184 i‡((
ícode_ªsu…
 =

185 
	`ícode_pdn_addªss
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
pd«ddªss
,

186 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

187 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÖdnaddress");

188  
ícode_ªsu…
;

190 
ícoded
 +
ícode_ªsu…
;

192 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
)

193 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
)

195 i‡((
ícode_ªsu…
 =

196 
	`ícode_å™ß˘i⁄_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
å™ß˘i⁄idítifõr
,

197 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
,

198 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

199 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÅransactionidentifier");

201  
ícode_ªsu…
;

203 
ícoded
 +
ícode_ªsu…
;

206 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
)

207 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
)

209 i‡((
ícode_ªsu…
 =

210 
	`ícode_quÆôy_of_£rvi˚
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdqos
,

211 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
,

212 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

213 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÇegotiatedqos");

215  
ícode_ªsu…
;

217 
ícoded
 +
ícode_ªsu…
;

220 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

221 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

223 i‡((
ícode_ªsu…
 =

224 
	`ícode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

225 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
,

226 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

227 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÇegotiatedllcsapi");

229  
ícode_ªsu…
;

231 
ícoded
 +
ícode_ªsu…
;

234 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

235 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

237 i‡((
ícode_ªsu…
 =

238 
	`ícode_ødio_¥i‹ôy
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

239 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
,

240 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

241 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÑadiopriority");

243  
ícode_ªsu…
;

245 
ícoded
 +
ícode_ªsu…
;

248 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

249 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

251 i‡((
ícode_ªsu…
 =

252 
	`ícode_∑ckë_Êow_idítifõr
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

253 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

254 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

255 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÖacketflowidentifier");

257  
ícode_ªsu…
;

259 
ícoded
 +
ícode_ªsu…
;

262 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
)

263 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
)

265 i‡((
ícode_ªsu…
 =

266 
	`ícode_≠n_aggªg©e_maximum_bô_øã
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
≠«mbr
,

267 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
, 
buf„r
 +

268 
ícoded
, 
Àn
 -Éncoded)) < 0) {

269 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEápnambr");

271  
ícode_ªsu…
;

273 
ícoded
 +
ícode_ªsu…
;

276 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
)

277 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
)

279 i‡((
ícode_ªsu…
 =

280 
	`ícode_esm_ˇu£
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
esmˇu£
,

281 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_IEI
, 
buf„r


282 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

283 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÉsmcause");

285  
ícode_ªsu…
;

287 
ícoded
 +
ícode_ªsu…
;

292 
	#CONFIGURATION_PROTOCOL_PPP
 0

	)

294 
	#PROTOCOL_ID_IPCP
 0x8021

	)

295 
	#PROTOCOL_ID_DNS_SERVER_IPV4_ADDRESS
 0x000D

	)

298 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

300 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
.
c⁄figuøti⁄¥Ÿﬁ
 = 
CONFIGURATION_PROTOCOL_PPP
;

301 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
.
¥Ÿocﬁid
 = 
PROTOCOL_ID_IPCP
;

302 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
.
ÀngthoÂrŸocﬁid
 = 16;

303 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
.
¥Ÿocﬁidc⁄ã¡s
.
vÆue
 = (
uöt8_t
 *)

311 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
.
¥Ÿocﬁidc⁄ã¡s
.
Àngth
 = 16;

315 i‡((
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

316 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

318 i‡((
ícode_ªsu…
 =

319 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

320 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

321 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

322 
	`LOG_TRACE
(
ERROR
, "ESM ENCODEÖrotocolconfigurationoptions");

324  
ícode_ªsu…
;

326 
ícoded
 +
ícode_ªsu…
;

328 
	`LOG_TRACE
(
INFO
, "ESM ENCODEDáctivate_default_eps_bearer_context_request");

329  
ícoded
;

330 
	}
}

	@src/esm/msg/ActivateDefaultEpsBearerContextRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EpsQuÆôyOfSîvi˚.h
"

38 
	~"Ac˚ssPoötName.h
"

39 
	~"PdnAddªss.h
"

40 
	~"Tønß˘i⁄Idítifõr.h
"

41 
	~"QuÆôyOfSîvi˚.h
"

42 
	~"LlcSîvi˚Ac˚ssPoötIdítifõr.h
"

43 
	~"RadioPri‹ôy.h
"

44 
	~"PackëFlowIdítifõr.h
"

45 
	~"A≤Aggªg©eMaximumBôR©e.h
"

46 
	~"EsmCau£.h
"

47 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

49 #i‚de‡
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_H_


50 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_H_


	)

53 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
 ( \

54 
EPS_QUALITY_OF_SERVICE_MINIMUM_LENGTH
 + \

55 
ACCESS_POINT_NAME_MINIMUM_LENGTH
 + \

56 
PDN_ADDRESS_MINIMUM_LENGTH
 )

	)

59 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_MAXIMUM_LENGTH
 ( \

60 
EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

61 
ACCESS_POINT_NAME_MAXIMUM_LENGTH
 + \

62 
PDN_ADDRESS_MAXIMUM_LENGTH
 + \

63 
TRANSACTION_IDENTIFIER_MAXIMUM_LENGTH
 + \

64 
QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

65 
LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MAXIMUM_LENGTH
 + \

66 
RADIO_PRIORITY_MAXIMUM_LENGTH
 + \

67 
PACKET_FLOW_IDENTIFIER_MAXIMUM_LENGTH
 + \

68 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_LENGTH
 + \

69 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

70 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

75 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_PRESENT
 (1<<0)

	)

76 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_PRESENT
 (1<<1)

	)

77 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
 (1<<2)

	)

78 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
 (1<<3)

	)

79 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
 (1<<4)

	)

80 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
 (1<<5)

	)

81 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
 (1<<6)

	)

82 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<7)

	)

84 
	ea˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_õi_èg
 {

85 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_TRANSACTION_IDENTIFIER_IEI
 = 0x5D,

86 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_QOS_IEI
 = 0x30,

87 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
 = 0x32,

88 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
 = 0x80,

89 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
 = 0x34,

90 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
 = 0x5E,

91 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_IEI
 = 0x58,

92 
	mACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

93 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_õi
;

102 
	sa˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg_èg
 {

104 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

105 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

106 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

107 
MesßgeTy≥
 
	mmesßgëy≥
;

108 
EpsQuÆôyOfSîvi˚
 
	mïsqos
;

109 
Ac˚ssPoötName
 
	mac˚s•oöäame
;

110 
PdnAddªss
 
	mpd«ddªss
;

112 
uöt32_t
 
	m¥e£n˚mask
;

113 
Tønß˘i⁄Idítifõr
 
	må™ß˘i⁄idítifõr
;

114 
QuÆôyOfSîvi˚
 
	m√gŸüãdqos
;

115 
LlcSîvi˚Ac˚ssPoötIdítifõr
 
	m√gŸüãdŒcßpi
;

116 
RadioPri‹ôy
 
	mødi›ri‹ôy
;

117 
PackëFlowIdítifõr
 
	m∑ckëÊowidítifõr
;

118 
A≤Aggªg©eMaximumBôR©e
 
	m≠«mbr
;

119 
EsmCau£
 
	mesmˇu£
;

120 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

121 } 
	ta˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
;

123 
decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

125 
ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
a˘iv©edeÁu…ïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/BearerResourceAllocationReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"BóªrResour˚AŒoˇti⁄Reje˘.h
"

39 
	$decode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(
bóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
 *
bóªr_ªsour˚_Æloˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
BEARER_RESOURCE_ALLOCATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
¥e£n˚mask
 |
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(
bóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
 *
bóªr_ªsour˚_Æloˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
BEARER_RESOURCE_ALLOCATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
esmˇu£
, 0,

90 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
¥e£n˚mask
 & 
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_Æloˇti⁄_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/BearerResourceAllocationReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
BEARER_RESOURCE_ALLOCATION_REJECT_H_


41 
	#BEARER_RESOURCE_ALLOCATION_REJECT_H_


	)

44 
	#BEARER_RESOURCE_ALLOCATION_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#BEARER_RESOURCE_ALLOCATION_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#BEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	ebóªr_ªsour˚_Æloˇti⁄_ªje˘_õi_èg
 {

58 
	mBEARER_RESOURCE_ALLOCATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tbóªr_ªsour˚_Æloˇti⁄_ªje˘_õi
;

68 
	sbóªr_ªsour˚_Æloˇti⁄_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tbóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
;

80 
decode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(
bóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
 *
bóªºesour˚Æloˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(
bóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
 *
bóªºesour˚Æloˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/BearerResourceAllocationRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"BóªrResour˚AŒoˇti⁄Reque°.h
"

39 
	$decode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(
bóªr_ªsour˚_Æloˇti⁄_ªque°_msg
 *
bóªr_ªsour˚_Æloˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
BEARER_RESOURCE_ALLOCATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_löked_ïs_bóªr_idítôy
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
lökedïsbóªridítôy
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52 i‡((
decoded_ªsu…
 = 
	`decode_åaffic_Êow_aggªg©e_des¸ùti⁄
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
åafficÊowaggªg©e
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

53  
decoded_ªsu…
;

55 
decoded
 +
decoded_ªsu…
;

57 i‡((
decoded_ªsu…
 = 
	`decode_ïs_quÆôy_of_£rvi˚
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
ªquúedåafficÊowqos
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

58  
decoded_ªsu…
;

60 
decoded
 +
decoded_ªsu…
;

63 
Àn
 - 
decoded
 > 0)

65 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

67 i‡(
õiDecoded
 >= 0x80)

68 
õiDecoded
 = ieiDecoded & 0xf0;

69 
õiDecoded
)

71 
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

72 i‡((
decoded_ªsu…
 =

73 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

74 
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

75 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

76  
decoded_ªsu…
;

77 
decoded
 +
decoded_ªsu…
;

79 
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
¥e£n˚mask
 |
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

82 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

83  
TLV_DECODE_UNEXPECTED_IEI
;

86  
decoded
;

87 
	}
}

89 
	$ícode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(
bóªr_ªsour˚_Æloˇti⁄_ªque°_msg
 *
bóªr_ªsour˚_Æloˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

91 
ícoded
 = 0;

92 
ícode_ªsu…
 = 0;

95 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
BEARER_RESOURCE_ALLOCATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

97 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_löked_ïs_bóªr_idítôy
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
lökedïsbóªridítôy
) & 0x0f) << 4) | 0x00;

98 
ícoded
++;

99 i‡((
ícode_ªsu…
 =

100 
	`ícode_åaffic_Êow_aggªg©e_des¸ùti⁄
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
åafficÊowaggªg©e
,

101 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

102  
ícode_ªsu…
;

104 
ícoded
 +
ícode_ªsu…
;

106 i‡((
ícode_ªsu…
 =

107 
	`ícode_ïs_quÆôy_of_£rvi˚
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
ªquúedåafficÊowqos
,

108 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

109  
ícode_ªsu…
;

111 
ícoded
 +
ícode_ªsu…
;

113 i‡((
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
¥e£n˚mask
 & 
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

114 =
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

116 i‡((
ícode_ªsu…
 =

117 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_Æloˇti⁄_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

118 
BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

119 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

121  
ícode_ªsu…
;

123 
ícoded
 +
ícode_ªsu…
;

126  
ícoded
;

127 
	}
}

	@src/esm/msg/BearerResourceAllocationRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"LökedEpsBóªrIdítôy.h
"

38 
	~"TøfficFlowAggªg©eDes¸ùti⁄.h
"

39 
	~"EpsQuÆôyOfSîvi˚.h
"

40 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

42 #i‚de‡
BEARER_RESOURCE_ALLOCATION_REQUEST_H_


43 
	#BEARER_RESOURCE_ALLOCATION_REQUEST_H_


	)

46 
	#BEARER_RESOURCE_ALLOCATION_REQUEST_MINIMUM_LENGTH
 ( \

47 
TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MINIMUM_LENGTH
 + \

48 
EPS_QUALITY_OF_SERVICE_MINIMUM_LENGTH
 )

	)

51 
	#BEARER_RESOURCE_ALLOCATION_REQUEST_MAXIMUM_LENGTH
 ( \

52 
TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MAXIMUM_LENGTH
 + \

53 
EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

54 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

59 
	#BEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

61 
	ebóªr_ªsour˚_Æloˇti⁄_ªque°_õi_èg
 {

62 
	mBEARER_RESOURCE_ALLOCATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

63 } 
	tbóªr_ªsour˚_Æloˇti⁄_ªque°_õi
;

72 
	sbóªr_ªsour˚_Æloˇti⁄_ªque°_msg_èg
 {

74 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

75 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

76 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

77 
MesßgeTy≥
 
	mmesßgëy≥
;

78 
LökedEpsBóªrIdítôy
 
	mlökedïsbóªridítôy
;

79 
TøfficFlowAggªg©eDes¸ùti⁄
 
	måafficÊowaggªg©e
;

80 
EpsQuÆôyOfSîvi˚
 
	mªquúedåafficÊowqos
;

82 
uöt32_t
 
	m¥e£n˚mask
;

83 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

84 } 
	tbóªr_ªsour˚_Æloˇti⁄_ªque°_msg
;

86 
decode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(
bóªr_ªsour˚_Æloˇti⁄_ªque°_msg
 *
bóªºesour˚Æloˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

88 
ícode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(
bóªr_ªsour˚_Æloˇti⁄_ªque°_msg
 *
bóªºesour˚Æloˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/BearerResourceModificationReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"BóªrResour˚Modifiˇti⁄Reje˘.h
"

39 
	$decode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(
bóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
 *
bóªr_ªsour˚_modifiˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
BEARER_RESOURCE_MODIFICATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
¥e£n˚mask
 |
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(
bóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
 *
bóªr_ªsour˚_modifiˇti⁄_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
BEARER_RESOURCE_MODIFICATION_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
esmˇu£
, 0,

90 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
¥e£n˚mask
 & 
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_modifiˇti⁄_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/BearerResourceModificationReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
BEARER_RESOURCE_MODIFICATION_REJECT_H_


41 
	#BEARER_RESOURCE_MODIFICATION_REJECT_H_


	)

44 
	#BEARER_RESOURCE_MODIFICATION_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#BEARER_RESOURCE_MODIFICATION_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#BEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	ebóªr_ªsour˚_modifiˇti⁄_ªje˘_õi_èg
 {

58 
	mBEARER_RESOURCE_MODIFICATION_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tbóªr_ªsour˚_modifiˇti⁄_ªje˘_õi
;

68 
	sbóªr_ªsour˚_modifiˇti⁄_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tbóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
;

80 
decode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(
bóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
 *
bóªºesour˚modifiˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(
bóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
 *
bóªºesour˚modifiˇti⁄ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/BearerResourceModificationRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"BóªrResour˚Modifiˇti⁄Reque°.h
"

39 
	$decode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(
bóªr_ªsour˚_modifiˇti⁄_ªque°_msg
 *
bóªr_ªsour˚_modifiˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
BEARER_RESOURCE_MODIFICATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_löked_ïs_bóªr_idítôy
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
ïsbóªridítôyf‹∑ckëfûãr
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

52 i‡((
decoded_ªsu…
 = 
	`decode_åaffic_Êow_aggªg©e_des¸ùti⁄
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
åafficÊowaggªg©e
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

53  
decoded_ªsu…
;

55 
decoded
 +
decoded_ªsu…
;

58 
Àn
 - 
decoded
 > 0)

60 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

62 i‡(
õiDecoded
 >= 0x80)

63 
õiDecoded
 = ieiDecoded & 0xf0;

64 
õiDecoded
)

66 
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_IEI
:

67 i‡((
decoded_ªsu…
 =

68 
	`decode_ïs_quÆôy_of_£rvi˚
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
ªquúedåafficÊowqos
,

69 
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_IEI
,

70 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

71  
decoded_ªsu…
;

72 
decoded
 +
decoded_ªsu…
;

74 
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 |
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_PRESENT
;

76 
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_IEI
:

77 i‡((
decoded_ªsu…
 =

78 
	`decode_esm_ˇu£
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
esmˇu£
,

79 
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_IEI
, 
buf„r


80 + 
decoded
, 
Àn
 - decoded)) <= 0)

81  
decoded_ªsu…
;

82 
decoded
 +
decoded_ªsu…
;

84 
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 |
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_PRESENT
;

86 
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

87 i‡((
decoded_ªsu…
 =

88 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

89 
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

90 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

91  
decoded_ªsu…
;

92 
decoded
 +
decoded_ªsu…
;

94 
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 |
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

97 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

98  
TLV_DECODE_UNEXPECTED_IEI
;

101  
decoded
;

102 
	}
}

104 
	$ícode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(
bóªr_ªsour˚_modifiˇti⁄_ªque°_msg
 *
bóªr_ªsour˚_modifiˇti⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

106 
ícoded
 = 0;

107 
ícode_ªsu…
 = 0;

110 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
BEARER_RESOURCE_MODIFICATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

112 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_löked_ïs_bóªr_idítôy
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
ïsbóªridítôyf‹∑ckëfûãr
) & 0x0f) << 4) | 0x00;

113 
ícoded
++;

114 i‡((
ícode_ªsu…
 =

115 
	`ícode_åaffic_Êow_aggªg©e_des¸ùti⁄
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
åafficÊowaggªg©e
,

116 0, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

117  
ícode_ªsu…
;

119 
ícoded
 +
ícode_ªsu…
;

121 i‡((
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 & 
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_PRESENT
)

122 =
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_PRESENT
)

124 i‡((
ícode_ªsu…
 =

125 
	`ícode_ïs_quÆôy_of_£rvi˚
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
ªquúedåafficÊowqos
,

126 
BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_IEI
,

127 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

129  
ícode_ªsu…
;

131 
ícoded
 +
ícode_ªsu…
;

134 i‡((
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 & 
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_PRESENT
)

135 =
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_PRESENT
)

137 i‡((
ícode_ªsu…
 =

138 
	`ícode_esm_ˇu£
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
esmˇu£
,

139 
BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_IEI
, 
buf„r
 +

140 
ícoded
, 
Àn
 -Éncoded)) < 0)

142  
ícode_ªsu…
;

144 
ícoded
 +
ícode_ªsu…
;

147 i‡((
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥e£n˚mask
 & 
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

148 =
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

150 i‡((
ícode_ªsu…
 =

151 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
bóªr_ªsour˚_modifiˇti⁄_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

152 
BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

153 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

155  
ícode_ªsu…
;

157 
ícoded
 +
ícode_ªsu…
;

160  
ícoded
;

161 
	}
}

	@src/esm/msg/BearerResourceModificationRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"LökedEpsBóªrIdítôy.h
"

38 
	~"TøfficFlowAggªg©eDes¸ùti⁄.h
"

39 
	~"EpsQuÆôyOfSîvi˚.h
"

40 
	~"EsmCau£.h
"

41 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

43 #i‚de‡
BEARER_RESOURCE_MODIFICATION_REQUEST_H_


44 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_H_


	)

47 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_MINIMUM_LENGTH
 ( \

48 
TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MINIMUM_LENGTH
 )

	)

51 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_MAXIMUM_LENGTH
 ( \

52 
TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MAXIMUM_LENGTH
 + \

53 
EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

54 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

55 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

60 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_PRESENT
 (1<<0)

	)

61 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_PRESENT
 (1<<1)

	)

62 
	#BEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<2)

	)

64 
	ebóªr_ªsour˚_modifiˇti⁄_ªque°_õi_èg
 {

65 
	mBEARER_RESOURCE_MODIFICATION_REQUEST_REQUIRED_TRAFFIC_FLOW_QOS_IEI
 = 0x5B,

66 
	mBEARER_RESOURCE_MODIFICATION_REQUEST_ESM_CAUSE_IEI
 = 0x58,

67 
	mBEARER_RESOURCE_MODIFICATION_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

68 } 
	tbóªr_ªsour˚_modifiˇti⁄_ªque°_õi
;

77 
	sbóªr_ªsour˚_modifiˇti⁄_ªque°_msg_èg
 {

79 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

80 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

81 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

82 
MesßgeTy≥
 
	mmesßgëy≥
;

83 
LökedEpsBóªrIdítôy
 
	mïsbóªridítôyf‹∑ckëfûãr
;

84 
TøfficFlowAggªg©eDes¸ùti⁄
 
	måafficÊowaggªg©e
;

86 
uöt32_t
 
	m¥e£n˚mask
;

87 
EpsQuÆôyOfSîvi˚
 
	mªquúedåafficÊowqos
;

88 
EsmCau£
 
	mesmˇu£
;

89 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

90 } 
	tbóªr_ªsour˚_modifiˇti⁄_ªque°_msg
;

92 
decode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(
bóªr_ªsour˚_modifiˇti⁄_ªque°_msg
 *
bóªºesour˚modifiˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

94 
ícode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(
bóªr_ªsour˚_modifiˇti⁄_ªque°_msg
 *
bóªºesour˚modifiˇti⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/DeactivateEpsBearerContextAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Dó˘iv©eEpsBóªrC⁄ãxtAc˚±.h
"

39 
	$decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

60 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

61 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 |
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

68 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

69  
TLV_DECODE_UNEXPECTED_IEI
;

72  
decoded
;

73 
	}
}

75 
	$ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

77 
ícoded
 = 0;

78 
ícode_ªsu…
 = 0;

81 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

83 i‡((
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 & 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

84 =
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

86 i‡((
ícode_ªsu…
 =

87 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

88 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

96  
ícoded
;

97 
	}
}

	@src/esm/msg/DeactivateEpsBearerContextAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

39 #i‚de‡
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_H_


40 
	#DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_H_


	)

43 
	#DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
 (0)

	)

46 
	#DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_MAXIMUM_LENGTH
 ( \

47 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

52 
	#DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

54 
	edó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_õi_èg
 {

55 
	mDEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

56 } 
	tdó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_õi
;

65 
	sdó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg_èg
 {

67 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

68 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

69 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

70 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
uöt32_t
 
	m¥e£n˚mask
;

73 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

74 } 
	tdó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
;

76 
decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
dó˘iv©ìpsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

78 
ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
dó˘iv©ìpsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/DeactivateEpsBearerContextRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Dó˘iv©eEpsBóªrC⁄ãxtReque°.h
"

39 
	$decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
esmˇu£
, 0,

90 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/DeactivateEpsBearerContextRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_H_


41 
	#DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_H_


	)

44 
	#DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	edó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_õi_èg
 {

58 
	mDEACTIVATE_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tdó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_õi
;

68 
	sdó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tdó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
;

80 
decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
dó˘iv©ìpsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
dó˘iv©ìpsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/EsmInformationRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"EsmInf‹m©i⁄Reque°.h
"

39 
	$decode_esm_öf‹m©i⁄_ªque°
(
esm_öf‹m©i⁄_ªque°_msg
 *
esm_öf‹m©i⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

44 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ESM_INFORMATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

47  
decoded
;

48 
	}
}

50 
	$ícode_esm_öf‹m©i⁄_ªque°
(
esm_öf‹m©i⁄_ªque°_msg
 *
esm_öf‹m©i⁄_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

52 
ícoded
 = 0;

55 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_INFORMATION_REQUEST_MINIMUM_LENGTH
, 
Àn
);

57  
ícoded
;

58 
	}
}

	@src/esm/msg/EsmInformationRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

38 #i‚de‡
ESM_INFORMATION_REQUEST_H_


39 
	#ESM_INFORMATION_REQUEST_H_


	)

42 
	#ESM_INFORMATION_REQUEST_MINIMUM_LENGTH
 (0)

	)

45 
	#ESM_INFORMATION_REQUEST_MAXIMUM_LENGTH
 (0)

	)

54 
	sesm_öf‹m©i⁄_ªque°_msg_èg
 {

56 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

57 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

58 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

59 
MesßgeTy≥
 
	mmesßgëy≥
;

60 } 
	tesm_öf‹m©i⁄_ªque°_msg
;

62 
decode_esm_öf‹m©i⁄_ªque°
(
esm_öf‹m©i⁄_ªque°_msg
 *
esmöf‹m©i⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

64 
ícode_esm_öf‹m©i⁄_ªque°
(
esm_öf‹m©i⁄_ªque°_msg
 *
esmöf‹m©i⁄ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/EsmInformationResponse.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"EsmInf‹m©i⁄Re•⁄£.h
"

39 
	$decode_esm_öf‹m©i⁄_ª•⁄£
(
esm_öf‹m©i⁄_ª•⁄£_msg
 *
esm_öf‹m©i⁄_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ESM_INFORMATION_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_ac˚ss_poöt_«me
(&
esm_öf‹m©i⁄_ª•⁄£
->
ac˚s•oöäame
,

60 
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_IEI
, 
buf„r
 +

61 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
esm_öf‹m©i⁄_ª•⁄£
->
¥e£n˚mask
 |
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_PRESENT
;

67 
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

68 i‡((
decoded_ªsu…
 =

69 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
esm_öf‹m©i⁄_ª•⁄£
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

70 
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

71 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

72  
decoded_ªsu…
;

73 
decoded
 +
decoded_ªsu…
;

75 
esm_öf‹m©i⁄_ª•⁄£
->
¥e£n˚mask
 |
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

78 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

79  
TLV_DECODE_UNEXPECTED_IEI
;

82  
decoded
;

83 
	}
}

85 
	$ícode_esm_öf‹m©i⁄_ª•⁄£
(
esm_öf‹m©i⁄_ª•⁄£_msg
 *
esm_öf‹m©i⁄_ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

87 
ícoded
 = 0;

88 
ícode_ªsu…
 = 0;

91 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_INFORMATION_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

93 i‡((
esm_öf‹m©i⁄_ª•⁄£
->
¥e£n˚mask
 & 
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_PRESENT
)

94 =
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_PRESENT
)

96 i‡((
ícode_ªsu…
 =

97 
	`ícode_ac˚ss_poöt_«me
(&
esm_öf‹m©i⁄_ª•⁄£
->
ac˚s•oöäame
,

98 
ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_IEI
, 
buf„r
 + 
ícoded
,

99 
Àn
 - 
ícoded
)) < 0)

101  
ícode_ªsu…
;

103 
ícoded
 +
ícode_ªsu…
;

106 i‡((
esm_öf‹m©i⁄_ª•⁄£
->
¥e£n˚mask
 & 
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

107 =
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

109 i‡((
ícode_ªsu…
 =

110 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
esm_öf‹m©i⁄_ª•⁄£
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

111 
ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

112 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

114  
ícode_ªsu…
;

116 
ícoded
 +
ícode_ªsu…
;

119  
ícoded
;

120 
	}
}

	@src/esm/msg/EsmInformationResponse.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"Ac˚ssPoötName.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
ESM_INFORMATION_RESPONSE_H_


41 
	#ESM_INFORMATION_RESPONSE_H_


	)

44 
	#ESM_INFORMATION_RESPONSE_MINIMUM_LENGTH
 (0)

	)

47 
	#ESM_INFORMATION_RESPONSE_MAXIMUM_LENGTH
 ( \

48 
ACCESS_POINT_NAME_MAXIMUM_LENGTH
 + \

49 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

54 
	#ESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_PRESENT
 (1<<0)

	)

55 
	#ESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<1)

	)

57 
	eesm_öf‹m©i⁄_ª•⁄£_õi_èg
 {

58 
	mESM_INFORMATION_RESPONSE_ACCESS_POINT_NAME_IEI
 = 0x28,

59 
	mESM_INFORMATION_RESPONSE_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

60 } 
	tesm_öf‹m©i⁄_ª•⁄£_õi
;

69 
	sesm_öf‹m©i⁄_ª•⁄£_msg_èg
 {

71 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

72 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

73 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

74 
MesßgeTy≥
 
	mmesßgëy≥
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
Ac˚ssPoötName
 
	mac˚s•oöäame
;

78 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

79 } 
	tesm_öf‹m©i⁄_ª•⁄£_msg
;

81 
decode_esm_öf‹m©i⁄_ª•⁄£
(
esm_öf‹m©i⁄_ª•⁄£_msg
 *
esmöf‹m©i⁄ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

83 
ícode_esm_öf‹m©i⁄_ª•⁄£
(
esm_öf‹m©i⁄_ª•⁄£_msg
 *
esmöf‹m©i⁄ª•⁄£
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/EsmStatus.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"EsmSètus.h
"

39 
	$decode_esm_°©us
(
esm_°©us_msg
 *
esm_°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ESM_STATUS_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
esm_°©us
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

53  
decoded
;

54 
	}
}

56 
	$ícode_esm_°©us
(
esm_°©us_msg
 *
esm_°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

58 
ícoded
 = 0;

59 
ícode_ªsu…
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_STATUS_MINIMUM_LENGTH
, 
Àn
);

64 i‡((
ícode_ªsu…
 = 
	`ícode_esm_ˇu£
(&
esm_°©us
->
esmˇu£
, 0, 
buf„r
 +

65 
ícoded
, 
Àn
 -Éncoded)) < 0)

66  
ícode_ªsu…
;

68 
ícoded
 +
ícode_ªsu…
;

70  
ícoded
;

71 
	}
}

	@src/esm/msg/EsmStatus.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

39 #i‚de‡
ESM_STATUS_H_


40 
	#ESM_STATUS_H_


	)

43 
	#ESM_STATUS_MINIMUM_LENGTH
 ( \

44 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

47 
	#ESM_STATUS_MAXIMUM_LENGTH
 ( \

48 
ESM_CAUSE_MAXIMUM_LENGTH
 )

	)

58 
	sesm_°©us_msg_èg
 {

60 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

61 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

62 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

63 
MesßgeTy≥
 
	mmesßgëy≥
;

64 
EsmCau£
 
	mesmˇu£
;

65 } 
	tesm_°©us_msg
;

67 
decode_esm_°©us
(
esm_°©us_msg
 *
esm°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

69 
ícode_esm_°©us
(
esm_°©us_msg
 *
esm°©us
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ModifyEpsBearerContextAccept.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"ModifyEpsBóªrC⁄ãxtAc˚±.h
"

39 
	$decode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(
modify_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
modify_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

60 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

61 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
modify_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

68 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

69  
TLV_DECODE_UNEXPECTED_IEI
;

72  
decoded
;

73 
	}
}

75 
	$ícode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(
modify_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
modify_ïs_bóªr_c⁄ãxt_ac˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

77 
ícoded
 = 0;

78 
ícode_ªsu…
 = 0;

81 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
, 
Àn
);

83 i‡((
modify_ïs_bóªr_c⁄ãxt_ac˚±
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

84 =
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

86 i‡((
ícode_ªsu…
 =

87 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ac˚±
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

88 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

96  
ícoded
;

97 
	}
}

	@src/esm/msg/ModifyEpsBearerContextAccept.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

39 #i‚de‡
MODIFY_EPS_BEARER_CONTEXT_ACCEPT_H_


40 
	#MODIFY_EPS_BEARER_CONTEXT_ACCEPT_H_


	)

43 
	#MODIFY_EPS_BEARER_CONTEXT_ACCEPT_MINIMUM_LENGTH
 (0)

	)

46 
	#MODIFY_EPS_BEARER_CONTEXT_ACCEPT_MAXIMUM_LENGTH
 ( \

47 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

52 
	#MODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

54 
	emodify_ïs_bóªr_c⁄ãxt_ac˚±_õi_èg
 {

55 
	mMODIFY_EPS_BEARER_CONTEXT_ACCEPT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

56 } 
	tmodify_ïs_bóªr_c⁄ãxt_ac˚±_õi
;

65 
	smodify_ïs_bóªr_c⁄ãxt_ac˚±_msg_èg
 {

67 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

68 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

69 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

70 
MesßgeTy≥
 
	mmesßgëy≥
;

72 
uöt32_t
 
	m¥e£n˚mask
;

73 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

74 } 
	tmodify_ïs_bóªr_c⁄ãxt_ac˚±_msg
;

76 
decode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(
modify_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
modifyïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

78 
ícode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(
modify_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
modifyïsbóªrc⁄ãxèc˚±
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ModifyEpsBearerContextReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"ModifyEpsBóªrC⁄ãxtReje˘.h
"

39 
	$decode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(
modify_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
modify_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(
modify_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
modify_ïs_bóªr_c⁄ãxt_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 =

89 
	`ícode_esm_ˇu£
(&
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
esmˇu£
, 0,

90 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

95 i‡((
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

96 =
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

98 i‡((
ícode_ªsu…
 =

99 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

100 
MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

101 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

103  
ícode_ªsu…
;

105 
ícoded
 +
ícode_ªsu…
;

108  
ícoded
;

109 
	}
}

	@src/esm/msg/ModifyEpsBearerContextReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
MODIFY_EPS_BEARER_CONTEXT_REJECT_H_


41 
	#MODIFY_EPS_BEARER_CONTEXT_REJECT_H_


	)

44 
	#MODIFY_EPS_BEARER_CONTEXT_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#MODIFY_EPS_BEARER_CONTEXT_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#MODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	emodify_ïs_bóªr_c⁄ãxt_ªje˘_õi_èg
 {

58 
	mMODIFY_EPS_BEARER_CONTEXT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tmodify_ïs_bóªr_c⁄ãxt_ªje˘_õi
;

68 
	smodify_ïs_bóªr_c⁄ãxt_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tmodify_ïs_bóªr_c⁄ãxt_ªje˘_msg
;

80 
decode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(
modify_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
modifyïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(
modify_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
modifyïsbóªrc⁄ãxåeje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/ModifyEpsBearerContextRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"ModifyEpsBóªrC⁄ãxtReque°.h
"

39 
	$decode_modify_ïs_bóªr_c⁄ãxt_ªque°
(
modify_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
modify_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

49 
Àn
 - 
decoded
 > 0)

51 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

53 i‡(
õiDecoded
 >= 0x80)

54 
õiDecoded
 = ieiDecoded & 0xf0;

55 
õiDecoded
)

57 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_IEI
:

58 i‡((
decoded_ªsu…
 =

59 
	`decode_ïs_quÆôy_of_£rvi˚
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√wïsqos
,

60 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_IEI
, 
buf„r
 +

61 
decoded
, 
Àn
 - decoded)) <= 0)

62  
decoded_ªsu…
;

63 
decoded
 +
decoded_ªsu…
;

65 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_PRESENT
;

67 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_IEI
:

68 i‡((
decoded_ªsu…
 =

69 
	`decode_åaffic_Êow_ãm∂©e
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
t·
,

70 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_IEI
, 
buf„r
 +

71 
decoded
, 
Àn
 - decoded)) <= 0)

72  
decoded_ªsu…
;

73 
decoded
 +
decoded_ªsu…
;

75 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_PRESENT
;

77 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_IEI
:

78 i‡((
decoded_ªsu…
 =

79 
	`decode_quÆôy_of_£rvi˚
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√wqos
,

80 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_IEI
, 
buf„r
 +

81 
decoded
, 
Àn
 - decoded)) <= 0)

82  
decoded_ªsu…
;

83 
decoded
 +
decoded_ªsu…
;

85 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_PRESENT
;

87 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
:

88 i‡((
decoded_ªsu…
 =

89 
	`decode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

90 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
,

91 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

92  
decoded_ªsu…
;

93 
decoded
 +
decoded_ªsu…
;

95 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
;

97 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
:

98 i‡((
decoded_ªsu…
 =

99 
	`decode_ødio_¥i‹ôy
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

100 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
,

101 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

102  
decoded_ªsu…
;

103 
decoded
 +
decoded_ªsu…
;

105 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
;

107 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
:

108 i‡((
decoded_ªsu…
 =

109 
	`decode_∑ckë_Êow_idítifõr
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

110 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

111 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

112  
decoded_ªsu…
;

113 
decoded
 +
decoded_ªsu…
;

115 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
;

117 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
:

118 i‡((
decoded_ªsu…
 =

119 
	`decode_≠n_aggªg©e_maximum_bô_øã
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
≠«mbr
,

120 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
, 
buf„r
 +

121 
decoded
, 
Àn
 - decoded)) <= 0)

122  
decoded_ªsu…
;

123 
decoded
 +
decoded_ªsu…
;

125 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
;

127 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

128 i‡((
decoded_ªsu…
 =

129 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

130 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

131 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

132  
decoded_ªsu…
;

133 
decoded
 +
decoded_ªsu…
;

135 
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 |
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

138 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

139  
TLV_DECODE_UNEXPECTED_IEI
;

142  
decoded
;

143 
	}
}

145 
	$ícode_modify_ïs_bóªr_c⁄ãxt_ªque°
(
modify_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
modify_ïs_bóªr_c⁄ãxt_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

147 
ícoded
 = 0;

148 
ícode_ªsu…
 = 0;

151 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

153 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_PRESENT
)

154 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_PRESENT
)

156 i‡((
ícode_ªsu…
 =

157 
	`ícode_ïs_quÆôy_of_£rvi˚
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√wïsqos
,

158 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_IEI
, 
buf„r
 +

159 
ícoded
, 
Àn
 -Éncoded)) < 0)

161  
ícode_ªsu…
;

163 
ícoded
 +
ícode_ªsu…
;

166 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_PRESENT
)

167 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_PRESENT
)

169 i‡((
ícode_ªsu…
 =

170 
	`ícode_åaffic_Êow_ãm∂©e
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
t·
,

171 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_IEI
, 
buf„r
 + 
ícoded
, 
Àn
 -

172 
ícoded
)) < 0)

174  
ícode_ªsu…
;

176 
ícoded
 +
ícode_ªsu…
;

179 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_PRESENT
)

180 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_PRESENT
)

182 i‡((
ícode_ªsu…
 =

183 
	`ícode_quÆôy_of_£rvi˚
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√wqos
,

184 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_IEI
, 
buf„r
 + 
ícoded
,

185 
Àn
 - 
ícoded
)) < 0)

187  
ícode_ªsu…
;

189 
ícoded
 +
ícode_ªsu…
;

192 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

193 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
)

195 i‡((
ícode_ªsu…
 =

196 
	`ícode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
√gŸüãdŒcßpi
,

197 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
, 
buf„r


198 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

200  
ícode_ªsu…
;

202 
ícoded
 +
ícode_ªsu…
;

205 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

206 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
)

208 i‡((
ícode_ªsu…
 =

209 
	`ícode_ødio_¥i‹ôy
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
ødi›ri‹ôy
,

210 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
, 
buf„r
 +

211 
ícoded
, 
Àn
 -Éncoded)) < 0)

213  
ícode_ªsu…
;

215 
ícoded
 +
ícode_ªsu…
;

218 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

219 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
)

221 i‡((
ícode_ªsu…
 =

222 
	`ícode_∑ckë_Êow_idítifõr
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
∑ckëÊowidítifõr
,

223 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
,

224 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

226  
ícode_ªsu…
;

228 
ícoded
 +
ícode_ªsu…
;

231 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
)

232 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
)

234 i‡((
ícode_ªsu…
 =

235 
	`ícode_≠n_aggªg©e_maximum_bô_øã
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
≠«mbr
,

236 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
, 
buf„r
 + 
ícoded
,

237 
Àn
 - 
ícoded
)) < 0)

239  
ícode_ªsu…
;

241 
ícoded
 +
ícode_ªsu…
;

244 i‡((
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥e£n˚mask
 & 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

245 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

247 i‡((
ícode_ªsu…
 =

248 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
modify_ïs_bóªr_c⁄ãxt_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

249 
MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

250 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

252  
ícode_ªsu…
;

254 
ícoded
 +
ícode_ªsu…
;

257  
ícoded
;

258 
	}
}

	@src/esm/msg/ModifyEpsBearerContextRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EpsQuÆôyOfSîvi˚.h
"

38 
	~"TøfficFlowTem∂©e.h
"

39 
	~"QuÆôyOfSîvi˚.h
"

40 
	~"LlcSîvi˚Ac˚ssPoötIdítifõr.h
"

41 
	~"RadioPri‹ôy.h
"

42 
	~"PackëFlowIdítifõr.h
"

43 
	~"A≤Aggªg©eMaximumBôR©e.h
"

44 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

46 #i‚de‡
MODIFY_EPS_BEARER_CONTEXT_REQUEST_H_


47 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_H_


	)

50 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_MINIMUM_LENGTH
 (0)

	)

53 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_MAXIMUM_LENGTH
 ( \

54 
EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

55 
TRAFFIC_FLOW_TEMPLATE_MAXIMUM_LENGTH
 + \

56 
QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 + \

57 
LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MAXIMUM_LENGTH
 + \

58 
RADIO_PRIORITY_MAXIMUM_LENGTH
 + \

59 
PACKET_FLOW_IDENTIFIER_MAXIMUM_LENGTH
 + \

60 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_LENGTH
 + \

61 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

66 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_PRESENT
 (1<<0)

	)

67 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_PRESENT
 (1<<1)

	)

68 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_PRESENT
 (1<<2)

	)

69 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_PRESENT
 (1<<3)

	)

70 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_PRESENT
 (1<<4)

	)

71 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_PRESENT
 (1<<5)

	)

72 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
 (1<<6)

	)

73 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<7)

	)

75 
	emodify_ïs_bóªr_c⁄ãxt_ªque°_õi_èg
 {

76 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_EPS_QOS_IEI
 = 0x5B,

77 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_TFT_IEI
 = 0x36,

78 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_NEW_QOS_IEI
 = 0x30,

79 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_NEGOTIATED_LLC_SAPI_IEI
 = 0x32,

80 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_RADIO_PRIORITY_IEI
 = 0x80,

81 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_PACKET_FLOW_IDENTIFIER_IEI
 = 0x34,

82 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_IEI
 = 0x5E,

83 
	mMODIFY_EPS_BEARER_CONTEXT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

84 } 
	tmodify_ïs_bóªr_c⁄ãxt_ªque°_õi
;

93 
	smodify_ïs_bóªr_c⁄ãxt_ªque°_msg_èg
 {

95 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

96 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

97 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

98 
MesßgeTy≥
 
	mmesßgëy≥
;

100 
uöt32_t
 
	m¥e£n˚mask
;

101 
EpsQuÆôyOfSîvi˚
 
	m√wïsqos
;

102 
TøfficFlowTem∂©e
 
	mt·
;

103 
QuÆôyOfSîvi˚
 
	m√wqos
;

104 
LlcSîvi˚Ac˚ssPoötIdítifõr
 
	m√gŸüãdŒcßpi
;

105 
RadioPri‹ôy
 
	mødi›ri‹ôy
;

106 
PackëFlowIdítifõr
 
	m∑ckëÊowidítifõr
;

107 
A≤Aggªg©eMaximumBôR©e
 
	m≠«mbr
;

108 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

109 } 
	tmodify_ïs_bóªr_c⁄ãxt_ªque°_msg
;

111 
decode_modify_ïs_bóªr_c⁄ãxt_ªque°
(
modify_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
modifyïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

113 
ícode_modify_ïs_bóªr_c⁄ãxt_ªque°
(
modify_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
modifyïsbóªrc⁄ãxåeque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/PdnConnectivityReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"PdnC⁄√˘ivôyReje˘.h
"

39 
	$decode_pdn_c⁄√˘ivôy_ªje˘
(
pdn_c⁄√˘ivôy_ªje˘_msg
 *
pdn_c⁄√˘ivôy_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
PDN_CONNECTIVITY_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
pdn_c⁄√˘ivôy_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_c⁄√˘ivôy_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
pdn_c⁄√˘ivôy_ªje˘
->
¥e£n˚mask
 |
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_pdn_c⁄√˘ivôy_ªje˘
(
pdn_c⁄√˘ivôy_ªje˘_msg
 *
pdn_c⁄√˘ivôy_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_CONNECTIVITY_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 = 
	`ícode_esm_ˇu£
(&
pdn_c⁄√˘ivôy_ªje˘
->
esmˇu£
, 0,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

90  
ícode_ªsu…
;

92 
ícoded
 +
ícode_ªsu…
;

94 i‡((
pdn_c⁄√˘ivôy_ªje˘
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

95 =
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

97 i‡((
ícode_ªsu…
 =

98 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_c⁄√˘ivôy_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

99 
PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
, 
buf„r


100 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

102  
ícode_ªsu…
;

104 
ícoded
 +
ícode_ªsu…
;

107  
ícoded
;

108 
	}
}

	@src/esm/msg/PdnConnectivityReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
PDN_CONNECTIVITY_REJECT_H_


41 
	#PDN_CONNECTIVITY_REJECT_H_


	)

44 
	#PDN_CONNECTIVITY_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#PDN_CONNECTIVITY_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#PDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	epdn_c⁄√˘ivôy_ªje˘_õi_èg
 {

58 
	mPDN_CONNECTIVITY_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tpdn_c⁄√˘ivôy_ªje˘_õi
;

68 
	spdn_c⁄√˘ivôy_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tpdn_c⁄√˘ivôy_ªje˘_msg
;

80 
decode_pdn_c⁄√˘ivôy_ªje˘
(
pdn_c⁄√˘ivôy_ªje˘_msg
 *
pdnc⁄√˘ivôyªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_pdn_c⁄√˘ivôy_ªje˘
(
pdn_c⁄√˘ivôy_ªje˘_msg
 *
pdnc⁄√˘ivôyªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/PdnConnectivityRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"PdnC⁄√˘ivôyReque°.h
"

39 
	$decode_pdn_c⁄√˘ivôy_ªque°
(
pdn_c⁄√˘ivôy_ªque°_msg
 *
pdn_c⁄√˘ivôy_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
PDN_CONNECTIVITY_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_ªque°_ty≥
(&
pdn_c⁄√˘ivôy_ªque°
->
pd¡y≥
, 0, *(
buf„r
 + 
decoded
Ë>> 4, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 i‡((
decoded_ªsu…
 = 
	`decode_u8_pdn_ty≥
(&
pdn_c⁄√˘ivôy_ªque°
->
ªque°ty≥
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

52  
decoded_ªsu…
;

54 
decoded
++;

56 
Àn
 - 
decoded
 > 0)

58 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

60 i‡(
õiDecoded
 >= 0x80)

61 
õiDecoded
 = ieiDecoded & 0xf0;

62 
õiDecoded
)

64 
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_IEI
:

65 i‡((
decoded_ªsu…
 =

66 
	`decode_esm_öf‹m©i⁄_å™s„r_Êag
(&
pdn_c⁄√˘ivôy_ªque°
->
esmöf‹m©i⁄å™s„rÊag
,

67 
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_IEI
,

68 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

69  
decoded_ªsu…
;

70 
decoded
 +
decoded_ªsu…
;

72 
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 |
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_PRESENT
;

74 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_IEI
:

75 i‡((
decoded_ªsu…
 =

76 
	`decode_ac˚ss_poöt_«me
(&
pdn_c⁄√˘ivôy_ªque°
->
ac˚s•oöäame
,

77 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_IEI
, 
buf„r
 +

78 
decoded
, 
Àn
 - decoded)) <= 0)

79  
decoded_ªsu…
;

80 
decoded
 +
decoded_ªsu…
;

82 
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 |
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
;

84 
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

85 i‡((
decoded_ªsu…
 =

86 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_c⁄√˘ivôy_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

87 
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

88 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

89  
decoded_ªsu…
;

90 
decoded
 +
decoded_ªsu…
;

92 
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 |
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

95 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

96  
TLV_DECODE_UNEXPECTED_IEI
;

99  
decoded
;

100 
	}
}

102 
	$ícode_pdn_c⁄√˘ivôy_ªque°
(
pdn_c⁄√˘ivôy_ªque°_msg
 *
pdn_c⁄√˘ivôy_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

104 
ícoded
 = 0;

105 
ícode_ªsu…
 = 0;

108 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_CONNECTIVITY_REQUEST_MINIMUM_LENGTH
, 
Àn
);

110 *(
buf„r
 + 
ícoded
Ë((
	`ícode_u8_pdn_ty≥
(&
pdn_c⁄√˘ivôy_ªque°
->
pd¡y≥
Ë& 0x0fË<< 4Ë| (
	`ícode_u8_ªque°_ty≥
(&pdn_c⁄√˘ivôy_ªque°->
ªque°ty≥
) & 0x0f);

111 
ícoded
++;

113 i‡((
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_PRESENT
)

114 =
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_PRESENT
)

116 i‡((
ícode_ªsu…
 =

117 
	`ícode_esm_öf‹m©i⁄_å™s„r_Êag
(&
pdn_c⁄√˘ivôy_ªque°
->
esmöf‹m©i⁄å™s„rÊag
,

118 
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_IEI
, 
buf„r


119 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

121  
ícode_ªsu…
;

123 
ícoded
 +
ícode_ªsu…
;

126 i‡((
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
)

127 =
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
)

129 i‡((
ícode_ªsu…
 =

130 
	`ícode_ac˚ss_poöt_«me
(&
pdn_c⁄√˘ivôy_ªque°
->
ac˚s•oöäame
,

131 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_IEI
, 
buf„r
 + 
ícoded
,

132 
Àn
 - 
ícoded
)) < 0)

134  
ícode_ªsu…
;

136 
ícoded
 +
ícode_ªsu…
;

139 i‡((
pdn_c⁄√˘ivôy_ªque°
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

140 =
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

142 i‡((
ícode_ªsu…
 =

143 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_c⁄√˘ivôy_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

144 
PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

145 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

147  
ícode_ªsu…
;

149 
ícoded
 +
ícode_ªsu…
;

152  
ícoded
;

153 
	}
}

	@src/esm/msg/PdnConnectivityRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"NasReque°Ty≥.h
"

38 
	~"PdnTy≥.h
"

39 
	~"EsmInf‹m©i⁄Tøns„rFœg.h
"

40 
	~"Ac˚ssPoötName.h
"

41 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

43 #i‚de‡
PDN_CONNECTIVITY_REQUEST_H_


44 
	#PDN_CONNECTIVITY_REQUEST_H_


	)

47 
	#PDN_CONNECTIVITY_REQUEST_MINIMUM_LENGTH
 ( \

48 
PDN_TYPE_MINIMUM_LENGTH
 )

	)

51 
	#PDN_CONNECTIVITY_REQUEST_MAXIMUM_LENGTH
 ( \

52 
PDN_TYPE_MAXIMUM_LENGTH
 + \

53 
ESM_INFORMATION_TRANSFER_FLAG_MAXIMUM_LENGTH
 + \

54 
ACCESS_POINT_NAME_MAXIMUM_LENGTH
 + \

55 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

60 
	#PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_PRESENT
 (1<<0)

	)

61 
	#PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
 (1<<1)

	)

62 
	#PDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<2)

	)

64 
	epdn_c⁄√˘ivôy_ªque°_õi_èg
 {

65 
	mPDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_IEI
 = 0xD0,

66 
	mPDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_IEI
 = 0x28,

67 
	mPDN_CONNECTIVITY_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

68 } 
	tpdn_c⁄√˘ivôy_ªque°_õi
;

77 
	spdn_c⁄√˘ivôy_ªque°_msg_èg
 {

79 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

80 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

81 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

82 
MesßgeTy≥
 
	mmesßgëy≥
;

83 
Reque°Ty≥
 
	mªque°ty≥
;

84 
PdnTy≥
 
	mpd¡y≥
;

86 
uöt32_t
 
	m¥e£n˚mask
;

87 
EsmInf‹m©i⁄Tøns„rFœg
 
	mesmöf‹m©i⁄å™s„rÊag
;

88 
Ac˚ssPoötName
 
	mac˚s•oöäame
;

89 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

90 } 
	tpdn_c⁄√˘ivôy_ªque°_msg
;

92 
decode_pdn_c⁄√˘ivôy_ªque°
(
pdn_c⁄√˘ivôy_ªque°_msg
 *
pdnc⁄√˘ivôyªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

94 
ícode_pdn_c⁄√˘ivôy_ªque°
(
pdn_c⁄√˘ivôy_ªque°_msg
 *
pdnc⁄√˘ivôyªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/PdnDisconnectReject.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"PdnDisc⁄√˘Reje˘.h
"

39 
	$decode_pdn_disc⁄√˘_ªje˘
(
pdn_disc⁄√˘_ªje˘_msg
 *
pdn_disc⁄√˘_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
PDN_DISCONNECT_REJECT_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_esm_ˇu£
(&
pdn_disc⁄√˘_ªje˘
->
esmˇu£
, 0, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
 +
decoded_ªsu…
;

54 
Àn
 - 
decoded
 > 0)

56 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

58 i‡(
õiDecoded
 >= 0x80)

59 
õiDecoded
 = ieiDecoded & 0xf0;

60 
õiDecoded
)

62 
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

63 i‡((
decoded_ªsu…
 =

64 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_disc⁄√˘_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

65 
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

66 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

67  
decoded_ªsu…
;

68 
decoded
 +
decoded_ªsu…
;

70 
pdn_disc⁄√˘_ªje˘
->
¥e£n˚mask
 |
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

73 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

74  
TLV_DECODE_UNEXPECTED_IEI
;

77  
decoded
;

78 
	}
}

80 
	$ícode_pdn_disc⁄√˘_ªje˘
(
pdn_disc⁄√˘_ªje˘_msg
 *
pdn_disc⁄√˘_ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

82 
ícoded
 = 0;

83 
ícode_ªsu…
 = 0;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_DISCONNECT_REJECT_MINIMUM_LENGTH
, 
Àn
);

88 i‡((
ícode_ªsu…
 = 
	`ícode_esm_ˇu£
(&
pdn_disc⁄√˘_ªje˘
->
esmˇu£
, 0,

89 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

90  
ícode_ªsu…
;

92 
ícoded
 +
ícode_ªsu…
;

94 i‡((
pdn_disc⁄√˘_ªje˘
->
¥e£n˚mask
 & 
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

95 =
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

97 i‡((
ícode_ªsu…
 =

98 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_disc⁄√˘_ªje˘
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

99 
PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
, 
buf„r
 +

100 
ícoded
, 
Àn
 -Éncoded)) < 0)

102  
ícode_ªsu…
;

104 
ícoded
 +
ícode_ªsu…
;

107  
ícoded
;

108 
	}
}

	@src/esm/msg/PdnDisconnectReject.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"EsmCau£.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
PDN_DISCONNECT_REJECT_H_


41 
	#PDN_DISCONNECT_REJECT_H_


	)

44 
	#PDN_DISCONNECT_REJECT_MINIMUM_LENGTH
 ( \

45 
ESM_CAUSE_MINIMUM_LENGTH
 )

	)

48 
	#PDN_DISCONNECT_REJECT_MAXIMUM_LENGTH
 ( \

49 
ESM_CAUSE_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#PDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	epdn_disc⁄√˘_ªje˘_õi_èg
 {

58 
	mPDN_DISCONNECT_REJECT_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tpdn_disc⁄√˘_ªje˘_õi
;

68 
	spdn_disc⁄√˘_ªje˘_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
EsmCau£
 
	mesmˇu£
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tpdn_disc⁄√˘_ªje˘_msg
;

80 
decode_pdn_disc⁄√˘_ªje˘
(
pdn_disc⁄√˘_ªje˘_msg
 *
pdndisc⁄√˘ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_pdn_disc⁄√˘_ªje˘
(
pdn_disc⁄√˘_ªje˘_msg
 *
pdndisc⁄√˘ªje˘
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/PdnDisconnectRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<°döt.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"PdnDisc⁄√˘Reque°.h
"

39 
	$decode_pdn_disc⁄√˘_ªque°
(
pdn_disc⁄√˘_ªque°_msg
 *
pdn_disc⁄√˘_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

41 
uöt32_t
 
decoded
 = 0;

42 
decoded_ªsu…
 = 0;

45 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
PDN_DISCONNECT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

48 i‡((
decoded_ªsu…
 = 
	`decode_u8_löked_ïs_bóªr_idítôy
(&
pdn_disc⁄√˘_ªque°
->
lökedïsbóªridítôy
, 0, *(
buf„r
 + 
decoded
Ë& 0x0f, 
Àn
 - decoded)) < 0)

49  
decoded_ªsu…
;

51 
decoded
++;

53 
Àn
 - 
decoded
 > 0)

55 
uöt8_t
 
õiDecoded
 = *(
buf„r
 + 
decoded
);

57 i‡(
õiDecoded
 >= 0x80)

58 
õiDecoded
 = ieiDecoded & 0xf0;

59 
õiDecoded
)

61 
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
:

62 i‡((
decoded_ªsu…
 =

63 
	`decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_disc⁄√˘_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

64 
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
,

65 
buf„r
 + 
decoded
, 
Àn
 - decoded)) <= 0)

66  
decoded_ªsu…
;

67 
decoded
 +
decoded_ªsu…
;

69 
pdn_disc⁄√˘_ªque°
->
¥e£n˚mask
 |
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
;

72 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
;

73  
TLV_DECODE_UNEXPECTED_IEI
;

76  
decoded
;

77 
	}
}

79 
	$ícode_pdn_disc⁄√˘_ªque°
(
pdn_disc⁄√˘_ªque°_msg
 *
pdn_disc⁄√˘_ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

81 
ícoded
 = 0;

82 
ícode_ªsu…
 = 0;

85 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_DISCONNECT_REQUEST_MINIMUM_LENGTH
, 
Àn
);

87 *(
buf„r
 + 
ícoded
Ë(
	`ícode_u8_löked_ïs_bóªr_idítôy
(&
pdn_disc⁄√˘_ªque°
->
lökedïsbóªridítôy
) & 0x0f);

88 
ícoded
++;

90 i‡((
pdn_disc⁄√˘_ªque°
->
¥e£n˚mask
 & 
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

91 =
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
)

93 i‡((
ícode_ªsu…
 =

94 
	`ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(&
pdn_disc⁄√˘_ªque°
->
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
,

95 
PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
, 
buf„r


96 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

98  
ícode_ªsu…
;

100 
ícoded
 +
ícode_ªsu…
;

103  
ícoded
;

104 
	}
}

	@src/esm/msg/PdnDisconnectRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"PrŸocﬁDis¸imö©‹.h
"

34 
	~"EpsBóªrIdítôy.h
"

35 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

36 
	~"MesßgeTy≥.h
"

37 
	~"LökedEpsBóªrIdítôy.h
"

38 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

40 #i‚de‡
PDN_DISCONNECT_REQUEST_H_


41 
	#PDN_DISCONNECT_REQUEST_H_


	)

44 
	#PDN_DISCONNECT_REQUEST_MINIMUM_LENGTH
 ( \

45 
LINKED_EPS_BEARER_IDENTITY_MINIMUM_LENGTH
 )

	)

48 
	#PDN_DISCONNECT_REQUEST_MAXIMUM_LENGTH
 ( \

49 
LINKED_EPS_BEARER_IDENTITY_MAXIMUM_LENGTH
 + \

50 
PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 )

	)

55 
	#PDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_PRESENT
 (1<<0)

	)

57 
	epdn_disc⁄√˘_ªque°_õi_èg
 {

58 
	mPDN_DISCONNECT_REQUEST_PROTOCOL_CONFIGURATION_OPTIONS_IEI
 = 0x27,

59 } 
	tpdn_disc⁄√˘_ªque°_õi
;

68 
	spdn_disc⁄√˘_ªque°_msg_èg
 {

70 
PrŸocﬁDis¸imö©‹
 
	m¥Ÿocﬁdis¸imö©‹
:4;

71 
EpsBóªrIdítôy
 
	mïsbóªridítôy
:4;

72 
Pro˚duªTønß˘i⁄Idítôy
 
	m¥o˚duªå™ß˘i⁄idítôy
;

73 
MesßgeTy≥
 
	mmesßgëy≥
;

74 
LökedEpsBóªrIdítôy
 
	mlökedïsbóªridítôy
;

76 
uöt32_t
 
	m¥e£n˚mask
;

77 
PrŸocﬁC⁄figuøti⁄O±i⁄s
 
	m¥Ÿocﬁc⁄figuøti⁄›ti⁄s
;

78 } 
	tpdn_disc⁄√˘_ªque°_msg
;

80 
decode_pdn_disc⁄√˘_ªque°
(
pdn_disc⁄√˘_ªque°_msg
 *
pdndisc⁄√˘ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

82 
ícode_pdn_disc⁄√˘_ªque°
(
pdn_disc⁄√˘_ªque°_msg
 *
pdndisc⁄√˘ªque°
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/esm_cause.h

47 #i‚de‡
__ESM_CAUSE_H__


48 
	#__ESM_CAUSE_H__


	)

58 
	#ESM_CAUSE_SUCCESS
 (-1)

	)

63 
	#ESM_CAUSE_OPERATOR_DETERMINED_BARRING
 8

	)

64 
	#ESM_CAUSE_INSUFFICIENT_RESOURCES
 26

	)

65 
	#ESM_CAUSE_UNKNOWN_ACCESS_POINT_NAME
 27

	)

66 
	#ESM_CAUSE_UNKNOWN_PDN_TYPE
 28

	)

67 
	#ESM_CAUSE_USER_AUTHENTICATION_FAILED
 29

	)

68 
	#ESM_CAUSE_REQUEST_REJECTED_BY_GW
 30

	)

69 
	#ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
 31

	)

70 
	#ESM_CAUSE_SERVICE_OPTION_NOT_SUPPORTED
 32

	)

71 
	#ESM_CAUSE_REQUESTED_SERVICE_OPTION_NOT_SUBSCRIBED
 33

	)

72 
	#ESM_CAUSE_SERVICE_OPTION_TEMPORARILY_OUT_OF_ORDER
 34

	)

73 
	#ESM_CAUSE_PTI_ALREADY_IN_USE
 35

	)

74 
	#ESM_CAUSE_REGULAR_DEACTIVATION
 36

	)

75 
	#ESM_CAUSE_EPS_QOS_NOT_ACCEPTED
 37

	)

76 
	#ESM_CAUSE_NETWORK_FAILURE
 38

	)

77 
	#ESM_CAUSE_REACTIVATION_REQUESTED
 39

	)

78 
	#ESM_CAUSE_SEMANTIC_ERROR_IN_THE_TFT_OPERATION
 41

	)

79 
	#ESM_CAUSE_SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION
 42

	)

80 
	#ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
 43

	)

81 
	#ESM_CAUSE_SEMANTIC_ERRORS_IN_PACKET_FILTER
 44

	)

82 
	#ESM_CAUSE_SYNTACTICAL_ERROR_IN_PACKET_FILTER
 45

	)

83 
	#ESM_CAUSE_PTI_MISMATCH
 47

	)

84 
	#ESM_CAUSE_LAST_PDN_DISCONNECTION_NOT_ALLOWED
 49

	)

85 
	#ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
 50

	)

86 
	#ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
 51

	)

87 
	#ESM_CAUSE_SINGLE_ADDRESS_BEARERS_ONLY_ALLOWED
 52

	)

88 
	#ESM_CAUSE_ESM_INFORMATION_NOT_RECEIVED
 53

	)

89 
	#ESM_CAUSE_PDN_CONNECTION_DOES_NOT_EXIST
 54

	)

90 
	#ESM_CAUSE_MULTIPLE_PDN_CONNECTIONS_NOT_ALLOWED
 55

	)

91 
	#ESM_CAUSE_COLLISION_WITH_NETWORK_INITIATED_REQUEST
 56

	)

92 
	#ESM_CAUSE_UNSUPPORTED_QCI_VALUE
 59

	)

93 
	#ESM_CAUSE_BEARER_HANDLING_NOT_SUPPORTED
 60

	)

94 
	#ESM_CAUSE_INVALID_PTI_VALUE
 81

	)

95 
	#ESM_CAUSE_APN_RESTRICTION_VALUE_NOT_COMPATIBLE
 112

	)

100 
	#ESM_CAUSE_SEMANTICALLY_INCORRECT
 95

	)

101 
	#ESM_CAUSE_INVALID_MANDATORY_INFO
 96

	)

102 
	#ESM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
 97

	)

103 
	#ESM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
 98

	)

104 
	#ESM_CAUSE_IE_NOT_IMPLEMENTED
 99

	)

105 
	#ESM_CAUSE_CONDITIONAL_IE_ERROR
 100

	)

106 
	#ESM_CAUSE_MESSAGE_NOT_COMPATIBLE
 101

	)

107 
	#ESM_CAUSE_PROTOCOL_ERROR
 111

	)

	@src/esm/msg/esm_msg.c

46 
	~"esm_msg.h
"

47 
	~"comm⁄Def.h
"

48 
	~"«s_log.h
"

50 
	~"TLVDecodî.h
"

51 
	~"TLVEncodî.h
"

53 #i‡((
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

54 
	~"«s_ôti_mesßgög.h
"

65 
_esm_msg_decode_hódî
(
esm_msg_hódî_t
 *
hódî
, c⁄° 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

66 
_esm_msg_ícode_hódî
(c⁄° 
esm_msg_hódî_t
 *
hódî
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

90 
	$esm_msg_decode
(
ESM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

92 
hódî_ªsu…
;

93 
decode_ªsu…
;

95 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

96 
uöt8_t
 *
buf„r_log
 = 
buf„r
;

97 
uöt32_t
 
Àn_log
 = 
Àn
;

98 
down_lök
;

100 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)))

101 
down_lök
 = 0;

103 
down_lök
 = 1;

107 
LOG_FUNC_IN
;

110 
hódî_ªsu…
 = 
	`_esm_msg_decode_hódî
(&
msg
->
hódî
, 
buf„r
, 
Àn
);

111 i‡(
hódî_ªsu…
 < 0) {

112 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - FailedÅo decode ESM message header "

113 "(%d)", 
hódî_ªsu…
);

114 
	`LOG_FUNC_RETURN
(
hódî_ªsu…
);

117 
buf„r
 +
hódî_ªsu…
;

118 
Àn
 -
hódî_ªsu…
;

120 
msg
->
hódî
.
mesßge_ty≥
)

122 
PDN_DISCONNECT_REQUEST
:

123 
decode_ªsu…
 = 
	`decode_pdn_disc⁄√˘_ªque°
(&
msg
->
pdn_disc⁄√˘_ªque°
, 
buf„r
, 
Àn
);

125 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

126 
decode_ªsu…
 = 
	`decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

128 
BEARER_RESOURCE_ALLOCATION_REQUEST
:

129 
decode_ªsu…
 = 
	`decode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(&
msg
->
bóªr_ªsour˚_Æloˇti⁄_ªque°
, 
buf„r
, 
Àn
);

131 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

132 
decode_ªsu…
 = 
	`decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

134 
PDN_CONNECTIVITY_REJECT
:

135 
decode_ªsu…
 = 
	`decode_pdn_c⁄√˘ivôy_ªje˘
(&
msg
->
pdn_c⁄√˘ivôy_ªje˘
, 
buf„r
, 
Àn
);

137 
MODIFY_EPS_BEARER_CONTEXT_REJECT
:

138 
decode_ªsu…
 = 
	`decode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

140 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
:

141 
decode_ªsu…
 = 
	`decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

143 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT
:

144 
decode_ªsu…
 = 
	`decode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

146 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
:

147 
decode_ªsu…
 = 
	`decode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

149 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
:

150 
decode_ªsu…
 = 
	`decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

152 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

153 
decode_ªsu…
 = 
	`decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

155 
MODIFY_EPS_BEARER_CONTEXT_REQUEST
:

156 
decode_ªsu…
 = 
	`decode_modify_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

158 
PDN_DISCONNECT_REJECT
:

159 
decode_ªsu…
 = 
	`decode_pdn_disc⁄√˘_ªje˘
(&
msg
->
pdn_disc⁄√˘_ªje˘
, 
buf„r
, 
Àn
);

161 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
:

162 
decode_ªsu…
 = 
	`decode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

164 
BEARER_RESOURCE_MODIFICATION_REJECT
:

165 
decode_ªsu…
 = 
	`decode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(&
msg
->
bóªr_ªsour˚_modifiˇti⁄_ªje˘
, 
buf„r
, 
Àn
);

167 
BEARER_RESOURCE_ALLOCATION_REJECT
:

168 
decode_ªsu…
 = 
	`decode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(&
msg
->
bóªr_ªsour˚_Æloˇti⁄_ªje˘
, 
buf„r
, 
Àn
);

170 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

171 
decode_ªsu…
 = 
	`decode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

173 
PDN_CONNECTIVITY_REQUEST
:

174 
decode_ªsu…
 = 
	`decode_pdn_c⁄√˘ivôy_ªque°
(&
msg
->
pdn_c⁄√˘ivôy_ªque°
, 
buf„r
, 
Àn
);

176 
ESM_INFORMATION_RESPONSE
:

177 
decode_ªsu…
 = 
	`decode_esm_öf‹m©i⁄_ª•⁄£
(&
msg
->
esm_öf‹m©i⁄_ª•⁄£
, 
buf„r
, 
Àn
);

179 
BEARER_RESOURCE_MODIFICATION_REQUEST
:

180 
decode_ªsu…
 = 
	`decode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(&
msg
->
bóªr_ªsour˚_modifiˇti⁄_ªque°
, 
buf„r
, 
Àn
);

182 
ESM_INFORMATION_REQUEST
:

183 
decode_ªsu…
 = 
	`decode_esm_öf‹m©i⁄_ªque°
(&
msg
->
esm_öf‹m©i⁄_ªque°
, 
buf„r
, 
Àn
);

185 
ESM_STATUS
:

186 
decode_ªsu…
 = 
	`decode_esm_°©us
(&
msg
->
esm_°©us
, 
buf„r
, 
Àn
);

189 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - Unexpected messageÅype: 0x%x",

190 
msg
->
hódî
.
mesßge_ty≥
);

191 
decode_ªsu…
 = 
TLV_DECODE_WRONG_MESSAGE_TYPE
;

195 i‡(
decode_ªsu…
 < 0) {

196 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - FailedÅo decode L3 ESM message 0x%x "

197 "(%u)", 
msg
->
hódî
.
mesßge_ty≥
, 
decode_ªsu…
);

198 
	`LOG_FUNC_RETURN
 (
decode_ªsu…
);

200 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

202 
	`«s_ôti_∂aö_msg
((*Ë
buf„r_log
, (
«s_mesßge_t
 *Ë
msg
, 
Àn_log
, 
down_lök
);

206 
	`LOG_FUNC_RETURN
 (
hódî_ªsu…
 + 
decode_ªsu…
);

207 
	}
}

226 
	$esm_msg_ícode
(
ESM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

228 
LOG_FUNC_IN
;

230 
hódî_ªsu…
;

231 
ícode_ªsu…
;

233 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

234 
uöt8_t
 *
buf„r_log
 = 
buf„r
;

235 
down_lök
;

237 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)))

238 
down_lök
 = 1;

240 
down_lök
 = 0;

245 
hódî_ªsu…
 = 
	`_esm_msg_ícode_hódî
(&
msg
->
hódî
, 
buf„r
, 
Àn
);

246 i‡(
hódî_ªsu…
 < 0) {

247 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - FailedÅoÉncode ESM message header "

248 "(%d)", 
hódî_ªsu…
);

249 
	`LOG_FUNC_RETURN
(
hódî_ªsu…
);

251 
	`LOG_TRACE
(
INFO
, "ESM-MSG - Encoded ESM message header "

252 "(%d)", 
hódî_ªsu…
);

254 
buf„r
 +
hódî_ªsu…
;

255 
Àn
 -
hódî_ªsu…
;

257 
msg
->
hódî
.
mesßge_ty≥
)

259 
PDN_DISCONNECT_REQUEST
:

260 
ícode_ªsu…
 = 
	`ícode_pdn_disc⁄√˘_ªque°
(&
msg
->
pdn_disc⁄√˘_ªque°
, 
buf„r
, 
Àn
);

262 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

263 
ícode_ªsu…
 = 
	`ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

265 
BEARER_RESOURCE_ALLOCATION_REQUEST
:

266 
ícode_ªsu…
 = 
	`ícode_bóªr_ªsour˚_Æloˇti⁄_ªque°
(&
msg
->
bóªr_ªsour˚_Æloˇti⁄_ªque°
, 
buf„r
, 
Àn
);

268 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

269 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

271 
PDN_CONNECTIVITY_REJECT
:

272 
ícode_ªsu…
 = 
	`ícode_pdn_c⁄√˘ivôy_ªje˘
(&
msg
->
pdn_c⁄√˘ivôy_ªje˘
, 
buf„r
, 
Àn
);

274 
MODIFY_EPS_BEARER_CONTEXT_REJECT
:

275 
ícode_ªsu…
 = 
	`ícode_modify_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

277 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
:

278 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

280 
MODIFY_EPS_BEARER_CONTEXT_ACCEPT
:

281 
ícode_ªsu…
 = 
	`ícode_modify_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

283 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
:

284 
ícode_ªsu…
 = 
	`ícode_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

286 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
:

287 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
, 
buf„r
, 
Àn
);

289 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

290 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
, 
buf„r
, 
Àn
);

292 
MODIFY_EPS_BEARER_CONTEXT_REQUEST
:

293 
ícode_ªsu…
 = 
	`ícode_modify_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
modify_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

295 
PDN_DISCONNECT_REJECT
:

296 
ícode_ªsu…
 = 
	`ícode_pdn_disc⁄√˘_ªje˘
(&
msg
->
pdn_disc⁄√˘_ªje˘
, 
buf„r
, 
Àn
);

298 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
:

299 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

301 
BEARER_RESOURCE_MODIFICATION_REJECT
:

302 
ícode_ªsu…
 = 
	`ícode_bóªr_ªsour˚_modifiˇti⁄_ªje˘
(&
msg
->
bóªr_ªsour˚_modifiˇti⁄_ªje˘
, 
buf„r
, 
Àn
);

304 
BEARER_RESOURCE_ALLOCATION_REJECT
:

305 
ícode_ªsu…
 = 
	`ícode_bóªr_ªsour˚_Æloˇti⁄_ªje˘
(&
msg
->
bóªr_ªsour˚_Æloˇti⁄_ªje˘
, 
buf„r
, 
Àn
);

307 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

308 
ícode_ªsu…
 = 
	`ícode_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(&
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
, 
buf„r
, 
Àn
);

310 
PDN_CONNECTIVITY_REQUEST
:

311 
ícode_ªsu…
 = 
	`ícode_pdn_c⁄√˘ivôy_ªque°
(&
msg
->
pdn_c⁄√˘ivôy_ªque°
, 
buf„r
, 
Àn
);

313 
ESM_INFORMATION_RESPONSE
:

314 
ícode_ªsu…
 = 
	`ícode_esm_öf‹m©i⁄_ª•⁄£
(&
msg
->
esm_öf‹m©i⁄_ª•⁄£
, 
buf„r
, 
Àn
);

316 
BEARER_RESOURCE_MODIFICATION_REQUEST
:

317 
ícode_ªsu…
 = 
	`ícode_bóªr_ªsour˚_modifiˇti⁄_ªque°
(&
msg
->
bóªr_ªsour˚_modifiˇti⁄_ªque°
, 
buf„r
, 
Àn
);

319 
ESM_INFORMATION_REQUEST
:

320 
ícode_ªsu…
 = 
	`ícode_esm_öf‹m©i⁄_ªque°
(&
msg
->
esm_öf‹m©i⁄_ªque°
, 
buf„r
, 
Àn
);

322 
ESM_STATUS
:

323 
ícode_ªsu…
 = 
	`ícode_esm_°©us
(&
msg
->
esm_°©us
, 
buf„r
, 
Àn
);

326 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - Unexpected messageÅype: 0x%x",

327 
msg
->
hódî
.
mesßge_ty≥
);

328 
ícode_ªsu…
 = 
TLV_ENCODE_WRONG_MESSAGE_TYPE
;

332 i‡(
ícode_ªsu…
 < 0) {

333 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - FailedÅoÉncode L3 ESM message 0x%x "

334 "(%d)", 
msg
->
hódî
.
mesßge_ty≥
, 
ícode_ªsu…
);

336 #i‡((
	`deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)Ë|| (deföed(
ENABLE_NAS_UE_LOGGING
Ë&& deföed(
UE_BUILD
Ë&& deföed(
NAS_UE
)))

337 
	`«s_ôti_∂aö_msg
((*Ë
buf„r_log
, (
«s_mesßge_t
 *Ë
msg
, 
hódî_ªsu…
 + 
ícode_ªsu…
, 
down_lök
);

341 
	`LOG_FUNC_RETURN
 (
hódî_ªsu…
 + 
ícode_ªsu…
);

342 
	}
}

368 
	$_esm_msg_decode_hódî
(
esm_msg_hódî_t
 *
hódî
,

369 c⁄° 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

371 
size
 = 0;

374 i‡(
Àn
 < (
esm_msg_hódî_t
)) {

375  (
TLV_DECODE_BUFFER_TOO_SHORT
);

379 
	`DECODE_U8
(
buf„r
 + 
size
, *(
uöt8_t
*)(
hódî
), size);

381 
	`DECODE_U8
(
buf„r
 + 
size
, 
hódî
->
¥o˚duª_å™ß˘i⁄_idítôy
, size);

383 
	`DECODE_U8
(
buf„r
 + 
size
, 
hódî
->
mesßge_ty≥
, size);

386 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 !
EPS_SESSION_MANAGEMENT_MESSAGE
)

388 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - UnexpectedÖrotocol discriminator: 0x%x",

389 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

390  (
TLV_DECODE_PROTOCOL_NOT_SUPPORTED
);

393  (
size
);

394 
	}
}

414 
	$_esm_msg_ícode_hódî
(c⁄° 
esm_msg_hódî_t
 *
hódî
,

415 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
)

417 
size
 = 0;

420 i‡(
Àn
 < (
esm_msg_hódî_t
)) {

421 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - bufferÅoo short");

422  (
TLV_ENCODE_BUFFER_TOO_SHORT
);

425 i‡(
hódî
->
¥Ÿocﬁ_dis¸imö©‹
 !
EPS_SESSION_MANAGEMENT_MESSAGE
) {

426 
	`LOG_TRACE
(
ERROR
, "ESM-MSG - UnexpectedÖrotocol discriminator: 0x%x",

427 
hódî
->
¥Ÿocﬁ_dis¸imö©‹
);

428  (
TLV_ENCODE_PROTOCOL_NOT_SUPPORTED
);

432 
	`ENCODE_U8
(
buf„r
 + 
size
, *(
uöt8_t
*)(
hódî
), size);

434 
	`ENCODE_U8
(
buf„r
 + 
size
, 
hódî
->
¥o˚duª_å™ß˘i⁄_idítôy
, size);

436 
	`ENCODE_U8
(
buf„r
 + 
size
, 
hódî
->
mesßge_ty≥
, size);

438  (
size
);

439 
	}
}

	@src/esm/msg/esm_msg.h

46 #i‚de‡
__ESM_MSG_H__


47 
	#__ESM_MSG_H__


	)

49 
	~"esm_msgDef.h
"

51 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReque°.h
"

52 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtAc˚±.h
"

53 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReje˘.h
"

54 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReque°.h
"

55 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtAc˚±.h
"

56 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReje˘.h
"

57 
	~"ModifyEpsBóªrC⁄ãxtReque°.h
"

58 
	~"ModifyEpsBóªrC⁄ãxtAc˚±.h
"

59 
	~"ModifyEpsBóªrC⁄ãxtReje˘.h
"

60 
	~"Dó˘iv©eEpsBóªrC⁄ãxtReque°.h
"

61 
	~"Dó˘iv©eEpsBóªrC⁄ãxtAc˚±.h
"

62 
	~"PdnDisc⁄√˘Reque°.h
"

63 
	~"PdnDisc⁄√˘Reje˘.h
"

64 
	~"PdnC⁄√˘ivôyReque°.h
"

65 
	~"PdnC⁄√˘ivôyReje˘.h
"

66 
	~"BóªrResour˚AŒoˇti⁄Reque°.h
"

67 
	~"BóªrResour˚AŒoˇti⁄Reje˘.h
"

68 
	~"BóªrResour˚Modifiˇti⁄Reque°.h
"

69 
	~"BóªrResour˚Modifiˇti⁄Reje˘.h
"

70 
	~"EsmInf‹m©i⁄Reque°.h
"

71 
	~"EsmInf‹m©i⁄Re•⁄£.h
"

72 
	~"EsmSètus.h
"

74 
	~<°döt.h
>

89 
esm_msg_hódî_t
 
	mhódî
;

90 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 
	ma˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
;

91 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 
	ma˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
;

92 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 
	ma˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
;

93 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 
	ma˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
;

94 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 
	ma˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
;

95 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 
	ma˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
;

96 
modify_ïs_bóªr_c⁄ãxt_ªque°_msg
 
	mmodify_ïs_bóªr_c⁄ãxt_ªque°
;

97 
modify_ïs_bóªr_c⁄ãxt_ac˚±_msg
 
	mmodify_ïs_bóªr_c⁄ãxt_ac˚±
;

98 
modify_ïs_bóªr_c⁄ãxt_ªje˘_msg
 
	mmodify_ïs_bóªr_c⁄ãxt_ªje˘
;

99 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 
	mdó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
;

100 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 
	mdó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
;

101 
pdn_c⁄√˘ivôy_ªque°_msg
 
	mpdn_c⁄√˘ivôy_ªque°
;

102 
pdn_c⁄√˘ivôy_ªje˘_msg
 
	mpdn_c⁄√˘ivôy_ªje˘
;

103 
pdn_disc⁄√˘_ªque°_msg
 
	mpdn_disc⁄√˘_ªque°
;

104 
pdn_disc⁄√˘_ªje˘_msg
 
	mpdn_disc⁄√˘_ªje˘
;

105 
bóªr_ªsour˚_Æloˇti⁄_ªque°_msg
 
	mbóªr_ªsour˚_Æloˇti⁄_ªque°
;

106 
bóªr_ªsour˚_Æloˇti⁄_ªje˘_msg
 
	mbóªr_ªsour˚_Æloˇti⁄_ªje˘
;

107 
bóªr_ªsour˚_modifiˇti⁄_ªque°_msg
 
	mbóªr_ªsour˚_modifiˇti⁄_ªque°
;

108 
bóªr_ªsour˚_modifiˇti⁄_ªje˘_msg
 
	mbóªr_ªsour˚_modifiˇti⁄_ªje˘
;

109 
esm_öf‹m©i⁄_ªque°_msg
 
	mesm_öf‹m©i⁄_ªque°
;

110 
esm_öf‹m©i⁄_ª•⁄£_msg
 
	mesm_öf‹m©i⁄_ª•⁄£
;

111 
esm_°©us_msg
 
	mesm_°©us
;

112 } 
	tESM_msg
;

123 
esm_msg_decode
(
ESM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

125 
esm_msg_ícode
(
ESM_msg
 *
msg
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

	@src/esm/msg/esm_msgDef.h

44 #i‚de‡
__ESM_MSGDEF_H__


45 
	#__ESM_MSGDEF_H__


	)

47 
	~<°döt.h
>

48 
	~<asm/byã‹dî.h
>

55 
	#ESM_HEADER_LENGTH
 (
esm_msg_hódî_t
)

	)

56 
	#ESM_HEADER_MINIMUM_LENGTH
 
ESM_HEADER_LENGTH


	)

57 
	#ESM_HEADER_MAXIMUM_LENGTH
 
ESM_HEADER_LENGTH


	)

60 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
 0b11000001

	)

61 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
 0b11000010

	)

62 
	#ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
 0b11000011

	)

63 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
 0b11000101

	)

64 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
 0b11000110

	)

65 
	#ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
 0b11000111

	)

66 
	#MODIFY_EPS_BEARER_CONTEXT_REQUEST
 0b11001001

	)

67 
	#MODIFY_EPS_BEARER_CONTEXT_ACCEPT
 0b11001010

	)

68 
	#MODIFY_EPS_BEARER_CONTEXT_REJECT
 0b11001011

	)

69 
	#DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
 0b11001101

	)

70 
	#DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
 0b11001110

	)

71 
	#PDN_CONNECTIVITY_REQUEST
 0b11010000

	)

72 
	#PDN_CONNECTIVITY_REJECT
 0b11010001

	)

73 
	#PDN_DISCONNECT_REQUEST
 0b11010010

	)

74 
	#PDN_DISCONNECT_REJECT
 0b11010011

	)

75 
	#BEARER_RESOURCE_ALLOCATION_REQUEST
 0b11010100

	)

76 
	#BEARER_RESOURCE_ALLOCATION_REJECT
 0b11010101

	)

77 
	#BEARER_RESOURCE_MODIFICATION_REQUEST
 0b11010110

	)

78 
	#BEARER_RESOURCE_MODIFICATION_REJECT
 0b11010111

	)

79 
	#ESM_INFORMATION_REQUEST
 0b11011001

	)

80 
	#ESM_INFORMATION_RESPONSE
 0b11011010

	)

81 
	#ESM_STATUS
 0b11101000

	)

100 #ifde‡
__LITTLE_ENDIAN_BITFIELD


101 
uöt8_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

102 
uöt8_t
 
	mïs_bóªr_idítôy
:4;

104 #ifde‡
__BIG_ENDIAN_BITFIELD


105 
uöt8_t
 
	mïs_bóªr_idítôy
:4;

106 
uöt8_t
 
	m¥Ÿocﬁ_dis¸imö©‹
:4;

108 
uöt8_t
 
	m¥o˚duª_å™ß˘i⁄_idítôy
;

109 
uöt8_t
 
	mmesßge_ty≥
;

110 }
	t__©åibuã__
((
	t__∑cked__
)Ë
	tesm_msg_hódî_t
;

	@src/esm/sap/esm_recv.c

48 
	~"esm_ªcv.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 
	~"esm_±.h
"

53 
	~"esm_ebr.h
"

54 
	~"esm_¥oc.h
"

56 
	~"esm_ˇu£.h
"

57 #ifde‡
NAS_MME


58 
	~"«s_ôti_mesßgög.h
"

60 #ifde‡
NAS_UE


61 
	~<°dlib.h
>

62 
	~<°rög.h
>

100 #ifde‡
NAS_UE


101 
	$esm_ªcv_°©us
(
±i
, 
ebi
, c⁄° 
esm_°©us_msg
 *
msg
)

103 #ifde‡
NAS_MME


104 
	$esm_ªcv_°©us
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

105 c⁄° 
esm_°©us_msg
 *
msg
)

108 
esm_ˇu£
;

109 
rc
;

111 
LOG_FUNC_IN
;

113 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received ESM status message (pti=%d,Ébi=%d)",

114 
±i
, 
ebi
);

120 
esm_ˇu£
 = 
msg
->
esmˇu£
;

123 #ifde‡
NAS_UE


124 
rc
 = 
	`esm_¥oc_°©us_öd
(
±i
, 
ebi
, &
esm_ˇu£
);

126 #ifde‡
NAS_MME


127 
rc
 = 
	`esm_¥oc_°©us_öd
(
˘x
, 
±i
, 
ebi
, &
esm_ˇu£
);

129 i‡(
rc
 !
RETURNîr‹
) {

130 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

134 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

135 
	}
}

142 #ifde‡
NAS_UE


160 
	$esm_ªcv_pdn_c⁄√˘ivôy_ªje˘
(
±i
, 
ebi
,

161 c⁄° 
pdn_c⁄√˘ivôy_ªje˘_msg
 *
msg
)

163 
LOG_FUNC_IN
;

165 
esm_ˇu£
;

167 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received PDN Connectivity Reject message "

168 "’ti=%d,Ébi=%d, cau£=%d)", 
±i
, 
ebi
, 
msg
->
esmˇu£
);

173 i‡–(
±i
 =
ESM_PT_UNASSIGNED
Ë|| 
	`esm_±_is_ª£rved
(pti) ) {

177 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

178 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

179 } i‡–
	`esm_±_is_nŸ_ö_u£
(
±i
) ) {

183 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - PTI mism©ch (±i=%d)", 
±i
);

184 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PTI_MISMATCH
);

189 i‡–(
ebi
 !
ESM_EBI_UNASSIGNED
Ë|| 
	`esm_ebr_is_ª£rved
(ebi) ) {

192 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

193 
ebi
);

194 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

201 
esm_ˇu£
 = 
msg
->
esmˇu£
;

204 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
(
±i
, &
esm_ˇu£
);

205 i‡(
rc
 !
RETURNîr‹
) {

206 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

210 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

211 
	}
}

230 
	$esm_ªcv_pdn_disc⁄√˘_ªje˘
(
±i
, 
ebi
,

231 c⁄° 
pdn_disc⁄√˘_ªje˘_msg
 *
msg
)

233 
LOG_FUNC_IN
;

235 
esm_ˇu£
;

237 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received PDN Disconnect Reject message "

238 "’ti=%d,Ébi=%d, cau£=%d)", 
±i
, 
ebi
, 
msg
->
esmˇu£
);

243 i‡–(
±i
 =
ESM_PT_UNASSIGNED
Ë|| 
	`esm_±_is_ª£rved
(pti) ) {

247 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

248 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

249 } i‡–
	`esm_±_is_nŸ_ö_u£
(
±i
) ) {

253 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - PTI mism©ch (±i=%d)", 
±i
);

254 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PTI_MISMATCH
);

259 i‡–(
ebi
 !
ESM_EBI_UNASSIGNED
Ë|| 
	`esm_ebr_is_ª£rved
(ebi) ) {

262 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

263 
ebi
);

264 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

271 
esm_ˇu£
 = 
msg
->
esmˇu£
;

274 
rc
 = 
	`esm_¥oc_pdn_disc⁄√˘_ªje˘
(
±i
, &
esm_ˇu£
);

275 i‡(
rc
 !
RETURNîr‹
) {

276 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

280 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

281 
	}
}

301 
	$esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

302 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
)

304 
LOG_FUNC_IN
;

306 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

308 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Default EPS Bearer Context "

309 "Reque° mesßgê’ti=%d,Ébi=%d)", 
±i
, 
ebi
);

314 i‡–(
±i
 =
ESM_PT_UNASSIGNED
Ë|| 
	`esm_±_is_ª£rved
(pti) ) {

318 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

319 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

320 } i‡–
	`esm_±_is_nŸ_ö_u£
(
±i
) ) {

324 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - PTI mism©ch (±i=%d)", 
±i
);

325 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PTI_MISMATCH
);

330 i‡–(
ebi
 =
ESM_EBI_UNASSIGNED
Ë|| 
	`esm_ebr_is_ª£rved
(ebi) ) {

334 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

335 
ebi
);

336 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

342 
esm_¥oc_qos_t
 
qos
 = {-1, -1, -1, -1, -1};

344 i‡(
msg
->
ïsqos
.
bôR©esExtPª£¡
) {

345 
qos
.
mbrUL
 =

346 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
maxBôR©eF‹UL
);

347 
qos
.
mbrDL
 =

348 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
maxBôR©eF‹DL
);

349 } i‡(
msg
->
ïsqos
.
bôR©esPª£¡
) {

350 
qos
.
mbrUL
 =

351 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
maxBôR©eF‹UL
);

352 
qos
.
mbrDL
 =

353 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
maxBôR©eF‹DL
);

356 i‡(
msg
->
ïsqos
.
bôR©esExtPª£¡
) {

357 
qos
.
gbrUL
 =

358 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
gu¨BôR©eF‹UL
);

359 
qos
.
gbrDL
 =

360 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
gu¨BôR©eF‹DL
);

361 } i‡(
msg
->
ïsqos
.
bôR©esPª£¡
) {

362 
qos
.
gbrUL
 =

363 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹UL
);

364 
qos
.
gbrDL
 =

365 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹DL
);

368 
qos
.
qci
 = 
msg
->
ïsqos
.qci;

370 
pdn_ty≥
 = -1;

371 i‡(
msg
->
pd«ddªss
.
pd¡y≥vÆue
 =
PDN_VALUE_TYPE_IPV4
) {

372 
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4
;

373 } i‡(
msg
->
pd«ddªss
.
pd¡y≥vÆue
 =
PDN_VALUE_TYPE_IPV6
) {

374 
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV6
;

375 } i‡(
msg
->
pd«ddªss
.
pd¡y≥vÆue
 =
PDN_VALUE_TYPE_IPV4V6
) {

376 
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4V6
;

379 i‡(
msg
->
¥e£n˚mask
 &

380 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
) {

383 
esm_ˇu£
 = 
msg
->
esmˇu£
;

387 
pid
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_ac˚±
(
±i
, 
pdn_ty≥
,

388 &
msg
->
pd«ddªss
.
pd«ddªssöf‹m©i⁄
,

389 &
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
,

390 &
esm_ˇu£
);

392 i‡(
pid
 !
RETURNîr‹
) {

394 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
pid
, 
ebi
, &
qos
,

395 &
esm_ˇu£
);

396 i‡(
rc
 !
RETURNîr‹
) {

397 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

402 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

403 
	}
}

423 
	$esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

424 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
)

426 
LOG_FUNC_IN
;

428 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

429 
i
;

430 
j
;

432 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Dedicated EPS Bearer "

433 "C⁄ãxàReque° mesßgê’ti=%d,Ébi=%d)", 
±i
, 
ebi
);

438 i‡–
	`esm_±_is_ª£rved
(
±i
) ) {

442 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

443 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

444 } i‡–(
±i
 !
ESM_PT_UNASSIGNED
Ë&& 
	`esm_±_is_nŸ_ö_u£
(pti) ) {

448 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - PTI mism©ch (±i=%d)", 
±i
);

449 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PTI_MISMATCH
);

454 i‡–(
ebi
 =
ESM_EBI_UNASSIGNED
Ë|| 
	`esm_ebr_is_ª£rved
(ebi) ) {

458 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

459 
ebi
);

460 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

465 i‡(
msg
->
t·
.
t·›î©i⁄code
 !
TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
) {

469 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_SEMANTIC_ERROR_IN_THE_TFT_OPERATION
);

470 } i‡(
msg
->
t·
.
numbîoÂackëfûãrs
 == 0) {

474 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION
);

481 
esm_¥oc_qos_t
 
qos
 = {-1, -1, -1, -1, -1};

483 i‡(
msg
->
ïsqos
.
bôR©esExtPª£¡
) {

484 
qos
.
mbrUL
 =

485 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
maxBôR©eF‹UL
);

486 
qos
.
mbrDL
 =

487 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
maxBôR©eF‹DL
);

488 } i‡(
msg
->
ïsqos
.
bôR©esPª£¡
) {

489 
qos
.
mbrUL
 =

490 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
maxBôR©eF‹UL
);

491 
qos
.
mbrDL
 =

492 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
maxBôR©eF‹DL
);

495 i‡(
msg
->
ïsqos
.
bôR©esExtPª£¡
) {

496 
qos
.
gbrUL
 =

497 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
gu¨BôR©eF‹UL
);

498 
qos
.
gbrDL
 =

499 
	`ïs_qos_bô_øã_ext_vÆue
(
msg
->
ïsqos
.
bôR©esExt
.
gu¨BôR©eF‹DL
);

500 } i‡(
msg
->
ïsqos
.
bôR©esPª£¡
) {

501 
qos
.
gbrUL
 =

502 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹UL
);

503 
qos
.
gbrDL
 =

504 
	`ïs_qos_bô_øã_vÆue
(
msg
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹DL
);

507 
qos
.
qci
 = 
msg
->
ïsqos
.qci;

510 
esm_¥oc_t·_t
 
t·
 = {0, {
NULL
}};

512 c⁄° 
PackëFûãrs
 *
pkfs
 = &(
msg
->
t·
.
∑ckëfûãæi°
.
¸óãt·
);

513 
i
 = 0; i < 
msg
->
t·
.
numbîoÂackëfûãrs
; i++) {

515 
t·
.
pkf
[
i
] = (
√tw‹k_pkf_t
 *)
	`mÆloc
((network_pkf_t));

516 i‡(
t·
.
pkf
[
i
] !
NULL
) {

518 
	`mem£t
(
t·
.
pkf
[
i
], 0, (
√tw‹k_pkf_t
));

520 
t·
.
n_pkfs
 += 1;

522 
t·
.
pkf
[
i
]->
id
 = 
pkfs
[i]->
idítifõr
;

524 
t·
.
pkf
[
i
]->
dú
 = 
pkfs
[i]->
dúe˘i⁄
;

526 
t·
.
pkf
[
i
]->
¥e˚dí˚
 = 
pkfs
[i]->
evÆ_¥e˚dí˚
;

529 c⁄° 
PackëFûãr
 *
pkf
 = &(
pkfs
[
i
]->
∑ckëfûãr
);

530 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
) {

532 
j
 = 0;

533 (
j
 < 
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
)

534 && (
j
 < 
NET_PACKET_FILTER_IPV4_ADDR_SIZE
); j++) {

535 
t·
.
pkf
[
i
]->
d©a
.
ùv4
.
addr
[
j
] =Ökf->
ùv4ªmŸóddr
[j].addr;

536 
t·
.
pkf
[
i
]->
d©a
.
ùv4
.
mask
[
j
] =Ökf->
ùv4ªmŸóddr
[j].mask;

538 } i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR_FLAG
) {

540 
j
 = 0;

541 (
j
 < 
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
)

542 && (
j
 < 
NET_PACKET_FILTER_IPV6_ADDR_SIZE
); j++) {

543 
t·
.
pkf
[
i
]->
d©a
.
ùv6
.
addr
[
j
] =Ökf->
ùv6ªmŸóddr
[j].addr;

544 
t·
.
pkf
[
i
]->
d©a
.
ùv6
.
mask
[
j
] =Ökf->
ùv6ªmŸóddr
[j].mask;

547 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
) {

549 
t·
.
pkf
[
i
]->
d©a
.
ùv4
.
¥Ÿocﬁ
 =

550 
pkf
->
¥Ÿocﬁidítifõr_√xthódî
;

552 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
) {

554 
t·
.
pkf
[
i
]->
Õ‹t
 =Ökf->
sögÀloˇÕ‹t
;

555 } i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE_FLAG
) {

558 
t·
.
pkf
[
i
]->
Õ‹t
 =Ökf->
loˇÕ‹å™ge
.
lowlimô
;

560 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
) {

562 
t·
.
pkf
[
i
]->
Ω‹t
 =Ökf->
sögÀªmŸï‹t
;

563 } i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE_FLAG
) {

566 
t·
.
pkf
[
i
]->
Ω‹t
 =Ökf->
ªmŸï‹å™ge
.
lowlimô
;

568 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX
) {

570 
t·
.
pkf
[
i
]->
d©a
.
ùv6
.
ù£c
 =Ökf->
£curôy∑ømëîödex
;

572 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS
) {

574 
t·
.
pkf
[
i
]->
d©a
.
ùv4
.
tos
 =

575 
pkf
->
typdeof£rvi˚_åaffic˛ass
.
vÆue
;

577 i‡(
pkf
->
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL
) {

579 
t·
.
pkf
[
i
]->
d©a
.
ùv6
.
Ê
 =Ökf->
Êowœbñ
;

585 
rc
 = 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
ebi
,

586 
msg
->
lökedïsbóªridítôy
,

587 &
qos
, &
t·
, &
esm_ˇu£
);

588 i‡(
rc
 !
RETURNîr‹
) {

589 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

592 
i
 = 0; i < 
t·
.
n_pkfs
; i++) {

593 
	`‰ì
(
t·
.
pkf
[
i
]);

596 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

597 
	}
}

616 
	$esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

617 c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
)

619 
LOG_FUNC_IN
;

621 
rc
 = 
RETURNok
;

622 
esm_ˇu£
;

624 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Deactivate EPS Bearer Context "

625 "Reque° mesßgê’ti=%d,Ébi=%d)", 
±i
, 
ebi
);

630 i‡–
	`esm_±_is_ª£rved
(
±i
) ) {

634 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

635 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

636 } i‡–
	`esm_±_is_nŸ_ö_u£
(
±i
) ) {

640 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - PTI mism©ch (±i=%d)", 
±i
);

641 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PTI_MISMATCH
);

646 i‡–(
ebi
 =
ESM_EBI_UNASSIGNED
Ë|| 
	`esm_ebr_is_ª£rved
(ebi) ||

647 
	`esm_ebr_is_nŸ_ö_u£
(
ebi
) ) {

652 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

653 
ebi
);

656 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

663 
esm_ˇu£
 = 
msg
->
esmˇu£
;

666 i‡(
±i
 !
ESM_PT_UNASSIGNED
) {

667 
rc
 = 
	`esm_¥oc_pdn_disc⁄√˘_ac˚±
(
±i
, &
esm_ˇu£
);

670 i‡(
rc
 !
RETURNîr‹
) {

672 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
(
ebi
, &
esm_ˇu£
);

673 i‡(
rc
 !
RETURNîr‹
) {

674 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

679 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

680 
	}
}

688 #ifde‡
NAS_MME


708 
	$esm_ªcv_pdn_c⁄√˘ivôy_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

709 c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
 *
msg
,

710 *
√w_ebi
, *
d©a
)

712 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

714 
LOG_FUNC_IN
;

716 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received PDN Connectivity Request message "

717 "(ueid=%u,Öti=%d,Ébi=%d)", 
˘x
->
ueid
, 
±i
, 
ebi
);

722 i‡–(
±i
 =
ESM_PT_UNASSIGNED
Ë|| 
	`esm_±_is_ª£rved
(pti) ) {

726 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

727 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

732 i‡–
ebi
 !
ESM_EBI_UNASSIGNED
 ) {

735 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

736 
ebi
);

737 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

744 
esm_¥oc_d©a_t
 *
esm_d©a
 = (esm_¥oc_d©a_à*)(
d©a
);

745 i‡(
d©a
 =
NULL
) {

746 
	`LOG_TRACE
(
ERROR
, "ESM-SAP - Invalid ESM data structure");

747 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_PROTOCOL_ERROR
);

750 
ªque°_ty≥
 = -1;

751 i‡(
msg
->
ªque°ty≥
 =
REQUEST_TYPE_INITIAL_REQUEST
) {

752 
ªque°_ty≥
 = 
ESM_PDN_REQUEST_INITIAL
;

753 } i‡(
msg
->
ªque°ty≥
 =
REQUEST_TYPE_HANDOVER
) {

754 
ªque°_ty≥
 = 
ESM_PDN_REQUEST_HANDOVER
;

755 } i‡(
msg
->
ªque°ty≥
 =
REQUEST_TYPE_EMERGENCY
) {

756 
ªque°_ty≥
 = 
ESM_PDN_REQUEST_EMERGENCY
;

759 
	`LOG_TRACE
(
ERROR
, "ESM-SAP - Invalid PDNÑequestÅype");

760 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_MANDATORY_INFO
);

763 i‡(
msg
->
pd¡y≥
 =
PDN_TYPE_IPV4
) {

764 
esm_d©a
->
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4
;

765 } i‡(
msg
->
pd¡y≥
 =
PDN_TYPE_IPV6
) {

766 
esm_d©a
->
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV6
;

767 } i‡(
msg
->
pd¡y≥
 =
PDN_TYPE_IPV4V6
) {

768 
esm_d©a
->
pdn_ty≥
 = 
ESM_PDN_TYPE_IPV4V6
;

771 
	`LOG_TRACE
(
ERROR
, "ESM-SAP - Invalid PDNÅype");

772 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_UNKNOWN_PDN_TYPE
);

776 i‡(
msg
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
) {

777 
esm_d©a
->
≠n
 = 
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
;

781 i‡(
msg
->
¥e£n˚mask
 &

782 
PDN_CONNECTIVITY_REQUEST_ESM_INFORMATION_TRANSFER_FLAG_PRESENT
) {

797 #i‡
	`deföed
(
ORIGINAL_CODE
)

799 
pid
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_ªque°
(
˘x
, 
±i
, 
ªque°_ty≥
,

800 &
esm_d©a
->
≠n
,

801 
esm_d©a
->
pdn_ty≥
,

802 &
esm_d©a
->
pdn_addr
,

803 &
esm_d©a
->
qos
,

804 &
esm_ˇu£
);

806 i‡(
pid
 !
RETURNîr‹
) {

808 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt
(
˘x
, 
pid
, 
√w_ebi
,

809 &
esm_d©a
->
qos
, &
esm_ˇu£
);

810 i‡(
rc
 !
RETURNîr‹
) {

811 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

815 
is_emîgícy
 = (
ªque°_ty≥
 =
ESM_PDN_REQUEST_EMERGENCY
);

817 
	`«s_ôti_pdn_c⁄√˘ivôy_ªq
(

818 
±i
,

819 
˘x
->
ueid
,

820 
˘x
->
imsi
,

821 
esm_d©a
,

822 
ªque°_ty≥
);

823 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

826 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

827 
	}
}

849 
	$esm_ªcv_pdn_disc⁄√˘_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

850 c⁄° 
pdn_disc⁄√˘_ªque°_msg
 *
msg
,

851 *
löked_ebi
)

853 
LOG_FUNC_IN
;

855 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

857 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received PDN Disconnect Request message "

858 "(ueid=%d,Öti=%d,Ébi=%d)", 
˘x
->
ueid
, 
±i
, 
ebi
);

863 i‡–(
±i
 =
ESM_PT_UNASSIGNED
Ë|| 
	`esm_±_is_ª£rved
(pti) ) {

867 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

868 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

873 i‡–
ebi
 !
ESM_EBI_UNASSIGNED
 ) {

876 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

877 
ebi
);

878 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

885 
pid
 = 
	`esm_¥oc_pdn_disc⁄√˘_ªque°
(
˘x
, 
±i
, &
esm_ˇu£
);

886 i‡(
pid
 !
RETURNîr‹
) {

889 *
löked_ebi
 = 
msg
->
lökedïsbóªridítôy
;

891 
bid
 = 0;

892 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
˘x
, 
FALSE
,

893 *
löked_ebi
,

894 &
pid
, &
bid
, &
esm_ˇu£
);

895 i‡(
rc
 !
RETURNîr‹
) {

896 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

901 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

902 
	}
}

923 
	$esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

924 
±i
, 
ebi
,

925 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

927 
LOG_FUNC_IN
;

929 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

931 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Default EPS Bearer Context "

932 "Ac˚± mesßgê(ueid=%d,Öti=%d,Ébi=%d)", 
˘x
->
ueid
, 
±i
, 
ebi
);

937 i‡(
	`esm_±_is_ª£rved
(
±i
)) {

941 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

942 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

947 i‡–
	`esm_ebr_is_ª£rved
(
ebi
Ë|| 
	`esm_ebr_is_nŸ_ö_u£
(
˘x
,Ébi) ) {

952 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

953 
ebi
);

954 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

961 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
˘x
, 
ebi
, &
esm_ˇu£
);

962 i‡(
rc
 !
RETURNîr‹
) {

963 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

967 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

968 
	}
}

989 
	$esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

990 
±i
, 
ebi
,

991 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
)

993 
LOG_FUNC_IN
;

995 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

997 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Default EPS Bearer Context "

998 "Reje˘ mesßgê(ueid=%d,Öti=%d,Ébi=%d)", 
˘x
->
ueid
, 
±i
, 
ebi
);

1003 i‡(
	`esm_±_is_ª£rved
(
±i
)) {

1007 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

1008 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

1013 i‡–
	`esm_ebr_is_ª£rved
(
ebi
Ë|| 
	`esm_ebr_is_nŸ_ö_u£
(
˘x
,Ébi) ) {

1018 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

1019 
ebi
);

1020 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

1027 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
˘x
, 
ebi
, &
esm_ˇu£
);

1028 i‡(
rc
 !
RETURNîr‹
) {

1029 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1033 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

1034 
	}
}

1055 
	$esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

1056 
±i
, 
ebi
,

1057 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

1059 
LOG_FUNC_IN
;

1061 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1063 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Dedicated EPS Bearer "

1065 
˘x
->
ueid
, 
±i
, 
ebi
);

1070 i‡(
	`esm_±_is_ª£rved
(
±i
)) {

1074 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

1075 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

1080 i‡–
	`esm_ebr_is_ª£rved
(
ebi
Ë|| 
	`esm_ebr_is_nŸ_ö_u£
(
˘x
,Ébi) ) {

1085 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

1086 
ebi
);

1087 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

1094 
rc
 = 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
˘x
, 
ebi
,

1095 &
esm_ˇu£
);

1096 i‡(
rc
 !
RETURNîr‹
) {

1097 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1101 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

1102 
	}
}

1123 
	$esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

1124 
±i
, 
ebi
,

1125 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
)

1127 
LOG_FUNC_IN
;

1129 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1131 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Activate Dedicated EPS Bearer "

1133 
˘x
->
ueid
, 
±i
, 
ebi
);

1138 i‡(
	`esm_±_is_ª£rved
(
±i
)) {

1142 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

1143 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

1148 i‡–
	`esm_ebr_is_ª£rved
(
ebi
Ë|| 
	`esm_ebr_is_nŸ_ö_u£
(
˘x
,Ébi) ) {

1153 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

1154 
ebi
);

1155 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

1162 
rc
 = 
	`esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
˘x
, 
ebi
,

1163 &
esm_ˇu£
);

1164 i‡(
rc
 !
RETURNîr‹
) {

1165 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1169 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

1170 
	}
}

1190 
	$esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

1191 
±i
, 
ebi
,

1192 c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

1194 
LOG_FUNC_IN
;

1196 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1198 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Received Deactivate EPS Bearer Context "

1199 "Ac˚± mesßgê(ueid=%d,Öti=%d,Ébi=%d)", 
˘x
->
ueid
, 
±i
, 
ebi
);

1204 i‡(
	`esm_±_is_ª£rved
(
±i
)) {

1208 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - InvÆid PTI vÆuê’ti=%d)", 
±i
);

1209 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_PTI_VALUE
);

1214 i‡–
	`esm_ebr_is_ª£rved
(
ebi
Ë|| 
	`esm_ebr_is_nŸ_ö_u£
(
˘x
,Ébi) ) {

1219 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Invalid EPS bearer identity (ebi=%d)",

1220 
ebi
);

1221 
	`LOG_FUNC_RETURN
 (
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
);

1228 
pid
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
(
˘x
, 
ebi
,

1229 &
esm_ˇu£
);

1230 i‡(
pid
 !
RETURNîr‹
) {

1232 
rc
 = 
	`esm_¥oc_pdn_disc⁄√˘_ac˚±
(
˘x
, 
pid
, &
esm_ˇu£
);

1234 i‡(
rc
 !
RETURNîr‹
) {

1235 
esm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

1240 
	`LOG_FUNC_RETURN
 (
esm_ˇu£
);

1241 
	}
}

	@src/esm/sap/esm_recv.h

47 #i‚de‡
__ESM_RECV_H__


48 
	#__ESM_RECV_H__


	)

50 
	~"EsmSètus.h
"

51 
	~"emmD©a.h
"

53 #ifde‡
NAS_UE


54 
	~"PdnC⁄√˘ivôyReje˘.h
"

55 
	~"PdnDisc⁄√˘Reje˘.h
"

56 
	~"BóªrResour˚AŒoˇti⁄Reje˘.h
"

57 
	~"BóªrResour˚Modifiˇti⁄Reje˘.h
"

59 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReque°.h
"

60 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReque°.h
"

61 
	~"ModifyEpsBóªrC⁄ãxtReque°.h
"

62 
	~"Dó˘iv©eEpsBóªrC⁄ãxtReque°.h
"

64 
	~"EsmInf‹m©i⁄Reque°.h
"

67 #ifde‡
NAS_MME


68 
	~"PdnC⁄√˘ivôyReque°.h
"

69 
	~"PdnDisc⁄√˘Reque°.h
"

70 
	~"BóªrResour˚AŒoˇti⁄Reque°.h
"

71 
	~"BóªrResour˚Modifiˇti⁄Reque°.h
"

73 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtAc˚±.h
"

74 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReje˘.h
"

75 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtAc˚±.h
"

76 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReje˘.h
"

77 
	~"ModifyEpsBóªrC⁄ãxtAc˚±.h
"

78 
	~"ModifyEpsBóªrC⁄ãxtReje˘.h
"

79 
	~"Dó˘iv©eEpsBóªrC⁄ãxtAc˚±.h
"

81 
	~"EsmInf‹m©i⁄Re•⁄£.h
"

105 #ifde‡
NAS_UE


106 
esm_ªcv_°©us
(
±i
, 
ebi
, c⁄° 
esm_°©us_msg
 *
msg
);

108 #ifde‡
NAS_MME


109 
esm_ªcv_°©us
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

110 c⁄° 
esm_°©us_msg
 *
msg
);

118 #ifde‡
NAS_UE


123 
esm_ªcv_pdn_c⁄√˘ivôy_ªje˘
(
±i
, 
ebi
,

124 c⁄° 
pdn_c⁄√˘ivôy_ªje˘_msg
 *
msg
);

126 
esm_ªcv_pdn_disc⁄√˘_ªje˘
(
±i
, 
ebi
,

127 c⁄° 
pdn_disc⁄√˘_ªje˘_msg
 *
msg
);

133 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

134 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
);

136 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

137 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
);

139 
esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

140 c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
);

148 #ifde‡
NAS_MME


153 
esm_ªcv_pdn_c⁄√˘ivôy_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

154 c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
 *
msg
, *
√w_ebi
, *
d©a
);

156 
esm_ªcv_pdn_disc⁄√˘_ªque°
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
, 
ebi
,

157 c⁄° 
pdn_disc⁄√˘_ªque°_msg
 *
msg
,

158 *
löked_ebi
);

164 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

165 
±i
, 
ebi
, c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

167 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

168 
±i
, 
ebi
, c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
);

170 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

171 
±i
, 
ebi
, c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

173 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
emm_d©a_c⁄ãxt_t
 *
˘x
,

174 
±i
, 
ebi
, c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
);

176 
esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
emm_d©a_c⁄ãxt_t
 *
˘x
, 
±i
,

177 
ebi
, c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

	@src/esm/sap/esm_sap.c

48 
	~"esm_ßp.h
"

49 
	~"esm_ªcv.h
"

50 
	~"esm_£nd.h
"

51 
	~"comm⁄Def.h
"

52 
	~"«s_log.h
"

54 
	~"O˘ëSåög.h
"

55 
	~"TLVDecodî.h
"

56 
	~"esm_msgDef.h
"

57 
	~"esm_msg.h
"

59 
	~"esm_ˇu£.h
"

60 
	~"esm_¥oc.h
"

62 
	~<°rög.h
>

63 
	~<as£π.h
>

73 #ifde‡
NAS_UE


74 
_esm_ßp_ªcv
(
msg_ty≥
, 
is_°™dÆ⁄e
,

75 c⁄° 
O˘ëSåög
 *
ªq
, O˘ëSåög *
r•
, 
esm_ßp_îr‹_t
 *
îr
);

76 
_esm_ßp_£nd
(
msg_ty≥
, 
is_°™dÆ⁄e
, 
±i
, 
ebi
,

77 c⁄° 
esm_ßp_d©a_t
 *
d©a
, 
O˘ëSåög
 *
r•
);

80 #ifde‡
NAS_MME


81 
_esm_ßp_ªcv
(
msg_ty≥
, 
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

82 c⁄° 
O˘ëSåög
 *
ªq
, O˘ëSåög *
r•
, 
esm_ßp_îr‹_t
 *
îr
);

83 
_esm_ßp_£nd
(
msg_ty≥
, 
is_°™dÆ⁄e
, 
emm_d©a_c⁄ãxt_t
 *
˘x
,

84 
±i
, 
ebi
, c⁄° 
esm_ßp_d©a_t
 *
d©a
, 
O˘ëSåög
 *
r•
);

90 c⁄° *
	g_esm_ßp_¥imôive_°r
[] = {

117 
	#ESM_SAP_BUFFER_SIZE
 4096

	)

118 
	g_esm_ßp_buf„r
[
ESM_SAP_BUFFER_SIZE
];

138 
	$esm_ßp_öôülize
()

140 
LOG_FUNC_IN
;

145 
LOG_FUNC_OUT
;

146 
	}
}

162 
	$esm_ßp_£nd
(
esm_ßp_t
 *
msg
)

164 
LOG_FUNC_IN
;

166 
rc
 = 
RETURNîr‹
;

167 
pid
;

170 
esm_¥imôive_t
 
¥imôive
 = 
msg
->primitive;

171 
	`as£π
–(
¥imôive
 > 
ESM_START
Ë&& (¥imôivê< 
ESM_END
));

173 
	`LOG_TRACE
(
INFO
, "ESM-SAP - ReceivedÖrimitive %s (%d)",

174 
_esm_ßp_¥imôive_°r
[
¥imôive
 - 
ESM_START
 - 1],Örimitive);

176 
¥imôive
) {

177 
ESM_PDN_CONNECTIVITY_REQ
:

178 #ifde‡
NAS_UE


180 
esm_pdn_c⁄√˘ivôy_t
 *
pdn_c⁄√˘
 = &
msg
->
d©a
.pdn_connect;

181 i‡–!
msg
->
is_°™dÆ⁄e
 || !
pdn_c⁄√˘
->
is_deföed
 ) {

182 
O˘ëSåög
 
≠n
 = {0, 
NULL
};

183 i‡(
pdn_c⁄√˘
->
≠n
) {

184 
≠n
.
Àngth
 = 
	`°æí
(
pdn_c⁄√˘
->apn);

185 
≠n
.
vÆue
 = (
uöt8_t
 *)
pdn_c⁄√˘
->apn;

188 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy
(
pdn_c⁄√˘
->
cid
, 
TRUE
,

189 
pdn_c⁄√˘
->
pdn_ty≥
, &
≠n
,

190 
pdn_c⁄√˘
->
is_emîgícy
, 
NULL
);

191 i‡–
msg
->
is_°™dÆ⁄e
 || (
rc
 !
RETURNok
) ) {

195 i‡(
pdn_c⁄√˘
->
is_deföed
) {

196 
±i
;

198 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy
(
pdn_c⁄√˘
->
cid
, 
TRUE
,

199 
pdn_c⁄√˘
->
pdn_ty≥
, 
NULL
,

200 
pdn_c⁄√˘
->
is_emîgícy
, &
±i
);

201 i‡(
rc
 !
RETURNîr‹
) {

203 
rc
 = 
	`_esm_ßp_£nd
(
PDN_CONNECTIVITY_REQUEST
,

204 
msg
->
is_°™dÆ⁄e
,

205 
±i
, 
EPS_BEARER_IDENTITY_UNASSIGNED
,

206 &
msg
->
d©a
, &msg->
£nd
);

211 #ifde‡
NAS_MME


213 
rc
 = 
	`_esm_ßp_ªcv
(
PDN_CONNECTIVITY_REQUEST
, 
msg
->
is_°™dÆ⁄e
,

214 
msg
->
˘x
, msg->
ªcv
, &msg->
£nd
, &msg->
îr
);

218 
ESM_PDN_CONNECTIVITY_REJ
:

219 #ifde‡
NAS_MME


221 
pid
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
(
msg
->
˘x
);

222 i‡(
pid
 !
RETURNîr‹
) {

223 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
msg
->
˘x
, 
pid
);

226 #ifde‡
NAS_UE


228 
esm_pdn_c⁄√˘ivôy_t
 *
pdn_c⁄√˘
 = &
msg
->
d©a
.pdn_connect;

229 i‡–
msg
->
is_°™dÆ⁄e
 && 
pdn_c⁄√˘
->
is_deföed
 ) {

231 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy
(
pdn_c⁄√˘
->
cid
, 
FALSE
,

232 
pdn_c⁄√˘
->
pdn_ty≥
, 
NULL
,

233 
pdn_c⁄√˘
->
is_emîgícy
, 
NULL
);

234 } i‡(
msg
->
ªcv
 !
NULL
) {

236 
rc
 = 
	`_esm_ßp_ªcv
(
PDN_CONNECTIVITY_REJECT
, 
msg
->
is_°™dÆ⁄e
,

237 
msg
->
ªcv
, &msg->
£nd
, &msg->
îr
);

240 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
TRUE
);

246 
ESM_PDN_DISCONNECT_REQ
:

247 #ifde‡
NAS_UE


249 
±i
, 
ebi
;

253 
rc
 = 
	`esm_¥oc_pdn_disc⁄√˘
(
msg
->
d©a
.
pdn_disc⁄√˘
.
cid
,

254 &
±i
, &
ebi
);

255 i‡(
rc
 !
RETURNîr‹
) {

257 
rc
 = 
	`_esm_ßp_£nd
(
PDN_DISCONNECT_REQUEST
, 
TRUE
, 
±i
, 
ebi
,

258 &
msg
->
d©a
, &msg->
£nd
);

264 
ESM_PDN_DISCONNECT_REJ
:

267 
ESM_BEARER_RESOURCE_ALLOCATE_REQ
:

270 
ESM_BEARER_RESOURCE_ALLOCATE_REJ
:

273 
ESM_BEARER_RESOURCE_MODIFY_REQ
:

276 
ESM_BEARER_RESOURCE_MODIFY_REJ
:

279 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REQ
:

280 #ifde‡
NAS_UE


282 
rc
 = 
	`_esm_ßp_ªcv
(
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
,

283 
msg
->
is_°™dÆ⁄e
,

284 
msg
->
ªcv
, &msg->
£nd
, &msg->
îr
);

288 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_CNF
:

289 #ifde‡
NAS_MME


291 
rc
 = 
	`_esm_ßp_ªcv
(
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
,

292 
msg
->
is_°™dÆ⁄e
, msg->
˘x
,

293 
msg
->
ªcv
, &msg->
£nd
, &msg->
îr
);

295 #ifde‡
NAS_UE


300 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_com∂ëe
();

301 i‡(
rc
 !
RETURNîr‹
) {

302 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_com∂ëe
();

307 
ESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REJ
:

308 #ifde‡
NAS_MME


310 
rc
 = 
	`_esm_ßp_ªcv
(
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
,

311 
msg
->
is_°™dÆ⁄e
, msg->
˘x
,

312 
msg
->
ªcv
, &msg->
£nd
, &msg->
îr
);

314 #ifde‡
NAS_UE


318 
rc
 = 
	`esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_Áûuª
();

319 i‡(
rc
 !
RETURNîr‹
) {

320 
rc
 = 
	`esm_¥oc_pdn_c⁄√˘ivôy_Áûuª
(
FALSE
);

325 
ESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_REQ
:

328 
ESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_CNF
:

331 
ESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_REJ
:

334 
ESM_EPS_BEARER_CONTEXT_MODIFY_REQ
:

337 
ESM_EPS_BEARER_CONTEXT_MODIFY_CNF
:

340 
ESM_EPS_BEARER_CONTEXT_MODIFY_REJ
:

343 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
: {

344 
bid
;

348 #ifde‡
NAS_UE


349 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
TRUE
,

350 
msg
->
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
, &
pid
, &
bid
);

352 #ifde‡
NAS_MME


353 
rc
 = 
	`esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e
(
msg
->
˘x
, 
TRUE
,

354 
msg
->
d©a
.
ïs_bóªr_c⁄ãxt_dó˘iv©e
.
ebi
,

355 &
pid
, &
bid
, 
NULL
);

360 
ESM_EPS_BEARER_CONTEXT_DEACTIVATE_CNF
:

363 
ESM_UNITDATA_IND
:

364 #ifde‡
NAS_UE


365 
rc
 = 
	`_esm_ßp_ªcv
(-1, 
msg
->
is_°™dÆ⁄e
, msg->
ªcv
,

366 &
msg
->
£nd
, &msg->
îr
);

368 #ifde‡
NAS_MME


369 
rc
 = 
	`_esm_ßp_ªcv
(-1, 
msg
->
is_°™dÆ⁄e
, msg->
˘x
,

370 
msg
->
ªcv
, &msg->
£nd
, &msg->
îr
);

378 #ifde‡
NAS_MME


379 i‡(
rc
 !
RETURNok
) {

380 
	`LOG_TRACE
(
ERROR
, "ESM-SAP - FailedÅoÖrocessÖrimitive %s (%d)",

381 
_esm_ßp_¥imôive_°r
[
¥imôive
 - 
ESM_START
 - 1],Örimitive);

385 
	`LOG_FUNC_RETURN
 (
rc
);

386 
	}
}

422 
_esm_ßp_ªcv
(
msg_ty≥
, 
is_°™dÆ⁄e
,

423 #ifde‡
NAS_MME


424 
emm_d©a_c⁄ãxt_t
 *
˘x
,

426 c⁄° 
O˘ëSåög
 *
ªq
, O˘ëSåög *
r•
,

427 
esm_ßp_îr‹_t
 *
îr
)

429 
esm_¥oc_¥o˚duª_t
 
	gesm_¥o˚duª
 = 
NULL
;

430 
	gesm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

431 
	grc
 = 
RETURNîr‹
;

432 
	gdecodî_rc
;

434 
ESM_msg
 
	gesm_msg
;

436 
	gLOG_FUNC_IN
;

438 
mem£t
(&
esm_msg
, 0 , (
ESM_msg
));

441 
	gdecodî_rc
 = 
esm_msg_decode
(&
esm_msg
, 
ªq
->
vÆue
,Ñeq->
Àngth
);

444 i‡(
	gdecodî_rc
 < 0) {

448 i‡(
	gdecodî_rc
 =
TLV_DECODE_BUFFER_TOO_SHORT
) {

449 
LOG_TRACE
(
WARNING
, "ESM-SAP - Discard messageÅoo shortÅo "

452 *
	gîr
 = 
ESM_SAP_DISCARDED
;

453 
LOG_FUNC_RETURN
 (
RETURNok
);

457 i‡(
	gdecodî_rc
 =
TLV_DECODE_WRONG_MESSAGE_TYPE
) {

458 
esm_ˇu£
 = 
ESM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
;

462 i‡(
	gdecodî_rc
 =
TLV_DECODE_UNEXPECTED_IEI
) {

463 
esm_ˇu£
 = 
ESM_CAUSE_CONDITIONAL_IE_ERROR
;

465 
	gesm_ˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

469 i‡–(
	gmsg_ty≥
 > 0Ë&& (msg_ty≥ !
esm_msg
.
hódî
.
mesßge_ty≥
) ) {

470 i‡(
esm_msg
.
hódî
.
mesßge_ty≥
 !
ESM_STATUS
) {

472 
LOG_TRACE
(
ERROR
, "ESM-SAP - Received ESM message 0x%x isÇot "

474 
esm_msg
.
hódî
.
mesßge_ty≥
, 
msg_ty≥
);

475 
	gesm_ˇu£
 = 
ESM_CAUSE_SEMANTICALLY_INCORRECT
;

480 
	g±i
 = 
esm_msg
.
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
;

482 
	gebi
 = 
esm_msg
.
hódî
.
ïs_bóªr_idítôy
;

486 
	gåiggîed_by_ue
 = (
±i
 !
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
);

488 
	gis_disˇrded
 = 
FALSE
;

490 i‡(
	gesm_ˇu£
 !
ESM_CAUSE_SUCCESS
) {

491 
LOG_TRACE
(
ERROR
, "ESM-SAP - FailedÅo decodeÉxpected ESM message "

492 "0x%x", 
msg_ty≥
);

495 
	gesm_msg
.
	ghódî
.
	gmesßge_ty≥
) {

496 #ifde‡
NAS_UE


497 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

502 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

503 
±i
, 
ebi
,

504 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
);

506 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_SUCCESS
) ||

507 (
esm_ˇu£
 =
ESM_CAUSE_PTI_ALREADY_IN_USE
) ) {

509 
rc
 = 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

510 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
);

513 
	gesm_¥o˚duª
 = 
esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
;

514 i‡(
	gesm_ˇu£
 =
ESM_CAUSE_PTI_ALREADY_IN_USE
) {

520 
is_disˇrded
 = 
TRUE
;

524 
	grc
 = 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

525 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
,

526 
esm_ˇu£
);

529 
	gesm_¥o˚duª
 = 
esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
;

533 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
:

538 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(

539 
±i
, 
ebi
,

540 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
);

542 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_SUCCESS
) ||

543 (
esm_ˇu£
 =
ESM_CAUSE_PTI_ALREADY_IN_USE
) ) {

545 
rc
 = 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

546 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
);

549 
	gesm_¥o˚duª
 = 
esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
;

550 i‡(
	gesm_ˇu£
 =
ESM_CAUSE_PTI_ALREADY_IN_USE
) {

556 
is_disˇrded
 = 
TRUE
;

560 
	grc
 = 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

561 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
,

562 
esm_ˇu£
);

565 
	gesm_¥o˚duª
 = 
esm_¥oc_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
;

569 
	gMODIFY_EPS_BEARER_CONTEXT_REQUEST
:

572 
	gDEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
:

577 
esm_ˇu£
 = 
esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

578 &
esm_msg
.
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
);

580 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

581 (
esm_ˇu£
 =
ESM_CAUSE_PTI_MISMATCH
) ) {

587 
is_disˇrded
 = 
TRUE
;

588 } i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_SUCCESS
) ||

589 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

591 
rc
 = 
esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

592 &
esm_msg
.
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
);

595 
	gesm_¥o˚duª
 = 
esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ac˚±
;

596 i‡(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) {

602 
is_disˇrded
 = 
TRUE
;

607 
	gPDN_CONNECTIVITY_REJECT
:

611 
esm_ˇu£
 = 
esm_ªcv_pdn_c⁄√˘ivôy_ªje˘
(
±i
, 
ebi
,

612 &
esm_msg
.
pdn_c⁄√˘ivôy_ªje˘
);

614 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

615 (
esm_ˇu£
 =
ESM_CAUSE_PTI_MISMATCH
) ||

616 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

625 
is_disˇrded
 = 
TRUE
;

629 
	gPDN_DISCONNECT_REJECT
:

633 
esm_ˇu£
 = 
esm_ªcv_pdn_disc⁄√˘_ªje˘
(
±i
, 
ebi
,

634 &
esm_msg
.
pdn_disc⁄√˘_ªje˘
);

636 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

637 (
esm_ˇu£
 =
ESM_CAUSE_PTI_MISMATCH
) ||

638 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

647 
is_disˇrded
 = 
TRUE
;

651 
	gBEARER_RESOURCE_ALLOCATION_REJECT
:

654 
	gBEARER_RESOURCE_MODIFICATION_REJECT
:

657 
	gESM_INFORMATION_REQUEST
:

660 
	gESM_STATUS
:

664 
esm_ˇu£
 = 
esm_ªcv_°©us
(
±i
, 
ebi
, &
esm_msg
.
esm_°©us
);

668 #ifde‡
NAS_MME


669 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

674 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(

675 
˘x
, 
±i
, 
ebi
,

676 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
);

678 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

679 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

686 
is_disˇrded
 = 
TRUE
;

690 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

695 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(

696 
˘x
, 
±i
, 
ebi
,

697 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
);

699 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

700 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

707 
is_disˇrded
 = 
TRUE
;

711 
	gDEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

716 
esm_ˇu£
 = 
esm_ªcv_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(

717 
˘x
, 
±i
, 
ebi
,

718 &
esm_msg
.
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
);

720 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

721 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

728 
is_disˇrded
 = 
TRUE
;

732 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
:

737 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(

738 
˘x
, 
±i
, 
ebi
,

739 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
);

741 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

742 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

749 
is_disˇrded
 = 
TRUE
;

753 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
:

758 
esm_ˇu£
 = 
esm_ªcv_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(

759 
˘x
, 
±i
, 
ebi
,

760 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
);

762 i‡–(
	gesm_ˇu£
 =
ESM_CAUSE_INVALID_PTI_VALUE
) ||

763 (
esm_ˇu£
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) ) {

770 
is_disˇrded
 = 
TRUE
;

774 
	gMODIFY_EPS_BEARER_CONTEXT_ACCEPT
:

777 
	gMODIFY_EPS_BEARER_CONTEXT_REJECT
:

780 
	gPDN_CONNECTIVITY_REQUEST
: {

781 
esm_¥oc_d©a_t
 
d©a
;

782 
mem£t
(&
d©a
, 0, (
esm_¥oc_d©a_t
));

784 
LOG_TRACE
(
DEBUG
, "ESM-SAP - PDN_CONNECTIVITY_REQUESTÖtò%uÉbò%u", 
±i
, 
ebi
);

789 
	gesm_ˇu£
 = 
esm_ªcv_pdn_c⁄√˘ivôy_ªque°
(
˘x
, 
±i
, 
ebi
,

790 &
esm_msg
.
pdn_c⁄√˘ivôy_ªque°
,

791 &
ebi
, &
d©a
);

793 i‡(
	gesm_ˇu£
 !
ESM_CAUSE_SUCCESS
) {

795 
rc
 = 
esm_£nd_pdn_c⁄√˘ivôy_ªje˘
(
±i
,

796 &
esm_msg
.
pdn_c⁄√˘ivôy_ªje˘
, 
esm_ˇu£
);

799 
	gesm_¥o˚duª
 = 
esm_¥oc_pdn_c⁄√˘ivôy_ªje˘
;

801 
	gesm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

803 #i‡
deföed
(
ORIGINAL_CODE
)

805 
	gpdn_ty≥
 = -1;

806 i‡(
	gd©a
.
	gpdn_ty≥
 =
ESM_PDN_TYPE_IPV4
) {

807 
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV4
;

808 } i‡(
	gd©a
.
	gpdn_ty≥
 =
ESM_PDN_TYPE_IPV6
) {

809 
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV6
;

810 } i‡(
	gd©a
.
	gpdn_ty≥
 =
ESM_PDN_TYPE_IPV4V6
) {

811 
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV4V6
;

814 
EpsQuÆôyOfSîvi˚
 
	gqos
;

815 
	gqos
.
	gbôR©esPª£¡
 = 1;

816 
	gqos
.
	gbôR©esExtPª£¡
 = 0;

817 
	gqos
.
	gqci
 = 
d©a
.
qos
.
qci
;

818 
	gqos
.
	gbôR©es
.
	gmaxBôR©eF‹UL
 = 
d©a
.
qos
.
mbrUL
;

819 
	gqos
.
	gbôR©es
.
	gmaxBôR©eF‹DL
 = 
d©a
.
qos
.
mbrDL
;

820 
	gqos
.
	gbôR©es
.
	ggu¨BôR©eF‹UL
 = 
d©a
.
qos
.
gbrUL
;

821 
	gqos
.
	gbôR©es
.
	ggu¨BôR©eF‹DL
 = 
d©a
.
qos
.
gbrDL
;

824 
	grc
 = 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

825 
±i
, 
ebi
,

826 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
,

827 &
d©a
.
≠n
, 
pdn_ty≥
, &d©a.
pdn_addr
, &
qos
, 
esm_ˇu£
);

829 
PackëFûãrs
 
	gpkfs
;

830 
	gpkfs
[0].
	gidítifõr
 = 1;

831 
	gpkfs
[0].
	gdúe˘i⁄
 = 
TRAFFIC_FLOW_TEMPLATE_DOWNLINK_ONLY
;

832 
	gpkfs
[0].
	gevÆ_¥e˚dí˚
 = 2;

833 
	gpkfs
[0].
	g∑ckëfûãr
.
	gÊags
 =

834 (
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
 |

835 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
 |

836 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
 |

837 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
);

838 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[0].
	gaddr
 = 192;

839 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[1].
	gaddr
 = 168;

840 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[2].
	gaddr
 = 12;

841 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[3].
	gaddr
 = 1;

842 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[0].
	gmask
 = 255;

843 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[1].
	gmask
 = 255;

844 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[2].
	gmask
 = 255;

845 
	gpkfs
[0].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[3].
	gmask
 = 0;

846 
	gpkfs
[0].
	g∑ckëfûãr
.
	g¥Ÿocﬁidítifõr_√xthódî
 = 17;

847 
	gpkfs
[0].
	g∑ckëfûãr
.
	gsögÀloˇÕ‹t
 = 10001;

848 
	gpkfs
[0].
	g∑ckëfûãr
.
	gsögÀªmŸï‹t
 = 12001;

849 
	gpkfs
[1].
	gidítifõr
 = 2;

850 
	gpkfs
[1].
	gdúe˘i⁄
 = 
TRAFFIC_FLOW_TEMPLATE_UPLINK_ONLY
;

851 
	gpkfs
[1].
	gevÆ_¥e˚dí˚
 = 3;

852 
	gpkfs
[1].
	g∑ckëfûãr
.
	gÊags
 =

853 (
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
 |

854 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
 |

855 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
 |

856 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
);

857 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[0].
	gaddr
 = 192;

858 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[1].
	gaddr
 = 168;

859 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[2].
	gaddr
 = 12;

860 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[3].
	gaddr
 = 1;

861 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[0].
	gmask
 = 255;

862 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[1].
	gmask
 = 255;

863 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[2].
	gmask
 = 255;

864 
	gpkfs
[1].
	g∑ckëfûãr
.
	gùv4ªmŸóddr
[3].
	gmask
 = 0;

865 
	gpkfs
[1].
	g∑ckëfûãr
.
	g¥Ÿocﬁidítifõr_√xthódî
 = 17;

866 
	gpkfs
[1].
	g∑ckëfûãr
.
	gsögÀloˇÕ‹t
 = 10002;

867 
	gpkfs
[1].
	g∑ckëfûãr
.
	gsögÀªmŸï‹t
 = 12002;

869 
	grc
 = 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(

870 
±i
, 
ebi
,

871 &
esm_msg
.
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
,

872 
ebi
, &
qos
, &
pkfs
, 2);

874 
	gesm_¥o˚duª
 = 
esm_¥oc_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
;

876 
	gesm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

887 
	gPDN_DISCONNECT_REQUEST
:

891 
esm_ˇu£
 = 
esm_ªcv_pdn_disc⁄√˘_ªque°
(
˘x
, 
±i
, 
ebi
,

892 &
esm_msg
.
pdn_disc⁄√˘_ªque°
, &
ebi
);

894 i‡(
	gesm_ˇu£
 !
ESM_CAUSE_SUCCESS
) {

896 
rc
 = 
esm_£nd_pdn_disc⁄√˘_ªje˘
(
±i
,

897 &
esm_msg
.
pdn_disc⁄√˘_ªje˘
, 
esm_ˇu£
);

900 
	gesm_¥o˚duª
 = 
esm_¥oc_pdn_disc⁄√˘_ªje˘
;

902 
	gesm_ˇu£
 = 
ESM_CAUSE_SUCCESS
;

905 
	grc
 = 
esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

906 &
esm_msg
.
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
,

907 
ESM_CAUSE_REGULAR_DEACTIVATION
);

910 
	gesm_¥o˚duª
 = 
esm_¥oc_ïs_bóªr_c⁄ãxt_dó˘iv©e_ªque°
;

914 
	gBEARER_RESOURCE_ALLOCATION_REQUEST
:

917 
	gBEARER_RESOURCE_MODIFICATION_REQUEST
:

920 
	gESM_INFORMATION_RESPONSE
:

923 
	gESM_STATUS
:

927 
esm_ˇu£
 = 
esm_ªcv_°©us
(
˘x
, 
±i
, 
ebi
, &
esm_msg
.
esm_°©us
);

932 
LOG_TRACE
(
WARNING
, "ESM-SAP - Received unexpected ESM message "

933 "0x%x", 
esm_msg
.
hódî
.
mesßge_ty≥
);

934 
	gesm_ˇu£
 = 
ESM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
;

938 i‡–(
	gesm_ˇu£
 !
ESM_CAUSE_SUCCESS
Ë&& (
esm_¥o˚duª
 =
NULL
) ) {

940 i‡(!
is_disˇrded
) {

943 
LOG_TRACE
(
WARNING
, "ESM-SAP - Received ESM message isÇot valid "

944 "(ˇu£=%d)", 
esm_ˇu£
);

946 
	grc
 = 
esm_£nd_°©us
(
±i
, 
ebi
, &
esm_msg
.
esm_°©us
, 
esm_ˇu£
);

949 
	gesm_¥o˚duª
 = 
esm_¥oc_°©us
;

951 
	gis_disˇrded
 = 
TRUE
;

955 *
	gîr
 = 
ESM_SAP_SUCCESS
;

956 
	grc
 = 
RETURNok
;

959 i‡–(
	grc
 !
RETURNîr‹
Ë&& (
esm_¥o˚duª
 !
NULL
) ) {

961 
size
 = 
esm_msg_ícode
(&
esm_msg
, (
uöt8_t
 *)
_esm_ßp_buf„r
,

962 
ESM_SAP_BUFFER_SIZE
);

963 i‡(
	gsize
 > 0) {

964 
	gr•
->
	gÀngth
 = 
size
;

965 
	gr•
->
	gvÆue
 = (
uöt8_t
 *)(
_esm_ßp_buf„r
);

968 #ifde‡
NAS_UE


969 
	grc
 = (*
esm_¥o˚duª
)(
is_°™dÆ⁄e
, 
	gebi
, 
	gr•
, 
	gåiggîed_by_ue
);

971 #ifde‡
NAS_MME


972 
	grc
 = (*
esm_¥o˚duª
)(
is_°™dÆ⁄e
, 
	g˘x
, 
	gebi
, 
	gr•
, 
	gåiggîed_by_ue
);

974 i‡(
	gis_disˇrded
) {

976 *
	gîr
 = 
ESM_SAP_DISCARDED
;

977 } i‡(
	grc
 !
RETURNok
) {

979 *
îr
 = 
ESM_SAP_FAILED
;

981 } i‡(
	gis_disˇrded
) {

982 
LOG_TRACE
(
WARNING
, "ESM-SAP - Silently discard messageÅype 0x%x",

983 
esm_msg
.
hódî
.
mesßge_ty≥
);

985 *
	gîr
 = 
ESM_SAP_DISCARDED
;

986 
	grc
 = 
RETURNok
;

989 
LOG_FUNC_RETURN
(
rc
);

1015 
_esm_ßp_£nd
(
msg_ty≥
, 
is_°™dÆ⁄e
,

1016 #ifde‡
NAS_MME


1017 
emm_d©a_c⁄ãxt_t
 *
˘x
,

1019 
±i
, 
ebi
, c⁄° 
esm_ßp_d©a_t
 *
d©a
,

1020 
O˘ëSåög
 *
r•
)

1022 
	gLOG_FUNC_IN
;

1024 
esm_¥oc_¥o˚duª_t
 
	gesm_¥o˚duª
 = 
NULL
;

1025 
	grc
 = 
RETURNok
;

1028 #ifde‡
NAS_UE


1029 
	g£¡_by_ue
 = 
TRUE
;

1031 #ifde‡
NAS_MME


1032 
	g£¡_by_ue
 = 
FALSE
;

1035 
ESM_msg
 
	gesm_msg
;

1036 
mem£t
(&
esm_msg
, 0 , (
ESM_msg
));

1039 
	gmsg_ty≥
) {

1040 #ifde‡
NAS_UE


1041 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

1044 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

1047 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
:

1050 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
:

1053 
	gMODIFY_EPS_BEARER_CONTEXT_ACCEPT
:

1056 
	gMODIFY_EPS_BEARER_CONTEXT_REJECT
:

1059 
	gDEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

1062 
	gPDN_CONNECTIVITY_REQUEST
: {

1066 c⁄° 
esm_pdn_c⁄√˘ivôy_t
 *
msg
 = &
d©a
->
pdn_c⁄√˘
;

1067 
	grc
 = 
esm_£nd_pdn_c⁄√˘ivôy_ªque°
(
±i
, 
msg
->
is_emîgícy
,

1068 
msg
->
pdn_ty≥
, msg->
≠n
,

1069 &
esm_msg
.
pdn_c⁄√˘ivôy_ªque°
);

1072 
	gesm_¥o˚duª
 = 
esm_¥oc_pdn_c⁄√˘ivôy_ªque°
;

1076 
	gPDN_DISCONNECT_REQUEST
:

1080 
rc
 = 
esm_£nd_pdn_disc⁄√˘_ªque°
(
±i
, 
ebi
,

1081 &
esm_msg
.
pdn_disc⁄√˘_ªque°
);

1084 
	gesm_¥o˚duª
 = 
esm_¥oc_pdn_disc⁄√˘_ªque°
;

1087 
	gBEARER_RESOURCE_ALLOCATION_REQUEST
:

1090 
	gBEARER_RESOURCE_MODIFICATION_REQUEST
:

1094 #ifde‡
NAS_MME


1095 
	gACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

1098 
	gACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
:

1101 
	gMODIFY_EPS_BEARER_CONTEXT_REQUEST
:

1104 
	gDEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
:

1107 
	gPDN_CONNECTIVITY_REJECT
:

1110 
	gPDN_DISCONNECT_REJECT
:

1113 
	gBEARER_RESOURCE_ALLOCATION_REJECT
:

1116 
	gBEARER_RESOURCE_MODIFICATION_REJECT
:

1120 
LOG_TRACE
(
WARNING
, "ESM-SAP - Send unexpected ESM message 0x%x",

1121 
msg_ty≥
);

1125 i‡(
	grc
 !
RETURNîr‹
) {

1127 
size
 = 
esm_msg_ícode
(&
esm_msg
, (
uöt8_t
 *)
_esm_ßp_buf„r
,

1128 
ESM_SAP_BUFFER_SIZE
);

1130 i‡(
	gsize
 > 0) {

1131 
	gr•
->
	gÀngth
 = 
size
;

1132 
	gr•
->
	gvÆue
 = (
uöt8_t
 *)(
_esm_ßp_buf„r
);

1135 i‡(
	gesm_¥o˚duª
) {

1136 #ifde‡
NAS_UE


1137 
	grc
 = (*
esm_¥o˚duª
)(
is_°™dÆ⁄e
, 
	g±i
, 
	gr•
, 
	g£¡_by_ue
);

1139 #ifde‡
NAS_MME


1140 
	grc
 = (*
esm_¥o˚duª
)(
is_°™dÆ⁄e
, 
	g˘x
, 
	g±i
, 
	gr•
, 
	g£¡_by_ue
);

1145 
LOG_FUNC_RETURN
(
rc
);

	@src/esm/sap/esm_sap.h

47 #i‚de‡
__ESM_SAP_H__


48 
	#__ESM_SAP_H__


	)

50 
	~"esm_ßpDef.h
"

68 
esm_ßp_öôülize
();

70 
esm_ßp_£nd
(
esm_ßp_t
 *
msg
);

	@src/esm/sap/esm_sapDef.h

47 
	~"emmD©a.h
"

49 #i‚de‡
__ESM_SAPDEF_H__


50 
	#__ESM_SAPDEF_H__


	)

52 
	~"O˘ëSåög.h
"

63 
	mESM_START
 = 0,

65 
	mESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REQ
,

66 
	mESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_CNF
,

67 
	mESM_DEFAULT_EPS_BEARER_CONTEXT_ACTIVATE_REJ
,

68 
	mESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_REQ
,

69 
	mESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_CNF
,

70 
	mESM_DEDICATED_EPS_BEARER_CONTEXT_ACTIVATE_REJ
,

71 
	mESM_EPS_BEARER_CONTEXT_MODIFY_REQ
,

72 
	mESM_EPS_BEARER_CONTEXT_MODIFY_CNF
,

73 
	mESM_EPS_BEARER_CONTEXT_MODIFY_REJ
,

74 
	mESM_EPS_BEARER_CONTEXT_DEACTIVATE_REQ
,

75 
	mESM_EPS_BEARER_CONTEXT_DEACTIVATE_CNF
,

77 
	mESM_PDN_CONNECTIVITY_REQ
,

78 
	mESM_PDN_CONNECTIVITY_REJ
,

79 
	mESM_PDN_DISCONNECT_REQ
,

80 
	mESM_PDN_DISCONNECT_REJ
,

81 
	mESM_BEARER_RESOURCE_ALLOCATE_REQ
,

82 
	mESM_BEARER_RESOURCE_ALLOCATE_REJ
,

83 
	mESM_BEARER_RESOURCE_MODIFY_REQ
,

84 
	mESM_BEARER_RESOURCE_MODIFY_REJ
,

86 
	mESM_UNITDATA_IND
,

87 
	mESM_END


88 } 
	tesm_¥imôive_t
;

98 
	mESM_SAP_SUCCESS
 = 1,

99 
	mESM_SAP_DISCARDED
,

101 
	mESM_SAP_FAILED


104 } 
	tesm_ßp_îr‹_t
;

111 } 
	gesm_a˘iv©e_ïs_deÁu…_bóªr_c⁄ãxt_t
;

118 
	mcid
;

119 
	mis_deföed
;

121 
	mpdn_ty≥
;

122 c⁄° *
	m≠n
;

123 
	mis_emîgícy
;

126 } 
	tesm_pdn_c⁄√˘ivôy_t
;

133 
	mcid
;

134 } 
	tesm_pdn_disc⁄√˘_t
;

141 
	#ESM_SAP_ALL_EBI
 0xff

	)

142 
	mebi
;

144 } 
	tesm_ïs_bóªr_c⁄ãxt_dó˘iv©e_t
;

152 
esm_pdn_c⁄√˘ivôy_t
 
	mpdn_c⁄√˘
;

153 
esm_pdn_disc⁄√˘_t
 
	mpdn_disc⁄√˘
;

154 
esm_ïs_bóªr_c⁄ãxt_dó˘iv©e_t
 
	mïs_bóªr_c⁄ãxt_dó˘iv©e
;

155 } 
	tesm_ßp_d©a_t
;

158 
esm_¥imôive_t
 
	m¥imôive
;

159 
	mis_°™dÆ⁄e
;

163 #i‡
deföed
(
NAS_MME
)

164 
emm_d©a_c⁄ãxt_t
 *
	m˘x
;

166 
	mueid
;

167 
esm_ßp_îr‹_t
 
	mîr
;

168 c⁄° 
O˘ëSåög
 *
	mªcv
;

169 
O˘ëSåög
 
	m£nd
;

170 
esm_ßp_d©a_t
 
	md©a
;

171 } 
	tesm_ßp_t
;

	@src/esm/sap/esm_send.c

48 
	~"esm_£nd.h
"

49 
	~"comm⁄Def.h
"

50 
	~"«s_log.h
"

52 #ifde‡
NAS_UE


53 
	~"√tw‹kDef.h
"

56 
	~"esm_msgDef.h
"

57 
	~"esm_ˇu£.h
"

59 
	~<°rög.h
>

98 
	$esm_£nd_°©us
(
±i
, 
ebi
, 
esm_°©us_msg
 *
msg
, 
esm_ˇu£
)

100 
LOG_FUNC_IN
;

103 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

104 
msg
->
ïsbóªridítôy
 = 
ebi
;

105 
msg
->
mesßgëy≥
 = 
ESM_STATUS
;

106 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

109 
msg
->
esmˇu£
 = 
esm_ˇu£
;

111 
	`LOG_TRACE
(
WARNING
, "ESM-SAP - Send ESM Status message (pti=%d,Ébi=%d)",

112 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

114 
	`LOG_FUNC_RETURN
(
RETURNok
);

115 
	}
}

122 #ifde‡
NAS_UE


145 
	$esm_£nd_pdn_c⁄√˘ivôy_ªque°
(
±i
, 
is_emîgícy
, 
pdn_ty≥
,

146 c⁄° *
≠n
,

147 
pdn_c⁄√˘ivôy_ªque°_msg
 *
msg
)

149 
LOG_FUNC_IN
;

152 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

153 
msg
->
ïsbóªridítôy
 = 
EPS_BEARER_IDENTITY_UNASSIGNED
;

154 
msg
->
mesßgëy≥
 = 
PDN_CONNECTIVITY_REQUEST
;

155 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

158 i‡(
is_emîgícy
) {

159 
msg
->
ªque°ty≥
 = 
REQUEST_TYPE_EMERGENCY
;

161 
msg
->
ªque°ty≥
 = 
REQUEST_TYPE_INITIAL_REQUEST
;

165 i‡(
pdn_ty≥
 =
NET_PDN_TYPE_IPV4
) {

166 
msg
->
pd¡y≥
 = 
PDN_TYPE_IPV4
;

167 } i‡(
pdn_ty≥
 =
NET_PDN_TYPE_IPV6
) {

168 
msg
->
pd¡y≥
 = 
PDN_TYPE_IPV6
;

169 } i‡(
pdn_ty≥
 =
NET_PDN_TYPE_IPV4V6
) {

170 
msg
->
pd¡y≥
 = 
PDN_TYPE_IPV4V6
;

174 
msg
->
¥e£n˚mask
 = 0;

175 i‡(
≠n
) {

176 
size_t
 
Àn
 = 
	`°æí
(
≠n
);

177 i‡(
Àn
 > 0) {

178 
msg
->
¥e£n˚mask
 |=

179 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
;

180 
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
.
Àngth
 = 
Àn
;

181 
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
.
vÆue
 = (
uöt8_t
 *)
≠n
;

185 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send PDN Connectivity Request message "

187 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

189 
	`LOG_FUNC_RETURN
(
RETURNok
);

190 
	}
}

212 
	$esm_£nd_pdn_disc⁄√˘_ªque°
(
±i
, 
ebi
,

213 
pdn_disc⁄√˘_ªque°_msg
 *
msg
)

215 
LOG_FUNC_IN
;

218 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

219 
msg
->
ïsbóªridítôy
 = 
EPS_BEARER_IDENTITY_UNASSIGNED
;

220 
msg
->
mesßgëy≥
 = 
PDN_DISCONNECT_REQUEST
;

221 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

224 
msg
->
lökedïsbóªridítôy
 = 
ebi
;

226 
msg
->
¥e£n˚mask
 = 0;

228 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send PDN Disconnect Request message "

230 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

232 
	`LOG_FUNC_RETURN
(
RETURNok
);

233 
	}
}

253 
	$esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

254 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

256 
LOG_FUNC_IN
;

259 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

260 
msg
->
ïsbóªridítôy
 = 
ebi
;

261 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
;

262 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
;

265 
msg
->
¥e£n˚mask
 = 0;

267 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Default EPS Bearer Context "

269 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

271 
	`LOG_FUNC_RETURN
(
RETURNok
);

272 
	}
}

293 
	$esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

294 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
, 
esm_ˇu£
)

296 
LOG_FUNC_IN
;

299 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

300 
msg
->
ïsbóªridítôy
 = 
ebi
;

301 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
;

302 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
;

304 
msg
->
esmˇu£
 = 
esm_ˇu£
;

306 
msg
->
¥e£n˚mask
 = 0;

308 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Default EPS Bearer Context "

310 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

312 
	`LOG_FUNC_RETURN
(
RETURNok
);

313 
	}
}

336 
	$esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

337 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

339 
LOG_FUNC_IN
;

342 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

343 
msg
->
ïsbóªridítôy
 = 
ebi
;

344 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
;

345 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
;

348 
msg
->
¥e£n˚mask
 = 0;

350 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Dedicated EPS Bearer Context "

352 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

354 
	`LOG_FUNC_RETURN
(
RETURNok
);

355 
	}
}

377 
	$esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

378 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
, 
esm_ˇu£
)

380 
LOG_FUNC_IN
;

383 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

384 
msg
->
ïsbóªridítôy
 = 
ebi
;

385 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
;

386 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
;

388 
msg
->
esmˇu£
 = 
esm_ˇu£
;

390 
msg
->
¥e£n˚mask
 = 0;

392 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Dedicated EPS Bearer Context "

394 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

396 
	`LOG_FUNC_RETURN
(
RETURNok
);

397 
	}
}

417 
	$esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

418 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
)

420 
LOG_FUNC_IN
;

423 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

424 
msg
->
ïsbóªridítôy
 = 
ebi
;

425 
msg
->
mesßgëy≥
 = 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
;

426 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
;

429 
msg
->
¥e£n˚mask
 = 0;

431 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Deactivate EPS Bearer Context Accept"

433 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

435 
	`LOG_FUNC_RETURN
(
RETURNok
);

436 
	}
}

444 #ifde‡
NAS_MME


464 
	$esm_£nd_pdn_c⁄√˘ivôy_ªje˘
(
±i
, 
pdn_c⁄√˘ivôy_ªje˘_msg
 *
msg
,

465 
esm_ˇu£
)

467 
LOG_FUNC_IN
;

470 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

471 
msg
->
ïsbóªridítôy
 = 
EPS_BEARER_IDENTITY_UNASSIGNED
;

472 
msg
->
mesßgëy≥
 = 
PDN_CONNECTIVITY_REJECT
;

473 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

476 
msg
->
esmˇu£
 = 
esm_ˇu£
;

478 
msg
->
¥e£n˚mask
 = 0;

480 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send PDN Connectivity Reject message "

482 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

484 
	`LOG_FUNC_RETURN
(
RETURNok
);

485 
	}
}

505 
	$esm_£nd_pdn_disc⁄√˘_ªje˘
(
±i
, 
pdn_disc⁄√˘_ªje˘_msg
 *
msg
,

506 
esm_ˇu£
)

508 
LOG_FUNC_IN
;

511 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

512 
msg
->
ïsbóªridítôy
 = 
EPS_BEARER_IDENTITY_UNASSIGNED
;

513 
msg
->
mesßgëy≥
 = 
PDN_DISCONNECT_REJECT
;

514 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

517 
msg
->
esmˇu£
 = 
esm_ˇu£
;

519 
msg
->
¥e£n˚mask
 = 0;

521 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send PDN Disconnect Reject message "

523 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

525 
	`LOG_FUNC_RETURN
(
RETURNok
);

526 
	}
}

552 
	$esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
±i
,

553 
ebi
,

554 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
,

555 c⁄° 
O˘ëSåög
 *
≠n
,

556 
pdn_ty≥
,

557 c⁄° 
O˘ëSåög
 *
pdn_addr
,

558 c⁄° 
EpsQuÆôyOfSîvi˚
 *
qos
,

559 
esm_ˇu£
)

561 
LOG_FUNC_IN
;

564 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

565 
msg
->
ïsbóªridítôy
 = 
ebi
;

566 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
;

567 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

570 
msg
->
ïsqos
 = *
qos
;

571 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† qci: %u", 
qos
->
qci
);

572 i‡(
qos
->
bôR©esPª£¡
) {

573 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† maxBôR©eF‹UL: %u", 
qos
->
bôR©es
.
maxBôR©eF‹UL
);

574 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† maxBôR©eF‹DL: %u", 
qos
->
bôR©es
.
maxBôR©eF‹DL
);

575 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† gu¨BôR©eF‹UL: %u", 
qos
->
bôR©es
.
gu¨BôR©eF‹UL
);

576 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† gu¨BôR©eF‹DL: %u", 
qos
->
bôR©es
.
gu¨BôR©eF‹DL
);

578 
	`LOG_TRACE
(
INFO
, "ESM-SAP -ÉpsqosÇo bitÑates defined");

580 i‡(
qos
->
bôR©esExtPª£¡
) {

581 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† maxBôR©eF‹UL Ext: %u", 
qos
->
bôR©esExt
.
maxBôR©eF‹UL
);

582 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† maxBôR©eF‹DL Ext: %u", 
qos
->
bôR©esExt
.
maxBôR©eF‹DL
);

583 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† gu¨BôR©eF‹UL Ext: %u", 
qos
->
bôR©esExt
.
gu¨BôR©eF‹UL
);

584 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Épsqo† gu¨BôR©eF‹DL Ext: %u", 
qos
->
bôR©esExt
.
gu¨BôR©eF‹DL
);

586 
	`LOG_TRACE
(
INFO
, "ESM-SAP -ÉpsqosÇo bitÑatesÉxt defined");

590 i‡((
≠n
 =
NULL
Ë|| (◊≤ !NULLË&& (≠n->
vÆue
 == NULL))) {

591 
	`LOG_TRACE
(
WARNING
, "ESM-SAP -ápn is NULL!");

594 
	`LOG_TRACE
(
INFO
, "ESM-SAP -á≤ i†%s", 
≠n
->
vÆue
);

597 
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
 = *
≠n
;

600 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Ödn_ty≥ i†%u", 
pdn_ty≥
);

601 
msg
->
pd«ddªss
.
pd¡y≥vÆue
 = 
pdn_ty≥
;

602 
	`LOG_TRACE
(
INFO
, "ESM-SAP -Ödn_add∏i†%u", 
	`dump_o˘ë_°rög
(
pdn_addr
));

603 
msg
->
pd«ddªss
.
pd«ddªssöf‹m©i⁄
 = *
pdn_addr
;

606 
msg
->
¥e£n˚mask
 = 0;

607 i‡(
esm_ˇu£
 !
ESM_CAUSE_SUCCESS
) {

608 
msg
->
¥e£n˚mask
 |=

609 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
;

610 
msg
->
esmˇu£
 = 
esm_ˇu£
;

614 
	`LOG_TRACE
(
INFO
, "ESM-SAP - FORCE APN-AMBR");

615 
msg
->
¥e£n˚mask
 |=

616 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_APNAMBR_PRESENT
;

617 
msg
->
≠«mbr
.
≠«mbrf‹dow∆ök
 = 0xfe;

618 
msg
->
≠«mbr
.
≠«mbrf‹u∂ök
 = 0xfe;

619 
msg
->
≠«mbr
.
≠«mbrf‹dow∆ök_exãnded
 = 0xde;

620 
msg
->
≠«mbr
.
≠«mbrf‹u∂ök_exãnded
 = 0x9e;

621 
msg
->
≠«mbr
.
≠«mbrf‹dow∆ök_exãnded2
 = 0;

622 
msg
->
≠«mbr
.
≠«mbrf‹u∂ök_exãnded2
 = 0;

623 
msg
->
≠«mbr
.
exãnsi⁄s
 = 0 | 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION_PRESENT
;

625 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Default EPS Bearer Context "

627 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

629 
	`LOG_FUNC_RETURN
(
RETURNok
);

630 
	}
}

659 
	$esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

660 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
,

661 
löked_ebi
, c⁄° 
EpsQuÆôyOfSîvi˚
 *
qos
,

662 
PackëFûãrs
 *
pkfs
, 
n_pkfs
)

664 
i
;

665 
LOG_FUNC_IN
;

668 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

669 
msg
->
ïsbóªridítôy
 = 
ebi
;

670 
msg
->
mesßgëy≥
 = 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
;

671 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

674 
msg
->
ïsqos
 = *
qos
;

677 
msg
->
t·
.
t·›î©i⁄code
 = 
TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
;

678 
msg
->
t·
.
ebô
 = 
TRAFFIC_FLOW_TEMPLATE_PARAMETER_LIST_IS_NOT_INCLUDED
;

679 
msg
->
t·
.
numbîoÂackëfûãrs
 = 
n_pkfs
;

680 
i
 = 0; i < 
msg
->
t·
.
numbîoÂackëfûãrs
; i++) {

681 
msg
->
t·
.
∑ckëfûãæi°
.
¸óãt·
[
i
] = (*
pkfs
)[i];

685 
msg
->
¥e£n˚mask
 = 0;

687 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Activate Dedicated EPS Bearer Context "

689 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

691 
	`LOG_FUNC_RETURN
(
RETURNok
);

692 
	}
}

714 
	$esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

715 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
,

716 
esm_ˇu£
)

718 
LOG_FUNC_IN
;

721 
msg
->
¥Ÿocﬁdis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

722 
msg
->
ïsbóªridítôy
 = 
ebi
;

723 
msg
->
mesßgëy≥
 = 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
;

724 
msg
->
¥o˚duªå™ß˘i⁄idítôy
 = 
±i
;

727 
msg
->
esmˇu£
 = 
esm_ˇu£
;

729 
msg
->
¥e£n˚mask
 = 0;

731 
	`LOG_TRACE
(
INFO
, "ESM-SAP - Send Deactivate EPS Bearer Context Request "

733 
msg
->
¥o˚duªå™ß˘i⁄idítôy
, msg->
ïsbóªridítôy
);

735 
	`LOG_FUNC_RETURN
(
RETURNok
);

736 
	}
}

	@src/esm/sap/esm_send.h

47 #i‚de‡
__ESM_SEND_H__


48 
	#__ESM_SEND_H__


	)

50 
	~"EsmSètus.h
"

52 #ifde‡
NAS_MME


53 
	~"PdnC⁄√˘ivôyReje˘.h
"

54 
	~"PdnDisc⁄√˘Reje˘.h
"

55 
	~"BóªrResour˚AŒoˇti⁄Reje˘.h
"

56 
	~"BóªrResour˚Modifiˇti⁄Reje˘.h
"

58 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReque°.h
"

59 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReque°.h
"

60 
	~"ModifyEpsBóªrC⁄ãxtReque°.h
"

61 
	~"Dó˘iv©eEpsBóªrC⁄ãxtReque°.h
"

63 
	~"EsmInf‹m©i⁄Reque°.h
"

66 #ifde‡
NAS_UE


67 
	~"PdnC⁄√˘ivôyReque°.h
"

68 
	~"PdnDisc⁄√˘Reque°.h
"

69 
	~"BóªrResour˚AŒoˇti⁄Reque°.h
"

70 
	~"BóªrResour˚Modifiˇti⁄Reque°.h
"

72 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtAc˚±.h
"

73 
	~"A˘iv©eDeÁu…EpsBóªrC⁄ãxtReje˘.h
"

74 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtAc˚±.h
"

75 
	~"A˘iv©eDediˇãdEpsBóªrC⁄ãxtReje˘.h
"

76 
	~"ModifyEpsBóªrC⁄ãxtAc˚±.h
"

77 
	~"ModifyEpsBóªrC⁄ãxtReje˘.h
"

78 
	~"Dó˘iv©eEpsBóªrC⁄ãxtAc˚±.h
"

80 
	~"EsmInf‹m©i⁄Re•⁄£.h
"

104 
esm_£nd_°©us
(
±i
, 
ebi
, 
esm_°©us_msg
 *
msg
, 
esm_ˇu£
);

111 #ifde‡
NAS_UE


116 
esm_£nd_pdn_c⁄√˘ivôy_ªque°
(
±i
, 
is_emîgícy
, 
pdn_ty≥
,

117 c⁄° *
≠n
, 
pdn_c⁄√˘ivôy_ªque°_msg
 *
msg
);

118 
esm_£nd_pdn_disc⁄√˘_ªque°
(
±i
, 
ebi
,

119 
pdn_disc⁄√˘_ªque°_msg
 *
msg
);

125 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

126 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

127 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

128 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
, 
esm_ˇu£
);

130 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

131 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

132 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(
ebi
,

133 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
 *
msg
, 
esm_ˇu£
);

135 
esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
ebi
,

136 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
 *
msg
);

145 #ifde‡
NAS_MME


150 
esm_£nd_pdn_c⁄√˘ivôy_ªje˘
(
±i
, 
pdn_c⁄√˘ivôy_ªje˘_msg
 *
msg
,

151 
esm_ˇu£
);

153 
esm_£nd_pdn_disc⁄√˘_ªje˘
(
±i
, 
pdn_disc⁄√˘_ªje˘_msg
 *
msg
,

154 
esm_ˇu£
);

160 
esm_£nd_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

161 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
, c⁄° 
O˘ëSåög
 *
≠n
,

162 
pdn_ty≥
, c⁄° 
O˘ëSåög
 *
pdn_addr
, c⁄° 
EpsQuÆôyOfSîvi˚
 *
qos
,

163 
esm_ˇu£
);

165 
esm_£nd_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

166 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
, 
löked_ebi
,

167 c⁄° 
EpsQuÆôyOfSîvi˚
 *
qos
, 
PackëFûãrs
 *
pkfs
, 
n_pkfs
);

169 
esm_£nd_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
±i
, 
ebi
,

170 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
 *
msg
, 
esm_ˇu£
);

	@src/ies/AccessPointName.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Ac˚ssPoötName.h
"

38 
	$decode_ac˚ss_poöt_«me
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
ac˚s•oöäame
->
ac˚s•oöäamevÆue
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_ac˚ss_poöt_«me_xml
(
ac˚s•oöäame
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_ac˚ss_poöt_«me
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

65 
O˘ëSåög
 
≠n_ícoded
;

66 
uöt32_t
 
Àngth_ödex
;

67 
uöt32_t
 
ödex
;

68 
uöt32_t
 
ödex_c›y
;

71 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ACCESS_POINT_NAME_MINIMUM_LENGTH
, 
Àn
);

72 #i‡
	`deföed
 (
NAS_DEBUG
)

73 
	`dump_ac˚ss_poöt_«me_xml
(
ac˚s•oöäame
, 
õi
);

75 i‡(
õi
 > 0)

77 *
buf„r
 = 
õi
;

78 
ícoded
++;

80 
ÀnPå
 = (
buf„r
 + 
ícoded
);

81 
ícoded
 ++;

83 
≠n_ícoded
.
Àngth
 = 0;

84 
≠n_ícoded
.
vÆue
 = 
	`ˇŒoc
(1, 
ACCESS_POINT_NAME_MAXIMUM_LENGTH
);

85 
ödex
 = 0;

86 
Àngth_ödex
 = 0;

87 
ödex_c›y
 = 1;

88 (
ac˚s•oöäame
->
ac˚s•oöäamevÆue
.
vÆue
[
ödex
] !0Ë&& (ödex <ác˚s•oöäame->ac˚s•oöäamevÆue.
Àngth
)) {

89 i‡(
ac˚s•oöäame
->
ac˚s•oöäamevÆue
.
vÆue
[
ödex
] == '.') {

90 
≠n_ícoded
.
vÆue
[
Àngth_ödex
] = 
ödex_c›y
 -Üength_index - 1;

91 
Àngth_ödex
 = 
ödex_c›y
;

92 
ödex_c›y
 = 
Àngth_ödex
 + 1;

94 
≠n_ícoded
.
vÆue
[
ödex_c›y
] = 
ac˚s•oöäame
->
ac˚s•oöäamevÆue
.vÆue[
ödex
];

95 
ödex_c›y
++;

97 
ödex
++;

99 
≠n_ícoded
.
vÆue
[
Àngth_ödex
] = 
ödex_c›y
 -Üength_index - 1;

100 
≠n_ícoded
.
Àngth
 = 
ödex_c›y
;

102 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
≠n_ícoded
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0) {

103 
	`‰ì
(
≠n_ícoded
.
vÆue
);

104  
ícode_ªsu…
;

106 
ícoded
 +
ícode_ªsu…
;

107 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

109 
	`‰ì
(
≠n_ícoded
.
vÆue
);

110  
ícoded
;

111 
	}
}

113 
	$dump_ac˚ss_poöt_«me_xml
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
)

115 
	`¥ötf
("<Access Point Name>\n");

116 i‡(
õi
 > 0)

118 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

119 
	`¥ötf
("%s</Access Point Name>\n",

120 
	`dump_o˘ë_°rög_xml
(&
ac˚s•oöäame
->
ac˚s•oöäamevÆue
));

121 
	}
}

	@src/ies/AccessPointName.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ACCESS_POINT_NAME_H_


36 
	#ACCESS_POINT_NAME_H_


	)

38 
	#ACCESS_POINT_NAME_MINIMUM_LENGTH
 3

	)

39 
	#ACCESS_POINT_NAME_MAXIMUM_LENGTH
 102

	)

41 
	sAc˚ssPoötName_èg
 {

42 
O˘ëSåög
 
	mac˚s•oöäamevÆue
;

43 } 
	tAc˚ssPoötName
;

45 
ícode_ac˚ss_poöt_«me
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_ac˚ss_poöt_«me
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_ac˚ss_poöt_«me_xml
(
Ac˚ssPoötName
 *
ac˚s•oöäame
, 
uöt8_t
 
õi
);

	@src/ies/AdditionalUpdateResult.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Addôi⁄ÆUpd©eResu….h
"

38 
	$decode_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ADDITIONAL_UPDATE_RESULT_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
addôi⁄Æupd©îesu…
 = *
buf„r
 & 0x3;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_addôi⁄Æ_upd©e_ªsu…_xml
(
addôi⁄Æupd©îesu…
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
addôi⁄Æupd©îesu…
 = *
buf„r
 & 0x3;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_addôi⁄Æ_upd©e_ªsu…_xml
(
addôi⁄Æupd©îesu…
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ADDITIONAL_UPDATE_RESULT_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_addôi⁄Æ_upd©e_ªsu…_xml
(
addôi⁄Æupd©îesu…
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
addôi⁄Æupd©îesu…
 & 0x3);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_addôi⁄Æ_upd©e_ªsu…_xml
(
addôi⁄Æupd©îesu…
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
addôi⁄Æupd©îesu…
 & 0x3);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_addôi⁄Æ_upd©e_ªsu…_xml
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Additional Update Result>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <Addôi⁄Æ upd©êªsu… vÆue>%u</Addôi⁄Æ upd©êªsu… vÆue>\n", *
addôi⁄Æupd©îesu…
);

101 
	`¥ötf
("</Additional Update Result>\n");

102 
	}
}

	@src/ies/AdditionalUpdateResult.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ADDITIONAL_UPDATE_RESULT_H_


36 
	#ADDITIONAL_UPDATE_RESULT_H_


	)

38 
	#ADDITIONAL_UPDATE_RESULT_MINIMUM_LENGTH
 1

	)

39 
	#ADDITIONAL_UPDATE_RESULT_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tAddôi⁄ÆUpd©eResu…
;

43 
ícode_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_addôi⁄Æ_upd©e_ªsu…_xml
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
);

49 
decode_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_addôi⁄Æ_upd©e_ªsu…
(
Addôi⁄ÆUpd©eResu…
 *
addôi⁄Æupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/AdditionalUpdateType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Addôi⁄ÆUpd©eTy≥.h
"

38 
	$decode_addôi⁄Æ_upd©e_ty≥
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 *
addôi⁄Æupd©ëy≥
 = *
buf„r
 & 0x1;

42 
decoded
++;

43 #i‡
	`deföed
 (
NAS_DEBUG
)

44 
	`dump_addôi⁄Æ_upd©e_ty≥_xml
(
addôi⁄Æupd©ëy≥
, 
õi
);

46  
decoded
;

47 
	}
}

49 
	$ícode_addôi⁄Æ_upd©e_ty≥
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

52 
	}
}

53 
	$dump_addôi⁄Æ_upd©e_ty≥_xml
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
)

55 
	`¥ötf
("<Additional Update Type>\n");

56 i‡(
õi
 > 0)

58 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

59 
	`¥ötf
(" <AUTV>%u</AUTV>\n", *
addôi⁄Æupd©ëy≥
);

60 
	`¥ötf
("</Additional Update Type>\n");

61 
	}
}

	@src/ies/AdditionalUpdateType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ADDITIONAL_UPDATE_TYPE_H_


36 
	#ADDITIONAL_UPDATE_TYPE_H_


	)

38 
	#ADDITIONAL_UPDATE_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#ADDITIONAL_UPDATE_TYPE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tAddôi⁄ÆUpd©eTy≥
;

43 
ícode_addôi⁄Æ_upd©e_ty≥
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
decode_addôi⁄Æ_upd©e_ty≥
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_addôi⁄Æ_upd©e_ty≥_xml
(
Addôi⁄ÆUpd©eTy≥
 *
addôi⁄Æupd©ëy≥
, 
uöt8_t
 
õi
);

	@src/ies/ApnAggregateMaximumBitRate.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"A≤Aggªg©eMaximumBôR©e.h
"

38 
	$decode_≠n_aggªg©e_maximum_bô_øã
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök
 = *(
buf„r
 + 
decoded
);

51 
decoded
++;

52 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök
 = *(
buf„r
 + 
decoded
);

53 
decoded
++;

54 i‡(
õÀn
 >= 4) {

55 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded
 = *(
buf„r
 + 
decoded
);

56 
decoded
++;

57 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded
 = *(
buf„r
 + 
decoded
);

58 
decoded
++;

59 i‡(
õÀn
 >= 6) {

60 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded2
 = *(
buf„r
 + 
decoded
);

61 
decoded
++;

62 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded2
 = *(
buf„r
 + 
decoded
);

63 
decoded
++;

66 #i‡
	`deföed
 (
NAS_DEBUG
)

67 
	`dump_≠n_aggªg©e_maximum_bô_øã_xml
(
≠«ggªg©emaximumbôøã
, 
õi
);

69  
decoded
;

70 
	}
}

71 
	$ícode_≠n_aggªg©e_maximum_bô_øã
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

73 
uöt8_t
 *
ÀnPå
;

74 
uöt32_t
 
ícoded
 = 0;

76 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MINIMUM_LENGTH
, 
Àn
);

77 #i‡
	`deföed
 (
NAS_DEBUG
)

78 
	`dump_≠n_aggªg©e_maximum_bô_øã_xml
(
≠«ggªg©emaximumbôøã
, 
õi
);

80 i‡(
õi
 > 0)

82 *
buf„r
 = 
õi
;

83 
ícoded
++;

85 
ÀnPå
 = (
buf„r
 + 
ícoded
);

86 
ícoded
 ++;

87 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök
;

88 
ícoded
++;

89 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök
;

90 
ícoded
++;

91 i‡(
≠«ggªg©emaximumbôøã
->
exãnsi⁄s
 & 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION_PRESENT
) {

92 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded
;

93 
ícoded
++;

94 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded
;

95 
ícoded
++;

96 i‡(
≠«ggªg©emaximumbôøã
->
exãnsi⁄s
 & 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION2_PRESENT
) {

97 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded2
;

98 
ícoded
++;

99 *(
buf„r
 + 
ícoded
Ë
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded2
;

100 
ícoded
++;

103 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

104  
ícoded
;

105 
	}
}

107 
	$dump_≠n_aggªg©e_maximum_bô_øã_xml
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
)

109 
	`¥ötf
("<Apn Aggregate Maximum Bit Rate>\n");

110 i‡(
õi
 > 0)

112 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

113 
	`¥ötf
(" <APN AMBR f‹ dow∆ök>%u</APN AMBR f‹ dow∆ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök
);

114 
	`¥ötf
(" <APN AMBR f‹ u∂ök>%u</APN AMBR f‹ u∂ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök
);

115 i‡(
≠«ggªg©emaximumbôøã
->
exãnsi⁄s
 & 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION_PRESENT
) {

116 
	`¥ötf
(" <APN AMBRÉxãnded f‹ dow∆ök>%u</APN AMBR f‹ dow∆ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded
);

117 
	`¥ötf
(" <APN AMBRÉxãnded f‹ u∂ök>%u</APN AMBR f‹ u∂ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded
);

118 i‡(
≠«ggªg©emaximumbôøã
->
exãnsi⁄s
 & 
APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION2_PRESENT
) {

119 
	`¥ötf
(" <APN AMBRÉxãnded2 f‹ dow∆ök>%u</APN AMBR f‹ dow∆ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹dow∆ök_exãnded
);

120 
	`¥ötf
(" <APN AMBRÉxãnded2 f‹ u∂ök>%u</APN AMBR f‹ u∂ök>\n", 
≠«ggªg©emaximumbôøã
->
≠«mbrf‹u∂ök_exãnded
);

123 
	`¥ötf
("</Apn Aggregate Maximum Bit Rate>\n");

124 
	}
}

	@src/ies/ApnAggregateMaximumBitRate.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
APN_AGGREGATE_MAXIMUM_BIT_RATE_H_


36 
	#APN_AGGREGATE_MAXIMUM_BIT_RATE_H_


	)

38 
	#APN_AGGREGATE_MAXIMUM_BIT_RATE_MINIMUM_LENGTH
 4

	)

39 
	#APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_LENGTH
 8

	)

41 
	#APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION_PRESENT
 (1<<0)

	)

42 
	#APN_AGGREGATE_MAXIMUM_BIT_RATE_MAXIMUM_EXTENSION2_PRESENT
 (1<<1)

	)

44 
	sA≤Aggªg©eMaximumBôR©e_èg
 {

45 
uöt8_t
 
	m≠«mbrf‹dow∆ök
;

46 
uöt8_t
 
	m≠«mbrf‹u∂ök
;

47 
uöt8_t
 
	m≠«mbrf‹dow∆ök_exãnded
;

48 
uöt8_t
 
	m≠«mbrf‹u∂ök_exãnded
;

49 
uöt8_t
 
	m≠«mbrf‹dow∆ök_exãnded2
;

50 
uöt8_t
 
	m≠«mbrf‹u∂ök_exãnded2
;

51 
uöt8_t
 
	mexãnsi⁄s
;

52 } 
	tA≤Aggªg©eMaximumBôR©e
;

54 
ícode_≠n_aggªg©e_maximum_bô_øã
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

56 
decode_≠n_aggªg©e_maximum_bô_øã
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

58 
dump_≠n_aggªg©e_maximum_bô_øã_xml
(
A≤Aggªg©eMaximumBôR©e
 *
≠«ggªg©emaximumbôøã
, 
uöt8_t
 
õi
);

	@src/ies/AuthenticationFailureParameter.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Authítiˇti⁄FaûuªP¨amëî.h
"

38 
	$decode_authítiˇti⁄_Áûuª_∑ømëî
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
authítiˇti⁄Áûuª∑ømëî
->
auts
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_authítiˇti⁄_Áûuª_∑ømëî_xml
(
authítiˇti⁄Áûuª∑ømëî
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_authítiˇti⁄_Áûuª_∑ømëî
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_FAILURE_PARAMETER_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_authítiˇti⁄_Áûuª_∑ømëî_xml
(
authítiˇti⁄Áûuª∑ømëî
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
authítiˇti⁄Áûuª∑ømëî
->
auts
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_authítiˇti⁄_Áûuª_∑ømëî_xml
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Authentication Failure Parameter>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
authítiˇti⁄Áûuª∑ømëî
->
auts
));

92 
	`¥ötf
("</Authentication Failure Parameter>\n");

93 
	}
}

	@src/ies/AuthenticationFailureParameter.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
AUTHENTICATION_FAILURE_PARAMETER_H_


36 
	#AUTHENTICATION_FAILURE_PARAMETER_H_


	)

38 
	#AUTHENTICATION_FAILURE_PARAMETER_MINIMUM_LENGTH
 16

	)

39 
	#AUTHENTICATION_FAILURE_PARAMETER_MAXIMUM_LENGTH
 16

	)

41 
	sAuthítiˇti⁄FaûuªP¨amëî_èg
 {

42 
O˘ëSåög
 
	mauts
;

43 } 
	tAuthítiˇti⁄FaûuªP¨amëî
;

45 
ícode_authítiˇti⁄_Áûuª_∑ømëî
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_authítiˇti⁄_Áûuª_∑ømëî
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_authítiˇti⁄_Áûuª_∑ømëî_xml
(
Authítiˇti⁄FaûuªP¨amëî
 *
authítiˇti⁄Áûuª∑ømëî
, 
uöt8_t
 
õi
);

	@src/ies/AuthenticationParameterAutn.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Authítiˇti⁄P¨amëîAuä.h
"

38 
	$decode_authítiˇti⁄_∑ømëî_auä
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
authítiˇti⁄∑ømëîauä
->
auä
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_authítiˇti⁄_∑ømëî_auä_xml
(
authítiˇti⁄∑ømëîauä
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_authítiˇti⁄_∑ømëî_auä
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
ícode_ªsu…
;

64 
uöt32_t
 
ícoded
 = 0;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_PARAMETER_AUTN_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_authítiˇti⁄_∑ømëî_auä_xml
(
authítiˇti⁄∑ømëîauä
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
authítiˇti⁄∑ømëîauä
->
auä
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_authítiˇti⁄_∑ømëî_auä_xml
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Authentication Parameter Autn>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
authítiˇti⁄∑ømëîauä
->
auä
));

92 
	`¥ötf
("</Authentication Parameter Autn>\n");

93 
	}
}

	@src/ies/AuthenticationParameterAutn.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
AUTHENTICATION_PARAMETER_AUTN_H_


36 
	#AUTHENTICATION_PARAMETER_AUTN_H_


	)

38 
	#AUTHENTICATION_PARAMETER_AUTN_MINIMUM_LENGTH
 17

	)

39 
	#AUTHENTICATION_PARAMETER_AUTN_MAXIMUM_LENGTH
 17

	)

41 
	sAuthítiˇti⁄P¨amëîAuä_èg
 {

42 
O˘ëSåög
 
	mauä
;

43 } 
	tAuthítiˇti⁄P¨amëîAuä
;

45 
ícode_authítiˇti⁄_∑ømëî_auä
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_authítiˇti⁄_∑ømëî_auä
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_authítiˇti⁄_∑ømëî_auä_xml
(
Authítiˇti⁄P¨amëîAuä
 *
authítiˇti⁄∑ømëîauä
, 
uöt8_t
 
õi
);

	@src/ies/AuthenticationParameterRand.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Authítiˇti⁄P¨amëîR™d.h
"

38 
	$decode_authítiˇti⁄_∑ømëî_ønd
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 16;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
authítiˇti⁄∑ømëîønd
->
ønd
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decode_ªsu…
;

51 
decoded
 +
decode_ªsu…
;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_authítiˇti⁄_∑ømëî_ønd_xml
(
authítiˇti⁄∑ømëîønd
, 
õi
);

55  
decoded
;

56 
	}
}

58 
	$ícode_authítiˇti⁄_∑ømëî_ønd
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

60 
uöt32_t
 
ícode_ªsu…
;

61 
uöt32_t
 
ícoded
 = 0;

63 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_PARAMETER_RAND_MINIMUM_LENGTH
, 
Àn
);

64 #i‡
	`deföed
 (
NAS_DEBUG
)

65 
	`dump_authítiˇti⁄_∑ømëî_ønd_xml
(
authítiˇti⁄∑ømëîønd
, 
õi
);

67 i‡(
õi
 > 0)

69 *
buf„r
 = 
õi
;

70 
ícoded
++;

72 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
authítiˇti⁄∑ømëîønd
->
ønd
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

73  
ícode_ªsu…
;

75 
ícoded
 +
ícode_ªsu…
;

76  
ícoded
;

77 
	}
}

79 
	$dump_authítiˇti⁄_∑ømëî_ønd_xml
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
)

81 
	`¥ötf
("<Authentication Parameter Rand>\n");

82 i‡(
õi
 > 0)

84 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

85 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
authítiˇti⁄∑ømëîønd
->
ønd
));

86 
	`¥ötf
("</Authentication Parameter Rand>\n");

87 
	}
}

	@src/ies/AuthenticationParameterRand.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
AUTHENTICATION_PARAMETER_RAND_H_


36 
	#AUTHENTICATION_PARAMETER_RAND_H_


	)

38 
	#AUTHENTICATION_PARAMETER_RAND_MINIMUM_LENGTH
 16

	)

39 
	#AUTHENTICATION_PARAMETER_RAND_MAXIMUM_LENGTH
 16

	)

41 
	sAuthítiˇti⁄P¨amëîR™d_èg
 {

42 
O˘ëSåög
 
	mønd
;

43 } 
	tAuthítiˇti⁄P¨amëîR™d
;

45 
ícode_authítiˇti⁄_∑ømëî_ønd
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_authítiˇti⁄_∑ømëî_ønd_xml
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
);

49 
decode_authítiˇti⁄_∑ømëî_ønd
(
Authítiˇti⁄P¨amëîR™d
 *
authítiˇti⁄∑ømëîønd
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/AuthenticationResponseParameter.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Authítiˇti⁄Re•⁄£P¨amëî.h
"

38 
	$decode_authítiˇti⁄_ª•⁄£_∑ømëî
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
authítiˇti⁄ª•⁄£∑ømëî
->
ªs
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_authítiˇti⁄_ª•⁄£_∑ømëî_xml
(
authítiˇti⁄ª•⁄£∑ømëî
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_authítiˇti⁄_ª•⁄£_∑ømëî
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
AUTHENTICATION_RESPONSE_PARAMETER_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_authítiˇti⁄_ª•⁄£_∑ømëî_xml
(
authítiˇti⁄ª•⁄£∑ømëî
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
authítiˇti⁄ª•⁄£∑ømëî
->
ªs
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_authítiˇti⁄_ª•⁄£_∑ømëî_xml
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Authentication Response Parameter>\n");

88 
	`dump_o˘ë_°rög_xml
(&
authítiˇti⁄ª•⁄£∑ømëî
->
ªs
);

89 
	`¥ötf
("</Authentication Response Parameter>\n");

90 
	}
}

	@src/ies/AuthenticationResponseParameter.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
AUTHENTICATION_RESPONSE_PARAMETER_H_


36 
	#AUTHENTICATION_RESPONSE_PARAMETER_H_


	)

38 
	#AUTHENTICATION_RESPONSE_PARAMETER_MINIMUM_LENGTH
 6

	)

39 
	#AUTHENTICATION_RESPONSE_PARAMETER_MAXIMUM_LENGTH
 18

	)

41 
	sAuthítiˇti⁄Re•⁄£P¨amëî_èg
 {

42 
O˘ëSåög
 
	mªs
;

43 } 
	tAuthítiˇti⁄Re•⁄£P¨amëî
;

45 
ícode_authítiˇti⁄_ª•⁄£_∑ømëî
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_authítiˇti⁄_ª•⁄£_∑ømëî
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_authítiˇti⁄_ª•⁄£_∑ømëî_xml
(
Authítiˇti⁄Re•⁄£P¨amëî
 *
authítiˇti⁄ª•⁄£∑ømëî
, 
uöt8_t
 
õi
);

	@src/ies/CipheringKeySequenceNumber.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"CùhîögKeySequí˚Numbî.h
"

38 
	$decode_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
CIPHERING_KEY_SEQUENCE_NUMBER_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
cùhîögkey£quí˚numbî
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_cùhîög_key_£quí˚_numbî_xml
(
cùhîögkey£quí˚numbî
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
cùhîögkey£quí˚numbî
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_cùhîög_key_£quí˚_numbî_xml
(
cùhîögkey£quí˚numbî
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
CIPHERING_KEY_SEQUENCE_NUMBER_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_cùhîög_key_£quí˚_numbî_xml
(
cùhîögkey£quí˚numbî
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
cùhîögkey£quí˚numbî
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_cùhîög_key_£quí˚_numbî_xml
(
cùhîögkey£quí˚numbî
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
cùhîögkey£quí˚numbî
 & 0x7);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_cùhîög_key_£quí˚_numbî_xml
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Ciphering Key Sequence Number>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <Key sequí˚>%u</Key sequí˚>\n", *
cùhîögkey£quí˚numbî
);

101 
	`¥ötf
("</Ciphering Key Sequence Number>\n");

102 
	}
}

	@src/ies/CipheringKeySequenceNumber.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
CIPHERING_KEY_SEQUENCE_NUMBER_H_


36 
	#CIPHERING_KEY_SEQUENCE_NUMBER_H_


	)

38 
	#CIPHERING_KEY_SEQUENCE_NUMBER_MINIMUM_LENGTH
 1

	)

39 
	#CIPHERING_KEY_SEQUENCE_NUMBER_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tCùhîögKeySequí˚Numbî
;

43 
ícode_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_cùhîög_key_£quí˚_numbî_xml
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
);

49 
decode_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_cùhîög_key_£quí˚_numbî
(
CùhîögKeySequí˚Numbî
 *
cùhîögkey£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/Cli.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Cli.h
"

38 
	$decode_˛i
(
Cli
 *
˛i
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
˛i
->
˛ivÆue
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_˛i_xml
(
˛i
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_˛i
(
Cli
 *
˛i
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
CLI_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_˛i_xml
(
˛i
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
˛i
->
˛ivÆue
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_˛i_xml
(
Cli
 *
˛i
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Cli>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
˛i
->
˛ivÆue
));

92 
	`¥ötf
("</Cli>\n");

93 
	}
}

	@src/ies/Cli.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
CLI_H_


36 
	#CLI_H_


	)

38 
	#CLI_MINIMUM_LENGTH
 3

	)

39 
	#CLI_MAXIMUM_LENGTH
 14

	)

41 
	sCli_èg
 {

42 
O˘ëSåög
 
	m˛ivÆue
;

43 } 
	tCli
;

45 
ícode_˛i
(
Cli
 *
˛i
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_˛i
(
Cli
 *
˛i
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_˛i_xml
(
Cli
 *
˛i
, 
uöt8_t
 
õi
);

	@src/ies/CsfbResponse.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"CsfbRe•⁄£.h
"

38 
	$decode_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
CSFB_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
csfbª•⁄£
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_csfb_ª•⁄£_xml
(
csfbª•⁄£
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
csfbª•⁄£
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_csfb_ª•⁄£_xml
(
csfbª•⁄£
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
CSFB_RESPONSE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_csfb_ª•⁄£_xml
(
csfbª•⁄£
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
csfbª•⁄£
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_csfb_ª•⁄£_xml
(
csfbª•⁄£
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
csfbª•⁄£
 & 0x7);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_csfb_ª•⁄£_xml
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Csfb Response>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <CSFBÑe•⁄£ vÆue>%u</CSFBÑe•⁄£ vÆue>\n", *
csfbª•⁄£
);

101 
	`¥ötf
("</Csfb Response>\n");

102 
	}
}

	@src/ies/CsfbResponse.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
CSFB_RESPONSE_H_


36 
	#CSFB_RESPONSE_H_


	)

38 
	#CSFB_RESPONSE_MINIMUM_LENGTH
 1

	)

39 
	#CSFB_RESPONSE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tCsfbRe•⁄£
;

43 
ícode_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_csfb_ª•⁄£_xml
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
);

49 
decode_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_csfb_ª•⁄£
(
CsfbRe•⁄£
 *
csfbª•⁄£
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/DaylightSavingTime.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"DaylightSavögTime.h
"

38 
	$decode_daylight_ßvög_time
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 *
daylightßvögtime
 = *
buf„r
 & 0x3;

51 
decoded
++;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_daylight_ßvög_time_xml
(
daylightßvögtime
, 
õi
);

55  
decoded
;

56 
	}
}

57 
	$ícode_daylight_ßvög_time
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
uöt8_t
 *
ÀnPå
;

60 
uöt32_t
 
ícoded
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DAYLIGHT_SAVING_TIME_MINIMUM_LENGTH
, 
Àn
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_daylight_ßvög_time_xml
(
daylightßvögtime
, 
õi
);

66 i‡(
õi
 > 0)

68 *
buf„r
 = 
õi
;

69 
ícoded
++;

71 
ÀnPå
 = (
buf„r
 + 
ícoded
);

72 
ícoded
 ++;

73 *(
buf„r
 + 
ícoded
) = 0x00 |

74 (*
daylightßvögtime
 & 0x3);

75 
ícoded
++;

76 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

77  
ícoded
;

78 
	}
}

80 
	$dump_daylight_ßvög_time_xml
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
)

82 
	`¥ötf
("<Daylight Saving Time>\n");

83 i‡(
õi
 > 0)

85 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

86 
	`¥ötf
(" <VÆue>%u</VÆue>\n", *
daylightßvögtime
);

87 
	`¥ötf
("</Daylight Saving Time>\n");

88 
	}
}

	@src/ies/DaylightSavingTime.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
DAYLIGHT_SAVING_TIME_H_


36 
	#DAYLIGHT_SAVING_TIME_H_


	)

38 
	#DAYLIGHT_SAVING_TIME_MINIMUM_LENGTH
 3

	)

39 
	#DAYLIGHT_SAVING_TIME_MAXIMUM_LENGTH
 3

	)

41 
uöt8_t
 
	tDaylightSavögTime
;

43 
ícode_daylight_ßvög_time
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
decode_daylight_ßvög_time
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_daylight_ßvög_time_xml
(
DaylightSavögTime
 *
daylightßvögtime
, 
uöt8_t
 
õi
);

	@src/ies/DetachType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"DëachTy≥.h
"

38 
	$decode_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
DETACH_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 
dëachty≥
->
swôchoff
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

47 
dëachty≥
->
ty≥ofdëach
 = *(
buf„r
 + 
decoded
) & 0x7;

48 
decoded
++;

49 #i‡
	`deföed
 (
NAS_DEBUG
)

50 
	`dump_dëach_ty≥_xml
(
dëachty≥
, 
õi
);

52  
decoded
;

53 
	}
}

55 
	$decode_u8_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

57 
decoded
 = 0;

58 
uöt8_t
 *
buf„r
 = &
vÆue
;

59 
dëachty≥
->
swôchoff
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

60 
dëachty≥
->
ty≥ofdëach
 = *(
buf„r
 + 
decoded
) & 0x7;

61 
decoded
++;

62 #i‡
	`deföed
 (
NAS_DEBUG
)

63 
	`dump_dëach_ty≥_xml
(
dëachty≥
, 
õi
);

65  
decoded
;

66 
	}
}

68 
	$ícode_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

70 
uöt8_t
 
ícoded
 = 0;

72 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DETACH_TYPE_MINIMUM_LENGTH
, 
Àn
);

73 #i‡
	`deföed
 (
NAS_DEBUG
)

74 
	`dump_dëach_ty≥_xml
(
dëachty≥
, 
õi
);

76 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

77 ((
dëachty≥
->
swôchoff
 & 0x1) << 3) |

78 (
dëachty≥
->
ty≥ofdëach
 & 0x7);

79 
ícoded
++;

80  
ícoded
;

81 
	}
}

83 
uöt8_t
 
	$ícode_u8_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
)

85 
uöt8_t
 
buf„rRëu∫
;

86 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

87 
uöt8_t
 
ícoded
 = 0;

88 
uöt8_t
 
õi
 = 0;

89 #i‡
	`deföed
 (
NAS_DEBUG
)

90 
	`dump_dëach_ty≥_xml
(
dëachty≥
, 0);

92 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

93 ((
dëachty≥
->
swôchoff
 & 0x1) << 3) |

94 (
dëachty≥
->
ty≥ofdëach
 & 0x7);

95 
ícoded
++;

97  
buf„rRëu∫
;

98 
	}
}

100 
	$dump_dëach_ty≥_xml
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
)

102 
	`¥ötf
("<Detach Type>\n");

103 i‡(
õi
 > 0)

105 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

106 
	`¥ötf
(" <Swôch off>%u</Swôch off>\n", 
dëachty≥
->
swôchoff
);

107 
	`¥ötf
(" <Ty≥ o‡dëach>%u</Ty≥ o‡dëach>\n", 
dëachty≥
->
ty≥ofdëach
);

108 
	`¥ötf
("</Detach Type>\n");

109 
	}
}

	@src/ies/DetachType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
DETACH_TYPE_H_


36 
	#DETACH_TYPE_H_


	)

38 
	#DETACH_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#DETACH_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	sDëachTy≥_èg
 {

42 
	#DETACH_TYPE_NORMAL_DETACH
 0

	)

43 
	#DETACH_TYPE_SWITCH_OFF
 1

	)

44 
uöt8_t
 
	mswôchoff
:1;

45 
	#DETACH_TYPE_EPS
 0b001

	)

46 
	#DETACH_TYPE_IMSI
 0b010

	)

47 
	#DETACH_TYPE_EPS_IMSI
 0b011

	)

48 
	#DETACH_TYPE_RESERVED_1
 0b110

	)

49 
	#DETACH_TYPE_RESERVED_2
 0b111

	)

50 
uöt8_t
 
	mty≥ofdëach
:3;

51 } 
	tDëachTy≥
;

53 
ícode_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
dump_dëach_ty≥_xml
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
);

57 
uöt8_t
 
ícode_u8_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
);

59 
decode_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

61 
decode_u8_dëach_ty≥
(
DëachTy≥
 *
dëachty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/DrxParameter.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"DrxP¨amëî.h
"

38 
	$decode_drx_∑ømëî
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
drx∑ømëî
->
•lôpgcy˛ecode
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 
drx∑ømëî
->
˙•ecificdrxcy˛ñígthc€fficõ¡™ddrxvÆuef‹s1mode
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

49 
drx∑ømëî
->
•lô⁄ccch
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

50 
drx∑ømëî
->
n⁄drxtimî
 = *(
buf„r
 + 
decoded
) & 0x7;

51 
decoded
++;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_drx_∑ømëî_xml
(
drx∑ømëî
, 
õi
);

55  
decoded
;

56 
	}
}

58 
	$ícode_drx_∑ømëî
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

60 
uöt32_t
 
ícoded
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
DRX_PARAMETER_MINIMUM_LENGTH
, 
Àn
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_drx_∑ømëî_xml
(
drx∑ømëî
, 
õi
);

66 i‡(
õi
 > 0)

68 *
buf„r
 = 
õi
;

69 
ícoded
++;

71 *(
buf„r
 + 
ícoded
Ë
drx∑ømëî
->
•lôpgcy˛ecode
;

72 
ícoded
++;

73 *(
buf„r
 + 
ícoded
Ë0x00 | ((
drx∑ømëî
->
˙•ecificdrxcy˛ñígthc€fficõ¡™ddrxvÆuef‹s1mode
 & 0xf) << 4) |

74 ((
drx∑ømëî
->
•lô⁄ccch
 & 0x1) << 3) |

75 (
drx∑ømëî
->
n⁄drxtimî
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
	$dump_drx_∑ømëî_xml
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
)

82 
	`¥ötf
("<Drx Parameter>\n");

83 i‡(
õi
 > 0)

85 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

86 
	`¥ötf
(" <SPLIT PG CYCLE CODE>%u</SPLIT PG CYCLE CODE>\n", 
drx∑ømëî
->
•lôpgcy˛ecode
);

87 
	`¥ötf
(" <CN s≥cifi¯DRX cy˛êÀngth c€fficõ¡ánd DRX vÆuêf‹ S1 mode>%u</CN s≥cifi¯DRX cy˛êÀngth c€fficõ¡ánd DRX vÆuêf‹ S1 mode>\n", 
drx∑ømëî
->
˙•ecificdrxcy˛ñígthc€fficõ¡™ddrxvÆuef‹s1mode
);

88 
	`¥ötf
(" <SPLIT o¿CCCH>%u</SPLIT o¿CCCH>\n", 
drx∑ømëî
->
•lô⁄ccch
);

89 
	`¥ötf
(" <n⁄ DRXÅimî>%u</n⁄ DRXÅimî>\n", 
drx∑ømëî
->
n⁄drxtimî
);

90 
	`¥ötf
("</Drx Parameter>\n");

91 
	}
}

	@src/ies/DrxParameter.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
DRX_PARAMETER_H_


36 
	#DRX_PARAMETER_H_


	)

38 
	#DRX_PARAMETER_MINIMUM_LENGTH
 3

	)

39 
	#DRX_PARAMETER_MAXIMUM_LENGTH
 3

	)

41 
	sDrxP¨amëî_èg
 {

42 
uöt8_t
 
	m•lôpgcy˛ecode
;

43 
uöt8_t
 
	m˙•ecificdrxcy˛ñígthc€fficõ¡™ddrxvÆuef‹s1mode
:4;

44 
uöt8_t
 
	m•lô⁄ccch
:1;

45 
uöt8_t
 
	mn⁄drxtimî
:3;

46 } 
	tDrxP¨amëî
;

48 
ícode_drx_∑ømëî
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

50 
dump_drx_∑ømëî_xml
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
);

52 
decode_drx_∑ømëî
(
DrxP¨amëî
 *
drx∑ømëî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/EmergencyNumberList.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EmîgícyNumbîLi°.h
"

38 
	$decode_emîgícy_numbî_li°
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
emîgícynumbîli°
->
Àngtho„mîgícy
 = *(
buf„r
 + 
decoded
);

51 
decoded
++;

52 
emîgícynumbîli°
->
emîgícy£rvi˚ˇãg‹yvÆue
 = *(
buf„r
 + 
decoded
) & 0x1f;

53 
decoded
++;

54 #i‡
	`deföed
 (
NAS_DEBUG
)

55 
	`dump_emîgícy_numbî_li°_xml
(
emîgícynumbîli°
, 
õi
);

57  
decoded
;

58 
	}
}

59 
	$ícode_emîgícy_numbî_li°
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

61 
uöt8_t
 *
ÀnPå
;

62 
uöt32_t
 
ícoded
 = 0;

64 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EMERGENCY_NUMBER_LIST_MINIMUM_LENGTH
, 
Àn
);

65 #i‡
	`deföed
 (
NAS_DEBUG
)

66 
	`dump_emîgícy_numbî_li°_xml
(
emîgícynumbîli°
, 
õi
);

68 i‡(
õi
 > 0)

70 *
buf„r
 = 
õi
;

71 
ícoded
++;

73 
ÀnPå
 = (
buf„r
 + 
ícoded
);

74 
ícoded
 ++;

75 *(
buf„r
 + 
ícoded
Ë
emîgícynumbîli°
->
Àngtho„mîgícy
;

76 
ícoded
++;

77 *(
buf„r
 + 
ícoded
) = 0x00 |

78 (
emîgícynumbîli°
->
emîgícy£rvi˚ˇãg‹yvÆue
 & 0x1f);

79 
ícoded
++;

80 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

81  
ícoded
;

82 
	}
}

84 
	$dump_emîgícy_numbî_li°_xml
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
)

86 
	`¥ötf
("<Emergency Number List>\n");

87 i‡(
õi
 > 0)

89 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

90 
	`¥ötf
(" <Lígth o‡emîgícy>%u</Lígth o‡emîgícy>\n", 
emîgícynumbîli°
->
Àngtho„mîgícy
);

91 
	`¥ötf
(" <Emîgícy sîvi˚ c©eg‹y vÆue>%u</Emîgícy sîvi˚ c©eg‹y vÆue>\n", 
emîgícynumbîli°
->
emîgícy£rvi˚ˇãg‹yvÆue
);

92 
	`¥ötf
("</Emergency Number List>\n");

93 
	}
}

	@src/ies/EmergencyNumberList.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EMERGENCY_NUMBER_LIST_H_


36 
	#EMERGENCY_NUMBER_LIST_H_


	)

38 
	#EMERGENCY_NUMBER_LIST_MINIMUM_LENGTH
 5

	)

39 
	#EMERGENCY_NUMBER_LIST_MAXIMUM_LENGTH
 50

	)

41 
	sEmîgícyNumbîLi°_èg
 {

42 
uöt8_t
 
	mÀngtho„mîgícy
;

43 
uöt8_t
 
	memîgícy£rvi˚ˇãg‹yvÆue
:5;

44 } 
	tEmîgícyNumbîLi°
;

46 
ícode_emîgícy_numbî_li°
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
decode_emîgícy_numbî_li°
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

50 
dump_emîgícy_numbî_li°_xml
(
EmîgícyNumbîLi°
 *
emîgícynumbîli°
, 
uöt8_t
 
õi
);

	@src/ies/EmmCause.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EmmCau£.h
"

38 
	$decode_emm_ˇu£
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
emmˇu£
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_emm_ˇu£_xml
(
emmˇu£
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_emm_ˇu£
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EMM_CAUSE_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_emm_ˇu£_xml
(
emmˇu£
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
Ë*
emmˇu£
;

68 
ícoded
++;

69  
ícoded
;

70 
	}
}

72 
	$dump_emm_ˇu£_xml
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
)

74 
	`¥ötf
("<Emm Cause>\n");

75 i‡(
õi
 > 0)

77 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

78 
	`¥ötf
(" <Cau£ vÆue>%u</Cau£ vÆue>\n", *
emmˇu£
);

79 
	`¥ötf
("</Emm Cause>\n");

80 
	}
}

	@src/ies/EmmCause.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EMM_CAUSE_H_


36 
	#EMM_CAUSE_H_


	)

38 
	#EMM_CAUSE_MINIMUM_LENGTH
 1

	)

39 
	#EMM_CAUSE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tEmmCau£
;

43 
ícode_emm_ˇu£
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_emm_ˇu£_xml
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
);

47 
decode_emm_ˇu£
(
EmmCau£
 *
emmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/EpsAttachResult.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsAâachResu….h
"

38 
	$decode_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EPS_ATTACH_RESULT_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
ïßâachªsu…
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ïs_©èch_ªsu…_xml
(
ïßâachªsu…
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
ïßâachªsu…
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ïs_©èch_ªsu…_xml
(
ïßâachªsu…
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_ATTACH_RESULT_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ïs_©èch_ªsu…_xml
(
ïßâachªsu…
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
ïßâachªsu…
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_ïs_©èch_ªsu…_xml
(
ïßâachªsu…
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
ïßâachªsu…
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_ïs_©èch_ªsu…_xml
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Eps Attach Result>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <EPSáâachÑesu… vÆue>%u</EPSáâachÑesu… vÆue>\n", *
ïßâachªsu…
);

103 
	`¥ötf
("</Eps Attach Result>\n");

104 
	}
}

	@src/ies/EpsAttachResult.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_ATTACH_RESULT_H_


36 
	#EPS_ATTACH_RESULT_H_


	)

38 
	#EPS_ATTACH_RESULT_MINIMUM_LENGTH
 1

	)

39 
	#EPS_ATTACH_RESULT_MAXIMUM_LENGTH
 1

	)

41 
	#EPS_ATTACH_RESULT_EPS
 0b001

	)

42 
	#EPS_ATTACH_RESULT_EPS_IMSI
 0b010

	)

43 
uöt8_t
 
	tEpsAâachResu…
;

45 
ícode_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_ïs_©èch_ªsu…_xml
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
);

49 
uöt8_t
 
ícode_u8_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
);

51 
decode_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
decode_u8_ïs_©èch_ªsu…
(
EpsAâachResu…
 *
ïßâachªsu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/EpsAttachType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsAâachTy≥.h
"

38 
	$decode_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EPS_ATTACH_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
ïßâachty≥
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ïs_©èch_ty≥_xml
(
ïßâachty≥
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
ïßâachty≥
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ïs_©èch_ty≥_xml
(
ïßâachty≥
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_ATTACH_TYPE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ïs_©èch_ty≥_xml
(
ïßâachty≥
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
ïßâachty≥
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_ïs_©èch_ty≥_xml
(
ïßâachty≥
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
ïßâachty≥
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_ïs_©èch_ty≥_xml
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Eps Attach Type>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <EPSáâachÅy≥ vÆue>%u</EPSáâachÅy≥ vÆue>\n", *
ïßâachty≥
);

103 
	`¥ötf
("</Eps Attach Type>\n");

104 
	}
}

	@src/ies/EpsAttachType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_ATTACH_TYPE_H_


36 
	#EPS_ATTACH_TYPE_H_


	)

38 
	#EPS_ATTACH_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#EPS_ATTACH_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	#EPS_ATTACH_TYPE_EPS
 0b0001

	)

42 
	#EPS_ATTACH_TYPE_IMSI
 0b0010

	)

43 
	#EPS_ATTACH_TYPE_EMERGENCY
 0b0110

	)

44 
	#EPS_ATTACH_TYPE_RESERVED
 0b0111

	)

45 
uöt8_t
 
	tEpsAâachTy≥
;

47 
ícode_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_ïs_©èch_ty≥_xml
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
);

51 
uöt8_t
 
ícode_u8_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
);

53 
decode_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
decode_u8_ïs_©èch_ty≥
(
EpsAâachTy≥
 *
ïßâachty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/EpsBearerContextStatus.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsBóªrC⁄ãxtSètus.h
"

38 
	$decode_ïs_bóªr_c⁄ãxt_°©us
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, *
ïsbóªrc⁄ãxt°©us
);

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_ïs_bóªr_c⁄ãxt_°©us_xml
(
ïsbóªrc⁄ãxt°©us
, 
õi
);

55  
decoded
;

56 
	}
}

57 
	$ícode_ïs_bóªr_c⁄ãxt_°©us
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
uöt8_t
 *
ÀnPå
;

60 
uöt32_t
 
ícoded
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_BEARER_CONTEXT_STATUS_MINIMUM_LENGTH
, 
Àn
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_ïs_bóªr_c⁄ãxt_°©us_xml
(
ïsbóªrc⁄ãxt°©us
, 
õi
);

66 i‡(
õi
 > 0)

68 *
buf„r
 = 
õi
;

69 
ícoded
++;

71 
ÀnPå
 = (
buf„r
 + 
ícoded
);

72 
ícoded
 ++;

73 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, *
ïsbóªrc⁄ãxt°©us
);

74 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

75  
ícoded
;

76 
	}
}

78 
	$dump_ïs_bóªr_c⁄ãxt_°©us_xml
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
)

80 
	`¥ötf
("<Eps Bearer Context Status>\n");

81 
	`¥ötf
(" <EBI>%u</EBI>\n", *
ïsbóªrc⁄ãxt°©us
);

82 
	`¥ötf
("</Eps Bearer Context Status>\n");

83 
	}
}

	@src/ies/EpsBearerContextStatus.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_BEARER_CONTEXT_STATUS_H_


36 
	#EPS_BEARER_CONTEXT_STATUS_H_


	)

38 
	#EPS_BEARER_CONTEXT_STATUS_MINIMUM_LENGTH
 4

	)

39 
	#EPS_BEARER_CONTEXT_STATUS_MAXIMUM_LENGTH
 4

	)

41 
uöt16_t
 
	tEpsBóªrC⁄ãxtSètus
;

43 
ícode_ïs_bóªr_c⁄ãxt_°©us
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
decode_ïs_bóªr_c⁄ãxt_°©us
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_ïs_bóªr_c⁄ãxt_°©us_xml
(
EpsBóªrC⁄ãxtSètus
 *
ïsbóªrc⁄ãxt°©us
, 
uöt8_t
 
õi
);

	@src/ies/EpsBearerIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsBóªrIdítôy.h
"

38 
	$decode_ïs_bóªr_idítôy
(
EpsBóªrIdítôy
 *
ïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_ïs_bóªr_idítôy
(
EpsBóªrIdítôy
 *
ïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/EpsBearerIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_BEARER_IDENTITY_H_


36 
	#EPS_BEARER_IDENTITY_H_


	)

38 
	#EPS_BEARER_IDENTITY_MINIMUM_LENGTH
 1

	)

39 
	#EPS_BEARER_IDENTITY_MAXIMUM_LENGTH
 1

	)

41 
	#EPS_BEARER_IDENTITY_UNASSIGNED
 0

	)

42 
	#EPS_BEARER_IDENTITY_FIRST
 5

	)

43 
	#EPS_BEARER_IDENTITY_LAST
 15

	)

44 
uöt8_t
 
	tEpsBóªrIdítôy
;

46 
ícode_ïs_bóªr_idítôy
(
EpsBóªrIdítôy
 *
ïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
dump_ïs_bóªr_idítôy_xml
(
EpsBóªrIdítôy
 *
ïsbóªridítôy
, 
uöt8_t
 
õi
);

50 
decode_ïs_bóªr_idítôy
(
EpsBóªrIdítôy
 *
ïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/EpsMobileIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsMobûeIdítôy.h
"

38 
decode_guti_ïs_mobûe_idítôy
(
GutiEpsMobûeIdítôy_t
 *
guti
, 
uöt8_t
 *
buf„r
);

39 
decode_imsi_ïs_mobûe_idítôy
(
ImsiEpsMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
);

40 
decode_imei_ïs_mobûe_idítôy
(
ImeiEpsMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
);

42 
ícode_guti_ïs_mobûe_idítôy
(
GutiEpsMobûeIdítôy_t
 *
guti
, 
uöt8_t
 *
buf„r
);

43 
ícode_imsi_ïs_mobûe_idítôy
(
ImsiEpsMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
);

44 
ícode_imei_ïs_mobûe_idítôy
(
ImeiEpsMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
);

46 
	$decode_ïs_mobûe_idítôy
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

48 
decoded_rc
 = 
TLV_DECODE_VALUE_DOESNT_MATCH
;

49 
decoded
 = 0;

50 
uöt8_t
 
õÀn
 = 0;

51 i‡(
õi
 > 0)

53 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

54 
decoded
++;

56 
õÀn
 = *(
buf„r
 + 
decoded
);

57 
decoded
++;

58 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

60 
uöt8_t
 
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

61 i‡(
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

62 
decoded_rc
 = 
	`decode_imsi_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
imsi
,

63 
buf„r
 + 
decoded
);

64 } i‡(
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) {

65 
decoded_rc
 = 
	`decode_guti_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
guti
,

66 
buf„r
 + 
decoded
);

67 } i‡(
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
) {

68 
decoded_rc
 = 
	`decode_imei_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
imei
,

69 
buf„r
 + 
decoded
);

72 i‡(
decoded_rc
 < 0) {

73  
decoded_rc
;

75 #i‡
	`deföed
 (
NAS_DEBUG
)

76 
	`dump_ïs_mobûe_idítôy_xml
(
ïsmobûeidítôy
, 
õi
);

78  (
decoded
 + 
decoded_rc
);

79 
	}
}

81 
	$ícode_ïs_mobûe_idítôy
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

83 
uöt8_t
 *
ÀnPå
;

84 
ícoded_rc
 = 
TLV_ENCODE_VALUE_DOESNT_MATCH
;

85 
uöt32_t
 
ícoded
 = 0;

87 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

88 #i‡
	`deföed
 (
NAS_DEBUG
)

89 
	`dump_ïs_mobûe_idítôy_xml
(
ïsmobûeidítôy
, 
õi
);

91 i‡(
õi
 > 0)

93 *
buf„r
 = 
õi
;

94 
ícoded
++;

96 
ÀnPå
 = (
buf„r
 + 
ícoded
);

97 
ícoded
 ++;

99 i‡(
ïsmobûeidítôy
->
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
)

101 
ícoded_rc
 = 
	`ícode_imsi_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
imsi
,

102 
buf„r
 + 
ícoded
);

104 i‡(
ïsmobûeidítôy
->
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
)

106 
ícoded_rc
 = 
	`ícode_guti_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
guti
,

107 
buf„r
 + 
ícoded
);

109 i‡(
ïsmobûeidítôy
->
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
)

111 
ícoded_rc
 = 
	`ícode_imei_ïs_mobûe_idítôy
(&
ïsmobûeidítôy
->
imei
,

112 
buf„r
 + 
ícoded
);

115 i‡(
ícoded_rc
 < 0) {

116  
ícoded_rc
;

118 *
ÀnPå
 = 
ícoded
 + 
ícoded_rc
 - 1 - ((
õi
 > 0) ? 1 : 0);

119  (
ícoded
 + 
ícoded_rc
);

120 
	}
}

122 
	$dump_ïs_mobûe_idítôy_xml
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
)

124 
	`¥ötf
("<Eps Mobile Identity>\n");

125 i‡(
õi
 > 0)

127 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

129 i‡(
ïsmobûeidítôy
->
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

130 
ImsiEpsMobûeIdítôy_t
* 
imsi
 = &
ïsmobûeidítôy
->imsi;

131 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
imsi
->
oddeví
);

132 
	`¥ötf
(" <Type of identity>IMSI</Type of identity>\n");

133 
	`¥ötf
(" <digô1>%u</digô1>\n", 
imsi
->
digô1
);

134 
	`¥ötf
(" <digô2>%u</digô2>\n", 
imsi
->
digô2
);

135 
	`¥ötf
(" <digô3>%u</digô3>\n", 
imsi
->
digô3
);

136 
	`¥ötf
(" <digô4>%u</digô4>\n", 
imsi
->
digô4
);

137 
	`¥ötf
(" <digô5>%u</digô5>\n", 
imsi
->
digô5
);

138 
	`¥ötf
(" <digô6>%u</digô6>\n", 
imsi
->
digô6
);

139 
	`¥ötf
(" <digô7>%u</digô7>\n", 
imsi
->
digô7
);

140 
	`¥ötf
(" <digô8>%u</digô8>\n", 
imsi
->
digô8
);

141 
	`¥ötf
(" <digô9>%u</digô9>\n", 
imsi
->
digô9
);

142 
	`¥ötf
(" <digô10>%u</digô10>\n", 
imsi
->
digô10
);

143 
	`¥ötf
(" <digô11>%u</digô11>\n", 
imsi
->
digô11
);

144 
	`¥ötf
(" <digô12>%u</digô12>\n", 
imsi
->
digô12
);

145 
	`¥ötf
(" <digô13>%u</digô13>\n", 
imsi
->
digô13
);

146 
	`¥ötf
(" <digô14>%u</digô14>\n", 
imsi
->
digô14
);

147 
	`¥ötf
(" <digô15>%u</digô15>\n", 
imsi
->
digô15
);

149 i‡(
ïsmobûeidítôy
->
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
)

151 
GutiEpsMobûeIdítôy_t
* 
guti
 = &
ïsmobûeidítôy
->guti;

152 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
guti
->
oddeví
);

153 
	`¥ötf
(" <Type of identity>GUTI</Type of identity>\n");

154 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
guti
->
mccdigô1
);

155 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
guti
->
mccdigô2
);

156 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
guti
->
mccdigô3
);

157 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
guti
->
mncdigô1
);

158 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
guti
->
mncdigô2
);

159 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
guti
->
mncdigô3
);

160 
	`¥ötf
(" <MME grou∞id>%u</MME grou∞id>\n", 
guti
->
mmegroupid
);

161 
	`¥ötf
(" <MME code>%u</MME code>\n", 
guti
->
mmecode
);

162 
	`¥ötf
(" <M TMSI>%u</M TMSI>\n", 
guti
->
mtmsi
);

164 i‡(
ïsmobûeidítôy
->
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
)

166 
ImeiEpsMobûeIdítôy_t
* 
imei
 = &
ïsmobûeidítôy
->imei;

167 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
imei
->
oddeví
);

168 
	`¥ötf
(" <Type of identity>IMEI</Type of identity>\n");

169 
	`¥ötf
(" <digô1>%u</digô1>\n", 
imei
->
digô1
);

170 
	`¥ötf
(" <digô2>%u</digô2>\n", 
imei
->
digô2
);

171 
	`¥ötf
(" <digô3>%u</digô3>\n", 
imei
->
digô3
);

172 
	`¥ötf
(" <digô4>%u</digô4>\n", 
imei
->
digô4
);

173 
	`¥ötf
(" <digô5>%u</digô5>\n", 
imei
->
digô5
);

174 
	`¥ötf
(" <digô6>%u</digô6>\n", 
imei
->
digô6
);

175 
	`¥ötf
(" <digô7>%u</digô7>\n", 
imei
->
digô7
);

176 
	`¥ötf
(" <digô8>%u</digô8>\n", 
imei
->
digô8
);

177 
	`¥ötf
(" <digô9>%u</digô9>\n", 
imei
->
digô9
);

178 
	`¥ötf
(" <digô10>%u</digô10>\n", 
imei
->
digô10
);

179 
	`¥ötf
(" <digô11>%u</digô11>\n", 
imei
->
digô11
);

180 
	`¥ötf
(" <digô12>%u</digô12>\n", 
imei
->
digô12
);

181 
	`¥ötf
(" <digô13>%u</digô13>\n", 
imei
->
digô13
);

182 
	`¥ötf
(" <digô14>%u</digô14>\n", 
imei
->
digô14
);

183 
	`¥ötf
(" <digô15>%u</digô15>\n", 
imei
->
digô15
);

186 
	`¥ötf
(" Wr⁄gÅy≥ o‡EPS mobûêidítôy (%u)\n", 
ïsmobûeidítôy
->
guti
.
ty≥ofidítôy
);

188 
	`¥ötf
("</Eps Mobile Identity>\n");

189 
	}
}

191 
	$decode_guti_ïs_mobûe_idítôy
(
GutiEpsMobûeIdítôy_t
 *
guti
, 
uöt8_t
 *
buf„r
)

193 
decoded
 = 0;

194 
guti
->
•¨e
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

198 i‡(
guti
->
•¨e
 != 0xf) {

199  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

201 
guti
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

202 
guti
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

203 i‡(
guti
->
ty≥ofidítôy
 !
EPS_MOBILE_IDENTITY_GUTI
) {

204  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

206 
decoded
++;

207 
guti
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

208 
guti
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

209 
decoded
++;

210 
guti
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

211 
guti
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

212 
decoded
++;

213 
guti
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

214 
guti
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

215 
decoded
++;

217 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
guti
->
mmegroupid
);

218 
guti
->
mmecode
 = *(
buf„r
 + 
decoded
);

219 
decoded
++;

221 
	`IES_DECODE_U32
(
buf„r
, 
decoded
, 
guti
->
mtmsi
);

222  
decoded
;

223 
	}
}

225 
	$decode_imsi_ïs_mobûe_idítôy
(
ImsiEpsMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
)

227 
decoded
 = 0;

228 
imsi
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

229 i‡(
imsi
->
ty≥ofidítôy
 !
EPS_MOBILE_IDENTITY_IMSI
) {

230  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

232 
imsi
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

233 
imsi
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

234 
decoded
++;

235 
imsi
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

236 
imsi
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

237 
decoded
++;

238 
imsi
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

239 
imsi
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

240 
decoded
++;

241 
imsi
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

242 
imsi
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

243 
decoded
++;

244 
imsi
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

245 
imsi
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

246 
decoded
++;

247 
imsi
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

248 
imsi
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

249 
decoded
++;

250 
imsi
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

251 
imsi
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

252 
decoded
++;

253 
imsi
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

254 
imsi
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

260 i‡((
imsi
->
oddeví
 =
EPS_MOBILE_IDENTITY_EVEN
Ë&& (imsi->
digô15
 != 0x0f))

262  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

264 
decoded
++;

265  
decoded
;

266 
	}
}

268 
	$decode_imei_ïs_mobûe_idítôy
(
ImeiEpsMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
)

270 
decoded
 = 0;

271 
imei
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

272 i‡(
imei
->
ty≥ofidítôy
 !
EPS_MOBILE_IDENTITY_IMEI
) {

273  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

275 
imei
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

276 
imei
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

277 
decoded
++;

278 
imei
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

279 
imei
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

280 
decoded
++;

281 
imei
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

282 
imei
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

283 
decoded
++;

284 
imei
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

285 
imei
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

286 
decoded
++;

287 
imei
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

288 
imei
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

289 
decoded
++;

290 
imei
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

291 
imei
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

292 
decoded
++;

293 
imei
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

294 
imei
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

295 
decoded
++;

296 
imei
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

297 
imei
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

298 
decoded
++;

299  
decoded
;

300 
	}
}

302 
	$ícode_guti_ïs_mobûe_idítôy
(
GutiEpsMobûeIdítôy_t
 *
guti
, 
uöt8_t
 *
buf„r
)

304 
uöt32_t
 
ícoded
 = 0;

305 *(
buf„r
 + 
ícoded
Ë0xf0 | ((
guti
->
oddeví
 & 0x1) << 3) |

306 (
guti
->
ty≥ofidítôy
 & 0x7);

307 
ícoded
++;

308 *(
buf„r
 + 
ícoded
Ë0x00 | ((
guti
->
mccdigô2
 & 0xf) << 4) |

309 (
guti
->
mccdigô1
 & 0xf);

310 
ícoded
++;

311 *(
buf„r
 + 
ícoded
Ë0x00 | ((
guti
->
mncdigô3
 & 0xf) << 4) |

312 (
guti
->
mccdigô3
 & 0xf);

313 
ícoded
++;

314 *(
buf„r
 + 
ícoded
Ë0x00 | ((
guti
->
mncdigô2
 & 0xf) << 4) |

315 (
guti
->
mncdigô1
 & 0xf);

316 
ícoded
++;

317 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
guti
->
mmegroupid
);

318 *(
buf„r
 + 
ícoded
Ë
guti
->
mmecode
;

319 
ícoded
++;

320 
	`IES_ENCODE_U32
(
buf„r
, 
ícoded
, 
guti
->
mtmsi
);

321  
ícoded
;

322 
	}
}

324 
	$ícode_imsi_ïs_mobûe_idítôy
(
ImsiEpsMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
)

326 
uöt32_t
 
ícoded
 = 0;

327 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô1
 << 4Ë| (imsi->
oddeví
 << 3) |

328 (
imsi
->
ty≥ofidítôy
);

329 
ícoded
++;

330 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô3
 << 4Ë| imsi->
digô2
;

331 
ícoded
++;

332 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô5
 << 4Ë| imsi->
digô4
;

333 
ícoded
++;

334 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô7
 << 4Ë| imsi->
digô6
;

335 
ícoded
++;

336 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô9
 << 4Ë| imsi->
digô8
;

337 
ícoded
++;

338 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô11
 << 4Ë| imsi->
digô10
;

339 
ícoded
++;

340 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô13
 << 4Ë| imsi->
digô12
;

341 
ícoded
++;

342 i‡(
imsi
->
oddeví
 !
EPS_MOBILE_IDENTITY_EVEN
) {

343 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô15
 << 4Ë| imsi->
digô14
;

346 *(
buf„r
 + 
ícoded
Ë0xf0 | 
imsi
->
digô14
;

348 
ícoded
++;

349  
ícoded
;

350 
	}
}

352 
	$ícode_imei_ïs_mobûe_idítôy
(
ImeiEpsMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
)

354 
uöt32_t
 
ícoded
 = 0;

355 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô1
 << 4Ë| (imei->
oddeví
 << 3) |

356 (
imei
->
ty≥ofidítôy
);

357 
ícoded
++;

358 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô3
 << 4Ë| imei->
digô2
;

359 
ícoded
++;

360 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô5
 << 4Ë| imei->
digô4
;

361 
ícoded
++;

362 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô7
 << 4Ë| imei->
digô6
;

363 
ícoded
++;

364 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô9
 << 4Ë| imei->
digô8
;

365 
ícoded
++;

366 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô11
 << 4Ë| imei->
digô10
;

367 
ícoded
++;

368 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô13
 << 4Ë| imei->
digô12
;

369 
ícoded
++;

370 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô15
 << 4Ë| imei->
digô14
;

371 
ícoded
++;

372  
ícoded
;

373 
	}
}

	@src/ies/EpsMobileIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_MOBILE_IDENTITY_H_


36 
	#EPS_MOBILE_IDENTITY_H_


	)

38 
	#EPS_MOBILE_IDENTITY_MINIMUM_LENGTH
 3

	)

39 
	#EPS_MOBILE_IDENTITY_MAXIMUM_LENGTH
 13

	)

42 
uöt8_t
 
	m•¨e
:4;

43 
	#EPS_MOBILE_IDENTITY_EVEN
 0

	)

44 
	#EPS_MOBILE_IDENTITY_ODD
 1

	)

45 
uöt8_t
 
	moddeví
:1;

46 
uöt8_t
 
	mty≥ofidítôy
:3;

47 
uöt8_t
 
	mmccdigô2
:4;

48 
uöt8_t
 
	mmccdigô1
:4;

49 
uöt8_t
 
	mmncdigô3
:4;

50 
uöt8_t
 
	mmccdigô3
:4;

51 
uöt8_t
 
	mmncdigô2
:4;

52 
uöt8_t
 
	mmncdigô1
:4;

53 
uöt16_t
 
	mmmegroupid
;

54 
uöt8_t
 
	mmmecode
;

55 
uöt32_t
 
	mmtmsi
;

56 } 
	tGutiEpsMobûeIdítôy_t
;

59 
uöt8_t
 
	mdigô1
:4;

60 
uöt8_t
 
	moddeví
:1;

61 
uöt8_t
 
	mty≥ofidítôy
:3;

62 
uöt8_t
 
	mdigô2
:4;

63 
uöt8_t
 
	mdigô3
:4;

64 
uöt8_t
 
	mdigô4
:4;

65 
uöt8_t
 
	mdigô5
:4;

66 
uöt8_t
 
	mdigô6
:4;

67 
uöt8_t
 
	mdigô7
:4;

68 
uöt8_t
 
	mdigô8
:4;

69 
uöt8_t
 
	mdigô9
:4;

70 
uöt8_t
 
	mdigô10
:4;

71 
uöt8_t
 
	mdigô11
:4;

72 
uöt8_t
 
	mdigô12
:4;

73 
uöt8_t
 
	mdigô13
:4;

74 
uöt8_t
 
	mdigô14
:4;

75 
uöt8_t
 
	mdigô15
:4;

76 } 
	tImsiEpsMobûeIdítôy_t
;

78 
ImsiEpsMobûeIdítôy_t
 
	tImeiEpsMobûeIdítôy_t
;

80 
	uEpsMobûeIdítôy_èg
 {

81 
	#EPS_MOBILE_IDENTITY_IMSI
 0b001

	)

82 
	#EPS_MOBILE_IDENTITY_GUTI
 0b110

	)

83 
	#EPS_MOBILE_IDENTITY_IMEI
 0b011

	)

84 
ImsiEpsMobûeIdítôy_t
 
	mimsi
;

85 
GutiEpsMobûeIdítôy_t
 
	mguti
;

86 
ImeiEpsMobûeIdítôy_t
 
	mimei
;

87 } 
	tEpsMobûeIdítôy
;

89 
ícode_ïs_mobûe_idítôy
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

91 
decode_ïs_mobûe_idítôy
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

93 
dump_ïs_mobûe_idítôy_xml
(
EpsMobûeIdítôy
 *
ïsmobûeidítôy
, 
uöt8_t
 
õi
);

	@src/ies/EpsNetworkFeatureSupport.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsNëw‹kFótuªSuµ‹t.h
"

38 
	$decode_ïs_√tw‹k_„©uª_suµ‹t
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 *
ï¢ëw‹k„©uªsuµ‹t
 = *
buf„r
 & 0x1;

51 
decoded
++;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_ïs_√tw‹k_„©uª_suµ‹t_xml
(
ï¢ëw‹k„©uªsuµ‹t
, 
õi
);

55  
decoded
;

56 
	}
}

57 
	$ícode_ïs_√tw‹k_„©uª_suµ‹t
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
uöt8_t
 *
ÀnPå
;

60 
uöt32_t
 
ícoded
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_NETWORK_FEATURE_SUPPORT_MINIMUM_LENGTH
, 
Àn
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_ïs_√tw‹k_„©uª_suµ‹t_xml
(
ï¢ëw‹k„©uªsuµ‹t
, 
õi
);

66 i‡(
õi
 > 0)

68 *
buf„r
 = 
õi
;

69 
ícoded
++;

71 
ÀnPå
 = (
buf„r
 + 
ícoded
);

72 
ícoded
 ++;

73 *(
buf„r
 + 
ícoded
) = 0x00 |

74 (*
ï¢ëw‹k„©uªsuµ‹t
 & 0x1);

75 
ícoded
++;

76 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

77  
ícoded
;

78 
	}
}

80 
	$dump_ïs_√tw‹k_„©uª_suµ‹t_xml
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
)

82 
	`¥ötf
("<Eps Network Feature Support>\n");

83 i‡(
õi
 > 0)

85 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

86 
	`¥ötf
(" <IMS VoPS>%u</IMS VoPS>\n", *
ï¢ëw‹k„©uªsuµ‹t
);

87 
	`¥ötf
("</Eps Network Feature Support>\n");

88 
	}
}

	@src/ies/EpsNetworkFeatureSupport.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_NETWORK_FEATURE_SUPPORT_H_


36 
	#EPS_NETWORK_FEATURE_SUPPORT_H_


	)

38 
	#EPS_NETWORK_FEATURE_SUPPORT_MINIMUM_LENGTH
 3

	)

39 
	#EPS_NETWORK_FEATURE_SUPPORT_MAXIMUM_LENGTH
 3

	)

41 
uöt8_t
 
	tEpsNëw‹kFótuªSuµ‹t
;

43 
ícode_ïs_√tw‹k_„©uª_suµ‹t
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
decode_ïs_√tw‹k_„©uª_suµ‹t
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_ïs_√tw‹k_„©uª_suµ‹t_xml
(
EpsNëw‹kFótuªSuµ‹t
 *
ï¢ëw‹k„©uªsuµ‹t
, 
uöt8_t
 
õi
);

	@src/ies/EpsQualityOfService.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsQuÆôyOfSîvi˚.h
"

38 
	$decode_ïs_qos_bô_øãs
(
EpsQoSBôR©es
* 
ïsqosbôøãs
, c⁄° 
uöt8_t
 *
buf„r
)

40 
decoded
 = 0;

41 
ïsqosbôøãs
->
maxBôR©eF‹UL
 = *(
buf„r
 + 
decoded
);

42 
decoded
++;

43 
ïsqosbôøãs
->
maxBôR©eF‹DL
 = *(
buf„r
 + 
decoded
);

44 
decoded
++;

45 
ïsqosbôøãs
->
gu¨BôR©eF‹UL
 = *(
buf„r
 + 
decoded
);

46 
decoded
++;

47 
ïsqosbôøãs
->
gu¨BôR©eF‹DL
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49  
decoded
;

50 
	}
}

52 
	$decode_ïs_quÆôy_of_£rvi˚
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

54 
decoded
 = 0;

55 
uöt8_t
 
õÀn
 = 0;

56 i‡(
õi
 > 0)

58 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

59 
decoded
++;

61 
õÀn
 = *(
buf„r
 + 
decoded
);

62 
decoded
++;

63 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

64 
ïsquÆôyof£rvi˚
->
qci
 = *(
buf„r
 + 
decoded
);

65 
decoded
++;

66 i‡–
õÀn
 > 2 + (
õi
 > 0) ? 1 : 0 ) {

68 
ïsquÆôyof£rvi˚
->
bôR©esPª£¡
 = 1;

69 
decoded
 +
	`decode_ïs_qos_bô_øãs
(&
ïsquÆôyof£rvi˚
->
bôR©es
,

70 
buf„r
 + 
decoded
);

73 
ïsquÆôyof£rvi˚
->
bôR©esPª£¡
 = 0;

75 i‡–
õÀn
 > 6 + (
õi
 > 0) ? 1 : 0 ) {

77 
ïsquÆôyof£rvi˚
->
bôR©esExtPª£¡
 = 1;

78 
decoded
 +
	`decode_ïs_qos_bô_øãs
(&
ïsquÆôyof£rvi˚
->
bôR©esExt
,

79 
buf„r
 + 
decoded
);

82 
ïsquÆôyof£rvi˚
->
bôR©esExtPª£¡
 = 0;

85 #i‡
	`deföed
 (
NAS_DEBUG
)

86 
	`dump_ïs_quÆôy_of_£rvi˚_xml
(
ïsquÆôyof£rvi˚
, 
õi
);

88  
decoded
;

89 
	}
}

91 
	$ícode_ïs_qos_bô_øãs
(c⁄° 
EpsQoSBôR©es
* 
ïsqosbôøãs
, 
uöt8_t
 *
buf„r
)

93 
ícoded
 = 0;

94 *(
buf„r
 + 
ícoded
Ë
ïsqosbôøãs
->
maxBôR©eF‹UL
;

95 
ícoded
 ++;

96 *(
buf„r
 + 
ícoded
Ë
ïsqosbôøãs
->
maxBôR©eF‹DL
;

97 
ícoded
 ++;

98 *(
buf„r
 + 
ícoded
Ë
ïsqosbôøãs
->
gu¨BôR©eF‹UL
;

99 
ícoded
 ++;

100 *(
buf„r
 + 
ícoded
Ë
ïsqosbôøãs
->
gu¨BôR©eF‹DL
;

101 
ícoded
 ++;

102  
ícoded
;

103 
	}
}

105 
	$ícode_ïs_quÆôy_of_£rvi˚
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

107 
uöt8_t
 *
ÀnPå
;

108 
uöt32_t
 
ícoded
 = 0;

110 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_QUALITY_OF_SERVICE_MINIMUM_LENGTH
, 
Àn
);

111 #i‡
	`deföed
 (
NAS_DEBUG
)

112 
	`dump_ïs_quÆôy_of_£rvi˚_xml
(
ïsquÆôyof£rvi˚
, 
õi
);

114 i‡(
õi
 > 0)

116 *
buf„r
 = 
õi
;

117 
ícoded
++;

119 
ÀnPå
 = (
buf„r
 + 
ícoded
);

120 
ícoded
 ++;

121 *(
buf„r
 + 
ícoded
Ë
ïsquÆôyof£rvi˚
->
qci
;

122 
ícoded
++;

123 i‡(
ïsquÆôyof£rvi˚
->
bôR©esPª£¡
) {

124 
ícoded
 +
	`ícode_ïs_qos_bô_øãs
(&
ïsquÆôyof£rvi˚
->
bôR©es
,

125 
buf„r
 + 
ícoded
);

127 i‡(
ïsquÆôyof£rvi˚
->
bôR©esExtPª£¡
) {

128 
ícoded
 +
	`ícode_ïs_qos_bô_øãs
(&
ïsquÆôyof£rvi˚
->
bôR©esExt
,

129 
buf„r
 + 
ícoded
);

131 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

132  
ícoded
;

133 
	}
}

135 
	$dump_ïs_quÆôy_of_£rvi˚_xml
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
)

137 
	`¥ötf
("<Eps Quality Of Service>\n");

138 i‡(
õi
 > 0)

140 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

141 
	`¥ötf
(" <QCI>%u</QCI>\n", 
ïsquÆôyof£rvi˚
->
qci
);

142 i‡(
ïsquÆôyof£rvi˚
->
bôR©esPª£¡
) {

143 
	`¥ötf
(" <bitRates>\n");

144 
	`¥ötf
(" <maxBitRateForUL>%u</maxBitRateForUL>\n",

145 
ïsquÆôyof£rvi˚
->
bôR©es
.
maxBôR©eF‹UL
);

146 
	`¥ötf
(" <maxBitRateForDL>%u</maxBitRateForDL>\n",

147 
ïsquÆôyof£rvi˚
->
bôR©es
.
maxBôR©eF‹DL
);

148 
	`¥ötf
(" <guarBitRateForUL>%u</guarBitRateForUL>\n",

149 
ïsquÆôyof£rvi˚
->
bôR©es
.
gu¨BôR©eF‹UL
);

150 
	`¥ötf
(" <guarBitRateForDL>%u</guarBitRateForDL>\n",

151 
ïsquÆôyof£rvi˚
->
bôR©es
.
gu¨BôR©eF‹DL
);

152 
	`¥ötf
(" </bitRates>\n");

154 i‡(
ïsquÆôyof£rvi˚
->
bôR©esExtPª£¡
) {

155 
	`¥ötf
(" <bitRatesExt>\n");

156 
	`¥ötf
(" <maxBitRateForUL>%u</maxBitRateForUL>\n",

157 
ïsquÆôyof£rvi˚
->
bôR©esExt
.
maxBôR©eF‹UL
);

158 
	`¥ötf
(" <maxBitRateForDL>%u</maxBitRateForDL>\n",

159 
ïsquÆôyof£rvi˚
->
bôR©esExt
.
maxBôR©eF‹DL
);

160 
	`¥ötf
(" <guarBitRateForUL>%u</guarBitRateForUL>\n",

161 
ïsquÆôyof£rvi˚
->
bôR©esExt
.
gu¨BôR©eF‹UL
);

162 
	`¥ötf
(" <guarBitRateForDL>%u</guarBitRateForDL>\n",

163 
ïsquÆôyof£rvi˚
->
bôR©esExt
.
gu¨BôR©eF‹DL
);

164 
	`¥ötf
(" </bitRatesExt>\n");

166 
	`¥ötf
("</Eps Quality Of Service>\n");

167 
	}
}

169 
	#EPS_QOS_BIT_RATE_MAX
 262144

170 
	`ïs_qos_bô_øã_vÆue
(
uöt8_t
 
br
)

	)

172 i‡(
	gbr
 < 0b00000001) {

173  (
	gEPS_QOS_BIT_RATE_MAX
);

174 } i‡–(
	gbr
 > 0b00000000) && (br < 0b01000000) ) {

175  (
	gbr
);

176 } i‡–(
	gbr
 > 0b00111111) && (br < 0b10000000) ) {

177  (64 + (
	gbr
 - 0b01000000) * 8);

178 } i‡–(
	gbr
 > 0b01111111) && (br < 0b11111111) ) {

179  (576 + (
	gbr
 - 0b10000000) * 64);

185 
	$ïs_qos_bô_øã_ext_vÆue
(
uöt8_t
 
br
)

187 i‡–(
br
 > 0b00000000) && (br < 0b01001011) ) {

188  (8600 + 
br
 * 100);

189 } i‡–(
br
 > 0b01001010) && (br < 0b10111011) ) {

190  (16384 + (
br
 - 0b01001010) * 1024);

191 } i‡–(
br
 > 0b10111010) && (br < 0b11111011) ) {

192  (131072 + (
br
 - 0b10111010) * 2048);

196 
	}
}

	@src/ies/EpsQualityOfService.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 #i‚de‡
EPS_QUALITY_OF_SERVICE_H_


34 
	#EPS_QUALITY_OF_SERVICE_H_


	)

36 
	#EPS_QUALITY_OF_SERVICE_MINIMUM_LENGTH
 2

	)

37 
	#EPS_QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 10

	)

40 
uöt8_t
 
	mmaxBôR©eF‹UL
;

41 
uöt8_t
 
	mmaxBôR©eF‹DL
;

42 
uöt8_t
 
	mgu¨BôR©eF‹UL
;

43 
uöt8_t
 
	mgu¨BôR©eF‹DL
;

44 } 
	tEpsQoSBôR©es
;

47 
uöt8_t
 
	mbôR©esPª£¡
:1;

48 
uöt8_t
 
	mbôR©esExtPª£¡
:1;

49 
uöt8_t
 
	mqci
;

50 
EpsQoSBôR©es
 
	mbôR©es
;

51 
EpsQoSBôR©es
 
	mbôR©esExt
;

52 } 
	tEpsQuÆôyOfSîvi˚
;

56 
ícode_ïs_quÆôy_of_£rvi˚
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

58 
decode_ïs_quÆôy_of_£rvi˚
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

60 
dump_ïs_quÆôy_of_£rvi˚_xml
(
EpsQuÆôyOfSîvi˚
 *
ïsquÆôyof£rvi˚
, 
uöt8_t
 
õi
);

62 
ïs_qos_bô_øã_vÆue
(
uöt8_t
 
br
);

63 
ïs_qos_bô_øã_ext_vÆue
(
uöt8_t
 
br
);

	@src/ies/EpsUpdateResult.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsUpd©eResu….h
"

38 
	$decode_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EPS_UPDATE_RESULT_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
ïsupd©îesu…
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ïs_upd©e_ªsu…_xml
(
ïsupd©îesu…
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
ïsupd©îesu…
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ïs_upd©e_ªsu…_xml
(
ïsupd©îesu…
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_UPDATE_RESULT_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ïs_upd©e_ªsu…_xml
(
ïsupd©îesu…
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
ïsupd©îesu…
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_ïs_upd©e_ªsu…_xml
(
ïsupd©îesu…
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
ïsupd©îesu…
 & 0x7);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_ïs_upd©e_ªsu…_xml
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Eps Update Result>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <EPS upd©êªsu… vÆue>%u</EPS upd©êªsu… vÆue>\n", *
ïsupd©îesu…
);

101 
	`¥ötf
("</Eps Update Result>\n");

102 
	}
}

	@src/ies/EpsUpdateResult.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_UPDATE_RESULT_H_


36 
	#EPS_UPDATE_RESULT_H_


	)

38 
	#EPS_UPDATE_RESULT_MINIMUM_LENGTH
 1

	)

39 
	#EPS_UPDATE_RESULT_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tEpsUpd©eResu…
;

43 
ícode_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_ïs_upd©e_ªsu…_xml
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
);

49 
decode_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_ïs_upd©e_ªsu…
(
EpsUpd©eResu…
 *
ïsupd©îesu…
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/EpsUpdateType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EpsUpd©eTy≥.h
"

38 
	$decode_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
EPS_UPDATE_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 
ïsupd©ëy≥
->
a˘iveÊag
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

47 
ïsupd©ëy≥
->
ïsupd©ëy≥vÆue
 = *(
buf„r
 + 
decoded
) & 0x7;

48 
decoded
++;

49 #i‡
	`deföed
 (
NAS_DEBUG
)

50 
	`dump_ïs_upd©e_ty≥_xml
(
ïsupd©ëy≥
, 
õi
);

52  
decoded
;

53 
	}
}

55 
	$decode_u8_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

57 
decoded
 = 0;

58 
uöt8_t
 *
buf„r
 = &
vÆue
;

59 
ïsupd©ëy≥
->
a˘iveÊag
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

60 
ïsupd©ëy≥
->
ïsupd©ëy≥vÆue
 = *(
buf„r
 + 
decoded
) & 0x7;

61 
decoded
++;

62 #i‡
	`deföed
 (
NAS_DEBUG
)

63 
	`dump_ïs_upd©e_ty≥_xml
(
ïsupd©ëy≥
, 
õi
);

65  
decoded
;

66 
	}
}

68 
	$ícode_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

70 
uöt8_t
 
ícoded
 = 0;

72 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
EPS_UPDATE_TYPE_MINIMUM_LENGTH
, 
Àn
);

73 #i‡
	`deföed
 (
NAS_DEBUG
)

74 
	`dump_ïs_upd©e_ty≥_xml
(
ïsupd©ëy≥
, 
õi
);

76 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

77 ((
ïsupd©ëy≥
->
a˘iveÊag
 & 0x1) << 3) |

78 (
ïsupd©ëy≥
->
ïsupd©ëy≥vÆue
 & 0x7);

79 
ícoded
++;

80  
ícoded
;

81 
	}
}

83 
uöt8_t
 
	$ícode_u8_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
)

85 
uöt8_t
 
buf„rRëu∫
;

86 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

87 
uöt8_t
 
ícoded
 = 0;

88 
uöt8_t
 
õi
 = 0;

89 
	`dump_ïs_upd©e_ty≥_xml
(
ïsupd©ëy≥
, 0);

90 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

91 ((
ïsupd©ëy≥
->
a˘iveÊag
 & 0x1) << 3) |

92 (
ïsupd©ëy≥
->
ïsupd©ëy≥vÆue
 & 0x7);

93 
ícoded
++;

95  
buf„rRëu∫
;

96 
	}
}

98 
	$dump_ïs_upd©e_ty≥_xml
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
)

100 
	`¥ötf
("<Eps Update Type>\n");

101 i‡(
õi
 > 0)

103 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

104 
	`¥ötf
(" <a˘ivêÊag>%u</a˘ivêÊag>\n", 
ïsupd©ëy≥
->
a˘iveÊag
);

105 
	`¥ötf
(" <EPS upd©êty≥ vÆue>%u</EPS upd©êty≥ vÆue>\n", 
ïsupd©ëy≥
->
ïsupd©ëy≥vÆue
);

106 
	`¥ötf
("</Eps Update Type>\n");

107 
	}
}

	@src/ies/EpsUpdateType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
EPS_UPDATE_TYPE_H_


36 
	#EPS_UPDATE_TYPE_H_


	)

38 
	#EPS_UPDATE_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#EPS_UPDATE_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	sEpsUpd©eTy≥_èg
 {

42 
uöt8_t
 
	ma˘iveÊag
:1;

43 
uöt8_t
 
	mïsupd©ëy≥vÆue
:3;

44 } 
	tEpsUpd©eTy≥
;

46 
ícode_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
dump_ïs_upd©e_ty≥_xml
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
);

50 
uöt8_t
 
ícode_u8_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
);

52 
decode_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

54 
decode_u8_ïs_upd©e_ty≥
(
EpsUpd©eTy≥
 *
ïsupd©ëy≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/EsmCause.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EsmCau£.h
"

38 
	$decode_esm_ˇu£
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
esmˇu£
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_esm_ˇu£_xml
(
esmˇu£
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_esm_ˇu£
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_CAUSE_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_esm_ˇu£_xml
(
esmˇu£
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
Ë*
esmˇu£
;

68 
ícoded
++;

69  
ícoded
;

70 
	}
}

72 
	$dump_esm_ˇu£_xml
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
)

74 
	`¥ötf
("<Esm Cause>\n");

75 i‡(
õi
 > 0)

77 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

78 
	`¥ötf
(" <Cau£ vÆue>%u</Cau£ vÆue>\n", *
esmˇu£
);

79 
	`¥ötf
("</Esm Cause>\n");

80 
	}
}

	@src/ies/EsmCause.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ESM_CAUSE_H_


36 
	#ESM_CAUSE_H_


	)

38 
	#ESM_CAUSE_MINIMUM_LENGTH
 1

	)

39 
	#ESM_CAUSE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tEsmCau£
;

43 
ícode_esm_ˇu£
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_esm_ˇu£_xml
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
);

47 
decode_esm_ˇu£
(
EsmCau£
 *
esmˇu£
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/EsmInformationTransferFlag.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"EsmInf‹m©i⁄Tøns„rFœg.h
"

38 
	$decode_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
ESM_INFORMATION_TRANSFER_FLAG_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
esmöf‹m©i⁄å™s„rÊag
 = *
buf„r
 & 0x1;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
esmöf‹m©i⁄å™s„rÊag
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
esmöf‹m©i⁄å™s„rÊag
 = *
buf„r
 & 0x1;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
esmöf‹m©i⁄å™s„rÊag
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_INFORMATION_TRANSFER_FLAG_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
esmöf‹m©i⁄å™s„rÊag
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
esmöf‹m©i⁄å™s„rÊag
 & 0x1);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
esmöf‹m©i⁄å™s„rÊag
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
esmöf‹m©i⁄å™s„rÊag
 & 0x1);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Esm Information Transfer Flag>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <EIT vÆue>%u</EIT vÆue>\n", *
esmöf‹m©i⁄å™s„rÊag
);

101 
	`¥ötf
("</Esm Information Transfer Flag>\n");

102 
	}
}

	@src/ies/EsmInformationTransferFlag.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ESM_INFORMATION_TRANSFER_FLAG_H_


36 
	#ESM_INFORMATION_TRANSFER_FLAG_H_


	)

38 
	#ESM_INFORMATION_TRANSFER_FLAG_MINIMUM_LENGTH
 1

	)

39 
	#ESM_INFORMATION_TRANSFER_FLAG_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tEsmInf‹m©i⁄Tøns„rFœg
;

43 
ícode_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_esm_öf‹m©i⁄_å™s„r_Êag_xml
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
);

49 
decode_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_esm_öf‹m©i⁄_å™s„r_Êag
(
EsmInf‹m©i⁄Tøns„rFœg
 *
esmöf‹m©i⁄å™s„rÊag
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/EsmMessageContainer.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"TLVEncodî.h
"

34 
	~"TLVDecodî.h
"

35 
	~"EsmMesßgeC⁄èöî.h
"

36 
	~"«s_log.h
"

38 
	#NAS_DEBUG
 1

	)

40 
	$decode_esm_mesßge_c⁄èöî
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

42 
decoded
 = 0;

43 
decode_ªsu…
;

44 
uöt16_t
 
õÀn
;

46 
LOG_FUNC_IN
;

48 i‡(
õi
 > 0)

50 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

51 
decoded
++;

54 
	`DECODE_LENGTH_U16
(
buf„r
 + 
decoded
, 
õÀn
, decoded);

56 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

57 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
esmmesßgec⁄èöî
->
esmmesßgec⁄èöîc⁄ã¡s
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0) {

58 
	`LOG_FUNC_RETURN
(
decode_ªsu…
);

60 
decoded
 +
decode_ªsu…
;

62 #i‡
	`deföed
 (
NAS_DEBUG
)

63 
	`dump_esm_mesßge_c⁄èöî_xml
(
esmmesßgec⁄èöî
, 
õi
);

65 
	`LOG_FUNC_RETURN
(
decoded
);

66 
	}
}

68 
	$ícode_esm_mesßge_c⁄èöî
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

70 
uöt8_t
 *
ÀnPå
;

71 
uöt32_t
 
ícoded
 = 0;

72 
öt32_t
 
ícode_ªsu…
;

74 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
, 
Àn
);

75 #i‡
	`deföed
 (
NAS_DEBUG
)

76 
	`dump_esm_mesßge_c⁄èöî_xml
(
esmmesßgec⁄èöî
, 
õi
);

78 i‡(
õi
 > 0)

80 *
buf„r
 = 
õi
;

81 
ícoded
++;

83 
ÀnPå
 = (
buf„r
 + 
ícoded
);

86 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
esmmesßgec⁄èöî
->
esmmesßgec⁄èöîc⁄ã¡s
, 
ÀnPå
 + (
uöt16_t
), 
Àn
 - (uint16_t))) < 0)

87  
ícode_ªsu…
;

89 
ícoded
 +
ícode_ªsu…
;

91 
	`ENCODE_U16
(
ÀnPå
, 
ícode_ªsu…
, 
ícoded
);

93 
ÀnPå
[1] = (((
ícoded
 - 2 - ((
õi
 > 0) ? 1: 0))) & 0x0000ff00) >> 8;

94 
ÀnPå
[0] = ((
ícoded
 - 2 - ((
õi
 > 0) ? 1: 0))) & 0x000000ff;

96  
ícoded
;

97 
	}
}

99 
	$dump_esm_mesßge_c⁄èöî_xml
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
)

101 
	`¥ötf
("<Esm Message Container>\n");

102 i‡(
õi
 > 0)

104 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

105 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
esmmesßgec⁄èöî
->
esmmesßgec⁄èöîc⁄ã¡s
));

106 
	`¥ötf
("</Esm Message Container>\n");

107 
	}
}

	@src/ies/EsmMessageContainer.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
ESM_MESSAGE_CONTAINER_H_


36 
	#ESM_MESSAGE_CONTAINER_H_


	)

38 
	#ESM_MESSAGE_CONTAINER_MINIMUM_LENGTH
 2

39 
	#ESM_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 65538

40 

	)

41 
	sEsmMesßgeC⁄èöî_èg
 {

42 
O˘ëSåög
 
	mesmmesßgec⁄èöîc⁄ã¡s
;

43 } 
	tEsmMesßgeC⁄èöî
;

45 
ícode_esm_mesßge_c⁄èöî
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_esm_mesßge_c⁄èöî
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_esm_mesßge_c⁄èöî_xml
(
EsmMesßgeC⁄èöî
 *
esmmesßgec⁄èöî
, 
uöt8_t
 
õi
);

	@src/ies/GprsTimer.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"G¥sTimî.h
"

38 c⁄° 
	g_g¥s_timî_unô
[] = {2, 60, 360, 60, 60, 60, 60, 0};

40 
	$decode_g¥s_timî
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

42 
decoded
 = 0;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
g¥°imî
->
unô
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

49 
g¥°imî
->
timîvÆue
 = *(
buf„r
 + 
decoded
) & 0x1f;

50 
decoded
++;

51 #i‡
	`deföed
 (
NAS_DEBUG
)

52 
	`dump_g¥s_timî_xml
(
g¥°imî
, 
õi
);

54  
decoded
;

55 
	}
}

57 
	$ícode_g¥s_timî
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
uöt32_t
 
ícoded
 = 0;

61 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
GPRS_TIMER_MINIMUM_LENGTH
, 
Àn
);

62 #i‡
	`deföed
 (
NAS_DEBUG
)

63 
	`dump_g¥s_timî_xml
(
g¥°imî
, 
õi
);

65 i‡(
õi
 > 0)

67 *
buf„r
 = 
õi
;

68 
ícoded
++;

70 *(
buf„r
 + 
ícoded
Ë0x00 | ((
g¥°imî
->
unô
 & 0x7) << 5) |

71 (
g¥°imî
->
timîvÆue
 & 0x1f);

72 
ícoded
++;

73  
ícoded
;

74 
	}
}

76 
	$dump_g¥s_timî_xml
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
)

78 
	`¥ötf
("<Gprs Timer>\n");

79 i‡(
õi
 > 0)

81 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

82 
	`¥ötf
(" <Unô>%u</Unô>\n", 
g¥°imî
->
unô
);

83 
	`¥ötf
(" <Timî vÆue>%u</Timî vÆue>\n", 
g¥°imî
->
timîvÆue
);

84 
	`¥ötf
("</Gprs Timer>\n");

85 
	}
}

87 
	$g¥s_timî_vÆue
(
G¥sTimî
 *
g¥°imî
)

89  (
g¥°imî
->
timîvÆue
 * 
_g¥s_timî_unô
[g¥°imî->
unô
]);

90 
	}
}

	@src/ies/GprsTimer.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
GPRS_TIMER_H_


36 
	#GPRS_TIMER_H_


	)

38 
	#GPRS_TIMER_MINIMUM_LENGTH
 2

	)

39 
	#GPRS_TIMER_MAXIMUM_LENGTH
 2

	)

41 
	sG¥sTimî_èg
 {

42 
	#GPRS_TIMER_UNIT_2S
 0b000

	)

43 
	#GPRS_TIMER_UNIT_60S
 0b001

	)

44 
	#GPRS_TIMER_UNIT_360S
 0b010

	)

45 
	#GPRS_TIMER_UNIT_0S
 0b111

	)

46 
uöt8_t
 
	munô
:3;

47 
uöt8_t
 
	mtimîvÆue
:5;

48 } 
	tG¥sTimî
;

50 
ícode_g¥s_timî
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

52 
dump_g¥s_timî_xml
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
);

54 
decode_g¥s_timî
(
G¥sTimî
 *
g¥°imî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

56 
g¥s_timî_vÆue
(
G¥sTimî
 *
g¥°imî
);

	@src/ies/GutiType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"GutiTy≥.h
"

38 
	$decode_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
GUTI_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
gutôy≥
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_guti_ty≥_xml
(
gutôy≥
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
gutôy≥
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_guti_ty≥_xml
(
gutôy≥
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
GUTI_TYPE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_guti_ty≥_xml
(
gutôy≥
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
gutôy≥
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_guti_ty≥
(
GutiTy≥
 *
gutôy≥
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_guti_ty≥_xml
(
gutôy≥
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
gutôy≥
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_guti_ty≥_xml
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Guti Type>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <Gutòty≥ vÆue>%u</Gutòty≥ vÆue>\n", *
gutôy≥
);

103 
	`¥ötf
("</Guti Type>\n");

104 
	}
}

	@src/ies/GutiType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
GUTI_TYPE_H_


36 
	#GUTI_TYPE_H_


	)

38 
	#GUTI_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#GUTI_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	#GUTI_NATIVE
 0

	)

42 
	#GUTI_MAPPED
 1

	)

43 
uöt8_t
 
	tGutiTy≥
;

45 
ícode_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_guti_ty≥_xml
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
);

49 
uöt8_t
 
ícode_u8_guti_ty≥
(
GutiTy≥
 *
gutôy≥
);

51 
decode_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
decode_u8_guti_ty≥
(
GutiTy≥
 *
gutôy≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/IdentityType2.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"IdítôyTy≥2.h
"

38 
	$decode_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
IDENTITY_TYPE_2_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
idítôyty≥2
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_idítôy_ty≥_2_xml
(
idítôyty≥2
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
idítôyty≥2
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_idítôy_ty≥_2_xml
(
idítôyty≥2
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
IDENTITY_TYPE_2_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_idítôy_ty≥_2_xml
(
idítôyty≥2
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
idítôyty≥2
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_idítôy_ty≥_2_xml
(
idítôyty≥2
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
idítôyty≥2
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_idítôy_ty≥_2_xml
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Identity Type 2>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <Ty≥ o‡idítôy>%u</Ty≥ o‡idítôy>\n", *
idítôyty≥2
);

103 
	`¥ötf
("</Identity Type 2>\n");

104 
	}
}

	@src/ies/IdentityType2.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
IDENTITY_TYPE_2_H_


36 
	#IDENTITY_TYPE_2_H_


	)

38 
	#IDENTITY_TYPE_2_MINIMUM_LENGTH
 1

	)

39 
	#IDENTITY_TYPE_2_MAXIMUM_LENGTH
 1

	)

41 
	#IDENTITY_TYPE_2_IMSI
 0b001

	)

42 
	#IDENTITY_TYPE_2_IMEI
 0b010

	)

43 
	#IDENTITY_TYPE_2_IMEISV
 0b011

	)

44 
	#IDENTITY_TYPE_2_TMSI
 0b100

	)

45 
uöt8_t
 
	tIdítôyTy≥2
;

47 
ícode_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_idítôy_ty≥_2_xml
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
);

51 
uöt8_t
 
ícode_u8_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
);

53 
decode_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
decode_u8_idítôy_ty≥_2
(
IdítôyTy≥2
 *
idítôyty≥2
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/ImeisvRequest.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"ImeisvReque°.h
"

38 
	$decode_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
IMEISV_REQUEST_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
imeisvªque°
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_imeisv_ªque°_xml
(
imeisvªque°
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
imeisvªque°
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_imeisv_ªque°_xml
(
imeisvªque°
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
IMEISV_REQUEST_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_imeisv_ªque°_xml
(
imeisvªque°
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
imeisvªque°
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_imeisv_ªque°_xml
(
imeisvªque°
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
imeisvªque°
 & 0x7);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_imeisv_ªque°_xml
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Imeisv Request>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <IMEISVÑeque° vÆue>%u</IMEISVÑeque° vÆue>\n", *
imeisvªque°
);

101 
	`¥ötf
("</Imeisv Request>\n");

102 
	}
}

	@src/ies/ImeisvRequest.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
IMEISV_REQUEST_H_


36 
	#IMEISV_REQUEST_H_


	)

38 
	#IMEISV_REQUEST_MINIMUM_LENGTH
 1

	)

39 
	#IMEISV_REQUEST_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tImeisvReque°
;

43 
ícode_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_imeisv_ªque°_xml
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
);

49 
decode_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_imeisv_ªque°
(
ImeisvReque°
 *
imeisvªque°
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/KsiAndSequenceNumber.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"KsiAndSequí˚Numbî.h
"

38 
	$decode_ksi_™d_£quí˚_numbî
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
ksünd£quí˚numbî
->
ksi
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

47 
ksünd£quí˚numbî
->
£quí˚numbî
 = *(
buf„r
 + 
decoded
) & 0x1f;

48 
decoded
++;

49 #i‡
	`deföed
 (
NAS_DEBUG
)

50 
	`dump_ksi_™d_£quí˚_numbî_xml
(
ksünd£quí˚numbî
, 
õi
);

52  
decoded
;

53 
	}
}

55 
	$ícode_ksi_™d_£quí˚_numbî
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

57 
uöt32_t
 
ícoded
 = 0;

59 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
KSI_AND_SEQUENCE_NUMBER_MINIMUM_LENGTH
, 
Àn
);

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ksi_™d_£quí˚_numbî_xml
(
ksünd£quí˚numbî
, 
õi
);

63 i‡(
õi
 > 0)

65 *
buf„r
 = 
õi
;

66 
ícoded
++;

68 *(
buf„r
 + 
ícoded
Ë0x00 | ((
ksünd£quí˚numbî
->
ksi
 & 0x7) << 5) |

69 (
ksünd£quí˚numbî
->
£quí˚numbî
 & 0x1f);

70 
ícoded
++;

71  
ícoded
;

72 
	}
}

74 
	$dump_ksi_™d_£quí˚_numbî_xml
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
)

76 
	`¥ötf
("<Ksi And Sequence Number>\n");

77 i‡(
õi
 > 0)

79 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

80 
	`¥ötf
(" <KSI>%u</KSI>\n", 
ksünd£quí˚numbî
->
ksi
);

81 
	`¥ötf
(" <Sequí˚Çumbî>%u</Sequí˚Çumbî>\n", 
ksünd£quí˚numbî
->
£quí˚numbî
);

82 
	`¥ötf
("</Ksi And Sequence Number>\n");

83 
	}
}

	@src/ies/KsiAndSequenceNumber.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
KSI_AND_SEQUENCE_NUMBER_H_


36 
	#KSI_AND_SEQUENCE_NUMBER_H_


	)

38 
	#KSI_AND_SEQUENCE_NUMBER_MINIMUM_LENGTH
 2

	)

39 
	#KSI_AND_SEQUENCE_NUMBER_MAXIMUM_LENGTH
 2

	)

41 
	sKsiAndSequí˚Numbî_èg
 {

42 
uöt8_t
 
	mksi
:3;

43 
uöt8_t
 
	m£quí˚numbî
:5;

44 } 
	tKsiAndSequí˚Numbî
;

46 
ícode_ksi_™d_£quí˚_numbî
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
dump_ksi_™d_£quí˚_numbî_xml
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
);

50 
decode_ksi_™d_£quí˚_numbî
(
KsiAndSequí˚Numbî
 *
ksünd£quí˚numbî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/LcsClientIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"LcsClõ¡Idítôy.h
"

38 
	$decode_lcs_˛õ¡_idítôy
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
lcs˛õ¡idítôy
->
lcs˛õ¡idítôyvÆue
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_lcs_˛õ¡_idítôy_xml
(
lcs˛õ¡idítôy
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_lcs_˛õ¡_idítôy
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
LCS_CLIENT_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_lcs_˛õ¡_idítôy_xml
(
lcs˛õ¡idítôy
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
lcs˛õ¡idítôy
->
lcs˛õ¡idítôyvÆue
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_lcs_˛õ¡_idítôy_xml
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Lcs Client Identity>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
lcs˛õ¡idítôy
->
lcs˛õ¡idítôyvÆue
));

92 
	`¥ötf
("</Lcs Client Identity>\n");

93 
	}
}

	@src/ies/LcsClientIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
LCS_CLIENT_IDENTITY_H_


36 
	#LCS_CLIENT_IDENTITY_H_


	)

38 
	#LCS_CLIENT_IDENTITY_MINIMUM_LENGTH
 3

	)

39 
	#LCS_CLIENT_IDENTITY_MAXIMUM_LENGTH
 257

	)

41 
	sLcsClõ¡Idítôy_èg
 {

42 
O˘ëSåög
 
	mlcs˛õ¡idítôyvÆue
;

43 } 
	tLcsClõ¡Idítôy
;

45 
ícode_lcs_˛õ¡_idítôy
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_lcs_˛õ¡_idítôy
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_lcs_˛õ¡_idítôy_xml
(
LcsClõ¡Idítôy
 *
lcs˛õ¡idítôy
, 
uöt8_t
 
õi
);

	@src/ies/LcsIndicator.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"LcsIndiˇt‹.h
"

38 
	$decode_lcs_ödiˇt‹
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
lcsödiˇt‹
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_lcs_ödiˇt‹_xml
(
lcsödiˇt‹
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_lcs_ödiˇt‹
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
LCS_INDICATOR_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_lcs_ödiˇt‹_xml
(
lcsödiˇt‹
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
Ë*
lcsödiˇt‹
;

68 
ícoded
++;

69  
ícoded
;

70 
	}
}

72 
	$dump_lcs_ödiˇt‹_xml
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
)

74 
	`¥ötf
("<Lcs Indicator>\n");

75 i‡(
õi
 > 0)

77 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

78 
	`¥ötf
(" <LCS indiˇt‹ vÆue>%u</LCS indiˇt‹ vÆue>\n", *
lcsödiˇt‹
);

79 
	`¥ötf
("</Lcs Indicator>\n");

80 
	}
}

	@src/ies/LcsIndicator.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
LCS_INDICATOR_H_


36 
	#LCS_INDICATOR_H_


	)

38 
	#LCS_INDICATOR_MINIMUM_LENGTH
 2

	)

39 
	#LCS_INDICATOR_MAXIMUM_LENGTH
 2

	)

41 
uöt8_t
 
	tLcsIndiˇt‹
;

43 
ícode_lcs_ödiˇt‹
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_lcs_ödiˇt‹_xml
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
);

47 
decode_lcs_ödiˇt‹
(
LcsIndiˇt‹
 *
lcsödiˇt‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/LinkedEpsBearerIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"LökedEpsBóªrIdítôy.h
"

38 
	$decode_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
LINKED_EPS_BEARER_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
lökedïsbóªridítôy
 = *
buf„r
 & 0xf;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_löked_ïs_bóªr_idítôy_xml
(
lökedïsbóªridítôy
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
lökedïsbóªridítôy
 = *
buf„r
 & 0xf;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_löked_ïs_bóªr_idítôy_xml
(
lökedïsbóªridítôy
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
LINKED_EPS_BEARER_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_löked_ïs_bóªr_idítôy_xml
(
lökedïsbóªridítôy
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
lökedïsbóªridítôy
 & 0xf);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_löked_ïs_bóªr_idítôy_xml
(
lökedïsbóªridítôy
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
lökedïsbóªridítôy
 & 0xf);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_löked_ïs_bóªr_idítôy_xml
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Linked Eps Bearer Identity>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <Löked EPS bóª∏idítôy vÆue>%u</Löked EPS bóª∏idítôy vÆue>\n", *
lökedïsbóªridítôy
);

103 
	`¥ötf
("</Linked Eps Bearer Identity>\n");

104 
	}
}

	@src/ies/LinkedEpsBearerIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
LINKED_EPS_BEARER_IDENTITY_H_


36 
	#LINKED_EPS_BEARER_IDENTITY_H_


	)

38 
	#LINKED_EPS_BEARER_IDENTITY_MINIMUM_LENGTH
 1

	)

39 
	#LINKED_EPS_BEARER_IDENTITY_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tLökedEpsBóªrIdítôy
;

43 
ícode_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_löked_ïs_bóªr_idítôy_xml
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
);

49 
decode_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_löked_ïs_bóªr_idítôy
(
LökedEpsBóªrIdítôy
 *
lökedïsbóªridítôy
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/LlcServiceAccessPointIdentifier.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"LlcSîvi˚Ac˚ssPoötIdítifõr.h
"

38 
	$decode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
Œc£rvi˚ac˚s•oötidítifõr
 = *
buf„r
 & 0xf;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_Œc_£rvi˚_ac˚ss_poöt_idítifõr_xml
(
Œc£rvi˚ac˚s•oötidítifõr
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_Œc_£rvi˚_ac˚ss_poöt_idítifõr_xml
(
Œc£rvi˚ac˚s•oötidítifõr
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
) = 0x00 |

68 (*
Œc£rvi˚ac˚s•oötidítifõr
 & 0xf);

69 
ícoded
++;

70  
ícoded
;

71 
	}
}

73 
	$dump_Œc_£rvi˚_ac˚ss_poöt_idítifõr_xml
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
)

75 
	`¥ötf
("<Llc Service Access Point Identifier>\n");

76 i‡(
õi
 > 0)

78 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

79 
	`¥ötf
(" <LLC SAPI vÆue>%u</LLC SAPI vÆue>\n", *
Œc£rvi˚ac˚s•oötidítifõr
);

80 
	`¥ötf
("</Llc Service Access Point Identifier>\n");

81 
	}
}

	@src/ies/LlcServiceAccessPointIdentifier.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
LLC_SERVICE_ACCESS_POINT_IDENTIFIER_H_


36 
	#LLC_SERVICE_ACCESS_POINT_IDENTIFIER_H_


	)

38 
	#LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MINIMUM_LENGTH
 2

	)

39 
	#LLC_SERVICE_ACCESS_POINT_IDENTIFIER_MAXIMUM_LENGTH
 2

	)

41 
uöt8_t
 
	tLlcSîvi˚Ac˚ssPoötIdítifõr
;

43 
ícode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_Œc_£rvi˚_ac˚ss_poöt_idítifõr_xml
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
);

47 
decode_Œc_£rvi˚_ac˚ss_poöt_idítifõr
(
LlcSîvi˚Ac˚ssPoötIdítifõr
 *
Œc£rvi˚ac˚s•oötidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/LocationAreaIdentification.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Loˇti⁄AªaIdítifiˇti⁄.h
"

38 
	$decode_loˇti⁄_¨ó_idítifiˇti⁄
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

47 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

48 
decoded
++;

49 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

50 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

51 
decoded
++;

52 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

53 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

54 
decoded
++;

56 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
loˇti⁄¨óidítifiˇti⁄
->
œc
);

57 #i‡
	`deföed
 (
NAS_DEBUG
)

58 
	`dump_loˇti⁄_¨ó_idítifiˇti⁄_xml
(
loˇti⁄¨óidítifiˇti⁄
, 
õi
);

60  
decoded
;

61 
	}
}

63 
	$ícode_loˇti⁄_¨ó_idítifiˇti⁄
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

65 
uöt32_t
 
ícoded
 = 0;

67 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
LOCATION_AREA_IDENTIFICATION_MINIMUM_LENGTH
, 
Àn
);

68 #i‡
	`deföed
 (
NAS_DEBUG
)

69 
	`dump_loˇti⁄_¨ó_idítifiˇti⁄_xml
(
loˇti⁄¨óidítifiˇti⁄
, 
õi
);

71 i‡(
õi
 > 0)

73 *
buf„r
 = 
õi
;

74 
ícoded
++;

76 *(
buf„r
 + 
ícoded
Ë0x00 | ((
loˇti⁄¨óidítifiˇti⁄
->
mccdigô2
 & 0xf) << 4) |

77 (
loˇti⁄¨óidítifiˇti⁄
->
mccdigô1
 & 0xf);

78 
ícoded
++;

79 *(
buf„r
 + 
ícoded
Ë0x00 | ((
loˇti⁄¨óidítifiˇti⁄
->
mncdigô3
 & 0xf) << 4) |

80 (
loˇti⁄¨óidítifiˇti⁄
->
mccdigô3
 & 0xf);

81 
ícoded
++;

82 *(
buf„r
 + 
ícoded
Ë0x00 | ((
loˇti⁄¨óidítifiˇti⁄
->
mncdigô2
 & 0xf) << 4) |

83 (
loˇti⁄¨óidítifiˇti⁄
->
mncdigô1
 & 0xf);

84 
ícoded
++;

85 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
loˇti⁄¨óidítifiˇti⁄
->
œc
);

86  
ícoded
;

87 
	}
}

89 
	$dump_loˇti⁄_¨ó_idítifiˇti⁄_xml
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
)

91 
	`¥ötf
("<Location Area Identification>\n");

92 i‡(
õi
 > 0)

94 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

95 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô2
);

96 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô1
);

97 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô3
);

98 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mccdigô3
);

99 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô2
);

100 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
loˇti⁄¨óidítifiˇti⁄
->
mncdigô1
);

101 
	`¥ötf
(" <LAC>%u</LAC>\n", 
loˇti⁄¨óidítifiˇti⁄
->
œc
);

102 
	`¥ötf
("</Location Area Identification>\n");

103 
	}
}

	@src/ies/LocationAreaIdentification.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
LOCATION_AREA_IDENTIFICATION_H_


36 
	#LOCATION_AREA_IDENTIFICATION_H_


	)

38 
	#LOCATION_AREA_IDENTIFICATION_MINIMUM_LENGTH
 6

	)

39 
	#LOCATION_AREA_IDENTIFICATION_MAXIMUM_LENGTH
 6

	)

41 
	sLoˇti⁄AªaIdítifiˇti⁄_èg
 {

42 
uöt8_t
 
	mmccdigô2
:4;

43 
uöt8_t
 
	mmccdigô1
:4;

44 
uöt8_t
 
	mmncdigô3
:4;

45 
uöt8_t
 
	mmccdigô3
:4;

46 
uöt8_t
 
	mmncdigô2
:4;

47 
uöt8_t
 
	mmncdigô1
:4;

48 
uöt16_t
 
	mœc
;

49 } 
	tLoˇti⁄AªaIdítifiˇti⁄
;

51 
ícode_loˇti⁄_¨ó_idítifiˇti⁄
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
dump_loˇti⁄_¨ó_idítifiˇti⁄_xml
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
);

55 
decode_loˇti⁄_¨ó_idítifiˇti⁄
(
Loˇti⁄AªaIdítifiˇti⁄
 *
loˇti⁄¨óidítifiˇti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/MessageType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"MesßgeTy≥.h
"

38 
	$decode_mesßge_ty≥
(
MesßgeTy≥
 *
mesßgëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_mesßge_ty≥
(
MesßgeTy≥
 *
mesßgëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/MessageType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
MESSAGE_TYPE_H_


36 
	#MESSAGE_TYPE_H_


	)

38 
	#MESSAGE_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#MESSAGE_TYPE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tMesßgeTy≥
;

43 
ícode_mesßge_ty≥
(
MesßgeTy≥
 *
mesßgëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_mesßge_ty≥_xml
(
MesßgeTy≥
 *
mesßgëy≥
, 
uöt8_t
 
õi
);

47 
decode_mesßge_ty≥
(
MesßgeTy≥
 *
mesßgëy≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/MobileIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"MobûeIdítôy.h
"

38 
decode_imsi_mobûe_idítôy
(
ImsiMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
);

39 
decode_imei_mobûe_idítôy
(
ImeiMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
);

40 
decode_imeisv_mobûe_idítôy
(
ImeisvMobûeIdítôy_t
 *
imeisv
, 
uöt8_t
 *
buf„r
);

41 
decode_tmsi_mobûe_idítôy
(
TmsiMobûeIdítôy_t
 *
tmsi
, 
uöt8_t
 *
buf„r
);

42 
decode_tmgi_mobûe_idítôy
(
TmgiMobûeIdítôy_t
 *
tmgi
, 
uöt8_t
 *
buf„r
);

43 
decode_no_mobûe_idítôy
(
NoMobûeIdítôy_t
 *
no_id
, 
uöt8_t
 *
buf„r
);

45 
ícode_imsi_mobûe_idítôy
(
ImsiMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
);

46 
ícode_imei_mobûe_idítôy
(
ImeiMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
);

47 
ícode_imeisv_mobûe_idítôy
(
ImeisvMobûeIdítôy_t
 *
imeisv
, 
uöt8_t
 *
buf„r
);

48 
ícode_tmsi_mobûe_idítôy
(
TmsiMobûeIdítôy_t
 *
tmsi
, 
uöt8_t
 *
buf„r
);

49 
ícode_tmgi_mobûe_idítôy
(
TmgiMobûeIdítôy_t
 *
tmgi
, 
uöt8_t
 *
buf„r
);

50 
ícode_no_mobûe_idítôy
(
NoMobûeIdítôy_t
 *
no_id
, 
uöt8_t
 *
buf„r
);

52 
	$decode_mobûe_idítôy
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

54 
decoded_rc
 = 
TLV_DECODE_VALUE_DOESNT_MATCH
;

55 
decoded
 = 0;

56 
uöt8_t
 
õÀn
 = 0;

57 i‡(
õi
 > 0)

59 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

60 
decoded
++;

62 
õÀn
 = *(
buf„r
 + 
decoded
);

63 
decoded
++;

65 
uöt8_t
 
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

66 i‡(
ty≥ofidítôy
 !
MOBILE_IDENTITY_NOT_AVAILABLE
) {

67 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

68 i‡(
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMSI
) {

69 
decoded_rc
 = 
	`decode_imsi_mobûe_idítôy
(&
mobûeidítôy
->
imsi
,

70 
buf„r
 + 
decoded
);

71 } i‡(
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEI
) {

72 
decoded_rc
 = 
	`decode_imei_mobûe_idítôy
(&
mobûeidítôy
->
imei
,

73 
buf„r
 + 
decoded
);

74 } i‡(
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEISV
) {

75 
decoded_rc
 = 
	`decode_imeisv_mobûe_idítôy
(&
mobûeidítôy
->
imeisv
,

76 
buf„r
 + 
decoded
);

77 } i‡(
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMSI
) {

78 
decoded_rc
 = 
	`decode_tmsi_mobûe_idítôy
(&
mobûeidítôy
->
tmsi
,

79 
buf„r
 + 
decoded
);

80 } i‡(
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMGI
) {

81 
decoded_rc
 = 
	`decode_tmgi_mobûe_idítôy
(&
mobûeidítôy
->
tmgi
,

82 
buf„r
 + 
decoded
);

84 } i‡(
õÀn
 =
MOBILE_IDENTITY_NOT_AVAILABLE_LTE_LENGTH
) {

85 
decoded_rc
 = 
	`decode_no_mobûe_idítôy
(&
mobûeidítôy
->
no_id
,

86 
buf„r
 + 
decoded
);

89 i‡(
decoded_rc
 < 0) {

90  
decoded_rc
;

92 #i‡
	`deföed
 (
NAS_DEBUG
)

93 
	`dump_mobûe_idítôy_xml
(
mobûeidítôy
, 
õi
);

95  (
decoded
 + 
decoded_rc
);

96 
	}
}

98 
	$ícode_mobûe_idítôy
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

100 
uöt8_t
 *
ÀnPå
;

101 
ícoded_rc
 = 
TLV_ENCODE_VALUE_DOESNT_MATCH
;

102 
uöt32_t
 
ícoded
 = 0;

104 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MOBILE_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

105 #i‡
	`deföed
 (
NAS_DEBUG
)

106 
	`dump_mobûe_idítôy_xml
(
mobûeidítôy
, 
õi
);

108 i‡(
õi
 > 0)

110 *
buf„r
 = 
õi
;

111 
ícoded
++;

113 
ÀnPå
 = (
buf„r
 + 
ícoded
);

114 
ícoded
 ++;

116 i‡(
mobûeidítôy
->
no_id
.
ty≥ofidítôy
 !
MOBILE_IDENTITY_NOT_AVAILABLE
) {

117 i‡(
mobûeidítôy
->
imsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMSI
)

119 
ícoded_rc
 = 
	`ícode_imsi_mobûe_idítôy
(&
mobûeidítôy
->
imsi
,

120 
buf„r
 + 
ícoded
);

122 i‡(
mobûeidítôy
->
imei
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEI
)

124 
ícoded_rc
 = 
	`ícode_imei_mobûe_idítôy
(&
mobûeidítôy
->
imei
,

125 
buf„r
 + 
ícoded
);

127 i‡(
mobûeidítôy
->
imeisv
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEISV
)

129 
ícoded_rc
 = 
	`ícode_imeisv_mobûe_idítôy
(&
mobûeidítôy
->
imeisv
,

130 
buf„r
 + 
ícoded
);

132 i‡(
mobûeidítôy
->
tmsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMSI
)

134 
ícoded_rc
 = 
	`ícode_tmsi_mobûe_idítôy
(&
mobûeidítôy
->
tmsi
,

135 
buf„r
 + 
ícoded
);

137 i‡(
mobûeidítôy
->
tmgi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMGI
)

139 
ícoded_rc
 = 
	`ícode_tmgi_mobûe_idítôy
(&
mobûeidítôy
->
tmgi
,

140 
buf„r
 + 
ícoded
);

142 i‡(
ícoded_rc
 > 0) {

143 *
ÀnPå
 = 
ícoded
 + 
ícoded_rc
 - 1 - ((
õi
 > 0) ? 1 : 0);

146 
ícoded_rc
 = 
	`ícode_no_mobûe_idítôy
(&
mobûeidítôy
->
no_id
,

147 
buf„r
 + 
ícoded
);

148 i‡(
ícoded_rc
 > 0) {

149 *
ÀnPå
 = 
MOBILE_IDENTITY_NOT_AVAILABLE_LTE_LENGTH
;

153 i‡(
ícoded_rc
 < 0) {

154  
ícoded_rc
;

156  (
ícoded
 + 
ícoded_rc
);

157 
	}
}

159 
	$dump_mobûe_idítôy_xml
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
)

161 
	`¥ötf
("<Mobile Identity>\n");

162 i‡(
õi
 > 0)

164 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

166 i‡(
mobûeidítôy
->
imsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMSI
) {

167 
ImsiMobûeIdítôy_t
* 
imsi
 = &
mobûeidítôy
->imsi;

168 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
imsi
->
oddeví
);

169 
	`¥ötf
(" <Type of identity>IMSI</Type of identity>\n");

170 
	`¥ötf
(" <digô1>%u</digô1>\n", 
imsi
->
digô1
);

171 
	`¥ötf
(" <digô2>%u</digô2>\n", 
imsi
->
digô2
);

172 
	`¥ötf
(" <digô3>%u</digô3>\n", 
imsi
->
digô3
);

173 
	`¥ötf
(" <digô4>%u</digô4>\n", 
imsi
->
digô4
);

174 
	`¥ötf
(" <digô5>%u</digô5>\n", 
imsi
->
digô5
);

175 
	`¥ötf
(" <digô6>%u</digô6>\n", 
imsi
->
digô6
);

176 
	`¥ötf
(" <digô7>%u</digô7>\n", 
imsi
->
digô7
);

177 
	`¥ötf
(" <digô8>%u</digô8>\n", 
imsi
->
digô8
);

178 
	`¥ötf
(" <digô9>%u</digô9>\n", 
imsi
->
digô9
);

179 
	`¥ötf
(" <digô10>%u</digô10>\n", 
imsi
->
digô10
);

180 
	`¥ötf
(" <digô11>%u</digô11>\n", 
imsi
->
digô11
);

181 
	`¥ötf
(" <digô12>%u</digô12>\n", 
imsi
->
digô12
);

182 
	`¥ötf
(" <digô13>%u</digô13>\n", 
imsi
->
digô13
);

183 
	`¥ötf
(" <digô14>%u</digô14>\n", 
imsi
->
digô14
);

184 
	`¥ötf
(" <digô15>%u</digô15>\n", 
imsi
->
digô15
);

186 i‡(
mobûeidítôy
->
imei
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEI
) {

187 
ImeiMobûeIdítôy_t
* 
imei
 = &
mobûeidítôy
->imei;

188 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
imei
->
oddeví
);

189 
	`¥ötf
(" <Type of identity>IMEI</Type of identity>\n");

190 
	`¥ötf
(" <digô1>%u</digô1>\n", 
imei
->
digô1
);

191 
	`¥ötf
(" <digô2>%u</digô2>\n", 
imei
->
digô2
);

192 
	`¥ötf
(" <digô3>%u</digô3>\n", 
imei
->
digô3
);

193 
	`¥ötf
(" <digô4>%u</digô4>\n", 
imei
->
digô4
);

194 
	`¥ötf
(" <digô5>%u</digô5>\n", 
imei
->
digô5
);

195 
	`¥ötf
(" <digô6>%u</digô6>\n", 
imei
->
digô6
);

196 
	`¥ötf
(" <digô7>%u</digô7>\n", 
imei
->
digô7
);

197 
	`¥ötf
(" <digô8>%u</digô8>\n", 
imei
->
digô8
);

198 
	`¥ötf
(" <digô9>%u</digô9>\n", 
imei
->
digô9
);

199 
	`¥ötf
(" <digô10>%u</digô10>\n", 
imei
->
digô10
);

200 
	`¥ötf
(" <digô11>%u</digô11>\n", 
imei
->
digô11
);

201 
	`¥ötf
(" <digô12>%u</digô12>\n", 
imei
->
digô12
);

202 
	`¥ötf
(" <digô13>%u</digô13>\n", 
imei
->
digô13
);

203 
	`¥ötf
(" <digô14>%u</digô14>\n", 
imei
->
digô14
);

204 
	`¥ötf
(" <digô15>%u</digô15>\n", 
imei
->
digô15
);

206 i‡(
mobûeidítôy
->
imeisv
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEISV
) {

207 
ImeisvMobûeIdítôy_t
* 
imeisv
 = &
mobûeidítôy
->imeisv;

208 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
imeisv
->
oddeví
);

209 
	`¥ötf
(" <Type of identity>IMEISV</Type of identity>\n");

210 
	`¥ötf
(" <digô1>%u</digô1>\n", 
imeisv
->
digô1
);

211 
	`¥ötf
(" <digô2>%u</digô2>\n", 
imeisv
->
digô2
);

212 
	`¥ötf
(" <digô3>%u</digô3>\n", 
imeisv
->
digô3
);

213 
	`¥ötf
(" <digô4>%u</digô4>\n", 
imeisv
->
digô4
);

214 
	`¥ötf
(" <digô5>%u</digô5>\n", 
imeisv
->
digô5
);

215 
	`¥ötf
(" <digô6>%u</digô6>\n", 
imeisv
->
digô6
);

216 
	`¥ötf
(" <digô7>%u</digô7>\n", 
imeisv
->
digô7
);

217 
	`¥ötf
(" <digô8>%u</digô8>\n", 
imeisv
->
digô8
);

218 
	`¥ötf
(" <digô9>%u</digô9>\n", 
imeisv
->
digô9
);

219 
	`¥ötf
(" <digô10>%u</digô10>\n", 
imeisv
->
digô10
);

220 
	`¥ötf
(" <digô11>%u</digô11>\n", 
imeisv
->
digô11
);

221 
	`¥ötf
(" <digô12>%u</digô12>\n", 
imeisv
->
digô12
);

222 
	`¥ötf
(" <digô13>%u</digô13>\n", 
imeisv
->
digô13
);

223 
	`¥ötf
(" <digô14>%u</digô14>\n", 
imeisv
->
digô14
);

224 
	`¥ötf
(" <digô15>%u</digô15>\n", 
imeisv
->
digô15
);

226 i‡(
mobûeidítôy
->
tmsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMSI
) {

227 
TmsiMobûeIdítôy_t
* 
tmsi
 = &
mobûeidítôy
->tmsi;

228 
	`¥ötf
(" <oddÉví>%u</oddÉví>\n", 
tmsi
->
oddeví
);

229 
	`¥ötf
(" <Type of identity>TMSI</Type of identity>\n");

230 
	`¥ötf
(" <digô1>%u</digô1>\n", 
tmsi
->
digô1
);

231 
	`¥ötf
(" <digô2>%u</digô2>\n", 
tmsi
->
digô2
);

232 
	`¥ötf
(" <digô3>%u</digô3>\n", 
tmsi
->
digô3
);

233 
	`¥ötf
(" <digô4>%u</digô4>\n", 
tmsi
->
digô4
);

234 
	`¥ötf
(" <digô5>%u</digô5>\n", 
tmsi
->
digô5
);

235 
	`¥ötf
(" <digô6>%u</digô6>\n", 
tmsi
->
digô6
);

236 
	`¥ötf
(" <digô7>%u</digô7>\n", 
tmsi
->
digô7
);

237 
	`¥ötf
(" <digô8>%u</digô8>\n", 
tmsi
->
digô8
);

238 
	`¥ötf
(" <digô9>%u</digô9>\n", 
tmsi
->
digô9
);

239 
	`¥ötf
(" <digô10>%u</digô10>\n", 
tmsi
->
digô10
);

240 
	`¥ötf
(" <digô11>%u</digô11>\n", 
tmsi
->
digô11
);

241 
	`¥ötf
(" <digô12>%u</digô12>\n", 
tmsi
->
digô12
);

242 
	`¥ötf
(" <digô13>%u</digô13>\n", 
tmsi
->
digô13
);

243 
	`¥ötf
(" <digô14>%u</digô14>\n", 
tmsi
->
digô14
);

244 
	`¥ötf
(" <digô15>%u</digô15>\n", 
tmsi
->
digô15
);

246 i‡(
mobûeidítôy
->
tmgi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMGI
) {

247 
TmgiMobûeIdítôy_t
* 
tmgi
 = &
mobûeidítôy
->tmgi;

248 
	`¥ötf
(" <MBMS sessi⁄ ID indiˇti⁄>%u</MBMS sessi⁄ ID indiˇti⁄>\n", 
tmgi
->
mbms£ssi⁄idödiˇti⁄
);

249 
	`¥ötf
(" <MCC MNC indication>%u</MCC MNC indication>\n",

250 
tmgi
->
mccmncödiˇti⁄
);

251 
	`¥ötf
(" <OddÉven>%u</OddÉven>\n",

252 
tmgi
->
oddeví
);

253 
	`¥ötf
(" <Type of identity>TMGI</Type of identity>\n");

254 
	`¥ötf
(" <MBMS service ID>%u</MBMS service ID>\n",

255 
tmgi
->
mbms£rvi˚id
);

256 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
tmgi
->
mccdigô2
);

257 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
tmgi
->
mccdigô1
);

258 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
tmgi
->
mncdigô3
);

259 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
tmgi
->
mccdigô3
);

260 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
tmgi
->
mncdigô2
);

261 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
tmgi
->
mncdigô1
);

262 
	`¥ötf
(" <MBMS session ID>%u</MBMS session ID>\n",

263 
tmgi
->
mbms£ssi⁄id
);

266 
	`¥ötf
(" Wr⁄gÅy≥ o‡mobûêidítôy (%u)\n", 
mobûeidítôy
->
imsi
.
ty≥ofidítôy
);

268 
	`¥ötf
("</Mobile Identity>\n");

269 
	}
}

271 
	$decode_imsi_mobûe_idítôy
(
ImsiMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
)

273 
decoded
 = 0;

274 
imsi
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

275 i‡(
imsi
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_IMSI
) {

276  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

278 
imsi
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

279 
imsi
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

280 
decoded
++;

281 
imsi
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

282 
imsi
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

283 
decoded
++;

284 
imsi
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

285 
imsi
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

286 
decoded
++;

287 
imsi
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

288 
imsi
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

289 
decoded
++;

290 
imsi
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

291 
imsi
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

292 
decoded
++;

293 
imsi
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

294 
imsi
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

295 
decoded
++;

296 
imsi
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

297 
imsi
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

298 
decoded
++;

299 
imsi
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

300 
imsi
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

306 i‡((
imsi
->
oddeví
 =
MOBILE_IDENTITY_EVEN
Ë&& (imsi->
digô15
 != 0x0f))

308  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

310 
decoded
++;

311  
decoded
;

312 
	}
}

314 
	$decode_imei_mobûe_idítôy
(
ImeiMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
)

316 
decoded
 = 0;

317 
imei
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

318 i‡(
imei
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_IMEI
) {

319  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

321 
imei
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

322 
imei
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

323 
decoded
++;

324 
imei
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

325 
imei
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

326 
decoded
++;

327 
imei
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

328 
imei
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

329 
decoded
++;

330 
imei
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

331 
imei
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

332 
decoded
++;

333 
imei
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

334 
imei
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

335 
decoded
++;

336 
imei
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

337 
imei
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

338 
decoded
++;

339 
imei
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

340 
imei
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

341 
decoded
++;

342 
imei
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

343 
imei
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

349 i‡((
imei
->
oddeví
 =
MOBILE_IDENTITY_EVEN
Ë&& (imei->
digô15
 != 0x0f))

351  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

353 
decoded
++;

354  
decoded
;

355 
	}
}

357 
	$decode_imeisv_mobûe_idítôy
(
ImeisvMobûeIdítôy_t
 *
imeisv
, 
uöt8_t
 *
buf„r
)

359 
decoded
 = 0;

360 
imeisv
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

361 i‡(
imeisv
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_IMEISV
) {

362  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

364 
imeisv
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

365 
imeisv
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

366 
decoded
++;

367 
imeisv
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

368 
imeisv
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

369 
decoded
++;

370 
imeisv
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

371 
imeisv
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

372 
decoded
++;

373 
imeisv
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

374 
imeisv
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

375 
decoded
++;

376 
imeisv
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

377 
imeisv
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

378 
decoded
++;

379 
imeisv
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

380 
imeisv
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

381 
decoded
++;

382 
imeisv
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

383 
imeisv
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

384 
decoded
++;

385 
imeisv
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

386 
imeisv
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

392 i‡((
imeisv
->
oddeví
 =
MOBILE_IDENTITY_EVEN
Ë&& (imeisv->
digô15
 != 0x0f))

394  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

396 
decoded
++;

397  
decoded
;

398 
	}
}

400 
	$decode_tmsi_mobûe_idítôy
(
TmsiMobûeIdítôy_t
 *
tmsi
, 
uöt8_t
 *
buf„r
)

402 
decoded
 = 0;

403 
tmsi
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

404 i‡(
tmsi
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_TMSI
) {

405  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

407 
tmsi
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

408 
tmsi
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

413 i‡(
tmsi
->
digô1
 != 0xf) {

414  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

416 
decoded
++;

417 
tmsi
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

418 
tmsi
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

419 
decoded
++;

420 
tmsi
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

421 
tmsi
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

422 
decoded
++;

423 
tmsi
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

424 
tmsi
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

425 
decoded
++;

426 
tmsi
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

427 
tmsi
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

428 
decoded
++;

429 
tmsi
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

430 
tmsi
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

431 
decoded
++;

432 
tmsi
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

433 
tmsi
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

434 
decoded
++;

435 
tmsi
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

436 
tmsi
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

437 
decoded
++;

438  
decoded
;

439 
	}
}

441 
	$decode_tmgi_mobûe_idítôy
(
TmgiMobûeIdítôy_t
 *
tmgi
, 
uöt8_t
 *
buf„r
)

443 
decoded
 = 0;

444 
tmgi
->
•¨e
 = (*(
buf„r
 + 
decoded
) >> 6) & 0x2;

448 i‡(
tmgi
->
•¨e
 != 0) {

449  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

451 
tmgi
->
mbms£ssi⁄idödiˇti⁄
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x1;

452 
tmgi
->
mccmncödiˇti⁄
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

453 
tmgi
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

454 
tmgi
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

455 i‡(
tmgi
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_TMGI
) {

456  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

458 
decoded
++;

460 
	`IES_DECODE_U24
(
buf„r
, 
decoded
, 
tmgi
->
mbms£rvi˚id
);

461 
tmgi
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

462 
tmgi
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

463 
decoded
++;

464 
tmgi
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

465 
tmgi
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

466 
decoded
++;

467 
tmgi
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

468 
tmgi
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

469 
decoded
++;

470 
tmgi
->
mbms£ssi⁄id
 = *(
buf„r
 + 
decoded
);

471 
decoded
++;

472  
decoded
;

473 
	}
}

475 
	$decode_no_mobûe_idítôy
(
NoMobûeIdítôy_t
 *
no_id
, 
uöt8_t
 *
buf„r
)

477 
decoded
 = 0;

478 
no_id
->
ty≥ofidítôy
 = *(
buf„r
 + 
decoded
) & 0x7;

479 i‡(
no_id
->
ty≥ofidítôy
 !
MOBILE_IDENTITY_NOT_AVAILABLE
) {

480  (
TLV_ENCODE_VALUE_DOESNT_MATCH
);

482 
no_id
->
oddeví
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

483 
no_id
->
digô1
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

484 
decoded
++;

485 
no_id
->
digô2
 = *(
buf„r
 + 
decoded
) & 0xf;

486 
no_id
->
digô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

487 
decoded
++;

488 
no_id
->
digô4
 = *(
buf„r
 + 
decoded
) & 0xf;

489 
no_id
->
digô5
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

490 
decoded
++;

491 
no_id
->
digô6
 = *(
buf„r
 + 
decoded
) & 0xf;

492 
no_id
->
digô7
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

493 
decoded
++;

494 
no_id
->
digô8
 = *(
buf„r
 + 
decoded
) & 0xf;

495 
no_id
->
digô9
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

496 
decoded
++;

497 
no_id
->
digô10
 = *(
buf„r
 + 
decoded
) & 0xf;

498 
no_id
->
digô11
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

499 
decoded
++;

500 
no_id
->
digô12
 = *(
buf„r
 + 
decoded
) & 0xf;

501 
no_id
->
digô13
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

502 
decoded
++;

503 
no_id
->
digô14
 = *(
buf„r
 + 
decoded
) & 0xf;

504 
no_id
->
digô15
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

505 
decoded
++;

506  
decoded
;

507 
	}
}

509 
	$ícode_imsi_mobûe_idítôy
(
ImsiMobûeIdítôy_t
 *
imsi
, 
uöt8_t
 *
buf„r
)

511 
uöt32_t
 
ícoded
 = 0;

512 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô1
 << 4Ë| (imsi->
oddeví
 << 3) |

513 (
imsi
->
ty≥ofidítôy
);

514 
ícoded
++;

515 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô3
 << 4Ë| imsi->
digô2
;

516 
ícoded
++;

517 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô5
 << 4Ë| imsi->
digô4
;

518 
ícoded
++;

519 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô7
 << 4Ë| imsi->
digô6
;

520 
ícoded
++;

521 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô9
 << 4Ë| imsi->
digô8
;

522 
ícoded
++;

523 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô11
 << 4Ë| imsi->
digô10
;

524 
ícoded
++;

525 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô13
 << 4Ë| imsi->
digô12
;

526 
ícoded
++;

527 i‡(
imsi
->
oddeví
 !
MOBILE_IDENTITY_EVEN
) {

528 *(
buf„r
 + 
ícoded
Ë0x00 | (
imsi
->
digô15
 << 4Ë| imsi->
digô14
;

531 *(
buf„r
 + 
ícoded
Ë0xf0 | 
imsi
->
digô14
;

533 
ícoded
++;

534  
ícoded
;

535 
	}
}

537 
	$ícode_imei_mobûe_idítôy
(
ImeiMobûeIdítôy_t
 *
imei
, 
uöt8_t
 *
buf„r
)

539 
uöt32_t
 
ícoded
 = 0;

540 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô1
 << 4Ë| (imei->
oddeví
 << 3) |

541 (
imei
->
ty≥ofidítôy
);

542 
ícoded
++;

543 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô3
 << 4Ë| imei->
digô2
;

544 
ícoded
++;

545 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô5
 << 4Ë| imei->
digô4
;

546 
ícoded
++;

547 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô7
 << 4Ë| imei->
digô6
;

548 
ícoded
++;

549 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô9
 << 4Ë| imei->
digô8
;

550 
ícoded
++;

551 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô11
 << 4Ë| imei->
digô10
;

552 
ícoded
++;

553 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô13
 << 4Ë| imei->
digô12
;

554 
ícoded
++;

555 i‡(
imei
->
oddeví
 !
MOBILE_IDENTITY_EVEN
) {

556 *(
buf„r
 + 
ícoded
Ë0x00 | (
imei
->
digô15
 << 4Ë| imei->
digô14
;

559 *(
buf„r
 + 
ícoded
Ë0xf0 | 
imei
->
digô14
;

561 
ícoded
++;

562  
ícoded
;

563 
	}
}

565 
	$ícode_imeisv_mobûe_idítôy
(
ImeisvMobûeIdítôy_t
 *
imeisv
, 
uöt8_t
 *
buf„r
)

567 
uöt32_t
 
ícoded
 = 0;

568 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô1
 << 4Ë| (imeisv->
oddeví
 << 3) |

569 (
imeisv
->
ty≥ofidítôy
);

570 
ícoded
++;

571 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô3
 << 4Ë| imeisv->
digô2
;

572 
ícoded
++;

573 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô5
 << 4Ë| imeisv->
digô4
;

574 
ícoded
++;

575 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô7
 << 4Ë| imeisv->
digô6
;

576 
ícoded
++;

577 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô9
 << 4Ë| imeisv->
digô8
;

578 
ícoded
++;

579 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô11
 << 4Ë| imeisv->
digô10
;

580 
ícoded
++;

581 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô13
 << 4Ë| imeisv->
digô12
;

582 
ícoded
++;

583 i‡(
imeisv
->
oddeví
 !
MOBILE_IDENTITY_EVEN
) {

584 *(
buf„r
 + 
ícoded
Ë0x00 | (
imeisv
->
digô15
 << 4Ë| imeisv->
digô14
;

587 *(
buf„r
 + 
ícoded
Ë0xf0 | 
imeisv
->
digô14
;

589 
ícoded
++;

590  
ícoded
;

591 
	}
}

593 
	$ícode_tmsi_mobûe_idítôy
(
TmsiMobûeIdítôy_t
 *
tmsi
, 
uöt8_t
 *
buf„r
)

595 
uöt32_t
 
ícoded
 = 0;

596 *(
buf„r
 + 
ícoded
Ë0xf0 | (
tmsi
->
oddeví
 << 3Ë| (tmsi->
ty≥ofidítôy
);

597 
ícoded
++;

598 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô3
 << 4Ë|Åmsi->
digô2
;

599 
ícoded
++;

600 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô5
 << 4Ë|Åmsi->
digô4
;

601 
ícoded
++;

602 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô7
 << 4Ë|Åmsi->
digô6
;

603 
ícoded
++;

604 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô9
 << 4Ë|Åmsi->
digô8
;

605 
ícoded
++;

606 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô11
 << 4Ë|Åmsi->
digô10
;

607 
ícoded
++;

608 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô13
 << 4Ë|Åmsi->
digô12
;

609 
ícoded
++;

610 *(
buf„r
 + 
ícoded
Ë0x00 | (
tmsi
->
digô15
 << 4Ë|Åmsi->
digô14
;

611 
ícoded
++;

612  
ícoded
;

613 
	}
}

615 
	$ícode_tmgi_mobûe_idítôy
(
TmgiMobûeIdítôy_t
 *
tmgi
, 
uöt8_t
 *
buf„r
)

617 
uöt32_t
 
ícoded
 = 0;

618 *(
buf„r
 + 
ícoded
) = 0x00 |

619 ((
tmgi
->
mbms£ssi⁄idödiˇti⁄
 & 0x1) << 5) |

620 ((
tmgi
->
mccmncödiˇti⁄
 & 0x1) << 4) |

621 ((
tmgi
->
oddeví
 & 0x1) << 3) |

622 (
tmgi
->
ty≥ofidítôy
 & 0x7);

623 
ícoded
++;

624 
	`IES_ENCODE_U24
(
buf„r
, 
ícoded
, 
tmgi
->
mbms£rvi˚id
);

625 *(
buf„r
 + 
ícoded
Ë0x00 | ((
tmgi
->
mccdigô2
 & 0xf) << 4) |

626 (
tmgi
->
mccdigô1
 & 0xf);

627 
ícoded
++;

628 *(
buf„r
 + 
ícoded
Ë0x00 | ((
tmgi
->
mncdigô3
 & 0xf) << 4) |

629 (
tmgi
->
mccdigô3
 & 0xf);

630 
ícoded
++;

631 *(
buf„r
 + 
ícoded
Ë0x00 | ((
tmgi
->
mncdigô2
 & 0xf) << 4) |

632 (
tmgi
->
mncdigô1
 & 0xf);

633 
ícoded
++;

634 *(
buf„r
 + 
ícoded
Ë
tmgi
->
mbms£ssi⁄id
;

635 
ícoded
++;

636  
ícoded
;

637 
	}
}

639 
	$ícode_no_mobûe_idítôy
(
NoMobûeIdítôy_t
 *
no_id
, 
uöt8_t
 *
buf„r
)

641 
uöt32_t
 
ícoded
 = 0;

642 *(
buf„r
 + 
ícoded
Ë
no_id
->
ty≥ofidítôy
;

643 
ícoded
++;

644 *(
buf„r
 + 
ícoded
) = 0x00;

645 
ícoded
++;

646 *(
buf„r
 + 
ícoded
) = 0x00;

647 
ícoded
++;

648 *(
buf„r
 + 
ícoded
) = 0x00;

649 
ícoded
++;

650 *(
buf„r
 + 
ícoded
) = 0x00;

651 
ícoded
++;

652 *(
buf„r
 + 
ícoded
) = 0x00;

653 
ícoded
++;

654 *(
buf„r
 + 
ícoded
) = 0x00;

655 
ícoded
++;

656 *(
buf„r
 + 
ícoded
) = 0x00;

657 
ícoded
++;

658  
ícoded
;

659 
	}
}

	@src/ies/MobileIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
MOBILE_IDENTITY_H_


36 
	#MOBILE_IDENTITY_H_


	)

38 
	#MOBILE_IDENTITY_MINIMUM_LENGTH
 3

	)

39 
	#MOBILE_IDENTITY_MAXIMUM_LENGTH
 11

	)

41 
	#MOBILE_IDENTITY_NOT_AVAILABLE_GSM_LENGTH
 1

	)

42 
	#MOBILE_IDENTITY_NOT_AVAILABLE_GPRS_LENGTH
 3

	)

43 
	#MOBILE_IDENTITY_NOT_AVAILABLE_LTE_LENGTH
 3

	)

46 
uöt8_t
 
	mdigô1
:4;

47 
uöt8_t
 
	moddeví
:1;

48 
uöt8_t
 
	mty≥ofidítôy
:3;

49 
uöt8_t
 
	mdigô2
:4;

50 
uöt8_t
 
	mdigô3
:4;

51 
uöt8_t
 
	mdigô4
:4;

52 
uöt8_t
 
	mdigô5
:4;

53 
uöt8_t
 
	mdigô6
:4;

54 
uöt8_t
 
	mdigô7
:4;

55 
uöt8_t
 
	mdigô8
:4;

56 
uöt8_t
 
	mdigô9
:4;

57 
uöt8_t
 
	mdigô10
:4;

58 
uöt8_t
 
	mdigô11
:4;

59 
uöt8_t
 
	mdigô12
:4;

60 
uöt8_t
 
	mdigô13
:4;

61 
uöt8_t
 
	mdigô14
:4;

62 
uöt8_t
 
	mdigô15
:4;

63 } 
	tImsiMobûeIdítôy_t
;

66 
uöt8_t
 
	m•¨e
:2;

67 
uöt8_t
 
	mmbms£ssi⁄idödiˇti⁄
:1;

68 
uöt8_t
 
	mmccmncödiˇti⁄
:1;

69 
	#MOBILE_IDENTITY_EVEN
 0

	)

70 
	#MOBILE_IDENTITY_ODD
 1

	)

71 
uöt8_t
 
	moddeví
:1;

72 
uöt8_t
 
	mty≥ofidítôy
:3;

73 
uöt32_t
 
	mmbms£rvi˚id
;

74 
uöt8_t
 
	mmccdigô2
:4;

75 
uöt8_t
 
	mmccdigô1
:4;

76 
uöt8_t
 
	mmncdigô3
:4;

77 
uöt8_t
 
	mmccdigô3
:4;

78 
uöt8_t
 
	mmncdigô2
:4;

79 
uöt8_t
 
	mmncdigô1
:4;

80 
uöt8_t
 
	mmbms£ssi⁄id
;

81 } 
	tTmgiMobûeIdítôy_t
;

83 
ImsiMobûeIdítôy_t
 
	tImeiMobûeIdítôy_t
;

84 
ImsiMobûeIdítôy_t
 
	tImeisvMobûeIdítôy_t
;

85 
ImsiMobûeIdítôy_t
 
	tTmsiMobûeIdítôy_t
;

86 
ImsiMobûeIdítôy_t
 
	tNoMobûeIdítôy_t
;

88 
	uMobûeIdítôy_èg
 {

89 
	#MOBILE_IDENTITY_IMSI
 0b001

	)

90 
	#MOBILE_IDENTITY_IMEI
 0b010

	)

91 
	#MOBILE_IDENTITY_IMEISV
 0b011

	)

92 
	#MOBILE_IDENTITY_TMSI
 0b100

	)

93 
	#MOBILE_IDENTITY_TMGI
 0b101

	)

94 
	#MOBILE_IDENTITY_NOT_AVAILABLE
 0b000

	)

95 
ImsiMobûeIdítôy_t
 
	mimsi
;

96 
ImeiMobûeIdítôy_t
 
	mimei
;

97 
ImeisvMobûeIdítôy_t
 
	mimeisv
;

98 
TmsiMobûeIdítôy_t
 
	mtmsi
;

99 
TmgiMobûeIdítôy_t
 
	mtmgi
;

100 
NoMobûeIdítôy_t
 
	mno_id
;

101 } 
	tMobûeIdítôy
;

103 
ícode_mobûe_idítôy
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

105 
decode_mobûe_idítôy
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

107 
dump_mobûe_idítôy_xml
(
MobûeIdítôy
 *
mobûeidítôy
, 
uöt8_t
 
õi
);

	@src/ies/MobileStationClassmark2.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"MobûeSèti⁄Cœssm¨k2.h
"

38 
	$decode_mobûe_°©i⁄_˛assm¨k_2
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
mobûe°©i⁄˛assm¨k2
->
ªvisi⁄Àvñ
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x3;

51 
mobûe°©i⁄˛assm¨k2
->
esöd
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

52 
mobûe°©i⁄˛assm¨k2
->
a51
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

53 
mobûe°©i⁄˛assm¨k2
->
rÂowîˇ∑bûôy
 = *(
buf„r
 + 
decoded
) & 0x7;

54 
decoded
++;

55 
mobûe°©i⁄˛assm¨k2
->
psˇ∑bûôy
 = (*(
buf„r
 + 
decoded
) >> 6) & 0x1;

56 
mobûe°©i⁄˛assm¨k2
->
sss¸ìnödiˇt‹
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x3;

57 
mobûe°©i⁄˛assm¨k2
->
smˇ∑bûôy
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

58 
mobûe°©i⁄˛assm¨k2
->
vbs
 = (*(
buf„r
 + 
decoded
) >> 2) & 0x1;

59 
mobûe°©i⁄˛assm¨k2
->
vgcs
 = (*(
buf„r
 + 
decoded
) >> 1) & 0x1;

60 
mobûe°©i⁄˛assm¨k2
->
fc
 = *(
buf„r
 + 
decoded
) & 0x1;

61 
decoded
++;

62 
mobûe°©i⁄˛assm¨k2
->
cm3
 = (*(
buf„r
 + 
decoded
) >> 7) & 0x1;

63 
mobûe°©i⁄˛assm¨k2
->
lcsvaˇp
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x1;

64 
mobûe°©i⁄˛assm¨k2
->
ucs2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

65 
mobûe°©i⁄˛assm¨k2
->
sﬁß
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

66 
mobûe°©i⁄˛assm¨k2
->
cm•
 = (*(
buf„r
 + 
decoded
) >> 2) & 0x1;

67 
mobûe°©i⁄˛assm¨k2
->
a53
 = (*(
buf„r
 + 
decoded
) >> 1) & 0x1;

68 
mobûe°©i⁄˛assm¨k2
->
a52
 = *(
buf„r
 + 
decoded
) & 0x1;

69 
decoded
++;

70 #i‡
	`deföed
 (
NAS_DEBUG
)

71 
	`dump_mobûe_°©i⁄_˛assm¨k_2_xml
(
mobûe°©i⁄˛assm¨k2
, 
õi
);

73  
decoded
;

74 
	}
}

75 
	$ícode_mobûe_°©i⁄_˛assm¨k_2
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

77 
uöt8_t
 *
ÀnPå
;

78 
uöt32_t
 
ícoded
 = 0;

80 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MOBILE_STATION_CLASSMARK_2_MINIMUM_LENGTH
, 
Àn
);

81 #i‡
	`deföed
 (
NAS_DEBUG
)

82 
	`dump_mobûe_°©i⁄_˛assm¨k_2_xml
(
mobûe°©i⁄˛assm¨k2
, 
õi
);

84 i‡(
õi
 > 0)

86 *
buf„r
 = 
õi
;

87 
ícoded
++;

89 
ÀnPå
 = (
buf„r
 + 
ícoded
);

90 
ícoded
 ++;

91 *(
buf„r
 + 
ícoded
) = 0x00 |

92 ((
mobûe°©i⁄˛assm¨k2
->
ªvisi⁄Àvñ
 & 0x3) << 5) |

93 ((
mobûe°©i⁄˛assm¨k2
->
esöd
 & 0x1) << 4) |

94 ((
mobûe°©i⁄˛assm¨k2
->
a51
 & 0x1) << 3) |

95 (
mobûe°©i⁄˛assm¨k2
->
rÂowîˇ∑bûôy
 & 0x7);

96 
ícoded
++;

97 *(
buf„r
 + 
ícoded
) = 0x00 |

98 ((
mobûe°©i⁄˛assm¨k2
->
psˇ∑bûôy
 & 0x1) << 6) |

99 ((
mobûe°©i⁄˛assm¨k2
->
sss¸ìnödiˇt‹
 & 0x3) << 4) |

100 ((
mobûe°©i⁄˛assm¨k2
->
smˇ∑bûôy
 & 0x1) << 3) |

101 ((
mobûe°©i⁄˛assm¨k2
->
vbs
 & 0x1) << 2) |

102 ((
mobûe°©i⁄˛assm¨k2
->
vgcs
 & 0x1) << 1) |

103 (
mobûe°©i⁄˛assm¨k2
->
fc
 & 0x1);

104 
ícoded
++;

105 *(
buf„r
 + 
ícoded
Ë0x00 | ((
mobûe°©i⁄˛assm¨k2
->
cm3
 & 0x1) << 7) |

106 ((
mobûe°©i⁄˛assm¨k2
->
lcsvaˇp
 & 0x1) << 5) |

107 ((
mobûe°©i⁄˛assm¨k2
->
ucs2
 & 0x1) << 4) |

108 ((
mobûe°©i⁄˛assm¨k2
->
sﬁß
 & 0x1) << 3) |

109 ((
mobûe°©i⁄˛assm¨k2
->
cm•
 & 0x1) << 2) |

110 ((
mobûe°©i⁄˛assm¨k2
->
a53
 & 0x1) << 1) |

111 (
mobûe°©i⁄˛assm¨k2
->
a52
 & 0x1);

112 
ícoded
++;

113 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

114  
ícoded
;

115 
	}
}

117 
	$dump_mobûe_°©i⁄_˛assm¨k_2_xml
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
)

119 
	`¥ötf
("<Mobile Station Classmark 2>\n");

120 i‡(
õi
 > 0)

122 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

123 
	`¥ötf
(" <Revisi⁄Üevñ>%u</Revisi⁄Üevñ>\n", 
mobûe°©i⁄˛assm¨k2
->
ªvisi⁄Àvñ
);

124 
	`¥ötf
(" <ES IND>%u</ES IND>\n", 
mobûe°©i⁄˛assm¨k2
->
esöd
);

125 
	`¥ötf
(" <A51>%u</A51>\n", 
mobûe°©i⁄˛assm¨k2
->
a51
);

126 
	`¥ötf
(" <RFÖowî c≠abûôy>%u</RFÖowî c≠abûôy>\n", 
mobûe°©i⁄˛assm¨k2
->
rÂowîˇ∑bûôy
);

127 
	`¥ötf
(" <PS c≠abûôy>%u</PS c≠abûôy>\n", 
mobûe°©i⁄˛assm¨k2
->
psˇ∑bûôy
);

128 
	`¥ötf
(" <SS S¸ì¿ödiˇt‹>%u</SS S¸ì¿ödiˇt‹>\n", 
mobûe°©i⁄˛assm¨k2
->
sss¸ìnödiˇt‹
);

129 
	`¥ötf
(" <SM c≠abûôy>%u</SM c≠abûôy>\n", 
mobûe°©i⁄˛assm¨k2
->
smˇ∑bûôy
);

130 
	`¥ötf
(" <VBS>%u</VBS>\n", 
mobûe°©i⁄˛assm¨k2
->
vbs
);

131 
	`¥ötf
(" <VGCS>%u</VGCS>\n", 
mobûe°©i⁄˛assm¨k2
->
vgcs
);

132 
	`¥ötf
(" <FC>%u</FC>\n", 
mobûe°©i⁄˛assm¨k2
->
fc
);

133 
	`¥ötf
(" <CM3>%u</CM3>\n", 
mobûe°©i⁄˛assm¨k2
->
cm3
);

134 
	`¥ötf
(" <LCSVA CAP>%u</LCSVA CAP>\n", 
mobûe°©i⁄˛assm¨k2
->
lcsvaˇp
);

135 
	`¥ötf
(" <UCS2>%u</UCS2>\n", 
mobûe°©i⁄˛assm¨k2
->
ucs2
);

136 
	`¥ötf
(" <SoLSA>%u</SoLSA>\n", 
mobûe°©i⁄˛assm¨k2
->
sﬁß
);

137 
	`¥ötf
(" <CMSP>%u</CMSP>\n", 
mobûe°©i⁄˛assm¨k2
->
cm•
);

138 
	`¥ötf
(" <A53>%u</A53>\n", 
mobûe°©i⁄˛assm¨k2
->
a53
);

139 
	`¥ötf
(" <A52>%u</A52>\n", 
mobûe°©i⁄˛assm¨k2
->
a52
);

140 
	`¥ötf
("</Mobile Station Classmark 2>\n");

141 
	}
}

	@src/ies/MobileStationClassmark2.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
MOBILE_STATION_CLASSMARK_2_H_


36 
	#MOBILE_STATION_CLASSMARK_2_H_


	)

38 
	#MOBILE_STATION_CLASSMARK_2_MINIMUM_LENGTH
 5

	)

39 
	#MOBILE_STATION_CLASSMARK_2_MAXIMUM_LENGTH
 5

	)

41 
	sMobûeSèti⁄Cœssm¨k2_èg
 {

42 
uöt8_t
 
	mªvisi⁄Àvñ
:2;

43 
uöt8_t
 
	mesöd
:1;

44 
uöt8_t
 
	ma51
:1;

45 
uöt8_t
 
	mrÂowîˇ∑bûôy
:3;

46 
uöt8_t
 
	mpsˇ∑bûôy
:1;

47 
uöt8_t
 
	msss¸ìnödiˇt‹
:2;

48 
uöt8_t
 
	msmˇ∑bûôy
:1;

49 
uöt8_t
 
	mvbs
:1;

50 
uöt8_t
 
	mvgcs
:1;

51 
uöt8_t
 
	mfc
:1;

52 
uöt8_t
 
	mcm3
:1;

53 
uöt8_t
 
	mlcsvaˇp
:1;

54 
uöt8_t
 
	mucs2
:1;

55 
uöt8_t
 
	msﬁß
:1;

56 
uöt8_t
 
	mcm•
:1;

57 
uöt8_t
 
	ma53
:1;

58 
uöt8_t
 
	ma52
:1;

59 } 
	tMobûeSèti⁄Cœssm¨k2
;

61 
ícode_mobûe_°©i⁄_˛assm¨k_2
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

63 
decode_mobûe_°©i⁄_˛assm¨k_2
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

65 
dump_mobûe_°©i⁄_˛assm¨k_2_xml
(
MobûeSèti⁄Cœssm¨k2
 *
mobûe°©i⁄˛assm¨k2
, 
uöt8_t
 
õi
);

	@src/ies/MobileStationClassmark3.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"MobûeSèti⁄Cœssm¨k3.h
"

38 
	$decode_mobûe_°©i⁄_˛assm¨k_3
(
MobûeSèti⁄Cœssm¨k3
 *
mobûe°©i⁄˛assm¨k3
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_mobûe_°©i⁄_˛assm¨k_3
(
MobûeSèti⁄Cœssm¨k3
 *
mobûe°©i⁄˛assm¨k3
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/MobileStationClassmark3.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
MOBILE_STATION_CLASSMARK_3_H_


36 
	#MOBILE_STATION_CLASSMARK_3_H_


	)

38 
	#MOBILE_STATION_CLASSMARK_3_MINIMUM_LENGTH
 1

	)

39 
	#MOBILE_STATION_CLASSMARK_3_MAXIMUM_LENGTH
 1

	)

42 
uöt8_t
 
	mfõld
;

43 } 
	tMobûeSèti⁄Cœssm¨k3
;

45 
ícode_mobûe_°©i⁄_˛assm¨k_3
(
MobûeSèti⁄Cœssm¨k3
 *
mobûe°©i⁄˛assm¨k3
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_mobûe_°©i⁄_˛assm¨k_3_xml
(
MobûeSèti⁄Cœssm¨k3
 *
mobûe°©i⁄˛assm¨k3
, 
uöt8_t
 
õi
);

49 
decode_mobûe_°©i⁄_˛assm¨k_3
(
MobûeSèti⁄Cœssm¨k3
 *
mobûe°©i⁄˛assm¨k3
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/MsNetworkCapability.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"MsNëw‹kC≠abûôy.h
"

38 
	$decode_ms_√tw‹k_ˇ∑bûôy
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
m¢ëw‹kˇ∑bûôy
->
m¢ëw‹kˇ∑bûôyvÆue
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_ms_√tw‹k_ˇ∑bûôy_xml
(
m¢ëw‹kˇ∑bûôy
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_ms_√tw‹k_ˇ∑bûôy
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
MS_NETWORK_CAPABILITY_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_ms_√tw‹k_ˇ∑bûôy_xml
(
m¢ëw‹kˇ∑bûôy
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
m¢ëw‹kˇ∑bûôy
->
m¢ëw‹kˇ∑bûôyvÆue
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_ms_√tw‹k_ˇ∑bûôy_xml
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Ms Network Capability>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
m¢ëw‹kˇ∑bûôy
->
m¢ëw‹kˇ∑bûôyvÆue
));

92 
	`¥ötf
("</Ms Network Capability>\n");

93 
	}
}

	@src/ies/MsNetworkCapability.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
MS_NETWORK_CAPABILITY_H_


36 
	#MS_NETWORK_CAPABILITY_H_


	)

38 
	#MS_NETWORK_CAPABILITY_MINIMUM_LENGTH
 3

	)

39 
	#MS_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 10

	)

41 
	sMsNëw‹kC≠abûôy_èg
 {

42 
O˘ëSåög
 
	mm¢ëw‹kˇ∑bûôyvÆue
;

43 } 
	tMsNëw‹kC≠abûôy
;

45 
ícode_ms_√tw‹k_ˇ∑bûôy
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_ms_√tw‹k_ˇ∑bûôy
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_ms_√tw‹k_ˇ∑bûôy_xml
(
MsNëw‹kC≠abûôy
 *
m¢ëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
);

	@src/ies/NasKeySetIdentifier.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"NasKeySëIdítifõr.h
"

38 
	$decode_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 
«skey£tidítifõr
->
tsc
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

47 
«skey£tidítifõr
->«skey£tidítifõ∏*(
buf„r
 + 
decoded
) & 0x7;

48 
decoded
++;

49 #i‡
	`deföed
 (
NAS_DEBUG
)

50 
	`dump_«s_key_£t_idítifõr_xml
(
«skey£tidítifõr
, 
õi
);

52  
decoded
;

53 
	}
}

55 
	$decode_u8_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

57 
decoded
 = 0;

58 
uöt8_t
 *
buf„r
 = &
vÆue
;

59 
«skey£tidítifõr
->
tsc
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

60 
«skey£tidítifõr
->«skey£tidítifõ∏*(
buf„r
 + 
decoded
) & 0x7;

61 
decoded
++;

62 #i‡
	`deföed
 (
NAS_DEBUG
)

63 
	`dump_«s_key_£t_idítifõr_xml
(
«skey£tidítifõr
, 
õi
);

65  
decoded
;

66 
	}
}

68 
	$ícode_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

70 
uöt8_t
 
ícoded
 = 0;

72 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
, 
Àn
);

73 #i‡
	`deföed
 (
NAS_DEBUG
)

74 
	`dump_«s_key_£t_idítifõr_xml
(
«skey£tidítifõr
, 
õi
);

76 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

77 ((
«skey£tidítifõr
->
tsc
 & 0x1) << 3) |

78 (
«skey£tidítifõr
->naskeysetidentifier & 0x7);

79 
ícoded
++;

80  
ícoded
;

81 
	}
}

83 
uöt8_t
 
	$ícode_u8_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
)

85 
uöt8_t
 
buf„rRëu∫
;

86 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

87 
uöt8_t
 
ícoded
 = 0;

88 
uöt8_t
 
õi
 = 0;

89 #i‡
	`deföed
 (
NAS_DEBUG
)

90 
	`dump_«s_key_£t_idítifõr_xml
(
«skey£tidítifõr
, 0);

92 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

93 ((
«skey£tidítifõr
->
tsc
 & 0x1) << 3) |

94 (
«skey£tidítifõr
->naskeysetidentifier & 0x7);

95 
ícoded
++;

97  
buf„rRëu∫
;

98 
	}
}

100 
	$dump_«s_key_£t_idítifõr_xml
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
)

102 
	`¥ötf
("<Nas Key Set Identifier>\n");

103 i‡(
õi
 > 0)

105 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

106 
	`¥ötf
(" <TSC>%u</TSC>\n", 
«skey£tidítifõr
->
tsc
);

107 
	`¥ötf
(" <NAS key së idítifõr>%u</NAS key së idítifõr>\n", 
«skey£tidítifõr
->naskeysetidentifier);

108 
	`¥ötf
("</Nas Key Set Identifier>\n");

109 
	}
}

	@src/ies/NasKeySetIdentifier.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NAS_KEY_SET_IDENTIFIER_H_


36 
	#NAS_KEY_SET_IDENTIFIER_H_


	)

38 
	#NAS_KEY_SET_IDENTIFIER_MINIMUM_LENGTH
 1

	)

39 
	#NAS_KEY_SET_IDENTIFIER_MAXIMUM_LENGTH
 1

	)

41 
	sNasKeySëIdítifõr_èg
 {

42 
	#NAS_KEY_SET_IDENTIFIER_NATIVE
 0

	)

43 
	#NAS_KEY_SET_IDENTIFIER_MAPPED
 1

	)

44 
uöt8_t
 
	mtsc
:1;

45 
	#NAS_KEY_SET_IDENTIFIER_NOT_AVAILABLE
 0b111

	)

46 
uöt8_t
 
	m«skey£tidítifõr
:3;

47 } 
	tNasKeySëIdítifõr
;

49 
ícode_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
dump_«s_key_£t_idítifõr_xml
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
);

53 
uöt8_t
 
ícode_u8_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
);

55 
decode_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

57 
decode_u8_«s_key_£t_idítifõr
(
NasKeySëIdítifõr
 *
«skey£tidítifõr
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/NasMessageContainer.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"NasMesßgeC⁄èöî.h
"

38 
	$decode_«s_mesßge_c⁄èöî
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
«smesßgec⁄èöî
->
«smesßgec⁄èöîc⁄ã¡s
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

52  
decode_ªsu…
;

54 
decoded
 +
decode_ªsu…
;

55 #i‡
	`deföed
 (
NAS_DEBUG
)

56 
	`dump_«s_mesßge_c⁄èöî_xml
(
«smesßgec⁄èöî
, 
õi
);

58  
decoded
;

59 
	}
}

60 
	$ícode_«s_mesßge_c⁄èöî
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

62 
uöt8_t
 *
ÀnPå
;

63 
uöt32_t
 
ícoded
 = 0;

64 
ícode_ªsu…
;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
NAS_MESSAGE_CONTAINER_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_«s_mesßge_c⁄èöî_xml
(
«smesßgec⁄èöî
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
«smesßgec⁄èöî
->
«smesßgec⁄èöîc⁄ã¡s
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

78  
ícode_ªsu…
;

80 
ícoded
 +
ícode_ªsu…
;

81 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

82  
ícoded
;

83 
	}
}

85 
	$dump_«s_mesßge_c⁄èöî_xml
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
)

87 
	`¥ötf
("<Nas Message Container>\n");

88 i‡(
õi
 > 0)

90 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

91 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
«smesßgec⁄èöî
->
«smesßgec⁄èöîc⁄ã¡s
));

92 
	`¥ötf
("</Nas Message Container>\n");

93 
	}
}

	@src/ies/NasMessageContainer.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NAS_MESSAGE_CONTAINER_H_


36 
	#NAS_MESSAGE_CONTAINER_H_


	)

38 
	#NAS_MESSAGE_CONTAINER_MINIMUM_LENGTH
 4

	)

39 
	#NAS_MESSAGE_CONTAINER_MAXIMUM_LENGTH
 253

	)

41 
	sNasMesßgeC⁄èöî_èg
 {

42 
O˘ëSåög
 
	m«smesßgec⁄èöîc⁄ã¡s
;

43 } 
	tNasMesßgeC⁄èöî
;

45 
ícode_«s_mesßge_c⁄èöî
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
decode_«s_mesßge_c⁄èöî
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_«s_mesßge_c⁄èöî_xml
(
NasMesßgeC⁄èöî
 *
«smesßgec⁄èöî
, 
uöt8_t
 
õi
);

	@src/ies/NasRequestType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"NasReque°Ty≥.h
"

38 
	$decode_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
REQUEST_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
ªque°ty≥
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ªque°_ty≥_xml
(
ªque°ty≥
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
ªque°ty≥
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ªque°_ty≥_xml
(
ªque°ty≥
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
REQUEST_TYPE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ªque°_ty≥_xml
(
ªque°ty≥
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
ªque°ty≥
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_ªque°_ty≥_xml
(
ªque°ty≥
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
ªque°ty≥
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_ªque°_ty≥_xml
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Request Type>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <Reque°Åy≥ vÆue>%u</Reque°Åy≥ vÆue>\n", *
ªque°ty≥
);

103 
	`¥ötf
("</Request Type>\n");

104 
	}
}

	@src/ies/NasRequestType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NAS_REQUEST_TYPE_H_


36 
	#NAS_REQUEST_TYPE_H_


	)

38 
	#REQUEST_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#REQUEST_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	#REQUEST_TYPE_INITIAL_REQUEST
 0b001

	)

42 
	#REQUEST_TYPE_HANDOVER
 0b010

	)

43 
	#REQUEST_TYPE_UNUSED
 0b011

	)

44 
	#REQUEST_TYPE_EMERGENCY
 0b100

	)

45 
uöt8_t
 
	tReque°Ty≥
;

47 
ícode_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_ªque°_ty≥_xml
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
);

51 
uöt8_t
 
ícode_u8_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
);

53 
decode_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
decode_u8_ªque°_ty≥
(
Reque°Ty≥
 *
ªque°ty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/NasSecurityAlgorithms.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"NasSecurôyAlg‹ôhms.h
"

38 
	$decode_«s_£curôy_Æg‹ôhms
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
«s£curôyÆg‹ôhms
->
ty≥ofcùhîögÆg‹ôhm
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x7;

47 
«s£curôyÆg‹ôhms
->
ty≥oföãgrôyÆg‹ôhm
 = *(
buf„r
 + 
decoded
) & 0x7;

48 
decoded
++;

49 #i‡
	`deföed
 (
NAS_DEBUG
)

50 
	`dump_«s_£curôy_Æg‹ôhms_xml
(
«s£curôyÆg‹ôhms
, 
õi
);

52  
decoded
;

53 
	}
}

55 
	$ícode_«s_£curôy_Æg‹ôhms
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

57 
uöt32_t
 
ícoded
 = 0;

59 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
NAS_SECURITY_ALGORITHMS_MINIMUM_LENGTH
, 
Àn
);

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_«s_£curôy_Æg‹ôhms_xml
(
«s£curôyÆg‹ôhms
, 
õi
);

63 i‡(
õi
 > 0)

65 *
buf„r
 = 
õi
;

66 
ícoded
++;

68 *(
buf„r
 + 
ícoded
) = 0x00 |

69 ((
«s£curôyÆg‹ôhms
->
ty≥ofcùhîögÆg‹ôhm
 & 0x7) << 4) |

70 (
«s£curôyÆg‹ôhms
->
ty≥oföãgrôyÆg‹ôhm
 & 0x7);

71 
ícoded
++;

72  
ícoded
;

73 
	}
}

75 
	$dump_«s_£curôy_Æg‹ôhms_xml
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
)

77 
	`¥ötf
("<Nas Security Algorithms>\n");

78 i‡(
õi
 > 0)

80 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

81 
	`¥ötf
(" <Ty≥ o‡cùhîögálg‹ôhm>%u</Ty≥ o‡cùhîögálg‹ôhm>\n", 
«s£curôyÆg‹ôhms
->
ty≥ofcùhîögÆg‹ôhm
);

82 
	`¥ötf
(" <Ty≥ o‡öãgrôyálg‹ôhm>%u</Ty≥ o‡öãgrôyálg‹ôhm>\n", 
«s£curôyÆg‹ôhms
->
ty≥oföãgrôyÆg‹ôhm
);

83 
	`¥ötf
("</Nas Security Algorithms>\n");

84 
	}
}

	@src/ies/NasSecurityAlgorithms.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NAS_SECURITY_ALGORITHMS_H_


36 
	#NAS_SECURITY_ALGORITHMS_H_


	)

38 
	#NAS_SECURITY_ALGORITHMS_MINIMUM_LENGTH
 1

	)

39 
	#NAS_SECURITY_ALGORITHMS_MAXIMUM_LENGTH
 2

	)

41 
	sNasSecurôyAlg‹ôhms_èg
 {

42 
	#NAS_SECURITY_ALGORITHMS_EEA0
 0b000

	)

43 
	#NAS_SECURITY_ALGORITHMS_EEA1
 0b001

	)

44 
	#NAS_SECURITY_ALGORITHMS_EEA2
 0b010

	)

45 
	#NAS_SECURITY_ALGORITHMS_EEA3
 0b011

	)

46 
	#NAS_SECURITY_ALGORITHMS_EEA4
 0b100

	)

47 
	#NAS_SECURITY_ALGORITHMS_EEA5
 0b101

	)

48 
	#NAS_SECURITY_ALGORITHMS_EEA6
 0b110

	)

49 
	#NAS_SECURITY_ALGORITHMS_EEA7
 0b111

	)

50 
uöt8_t
 
	mty≥ofcùhîögÆg‹ôhm
:3;

51 
	#NAS_SECURITY_ALGORITHMS_EIA0
 0b000

	)

52 
	#NAS_SECURITY_ALGORITHMS_EIA1
 0b001

	)

53 
	#NAS_SECURITY_ALGORITHMS_EIA2
 0b010

	)

54 
	#NAS_SECURITY_ALGORITHMS_EIA3
 0b011

	)

55 
	#NAS_SECURITY_ALGORITHMS_EIA4
 0b100

	)

56 
	#NAS_SECURITY_ALGORITHMS_EIA5
 0b101

	)

57 
	#NAS_SECURITY_ALGORITHMS_EIA6
 0b110

	)

58 
	#NAS_SECURITY_ALGORITHMS_EIA7
 0b111

	)

59 
uöt8_t
 
	mty≥oföãgrôyÆg‹ôhm
:3;

60 } 
	tNasSecurôyAlg‹ôhms
;

62 
ícode_«s_£curôy_Æg‹ôhms
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

64 
dump_«s_£curôy_Æg‹ôhms_xml
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
);

66 
decode_«s_£curôy_Æg‹ôhms
(
NasSecurôyAlg‹ôhms
 *
«s£curôyÆg‹ôhms
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/NetworkName.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Nëw‹kName.h
"

38 
	$decode_√tw‹k_«me
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 i‡(((*
buf„r
 >> 7) & 0x1) != 1)

53 
îr‹CodeDecodî
 = 
TLV_DECODE_VALUE_DOESNT_MATCH
;

54  
TLV_DECODE_VALUE_DOESNT_MATCH
;

56 
√tw‹k«me
->
codögscheme
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

57 
√tw‹k«me
->
addci
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

58 
√tw‹k«me
->
numbîof•¨ebôsöœ°o˘ë
 = (*(
buf„r
 + 
decoded
) >> 1) & 0x7;

59 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
√tw‹k«me
->
ãxt°rög
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

60  
decode_ªsu…
;

62 
decoded
 +
decode_ªsu…
;

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_√tw‹k_«me_xml
(
√tw‹k«me
, 
õi
);

66  
decoded
;

67 
	}
}

68 
	$ícode_√tw‹k_«me
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

70 
uöt8_t
 *
ÀnPå
;

71 
uöt32_t
 
ícoded
 = 0;

72 
ícode_ªsu…
;

74 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
NETWORK_NAME_MINIMUM_LENGTH
, 
Àn
);

75 #i‡
	`deföed
 (
NAS_DEBUG
)

76 
	`dump_√tw‹k_«me_xml
(
√tw‹k«me
, 
õi
);

78 i‡(
õi
 > 0)

80 *
buf„r
 = 
õi
;

81 
ícoded
++;

83 
ÀnPå
 = (
buf„r
 + 
ícoded
);

84 
ícoded
 ++;

85 *(
buf„r
 + 
ícoded
) = 0x00 | (1 << 7) |

86 ((
√tw‹k«me
->
codögscheme
 & 0x7) << 4) |

87 ((
√tw‹k«me
->
addci
 & 0x1) << 3) |

88 (
√tw‹k«me
->
numbîof•¨ebôsöœ°o˘ë
 & 0x7);

89 
ícoded
++;

90 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
√tw‹k«me
->
ãxt°rög
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

91  
ícode_ªsu…
;

93 
ícoded
 +
ícode_ªsu…
;

94 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

95  
ícoded
;

96 
	}
}

98 
	$dump_√tw‹k_«me_xml
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
)

100 
	`¥ötf
("<Network Name>\n");

101 i‡(
õi
 > 0)

103 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

104 
	`¥ötf
(" <Codög scheme>%u</Codög scheme>\n", 
√tw‹k«me
->
codögscheme
);

105 
	`¥ötf
(" <Add CI>%u</Add CI>\n", 
√tw‹k«me
->
addci
);

106 
	`¥ötf
(" <Numbî o‡•¨êbô†öÜa° o˘ë>%u</Numbî o‡•¨êbô†öÜa° o˘ë>\n", 
√tw‹k«me
->
numbîof•¨ebôsöœ°o˘ë
);

107 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
√tw‹k«me
->
ãxt°rög
));

108 
	`¥ötf
("</Network Name>\n");

109 
	}
}

	@src/ies/NetworkName.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NETWORK_NAME_H_


36 
	#NETWORK_NAME_H_


	)

38 
	#NETWORK_NAME_MINIMUM_LENGTH
 3

	)

39 
	#NETWORK_NAME_MAXIMUM_LENGTH
 255

	)

41 
	sNëw‹kName_èg
 {

42 
uöt8_t
 
	mcodögscheme
:3;

43 
uöt8_t
 
	maddci
:1;

44 
uöt8_t
 
	mnumbîof•¨ebôsöœ°o˘ë
:3;

45 
O˘ëSåög
 
	mãxt°rög
;

46 } 
	tNëw‹kName
;

48 
ícode_√tw‹k_«me
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

50 
decode_√tw‹k_«me
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

52 
dump_√tw‹k_«me_xml
(
Nëw‹kName
 *
√tw‹k«me
, 
uöt8_t
 
õi
);

	@src/ies/Nonce.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"N⁄˚.h
"

38 
	$decode_n⁄˚
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

47 
	`IES_DECODE_U32
(
buf„r
, 
decoded
, *
n⁄˚
);

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_n⁄˚_xml
(
n⁄˚
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_n⁄˚
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
NONCE_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_n⁄˚_xml
(
n⁄˚
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 
	`IES_ENCODE_U32
(
buf„r
, 
ícoded
, *
n⁄˚
);

68  
ícoded
;

69 
	}
}

71 
	$dump_n⁄˚_xml
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
)

73 
	`¥ötf
("<Nonce>\n");

74 i‡(
õi
 > 0)

76 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

77 
	`¥ötf
(" <N⁄˚ vÆue>%u</N⁄˚ vÆue>\n", *
n⁄˚
);

78 
	`¥ötf
("</Nonce>\n");

79 
	}
}

	@src/ies/Nonce.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
NONCE_H_


36 
	#NONCE_H_


	)

38 
	#NONCE_MINIMUM_LENGTH
 5

	)

39 
	#NONCE_MAXIMUM_LENGTH
 5

	)

41 
uöt32_t
 
	tN⁄˚
;

43 
ícode_n⁄˚
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_n⁄˚_xml
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
);

47 
decode_n⁄˚
(
N⁄˚
 *
n⁄˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/PTmsiSignature.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PTmsiSig«tuª.h
"

38 
	$decode_p_tmsi_sig«tuª
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
decode_ªsu…
;

42 
uöt8_t
 
õÀn
 = 3;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
±msisig«tuª
->
±msisig«tuªvÆue
, 
õÀn
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

49  
decode_ªsu…
;

51 
decoded
 +
decode_ªsu…
;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_p_tmsi_sig«tuª_xml
(
±msisig«tuª
, 
õi
);

55  
decoded
;

56 
	}
}

58 
	$ícode_p_tmsi_sig«tuª
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

60 
uöt32_t
 
ícode_ªsu…
;

61 
uöt32_t
 
ícoded
 = 0;

63 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
P_TMSI_SIGNATURE_MINIMUM_LENGTH
, 
Àn
);

64 #i‡
	`deföed
 (
NAS_DEBUG
)

65 
	`dump_p_tmsi_sig«tuª_xml
(
±msisig«tuª
, 
õi
);

67 i‡(
õi
 > 0)

69 *
buf„r
 = 
õi
;

70 
ícoded
++;

72 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
±msisig«tuª
->
±msisig«tuªvÆue
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

73  
ícode_ªsu…
;

75 
ícoded
 +
ícode_ªsu…
;

76  
ícoded
;

77 
	}
}

79 
	$dump_p_tmsi_sig«tuª_xml
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
)

81 
	`¥ötf
("<P Tmsi Signature>\n");

82 i‡(
õi
 > 0)

84 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

85 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
±msisig«tuª
->
±msisig«tuªvÆue
));

86 
	`¥ötf
("</P Tmsi Signature>\n");

87 
	}
}

	@src/ies/PTmsiSignature.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
P_TMSI_SIGNATURE_H_


36 
	#P_TMSI_SIGNATURE_H_


	)

38 
	#P_TMSI_SIGNATURE_MINIMUM_LENGTH
 4

	)

39 
	#P_TMSI_SIGNATURE_MAXIMUM_LENGTH
 4

	)

41 
	sPTmsiSig«tuª_èg
 {

42 
O˘ëSåög
 
	m±msisig«tuªvÆue
;

43 } 
	tPTmsiSig«tuª
;

45 
ícode_p_tmsi_sig«tuª
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_p_tmsi_sig«tuª_xml
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
);

49 
decode_p_tmsi_sig«tuª
(
PTmsiSig«tuª
 *
±msisig«tuª
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/PacketFlowIdentifier.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PackëFlowIdítifõr.h
"

38 
	$decode_∑ckë_Êow_idítifõr
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 *
∑ckëÊowidítifõr
 = *
buf„r
 & 0x7f;

51 
decoded
++;

52 #i‡
	`deföed
 (
NAS_DEBUG
)

53 
	`dump_∑ckë_Êow_idítifõr_xml
(
∑ckëÊowidítifõr
, 
õi
);

55  
decoded
;

56 
	}
}

57 
	$ícode_∑ckë_Êow_idítifõr
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
uöt8_t
 *
ÀnPå
;

60 
uöt32_t
 
ícoded
 = 0;

62 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PACKET_FLOW_IDENTIFIER_MINIMUM_LENGTH
, 
Àn
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_∑ckë_Êow_idítifõr_xml
(
∑ckëÊowidítifõr
, 
õi
);

66 i‡(
õi
 > 0)

68 *
buf„r
 = 
õi
;

69 
ícoded
++;

71 
ÀnPå
 = (
buf„r
 + 
ícoded
);

72 
ícoded
 ++;

73 *(
buf„r
 + 
ícoded
) = 0x00 |

74 (*
∑ckëÊowidítifõr
 & 0x7f);

75 
ícoded
++;

76 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

77  
ícoded
;

78 
	}
}

80 
	$dump_∑ckë_Êow_idítifõr_xml
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
)

82 
	`¥ötf
("<Packet Flow Identifier>\n");

83 i‡(
õi
 > 0)

85 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

86 
	`¥ötf
(" <Packë flow idítifõ∏vÆue>%u</Packë flow idítifõ∏vÆue>\n", *
∑ckëÊowidítifõr
);

87 
	`¥ötf
("</Packet Flow Identifier>\n");

88 
	}
}

	@src/ies/PacketFlowIdentifier.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PACKET_FLOW_IDENTIFIER_H_


36 
	#PACKET_FLOW_IDENTIFIER_H_


	)

38 
	#PACKET_FLOW_IDENTIFIER_MINIMUM_LENGTH
 3

	)

39 
	#PACKET_FLOW_IDENTIFIER_MAXIMUM_LENGTH
 3

	)

41 
uöt8_t
 
	tPackëFlowIdítifõr
;

43 
ícode_∑ckë_Êow_idítifõr
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
decode_∑ckë_Êow_idítifõr
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_∑ckë_Êow_idítifõr_xml
(
PackëFlowIdítifõr
 *
∑ckëÊowidítifõr
, 
uöt8_t
 
õi
);

	@src/ies/PagingIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PagögIdítôy.h
"

38 
	$decode_∑gög_idítôy
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
∑gögidítôy
 = *
buf„r
 & 0x1;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_∑gög_idítôy_xml
(
∑gögidítôy
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_∑gög_idítôy
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PAGING_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_∑gög_idítôy_xml
(
∑gögidítôy
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
) = 0x00 |

68 (*
∑gögidítôy
 & 0x1);

69 
ícoded
++;

70  
ícoded
;

71 
	}
}

73 
	$dump_∑gög_idítôy_xml
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
)

75 
	`¥ötf
("<Paging Identity>\n");

76 i‡(
õi
 > 0)

78 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

79 
	`¥ötf
(" <Pagög idítôy vÆue>%u</Pagög idítôy vÆue>\n", *
∑gögidítôy
);

80 
	`¥ötf
("</Paging Identity>\n");

81 
	}
}

	@src/ies/PagingIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PAGING_IDENTITY_H_


36 
	#PAGING_IDENTITY_H_


	)

38 
	#PAGING_IDENTITY_MINIMUM_LENGTH
 2

	)

39 
	#PAGING_IDENTITY_MAXIMUM_LENGTH
 2

	)

41 
uöt8_t
 
	tPagögIdítôy
;

43 
ícode_∑gög_idítôy
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_∑gög_idítôy_xml
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
);

47 
decode_∑gög_idítôy
(
PagögIdítôy
 *
∑gögidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/PdnAddress.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PdnAddªss.h
"

38 
	$decode_pdn_addªss
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 
decode_ªsu…
;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
õÀn
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

51 
pd«ddªss
->
pd¡y≥vÆue
 = *(
buf„r
 + 
decoded
) & 0x7;

52 
decoded
++;

53 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
pd«ddªss
->
pd«ddªssöf‹m©i⁄
, 
õÀn
 - 1, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

54  
decode_ªsu…
;

56 
decoded
 +
decode_ªsu…
;

57 #i‡
	`deföed
 (
NAS_DEBUG
)

58 
	`dump_pdn_addªss_xml
(
pd«ddªss
, 
õi
);

60  
decoded
;

61 
	}
}

62 
	$ícode_pdn_addªss
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

64 
uöt8_t
 *
ÀnPå
;

65 
uöt32_t
 
ícoded
 = 0;

66 
ícode_ªsu…
;

68 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_ADDRESS_MINIMUM_LENGTH
, 
Àn
);

69 #i‡
	`deföed
 (
NAS_DEBUG
)

70 
	`dump_pdn_addªss_xml
(
pd«ddªss
, 
õi
);

72 i‡(
õi
 > 0)

74 *
buf„r
 = 
õi
;

75 
ícoded
++;

77 
ÀnPå
 = (
buf„r
 + 
ícoded
);

78 
ícoded
 ++;

79 *(
buf„r
 + 
ícoded
) = 0x00 |

80 (
pd«ddªss
->
pd¡y≥vÆue
 & 0x7);

81 
ícoded
++;

82 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
pd«ddªss
->
pd«ddªssöf‹m©i⁄
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

83  
ícode_ªsu…
;

85 
ícoded
 +
ícode_ªsu…
;

86 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

87  
ícoded
;

88 
	}
}

90 
	$dump_pdn_addªss_xml
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
)

92 
	`¥ötf
("<Pdn Address>\n");

93 i‡(
õi
 > 0)

95 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

96 
	`¥ötf
(" <PDNÅy≥ vÆue>%u</PDNÅy≥ vÆue>\n", 
pd«ddªss
->
pd¡y≥vÆue
);

97 
	`¥ötf
("%s", 
	`dump_o˘ë_°rög_xml
(&
pd«ddªss
->
pd«ddªssöf‹m©i⁄
));

98 
	`¥ötf
("</Pdn Address>\n");

99 
	}
}

	@src/ies/PdnAddress.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PDN_ADDRESS_H_


36 
	#PDN_ADDRESS_H_


	)

38 
	#PDN_ADDRESS_MINIMUM_LENGTH
 7

	)

39 
	#PDN_ADDRESS_MAXIMUM_LENGTH
 15

	)

41 
	sPdnAddªss_èg
 {

42 
	#PDN_VALUE_TYPE_IPV4
 0b001

	)

43 
	#PDN_VALUE_TYPE_IPV6
 0b010

	)

44 
	#PDN_VALUE_TYPE_IPV4V6
 0b011

	)

45 
uöt8_t
 
	mpd¡y≥vÆue
:3;

46 
O˘ëSåög
 
	mpd«ddªssöf‹m©i⁄
;

47 } 
	tPdnAddªss
;

49 
ícode_pdn_addªss
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_pdn_addªss
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
dump_pdn_addªss_xml
(
PdnAddªss
 *
pd«ddªss
, 
uöt8_t
 
õi
);

	@src/ies/PdnType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PdnTy≥.h
"

38 
	$decode_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
PDN_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
pd¡y≥
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_pdn_ty≥_xml
(
pd¡y≥
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
pd¡y≥
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_pdn_ty≥_xml
(
pd¡y≥
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PDN_TYPE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_pdn_ty≥_xml
(
pd¡y≥
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
pd¡y≥
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 #i‡
	`deföed
 (
NAS_DEBUG
)

87 
	`dump_pdn_ty≥_xml
(
pd¡y≥
, 0);

89 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

90 (*
pd¡y≥
 & 0x7);

91 
ícoded
++;

93  
buf„rRëu∫
;

94 
	}
}

96 
	$dump_pdn_ty≥_xml
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Pdn Type>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <PDNÅy≥ vÆue>%u</PDNÅy≥ vÆue>\n", *
pd¡y≥
);

103 
	`¥ötf
("</Pdn Type>\n");

104 
	}
}

	@src/ies/PdnType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PDN_TYPE_H_


36 
	#PDN_TYPE_H_


	)

38 
	#PDN_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#PDN_TYPE_MAXIMUM_LENGTH
 1

	)

41 
	#PDN_TYPE_IPV4
 0b001

	)

42 
	#PDN_TYPE_IPV6
 0b010

	)

43 
	#PDN_TYPE_IPV4V6
 0b011

	)

44 
	#PDN_TYPE_UNUSED
 0b100

	)

45 
uöt8_t
 
	tPdnTy≥
;

47 
ícode_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
dump_pdn_ty≥_xml
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
);

51 
uöt8_t
 
ícode_u8_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
);

53 
decode_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
decode_u8_pdn_ty≥
(
PdnTy≥
 *
pd¡y≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/PlmnList.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PlmnLi°.h
"

38 
	$decode_∂mn_li°
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
∂m∆i°
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

51 
∂m∆i°
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

52 
decoded
++;

53 
∂m∆i°
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

54 
∂m∆i°
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

55 
decoded
++;

56 
∂m∆i°
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

57 
∂m∆i°
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

58 
decoded
++;

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_∂mn_li°_xml
(
∂m∆i°
, 
õi
);

62  
decoded
;

63 
	}
}

64 
	$ícode_∂mn_li°
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

66 
uöt8_t
 *
ÀnPå
;

67 
uöt32_t
 
ícoded
 = 0;

69 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PLMN_LIST_MINIMUM_LENGTH
, 
Àn
);

70 #i‡
	`deföed
 (
NAS_DEBUG
)

71 
	`dump_∂mn_li°_xml
(
∂m∆i°
, 
õi
);

73 i‡(
õi
 > 0)

75 *
buf„r
 = 
õi
;

76 
ícoded
++;

78 
ÀnPå
 = (
buf„r
 + 
ícoded
);

79 
ícoded
 ++;

80 *(
buf„r
 + 
ícoded
Ë0x00 | ((
∂m∆i°
->
mccdigô2
 & 0xf) << 4) |

81 (
∂m∆i°
->
mccdigô1
 & 0xf);

82 
ícoded
++;

83 *(
buf„r
 + 
ícoded
Ë0x00 | ((
∂m∆i°
->
mncdigô3
 & 0xf) << 4) |

84 (
∂m∆i°
->
mccdigô3
 & 0xf);

85 
ícoded
++;

86 *(
buf„r
 + 
ícoded
Ë0x00 | ((
∂m∆i°
->
mncdigô2
 & 0xf) << 4) |

87 (
∂m∆i°
->
mncdigô1
 & 0xf);

88 
ícoded
++;

89 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

90  
ícoded
;

91 
	}
}

93 
	$dump_∂mn_li°_xml
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
)

95 
	`¥ötf
("<Plmn List>\n");

96 i‡(
õi
 > 0)

98 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

99 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
∂m∆i°
->
mccdigô2
);

100 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
∂m∆i°
->
mccdigô1
);

101 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
∂m∆i°
->
mncdigô3
);

102 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
∂m∆i°
->
mccdigô3
);

103 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
∂m∆i°
->
mncdigô2
);

104 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
∂m∆i°
->
mncdigô1
);

105 
	`¥ötf
("</Plmn List>\n");

106 
	}
}

	@src/ies/PlmnList.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PLMN_LIST_H_


36 
	#PLMN_LIST_H_


	)

38 
	#PLMN_LIST_MINIMUM_LENGTH
 5

	)

39 
	#PLMN_LIST_MAXIMUM_LENGTH
 47

	)

41 
	sPlmnLi°_èg
 {

42 
uöt8_t
 
	mmccdigô2
:4;

43 
uöt8_t
 
	mmccdigô1
:4;

44 
uöt8_t
 
	mmncdigô3
:4;

45 
uöt8_t
 
	mmccdigô3
:4;

46 
uöt8_t
 
	mmncdigô2
:4;

47 
uöt8_t
 
	mmncdigô1
:4;

48 } 
	tPlmnLi°
;

50 
ícode_∂mn_li°
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

52 
decode_∂mn_li°
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

54 
dump_∂mn_li°_xml
(
PlmnLi°
 *
∂m∆i°
, 
uöt8_t
 
õi
);

	@src/ies/ProcedureTransactionIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Pro˚duªTønß˘i⁄Idítôy.h
"

38 
	$decode_¥o˚duª_å™ß˘i⁄_idítôy
(
Pro˚duªTønß˘i⁄Idítôy
 *
¥o˚duªå™ß˘i⁄idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_¥o˚duª_å™ß˘i⁄_idítôy
(
Pro˚duªTønß˘i⁄Idítôy
 *
¥o˚duªå™ß˘i⁄idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/ProcedureTransactionIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PROCEDURE_TRANSACTION_IDENTITY_H_


36 
	#PROCEDURE_TRANSACTION_IDENTITY_H_


	)

38 
	#PROCEDURE_TRANSACTION_IDENTITY_MINIMUM_LENGTH
 1

	)

39 
	#PROCEDURE_TRANSACTION_IDENTITY_MAXIMUM_LENGTH
 1

	)

41 
	#PROCEDURE_TRANSACTION_IDENTITY_UNASSIGNED
 0

	)

42 
	#PROCEDURE_TRANSACTION_IDENTITY_FIRST
 1

	)

43 
	#PROCEDURE_TRANSACTION_IDENTITY_LAST
 254

	)

44 
uöt8_t
 
	tPro˚duªTønß˘i⁄Idítôy
;

46 
ícode_¥o˚duª_å™ß˘i⁄_idítôy
(
Pro˚duªTønß˘i⁄Idítôy
 *
¥o˚duªå™ß˘i⁄idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
dump_¥o˚duª_å™ß˘i⁄_idítôy_xml
(
Pro˚duªTønß˘i⁄Idítôy
 *
¥o˚duªå™ß˘i⁄idítôy
, 
uöt8_t
 
õi
);

50 
decode_¥o˚duª_å™ß˘i⁄_idítôy
(
Pro˚duªTønß˘i⁄Idítôy
 *
¥o˚duªå™ß˘i⁄idítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/ProtocolConfigurationOptions.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"TLVEncodî.h
"

34 
	~"TLVDecodî.h
"

35 
	~"PrŸocﬁC⁄figuøti⁄O±i⁄s.h
"

37 
	$decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

39 
uöt32_t
 
decoded
 = 0;

40 
uöt8_t
 
õÀn
 = 0;

41 
decode_ªsu…
;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 i‡(((*(
buf„r
 + 
decoded
) >> 7) & 0x1) != 1)

52 
îr‹CodeDecodî
 = 
TLV_DECODE_VALUE_DOESNT_MATCH
;

53  
TLV_DECODE_VALUE_DOESNT_MATCH
;

56 i‡(((*(
buf„r
 + 
decoded
) & 0x78) >> 3) != 0)

58 
îr‹CodeDecodî
 = 
TLV_DECODE_VALUE_DOESNT_MATCH
;

59  
TLV_DECODE_VALUE_DOESNT_MATCH
;

61 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
c⁄figuøti⁄¥Ÿﬁ
 = (*(
buf„r
 + 
decoded
) >> 1) & 0x7;

62 
decoded
++;

64 (
Àn
 - 
decoded
) > 0) {

65 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁid
);

66 
	`DECODE_U8
(
buf„r
 + 
decoded
, 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
ÀngthoÂrŸocﬁid
, decoded);

67 i‡((
decode_ªsu…
 = 
	`decode_o˘ë_°rög
(&
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁidc⁄ã¡s
,

68 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
ÀngthoÂrŸocﬁid
, 
buf„r
 + 
decoded
, 
Àn
 - decoded)) < 0)

70  
decode_ªsu…
;

72 
decoded
 +
decode_ªsu…
;

75 #i‡
	`deföed
 (
NAS_DEBUG
)

76 
	`dump_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s_xml
(
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
õi
);

78  
decoded
;

79 
	}
}

80 
	$ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

82 
uöt8_t
 *
ÀnPå
;

83 
uöt32_t
 
ícoded
 = 0;

84 
ícode_ªsu…
;

86 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
PROTOCOL_CONFIGURATION_OPTIONS_MINIMUM_LENGTH
, 
Àn
);

87 #i‡
	`deföed
 (
NAS_DEBUG
)

88 
	`dump_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s_xml
(
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
õi
);

90 i‡(
õi
 > 0)

92 *
buf„r
 = 
õi
;

93 
ícoded
++;

95 
ÀnPå
 = (
buf„r
 + 
ícoded
);

96 
ícoded
 ++;

97 *(
buf„r
 + 
ícoded
) = 0x00 | (1 << 7) |

98 (
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
c⁄figuøti⁄¥Ÿﬁ
 & 0x7);

99 
ícoded
++;

100 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁid
);

101 *(
buf„r
 + 
ícoded
Ë
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
ÀngthoÂrŸocﬁid
;

102 
ícoded
++;

103 i‡((
ícode_ªsu…
 = 
	`ícode_o˘ë_°rög
(&
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁidc⁄ã¡s
, 
buf„r
 + 
ícoded
, 
Àn
 -Éncoded)) < 0)

104  
ícode_ªsu…
;

106 
ícoded
 +
ícode_ªsu…
;

107 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

108  
ícoded
;

109 
	}
}

111 
	$dump_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s_xml
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
)

113 
	`¥ötf
("<Protocol Configuration Options>\n");

114 i‡(
õi
 > 0)

116 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

117 
	`¥ötf
(" <C⁄figuøti⁄ÖrŸﬁ>%u</C⁄figuøti⁄ÖrŸﬁ>\n", 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
c⁄figuøti⁄¥Ÿﬁ
);

118 
	`¥ötf
(" <PrŸocﬁ ID>%u</PrŸocﬁ ID>\n", 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁid
);

119 
	`¥ötf
(" <Lígth o‡¥Ÿocﬁ ID>%u</Lígth o‡¥Ÿocﬁ ID>\n", 
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
ÀngthoÂrŸocﬁid
);

120 
	`¥ötf
("%s",
	`dump_o˘ë_°rög_xml
(&
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
->
¥Ÿocﬁidc⁄ã¡s
));

121 
	`¥ötf
("</Protocol Configuration Options>\n");

122 
	}
}

	@src/ies/ProtocolConfigurationOptions.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PROTOCOL_CONFIGURATION_OPTIONS_H_


36 
	#PROTOCOL_CONFIGURATION_OPTIONS_H_


	)

38 
	#PROTOCOL_CONFIGURATION_OPTIONS_MINIMUM_LENGTH
 3

	)

39 
	#PROTOCOL_CONFIGURATION_OPTIONS_MAXIMUM_LENGTH
 253

	)

44 
	ePrŸocﬁC⁄figuøti⁄O±i⁄sLi°_ids_èg
{

45 
	mPCO_UNKNOWN
 = 0,

46 
	mPCO_P_CSCF_IPV6_ADDRESS_REQ
 = 1,

47 
	mPCO_IM_CN_SUBSYSTEM_SIGNALING_FLAG
 = 2,

48 
	mPCO_DNS_SERVER_IPV6_ADDRESS_REQ
 = 3,

49 
	mPCO_NOT_SUPPORTED
 = 4,

50 
	mPCO_MS_SUPPORTED_OF_NETWORK_REQUESTED_BEARER_CONTROL_INDICATOR
 = 5,

51 
	mPCO_RESERVED
 = 6,

53 } 
	tPrŸocﬁC⁄figuøti⁄O±i⁄sLi°_ids
;

60 
	sPrŸocﬁC⁄figuøti⁄O±i⁄s_èg
 {

61 
uöt8_t
 
	mc⁄figuøti⁄¥Ÿﬁ
:3;

62 
uöt16_t
 
	m¥Ÿocﬁid
;

63 
uöt8_t
 
	mÀngthoÂrŸocﬁid
;

64 
O˘ëSåög
 
	m¥Ÿocﬁidc⁄ã¡s
;

65 } 
	tPrŸocﬁC⁄figuøti⁄O±i⁄s
;

67 
ícode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

69 
decode_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

71 
dump_¥Ÿocﬁ_c⁄figuøti⁄_›ti⁄s_xml
(
PrŸocﬁC⁄figuøti⁄O±i⁄s
 *
¥Ÿocﬁc⁄figuøti⁄›ti⁄s
, 
uöt8_t
 
õi
);

	@src/ies/ProtocolDiscriminator.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"PrŸocﬁDis¸imö©‹.h
"

38 
	$decode_¥Ÿocﬁ_dis¸imö©‹
(
PrŸocﬁDis¸imö©‹
 *
¥Ÿocﬁdis¸imö©‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_¥Ÿocﬁ_dis¸imö©‹
(
PrŸocﬁDis¸imö©‹
 *
¥Ÿocﬁdis¸imö©‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/ProtocolDiscriminator.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
PROTOCOL_DISCRIMINATOR_H_


36 
	#PROTOCOL_DISCRIMINATOR_H_


	)

38 
	#PROTOCOL_DISCRIMINATOR_MINIMUM_LENGTH
 1

	)

39 
	#PROTOCOL_DISCRIMINATOR_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tPrŸocﬁDis¸imö©‹
;

43 
ícode_¥Ÿocﬁ_dis¸imö©‹
(
PrŸocﬁDis¸imö©‹
 *
¥Ÿocﬁdis¸imö©‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_¥Ÿocﬁ_dis¸imö©‹_xml
(
PrŸocﬁDis¸imö©‹
 *
¥Ÿocﬁdis¸imö©‹
, 
uöt8_t
 
õi
);

47 
decode_¥Ÿocﬁ_dis¸imö©‹
(
PrŸocﬁDis¸imö©‹
 *
¥Ÿocﬁdis¸imö©‹
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/QualityOfService.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"QuÆôyOfSîvi˚.h
"

38 
	$decode_quÆôy_of_£rvi˚
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
quÆôyof£rvi˚
->
dñay˛ass
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x7;

51 
quÆôyof£rvi˚
->
ªlübûôy˛ass
 = *(
buf„r
 + 
decoded
) & 0x7;

52 
decoded
++;

53 
quÆôyof£rvi˚
->
≥akthroughput
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

54 
quÆôyof£rvi˚
->
¥e˚dí˚˛ass
 = *(
buf„r
 + 
decoded
) & 0x7;

55 
decoded
++;

56 
quÆôyof£rvi˚
->
mó¡hroughput
 = *(
buf„r
 + 
decoded
) & 0x1f;

57 
decoded
++;

58 
quÆôyof£rvi˚
->
åaffic˛ass
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

59 
quÆôyof£rvi˚
->
dñivîy‹dî
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x3;

60 
quÆôyof£rvi˚
->
dñivîyo„º⁄eoussdu
 = *(
buf„r
 + 
decoded
) & 0x7;

61 
decoded
++;

62 
quÆôyof£rvi˚
->
maximumsdusize
 = *(
buf„r
 + 
decoded
);

63 
decoded
++;

64 
quÆôyof£rvi˚
->
maximumbôøãu∂ök
 = *(
buf„r
 + 
decoded
);

65 
decoded
++;

66 
quÆôyof£rvi˚
->
maximumbôøãdow∆ök
 = *(
buf„r
 + 
decoded
);

67 
decoded
++;

68 
quÆôyof£rvi˚
->
ªsiduÆbî
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

69 
quÆôyof£rvi˚
->
sduøti€º‹
 = *(
buf„r
 + 
decoded
) & 0xf;

70 
decoded
++;

71 
quÆôyof£rvi˚
->
å™s„rdñay
 = (*(
buf„r
 + 
decoded
) >> 2) & 0x3f;

72 
quÆôyof£rvi˚
->
åaffich™dlög¥i‹ôy
 = *(
buf„r
 + 
decoded
) & 0x3;

73 
decoded
++;

74 
quÆôyof£rvi˚
->
gu¨™ãedbôøãu∂ök
 = *(
buf„r
 + 
decoded
);

75 
decoded
++;

76 
quÆôyof£rvi˚
->
gu¨™ãedbôøãdow∆ök
 = *(
buf„r
 + 
decoded
);

77 
decoded
++;

78 
quÆôyof£rvi˚
->
sig«lögödiˇti⁄
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

79 
quÆôyof£rvi˚
->
sour˚°©i°icsdes¸ùt‹
 = *(
buf„r
 + 
decoded
) & 0xf;

80 
decoded
++;

81 #i‡
	`deföed
 (
NAS_DEBUG
)

82 
	`dump_quÆôy_of_£rvi˚_xml
(
quÆôyof£rvi˚
, 
õi
);

84  
decoded
;

85 
	}
}

86 
	$ícode_quÆôy_of_£rvi˚
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

88 
uöt8_t
 *
ÀnPå
;

89 
uöt32_t
 
ícoded
 = 0;

91 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
QUALITY_OF_SERVICE_MINIMUM_LENGTH
, 
Àn
);

92 #i‡
	`deföed
 (
NAS_DEBUG
)

93 
	`dump_quÆôy_of_£rvi˚_xml
(
quÆôyof£rvi˚
, 
õi
);

95 i‡(
õi
 > 0)

97 *
buf„r
 = 
õi
;

98 
ícoded
++;

100 
ÀnPå
 = (
buf„r
 + 
ícoded
);

101 
ícoded
 ++;

102 *(
buf„r
 + 
ícoded
) = 0x00 |

103 ((
quÆôyof£rvi˚
->
dñay˛ass
 & 0x7) << 3) |

104 (
quÆôyof£rvi˚
->
ªlübûôy˛ass
 & 0x7);

105 
ícoded
++;

106 *(
buf„r
 + 
ícoded
Ë0x00 | ((
quÆôyof£rvi˚
->
≥akthroughput
 & 0xf) << 4) |

107 (
quÆôyof£rvi˚
->
¥e˚dí˚˛ass
 & 0x7);

108 
ícoded
++;

109 *(
buf„r
 + 
ícoded
) = 0x00 |

110 (
quÆôyof£rvi˚
->
mó¡hroughput
 & 0x1f);

111 
ícoded
++;

112 *(
buf„r
 + 
ícoded
Ë0x00 | ((
quÆôyof£rvi˚
->
åaffic˛ass
 & 0x7) << 5) |

113 ((
quÆôyof£rvi˚
->
dñivîy‹dî
 & 0x3) << 3) |

114 (
quÆôyof£rvi˚
->
dñivîyo„º⁄eoussdu
 & 0x7);

115 
ícoded
++;

116 *(
buf„r
 + 
ícoded
Ë
quÆôyof£rvi˚
->
maximumsdusize
;

117 
ícoded
++;

118 *(
buf„r
 + 
ícoded
Ë
quÆôyof£rvi˚
->
maximumbôøãu∂ök
;

119 
ícoded
++;

120 *(
buf„r
 + 
ícoded
Ë
quÆôyof£rvi˚
->
maximumbôøãdow∆ök
;

121 
ícoded
++;

122 *(
buf„r
 + 
ícoded
Ë0x00 | ((
quÆôyof£rvi˚
->
ªsiduÆbî
 & 0xf) << 4) |

123 (
quÆôyof£rvi˚
->
sduøti€º‹
 & 0xf);

124 
ícoded
++;

125 *(
buf„r
 + 
ícoded
Ë0x00 | ((
quÆôyof£rvi˚
->
å™s„rdñay
 & 0x3f) << 2) |

126 (
quÆôyof£rvi˚
->
åaffich™dlög¥i‹ôy
 & 0x3);

127 
ícoded
++;

128 *(
buf„r
 + 
ícoded
Ë
quÆôyof£rvi˚
->
gu¨™ãedbôøãu∂ök
;

129 
ícoded
++;

130 *(
buf„r
 + 
ícoded
Ë
quÆôyof£rvi˚
->
gu¨™ãedbôøãdow∆ök
;

131 
ícoded
++;

132 *(
buf„r
 + 
ícoded
) = 0x00 |

133 ((
quÆôyof£rvi˚
->
sig«lögödiˇti⁄
 & 0x1) << 4) |

134 (
quÆôyof£rvi˚
->
sour˚°©i°icsdes¸ùt‹
 & 0xf);

135 
ícoded
++;

136 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

137  
ícoded
;

138 
	}
}

140 
	$dump_quÆôy_of_£rvi˚_xml
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
)

142 
	`¥ötf
("<Quality Of Service>\n");

143 i‡(
õi
 > 0)

145 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

146 
	`¥ötf
(" <Dñay cœss>%u</Dñay cœss>\n", 
quÆôyof£rvi˚
->
dñay˛ass
);

147 
	`¥ötf
(" <Rñübûôy cœss>%u</Rñübûôy cœss>\n", 
quÆôyof£rvi˚
->
ªlübûôy˛ass
);

148 
	`¥ötf
(" <PókÅhroughput>%u</PókÅhroughput>\n", 
quÆôyof£rvi˚
->
≥akthroughput
);

149 
	`¥ötf
(" <Pª˚dí˚ cœss>%u</Pª˚dí˚ cœss>\n", 
quÆôyof£rvi˚
->
¥e˚dí˚˛ass
);

150 
	`¥ötf
(" <Mó¿throughput>%u</Mó¿throughput>\n", 
quÆôyof£rvi˚
->
mó¡hroughput
);

151 
	`¥ötf
(" <Tøffi¯˛ass>%u</Tøffi¯˛ass>\n", 
quÆôyof£rvi˚
->
åaffic˛ass
);

152 
	`¥ötf
(" <Dñivîy ordî>%u</Dñivîy ordî>\n", 
quÆôyof£rvi˚
->
dñivîy‹dî
);

153 
	`¥ötf
(" <Dñivîy o‡îr⁄eou†SDU>%u</Dñivîy o‡îr⁄eou†SDU>\n", 
quÆôyof£rvi˚
->
dñivîyo„º⁄eoussdu
);

154 
	`¥ötf
(" <Maximum SDU size>%u</Maximum SDU size>\n", 
quÆôyof£rvi˚
->
maximumsdusize
);

155 
	`¥ötf
(" <Maximum bôÑ©êu∂ök>%u</Maximum bôÑ©êu∂ök>\n", 
quÆôyof£rvi˚
->
maximumbôøãu∂ök
);

156 
	`¥ötf
(" <Maximum bôÑ©êdow∆ök>%u</Maximum bôÑ©êdow∆ök>\n", 
quÆôyof£rvi˚
->
maximumbôøãdow∆ök
);

157 
	`¥ötf
(" <ResiduÆ BER>%u</ResiduÆ BER>\n", 
quÆôyof£rvi˚
->
ªsiduÆbî
);

158 
	`¥ötf
(" <SDUÑ©iÿîr‹>%u</SDUÑ©iÿîr‹>\n", 
quÆôyof£rvi˚
->
sduøti€º‹
);

159 
	`¥ötf
(" <Tøns„∏dñay>%u</Tøns„∏dñay>\n", 
quÆôyof£rvi˚
->
å™s„rdñay
);

160 
	`¥ötf
(" <Tøffi¯h™dlögÖri‹ôy>%u</Tøffi¯h™dlögÖri‹ôy>\n", 
quÆôyof£rvi˚
->
åaffich™dlög¥i‹ôy
);

161 
	`¥ötf
(" <Gu¨™ãed bôÑ©êu∂ök>%u</Gu¨™ãed bôÑ©êu∂ök>\n", 
quÆôyof£rvi˚
->
gu¨™ãedbôøãu∂ök
);

162 
	`¥ötf
(" <Gu¨™ãed bôÑ©êdow∆ök>%u</Gu¨™ãed bôÑ©êdow∆ök>\n", 
quÆôyof£rvi˚
->
gu¨™ãedbôøãdow∆ök
);

163 
	`¥ötf
(" <Sig«lög indiˇti⁄>%u</Sig«lög indiˇti⁄>\n", 
quÆôyof£rvi˚
->
sig«lögödiˇti⁄
);

164 
	`¥ötf
(" <Sour˚ sèti°ic†des¸ùt‹>%u</Sour˚ sèti°ic†des¸ùt‹>\n", 
quÆôyof£rvi˚
->
sour˚°©i°icsdes¸ùt‹
);

165 
	`¥ötf
("</Quality Of Service>\n");

166 
	}
}

	@src/ies/QualityOfService.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
QUALITY_OF_SERVICE_H_


36 
	#QUALITY_OF_SERVICE_H_


	)

38 
	#QUALITY_OF_SERVICE_MINIMUM_LENGTH
 14

	)

39 
	#QUALITY_OF_SERVICE_MAXIMUM_LENGTH
 14

	)

41 
	sQuÆôyOfSîvi˚_èg
 {

42 
uöt8_t
 
	mdñay˛ass
:3;

43 
uöt8_t
 
	mªlübûôy˛ass
:3;

44 
uöt8_t
 
	m≥akthroughput
:4;

45 
uöt8_t
 
	m¥e˚dí˚˛ass
:3;

46 
uöt8_t
 
	mmó¡hroughput
:5;

47 
uöt8_t
 
	måaffic˛ass
:3;

48 
uöt8_t
 
	mdñivîy‹dî
:2;

49 
uöt8_t
 
	mdñivîyo„º⁄eoussdu
:3;

50 
uöt8_t
 
	mmaximumsdusize
;

51 
uöt8_t
 
	mmaximumbôøãu∂ök
;

52 
uöt8_t
 
	mmaximumbôøãdow∆ök
;

53 
uöt8_t
 
	mªsiduÆbî
:4;

54 
uöt8_t
 
	msduøti€º‹
:4;

55 
uöt8_t
 
	må™s„rdñay
:6;

56 
uöt8_t
 
	måaffich™dlög¥i‹ôy
:2;

57 
uöt8_t
 
	mgu¨™ãedbôøãu∂ök
;

58 
uöt8_t
 
	mgu¨™ãedbôøãdow∆ök
;

59 
uöt8_t
 
	msig«lögödiˇti⁄
:1;

60 
uöt8_t
 
	msour˚°©i°icsdes¸ùt‹
:4;

61 } 
	tQuÆôyOfSîvi˚
;

63 
ícode_quÆôy_of_£rvi˚
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

65 
decode_quÆôy_of_£rvi˚
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

67 
dump_quÆôy_of_£rvi˚_xml
(
QuÆôyOfSîvi˚
 *
quÆôyof£rvi˚
, 
uöt8_t
 
õi
);

	@src/ies/RadioPriority.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"RadioPri‹ôy.h
"

38 
	$decode_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
RADIO_PRIORITY_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
ødi›ri‹ôy
 = *
buf„r
 & 0x7;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ødio_¥i‹ôy_xml
(
ødi›ri‹ôy
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
ødi›ri‹ôy
 = *
buf„r
 & 0x7;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ødio_¥i‹ôy_xml
(
ødi›ri‹ôy
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
RADIO_PRIORITY_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ødio_¥i‹ôy_xml
(
ødi›ri‹ôy
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
ødi›ri‹ôy
 & 0x7);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_ødio_¥i‹ôy_xml
(
ødi›ri‹ôy
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
ødi›ri‹ôy
 & 0x7);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_ødio_¥i‹ôy_xml
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Radio Priority>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <Radiÿ¥i‹ôyÜevñ vÆue>%u</Radiÿ¥i‹ôyÜevñ vÆue>\n", *
ødi›ri‹ôy
);

101 
	`¥ötf
("</Radio Priority>\n");

102 
	}
}

	@src/ies/RadioPriority.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
RADIO_PRIORITY_H_


36 
	#RADIO_PRIORITY_H_


	)

38 
	#RADIO_PRIORITY_MINIMUM_LENGTH
 1

	)

39 
	#RADIO_PRIORITY_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tRadioPri‹ôy
;

43 
ícode_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_ødio_¥i‹ôy_xml
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
);

49 
decode_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_ødio_¥i‹ôy
(
RadioPri‹ôy
 *
ødi›ri‹ôy
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/SecurityHeaderType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"SecurôyHódîTy≥.h
"

38 
	$decode_£curôy_hódî_ty≥
(
SecurôyHódîTy≥
 *
£curôyhódîty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_£curôy_hódî_ty≥
(
SecurôyHódîTy≥
 *
£curôyhódîty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/SecurityHeaderType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
SECURITY_HEADER_TYPE_H_


36 
	#SECURITY_HEADER_TYPE_H_


	)

38 
	#SECURITY_HEADER_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#SECURITY_HEADER_TYPE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tSecurôyHódîTy≥
;

43 
ícode_£curôy_hódî_ty≥
(
SecurôyHódîTy≥
 *
£curôyhódîty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_£curôy_hódî_ty≥_xml
(
SecurôyHódîTy≥
 *
£curôyhódîty≥
, 
uöt8_t
 
õi
);

47 
decode_£curôy_hódî_ty≥
(
SecurôyHódîTy≥
 *
£curôyhódîty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/ServiceType.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Sîvi˚Ty≥.h
"

38 
	$decode_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
SERVICE_TYPE_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
£rvi˚ty≥
 = *
buf„r
 & 0xf;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_£rvi˚_ty≥_xml
(
£rvi˚ty≥
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
£rvi˚ty≥
 = *
buf„r
 & 0xf;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_£rvi˚_ty≥_xml
(
£rvi˚ty≥
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SERVICE_TYPE_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_£rvi˚_ty≥_xml
(
£rvi˚ty≥
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
£rvi˚ty≥
 & 0xf);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_£rvi˚_ty≥_xml
(
£rvi˚ty≥
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
£rvi˚ty≥
 & 0xf);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_£rvi˚_ty≥_xml
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Service Type>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <Sîvi˚Åy≥ vÆue>%u</Sîvi˚Åy≥ vÆue>\n", *
£rvi˚ty≥
);

101 
	`¥ötf
("</Service Type>\n");

102 
	}
}

	@src/ies/ServiceType.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
SERVICE_TYPE_H_


36 
	#SERVICE_TYPE_H_


	)

38 
	#SERVICE_TYPE_MINIMUM_LENGTH
 1

	)

39 
	#SERVICE_TYPE_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tSîvi˚Ty≥
;

43 
ícode_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_£rvi˚_ty≥_xml
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
);

49 
decode_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_£rvi˚_ty≥
(
Sîvi˚Ty≥
 *
£rvi˚ty≥
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/ShortMac.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Sh‹tMac.h
"

38 
	$decode_sh‹t_mac
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

47 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, *
sh‹tmac
);

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_sh‹t_mac_xml
(
sh‹tmac
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_sh‹t_mac
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SHORT_MAC_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_sh‹t_mac_xml
(
sh‹tmac
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, *
sh‹tmac
);

68  
ícoded
;

69 
	}
}

71 
	$dump_sh‹t_mac_xml
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
)

73 
	`¥ötf
("<Short Mac>\n");

74 i‡(
õi
 > 0)

76 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

77 
	`¥ötf
(" <Sh‹àMAC vÆue>%u</Sh‹àMAC vÆue>\n", *
sh‹tmac
);

78 
	`¥ötf
("</Short Mac>\n");

79 
	}
}

	@src/ies/ShortMac.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
SHORT_MAC_H_


36 
	#SHORT_MAC_H_


	)

38 
	#SHORT_MAC_MINIMUM_LENGTH
 3

	)

39 
	#SHORT_MAC_MAXIMUM_LENGTH
 3

	)

41 
uöt16_t
 
	tSh‹tMac
;

43 
ícode_sh‹t_mac
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_sh‹t_mac_xml
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
);

47 
decode_sh‹t_mac
(
Sh‹tMac
 *
sh‹tmac
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/SsCode.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"SsCode.h
"

38 
	$decode_ss_code
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
sscode
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ss_code_xml
(
sscode
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_ss_code
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SS_CODE_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_ss_code_xml
(
sscode
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
Ë*
sscode
;

68 
ícoded
++;

69  
ícoded
;

70 
	}
}

72 
	$dump_ss_code_xml
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
)

74 
	`¥ötf
("<Ss Code>\n");

75 i‡(
õi
 > 0)

77 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

78 
	`¥ötf
(" <SS codêvÆue>%u</SS codêvÆue>\n", *
sscode
);

79 
	`¥ötf
("</Ss Code>\n");

80 
	}
}

	@src/ies/SsCode.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
SS_CODE_H_


36 
	#SS_CODE_H_


	)

38 
	#SS_CODE_MINIMUM_LENGTH
 2

	)

39 
	#SS_CODE_MAXIMUM_LENGTH
 2

	)

41 
uöt8_t
 
	tSsCode
;

43 
ícode_ss_code
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_ss_code_xml
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
);

47 
decode_ss_code
(
SsCode
 *
sscode
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/SupportedCodecList.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Suµ‹ãdCodecLi°.h
"

38 
	$decode_suµ‹ãd_codec_li°
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
uöt8_t
 
õÀn
 = 0;

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

45 
decoded
++;

47 
õÀn
 = *(
buf„r
 + 
decoded
);

48 
decoded
++;

49 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

50 
suµ‹ãdcode˛i°
->
sy°emidítifiˇti⁄
 = *(
buf„r
 + 
decoded
);

51 
decoded
++;

52 
suµ‹ãdcode˛i°
->
Àngthofbôm≠
 = *(
buf„r
 + 
decoded
);

53 
decoded
++;

55 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
suµ‹ãdcode˛i°
->
codecbôm≠
);

56 #i‡
	`deföed
 (
NAS_DEBUG
)

57 
	`dump_suµ‹ãd_codec_li°_xml
(
suµ‹ãdcode˛i°
, 
õi
);

59  
decoded
;

60 
	}
}

61 
	$ícode_suµ‹ãd_codec_li°
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

63 
uöt8_t
 *
ÀnPå
;

64 
uöt32_t
 
ícoded
 = 0;

66 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
SUPPORTED_CODEC_LIST_MINIMUM_LENGTH
, 
Àn
);

67 #i‡
	`deföed
 (
NAS_DEBUG
)

68 
	`dump_suµ‹ãd_codec_li°_xml
(
suµ‹ãdcode˛i°
, 
õi
);

70 i‡(
õi
 > 0)

72 *
buf„r
 = 
õi
;

73 
ícoded
++;

75 
ÀnPå
 = (
buf„r
 + 
ícoded
);

76 
ícoded
 ++;

77 *(
buf„r
 + 
ícoded
Ë
suµ‹ãdcode˛i°
->
sy°emidítifiˇti⁄
;

78 
ícoded
++;

79 *(
buf„r
 + 
ícoded
Ë
suµ‹ãdcode˛i°
->
Àngthofbôm≠
;

80 
ícoded
++;

81 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
suµ‹ãdcode˛i°
->
codecbôm≠
);

82 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

83  
ícoded
;

84 
	}
}

86 
	$dump_suµ‹ãd_codec_li°_xml
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
)

88 
	`¥ötf
("<Supported Codec List>\n");

89 i‡(
õi
 > 0)

91 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

92 
	`¥ötf
(" <Sy°em idítifiˇti⁄>%u</Sy°em idítifiˇti⁄>\n", 
suµ‹ãdcode˛i°
->
sy°emidítifiˇti⁄
);

93 
	`¥ötf
(" <Lígth o‡bôm≠>%u</Lígth o‡bôm≠>\n", 
suµ‹ãdcode˛i°
->
Àngthofbôm≠
);

94 
	`¥ötf
(" <Code¯bôm≠>%u</Code¯bôm≠>\n", 
suµ‹ãdcode˛i°
->
codecbôm≠
);

95 
	`¥ötf
("</Supported Codec List>\n");

96 
	}
}

	@src/ies/SupportedCodecList.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
SUPPORTED_CODEC_LIST_H_


36 
	#SUPPORTED_CODEC_LIST_H_


	)

38 
	#SUPPORTED_CODEC_LIST_MINIMUM_LENGTH
 5

	)

39 
	#SUPPORTED_CODEC_LIST_MAXIMUM_LENGTH
 5

	)

41 
	sSuµ‹ãdCodecLi°_èg
 {

42 
uöt8_t
 
	msy°emidítifiˇti⁄
;

43 
uöt8_t
 
	mÀngthofbôm≠
;

44 
uöt16_t
 
	mcodecbôm≠
;

45 } 
	tSuµ‹ãdCodecLi°
;

47 
ícode_suµ‹ãd_codec_li°
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
decode_suµ‹ãd_codec_li°
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
dump_suµ‹ãd_codec_li°_xml
(
Suµ‹ãdCodecLi°
 *
suµ‹ãdcode˛i°
, 
uöt8_t
 
õi
);

	@src/ies/TimeZone.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TimeZ⁄e.h
"

38 
	$decode_time_z⁄e
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 *
timez⁄e
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_time_z⁄e_xml
(
timez⁄e
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$ícode_time_z⁄e
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

56 
uöt32_t
 
ícoded
 = 0;

58 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TIME_ZONE_MINIMUM_LENGTH
, 
Àn
);

59 #i‡
	`deföed
 (
NAS_DEBUG
)

60 
	`dump_time_z⁄e_xml
(
timez⁄e
, 
õi
);

62 i‡(
õi
 > 0)

64 *
buf„r
 = 
õi
;

65 
ícoded
++;

67 *(
buf„r
 + 
ícoded
Ë*
timez⁄e
;

68 
ícoded
++;

69  
ícoded
;

70 
	}
}

72 
	$dump_time_z⁄e_xml
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
)

74 
	`¥ötf
("<Time Zone>\n");

75 i‡(
õi
 > 0)

77 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

78 
	`¥ötf
(" <Timêz⁄e>%u</Timêz⁄e>\n", *
timez⁄e
);

79 
	`¥ötf
("</Time Zone>\n");

80 
	}
}

	@src/ies/TimeZone.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TIME_ZONE_H_


36 
	#TIME_ZONE_H_


	)

38 
	#TIME_ZONE_MINIMUM_LENGTH
 2

	)

39 
	#TIME_ZONE_MAXIMUM_LENGTH
 2

	)

41 
uöt8_t
 
	tTimeZ⁄e
;

43 
ícode_time_z⁄e
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_time_z⁄e_xml
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
);

47 
decode_time_z⁄e
(
TimeZ⁄e
 *
timez⁄e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/TimeZoneAndTime.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TimeZ⁄eAndTime.h
"

38 
	$decode_time_z⁄e_™d_time
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
timez⁄óndtime
->
yór
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 
timez⁄óndtime
->
m⁄th
 = *(
buf„r
 + 
decoded
);

49 
decoded
++;

50 
timez⁄óndtime
->
day
 = *(
buf„r
 + 
decoded
);

51 
decoded
++;

52 
timez⁄óndtime
->
hour
 = *(
buf„r
 + 
decoded
);

53 
decoded
++;

54 
timez⁄óndtime
->
möuã
 = *(
buf„r
 + 
decoded
);

55 
decoded
++;

56 
timez⁄óndtime
->
£c⁄d
 = *(
buf„r
 + 
decoded
);

57 
decoded
++;

58 
timez⁄óndtime
->
timez⁄e
 = *(
buf„r
 + 
decoded
);

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_time_z⁄e_™d_time_xml
(
timez⁄óndtime
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_time_z⁄e_™d_time
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt32_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TIME_ZONE_AND_TIME_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_time_z⁄e_™d_time_xml
(
timez⁄óndtime
, 
õi
);

74 i‡(
õi
 > 0)

76 *
buf„r
 = 
õi
;

77 
ícoded
++;

79 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
yór
;

80 
ícoded
++;

81 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
m⁄th
;

82 
ícoded
++;

83 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
day
;

84 
ícoded
++;

85 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
hour
;

86 
ícoded
++;

87 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
möuã
;

88 
ícoded
++;

89 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
£c⁄d
;

90 
ícoded
++;

91 *(
buf„r
 + 
ícoded
Ë
timez⁄óndtime
->
timez⁄e
;

92 
ícoded
++;

93  
ícoded
;

94 
	}
}

96 
	$dump_time_z⁄e_™d_time_xml
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
)

98 
	`¥ötf
("<Time Zone And Time>\n");

99 i‡(
õi
 > 0)

101 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

102 
	`¥ötf
(" <Yór>%u</Yór>\n", 
timez⁄óndtime
->
yór
);

103 
	`¥ötf
(" <M⁄th>%u</M⁄th>\n", 
timez⁄óndtime
->
m⁄th
);

104 
	`¥ötf
(" <Day>%u</Day>\n", 
timez⁄óndtime
->
day
);

105 
	`¥ötf
(" <Hour>%u</Hour>\n", 
timez⁄óndtime
->
hour
);

106 
	`¥ötf
(" <Möuã>%u</Möuã>\n", 
timez⁄óndtime
->
möuã
);

107 
	`¥ötf
(" <Sec⁄d>%u</Sec⁄d>\n", 
timez⁄óndtime
->
£c⁄d
);

108 
	`¥ötf
(" <TimêZ⁄e>%u</TimêZ⁄e>\n", 
timez⁄óndtime
->
timez⁄e
);

109 
	`¥ötf
("</Time Zone And Time>\n");

110 
	}
}

	@src/ies/TimeZoneAndTime.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TIME_ZONE_AND_TIME_H_


36 
	#TIME_ZONE_AND_TIME_H_


	)

38 
	#TIME_ZONE_AND_TIME_MINIMUM_LENGTH
 8

	)

39 
	#TIME_ZONE_AND_TIME_MAXIMUM_LENGTH
 8

	)

41 
	sTimeZ⁄eAndTime_èg
 {

42 
uöt8_t
 
	myór
;

43 
uöt8_t
 
	mm⁄th
;

44 
uöt8_t
 
	mday
;

45 
uöt8_t
 
	mhour
;

46 
uöt8_t
 
	mmöuã
;

47 
uöt8_t
 
	m£c⁄d
;

48 
uöt8_t
 
	mtimez⁄e
;

49 } 
	tTimeZ⁄eAndTime
;

51 
ícode_time_z⁄e_™d_time
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
dump_time_z⁄e_™d_time_xml
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
);

55 
decode_time_z⁄e_™d_time
(
TimeZ⁄eAndTime
 *
timez⁄óndtime
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/TmsiStatus.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TmsiSètus.h
"

38 
	$decode_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
TMSI_STATUS_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
tmsi°©us
 = *
buf„r
 & 0x1;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_tmsi_°©us_xml
(
tmsi°©us
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
tmsi°©us
 = *
buf„r
 & 0x1;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_tmsi_°©us_xml
(
tmsi°©us
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TMSI_STATUS_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_tmsi_°©us_xml
(
tmsi°©us
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
tmsi°©us
 & 0x1);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_tmsi_°©us_xml
(
tmsi°©us
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
tmsi°©us
 & 0x1);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_tmsi_°©us_xml
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Tmsi Status>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <TMSI fœg>%u</TMSI fœg>\n", *
tmsi°©us
);

101 
	`¥ötf
("</Tmsi Status>\n");

102 
	}
}

	@src/ies/TmsiStatus.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TMSI_STATUS_H_


36 
	#TMSI_STATUS_H_


	)

38 
	#TMSI_STATUS_MINIMUM_LENGTH
 1

	)

39 
	#TMSI_STATUS_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tTmsiSètus
;

43 
ícode_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_tmsi_°©us_xml
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
);

49 
decode_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_tmsi_°©us
(
TmsiSètus
 *
tmsi°©us
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/TrackingAreaIdentity.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TøckögAªaIdítôy.h
"

38 
	$decode_åackög_¨ó_idítôy
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
åackög¨óidítôy
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

47 
åackög¨óidítôy
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

48 
decoded
++;

49 
åackög¨óidítôy
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

50 
åackög¨óidítôy
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

51 
decoded
++;

52 
åackög¨óidítôy
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

53 
åackög¨óidítôy
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

54 
decoded
++;

56 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
åackög¨óidítôy
->
èc
);

57 #i‡
	`deföed
 (
NAS_DEBUG
)

58 
	`dump_åackög_¨ó_idítôy_xml
(
åackög¨óidítôy
, 
õi
);

60  
decoded
;

61 
	}
}

63 
	$ícode_åackög_¨ó_idítôy
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

65 
uöt32_t
 
ícoded
 = 0;

67 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_IDENTITY_MINIMUM_LENGTH
, 
Àn
);

68 #i‡
	`deföed
 (
NAS_DEBUG
)

69 
	`dump_åackög_¨ó_idítôy_xml
(
åackög¨óidítôy
, 
õi
);

71 i‡(
õi
 > 0)

73 *
buf„r
 = 
õi
;

74 
ícoded
++;

76 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôy
->
mccdigô2
 & 0xf) << 4) |

77 (
åackög¨óidítôy
->
mccdigô1
 & 0xf);

78 
ícoded
++;

79 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôy
->
mncdigô3
 & 0xf) << 4) |

80 (
åackög¨óidítôy
->
mccdigô3
 & 0xf);

81 
ícoded
++;

82 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôy
->
mncdigô2
 & 0xf) << 4) |

83 (
åackög¨óidítôy
->
mncdigô1
 & 0xf);

84 
ícoded
++;

85 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
åackög¨óidítôy
->
èc
);

86  
ícoded
;

87 
	}
}

89 
	$dump_åackög_¨ó_idítôy_xml
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
)

91 
	`¥ötf
("<Tracking Area Identity>\n");

92 i‡(
õi
 > 0)

94 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

95 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
åackög¨óidítôy
->
mccdigô2
);

96 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
åackög¨óidítôy
->
mccdigô1
);

97 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
åackög¨óidítôy
->
mncdigô3
);

98 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
åackög¨óidítôy
->
mccdigô3
);

99 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
åackög¨óidítôy
->
mncdigô2
);

100 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
åackög¨óidítôy
->
mncdigô1
);

101 
	`¥ötf
(" <TAC>0x%.4x</TAC>\n", 
åackög¨óidítôy
->
èc
);

102 
	`¥ötf
("</Tracking Area Identity>\n");

103 
	}
}

	@src/ies/TrackingAreaIdentity.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TRACKING_AREA_IDENTITY_H_


36 
	#TRACKING_AREA_IDENTITY_H_


	)

38 
	#TRACKING_AREA_IDENTITY_MINIMUM_LENGTH
 6

	)

39 
	#TRACKING_AREA_IDENTITY_MAXIMUM_LENGTH
 6

	)

41 
	sTøckögAªaIdítôy_èg
 {

42 
uöt8_t
 
	mmccdigô2
:4;

43 
uöt8_t
 
	mmccdigô1
:4;

44 
uöt8_t
 
	mmncdigô3
:4;

45 
uöt8_t
 
	mmccdigô3
:4;

46 
uöt8_t
 
	mmncdigô2
:4;

47 
uöt8_t
 
	mmncdigô1
:4;

48 
uöt16_t
 
	mèc
;

49 } 
	tTøckögAªaIdítôy
;

51 
ícode_åackög_¨ó_idítôy
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

53 
dump_åackög_¨ó_idítôy_xml
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
);

55 
decode_åackög_¨ó_idítôy
(
TøckögAªaIdítôy
 *
åackög¨óidítôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/TrackingAreaIdentityList.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"TLVEncodî.h
"

34 
	~"TLVDecodî.h
"

35 
	~"TøckögAªaIdítôyLi°.h
"

37 
	$decode_åackög_¨ó_idítôy_li°
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

39 
decoded
 = 0;

40 
uöt8_t
 
õÀn
 = 0;

41 i‡(
õi
 > 0)

43 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

44 
decoded
++;

46 
õÀn
 = *(
buf„r
 + 
decoded
);

47 
decoded
++;

48 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

49 
åackög¨óidítôyli°
->
ty≥oÊi°
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x3;

50 
åackög¨óidítôyli°
->
numbîo„Àmíts
 = *(
buf„r
 + 
decoded
) & 0x1f;

51 
decoded
++;

52 
åackög¨óidítôyli°
->
mccdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

53 
åackög¨óidítôyli°
->
mccdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

54 
decoded
++;

55 
åackög¨óidítôyli°
->
mncdigô3
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

56 
åackög¨óidítôyli°
->
mccdigô3
 = *(
buf„r
 + 
decoded
) & 0xf;

57 
decoded
++;

58 
åackög¨óidítôyli°
->
mncdigô2
 = (*(
buf„r
 + 
decoded
) >> 4) & 0xf;

59 
åackög¨óidítôyli°
->
mncdigô1
 = *(
buf„r
 + 
decoded
) & 0xf;

60 
decoded
++;

62 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, 
åackög¨óidítôyli°
->
èc
);

63 #i‡
	`deföed
 (
NAS_DEBUG
)

64 
	`dump_åackög_¨ó_idítôy_li°_xml
(
åackög¨óidítôyli°
, 
õi
);

66  
decoded
;

67 
	}
}

69 
	$ícode_åackög_¨ó_idítôy_li°
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

71 
uöt8_t
 *
ÀnPå
;

72 
uöt32_t
 
ícoded
 = 0;

74 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRACKING_AREA_IDENTITY_LIST_MINIMUM_LENGTH
, 
Àn
);

75 #i‡
	`deföed
 (
NAS_DEBUG
)

76 
	`dump_åackög_¨ó_idítôy_li°_xml
(
åackög¨óidítôyli°
, 
õi
);

78 i‡(
õi
 > 0)

80 *
buf„r
 = 
õi
;

81 
ícoded
++;

83 
ÀnPå
 = (
buf„r
 + 
ícoded
);

84 
ícoded
 ++;

85 *(
buf„r
 + 
ícoded
) = 0x00 |

86 ((
åackög¨óidítôyli°
->
ty≥oÊi°
 & 0x3) << 5) |

87 (
åackög¨óidítôyli°
->
numbîo„Àmíts
 & 0x1f);

88 
ícoded
++;

89 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôyli°
->
mccdigô2
 & 0xf) << 4) |

90 (
åackög¨óidítôyli°
->
mccdigô1
 & 0xf);

91 
ícoded
++;

92 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôyli°
->
mncdigô3
 & 0xf) << 4) |

93 (
åackög¨óidítôyli°
->
mccdigô3
 & 0xf);

94 
ícoded
++;

95 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åackög¨óidítôyli°
->
mncdigô2
 & 0xf) << 4) |

96 (
åackög¨óidítôyli°
->
mncdigô1
 & 0xf);

97 
ícoded
++;

98 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
åackög¨óidítôyli°
->
èc
);

99 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

100  
ícoded
;

101 
	}
}

103 
	$dump_åackög_¨ó_idítôy_li°_xml
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
)

105 
	`¥ötf
("<Tracking Area Identity List>\n");

106 i‡(
õi
 > 0)

108 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

109 
	`¥ötf
(" <Ty≥ o‡li°>%u</Ty≥ o‡li°>\n", 
åackög¨óidítôyli°
->
ty≥oÊi°
);

112 
	`¥ötf
(" <Numbî o‡ñemíts>%u</Numbî o‡ñemíts>\n", 
åackög¨óidítôyli°
->
numbîo„Àmíts
 + 1);

113 
	`¥ötf
(" <MCC digô 2>%u</MCC digô 2>\n", 
åackög¨óidítôyli°
->
mccdigô2
);

114 
	`¥ötf
(" <MCC digô 1>%u</MCC digô 1>\n", 
åackög¨óidítôyli°
->
mccdigô1
);

115 
	`¥ötf
(" <MNC digô 3>%u</MNC digô 3>\n", 
åackög¨óidítôyli°
->
mncdigô3
);

116 
	`¥ötf
(" <MCC digô 3>%u</MCC digô 3>\n", 
åackög¨óidítôyli°
->
mccdigô3
);

117 
	`¥ötf
(" <MNC digô 2>%u</MNC digô 2>\n", 
åackög¨óidítôyli°
->
mncdigô2
);

118 
	`¥ötf
(" <MNC digô 1>%u</MNC digô 1>\n", 
åackög¨óidítôyli°
->
mncdigô1
);

119 
	`¥ötf
(" <TAC>0x%.4x</TAC>\n", 
åackög¨óidítôyli°
->
èc
);

120 
	`¥ötf
("</Tracking Area Identity List>\n");

121 
	}
}

	@src/ies/TrackingAreaIdentityList.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TRACKING_AREA_IDENTITY_LIST_H_


36 
	#TRACKING_AREA_IDENTITY_LIST_H_


	)

38 
	#TRACKING_AREA_IDENTITY_LIST_MINIMUM_LENGTH
 8

	)

39 
	#TRACKING_AREA_IDENTITY_LIST_MAXIMUM_LENGTH
 98

	)

41 
	sTøckögAªaIdítôyLi°_èg
 {

45 
	#TRACKING_AREA_IDENTITY_LIST_ONE_PLMN_CONSECUTIVE_TACS
 0b01

	)

47 
uöt8_t
 
	mty≥oÊi°
:2;

48 
uöt8_t
 
	mnumbîo„Àmíts
:5;

49 
uöt8_t
 
	mmccdigô2
:4;

50 
uöt8_t
 
	mmccdigô1
:4;

51 
uöt8_t
 
	mmncdigô3
:4;

52 
uöt8_t
 
	mmccdigô3
:4;

53 
uöt8_t
 
	mmncdigô2
:4;

54 
uöt8_t
 
	mmncdigô1
:4;

55 
uöt16_t
 
	mèc
;

56 } 
	tTøckögAªaIdítôyLi°
;

58 
ícode_åackög_¨ó_idítôy_li°
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

60 
decode_åackög_¨ó_idítôy_li°
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

62 
dump_åackög_¨ó_idítôy_li°_xml
(
TøckögAªaIdítôyLi°
 *
åackög¨óidítôyli°
, 
uöt8_t
 
õi
);

	@src/ies/TrafficFlowAggregateDescription.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TøfficFlowAggªg©eDes¸ùti⁄.h
"

38 
	$decode_åaffic_Êow_aggªg©e_des¸ùti⁄
(
TøfficFlowAggªg©eDes¸ùti⁄
 *
åafficÊowaggªg©edes¸ùti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_åaffic_Êow_aggªg©e_des¸ùti⁄
(
TøfficFlowAggªg©eDes¸ùti⁄
 *
åafficÊowaggªg©edes¸ùti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/TrafficFlowAggregateDescription.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_H_


36 
	#TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_H_


	)

38 
	#TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MINIMUM_LENGTH
 1

	)

39 
	#TRAFFIC_FLOW_AGGREGATE_DESCRIPTION_MAXIMUM_LENGTH
 1

	)

42 
uöt8_t
 
	mfõld
;

43 } 
	tTøfficFlowAggªg©eDes¸ùti⁄
;

45 
ícode_åaffic_Êow_aggªg©e_des¸ùti⁄
(
TøfficFlowAggªg©eDes¸ùti⁄
 *
åafficÊowaggªg©edes¸ùti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_åaffic_Êow_aggªg©e_des¸ùti⁄_xml
(
TøfficFlowAggªg©eDes¸ùti⁄
 *
åafficÊowaggªg©edes¸ùti⁄
, 
uöt8_t
 
õi
);

49 
decode_åaffic_Êow_aggªg©e_des¸ùti⁄
(
TøfficFlowAggªg©eDes¸ùti⁄
 *
åafficÊowaggªg©edes¸ùti⁄
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/TrafficFlowTemplate.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"TøfficFlowTem∂©e.h
"

38 
decode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(
DñëePackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

39 
decode_åaffic_Êow_ãm∂©e_¸óã_t·
(
Cª©eNewT·
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

40 
decode_åaffic_Êow_ãm∂©e_add_∑ckë
(
AddPackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

41 
decode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(
Rïœ˚PackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

43 
decode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

44 
decode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

46 
ícode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(
DñëePackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
ícode_åaffic_Êow_ãm∂©e_¸óã_t·
(
Cª©eNewT·
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

48 
ícode_åaffic_Êow_ãm∂©e_add_∑ckë
(
AddPackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

49 
ícode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(
Rïœ˚PackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

52 
ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

54 
dump_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
);

55 
dump_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
);

57 
	$decode_åaffic_Êow_ãm∂©e
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

59 
decoded
 = 0;

60 
decoded_ªsu…
 = 0;

61 
uöt8_t
 
õÀn
 = 0;

63 i‡(
õi
 > 0)

65 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

66 
decoded
++;

68 
õÀn
 = *(
buf„r
 + 
decoded
);

69 
decoded
++;

70 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

71 
åafficÊowãm∂©e
->
t·›î©i⁄code
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

72 
åafficÊowãm∂©e
->
ebô
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

73 
åafficÊowãm∂©e
->
numbîoÂackëfûãrs
 = *(
buf„r
 + 
decoded
) & 0xf;

74 
decoded
++;

77 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_DELETE_PACKET
)

79 
decoded_ªsu…
 = 
	`decode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
dñëïackëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 + 
decoded
), 
Àn
 - decoded);

81 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
)

83 
decoded_ªsu…
 = 
	`decode_åaffic_Êow_ãm∂©e_¸óã_t·
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
¸óãt·
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 + 
decoded
), 
Àn
 - decoded);

85 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_ADD_PACKET
)

87 
decoded_ªsu…
 = 
	`decode_åaffic_Êow_ãm∂©e_add_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
add∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 + 
decoded
), 
Àn
 - decoded);

89 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_REPLACE_PACKET
)

91 
decoded_ªsu…
 = 
	`decode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
ª∂a˚∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 + 
decoded
), 
Àn
 - decoded);

94 #i‡
	`deföed
 (
NAS_DEBUG
)

95 
	`dump_åaffic_Êow_ãm∂©e_xml
(
åafficÊowãm∂©e
, 
õi
);

97 i‡(
decoded_ªsu…
 < 0) {

98  
decoded_ªsu…
;

100  (
decoded
 + 
decoded_ªsu…
);

101 
	}
}

103 
	$ícode_åaffic_Êow_ãm∂©e
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

105 
uöt8_t
 *
ÀnPå
;

106 
uöt32_t
 
ícoded
 = 0;

108 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
TRAFFIC_FLOW_TEMPLATE_MINIMUM_LENGTH
, 
Àn
);

109 #i‡
	`deföed
 (
NAS_DEBUG
)

110 
	`dump_åaffic_Êow_ãm∂©e_xml
(
åafficÊowãm∂©e
, 
õi
);

112 i‡(
õi
 > 0)

114 *
buf„r
 = 
õi
;

115 
ícoded
++;

117 
ÀnPå
 = (
buf„r
 + 
ícoded
);

118 
ícoded
 ++;

119 *(
buf„r
 + 
ícoded
Ë0x00 | ((
åafficÊowãm∂©e
->
t·›î©i⁄code
 & 0x7Ë<< 5Ë| (—øfficÊowãm∂©e->
ebô
 & 0x1Ë<< 4Ë| (åafficÊowãm∂©e->
numbîoÂackëfûãrs
 & 0xf);

120 
ícoded
++;

123 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_DELETE_PACKET
)

125 
ícoded
 +
	`ícode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
dñëïackëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 +Éncoded), 
Àn
 -Éncoded);

127 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
)

129 
ícoded
 +
	`ícode_åaffic_Êow_ãm∂©e_¸óã_t·
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
¸óãt·
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 +Éncoded), 
Àn
 -Éncoded);

131 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_ADD_PACKET
)

133 
ícoded
 +
	`ícode_åaffic_Êow_ãm∂©e_add_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
add∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 +Éncoded), 
Àn
 -Éncoded);

135 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_REPLACE_PACKET
)

137 
ícoded
 +
	`ícode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
ª∂a˚∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
, (
buf„r
 +Éncoded), 
Àn
 -Éncoded);

140 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

141  
ícoded
;

142 
	}
}

144 
	$dump_åaffic_Êow_ãm∂©e_xml
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
)

146 
	`¥ötf
("<Traffic Flow Template>\n");

147 i‡(
õi
 > 0)

149 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

150 
	`¥ötf
(" <TFT o≥øti⁄ code>%u</TFT o≥øti⁄ code>\n", 
åafficÊowãm∂©e
->
t·›î©i⁄code
);

151 
	`¥ötf
(" <E bô>%u</E bô>\n", 
åafficÊowãm∂©e
->
ebô
);

152 
	`¥ötf
(" <Numbî o‡∑ckë fûãrs>%u</Numbî o‡∑ckë fûãrs>\n", 
åafficÊowãm∂©e
->
numbîoÂackëfûãrs
);

154 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_DELETE_PACKET
)

156 
	`dump_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
dñëïackëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
);

158 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
)

160 
	`dump_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
¸óãt·
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
);

162 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_ADD_PACKET
)

164 
	`dump_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
add∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
);

166 i‡(
åafficÊowãm∂©e
->
t·›î©i⁄code
 =
TRAFFIC_FLOW_TEMPLATE_OPCODE_REPLACE_PACKET
)

168 
	`dump_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(&
åafficÊowãm∂©e
->
∑ckëfûãæi°
.
ª∂a˚∑ckëfûãr
,ÅøfficÊowãm∂©e->
numbîoÂackëfûãrs
);

171 
	`¥ötf
("</Traffic Flow Template>\n");

172 
	}
}

174 
	$decode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(
DñëePackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

176  
	`decode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

177 
	}
}

179 
	$decode_åaffic_Êow_ãm∂©e_¸óã_t·
(
Cª©eNewT·
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

181  
	`decode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

182 
	}
}

184 
	$decode_åaffic_Êow_ãm∂©e_add_∑ckë
(
AddPackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

186  
	`decode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

187 
	}
}

189 
	$decode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(
Rïœ˚PackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

191  
	`decode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

192 
	}
}

194 
	$decode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

196 
decoded
 = 0, 
i
;

198 
i
 = 0; (ò< 
nb∑ckëfûãrs
Ë&& (
Àn
 - 
decoded
 > 0); i++)

201 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, (*
∑ckëfûãridítifõrs
)[
i
].
idítifõr
);

204  
decoded
;

205 
	}
}

207 
	$decode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

209 
decoded
 = 0, 
i
, 
j
;

211 
i
 = 0; (ò< 
nb∑ckëfûãrs
); i++)

213 i‡(
Àn
 - 
decoded
 <= 0) {

216  (
TLV_DECODE_VALUE_DOESNT_MATCH
);

219 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 = 0;

221 (*
∑ckëfûãrs
)[
i
].
dúe˘i⁄
 = *(
buf„r
 + 
decoded
) >> 4;

223 (*
∑ckëfûãrs
)[
i
].
idítifõr
 = *(
buf„r
 + 
decoded
) & 0x0f;

224 
decoded
++;

226 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
evÆ_¥e˚dí˚
);

228 
uöt8_t
 
pkÊí
;

229 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, 
pkÊí
);

231 
pkf°¨t
 = 
decoded
;

232 
decoded
 - 
pkf°¨t
 < 
pkÊí
)

235 
uöt8_t
 
comp⁄ít_ty≥
;

236 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, 
comp⁄ít_ty≥
);

238 
comp⁄ít_ty≥
)

240 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR
:

242 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
;

243 
j
 = 0; j < 
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
; j++)

245 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[
j
].
addr
 = *(
buf„r
 + 
decoded
);

246 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[
j
].
mask
 = *(
buf„r
 + 
decoded
 + 
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
);

247 
decoded
++;

249 
decoded
 +
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
;

252 
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR
:

254 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR_FLAG
;

255 
j
 = 0; j < 
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
; j++)

257 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[
j
].
addr
 = *(
buf„r
 + 
decoded
);

258 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[
j
].
mask
 = *(
buf„r
 + 
decoded
 + 
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
);

259 
decoded
++;

261 
decoded
 +
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
;

264 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER
:

266 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
;

267 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
¥Ÿocﬁidítifõr_√xthódî
);

270 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT
:

272 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
;

273 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀloˇÕ‹t
);

276 
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE
:

278 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE_FLAG
;

279 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
lowlimô
);

280 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
highlimô
);

283 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT
:

285 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |=
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
 ;

286 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀªmŸï‹t
);

289 
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE
:

291 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE_FLAG
;

292 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
lowlimô
);

293 
	`IES_DECODE_U16
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
highlimô
);

296 
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX
:

298 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX_FLAG
;

299 
	`IES_DECODE_U32
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
£curôy∑ømëîödex
);

302 
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS
:

304 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS_FLAG
;

305 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
vÆue
);

306 
	`IES_DECODE_U8
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
mask
);

309 
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL
:

311 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 |
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL_FLAG
;

312 
	`IES_DECODE_U24
(
buf„r
, 
decoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êowœbñ
);

317  (
TLV_DECODE_UNEXPECTED_IEI
);

323 i‡(
Àn
 - 
decoded
 != 0) {

326  (
TLV_DECODE_VALUE_DOESNT_MATCH
);

328  
decoded
;

329 
	}
}

331 
	$ícode_åaffic_Êow_ãm∂©e_dñëe_∑ckë
(
DñëePackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

333  
	`ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

334 
	}
}

336 
	$ícode_åaffic_Êow_ãm∂©e_¸óã_t·
(
Cª©eNewT·
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

338  
	`ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

339 
	}
}

341 
	$ícode_åaffic_Êow_ãm∂©e_add_∑ckë
(
AddPackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

343  
	`ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

344 
	}
}

346 
	$ícode_åaffic_Êow_ãm∂©e_ª∂a˚_∑ckë
(
Rïœ˚PackëFûãr
* 
∑ckëfûãr
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

348  
	`ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
∑ckëfûãr
, 
nb∑ckëfûãrs
, 
buf„r
, 
Àn
);

349 
	}
}

351 
	$ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

353 
ícoded
 = 0, 
i
;

355 
i
 = 0; (ò< 
nb∑ckëfûãrs
Ë&& (
Àn
 - 
ícoded
 > 0); i++)

358 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (*
∑ckëfûãridítifõrs
)[
i
].
idítifõr
);

361  
ícoded
;

362 
	}
}

364 
	$ícode_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

366 
ícoded
 = 0, 
i
, 
j
;

368 
i
 = 0; (ò< 
nb∑ckëfûãrs
Ë&& (
Àn
 - 
ícoded
 > 0); i++)

370 i‡(
Àn
 - 
ícoded
 <= 0) {

373  (
TLV_DECODE_VALUE_DOESNT_MATCH
);

376 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (0x00 | ((*
∑ckëfûãrs
)[
i
].
dúe˘i⁄
 << 4Ë| ((*∑ckëfûãrs)[i].
idítifõr
)));

378 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
evÆ_¥e˚dí˚
);

380 
uöt8_t
* 
pkÊíPå
 = 
buf„r
 + 
ícoded
;

381 
ícoded
++;

383 
pkf°¨t
 = 
ícoded
;

384 
uöt16_t
 
Êag
 = 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
;

385 
Êag
 <
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL_FLAG
)

387 (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
Êag
)

389 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
:

391 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR
);

392 
j
 = 0; j < 
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
; j++)

394 *(
buf„r
 + 
ícoded
Ë(*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[
j
].
addr
;

395 *(
buf„r
 + 
ícoded
 + 
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
Ë(*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[
j
].
mask
;

396 
ícoded
++;

398 
ícoded
 +
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
;

401 
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR_FLAG
:

403 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR
);

404 
j
 = 0; j < 
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
; j++)

406 *(
buf„r
 + 
ícoded
Ë(*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[
j
].
addr
;

407 *(
buf„r
 + 
ícoded
 + 
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
Ë(*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[
j
].
mask
;

408 
ícoded
++;

410 
ícoded
 +
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
;

413 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
:

415 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER
);

416 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
¥Ÿocﬁidítifõr_√xthódî
);

419 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
:

421 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT
);

422 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀloˇÕ‹t
);

425 
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE_FLAG
:

427 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE
);

428 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
lowlimô
);

429 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
highlimô
);

432 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
:

434 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT
);

435 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀªmŸï‹t
);

438 
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE_FLAG
:

440 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE
);

441 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
lowlimô
);

442 
	`IES_ENCODE_U16
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
highlimô
);

445 
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX_FLAG
:

447 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX
);

448 
	`IES_ENCODE_U32
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
£curôy∑ømëîödex
);

451 
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS_FLAG
:

453 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS
);

454 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
vÆue
);

455 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
mask
);

458 
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL_FLAG
:

460 
	`IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL
);

461 
	`IES_ENCODE_U24
(
buf„r
, 
ícoded
, (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êowœbñ
 & 0x000fffff);

467 
Êag
 = flag << 1;

470 *
pkÊíPå
 = 
ícoded
 - 
pkf°¨t
;

473  
ícoded
;

474 
	}
}

476 
	$dump_åaffic_Êow_ãm∂©e_∑ckë_fûãr_idítifõrs
(
PackëFûãrIdítifõrs
* 
∑ckëfûãridítifõrs
, 
uöt8_t
 
nb∑ckëfûãrs
)

478 
i
;

479 
	`¥ötf
(" <Packet filterÜist>\n");

480 
i
 = 0; i < 
nb∑ckëfûãrs
; i++)

482 
	`¥ötf
(" <Idítifõr>%u</Idítifõr>\n", (*
∑ckëfûãridítifõrs
)[
i
].
idítifõr
);

484 
	`¥ötf
(" </Packet filterÜist>\n");

485 
	}
}

487 
	$dump_åaffic_Êow_ãm∂©e_∑ckë_fûãrs
(
PackëFûãrs
* 
∑ckëfûãrs
, 
uöt8_t
 
nb∑ckëfûãrs
)

489 
i
;

490 
	`¥ötf
(" <Packet filterÜist>\n");

491 
i
 = 0; i < 
nb∑ckëfûãrs
; i++)

493 
	`¥ötf
(" <Idítifõr>%u</Idítifõr>\n", (*
∑ckëfûãrs
)[
i
].
idítifõr
);

494 
	`¥ötf
(" <Dúe˘i⁄>%u</Dúe˘i⁄>\n", (*
∑ckëfûãrs
)[
i
].
dúe˘i⁄
);

495 
	`¥ötf
(" <EvÆu©i⁄Öª˚dí˚>%u</EvÆu©i⁄Öª˚dí˚>\n", (*
∑ckëfûãrs
)[
i
].
evÆ_¥e˚dí˚
);

496 
	`¥ötf
(" <Packet filter>\n");

497 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
)

499 
	`¥ötf
(" <IPv4ÑemŸêaddªss>%u.%u.%u.%u</IPv4ÑemŸêaddªss>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[0].
addr
, (*packetfilters)[i].packetfilter.ipv4remoteaddr[1].addr, (*packetfilters)[i].packetfilter.ipv4remoteaddr[2].addr, (*packetfilters)[i].packetfilter.ipv4remoteaddr[3].addr);

500 
	`¥ötf
(" <IPv4ÑemŸêaddªs†mask>%u.%u.%u.%u</IPv4ÑemŸêaddªs†mask>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv4ªmŸóddr
[0].
mask
, (*packetfilters)[i].packetfilter.ipv4remoteaddr[1].mask, (*packetfilters)[i].packetfilter.ipv4remoteaddr[2].mask, (*packetfilters)[i].packetfilter.ipv4remoteaddr[3].mask);

502 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR_FLAG
)

504 
	`¥ötf
(" <Ipv6ÑemŸêaddªss>%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x</Ipv6ÑemŸêaddªss>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[0].
addr
, (*packetfilters)[i].packetfilter.ipv6remoteaddr[1].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[2].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[3].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[4].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[5].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[6].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[7].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[8].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[9].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[10].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[11].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[12].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[13].addr, (*packetfilters)[i].packetfilter.ipv6remoteaddr[14].addr, (*packetfilters)[i].packetfilter.

505 
ùv6ªmŸóddr
[15].
addr
);

506 
	`¥ötf
(" <Ipv6ÑemŸêaddªs†mask>%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x:%x%.2x</Ipv6ÑemŸêaddªs†mask>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ùv6ªmŸóddr
[0].
mask
, (*packetfilters)[i].packetfilter.ipv6remoteaddr[1].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[2].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[3].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[4].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[5].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[6].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[7].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[8].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[9].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[10].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[11].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[12].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[13].mask, (*packetfilters)[i].packetfilter.ipv6remoteaddr[14].mask, (*packetfilters)[i].

507 
∑ckëfûãr
.
ùv6ªmŸóddr
[15].
mask
);

509 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
)

511 
	`¥ötf
(" <PrŸocﬁ idítifõ∏- NexàhódîÅy≥>%u</PrŸocﬁ idítifõ∏- NexàhódîÅy≥>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
¥Ÿocﬁidítifõr_√xthódî
);

513 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
)

515 
	`¥ötf
(" <SögÀÜoˇ»p‹t>%u</SögÀÜoˇ»p‹t>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀloˇÕ‹t
);

517 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE_FLAG
)

519 
	`¥ötf
(" <Loˇ»p‹àøngêlowÜimô>%u</Loˇ»p‹àøngêlowÜimô>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
lowlimô
);

520 
	`¥ötf
(" <Loˇ»p‹àøngêhighÜimô>%u</Loˇ»p‹àøngêhighÜimô>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
loˇÕ‹å™ge
.
highlimô
);

522 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
)

524 
	`¥ötf
(" <SögÀÑemŸêp‹t>%u</SögÀÑemŸêp‹t>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
sögÀªmŸï‹t
);

526 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE_FLAG
)

528 
	`¥ötf
(" <RemŸêp‹àøngêlowÜimô>%u</RemŸêp‹àøngêlowÜimô>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
lowlimô
);

529 
	`¥ötf
(" <RemŸêp‹àøngêhighÜimô>%u</RemŸêp‹àøngêhighÜimô>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
ªmŸï‹å™ge
.
highlimô
);

531 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX_FLAG
)

533 
	`¥ötf
(" <SecurôyÖ¨amëî index>%u</SecurôyÖ¨amëî index>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
£curôy∑ømëîödex
);

535 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS_FLAG
)

537 
	`¥ötf
(" <Ty≥ o‡£rvi˚ - Tøffi¯˛ass>%u</Ty≥ o‡£rvi˚ - Tøffi¯˛ass>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
vÆue
);

538 
	`¥ötf
(" <Ty≥ o‡£rvi˚ - Tøffi¯˛as†mask>%u</Ty≥ o‡£rvi˚ - Tøffi¯˛as†mask>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
typdeof£rvi˚_åaffic˛ass
.
mask
);

540 i‡((*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êags
 & 
TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL_FLAG
)

542 
	`¥ötf
(" <FlowÜabñ>%u</FlowÜabñ>\n", (*
∑ckëfûãrs
)[
i
].
∑ckëfûãr
.
Êowœbñ
);

544 
	`¥ötf
(" </Packet filter>\n");

546 
	`¥ötf
(" </Packet filterÜist>\n");

547 
	}
}

	@src/ies/TrafficFlowTemplate.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 #i‚de‡
TRAFFIC_FLOW_TEMPLATE_H_


34 
	#TRAFFIC_FLOW_TEMPLATE_H_


	)

36 
	#TRAFFIC_FLOW_TEMPLATE_MINIMUM_LENGTH
 2

	)

37 
	#TRAFFIC_FLOW_TEMPLATE_MAXIMUM_LENGTH
 256

	)

45 
	#TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR
 0b00010000

	)

46 
	#TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR
 0b00100000

	)

47 
	#TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER
 0b00110000

	)

48 
	#TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT
 0b01000000

	)

49 
	#TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE
 0b01000001

	)

50 
	#TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT
 0b01010000

	)

51 
	#TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE
 0b01010001

	)

52 
	#TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX
 0b01100000

	)

53 
	#TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS
 0b01110000

	)

54 
	#TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL
 0b10000000

	)

61 
	#TRAFFIC_FLOW_TEMPLATE_IPV4_REMOTE_ADDR_FLAG
 (1<<0)

	)

62 
	#TRAFFIC_FLOW_TEMPLATE_IPV6_REMOTE_ADDR_FLAG
 (1<<1)

	)

63 
	#TRAFFIC_FLOW_TEMPLATE_PROTOCOL_NEXT_HEADER_FLAG
 (1<<2)

	)

64 
	#TRAFFIC_FLOW_TEMPLATE_SINGLE_LOCAL_PORT_FLAG
 (1<<3)

	)

65 
	#TRAFFIC_FLOW_TEMPLATE_LOCAL_PORT_RANGE_FLAG
 (1<<4)

	)

66 
	#TRAFFIC_FLOW_TEMPLATE_SINGLE_REMOTE_PORT_FLAG
 (1<<5)

	)

67 
	#TRAFFIC_FLOW_TEMPLATE_REMOTE_PORT_RANGE_FLAG
 (1<<6)

	)

68 
	#TRAFFIC_FLOW_TEMPLATE_SECURITY_PARAMETER_INDEX_FLAG
 (1<<7)

	)

69 
	#TRAFFIC_FLOW_TEMPLATE_TYPE_OF_SERVICE_TRAFFIC_CLASS_FLAG
 (1<<8)

	)

70 
	#TRAFFIC_FLOW_TEMPLATE_FLOW_LABEL_FLAG
 (1<<9)

	)

71 
uöt16_t
 
	mÊags
;

72 
	#TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
 4

	)

74 
uöt8_t
 
	maddr
;

75 
uöt8_t
 
	mmask
;

76 } 
	mùv4ªmŸóddr
[
TRAFFIC_FLOW_TEMPLATE_IPV4_ADDR_SIZE
];

77 
	#TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
 16

	)

79 
uöt8_t
 
	maddr
;

80 
uöt8_t
 
	mmask
;

81 } 
	mùv6ªmŸóddr
[
TRAFFIC_FLOW_TEMPLATE_IPV6_ADDR_SIZE
];

82 
uöt8_t
 
	m¥Ÿocﬁidítifõr_√xthódî
;

83 
uöt16_t
 
	msögÀloˇÕ‹t
;

85 
uöt16_t
 
	mlowlimô
;

86 
uöt16_t
 
	mhighlimô
;

87 } 
	mloˇÕ‹å™ge
;

88 
uöt16_t
 
	msögÀªmŸï‹t
;

90 
uöt16_t
 
	mlowlimô
;

91 
uöt16_t
 
	mhighlimô
;

92 } 
	mªmŸï‹å™ge
;

93 
uöt32_t
 
	m£curôy∑ømëîödex
;

95 
uöt8_t
 
	mvÆue
;

96 
uöt8_t
 
	mmask
;

97 } 
	mtypdeof£rvi˚_åaffic˛ass
;

98 
uöt32_t
 
	mÊowœbñ
;

99 } 
	tPackëFûãr
;

106 °ru˘ {} 
	gNoPackëFûãr
;

108 
NoPackëFûãr
 
	tDñëeExi°ögT·
;

109 
NoPackëFûãr
 
	tNoT·O≥øti⁄
;

116 
	#TRAFFIC_FLOW_TEMPLATE_PACKET_IDENTIFIER_MAX
 16

	)

118 
uöt8_t
 
	midítifõr
;

119 } 
	tPackëFûãrIdítifõrs
[
TRAFFIC_FLOW_TEMPLATE_PACKET_IDENTIFIER_MAX
];

121 
PackëFûãrIdítifõrs
 
	tDñëePackëFûãr
;

129 
	#TRAFFIC_FLOW_TEMPLATE_NB_PACKET_FILTERS_MAX
 4

	)

131 
uöt8_t
 
	midítifõr
:4;

132 
	#TRAFFIC_FLOW_TEMPLATE_PRE_REL7_TFT_FILTER
 0b00

	)

133 
	#TRAFFIC_FLOW_TEMPLATE_DOWNLINK_ONLY
 0b01

	)

134 
	#TRAFFIC_FLOW_TEMPLATE_UPLINK_ONLY
 0b10

	)

135 
	#TRAFFIC_FLOW_TEMPLATE_BIDIRECTIONAL
 0b11

	)

136 
uöt8_t
 
	mdúe˘i⁄
:2;

137 
uöt8_t
 
	mevÆ_¥e˚dí˚
;

138 
PackëFûãr
 
	m∑ckëfûãr
;

139 } 
	tPackëFûãrs
[
TRAFFIC_FLOW_TEMPLATE_NB_PACKET_FILTERS_MAX
];

141 
PackëFûãrs
 
	tCª©eNewT·
;

142 
PackëFûãrs
 
	tAddPackëFûãr
;

143 
PackëFûãrs
 
	tRïœ˚PackëFûãr
;

150 
Cª©eNewT·
 
	m¸óãt·
;

151 
DñëeExi°ögT·
 
	mdñëë·
;

152 
AddPackëFûãr
 
	madd∑ckëfûãr
;

153 
Rïœ˚PackëFûãr
 
	mª∂a˚∑ckëfûãr
;

154 
DñëePackëFûãr
 
	mdñëïackëfûãr
;

155 
NoT·O≥øti⁄
 
	mnŸ·›î©i⁄
;

156 } 
	tPackëFûãrLi°
;

166 } 
	gP¨amëîLi°
;

174 
	sTøfficFlowTem∂©e_èg
 {

175 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_SPARE
 0b000

	)

176 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_CREATE
 0b001

	)

177 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_DELETE
 0b010

	)

178 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_ADD_PACKET
 0b011

	)

179 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_REPLACE_PACKET
 0b100

	)

180 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_DELETE_PACKET
 0b101

	)

181 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_NO_OPERATION
 0b110

	)

182 
	#TRAFFIC_FLOW_TEMPLATE_OPCODE_RESERVED
 0b111

	)

183 
uöt8_t
 
	mt·›î©i⁄code
:3;

184 
	#TRAFFIC_FLOW_TEMPLATE_PARAMETER_LIST_IS_NOT_INCLUDED
 0

	)

185 
	#TRAFFIC_FLOW_TEMPLATE_PARAMETER_LIST_IS_INCLUDED
 1

	)

186 
uöt8_t
 
	mebô
:1;

187 
uöt8_t
 
	mnumbîoÂackëfûãrs
:4;

188 
PackëFûãrLi°
 
	m∑ckëfûãæi°
;

189 
P¨amëîLi°
 
	m∑ømëîli°
;

190 } 
	tTøfficFlowTem∂©e
;

192 
ícode_åaffic_Êow_ãm∂©e
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

194 
decode_åaffic_Êow_ãm∂©e
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

196 
dump_åaffic_Êow_ãm∂©e_xml
(
TøfficFlowTem∂©e
 *
åafficÊowãm∂©e
, 
uöt8_t
 
õi
);

	@src/ies/TransactionIdentifier.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"Tønß˘i⁄Idítifõr.h
"

38 
	$decode_å™ß˘i⁄_idítifõr
(
Tønß˘i⁄Idítifõr
 *
å™ß˘i⁄idítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
	}
}

43 
	$ícode_å™ß˘i⁄_idítifõr
(
Tønß˘i⁄Idítifõr
 *
å™ß˘i⁄idítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

46 
	}
}

	@src/ies/TransactionIdentifier.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
TRANSACTION_IDENTIFIER_H_


36 
	#TRANSACTION_IDENTIFIER_H_


	)

38 
	#TRANSACTION_IDENTIFIER_MINIMUM_LENGTH
 1

	)

39 
	#TRANSACTION_IDENTIFIER_MAXIMUM_LENGTH
 1

	)

42 
uöt8_t
 
	mfõld
;

43 } 
	tTønß˘i⁄Idítifõr
;

45 
ícode_å™ß˘i⁄_idítifõr
(
Tønß˘i⁄Idítifõr
 *
å™ß˘i⁄idítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

47 
dump_å™ß˘i⁄_idítifõr_xml
(
Tønß˘i⁄Idítifõr
 *
å™ß˘i⁄idítifõr
, 
uöt8_t
 
õi
);

49 
decode_å™ß˘i⁄_idítifõr
(
Tønß˘i⁄Idítifõr
 *
å™ß˘i⁄idítifõr
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

	@src/ies/UeNetworkCapability.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

32 
	~<°rög.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"UeNëw‹kC≠abûôy.h
"

39 
	$decode_ue_√tw‹k_ˇ∑bûôy
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
decoded
 = 0;

42 
uöt8_t
 
õÀn
 = 0;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
	`DECODE_U8
(
buf„r
 + 
decoded
, 
õÀn
, decoded);

50 
	`mem£t
(
uíëw‹kˇ∑bûôy
, 0, (
UeNëw‹kC≠abûôy
));

52 
	`LOG_TRACE
(
INFO
, "decode_ue_√tw‹k_ˇ∑bûôyÜí = %d",
õÀn
);

53 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

54 
uíëw‹kˇ∑bûôy
->
ìa
 = *(
buf„r
 + 
decoded
);

55 
decoded
++;

56 
uíëw‹kˇ∑bûôy
->
eü
 = *(
buf„r
 + 
decoded
);

57 
decoded
++;

60 i‡(
õÀn
 > 2) {

61 
uíëw‹kˇ∑bûôy
->
uó
 = *(
buf„r
 + 
decoded
);

62 
decoded
++;

64 i‡(
õÀn
 > 3) {

65 
uíëw‹kˇ∑bûôy
->
ucs2
 = (*(
buf„r
 + 
decoded
) >> 7) & 0x1;

66 
uíëw‹kˇ∑bûôy
->
uü
 = *(
buf„r
 + 
decoded
) & 0x7f;

67 
decoded
++;

68 
uíëw‹kˇ∑bûôy
->
umts_¥e£¡
 =1;

69 
	`LOG_TRACE
(
INFO
, "uenetworkcapability decoded UMTS\n");

71 i‡(
õÀn
 > 4) {

72 
uíëw‹kˇ∑bûôy
->
•¨e
 = (*(
buf„r
 + 
decoded
) >> 5) & 0x7;

73 
uíëw‹kˇ∑bûôy
->
csfb
 = (*(
buf„r
 + 
decoded
) >> 4) & 0x1;

74 
uíëw‹kˇ∑bûôy
->
Õp
 = (*(
buf„r
 + 
decoded
) >> 3) & 0x1;

75 
uíëw‹kˇ∑bûôy
->
lcs
 = (*(
buf„r
 + 
decoded
) >> 2) & 0x1;

76 
uíëw‹kˇ∑bûôy
->
§vcc
 = (*(
buf„r
 + 
decoded
) >> 1) & 0x1;

77 
uíëw‹kˇ∑bûôy
->
nf
 = *(
buf„r
 + 
decoded
) & 0x1;

78 
decoded
++;

79 
uíëw‹kˇ∑bûôy
->
g¥s_¥e£¡
 =1;

80 
	`LOG_TRACE
(
INFO
, "uenetworkcapability decoded GPRS\n");

84 
	`LOG_TRACE
(
INFO
, "uíëw‹kˇ∑bûôy decoded=%u\n", 
decoded
);

86 i‡((
õÀn
 + 2Ë!
decoded
) {

87 
decoded
 = 
õÀn
 + 1 + (
õi
 > 0 ? 1 : 0) ;

88 
	`LOG_TRACE
(
INFO
, "uíëw‹kˇ∑bûôyÅhí decoded=%u\n", 
decoded
);

91 #i‡
	`deföed
 (
NAS_DEBUG
)

92 
	`dump_ue_√tw‹k_ˇ∑bûôy_xml
(
uíëw‹kˇ∑bûôy
, 
õi
);

94  
decoded
;

95 
	}
}

96 
	$ícode_ue_√tw‹k_ˇ∑bûôy
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

98 
uöt8_t
 *
ÀnPå
;

99 
uöt32_t
 
ícoded
 = 0;

101 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
UE_NETWORK_CAPABILITY_MINIMUM_LENGTH
, 
Àn
);

102 #i‡
	`deföed
 (
NAS_DEBUG
)

103 
	`dump_ue_√tw‹k_ˇ∑bûôy_xml
(
uíëw‹kˇ∑bûôy
, 
õi
);

105 i‡(
õi
 > 0)

107 *
buf„r
 = 
õi
;

108 
ícoded
++;

110 
ÀnPå
 = (
buf„r
 + 
ícoded
);

111 
ícoded
 ++;

112 *(
buf„r
 + 
ícoded
Ë
uíëw‹kˇ∑bûôy
->
ìa
;

113 
ícoded
++;

114 *(
buf„r
 + 
ícoded
Ë
uíëw‹kˇ∑bûôy
->
eü
;

115 
ícoded
++;

116 
	`LOG_TRACE
(
INFO
, "uíëw‹kˇ∑bûôyÉncoded EPS %u\n", 
ícoded
);

118 i‡(
uíëw‹kˇ∑bûôy
->
umts_¥e£¡
) {

119 *(
buf„r
 + 
ícoded
Ë
uíëw‹kˇ∑bûôy
->
uó
;

120 
ícoded
++;

121 *(
buf„r
 + 
ícoded
Ë0x00 | ((
uíëw‹kˇ∑bûôy
->
ucs2
 & 0x1) << 7) |

122 (
uíëw‹kˇ∑bûôy
->
uü
 & 0x7f);

123 
ícoded
++;

124 
	`LOG_TRACE
(
INFO
, "uíëw‹kˇ∑bûôyÉncoded UMTS %u\n", 
ícoded
);

127 i‡(
uíëw‹kˇ∑bûôy
->
g¥s_¥e£¡
) {

129 *(
buf„r
 + 
ícoded
) = 0x00 | 0x60;

136 
ícoded
++;

137 
	`LOG_TRACE
(
INFO
, "uíëw‹kˇ∑bûôyÉncoded GPRS %u\n", 
ícoded
);

140 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

141  
ícoded
;

142 
	}
}

144 
	$dump_ue_√tw‹k_ˇ∑bûôy_xml
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
)

146 
	`¥ötf
("<Ue Network Capability>\n");

147 i‡(
õi
 > 0)

149 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

150 
	`¥ötf
(" <EEA>%02x</EEA>\n", 
uíëw‹kˇ∑bûôy
->
ìa
);

151 
	`¥ötf
(" <EIA>%02x</EIA>\n", 
uíëw‹kˇ∑bûôy
->
eü
);

152 
	`¥ötf
(" <UEA>%02x</UEA>\n", 
uíëw‹kˇ∑bûôy
->
uó
);

153 
	`¥ötf
(" <UCS2>%u</UCS2>\n", 
uíëw‹kˇ∑bûôy
->
ucs2
);

154 
	`¥ötf
(" <UIA>%u</UIA>\n", 
uíëw‹kˇ∑bûôy
->
uü
);

155 
	`¥ötf
(" <SPARE>%u</SPARE>\n", 
uíëw‹kˇ∑bûôy
->
•¨e
);

156 
	`¥ötf
(" <CSFB>%u</CSFB>\n", 
uíëw‹kˇ∑bûôy
->
csfb
);

157 
	`¥ötf
(" <LPP>%u</LPP>\n", 
uíëw‹kˇ∑bûôy
->
Õp
);

158 
	`¥ötf
(" <LCS>%u</LCS>\n", 
uíëw‹kˇ∑bûôy
->
lcs
);

159 
	`¥ötf
(" <SR VCC>%u</SR VCC>\n", 
uíëw‹kˇ∑bûôy
->
§vcc
);

160 
	`¥ötf
(" <NF>%u<NF/>\n", 
uíëw‹kˇ∑bûôy
->
nf
);

161 
	`¥ötf
(" <UMTS>%u<UMTS/>\n", 
uíëw‹kˇ∑bûôy
->
umts_¥e£¡
);

162 
	`¥ötf
(" <GPRS>%u<GPRS/>\n", 
uíëw‹kˇ∑bûôy
->
g¥s_¥e£¡
);

163 
	`¥ötf
("</Ue Network Capability>\n");

164 
	}
}

	@src/ies/UeNetworkCapability.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
UE_NETWORK_CAPABILITY_H_


36 
	#UE_NETWORK_CAPABILITY_H_


	)

38 
	#UE_NETWORK_CAPABILITY_MINIMUM_LENGTH
 4

	)

39 
	#UE_NETWORK_CAPABILITY_MAXIMUM_LENGTH
 7

	)

41 
	sUeNëw‹kC≠abûôy_èg
 {

43 
	#UE_NETWORK_CAPABILITY_EEA0
 0b10000000

	)

44 
	#UE_NETWORK_CAPABILITY_EEA1
 0b01000000

	)

45 
	#UE_NETWORK_CAPABILITY_EEA2
 0b00100000

	)

46 
	#UE_NETWORK_CAPABILITY_EEA3
 0b00010000

	)

47 
	#UE_NETWORK_CAPABILITY_EEA4
 0b00001000

	)

48 
	#UE_NETWORK_CAPABILITY_EEA5
 0b00000100

	)

49 
	#UE_NETWORK_CAPABILITY_EEA6
 0b00000010

	)

50 
	#UE_NETWORK_CAPABILITY_EEA7
 0b00000001

	)

51 
uöt8_t
 
	mìa
;

53 
	#UE_NETWORK_CAPABILITY_EIA0
 0b10000000

	)

54 
	#UE_NETWORK_CAPABILITY_EIA1
 0b01000000

	)

55 
	#UE_NETWORK_CAPABILITY_EIA2
 0b00100000

	)

56 
	#UE_NETWORK_CAPABILITY_EIA3
 0b00010000

	)

57 
	#UE_NETWORK_CAPABILITY_EIA4
 0b00001000

	)

58 
	#UE_NETWORK_CAPABILITY_EIA5
 0b00000100

	)

59 
	#UE_NETWORK_CAPABILITY_EIA6
 0b00000010

	)

60 
	#UE_NETWORK_CAPABILITY_EIA7
 0b00000001

	)

61 
uöt8_t
 
	meü
;

63 
	#UE_NETWORK_CAPABILITY_UEA0
 0b10000000

	)

64 
	#UE_NETWORK_CAPABILITY_UEA1
 0b01000000

	)

65 
	#UE_NETWORK_CAPABILITY_UEA2
 0b00100000

	)

66 
	#UE_NETWORK_CAPABILITY_UEA3
 0b00010000

	)

67 
	#UE_NETWORK_CAPABILITY_UEA4
 0b00001000

	)

68 
	#UE_NETWORK_CAPABILITY_UEA5
 0b00000100

	)

69 
	#UE_NETWORK_CAPABILITY_UEA6
 0b00000010

	)

70 
	#UE_NETWORK_CAPABILITY_UEA7
 0b00000001

	)

71 
uöt8_t
 
	muó
;

73 
	#UE_NETWORK_CAPABILITY_DEFAULT_ALPHABET
 0

	)

74 
	#UE_NETWORK_CAPABILITY_UCS2_ALPHABET
 1

	)

75 
uöt8_t
 
	mucs2
:1;

77 
	#UE_NETWORK_CAPABILITY_UIA1
 0b01000000

	)

78 
	#UE_NETWORK_CAPABILITY_UIA2
 0b00100000

	)

79 
	#UE_NETWORK_CAPABILITY_UIA3
 0b00010000

	)

80 
	#UE_NETWORK_CAPABILITY_UIA4
 0b00001000

	)

81 
	#UE_NETWORK_CAPABILITY_UIA5
 0b00000100

	)

82 
	#UE_NETWORK_CAPABILITY_UIA6
 0b00000010

	)

83 
	#UE_NETWORK_CAPABILITY_UIA7
 0b00000001

	)

84 
uöt8_t
 
	muü
:7;

86 
uöt8_t
 
	m•¨e
:3;

88 
	#UE_NETWORK_CAPABILITY_CSFB
 1

	)

89 
uöt8_t
 
	mcsfb
:1;

91 
	#UE_NETWORK_CAPABILITY_LPP
 1

	)

92 
uöt8_t
 
	mÕp
:1;

94 
	#UE_NETWORK_CAPABILITY_LCS
 1

	)

95 
uöt8_t
 
	mlcs
:1;

97 
	#UE_NETWORK_CAPABILITY_SRVCC
 1

	)

98 
uöt8_t
 
	m§vcc
:1;

100 
	#UE_NETWORK_CAPABILITY_NF
 1

	)

101 
uöt8_t
 
	mnf
:1;

103 
uöt8_t
 
	mumts_¥e£¡
;

104 
uöt8_t
 
	mg¥s_¥e£¡
;

105 } 
	tUeNëw‹kC≠abûôy
;

107 
ícode_ue_√tw‹k_ˇ∑bûôy
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

109 
decode_ue_√tw‹k_ˇ∑bûôy
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

111 
dump_ue_√tw‹k_ˇ∑bûôy_xml
(
UeNëw‹kC≠abûôy
 *
uíëw‹kˇ∑bûôy
, 
uöt8_t
 
õi
);

	@src/ies/UeRadioCapabilityInformationUpdateNeeded.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

34 
	~"TLVEncodî.h
"

35 
	~"TLVDecodî.h
"

36 
	~"UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded.h
"

38 
	$decode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

40 
decoded
 = 0;

41 
	`CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
buf„r
, 
UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_MINIMUM_LENGTH
, 
Àn
);

42 i‡(
õi
 > 0)

44 
	`CHECK_IEI_DECODER
((*
buf„r
 & 0xf0), 
õi
);

46 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
 = *
buf„r
 & 0x1;

47 
decoded
++;

48 #i‡
	`deföed
 (
NAS_DEBUG
)

49 
	`dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
õi
);

51  
decoded
;

52 
	}
}

54 
	$decode_u8_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
)

56 
decoded
 = 0;

57 
uöt8_t
 *
buf„r
 = &
vÆue
;

58 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
 = *
buf„r
 & 0x1;

59 
decoded
++;

60 #i‡
	`deföed
 (
NAS_DEBUG
)

61 
	`dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
õi
);

63  
decoded
;

64 
	}
}

66 
	$ícode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

68 
uöt8_t
 
ícoded
 = 0;

70 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_MINIMUM_LENGTH
, 
Àn
);

71 #i‡
	`deföed
 (
NAS_DEBUG
)

72 
	`dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
õi
);

74 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

75 (*
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
 & 0x1);

76 
ícoded
++;

77  
ícoded
;

78 
	}
}

80 
uöt8_t
 
	$ícode_u8_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
)

82 
uöt8_t
 
buf„rRëu∫
;

83 
uöt8_t
 *
buf„r
 = &
buf„rRëu∫
;

84 
uöt8_t
 
ícoded
 = 0;

85 
uöt8_t
 
õi
 = 0;

86 
	`dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 0);

87 *(
buf„r
 + 
ícoded
Ë0x00 | (
õi
 & 0xf0) |

88 (*
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
 & 0x1);

89 
ícoded
++;

91  
buf„rRëu∫
;

92 
	}
}

94 
	$dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
)

96 
	`¥ötf
("<Ue Radio Capability Information Update Needed>\n");

97 i‡(
õi
 > 0)

99 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

100 
	`¥ötf
(" <URC upd>%u</URC upd>\n", *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
);

101 
	`¥ötf
("</Ue Radio Capability Information Update Needed>\n");

102 
	}
}

	@src/ies/UeRadioCapabilityInformationUpdateNeeded.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_H_


36 
	#UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_H_


	)

38 
	#UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_MINIMUM_LENGTH
 1

	)

39 
	#UE_RADIO_CAPABILITY_INFORMATION_UPDATE_NEEDED_MAXIMUM_LENGTH
 1

	)

41 
uöt8_t
 
	tUeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
;

43 
ícode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

45 
dump_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded_xml
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
);

47 
uöt8_t
 
ícode_u8_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
);

49 
decode_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

51 
decode_u8_ue_ødio_ˇ∑bûôy_öf‹m©i⁄_upd©e_√eded
(
UeRadioC≠abûôyInf‹m©i⁄Upd©eNìded
 *
uîadioˇ∑bûôyöf‹m©i⁄upd©íìded
, 
uöt8_t
 
õi
, uöt8_à
vÆue
, 
uöt32_t
 
Àn
);

	@src/ies/UeSecurityCapability.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

32 
	~<°rög.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"UeSecurôyC≠abûôy.h
"

39 
	$decode_ue_£curôy_ˇ∑bûôy
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
decoded
 = 0;

42 
uöt8_t
 
õÀn
 = 0;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
	`mem£t
(
ue£curôyˇ∑bûôy
, 0, (
UeSecurôyC≠abûôy
));

49 
õÀn
 = *(
buf„r
 + 
decoded
);

50 
decoded
++;

51 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

52 
ue£curôyˇ∑bûôy
->
ìa
 = *(
buf„r
 + 
decoded
);

53 
decoded
++;

54 
ue£curôyˇ∑bûôy
->
eü
 = *(
buf„r
 + 
decoded
);

55 
decoded
++;

56 i‡(
Àn
 >
decoded
 + 3) {

57 
ue£curôyˇ∑bûôy
->
umts_¥e£¡
 = 1;

58 
ue£curôyˇ∑bûôy
->
uó
 = *(
buf„r
 + 
decoded
);

59 
decoded
++;

60 
ue£curôyˇ∑bûôy
->
uü
 = *(
buf„r
 + 
decoded
) & 0x7f;

61 
decoded
++;

62 i‡(
Àn
 =
decoded
 + 4) {

63 
ue£curôyˇ∑bûôy
->
g¥s_¥e£¡
 = 1;

64 
ue£curôyˇ∑bûôy
->
gó
 = *(
buf„r
 + 
decoded
) & 0x7f;

65 
decoded
++;

68 #i‡
	`deföed
 (
NAS_DEBUG
)

69 
	`dump_ue_£curôy_ˇ∑bûôy_xml
(
ue£curôyˇ∑bûôy
, 
õi
);

71  
decoded
;

72 
	}
}

73 
	$ícode_ue_£curôy_ˇ∑bûôy
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

75 
uöt8_t
 *
ÀnPå
;

76 
uöt32_t
 
ícoded
 = 0;

78 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
UE_SECURITY_CAPABILITY_MINIMUM_LENGTH
, 
Àn
);

79 #i‡
	`deföed
 (
NAS_DEBUG
)

80 
	`dump_ue_£curôy_ˇ∑bûôy_xml
(
ue£curôyˇ∑bûôy
, 
õi
);

82 i‡(
õi
 > 0)

84 *
buf„r
 = 
õi
;

85 
ícoded
++;

87 
ÀnPå
 = (
buf„r
 + 
ícoded
);

88 
ícoded
 ++;

89 *(
buf„r
 + 
ícoded
Ë
ue£curôyˇ∑bûôy
->
ìa
;

90 
ícoded
++;

91 *(
buf„r
 + 
ícoded
Ë
ue£curôyˇ∑bûôy
->
eü
;

92 
ícoded
++;

93 i‡(
ue£curôyˇ∑bûôy
->
umts_¥e£¡
) {

94 *(
buf„r
 + 
ícoded
Ë
ue£curôyˇ∑bûôy
->
uó
;

95 
ícoded
++;

96 *(
buf„r
 + 
ícoded
) = 0x00 |

97 (
ue£curôyˇ∑bûôy
->
uü
 & 0x7f);

98 
ícoded
++;

101 *(
buf„r
 + 
ícoded
) = 0x00 | 0x60;

103 
ícoded
++;

106 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

107  
ícoded
;

108 
	}
}

110 
	$dump_ue_£curôy_ˇ∑bûôy_xml
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
)

112 
	`¥ötf
("<Ue Security Capability>\n");

113 i‡(
õi
 > 0)

115 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

116 
	`¥ötf
(" <EEA>%u</EEA>\n", 
ue£curôyˇ∑bûôy
->
ìa
);

117 
	`¥ötf
(" <EIA>%u</EIA>\n", 
ue£curôyˇ∑bûôy
->
eü
);

118 i‡(
ue£curôyˇ∑bûôy
->
umts_¥e£¡
 == 1) {

119 
	`¥ötf
(" <UEA>%u</UEA>\n", 
ue£curôyˇ∑bûôy
->
uó
);

120 
	`¥ötf
(" <UIA>%u</UIA>\n", 
ue£curôyˇ∑bûôy
->
uü
);

122 i‡(
ue£curôyˇ∑bûôy
->
g¥s_¥e£¡
 == 1) {

123 
	`¥ötf
(" <GEA>%u</GEA>\n", 
ue£curôyˇ∑bûôy
->
gó
);

125 
	`¥ötf
("</Ue Security Capability>\n");

126 
	}
}

	@src/ies/UeSecurityCapability.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
UE_SECURITY_CAPABILITY_H_


36 
	#UE_SECURITY_CAPABILITY_H_


	)

38 
	#UE_SECURITY_CAPABILITY_MINIMUM_LENGTH
 2

	)

39 
	#UE_SECURITY_CAPABILITY_MAXIMUM_LENGTH
 7

	)

41 
	sUeSecurôyC≠abûôy_èg
 {

43 
	#UE_SECURITY_CAPABILITY_EEA0
 0b10000000

	)

44 
	#UE_SECURITY_CAPABILITY_EEA1
 0b01000000

	)

45 
	#UE_SECURITY_CAPABILITY_EEA2
 0b00100000

	)

46 
	#UE_SECURITY_CAPABILITY_EEA3
 0b00010000

	)

47 
	#UE_SECURITY_CAPABILITY_EEA4
 0b00001000

	)

48 
	#UE_SECURITY_CAPABILITY_EEA5
 0b00000100

	)

49 
	#UE_SECURITY_CAPABILITY_EEA6
 0b00000010

	)

50 
	#UE_SECURITY_CAPABILITY_EEA7
 0b00000001

	)

51 
uöt8_t
 
	mìa
;

53 
	#UE_SECURITY_CAPABILITY_EIA0
 0b10000000

	)

54 
	#UE_SECURITY_CAPABILITY_EIA1
 0b01000000

	)

55 
	#UE_SECURITY_CAPABILITY_EIA2
 0b00100000

	)

56 
	#UE_SECURITY_CAPABILITY_EIA3
 0b00010000

	)

57 
	#UE_SECURITY_CAPABILITY_EIA4
 0b00001000

	)

58 
	#UE_SECURITY_CAPABILITY_EIA5
 0b00000100

	)

59 
	#UE_SECURITY_CAPABILITY_EIA6
 0b00000010

	)

60 
	#UE_SECURITY_CAPABILITY_EIA7
 0b00000001

	)

61 
uöt8_t
 
	meü
;

62 
uöt8_t
 
	mumts_¥e£¡
;

63 
uöt8_t
 
	mg¥s_¥e£¡
;

65 
	#UE_SECURITY_CAPABILITY_UEA0
 0b10000000

	)

66 
	#UE_SECURITY_CAPABILITY_UEA1
 0b01000000

	)

67 
	#UE_SECURITY_CAPABILITY_UEA2
 0b00100000

	)

68 
	#UE_SECURITY_CAPABILITY_UEA3
 0b00010000

	)

69 
	#UE_SECURITY_CAPABILITY_UEA4
 0b00001000

	)

70 
	#UE_SECURITY_CAPABILITY_UEA5
 0b00000100

	)

71 
	#UE_SECURITY_CAPABILITY_UEA6
 0b00000010

	)

72 
	#UE_SECURITY_CAPABILITY_UEA7
 0b00000001

	)

73 
uöt8_t
 
	muó
;

75 
	#UE_SECURITY_CAPABILITY_UIA1
 0b01000000

	)

76 
	#UE_SECURITY_CAPABILITY_UIA2
 0b00100000

	)

77 
	#UE_SECURITY_CAPABILITY_UIA3
 0b00010000

	)

78 
	#UE_SECURITY_CAPABILITY_UIA4
 0b00001000

	)

79 
	#UE_SECURITY_CAPABILITY_UIA5
 0b00000100

	)

80 
	#UE_SECURITY_CAPABILITY_UIA6
 0b00000010

	)

81 
	#UE_SECURITY_CAPABILITY_UIA7
 0b00000001

	)

82 
uöt8_t
 
	muü
:7;

84 
	#UE_SECURITY_CAPABILITY_GEA1
 0b01000000

	)

85 
	#UE_SECURITY_CAPABILITY_GEA2
 0b00100000

	)

86 
	#UE_SECURITY_CAPABILITY_GEA3
 0b00010000

	)

87 
	#UE_SECURITY_CAPABILITY_GEA4
 0b00001000

	)

88 
	#UE_SECURITY_CAPABILITY_GEA5
 0b00000100

	)

89 
	#UE_SECURITY_CAPABILITY_GEA6
 0b00000010

	)

90 
	#UE_SECURITY_CAPABILITY_GEA7
 0b00000001

	)

91 
uöt8_t
 
	mgó
:7;

92 } 
	tUeSecurôyC≠abûôy
;

94 
ícode_ue_£curôy_ˇ∑bûôy
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

96 
decode_ue_£curôy_ˇ∑bûôy
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

98 
dump_ue_£curôy_ˇ∑bûôy_xml
(
UeSecurôyC≠abûôy
 *
ue£curôyˇ∑bûôy
, 
uöt8_t
 
õi
);

	@src/ies/VoiceDomainPreferenceAndUeUsageSetting.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

32 
	~<°rög.h
>

35 
	~"TLVEncodî.h
"

36 
	~"TLVDecodî.h
"

37 
	~"Voi˚DomaöPª„ªn˚AndUeUßgeSëtög.h
"

39 
	$decode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

41 
decoded
 = 0;

42 
uöt8_t
 
õÀn
 = 0;

43 i‡(
õi
 > 0)

45 
	`CHECK_IEI_DECODER
(
õi
, *
buf„r
);

46 
decoded
++;

48 
	`mem£t
(
voi˚domaö¥e„ªn˚™dueußge£âög
, 0, (
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
));

49 
õÀn
 = *(
buf„r
 + 
decoded
);

50 
decoded
++;

51 
	`CHECK_LENGTH_DECODER
(
Àn
 - 
decoded
, 
õÀn
);

53 
voi˚domaö¥e„ªn˚™dueußge£âög
->
ue_ußge_£âög
 = (*(
buf„r
 + 
decoded
) >> 2) & 0x1;

54 
voi˚domaö¥e„ªn˚™dueußge£âög
->
voi˚_domaö_f‹_euå™
 = *(
buf„r
 + 
decoded
) & 0x3;

55 
decoded
++;

57 #i‡
	`deföed
 (
NAS_DEBUG
)

58 
	`dump_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög_xml
(
voi˚domaö¥e„ªn˚™dueußge£âög
, 
õi
);

60  
decoded
;

61 
	}
}

62 
	$ícode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
)

64 
uöt8_t
 *
ÀnPå
;

65 
uöt32_t
 
ícoded
 = 0;

67 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_MINIMUM_LENGTH
, 
Àn
);

68 #i‡
	`deföed
 (
NAS_DEBUG
)

69 
	`dump_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög_xml
(
voi˚domaö¥e„ªn˚™dueußge£âög
, 
õi
);

71 i‡(
õi
 > 0)

73 *
buf„r
 = 
õi
;

74 
ícoded
++;

76 
ÀnPå
 = (
buf„r
 + 
ícoded
);

77 
ícoded
 ++;

78 *(
buf„r
 + 
ícoded
) = 0x00 |

79 (
voi˚domaö¥e„ªn˚™dueußge£âög
->
ue_ußge_£âög
 << 2) |

80 
voi˚domaö¥e„ªn˚™dueußge£âög
->
voi˚_domaö_f‹_euå™
;

81 
ícoded
++;

83 *
ÀnPå
 = 
ícoded
 - 1 - ((
õi
 > 0) ? 1 : 0);

84  
ícoded
;

85 
	}
}

87 
	$dump_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög_xml
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
)

89 
	`¥ötf
("<Voice domainÖreferenceánd UE usage setting>\n");

90 i‡(
õi
 > 0)

92 
	`¥ötf
(" <IEI>0x%X</IEI>\n", 
õi
);

93 
	`¥ötf
(" <UE_USAGE_SETTING>%u</UE_USAGE_SETTING>\n", 
voi˚domaö¥e„ªn˚™dueußge£âög
->
ue_ußge_£âög
);

94 
	`¥ötf
(" <VOICE_DOMAIN_FOR_EUTRAN>%u</VOICE_DOMAIN_FOR_EUTRAN>\n", 
voi˚domaö¥e„ªn˚™dueußge£âög
->
voi˚_domaö_f‹_euå™
);

95 
	`¥ötf
("</Voice domainÖreferenceánd UE usage setting>\n");

96 
	}
}

	@src/ies/VoiceDomainPreferenceAndUeUsageSetting.h

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"O˘ëSåög.h
"

35 #i‚de‡
VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_H_


36 
	#VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_H_


	)

38 
	#VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_MINIMUM_LENGTH
 1

	)

39 
	#VOICE_DOMAIN_PREFERENCE_AND_UE_USAGE_SETTING_MAXIMUM_LENGTH
 1

	)

41 
	sVoi˚DomaöPª„ªn˚AndUeUßgeSëtög_èg
 {

42 
uöt8_t
 
	m•¨e
:5;

43 
	#UE_USAGE_SETTING_VOICE_CENTRIC
 0b0

	)

44 
	#UE_USAGE_SETTING_DATA_CENTRIC
 0b1

	)

45 
uöt8_t
 
	mue_ußge_£âög
:1;

46 
	#VOICE_DOMAIN_PREFERENCE_CS_VOICE_ONLY
 0b00

	)

47 
	#VOICE_DOMAIN_PREFERENCE_IMS_PS_VOICE_ONLY
 0b01

	)

48 
	#VOICE_DOMAIN_PREFERENCE_CS_VOICE_PREFERRED_IMS_PS_VOICE_AS_SECONDARY
 0b10

	)

49 
	#VOICE_DOMAIN_PREFERENCE_IMS_PS_VOICE_PREFERRED_CS_VOICE_AS_SECONDARY
 0b11

	)

50 
uöt8_t
 
	mvoi˚_domaö_f‹_euå™
:2;

51 } 
	tVoi˚DomaöPª„ªn˚AndUeUßgeSëtög
;

53 
ícode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

55 
decode_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
, uöt8_à*
buf„r
, 
uöt32_t
 
Àn
);

57 
dump_voi˚_domaö_¥e„ªn˚_™d_ue_ußge_£âög_xml
(
Voi˚DomaöPª„ªn˚AndUeUßgeSëtög
 *
voi˚domaö¥e„ªn˚™dueußge£âög
, 
uöt8_t
 
õi
);

	@src/include/securityDef.h

45 #i‚de‡
__SECURITYDEF_H__


46 
	#__SECURITYDEF_H__


	)

55 
	#AUTH_SQN_INDEX
 0

	)

56 
	#AUTH_AMF_INDEX
 (
AUTH_SQN_INDEX
 + 
AUTH_SQN_SIZE
)

	)

57 
	#AUTH_MAC_INDEX
 (
AUTH_AMF_INDEX
 + 
AUTH_AMF_SIZE
)

	)

62 
	#AUTH_SQN_SIZE
 6

	)

63 
	#AUTH_AK_SIZE
 6

	)

64 
	#AUTH_AMF_SIZE
 2

	)

65 
	#AUTH_MAC_SIZE
 8

	)

66 
	#AUTH_AUTN_SIZE
 16

	)

68 
	#AUTH_MACS_SIZE
 8

	)

69 
	#AUTH_AUTS_SIZE
 16

	)

70 
	#AUTH_RAND_SIZE
 16

	)

71 
	#AUTH_CK_SIZE
 16

	)

72 
	#AUTH_IK_SIZE
 16

	)

73 
	#AUTH_RES_SIZE
 16

	)

74 
	#AUTH_SNID_SIZE
 3

	)

75 
	#AUTH_KASME_SIZE
 32

	)

76 
	#AUTH_KNAS_INT_SIZE
 16

	)

77 
	#AUTH_KNAS_ENC_SIZE
 16

	)

78 
	#AUTH_KENB_SIZE
 
AUTH_KASME_SIZE


	)

81 
	#AUTH_AMF_SEPARATION_BIT
(
a
Ë(◊Ë& 0x80)

	)

92 
uöt8_t
 
	mkasme
[
AUTH_KASME_SIZE
];

94 
uöt8_t
 
	mønd
[
AUTH_RAND_SIZE
];

96 
uöt8_t
 
	mauä
[
AUTH_AUTN_SIZE
];

98 
	#AUTH_XRES_SIZE
 
AUTH_RES_SIZE


	)

99 
uöt8_t
 
	mxªs_size
;

100 
uöt8_t
 
	mxªs
[
AUTH_XRES_SIZE
];

101 } 
	tauth_ve˘‹_t
;

	@src/include/userDef.h

45 #i‚de‡
__USERDEF_H__


46 
	#__USERDEF_H__


	)

48 
	~<°döt.h
>

58 
	#USER_NVRAM_FILENAME
 ".ue.nvøm"

	)

64 
	#USER_NVRAM_DIRNAME
 "NVRAM_DIR"

	)

77 
	#USER_IMEI_SIZE
 15

	)

78 
	mIMEI
[
USER_IMEI_SIZE
+1];

80 
	#USER_MANUFACTURER_SIZE
 16

	)

81 
	mm™uÁ˘uªr
[
USER_MANUFACTURER_SIZE
+1];

83 
	#USER_MODEL_SIZE
 16

	)

84 
	mmodñ
[
USER_MODEL_SIZE
+1];

86 
	#USER_PIN_SIZE
 4

	)

87 
	mPIN
[
USER_PIN_SIZE
+1];

88 } 
	tu£r_nvd©a_t
;

	@src/nas_network.c

46 
	~"«s_√tw‹k.h
"

47 
	~"comm⁄Def.h
"

48 
	~"«s_log.h
"

49 
	~"«s_timî.h
"

51 
	~"as_mesßge.h
"

52 
	~"«s_¥oc.h
"

80 #i‡
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

81 
	$«s_√tw‹k_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
)

83 
	$«s_√tw‹k_öôülize
()

86 
LOG_FUNC_IN
;

88 #ifde‡
NAS_MME


90 #i‡
	`deföed
(
EPC_BUILD
)

91 
	`«s_timî_öô
();

92 
	`«s_¥oc_öôülize
(
mme_c⁄fig_p
);

94 
	`«s_¥oc_öôülize
();

98 
LOG_FUNC_OUT
;

99 
	}
}

115 
	$«s_√tw‹k_˛ónup
()

117 
LOG_FUNC_IN
;

119 
	`«s_¥oc_˛ónup
();

121 
LOG_FUNC_OUT
;

122 
	}
}

142 
	$«s_√tw‹k_¥o˚ss_d©a
(
msg_id
, c⁄° *
d©a
)

144 
LOG_FUNC_IN
;

146 c⁄° 
as_mesßge_t
 *
msg
 = (as_mesßge_à*)(
d©a
);

147 
rc
 = 
RETURNok
;

150 i‡(
msg_id
 !
msg
->
msgID
) {

151 
	`LOG_TRACE
(
ERROR
, "NET-MAIN - Message identifier 0x%xÅoÖrocess "

153 
msg_id
, 
msg
->
msgID
);

154 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

157 
msg_id
) {

158 #ifde‡
NAS_UE


159 
AS_BROADCAST_INFO_IND
:

162 
AS_CELL_INFO_CNF
: {

164 c⁄° 
˚Œ_öfo_˙f_t
 *
öfo
 = &
msg
->msg.
˚Œ_öfo_˙f
;

165 
˚Œ_found
 = (
öfo
->
îrCode
 =
AS_SUCCESS
);

166 
rc
 = 
	`«s_¥oc_˚Œ_öfo
(
˚Œ_found
, 
öfo
->
èc
,

167 
öfo
->
˚ŒID
, info->
øt
,

168 
öfo
->
r§p
, info->
r§q
);

172 
AS_CELL_INFO_IND
:

175 
AS_PAGING_IND
:

178 
AS_NAS_ESTABLISH_CNF
: {

180 c⁄° 
«s_e°ablish_˙f_t
 *
c⁄fúm
 = &
msg
->msg.
«s_e°ablish_˙f
;

181 i‡–(
c⁄fúm
->
îrCode
 =
AS_SUCCESS
) ||

182 (
c⁄fúm
->
îrCode
 =
AS_TERMINATED_NAS
) ) {

183 
rc
 = 
	`«s_¥oc_e°ablish_˙f
(
c⁄fúm
->
«sMsg
.
d©a
,

184 
c⁄fúm
->
«sMsg
.
Àngth
);

186 
	`LOG_TRACE
(
WARNING
, "NET-MAIN - "

188 
rc
 = 
	`«s_¥oc_e°ablish_ªj
();

193 
AS_NAS_RELEASE_IND
:

195 
rc
 = 
	`«s_¥oc_ªÀa£_öd
(
msg
->msg.
«s_ªÀa£_öd
.
ˇu£
);

198 
AS_UL_INFO_TRANSFER_CNF
:

200 i‡(
msg
->msg.
ul_öfo_å™s„r_˙f
.
îrCode
 !
AS_SUCCESS
) {

201 
	`LOG_TRACE
(
WARNING
, "NET-MAIN - "

203 
rc
 = 
	`«s_¥oc_ul_å™s„r_ªj
();

205 
rc
 = 
	`«s_¥oc_ul_å™s„r_˙f
();

209 
AS_DL_INFO_TRANSFER_IND
: {

210 c⁄° 
dl_öfo_å™s„r_öd_t
 *
öfo
 = &
msg
->msg.
dl_öfo_å™s„r_öd
;

212 
rc
 = 
	`«s_¥oc_dl_å™s„r_öd
(
öfo
->
«sMsg
.
d©a
,

213 
öfo
->
«sMsg
.
Àngth
);

217 
AS_RAB_ESTABLISH_IND
:

220 
AS_RAB_RELEASE_IND
:

223 #ifde‡
NAS_MME


224 
AS_NAS_ESTABLISH_IND
: {

226 c⁄° 
«s_e°ablish_öd_t
 *
ödiˇti⁄
 = &
msg
->msg.
«s_e°ablish_öd
;

227 
rc
 = 
	`«s_¥oc_e°ablish_öd
(
ödiˇti⁄
->
UEid
,

228 
ödiˇti⁄
->
èc
,

229 
ödiˇti⁄
->
öôülNasMsg
.
d©a
,

230 
ödiˇti⁄
->
öôülNasMsg
.
Àngth
);

234 
AS_DL_INFO_TRANSFER_CNF
: {

235 c⁄° 
dl_öfo_å™s„r_˙f_t
 *
öfo
 = &
msg
->msg.
dl_öfo_å™s„r_˙f
;

237 i‡(
öfo
->
îrCode
 !
AS_SUCCESS
) {

238 
	`LOG_TRACE
(
WARNING
, "NET-MAIN - "

240 
rc
 = 
	`«s_¥oc_dl_å™s„r_ªj
(
öfo
->
UEid
);

242 
rc
 = 
	`«s_¥oc_dl_å™s„r_˙f
(
öfo
->
UEid
);

247 
AS_UL_INFO_TRANSFER_IND
: {

248 c⁄° 
ul_öfo_å™s„r_öd_t
 *
öfo
 = &
msg
->msg.
ul_öfo_å™s„r_öd
;

250 
rc
 = 
	`«s_¥oc_ul_å™s„r_öd
(
öfo
->
UEid
,

251 
öfo
->
«sMsg
.
d©a
,

252 
öfo
->
«sMsg
.
Àngth
);

256 
AS_RAB_ESTABLISH_CNF
:

261 
	`LOG_TRACE
(
ERROR
, "NET-MAIN - Unexpected AS messageÅype: 0x%x",

262 
msg_id
);

263 
rc
 = 
RETURNîr‹
;

267 
	`LOG_FUNC_RETURN
 (
rc
);

268 
	}
}

	@src/nas_network.h

46 #i‡
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

47 
	~"mme_c⁄fig.h
"

50 #i‚de‡
__NAS_NETWORK_H__


51 
	#__NAS_NETWORK_H__


	)

69 #i‡
deföed
(
EPC_BUILD
Ë&& deföed(
NAS_MME
)

70 
«s_√tw‹k_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
);

72 
«s_√tw‹k_öôülize
();

75 
«s_√tw‹k_˛ónup
();

77 
«s_√tw‹k_¥o˚ss_d©a
(
comm™d_id
, c⁄° *
d©a
);

79 c⁄° *
«s_√tw‹k_gë_d©a
();

	@src/nas_parser.c

46 
	~"«s_∑r£r.h
"

47 
	~"∑r£r.h
"

49 
	~<°dio.h
>

50 
	~<°dlib.h
>

64 #ifde‡
NAS_UE


65 
	mNAS_PARSER_UE_ID
,

67 
	mNAS_PARSER_TRACE_LEVEL
,

68 #ifde‡
NAS_UE


69 
	mNAS_PARSER_USER_HOST
,

71 
	mNAS_PARSER_NETWORK_HOST
,

72 #ifde‡
NAS_UE


73 
	mNAS_PARSER_USER_PORT
,

75 
	mNAS_PARSER_NETWORK_PORT
,

76 #ifde‡
NAS_UE


77 
	mNAS_PARSER_DEVICE_PATH
,

78 
	mNAS_PARSER_DEVICE_ATTR
,

80 
	mNAS_PARSER_NB_OPTIONS


92 
∑r£r_comm™d_löe_t
 
	g«sP¨£rComm™dLöe
 = {

94 
NAS_PARSER_NB_OPTIONS
,

96 #ifde‡
NAS_UE


99 
NAS_PARSER_DEFAULT_UE_ID


104 
NAS_PARSER_DEFAULT_TRACE_LEVEL


106 #ifde‡
NAS_UE


109 
NAS_PARSER_DEFAULT_USER_HOSTNAME


114 
NAS_PARSER_DEFAULT_NETWORK_HOSTNAME


116 #ifde‡
NAS_UE


119 
NAS_PARSER_DEFAULT_USER_PORT_NUMBER


124 
NAS_PARSER_DEFAULT_NETWORK_PORT_NUMBER


126 #ifde‡
NAS_UE


136 
©ohex
(c⁄° *
a_ch¨
);

157 
	$«s_∑r£r_¥öt_ußge
(c⁄° *
vîsi⁄
)

159 
	`∑r£r_¥öt_ußge
(&
«sP¨£rComm™dLöe
);

160 
	`Ârötf
(
°dîr
, "Vîsi⁄: %s\n", 
vîsi⁄
);

161 
	}
}

177 
	$«s_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° **
¨gv
)

179  
	`∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
, &
«sP¨£rComm™dLöe
);

180 
	}
}

196 
	$«s_∑r£r_gë_nb_›ti⁄s
()

198  
«sP¨£rComm™dLöe
.
nb_›ti⁄s
;

199 
	}
}

214 
	$«s_∑r£r_gë_åa˚_Àvñ
()

216  
	`©ohex
–
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_TRACE_LEVEL
].
pvÆue
 );

217 
	}
}

232 c⁄° *
	$«s_∑r£r_gë_√tw‹k_ho°
()

234  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_NETWORK_HOST
].
pvÆue
;

235 
	}
}

250 c⁄° *
	$«s_∑r£r_gë_√tw‹k_p‹t
()

252  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_NETWORK_PORT
].
pvÆue
;

253 
	}
}

255 #ifde‡
NAS_UE


269 
	$«s_∑r£r_gë_ueid
()

271  
	`©oi
–
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_UE_ID
].
pvÆue
 );

272 
	}
}

287 c⁄° *
	$«s_∑r£r_gë_u£r_ho°
()

289  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_USER_HOST
].
pvÆue
;

290 
	}
}

306 c⁄° *
	$«s_∑r£r_gë_u£r_p‹t
()

308  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_USER_PORT
].
pvÆue
;

309 
	}
}

324 c⁄° *
	$«s_∑r£r_gë_devi˚_∑th
()

326  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_DEVICE_PATH
].
pvÆue
;

327 
	}
}

342 c⁄° *
	$«s_∑r£r_gë_devi˚_∑øms
()

344  
«sP¨£rComm™dLöe
.
›ti⁄s
[
NAS_PARSER_DEVICE_ATTR
].
pvÆue
;

345 
	}
}

352 
	$©ohex
(c⁄° *
a_ch¨
)

354 
ªsu…
;

356 
ªsu…
=0; 
a_ch¨
;á_char++) {

357 i‡(*
a_ch¨
 >= '0' && *a_char <= '9') {

358 
ªsu…
 = (ªsu… << 4Ë+ (*
a_ch¨
 - '0');

359 } i‡(*
a_ch¨
 >= 'A' && *a_char <= 'F') {

360 
ªsu…
 = (ªsu… << 4Ë+ (*
a_ch¨
 - 'A' + 10);

361 } i‡(*
a_ch¨
 >= 'a' && *a_char <= 'f') {

362 
ªsu…
 = (ªsu… << 4Ë+ (*
a_ch¨
 - 'a' + 10);

367  
ªsu…
;

368 
	}
}

	@src/nas_parser.h

45 #i‚de‡
__NAS_PARSER_H__


46 
	#__NAS_PARSER_H__


	)

53 
	#NAS_PARSER_DEFAULT_TRACE_LEVEL
 "0"

	)

56 
	#NAS_PARSER_DEFAULT_NETWORK_HOSTNAME
 "loˇlho°"

	)

59 
	#NAS_PARSER_DEFAULT_NETWORK_PORT_NUMBER
 "12000"

	)

61 #ifde‡
NAS_UE


63 
	#NAS_PARSER_DEFAULT_UE_ID
 "1"

	)

66 
	#NAS_PARSER_DEFAULT_USER_HOSTNAME
 "loˇlho°"

	)

69 
	#NAS_PARSER_DEFAULT_USER_PORT_NUMBER
 "10000"

	)

84 
«s_∑r£r_¥öt_ußge
(c⁄° *
vîsi⁄
);

85 
«s_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° **
¨gv
);

87 
«s_∑r£r_gë_nb_›ti⁄s
();

88 
«s_∑r£r_gë_åa˚_Àvñ
();

89 c⁄° *
«s_∑r£r_gë_√tw‹k_ho°
();

90 c⁄° *
«s_∑r£r_gë_√tw‹k_p‹t
();

92 #ifde‡
NAS_UE


93 
«s_∑r£r_gë_ueid
();

94 c⁄° *
«s_∑r£r_gë_u£r_ho°
();

95 c⁄° *
«s_∑r£r_gë_u£r_p‹t
();

96 c⁄° *
«s_∑r£r_gë_devi˚_∑th
();

97 c⁄° *
«s_∑r£r_gë_devi˚_∑øms
();

	@src/nas_proc.c

46 
	~"«s_¥oc.h
"

47 
	~"«s_log.h
"

49 
	~"emm_maö.h
"

50 
	~"emm_ßp.h
"

52 
	~"esm_maö.h
"

53 
	~"esm_ßp.h
"

55 
	~<°dio.h
>

65 #ifde‡
NAS_UE


69 
	#NAS_PROC_RSRQ_UNKNOWN
 255

	)

70 
	#NAS_PROC_RSRP_UNKNOWN
 255

	)

77 
	mEPS_ˇ∑bûôy_°©us
;

79 
	mr§q
;

81 
	mr§p
;

82 } 
	g_«s_¥oc_d©a
;

84 
_«s_¥oc_a˘iv©e
(
cid
, 
≠∂y_to_Æl
);

85 
_«s_¥oc_dó˘iv©e
(
cid
, 
≠∂y_to_Æl
);

91 #ifde‡
NAS_UE


109 
	$«s_¥oc_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
emm_cb
,

110 
esm_ödiˇti⁄_ˇŒback_t
 
esm_cb
, c⁄° *
imei
)

112 
LOG_FUNC_IN
;

115 
_«s_¥oc_d©a
.
EPS_ˇ∑bûôy_°©us
 = 
FALSE
;

116 
_«s_¥oc_d©a
.
r§q
 = 
NAS_PROC_RSRQ_UNKNOWN
;

117 
_«s_¥oc_d©a
.
r§p
 = 
NAS_PROC_RSRP_UNKNOWN
;

120 
	`emm_maö_öôülize
(
emm_cb
, 
imei
);

123 
	`esm_maö_öôülize
(
esm_cb
);

125 
LOG_FUNC_OUT
;

126 
	}
}

128 #ifde‡
NAS_MME


143 #i‡
deföed
(
EPC_BUILD
)

144 
	$«s_¥oc_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
)

146 
LOG_FUNC_IN
;

149 
	`emm_maö_öôülize
(
mme_c⁄fig_p
);

152 
	`esm_maö_öôülize
();

154 
LOG_FUNC_OUT
;

155 
	}
}

157 
	$«s_¥oc_öôülize
()

159 
LOG_FUNC_IN
;

162 
	`emm_maö_öôülize
();

165 
	`esm_maö_öôülize
();

167 
LOG_FUNC_OUT
;

168 
	}
}

186 
	$«s_¥oc_˛ónup
()

188 
LOG_FUNC_IN
;

190 #ifde‡
NAS_UE


192 
rc
 = 
	`«s_¥oc_dëach
(
TRUE
);

193 i‡(
rc
 !
RETURNok
) {

194 
	`LOG_TRACE
(
ERROR
, "NAS-PROC - FailedÅo detach fromÅheÇetwork");

199 
	`emm_maö_˛ónup
();

202 
	`esm_maö_˛ónup
();

204 
LOG_FUNC_OUT
;

205 
	}
}

212 #ifde‡
NAS_UE


228 
	$«s_¥oc_íabÀ_s1_mode
()

230 
LOG_FUNC_IN
;

232 
emm_ßp_t
 
emm_ßp
;

233 
rc
;

239 
_«s_¥oc_d©a
.
EPS_ˇ∑bûôy_°©us
 = 
TRUE
;

240 
emm_ßp
.
¥imôive
 = 
EMMREG_S1_ENABLED
;

241 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

243 
	`LOG_FUNC_RETURN
 (
rc
);

244 
	}
}

261 
	$«s_¥oc_dißbÀ_s1_mode
()

263 
LOG_FUNC_IN
;

265 
emm_ßp_t
 
emm_ßp
;

266 
rc
;

272 
_«s_¥oc_d©a
.
EPS_ˇ∑bûôy_°©us
 = 
FALSE
;

273 
emm_ßp
.
¥imôive
 = 
EMMREG_S1_DISABLED
;

274 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

276 
	`LOG_FUNC_RETURN
 (
rc
);

277 
	}
}

294 
	$«s_¥oc_gë_ïs
(*
°©
)

296 
LOG_FUNC_IN
;

298 *
°©
 = 
_«s_¥oc_d©a
.
EPS_ˇ∑bûôy_°©us
;

300 
	`LOG_FUNC_RETURN
 (
RETURNok
);

301 
	}
}

317 
	$«s_¥oc_gë_imsi
(*
imsi_°r
)

319 
LOG_FUNC_IN
;

321 c⁄° 
imsi_t
 *
imsi
 = 
	`emm_maö_gë_imsi
();

323 i‡(
imsi
 !
NULL
) {

324 
off£t
 = 0;

325 
off£t
 +
	`•rötf
(
imsi_°r
 + offset, "%u%u%u%u%u",

326 
imsi
->
u
.
num
.
digô1
, imsi->u.num.
digô2
,

327 
imsi
->
u
.
num
.
digô3
, imsi->u.num.
digô4
,

328 
imsi
->
u
.
num
.
digô5
);

329 i‡(
imsi
->
u
.
num
.
digô6
 != 0xf) {

330 
off£t
 +
	`•rötf
(
imsi_°r
 + off£t, "%u", 
imsi
->
u
.
num
.
digô6
);

332 
off£t
 +
	`•rötf
(
imsi_°r
 + offset, "%u%u%u%u%u%u%u%u",

333 
imsi
->
u
.
num
.
digô7
, imsi->u.num.
digô8
,

334 
imsi
->
u
.
num
.
digô9
, imsi->u.num.
digô10
,

335 
imsi
->
u
.
num
.
digô11
, imsi->u.num.
digô12
,

336 
imsi
->
u
.
num
.
digô13
, imsi->u.num.
digô14
);

337 i‡(
imsi
->
u
.
num
.
digô15
 != 0xf) {

338 
off£t
 +
	`•rötf
(
imsi_°r
 + off£t, "%u", 
imsi
->
u
.
num
.
digô15
);

340 
	`LOG_FUNC_RETURN
 (
RETURNok
);

343 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

344 
	}
}

361 
	$«s_¥oc_gë_msisdn
(*
msisdn_°r
, *
t⁄_≈i
)

363 
LOG_FUNC_IN
;

365 c⁄° 
msisdn_t
 *
msisdn
 = 
	`emm_maö_gë_msisdn
();

367 i‡(
msisdn
 !
NULL
) {

370 
Byã_t
 
ext
:1;

371 
Byã_t
 
t⁄
:3;

372 
Byã_t
 
≈i
:4;

373 } 
ext_t⁄_≈i
;

374 
Byã_t
 
ty≥
;

375 } 
c⁄vîãr
;

376 
c⁄vîãr
.
ext_t⁄_≈i
.
ext
 = 
msisdn
->ext;

377 
c⁄vîãr
.
ext_t⁄_≈i
.
t⁄
 = 
msisdn
->ton;

378 
c⁄vîãr
.
ext_t⁄_≈i
.
≈i
 = 
msisdn
->npi;

379 *
t⁄_≈i
 = 
c⁄vîãr
.
ty≥
;

381 
	`•rötf
(
msisdn_°r
, "%u%u%u%u%u%u%u%u%u%u%u",

382 
msisdn
->
digô
[0].
msb
, msisdn->digô[0].
lsb
,

383 
msisdn
->
digô
[1].
msb
, msisdn->digô[1].
lsb
,

384 
msisdn
->
digô
[2].
msb
, msisdn->digô[2].
lsb
,

385 
msisdn
->
digô
[3].
msb
, msisdn->digô[3].
lsb
,

386 
msisdn
->
digô
[4].
msb
, msisdn->digô[4].
lsb
,

387 
msisdn
->
digô
[5].
msb
);

389 
	`LOG_FUNC_RETURN
 (
RETURNok
);

392 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

393 
	}
}

410 
	$«s_¥oc_gë_sig«l_quÆôy
(*
r§q
, *
r§p
)

412 
LOG_FUNC_IN
;

414 *
r§q
 = 
_«s_¥oc_d©a
.rsrq;

415 *
r§p
 = 
_«s_¥oc_d©a
.rsrp;

417 
	`LOG_FUNC_RETURN
 (
RETURNok
);

418 
	}
}

439 
	$«s_¥oc_ªgi°î
(
mode
, 
f‹m©
, c⁄° 
√tw‹k_∂mn_t
 *
›î
, 
AcT
)

441 
LOG_FUNC_IN
;

443 
rc
 = 
RETURNîr‹
;

448 
ödex
 = 
	`emm_maö_£t_∂mn_£À˘i⁄_mode
(
mode
, 
f‹m©
, 
›î
, 
AcT
);

449 i‡–!(
ödex
 < 0) ) {

454 
emm_ßp_t
 
emm_ßp
;

455 
emm_ßp
.
¥imôive
 = 
EMMREG_REGISTER_REQ
;

456 
emm_ßp
.
u
.
emm_ªg
.u.
ªgi°
.
ödex
 = index;

457 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

460 
	`LOG_FUNC_RETURN
 (
rc
);

461 
	}
}

477 
	$«s_¥oc_dîegi°î
()

479 
LOG_FUNC_IN
;

482 
	`LOG_TRACE
(
ERROR
, "NAS-PROC - Network deregistrationÖrocedure is "

485 
	`LOG_FUNC_RETURN
 (
RETURNok
);

486 
	}
}

507 
	$«s_¥oc_gë_ªg_d©a
(*
mode
, *
£À˘ed
, 
f‹m©
,

508 
√tw‹k_∂mn_t
 *
›î
, *
AcT
)

510 
LOG_FUNC_IN
;

513 *
mode
 = 
	`emm_maö_gë_∂mn_£À˘i⁄_mode
();

516 c⁄° *
›î_«me
 = 
	`emm_maö_gë_£À˘ed_∂mn
(
›î
, 
f‹m©
);

518 i‡(
›î_«me
 !
NULL
) {

520 *
£À˘ed
 = 
TRUE
;

522 *
AcT
 = 
	`emm_maö_gë_∂mn_øt
();

525 *
£À˘ed
 = 
FALSE
;

526 *
AcT
 = 
NET_ACCESS_UNAVAILABLE
;

529 
	`LOG_FUNC_RETURN
 (
RETURNok
);

530 
	}
}

546 
	$«s_¥oc_gë_›î_li°
(c⁄° **
›î_li°
)

548 
LOG_FUNC_IN
;

550 
size
 = 
	`emm_maö_gë_∂mn_li°
(
›î_li°
);

552 
	`LOG_FUNC_RETURN
 (
size
);

553 
	}
}

571 
	$«s_¥oc_gë_ªg_°©us
(*
°©
)

573 
LOG_FUNC_IN
;

575 *
°©
 = 
	`emm_maö_gë_∂mn_°©us
();

577 
	`LOG_FUNC_RETURN
 (
RETURNok
);

578 
	}
}

599 
	$«s_¥oc_gë_loc_öfo
(*
èc
, *
ci
, *
AcT
)

601 
LOG_FUNC_IN
;

603 
	`•rötf
(
èc
, "%.4x", 
	`emm_maö_gë_∂mn_èc
());

604 
	`•rötf
(
ci
, "%.8x", 
	`emm_maö_gë_∂mn_ci
());

605 *
AcT
 = 
	`emm_maö_gë_∂mn_øt
();

607 
	`LOG_FUNC_RETURN
 (
RETURNok
);

608 
	}
}

624 
	$«s_¥oc_dëach
(
swôch_off
)

626 
LOG_FUNC_IN
;

628 
emm_ßp_t
 
emm_ßp
;

629 
rc
 = 
RETURNok
;

631 i‡–
	`emm_maö_is_©èched
() ) {

633 
emm_ßp
.
¥imôive
 = 
EMMREG_DETACH_INIT
;

634 
emm_ßp
.
u
.
emm_ªg
.u.
dëach
.
swôch_off
 = switch_off;

635 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

638 
	`LOG_FUNC_RETURN
 (
rc
);

639 
	}
}

655 
	$«s_¥oc_©èch
()

657 
LOG_FUNC_IN
;

659 
emm_ßp_t
 
emm_ßp
;

660 
rc
 = 
RETURNok
;

662 i‡–!
	`emm_maö_is_©èched
() ) {

664 
emm_ßp
.
¥imôive
 = 
EMMREG_ATTACH_INIT
;

665 
emm_ßp
.
u
.
emm_ªg
.u.
©èch
.
is_emîgícy
 = 
FALSE
;

666 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

669 
	`LOG_FUNC_RETURN
 (
rc
);

670 
	}
}

687 
	$«s_¥oc_gë_©èch_°©us
()

689 
LOG_FUNC_IN
;

691 
is_©èched
 = 
	`emm_maö_is_©èched
();

693 
	`LOG_FUNC_RETURN
 (
is_©èched
);

694 
	}
}

710 
	$«s_¥oc_gë_pdn_ønge
()

712 
LOG_FUNC_IN
;

714 
max_pdn_id
 = 
	`esm_maö_gë_nb_pdns_max
();

716 
	`LOG_FUNC_RETURN
 (
max_pdn_id
);

717 
	}
}

735 
	$«s_¥oc_gë_pdn_°©us
(*
cids
, *
°©es
, 
n_pdn_max
)

737 
LOG_FUNC_IN
;

739 
cid
;

740 
n_deföed_pdn
 = 0;

743 
n_pdn
 = 
	`esm_maö_gë_nb_pdns_max
();

746 
cid
 = 1; (cid < 
n_pdn
+1Ë&& (
n_deföed_pdn
 < 
n_pdn_max
); cid++) {

748 
°©e
 = 
FALSE
;

749 
is_deföed
 = 
	`esm_maö_gë_pdn_°©us
(
cid
, &
°©e
);

750 i‡(
is_deföed
 !
FALSE
) {

752 *(
cids
++Ë
cid
;

753 *(
°©es
++Ë
°©e
;

754 
n_deföed_pdn
 += 1;

758 
	`LOG_FUNC_RETURN
 (
n_deföed_pdn
);

759 
	}
}

778 
	$«s_¥oc_gë_pdn_∑øm
(*
cids
, *
ty≥s
, c⁄° **
≠ns
,

779 
n_pdn_max
)

781 
LOG_FUNC_IN
;

783 
cid
;

784 
n_deföed_pdn
 = 0;

787 
n_pdn
 = 
	`esm_maö_gë_nb_pdns_max
();

790 
cid
 = 1; (cid < 
n_pdn
+1Ë&& (
n_deföed_pdn
 < 
n_pdn_max
); cid++) {

791 
emîgícy
, 
a˘ive
;

793 
rc
 = 
	`esm_maö_gë_pdn
(
cid
, 
ty≥s
, 
≠ns
, &
emîgícy
, &
a˘ive
);

794 i‡(
rc
 !
RETURNîr‹
) {

796 *(
cids
++Ë
cid
;

797 
ty≥s
++;

798 
≠ns
++;

799 
n_deföed_pdn
 += 1;

803 
	`LOG_FUNC_RETURN
 (
n_deföed_pdn
);

804 
	}
}

829 
	$«s_¥oc_gë_pdn_addr
(
cid
, *
cids
, c⁄° **
addr1
,

830 c⁄° **
addr2
, 
n_pdn_max
)

832 
LOG_FUNC_IN
;

834 
rc
;

835 
n_deföed_pdn
 = 0;

837 i‡(
cid
 > 0) {

839 
rc
 = 
	`esm_maö_gë_pdn_addr
(
cid
, 
addr1
, 
addr2
);

840 i‡(
rc
 !
RETURNîr‹
) {

841 *
cids
 = 
cid
;

842 
n_deföed_pdn
 = 1;

844 } i‡(
cid
 < 0) {

846 
n_pdn
 = 
	`esm_maö_gë_nb_pdns_max
();

849 
cid
 = 1; (cid < 
n_pdn
+1Ë&& (
n_deföed_pdn
 < 
n_pdn_max
); cid++) {

851 
rc
 = 
	`esm_maö_gë_pdn_addr
(
cid
, 
addr1
, 
addr2
);

852 i‡(
rc
 !
RETURNîr‹
) {

854 *(
cids
++Ë
cid
;

855 
addr1
++;

856 
addr2
++;

857 
n_deföed_pdn
 += 1;

865 
	`LOG_FUNC_RETURN
 (
n_deföed_pdn
);

866 
	}
}

890 
	$«s_¥oc_£t_pdn
(
cid
, 
ty≥
, c⁄° *
≠n
, 
ùv4_addr
,

891 
emîgícy
, 
p_cscf
, 
im_˙_sig«l
)

893 
LOG_FUNC_IN
;

895 
rc
;

897 
esm_ßp_t
 
esm_ßp
;

898 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REQ
;

899 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

900 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_deföed
 = 
FALSE
;

901 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
cid
 = cid;

902 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
pdn_ty≥
 = 
ty≥
;

903 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
≠n
 =ápn;

904 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_emîgícy
 = 
emîgícy
;

909 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

911 
	`LOG_FUNC_RETURN
 (
rc
);

912 
	}
}

928 
	$«s_¥oc_ª£t_pdn
(
cid
)

930 
LOG_FUNC_IN
;

932 
rc
;

934 
esm_ßp_t
 
esm_ßp
;

935 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REJ
;

936 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

937 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_deföed
 = 
TRUE
;

938 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
cid
 = cid;

942 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

943 
	`LOG_FUNC_RETURN
 (
rc
);

944 
	}
}

962 
	$«s_¥oc_dó˘iv©e_pdn
(
cid
)

964 
LOG_FUNC_IN
;

966 
rc
 = 
RETURNok
;

968 i‡(
cid
 > 0) {

970 
rc
 = 
	`_«s_¥oc_dó˘iv©e
(
cid
, 
FALSE
);

974 
cid
 = 2;

976 (
rc
 !
RETURNîr‹
Ë&& (
cid
 < 
	`esm_maö_gë_nb_pdns_max
()+1)) {

977 
rc
 = 
	`_«s_¥oc_dó˘iv©e
(
cid
++, 
TRUE
);

981 
	`LOG_FUNC_RETURN
 (
rc
);

982 
	}
}

1000 
	$«s_¥oc_a˘iv©e_pdn
(
cid
)

1002 
LOG_FUNC_IN
;

1004 
rc
 = 
RETURNok
;

1006 i‡–!
	`emm_maö_is_©èched
() ) {

1011 
	`LOG_TRACE
(
WARNING
, "NAS-PROC - UE isÇotáttachedÅoÅheÇetwork");

1012 
rc
 = 
	`«s_¥oc_©èch
();

1013 } i‡(
	`emm_maö_is_emîgícy
()) {

1016 
	`LOG_TRACE
(
WARNING
,"NAS-PROC - Attached forÉmergency bearer services");

1017 
rc
 = 
RETURNîr‹
;

1020 i‡(
rc
 !
RETURNîr‹
) {

1021 i‡(
cid
 > 0) {

1023 
rc
 = 
	`_«s_¥oc_a˘iv©e
(
cid
, 
FALSE
);

1025 
cid
 = 1;

1027 (
rc
 !
RETURNîr‹
Ë&& (
cid
 < 
	`esm_maö_gë_nb_pdns_max
()+1)) {

1028 
rc
 = 
	`_«s_¥oc_a˘iv©e
(
cid
++, 
TRUE
);

1033 
	`LOG_FUNC_RETURN
 (
rc
);

1034 
	}
}

1066 
	$«s_¥oc_˚Œ_öfo
(
found
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
AcT
,

1067 
UI¡8_t
 
r§q
, UI¡8_à
r§p
)

1069 
LOG_FUNC_IN
;

1071 
emm_ßp_t
 
emm_ßp
;

1072 
rc
;

1075 
_«s_¥oc_d©a
.
r§q
 =Ñsrq;

1076 
_«s_¥oc_d©a
.
r§p
 =Ñsrp;

1082 
emm_ßp
.
¥imôive
 = 
EMMAS_CELL_INFO_RES
;

1083 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
found
 = found;

1084 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
∂mnIDs
.
n_∂mns
 = 0;

1085 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
øt
 = 
AcT
;

1086 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
èc
 =Åac;

1087 
emm_ßp
.
u
.
emm_as
.u.
˚Œ_öfo
.
˚ŒID
 = 
ci
;

1089 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1091 
	`LOG_FUNC_RETURN
 (
rc
);

1092 
	}
}

1111 
	$«s_¥oc_e°ablish_˙f
(c⁄° 
Byã_t
 *
d©a
, 
UI¡32_t
 
Àn
)

1113 
LOG_FUNC_IN
;

1115 
emm_ßp_t
 
emm_ßp
;

1116 
rc
;

1123 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_CNF
;

1124 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
Àngth
 = 
Àn
;

1125 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
vÆue
 = (
uöt8_t
 *)
d©a
;

1126 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1128 
	`LOG_FUNC_RETURN
 (
rc
);

1129 
	}
}

1148 
	$«s_¥oc_e°ablish_ªj
()

1150 
LOG_FUNC_IN
;

1152 
emm_ßp_t
 
emm_ßp
;

1153 
rc
;

1160 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_REJ
;

1161 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1163 
	`LOG_FUNC_RETURN
 (
rc
);

1164 
	}
}

1181 
	$«s_¥oc_ªÀa£_öd
(
ˇu£
)

1183 
LOG_FUNC_IN
;

1185 
emm_ßp_t
 
emm_ßp
;

1186 
rc
;

1192 
emm_ßp
.
¥imôive
 = 
EMMAS_RELEASE_IND
;

1193 
emm_ßp
.
u
.
emm_as
.u.
ªÀa£
.
ˇu£
 = cause;

1194 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1196 
	`LOG_FUNC_RETURN
 (
rc
);

1197 
	}
}

1215 
	$«s_¥oc_ul_å™s„r_˙f
()

1217 
LOG_FUNC_IN
;

1219 
emm_ßp_t
 
emm_ßp
;

1220 
rc
;

1227 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1228 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = 0;

1229 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
TRUE
;

1230 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 0;

1231 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1233 
	`LOG_FUNC_RETURN
 (
rc
);

1234 
	}
}

1252 
	$«s_¥oc_ul_å™s„r_ªj
()

1254 
LOG_FUNC_IN
;

1256 
emm_ßp_t
 
emm_ßp
;

1257 
rc
;

1264 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1265 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = 0;

1266 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
FALSE
;

1267 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 0;

1268 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1270 
	`LOG_FUNC_RETURN
 (
rc
);

1271 
	}
}

1289 
	$«s_¥oc_dl_å™s„r_öd
(c⁄° 
Byã_t
 *
d©a
, 
UI¡32_t
 
Àn
)

1291 
LOG_FUNC_IN
;

1293 
rc
 = 
RETURNîr‹
;

1295 i‡(
Àn
 > 0) {

1296 
emm_ßp_t
 
emm_ßp
;

1301 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1302 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = 0;

1303 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
TRUE
;

1304 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 
Àn
;

1305 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
vÆue
 = (
uöt8_t
 *)data;

1306 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1309 
	`LOG_FUNC_RETURN
 (
rc
);

1310 
	}
}

1313 #ifde‡
NAS_MME


1334 
	$«s_¥oc_e°ablish_öd
(
UI¡32_t
 
ueid
, 
èc_t
 
èc
,

1335 c⁄° 
Byã_t
 *
d©a
, 
UI¡32_t
 
Àn
)

1337 
LOG_FUNC_IN
;

1339 
rc
 = 
RETURNîr‹
;

1341 i‡(
Àn
 > 0) {

1342 
emm_ßp_t
 
emm_ßp
;

1348 
emm_ßp
.
¥imôive
 = 
EMMAS_ESTABLISH_REQ
;

1349 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
ueid
 = ueid;

1350 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
Àngth
 = 
Àn
;

1351 
emm_ßp
.
u
.
emm_as
.u.
e°ablish
.
NASmsg
.
vÆue
 = (
uöt8_t
 *)
d©a
;

1352 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1355 
	`LOG_FUNC_RETURN
 (
rc
);

1356 
	}
}

1374 
	$«s_¥oc_dl_å™s„r_˙f
(
UI¡32_t
 
ueid
)

1376 
LOG_FUNC_IN
;

1378 
emm_ßp_t
 
emm_ßp
;

1379 
rc
;

1386 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1387 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = ueid;

1388 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
TRUE
;

1389 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 0;

1390 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1392 
	`LOG_FUNC_RETURN
 (
rc
);

1393 
	}
}

1411 
	$«s_¥oc_dl_å™s„r_ªj
(
UI¡32_t
 
ueid
)

1413 
LOG_FUNC_IN
;

1415 
emm_ßp_t
 
emm_ßp
;

1416 
rc
;

1423 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1424 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = ueid;

1425 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
FALSE
;

1426 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 0;

1427 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1429 
	`LOG_FUNC_RETURN
 (
rc
);

1430 
	}
}

1449 
	$«s_¥oc_ul_å™s„r_öd
(
UI¡32_t
 
ueid
, c⁄° 
Byã_t
 *
d©a
, UI¡32_à
Àn
)

1451 
rc
 = 
RETURNîr‹
;

1453 
LOG_FUNC_IN
;

1455 i‡(
Àn
 > 0) {

1456 
emm_ßp_t
 
emm_ßp
;

1461 
emm_ßp
.
¥imôive
 = 
EMMAS_DATA_IND
;

1462 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
ueid
 = ueid;

1463 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
dñivîed
 = 
TRUE
;

1464 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
Àngth
 = 
Àn
;

1465 
emm_ßp
.
u
.
emm_as
.u.
d©a
.
NASmsg
.
vÆue
 = (
uöt8_t
 *)data;

1466 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1469 
	`LOG_FUNC_RETURN
 (
rc
);

1470 
	}
}

1472 #i‡
deföed
(
EPC_BUILD
)

1473 
	$«s_¥oc_auth_∑øm_ªs
(
emm_˙_auth_ªs_t
 *
emm_˙_auth_ªs
)

1475 
rc
 = 
RETURNîr‹
;

1476 
emm_ßp_t
 
emm_ßp
;

1478 
LOG_FUNC_IN
;

1480 
emm_ßp
.
¥imôive
 = 
EMMCN_AUTHENTICATION_PARAM_RES
;

1481 
emm_ßp
.
u
.
emm_˙
.u.
auth_ªs
 = 
emm_˙_auth_ªs
;

1483 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1485 
	`LOG_FUNC_RETURN
 (
rc
);

1486 
	}
}

1488 
	$«s_¥oc_auth_∑øm_Áû
(
emm_˙_auth_Áû_t
 *
emm_˙_auth_Áû
)

1490 
rc
 = 
RETURNîr‹
;

1491 
emm_ßp_t
 
emm_ßp
;

1493 
LOG_FUNC_IN
;

1495 
emm_ßp
.
¥imôive
 = 
EMMCN_AUTHENTICATION_PARAM_FAIL
;

1496 
emm_ßp
.
u
.
emm_˙
.u.
auth_Áû
 = 
emm_˙_auth_Áû
;

1498 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1500 
	`LOG_FUNC_RETURN
 (
rc
);

1501 
	}
}

1503 
	$«s_¥oc_dîegi°î_ue
(
UI¡32_t
 
ue_id
)

1505 
rc
 = 
RETURNîr‹
;

1506 
emm_ßp_t
 
emm_ßp
;

1508 
LOG_FUNC_IN
;

1510 
emm_ßp
.
¥imôive
 = 
EMMCN_DEREGISTER_UE
;

1511 
emm_ßp
.
u
.
emm_˙
.u.
dîegi°î
.
UEid
 = 
ue_id
;

1513 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1515 
	`LOG_FUNC_RETURN
 (
rc
);

1516 
	}
}

1518 
	$«s_¥oc_pdn_c⁄√˘ivôy_ªs
(
emm_˙_pdn_ªs_t
 *
emm_˙_pdn_ªs
)

1520 
rc
 = 
RETURNîr‹
;

1521 
emm_ßp_t
 
emm_ßp
;

1523 
LOG_FUNC_IN
;

1525 
emm_ßp
.
¥imôive
 = 
EMMCN_PDN_CONNECTIVITY_RES
;

1526 
emm_ßp
.
u
.
emm_˙
.u.
emm_˙_pdn_ªs
 =Émm_cn_pdn_res;

1528 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1530 
	`LOG_FUNC_RETURN
 (
rc
);

1531 
	}
}

1533 
	$«s_¥oc_pdn_c⁄√˘ivôy_Áû
(
emm_˙_pdn_Áû_t
 *
emm_˙_pdn_Áû
)

1535 
rc
 = 
RETURNîr‹
;

1536 
emm_ßp_t
 
emm_ßp
;

1538 
LOG_FUNC_IN
;

1540 
emm_ßp
.
¥imôive
 = 
EMMCN_PDN_CONNECTIVITY_FAIL
;

1541 
emm_ßp
.
u
.
emm_˙
.u.
emm_˙_pdn_Áû
 =Émm_cn_pdn_fail;

1543 
rc
 = 
	`emm_ßp_£nd
(&
emm_ßp
);

1545 
	`LOG_FUNC_RETURN
 (
rc
);

1546 
	}
}

1557 #ifde‡
NAS_UE


1576 
	$_«s_¥oc_a˘iv©e
(
cid
, 
≠∂y_to_Æl
)

1578 
LOG_FUNC_IN
;

1580 
rc
;

1581 
a˘ive
 = 
FALSE
;

1583 
esm_ßp_t
 
esm_ßp
;

1586 
rc
 = 
	`esm_maö_gë_pdn
(
cid
, &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
pdn_ty≥
,

1587 &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
≠n
,

1588 &
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_emîgícy
, &
a˘ive
);

1589 i‡(
rc
 !
RETURNok
) {

1591 i‡(
≠∂y_to_Æl
) {

1593 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1596 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1599 i‡(
a˘ive
) {

1601 
	`LOG_TRACE
(
WARNING
, "NAS-PROC - PDN c⁄√˘i⁄ %d i†a˘ive", 
cid
);

1602 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1604 i‡(
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_emîgícy
) {

1605 i‡(
	`esm_maö_has_emîgícy
()) {

1610 
	`LOG_TRACE
(
WARNING
, "NAS-PROC - PDN connection forÉmergency "

1611 "bóª∏£rvi˚†i†ÆªadyÉ°ablished (cid=%d)", 
cid
);

1612 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1619 
esm_ßp
.
¥imôive
 = 
ESM_PDN_CONNECTIVITY_REQ
;

1620 
esm_ßp
.
is_°™dÆ⁄e
 = 
TRUE
;

1621 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
is_deföed
 = 
TRUE
;

1622 
esm_ßp
.
d©a
.
pdn_c⁄√˘
.
cid
 = cid;

1623 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

1625 
	`LOG_FUNC_RETURN
 (
rc
);

1626 
	}
}

1645 
	$_«s_¥oc_dó˘iv©e
(
cid
, 
≠∂y_to_Æl
)

1647 
LOG_FUNC_IN
;

1649 
rc
;

1650 
pdn_ty≥
;

1651 c⁄° *
≠n
;

1652 
emîgícy
 = 
FALSE
;

1653 
a˘ive
 = 
FALSE
;

1656 
rc
 = 
	`esm_maö_gë_pdn
(
cid
, &
pdn_ty≥
, &
≠n
, &
emîgícy
, &
a˘ive
);

1657 i‡(
rc
 !
RETURNok
) {

1659 i‡(
≠∂y_to_Æl
) {

1661 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1663 
	`LOG_FUNC_RETURN
 (
RETURNîr‹
);

1666 i‡(!
a˘ive
) {

1668 
	`LOG_TRACE
(
WARNING
, "NAS-PROC - PDN c⁄√˘i⁄ %d i†nŸá˘ive", 
cid
);

1669 
	`LOG_FUNC_RETURN
 (
RETURNok
);

1672 i‡(
	`esm_maö_gë_nb_pdns
() > 1) {

1677 
esm_ßp_t
 
esm_ßp
;

1678 
esm_ßp
.
¥imôive
 = 
ESM_PDN_DISCONNECT_REQ
;

1679 
esm_ßp
.
d©a
.
pdn_disc⁄√˘
.
cid
 = cid;

1680 
rc
 = 
	`esm_ßp_£nd
(&
esm_ßp
);

1684 
	`LOG_TRACE
(
WARNING
,"NAS-PROC - "

1686 
rc
 = 
RETURNîr‹
;

1689 
	`LOG_FUNC_RETURN
 (
rc
);

1690 
	}
}

	@src/nas_proc.h

45 #i‚de‡
__NAS_PROC_H__


46 
	#__NAS_PROC_H__


	)

48 #i‡
deföed
(
EPC_BUILD
)

49 
	~"mme_c⁄fig.h
"

50 
	~"emm_˙Def.h
"

53 
	~"comm⁄Def.h
"

54 
	~"√tw‹kDef.h
"

72 #ifde‡
NAS_UE


73 
«s_¥oc_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
emm_cb
,

74 
esm_ödiˇti⁄_ˇŒback_t
 
esm_cb
, c⁄° *
imei
);

76 #ifde‡
NAS_MME


77 #i‡
deföed
(
EPC_BUILD
)

78 
«s_¥oc_öôülize
(
mme_c⁄fig_t
 *
mme_c⁄fig_p
);

80 
«s_¥oc_öôülize
();

84 
«s_¥oc_˛ónup
();

92 #ifde‡
NAS_UE


93 
«s_¥oc_íabÀ_s1_mode
();

94 
«s_¥oc_dißbÀ_s1_mode
();

95 
«s_¥oc_gë_ïs
(*
°©
);

97 
«s_¥oc_gë_imsi
(*
imsi_°r
);

98 
«s_¥oc_gë_msisdn
(*
msisdn_°r
, *
t⁄_≈i
);

100 
«s_¥oc_gë_sig«l_quÆôy
(*
r§q
, *
r§p
);

102 
«s_¥oc_ªgi°î
(
mode
, 
f‹m©
, c⁄° 
√tw‹k_∂mn_t
 *
›î
, 
AcT
);

103 
«s_¥oc_dîegi°î
();

104 
«s_¥oc_gë_ªg_d©a
(*
mode
, *
£À˘ed
, 
f‹m©
,

105 
√tw‹k_∂mn_t
 *
›î
, *
AcT
);

106 
«s_¥oc_gë_›î_li°
(c⁄° **
›î_li°
);

108 
«s_¥oc_gë_ªg_°©us
(*
°©
);

109 
«s_¥oc_gë_loc_öfo
(*
èc
, *
ci
, *
AcT
);

111 
«s_¥oc_dëach
(
swôch_off
);

112 
«s_¥oc_©èch
();

113 
«s_¥oc_gë_©èch_°©us
();

115 
«s_¥oc_ª£t_pdn
(
cid
);

116 
«s_¥oc_£t_pdn
(
cid
, 
ty≥
, c⁄° *
≠n
, 
ùv4_addr
,

117 
emîgícy
, 
p_cscf
, 
im_˙_sig«l
);

118 
«s_¥oc_gë_pdn_ønge
();

119 
«s_¥oc_gë_pdn_°©us
(*
cids
, *
°©es
, 
n_pdn_max
);

120 
«s_¥oc_gë_pdn_∑øm
(*
cids
, *
ty≥s
, c⁄° **
≠ns
,

121 
n_pdn_max
);

122 
«s_¥oc_gë_pdn_addr
(
cid
, *
cids
, c⁄° **
addr1
,

123 c⁄° **
addr2
, 
n_addr_max
);

124 
«s_¥oc_dó˘iv©e_pdn
(
cid
);

125 
«s_¥oc_a˘iv©e_pdn
(
cid
);

134 #ifde‡
NAS_UE


135 
«s_¥oc_˚Œ_öfo
(
found
, 
èc_t
 
èc
, 
ci_t
 
ci
, 
AcT_t
 
øt
, 
UI¡8_t
 
r§p
,

136 
UI¡8_t
 
r§q
);

138 
«s_¥oc_e°ablish_˙f
(c⁄° 
Byã_t
 *
d©a
, 
UI¡32_t
 
Àn
);

139 
«s_¥oc_e°ablish_ªj
();

141 
«s_¥oc_ªÀa£_öd
(
ˇu£
);

143 
«s_¥oc_ul_å™s„r_˙f
();

144 
«s_¥oc_ul_å™s„r_ªj
();

145 
«s_¥oc_dl_å™s„r_öd
(c⁄° 
Byã_t
 *
d©a
, 
UI¡32_t
 
Àn
);

148 #ifde‡
NAS_MME


149 
«s_¥oc_e°ablish_öd
(
UI¡32_t
 
ueid
, 
èc_t
 
èc
, c⁄° 
Byã_t
 *
d©a
,

150 
UI¡32_t
 
Àn
);

152 
«s_¥oc_dl_å™s„r_˙f
(
UI¡32_t
 
ueid
);

153 
«s_¥oc_dl_å™s„r_ªj
(
UI¡32_t
 
ueid
);

154 
«s_¥oc_ul_å™s„r_öd
(
UI¡32_t
 
ueid
, c⁄° 
Byã_t
 *
d©a
, UI¡32_à
Àn
);

162 #i‡
deföed
(
NAS_MME
Ë&& deföed(
EPC_BUILD
)

163 
«s_¥oc_auth_∑øm_ªs
(
emm_˙_auth_ªs_t
 *
emm_˙_auth_ªs
);

164 
«s_¥oc_auth_∑øm_Áû
(
emm_˙_auth_Áû_t
 *
emm_˙_auth_Áû
);

165 
«s_¥oc_dîegi°î_ue
(
UI¡32_t
 
ue_id
);

166 
«s_¥oc_pdn_c⁄√˘ivôy_ªs
(
«s_pdn_c⁄√˘ivôy_r•_t
 *
«s_pdn_c⁄√˘ivôy_r•
);

167 
«s_¥oc_pdn_c⁄√˘ivôy_Áû
(
«s_pdn_c⁄√˘ivôy_Áû_t
 *
«s_pdn_c⁄√˘ivôy_Áû
);

	@src/nas_user.c

46 #ifde‡
NAS_UE


48 
	~"«s_u£r.h
"

49 
	~"u£rDef.h
"

50 
	~"«s_log.h
"

51 
	~"mem‹y.h
"

53 
	~"©_comm™d.h
"

54 
	~"©_ª•⁄£.h
"

55 
	~"©_îr‹.h
"

56 
	~"u£r_ödiˇti⁄.h
"

57 
	~"«s_¥oc.h
"

58 
	~"u£r_≠i.h
"

60 
	~<°rög.h
>

61 
	~<°dlib.h
>

76 
_«s_u£r_¥oc_cg¢
 (c⁄° 
©_comm™d_t
 *
d©a
);

77 
_«s_u£r_¥oc_cgmi
 (c⁄° 
©_comm™d_t
 *
d©a
);

78 
_«s_u£r_¥oc_cgmm
 (c⁄° 
©_comm™d_t
 *
d©a
);

79 
_«s_u£r_¥oc_cgmr
 (c⁄° 
©_comm™d_t
 *
d©a
);

80 
_«s_u£r_¥oc_cimi
 (c⁄° 
©_comm™d_t
 *
d©a
);

81 
_«s_u£r_¥oc_cfun
 (c⁄° 
©_comm™d_t
 *
d©a
);

82 
_«s_u£r_¥oc_˝ö
 (c⁄° 
©_comm™d_t
 *
d©a
);

83 
_«s_u£r_¥oc_csq
 (c⁄° 
©_comm™d_t
 *
d©a
);

84 
_«s_u£r_¥oc_˚sq
 (c⁄° 
©_comm™d_t
 *
d©a
);

85 
_«s_u£r_¥oc_c›s
 (c⁄° 
©_comm™d_t
 *
d©a
);

86 
_«s_u£r_¥oc_cg©t
 (c⁄° 
©_comm™d_t
 *
d©a
);

87 
_«s_u£r_¥oc_¸eg
 (c⁄° 
©_comm™d_t
 *
d©a
);

88 
_«s_u£r_¥oc_cgªg
 (c⁄° 
©_comm™d_t
 *
d©a
);

89 
_«s_u£r_¥oc_˚ªg
 (c⁄° 
©_comm™d_t
 *
d©a
);

90 
_«s_u£r_¥oc_cgdc⁄t
 (c⁄° 
©_comm™d_t
 *
d©a
);

91 
_«s_u£r_¥oc_cga˘
 (c⁄° 
©_comm™d_t
 *
d©a
);

92 
_«s_u£r_¥oc_cmì
 (c⁄° 
©_comm™d_t
 *
d©a
);

93 
_«s_u£r_¥oc_˛ck
 (c⁄° 
©_comm™d_t
 *
d©a
);

94 
_«s_u£r_¥oc_cg∑ddr
 (c⁄° 
©_comm™d_t
 *
d©a
);

95 
_«s_u£r_¥oc_˙um
 (c⁄° 
©_comm™d_t
 *
d©a
);

96 
_«s_u£r_¥oc_˛ac
 (c⁄° 
©_comm™d_t
 *
d©a
);

99 (*
	t_«s_u£r_¥o˚duª_t
Ë(c⁄° 
	t©_comm™d_t
 *);

101 
_«s_u£r_¥o˚duª_t
 
_«s_u£r_¥o˚duª
[
AT_COMMAND_ID_MAX
] = {

102 
NULL
,

103 
_«s_u£r_¥oc_cg¢
,

104 
_«s_u£r_¥oc_cgmi
,

105 
_«s_u£r_¥oc_cgmm
,

106 
_«s_u£r_¥oc_cgmr
,

107 
_«s_u£r_¥oc_cimi
,

108 
_«s_u£r_¥oc_cfun
,

109 
_«s_u£r_¥oc_˝ö
,

110 
_«s_u£r_¥oc_csq
,

111 
_«s_u£r_¥oc_˚sq
,

112 
_«s_u£r_¥oc_˛ac
,

113 
_«s_u£r_¥oc_cmì
,

114 
_«s_u£r_¥oc_˙um
,

115 
_«s_u£r_¥oc_˛ck
,

116 
_«s_u£r_¥oc_c›s
,

117 
_«s_u£r_¥oc_¸eg
,

118 
_«s_u£r_¥oc_cg©t
,

119 
_«s_u£r_¥oc_cgªg
,

120 
_«s_u£r_¥oc_˚ªg
,

121 
_«s_u£r_¥oc_cgdc⁄t
,

122 
_«s_u£r_¥oc_cga˘
,

123 
_«s_u£r_¥oc_cg∑ddr
,

124 
	}
};

130 
©_ª•⁄£_t
 
	g_«s_u£r_d©a
 = {};

145 
	mNAS_USER_READY
,

146 
	mNAS_USER_SIM_PIN
,

147 
	mNAS_USER_SIM_PUK
,

148 
	mNAS_USER_PH_SIM_PIN


150 } 
	t«s_u£r_sim_°©us
;

151 c⁄° *
	g_«s_u£r_sim_°©us_°r
[] = {

163 c⁄° *
	mvîsi⁄
;

165 
«s_u£r_sim_°©us
 
	msim_°©us
;

167 
	mfun
;

168 } 
	g_«s_u£r_c⁄ãxt
;

175 
u£r_nvd©a_t
 
	g_«s_u£r_nvd©a
;

197 
	$«s_u£r_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
emm_cb
,

198 
esm_ödiˇti⁄_ˇŒback_t
 
esm_cb
, c⁄° *
vîsi⁄
)

200 
LOG_FUNC_IN
;

203 *
∑th
 = 
	`mem‹y_gë_∑th
(
USER_NVRAM_DIRNAME
, 
USER_NVRAM_FILENAME
);

204 i‡(
∑th
 =
NULL
) {

205 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo get UE's dataÖathname");

210 
rc
 = 
	`mem‹y_ªad
(
∑th
, &
_«s_u£r_nvd©a
, (
u£r_nvd©a_t
));

211 i‡(
rc
 !
RETURNok
) {

212 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FaûedÅÿªad %s", 
∑th
);

214 
	`‰ì
(
∑th
);

217 
_«s_u£r_c⁄ãxt
.
vîsi⁄
 = version;

218 
_«s_u£r_c⁄ãxt
.
sim_°©us
 = 
NAS_USER_SIM_PIN
;

219 
_«s_u£r_c⁄ãxt
.
fun
 = 
AT_CFUN_FUN_DEFAULT
;

222 
	`«s_¥oc_öôülize
(
emm_cb
, 
esm_cb
, 
_«s_u£r_nvd©a
.
IMEI
);

224 
LOG_FUNC_OUT
;

225 
	}
}

240 
	$«s_u£r_ª˚ive_™d_¥o˚ss
(*
fd
, *
mesßge
)

242 
LOG_FUNC_IN
;

244 
ªt_code
;

245 
nb_comm™d
;

246 
byãs
;

247 
i
;

249 i‡(
mesßge
 !
NULL
) {

251 
byãs
 = 
	`u£r_≠i_£t_d©a
(
mesßge
);

254 
byãs
 = 
	`u£r_≠i_ªad_d©a
 (*
fd
);

255 i‡(
byãs
 =
RETURNîr‹
) {

258 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

260 
	`LOG_FUNC_RETURN
(
TRUE
);

264 i‡(
byãs
 == 0) {

266 
	`LOG_FUNC_RETURN
(
FALSE
);

270 
nb_comm™d
 = 
	`u£r_≠i_decode_d©a
 (
byãs
);

271 
i
 = 0; i < 
nb_comm™d
; i++) {

273 c⁄° *
d©a
 = 
	`u£r_≠i_gë_d©a
 (
i
);

274 i‡(
d©a
 =
NULL
) {

277 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

279 
i
);

284 
ªt_code
 = 
	`«s_u£r_¥o˚ss_d©a
 (
d©a
);

285 i‡(
ªt_code
 !
RETURNok
) {

289 
LOG_TRACE


290 (
WARNING
, "UE-MAIN - "

295 i‡(
mesßge
 =
NULL
) {

297 
byãs
 = 
	`u£r_≠i_ícode_d©a
 (
	`«s_u£r_gë_d©a
 (), 
i
 =
nb_comm™d
 - 1);

298 i‡(
byãs
 =
RETURNîr‹
) {

305 
byãs
 = 
	`u£r_≠i_£nd_d©a
 (*
fd
, bytes);

306 i‡(
byãs
 =
RETURNîr‹
) {

309 
	`LOG_TRACE
 (
ERROR
, "UE-MAIN - "

311 
	`LOG_FUNC_RETURN
(
TRUE
);

316 
	`LOG_FUNC_RETURN
(
FALSE
);

317 
	}
}

336 
	$«s_u£r_¥o˚ss_d©a
(c⁄° *
d©a
)

338 
LOG_FUNC_IN
;

340 
ªt_code
 = 
RETURNîr‹
;

342 i‡(
d©a
) {

343 c⁄° 
©_comm™d_t
 *
u£r_d©a
 = (©_comm™d_à*)(
d©a
);

344 
_«s_u£r_¥o˚duª_t
 
«s_¥o˚duª
;

346 
	`LOG_TRACE
(
INFO
, "USR-MAIN - Process %s AT command %d",

347 (
u£r_d©a
->
ty≥
 =
AT_COMMAND_ACT
) ? "action" :

348 (
u£r_d©a
->
ty≥
 =
AT_COMMAND_SET
) ? "setÖarameter" :

349 (
u£r_d©a
->
ty≥
 =
AT_COMMAND_GET
) ? "getÖarameter" :

350 (
u£r_d©a
->
ty≥
 =
AT_COMMAND_TST
) ? "testÖarameter"

351 : "unknow¿ty≥", 
u£r_d©a
->
id
);

354 
«s_¥o˚duª
 = 
_«s_u£r_¥o˚duª
[
u£r_d©a
->
id
];

355 i‡(
«s_¥o˚duª
 !
NULL
) {

356 
ªt_code
 = (*
«s_¥o˚duª
)(
u£r_d©a
);

359 
_«s_u£r_d©a
.
id
 = 
u£r_d©a
->id;

360 
_«s_u£r_d©a
.
ty≥
 = 
u£r_d©a
->type;

361 
_«s_u£r_d©a
.
mask
 = 
u£r_d©a
->mask;

362 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

363 
ªt_code
 = 
RETURNok
;

366 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - DataÅo beÖrocessed isÇull");

367 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

370 
	`LOG_FUNC_RETURN
 (
ªt_code
);

371 
	}
}

390 c⁄° *
	$«s_u£r_gë_d©a
()

392 
LOG_FUNC_IN
;

393 
	`LOG_FUNC_RETURN
 ((*Ë&
_«s_u£r_d©a
);

394 
	}
}

419 
	$_«s_u£r_¥oc_cg¢
(c⁄° 
©_comm™d_t
 *
d©a
)

421 
LOG_FUNC_IN
;

423 
ªt_code
 = 
RETURNok
;

424 
©_cg¢_ª•_t
 *
cg¢
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgsn;

425 
	`mem£t
(
cg¢
, 0, (
©_cg¢_ª•_t
));

427 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

428 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

429 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGSN_MASK
;

430 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

432 
d©a
->
ty≥
) {

433 
AT_COMMAND_ACT
:

435 
	`°∫˝y
(
cg¢
->
¢
, 
_«s_u£r_nvd©a
.
IMEI
,

436 
AT_RESPONSE_INFO_TEXT_SIZE
);

439 
AT_COMMAND_TST
:

444 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGSN commandÅype %d isÇot supported",

445 
d©a
->
ty≥
);

446 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

447 
ªt_code
 = 
RETURNîr‹
;

451 
	`LOG_FUNC_RETURN
 (
ªt_code
);

452 
	}
}

471 
	$_«s_u£r_¥oc_cgmi
(c⁄° 
©_comm™d_t
 *
d©a
)

473 
LOG_FUNC_IN
;

475 
ªt_code
 = 
RETURNok
;

476 
©_cgmi_ª•_t
 *
cgmi
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgmi;

477 
	`mem£t
(
cgmi
, 0, (
©_cgmi_ª•_t
));

479 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

480 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

481 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGMI_MASK
;

482 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

484 
d©a
->
ty≥
) {

485 
AT_COMMAND_ACT
:

487 
	`°∫˝y
(
cgmi
->
m™uÁ˘uªr
, 
_«s_u£r_nvd©a
.manufacturer,

488 
AT_RESPONSE_INFO_TEXT_SIZE
);

491 
AT_COMMAND_TST
:

496 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGMI commandÅype %d isÇot supported",

497 
d©a
->
ty≥
);

498 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

499 
ªt_code
 = 
RETURNîr‹
;

503 
	`LOG_FUNC_RETURN
 (
ªt_code
);

504 
	}
}

523 
	$_«s_u£r_¥oc_cgmm
(c⁄° 
©_comm™d_t
 *
d©a
)

525 
LOG_FUNC_IN
;

527 
ªt_code
 = 
RETURNok
;

528 
©_cgmm_ª•_t
 *
cgmm
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgmm;

529 
	`mem£t
(
cgmm
, 0, (
©_cgmm_ª•_t
));

531 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

532 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

533 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGMM_MASK
;

534 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

536 
d©a
->
ty≥
) {

537 
AT_COMMAND_ACT
:

539 
	`°∫˝y
(
cgmm
->
modñ
, 
_«s_u£r_nvd©a
.model,

540 
AT_RESPONSE_INFO_TEXT_SIZE
);

543 
AT_COMMAND_TST
:

548 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGMM commandÅype %d isÇot supported",

549 
d©a
->
ty≥
);

550 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

551 
ªt_code
 = 
RETURNîr‹
;

555 
	`LOG_FUNC_RETURN
 (
ªt_code
);

556 
	}
}

576 
	$_«s_u£r_¥oc_cgmr
(c⁄° 
©_comm™d_t
 *
d©a
)

578 
LOG_FUNC_IN
;

580 
ªt_code
 = 
RETURNok
;

581 
©_cgmr_ª•_t
 *
cgmr
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgmr;

582 
	`mem£t
(
cgmr
, 0, (
©_cgmr_ª•_t
));

584 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

585 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

586 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGMR_MASK
;

587 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

589 
d©a
->
ty≥
) {

590 
AT_COMMAND_ACT
:

592 
	`°∫˝y
(
cgmr
->
ªvisi⁄
, 
_«s_u£r_c⁄ãxt
.
vîsi⁄
,

593 
AT_RESPONSE_INFO_TEXT_SIZE
);

596 
AT_COMMAND_TST
:

601 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGMR commandÅype %d isÇot supported",

602 
d©a
->
ty≥
);

603 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

604 
ªt_code
 = 
RETURNîr‹
;

608 
	`LOG_FUNC_RETURN
 (
ªt_code
);

609 
	}
}

632 
	$_«s_u£r_¥oc_cimi
(c⁄° 
©_comm™d_t
 *
d©a
)

634 
LOG_FUNC_IN
;

636 
ªt_code
 = 
RETURNok
;

637 
©_cimi_ª•_t
 *
cimi
 = &
_«s_u£r_d©a
.
ª•⁄£
.cimi;

638 
	`mem£t
(
cimi
, 0, (
©_cimi_ª•_t
));

640 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

641 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

642 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CIMI_MASK
;

643 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

645 
d©a
->
ty≥
) {

646 
AT_COMMAND_ACT
:

647 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

648 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

649 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

652 
ªt_code
 = 
	`«s_¥oc_gë_imsi
(
cimi
->
IMSI
);

653 i‡(
ªt_code
 !
RETURNok
) {

654 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo get IMSIÇumber");

655 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

659 
AT_COMMAND_TST
:

664 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CIMI commandÅype %d isÇot supported",

665 
d©a
->
ty≥
);

666 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

667 
ªt_code
 = 
RETURNîr‹
;

671 
	`LOG_FUNC_RETURN
 (
ªt_code
);

672 
	}
}

690 
	$_«s_u£r_¥oc_cfun
(c⁄° 
©_comm™d_t
 *
d©a
)

692 
LOG_FUNC_IN
;

694 
ªt_code
 = 
RETURNok
;

695 
©_cfun_ª•_t
 *
cfun
 = &
_«s_u£r_d©a
.
ª•⁄£
.cfun;

696 
	`mem£t
(
cfun
, 0, (
©_cfun_ª•_t
));

698 
fun
 = 
AT_CFUN_FUN_DEFAULT
;

700 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

701 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

702 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CFUN_MASK
;

703 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

705 
d©a
->
ty≥
) {

706 
AT_COMMAND_SET
:

710 i‡(
d©a
->
mask
 & 
AT_CFUN_RST_MASK
) {

711 i‡(
d©a
->
comm™d
.
cfun
.
r°
 =
AT_CFUN_RST
) {

713 } i‡(
d©a
->
comm™d
.
cfun
.
r°
 !
AT_CFUN_NORST
) {

716 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <rst>Öarameter isÇot valid"

717 " (%d)", 
d©a
->
comm™d
.
cfun
.
r°
);

718 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

719 
ªt_code
 = 
RETURNîr‹
;

724 i‡(
d©a
->
mask
 & 
AT_CFUN_FUN_MASK
) {

725 i‡–(
d©a
->
comm™d
.
cfun
.
fun
 < 
AT_CFUN_MIN
) ||

726 (
d©a
->
comm™d
.
cfun
.
fun
 > 
AT_CFUN_MAX
) ) {

729 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <fun>Öarameter isÇot valid"

730 " (%d)", 
d©a
->
comm™d
.
cfun
.
fun
);

731 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

732 
ªt_code
 = 
RETURNîr‹
;

736 
fun
 = 
d©a
->
comm™d
.
cfun
.fun;

739 
fun
) {

740 
AT_CFUN_MIN
:

744 
AT_CFUN_FULL
:

747 
ªt_code
 = 
	`«s_¥oc_íabÀ_s1_mode
();

755 i‡(
ªt_code
 !
RETURNîr‹
) {

757 
_«s_u£r_c⁄ãxt
.
fun
 = fun;

761 
AT_COMMAND_GET
:

763 
cfun
->
fun
 = 
_«s_u£r_c⁄ãxt
.fun;

766 
AT_COMMAND_TST
:

773 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CFUN commandÅype %d isÇot supported",

774 
d©a
->
ty≥
);

775 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

776 
ªt_code
 = 
RETURNîr‹
;

780 
	`LOG_FUNC_RETURN
 (
ªt_code
);

781 
	}
}

800 
	$_«s_u£r_¥oc_˝ö
(c⁄° 
©_comm™d_t
 *
d©a
)

802 
LOG_FUNC_IN
;

804 
ªt_code
 = 
RETURNok
;

805 
©_˝ö_ª•_t
 *
˝ö
 = &
_«s_u£r_d©a
.
ª•⁄£
.cpin;

806 
	`mem£t
(
˝ö
, 0, (
©_˝ö_ª•_t
));

808 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

809 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

810 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CPIN_MASK
;

811 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

813 
d©a
->
ty≥
) {

814 
AT_COMMAND_SET
:

819 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 =
NAS_USER_SIM_PIN
) {

821 i‡(
	`°∫cmp
(
_«s_u£r_nvd©a
.
PIN
,

822 
d©a
->
comm™d
.
˝ö
.
pö
, 
USER_PIN_SIZE
) != 0) {

824 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - PIN code isÇot correct "

825 "(%s)", 
d©a
->
comm™d
.
˝ö
.
pö
);

826 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PASSWD
;

827 
ªt_code
 = 
RETURNîr‹
;

831 
_«s_u£r_c⁄ãxt
.
sim_°©us
 = 
NAS_USER_READY
;

836 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_ALLOWED
;

837 
ªt_code
 = 
RETURNîr‹
;

842 
AT_COMMAND_GET
:

847 
	`°∫˝y
(
˝ö
->
code
,

848 
_«s_u£r_sim_°©us_°r
[
_«s_u£r_c⁄ãxt
.
sim_°©us
],

849 
AT_CPIN_RESP_SIZE
);

852 
AT_COMMAND_TST
:

858 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CPIN commandÅype %d isÇot supported",

859 
d©a
->
ty≥
);

860 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

861 
ªt_code
 = 
RETURNîr‹
;

865 
	`LOG_FUNC_RETURN
 (
ªt_code
);

866 
	}
}

885 
	$_«s_u£r_¥oc_csq
(c⁄° 
©_comm™d_t
 *
d©a
)

887 
LOG_FUNC_IN
;

889 
ªt_code
 = 
RETURNok
;

890 
©_csq_ª•_t
 *
csq
 = &
_«s_u£r_d©a
.
ª•⁄£
.csq;

891 
	`mem£t
(
csq
, 0, (
©_csq_ª•_t
));

893 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

894 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

895 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CSQ_MASK
;

896 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

898 
d©a
->
ty≥
) {

899 
AT_COMMAND_ACT
:

900 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

901 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

902 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

908 
csq
->
rssi
 = 
AT_CESQ_RSSI_UNKNOWN
;

909 
csq
->
bî
 = 
AT_CESQ_BER_UNKNOWN
;

912 
AT_COMMAND_TST
:

919 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CSQ commandÅype %d isÇot supported",

920 
d©a
->
ty≥
);

921 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

922 
ªt_code
 = 
RETURNîr‹
;

926 
	`LOG_FUNC_RETURN
 (
ªt_code
);

927 
	}
}

945 
	$_«s_u£r_¥oc_˚sq
(c⁄° 
©_comm™d_t
 *
d©a
)

947 
LOG_FUNC_IN
;

949 
ªt_code
 = 
RETURNok
;

950 
©_˚sq_ª•_t
 *
˚sq
 = &
_«s_u£r_d©a
.
ª•⁄£
.cesq;

951 
	`mem£t
(
˚sq
, 0, (
©_˚sq_ª•_t
));

953 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

954 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

955 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CESQ_MASK
;

956 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

958 
d©a
->
ty≥
) {

959 
AT_COMMAND_ACT
:

960 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

961 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

962 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

967 
˚sq
->
rssi
 = 
AT_CESQ_RSSI_UNKNOWN
;

968 
˚sq
->
bî
 = 
AT_CESQ_BER_UNKNOWN
;

969 
˚sq
->
rs˝
 = 
AT_CESQ_RSCP_UNKNOWN
;

970 
˚sq
->
e˙o
 = 
AT_CESQ_ECNO_UNKNOWN
;

971 
ªt_code
 = 
	`«s_¥oc_gë_sig«l_quÆôy
(&
˚sq
->
r§q
, &˚sq->
r§p
);

974 
AT_COMMAND_TST
:

981 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CESQ commandÅype %d isÇot supported",

982 
d©a
->
ty≥
);

983 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

984 
ªt_code
 = 
RETURNîr‹
;

988 
	`LOG_FUNC_RETURN
 (
ªt_code
);

989 
	}
}

1009 
	$_«s_u£r_¥oc_c›s
(c⁄° 
©_comm™d_t
 *
d©a
)

1011 
LOG_FUNC_IN
;

1013 
ªt_code
 = 
RETURNok
;

1014 
©_c›s_ª•_t
 *
c›s
 = &
_«s_u£r_d©a
.
ª•⁄£
.cops;

1015 
	`mem£t
(
c›s
, 0, (
©_c›s_ª•_t
));

1017 
ªad_f‹m©
 = 
AT_COPS_FORMAT_DEFAULT
;

1019 
mode
 = 
AT_COPS_MODE_DEFAULT
;

1020 
f‹m©
 = 
AT_COPS_FORMAT_DEFAULT
;

1021 
AcT
 = 
AT_COPS_ACT_DEFAULT
;

1022 
›î_buf„r
[
NET_FORMAT_MAX_SIZE
], *
›î
 = oper_buffer;

1023 
	`mem£t
(
›î
, 0, 
NET_FORMAT_MAX_SIZE
);

1025 
›î_is_£À˘ed
;

1027 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1028 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1029 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

1030 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1032 
d©a
->
ty≥
) {

1033 
AT_COMMAND_SET
:

1034 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1035 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1036 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1043 i‡(
d©a
->
mask
 & 
AT_COPS_MODE_MASK
) {

1044 
mode
 = 
d©a
->
comm™d
.
c›s
.mode;

1045 
mode
) {

1046 
AT_COPS_AUTO
:

1052 
AT_COPS_MANUAL
:

1059 
AT_COPS_MANAUTO
:

1065 i‡–!(
d©a
->
mask
 & 
AT_COPS_OPER_MASK
) ) {

1066 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <oper>Öarameter isÇotÖresent");

1067 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1068 
ªt_code
 = 
RETURNîr‹
;

1073 i‡–!(
d©a
->
mask
 & 
AT_COPS_FORMAT_MASK
) ) {

1074 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <format>Öarameter isÇotÖresent");

1075 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1076 
ªt_code
 = 
RETURNîr‹
;

1081 i‡–(
d©a
->
comm™d
.
c›s
.
f‹m©
 < 
AT_COPS_FORMAT_MIN
) ||

1082 (
d©a
->
comm™d
.
c›s
.
f‹m©
 > 
AT_COPS_FORMAT_MAX
) ) {

1084 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <format>Öarameter isÇot valid (%d)",

1085 
d©a
->
comm™d
.
c›s
.
f‹m©
);

1086 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1087 
ªt_code
 = 
RETURNîr‹
;

1090 
ªad_f‹m©
 = 
f‹m©
 = 
d©a
->
comm™d
.
c›s
.format;

1093 i‡(
d©a
->
mask
 & 
AT_COPS_ACT_MASK
) {

1094 i‡–(
d©a
->
comm™d
.
c›s
.
AcT
 < 
AT_COPS_ACT_MIN
) ||

1095 (
d©a
->
comm™d
.
c›s
.
AcT
 > 
AT_COPS_ACT_MAX
) ) {

1097 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <AcT>Öarameter isÇot valid (%d)",

1098 
d©a
->
comm™d
.
c›s
.
AcT
);

1099 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1100 
ªt_code
 = 
RETURNîr‹
;

1103 
AcT
 = 
d©a
->
comm™d
.
c›s
.AcT;

1108 
AT_COPS_DEREG
:

1115 
AT_COPS_FORMAT
:

1119 i‡(
d©a
->
mask
 & 
AT_COPS_FORMAT_MASK
) {

1120 i‡–(
d©a
->
comm™d
.
c›s
.
f‹m©
 < 
AT_COPS_FORMAT_MIN
) ||

1121 (
d©a
->
comm™d
.
c›s
.
f‹m©
 > 
AT_COPS_FORMAT_MAX
) ) {

1123 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <format>Öarameter isÇot valid (%d)",

1124 
d©a
->
comm™d
.
c›s
.
f‹m©
);

1125 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1126 
ªt_code
 = 
RETURNîr‹
;

1130 
ªad_f‹m©
 = 
d©a
->
comm™d
.
c›s
.
f‹m©
;

1133 
ªad_f‹m©
 = 
AT_COPS_FORMAT_DEFAULT
;

1139 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <mode>Ö¨amëî i†nŸ suµ‹ãd (%d)", 
mode
);

1140 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1141 
ªt_code
 = 
RETURNîr‹
;

1149 i‡(
ªt_code
 !
RETURNîr‹
) {

1150 i‡(
mode
 =
AT_COPS_DEREG
) {

1152 
ªt_code
 = 
	`«s_¥oc_dîegi°î
();

1153 i‡(
ªt_code
 !
RETURNok
) {

1154 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Network deregistration failed");

1155 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1158 } i‡(
mode
 !
AT_COPS_FORMAT
) {

1161 
ªt_code
 = 
	`«s_¥oc_ªgi°î
(
mode
, 
f‹m©
,

1162 &
d©a
->
comm™d
.
c›s
.
∂mn
, 
AcT
);

1163 i‡(
ªt_code
 !
RETURNok
) {

1164 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Nëw‹kÑegi°øti⁄ faûed (<mode>=%d)", 
mode
);

1165 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1173 
AT_COMMAND_GET
:

1180 
ªt_code
 = 
	`«s_¥oc_gë_ªg_d©a
(&
mode
,

1181 &
›î_is_£À˘ed
, 
ªad_f‹m©
,

1182 &
c›s
->
gë
.
∂mn
, &c›s->gë.
AcT
);

1183 i‡(
ªt_code
 !
RETURNok
) {

1184 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÑegistration data (<mode>=%d)",

1185 
mode
);

1186 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1191 i‡(
mode
 =
NET_PLMN_AUTO
) {

1192 
c›s
->
gë
.
mode
 = 
AT_COPS_AUTO
;

1193 } i‡(
mode
 =
NET_PLMN_MANUAL
) {

1194 
c›s
->
gë
.
mode
 = 
AT_COPS_MANUAL
;

1196 
c›s
->
gë
.
mode
 = 
AT_COPS_MANAUTO
;

1200 i‡(
›î_is_£À˘ed
) {

1201 
c›s
->
gë
.
f‹m©
 = 
ªad_f‹m©
;

1202 
_«s_u£r_d©a
.
mask
 |(
AT_COPS_RESP_FORMAT_MASK
 |

1203 
AT_COPS_RESP_OPER_MASK
);

1205 i‡(
c›s
->
gë
.
AcT
 !
NET_ACCESS_UNAVAILABLE
) {

1206 
_«s_u£r_d©a
.
mask
 |
AT_COPS_RESP_ACT_MASK
;

1212 
AT_COMMAND_TST
:

1217 
c›s
->
t°
.
size
 = 
	`«s_¥oc_gë_›î_li°
(&c›s->t°.
d©a
);

1221 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+COPS commandÅype %d isÇot supported",

1222 
d©a
->
ty≥
);

1223 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1224 
ªt_code
 = 
RETURNîr‹
;

1228 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1229 
	}
}

1247 
	$_«s_u£r_¥oc_cg©t
(c⁄° 
©_comm™d_t
 *
d©a
)

1249 
LOG_FUNC_IN
;

1251 
ªt_code
 = 
RETURNok
;

1252 
©_cg©t_ª•_t
 *
cg©t
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgatt;

1253 
	`mem£t
(
cg©t
, 0, (
©_cg©t_ª•_t
));

1255 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1256 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1257 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGATT_MASK
;

1258 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1260 
d©a
->
ty≥
) {

1261 
AT_COMMAND_SET
:

1262 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1263 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1264 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1270 i‡(
d©a
->
mask
 & 
AT_CGATT_STATE_MASK
) {

1271 i‡–(
d©a
->
comm™d
.
cg©t
.
°©e
 < 
AT_CGATT_STATE_MIN
) ||

1272 (
d©a
->
comm™d
.
cg©t
.
°©e
 > 
AT_CGATT_STATE_MAX
) ) {

1275 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <state>Öarameter isÇot valid (%d)",

1276 
d©a
->
comm™d
.
cg©t
.
°©e
);

1277 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1278 
ªt_code
 = 
RETURNîr‹
;

1284 
ªt_code
 = 
RETURNîr‹
;

1285 i‡(
d©a
->
comm™d
.
cg©t
.
°©e
 =
AT_CGATT_ATTACHED
) {

1286 
ªt_code
 = 
	`«s_¥oc_©èch
();

1287 } i‡(
d©a
->
comm™d
.
cg©t
.
°©e
 =
AT_CGATT_DETACHED
) {

1288 
ªt_code
 = 
	`«s_¥oc_dëach
(
FALSE
);

1290 i‡(
ªt_code
 !
RETURNok
) {

1291 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅoáttach/detach "

1293 
d©a
->
comm™d
.
cg©t
.
°©e
);

1294 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1299 
AT_COMMAND_GET
:

1303 i‡(
	`«s_¥oc_gë_©èch_°©us
(Ë!
TRUE
) {

1304 
cg©t
->
°©e
 = 
AT_CGATT_DETACHED
;

1306 
cg©t
->
°©e
 = 
AT_CGATT_ATTACHED
;

1310 
AT_COMMAND_TST
:

1318 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGATT commandÅype %d isÇot supported",

1319 
d©a
->
ty≥
);

1320 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1321 
ªt_code
 = 
RETURNîr‹
;

1325 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1326 
	}
}

1345 
	$_«s_u£r_¥oc_¸eg
(c⁄° 
©_comm™d_t
 *
d©a
)

1347 
LOG_FUNC_IN
;

1349 
ªt_code
 = 
RETURNok
;

1350 
©_¸eg_ª•_t
 *
¸eg
 = &
_«s_u£r_d©a
.
ª•⁄£
.creg;

1351 
	`mem£t
(
¸eg
, 0, (
©_¸eg_ª•_t
));

1353 
n
 = 
AT_CREG_N_DEFAULT
;

1355 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1356 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1357 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

1358 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1360 
d©a
->
ty≥
) {

1361 
AT_COMMAND_SET
:

1362 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1363 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1364 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1372 i‡(
d©a
->
mask
 & 
AT_CREG_N_MASK
) {

1373 i‡–(
d©a
->
comm™d
.
¸eg
.
n
 < 
AT_CREG_N_MIN
) ||

1374 (
d©a
->
comm™d
.
¸eg
.
n
 > 
AT_CREG_N_MAX
) ) {

1377 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <n>Öarameter isÇot valid"

1378 " (%d)", 
d©a
->
comm™d
.
¸eg
.
n
);

1379 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1380 
ªt_code
 = 
RETURNîr‹
;

1384 
n
 = 
d©a
->
comm™d
.
¸eg
.n;

1387 
n
 = 
AT_CREG_N_DEFAULT
;

1391 
n
) {

1392 
AT_CREG_OFF
:

1394 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_REG
);

1395 i‡(
ªt_code
 !
RETURNîr‹
) {

1397 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_LOC
);

1399 i‡(
ªt_code
 !
RETURNok
) {

1400 
	`LOG_TRACE
(
ERROR
,

1402 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1406 
AT_CREG_BOTH
:

1408 
AT_CREG_ON
:

1411 
ªt_code
 = 
	`u£r_öd_ªgi°î
(
USER_IND_REG
, 
AT_CREG
, 
NULL
);

1412 i‡(
ªt_code
 !
RETURNok
) {

1413 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅoÉnableÜogging ofÑegistration status");

1414 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1424 
AT_COMMAND_GET
:

1431 
¸eg
->
n
 =Ç;

1432 
n
) {

1433 
AT_CREG_BOTH
:

1435 
AT_CREG_OFF
:

1436 
AT_CREG_ON
:

1438 
ªt_code
 = 
	`«s_¥oc_gë_ªg_°©us
(&
¸eg
->
°©
);

1439 i‡(
ªt_code
 !
RETURNok
) {

1440 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÑegistration status");

1441 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1451 
AT_COMMAND_TST
:

1455 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CREG commandÅype %d isÇot supported",

1456 
d©a
->
ty≥
);

1457 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1458 
ªt_code
 = 
RETURNîr‹
;

1462 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1463 
	}
}

1482 
	$_«s_u£r_¥oc_cgªg
(c⁄° 
©_comm™d_t
 *
d©a
)

1484 
LOG_FUNC_IN
;

1486 
ªt_code
 = 
RETURNok
;

1487 
©_cgªg_ª•_t
 *
cgªg
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgreg;

1488 
	`mem£t
(
cgªg
, 0, (
©_cgªg_ª•_t
));

1490 
n
 = 
AT_CGREG_N_DEFAULT
;

1492 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1493 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1494 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

1495 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1497 
d©a
->
ty≥
) {

1498 
AT_COMMAND_SET
:

1499 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1500 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1501 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1509 i‡(
d©a
->
mask
 & 
AT_CGREG_N_MASK
) {

1510 i‡–(
d©a
->
comm™d
.
cgªg
.
n
 < 
AT_CGREG_N_MIN
) ||

1511 (
d©a
->
comm™d
.
cgªg
.
n
 > 
AT_CGREG_N_MAX
) ) {

1514 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <n>Öarameter isÇot valid"

1515 " (%d)", 
d©a
->
comm™d
.
cgªg
.
n
);

1516 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1517 
ªt_code
 = 
RETURNîr‹
;

1521 
n
 = 
d©a
->
comm™d
.
cgªg
.n;

1524 
n
 = 
AT_CGREG_N_DEFAULT
;

1528 
n
) {

1529 
AT_CGREG_OFF
:

1531 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_REG
);

1532 i‡(
ªt_code
 !
RETURNîr‹
) {

1534 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_LOC
);

1536 i‡(
ªt_code
 !
RETURNok
) {

1537 
	`LOG_TRACE
(
ERROR
,

1539 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1543 
AT_CGREG_BOTH
:

1545 
AT_CGREG_ON
:

1548 
ªt_code
 = 
	`u£r_öd_ªgi°î
(
USER_IND_REG
, 
AT_CGREG
, 
NULL
);

1549 i‡(
ªt_code
 !
RETURNok
) {

1550 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅoÉnableÜogging ofÑegistration status");

1551 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1561 
AT_COMMAND_GET
:

1568 
cgªg
->
n
 =Ç;

1569 
n
) {

1570 
AT_CGREG_BOTH
:

1572 
AT_CGREG_OFF
:

1573 
AT_CGREG_ON
:

1575 
ªt_code
 = 
	`«s_¥oc_gë_ªg_°©us
(&
cgªg
->
°©
);

1576 i‡(
ªt_code
 !
RETURNok
) {

1577 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÑegistration status");

1578 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1588 
AT_COMMAND_TST
:

1592 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGREG commandÅype %d isÇot supported",

1593 
d©a
->
ty≥
);

1594 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1595 
ªt_code
 = 
RETURNîr‹
;

1599 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1600 
	}
}

1619 
	$_«s_u£r_¥oc_˚ªg
(c⁄° 
©_comm™d_t
 *
d©a
)

1621 
LOG_FUNC_IN
;

1623 
ªt_code
 = 
RETURNok
;

1624 
©_˚ªg_ª•_t
 *
˚ªg
 = &
_«s_u£r_d©a
.
ª•⁄£
.cereg;

1625 
	`mem£t
(
˚ªg
, 0, (
©_˚ªg_ª•_t
));

1627 
n
 = 
AT_CEREG_N_DEFAULT
;

1629 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1630 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1631 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

1632 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1634 
d©a
->
ty≥
) {

1635 
AT_COMMAND_SET
:

1636 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1637 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1638 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1646 i‡(
d©a
->
mask
 & 
AT_CEREG_N_MASK
) {

1647 i‡–(
d©a
->
comm™d
.
˚ªg
.
n
 < 
AT_CEREG_N_MIN
) ||

1648 (
d©a
->
comm™d
.
˚ªg
.
n
 > 
AT_CEREG_N_MAX
) ) {

1651 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <n>Öarameter isÇot valid"

1652 " (%d)", 
d©a
->
comm™d
.
˚ªg
.
n
);

1653 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1654 
ªt_code
 = 
RETURNîr‹
;

1658 
n
 = 
d©a
->
comm™d
.
˚ªg
.n;

1661 
n
 = 
AT_CEREG_N_DEFAULT
;

1665 
n
) {

1666 
AT_CEREG_OFF
:

1668 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_REG
);

1669 i‡(
ªt_code
 !
RETURNîr‹
) {

1671 
ªt_code
 = 
	`u£r_öd_dîegi°î
(
USER_IND_LOC
);

1673 i‡(
ªt_code
 !
RETURNok
) {

1674 
	`LOG_TRACE
(
ERROR
,

1676 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1680 
AT_CEREG_BOTH
:

1682 
ªt_code
 = 
	`u£r_öd_ªgi°î
(
USER_IND_LOC
, 
AT_CEREG
, 
NULL
);

1683 i‡(
ªt_code
 !
RETURNok
) {

1684 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅoÉnableÜogging ofÜocation information");

1685 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1689 
AT_CEREG_ON
:

1692 
ªt_code
 = 
	`u£r_öd_ªgi°î
(
USER_IND_REG
, 
AT_CEREG
, 
NULL
);

1693 i‡(
ªt_code
 !
RETURNok
) {

1694 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅoÉnableÜogging ofÑegistration status");

1695 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1705 
AT_COMMAND_GET
:

1712 
˚ªg
->
n
 =Ç;

1713 
n
) {

1714 
AT_CEREG_BOTH
:

1716 
ªt_code
 = 
	`«s_¥oc_gë_loc_öfo
(
˚ªg
->
èc
, cîeg->
ci
,

1717 &
˚ªg
->
AcT
);

1718 i‡(
ªt_code
 !
RETURNok
) {

1719 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÜocation information");

1720 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1724 i‡(
˚ªg
->
èc
[0] != 0) {

1725 
_«s_u£r_d©a
.
mask
 |(
AT_CEREG_RESP_TAC_MASK
 |

1726 
AT_CEREG_RESP_CI_MASK
);

1727 i‡(
˚ªg
->
AcT
 !
NET_ACCESS_UNAVAILABLE
) {

1728 
_«s_u£r_d©a
.
mask
 |(
AT_CEREG_RESP_ACT_MASK
);

1734 
AT_CEREG_OFF
:

1735 
AT_CEREG_ON
:

1737 
ªt_code
 = 
	`«s_¥oc_gë_ªg_°©us
(&
˚ªg
->
°©
);

1738 i‡(
ªt_code
 !
RETURNok
) {

1739 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÑegistration status");

1740 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1750 
AT_COMMAND_TST
:

1754 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CEREG commandÅype %d isÇot supported",

1755 
d©a
->
ty≥
);

1756 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1757 
ªt_code
 = 
RETURNîr‹
;

1761 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1762 
	}
}

1786 
	$_«s_u£r_¥oc_cgdc⁄t
(c⁄° 
©_comm™d_t
 *
d©a
)

1788 
LOG_FUNC_IN
;

1790 
ªt_code
 = 
RETURNok
;

1791 
©_cgdc⁄t_gë_t
 *
cgdc⁄t
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgdc⁄t.
gë
;

1792 
	`mem£t
(
cgdc⁄t
, 0, (
©_cgdc⁄t_ª•_t
));

1794 
cid
 = 
AT_CGDCONT_CID_DEFAULT
;

1795 
pdn_ty≥
 = 
NET_PDN_TYPE_IPV4
;

1796 c⁄° *
≠n
 = 
NULL
;

1797 
ùv4_addr_Æloˇti⁄
 = 
AT_CGDCONT_IPV4_DEFAULT
;

1798 
emîgícy
 = 
AT_CGDCONT_EBS_DEFAULT
;

1799 
p_cscf
 = 
AT_CGDCONT_PCSCF_DEFAULT
;

1800 
im_˙_sig«Œög
 = 
AT_CGDCONT_IM_CM_DEFAULT
;

1801 
ª£t_pdn
 = 
TRUE
;

1803 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

1804 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

1805 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_NO_PARAM
;

1806 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

1808 
d©a
->
ty≥
) {

1809 
AT_COMMAND_SET
:

1810 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

1811 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

1812 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

1818 i‡(
d©a
->
mask
 & 
AT_CGDCONT_CID_MASK
) {

1819 i‡(
d©a
->
comm™d
.
cgdc⁄t
.
cid
 < 
AT_CGDCONT_CID_MIN
) {

1822 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <cid>Öarameter isÇot valid"

1823 " (%d)", 
d©a
->
comm™d
.
cgdc⁄t
.
cid
);

1824 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1825 
ªt_code
 = 
RETURNîr‹
;

1828 
cid
 = 
d©a
->
comm™d
.
cgdc⁄t
.cid;

1830 i‡(
d©a
->
mask
 & 
AT_CGDCONT_PDP_TYPE_MASK
) {

1831 i‡(
	`°rcmp
(
d©a
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, "IP") == 0) {

1832 
pdn_ty≥
 = 
NET_PDN_TYPE_IPV4
;

1833 } i‡(
	`°rcmp
(
d©a
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
, "IPV6") == 0) {

1834 
pdn_ty≥
 = 
NET_PDN_TYPE_IPV6
;

1835 } i‡(
	`°rcmp
(
d©a
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
,"IPV4V6") == 0) {

1836 
pdn_ty≥
 = 
NET_PDN_TYPE_IPV4V6
;

1840 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <PDN_type>Öarameter isÇot "

1841 "vÆid (%s)", 
d©a
->
comm™d
.
cgdc⁄t
.
PDP_ty≥
);

1842 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1843 
ªt_code
 = 
RETURNîr‹
;

1846 
ª£t_pdn
 = 
FALSE
;

1848 i‡(
d©a
->
mask
 & 
AT_CGDCONT_APN_MASK
) {

1849 
≠n
 = 
d©a
->
comm™d
.
cgdc⁄t
.
APN
;

1851 i‡(
d©a
->
mask
 & 
AT_CGDCONT_D_COMP_MASK
) {

1852 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
d_comp
 < 
AT_CGDCONT_D_COMP_MIN
) ||

1853 (
d©a
->
comm™d
.
cgdc⁄t
.
d_comp
 > 
AT_CGDCONT_D_COMP_MAX
) ) {

1856 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <d_comp>Öarameter isÇot "

1857 "vÆid (%d)", 
d©a
->
comm™d
.
cgdc⁄t
.
d_comp
);

1858 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1859 
ªt_code
 = 
RETURNîr‹
;

1864 i‡(
d©a
->
mask
 & 
AT_CGDCONT_H_COMP_MASK
) {

1865 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
h_comp
 < 
AT_CGDCONT_H_COMP_MIN
) ||

1866 (
d©a
->
comm™d
.
cgdc⁄t
.
h_comp
 > 
AT_CGDCONT_H_COMP_MAX
) ) {

1869 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <h_comp>Öarameter isÇot "

1870 "vÆid (%d)", 
d©a
->
comm™d
.
cgdc⁄t
.
h_comp
);

1871 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1872 
ªt_code
 = 
RETURNîr‹
;

1877 i‡(
d©a
->
mask
 & 
AT_CGDCONT_IPV4ADDRALLOC_MASK
) {

1878 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
 < 
AT_CGDCONT_IPV4_MIN
)

1879 || (
d©a
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
 > 
AT_CGDCONT_IPV4_MAX
) ) {

1882 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <IPv4AddrAlloc>Öarameter "

1884 
d©a
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
);

1885 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1886 
ªt_code
 = 
RETURNîr‹
;

1889 
ùv4_addr_Æloˇti⁄
 = 
d©a
->
comm™d
.
cgdc⁄t
.
IPv4AddrAŒoc
;

1891 i‡(
d©a
->
mask
 & 
AT_CGDCONT_EMERGECY_INDICATION_MASK
) {

1892 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
 < 
AT_CGDCONT_EBS_MIN
)

1893 || (
d©a
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
 > 
AT_CGDCONT_EBS_MAX
) ) {

1896 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <emergency indication> "

1898 
d©a
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
);

1899 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1900 
ªt_code
 = 
RETURNîr‹
;

1903 
emîgícy
 = 
d©a
->
comm™d
.
cgdc⁄t
.
emîgícy_ödiˇti⁄
;

1905 i‡(
d©a
->
mask
 & 
AT_CGDCONT_P_CSCF_DISCOVERY_MASK
) {

1906 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
 < 
AT_CGDCONT_PCSCF_MIN
)

1907 || (
d©a
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
 > 
AT_CGDCONT_PCSCF_MAX
) ) {

1910 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <P-CSCF_discovery> "

1912 
d©a
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
);

1913 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1914 
ªt_code
 = 
RETURNîr‹
;

1917 
p_cscf
 = 
d©a
->
comm™d
.
cgdc⁄t
.
P_CSCF_discovîy
;

1919 i‡(
d©a
->
mask
 & 
AT_CGDCONT_IM_CN_SIGNALLING_FLAG_IND_MASK
) {

1920 i‡–(
d©a
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
 < 
AT_CGDCONT_IM_CM_MIN
)

1921 || (
d©a
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
 > 
AT_CGDCONT_IM_CM_MAX
) ) {

1925 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <IM_CN_Signalling_Flag_Ind> "

1927 
d©a
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
);

1928 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

1929 
ªt_code
 = 
RETURNîr‹
;

1932 
im_˙_sig«Œög
 = 
d©a
->
comm™d
.
cgdc⁄t
.
IM_CN_Sig«Œög_Fœg_Ind
;

1937 i‡(
ª£t_pdn
) {

1940 
ªt_code
 = 
	`«s_¥oc_ª£t_pdn
(
cid
);

1943 
ªt_code
 = 
	`«s_¥oc_£t_pdn
(
cid
, 
pdn_ty≥
, 
≠n
,

1944 
ùv4_addr_Æloˇti⁄
, 
emîgícy
,

1945 
p_cscf
, 
im_˙_sig«Œög
);

1947 i‡(
ªt_code
 !
RETURNok
) {

1948 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo setup PDN connection "

1949 "(<cid>=%d)", 
d©a
->
comm™d
.
cgdc⁄t
.
cid
);

1950 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1955 
AT_COMMAND_GET
:

1960 
cgdc⁄t
->
n_pdns
 = 
	`«s_¥oc_gë_pdn_∑øm
(cgdc⁄t->
cid
,

1961 
cgdc⁄t
->
PDP_ty≥
,

1962 
cgdc⁄t
->
APN
,

1963 
AT_CGDCONT_RESP_SIZE
);

1964 i‡(
cgdc⁄t
->
n_pdns
 == 0) {

1965 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Noány PDN context is defined");

1966 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1970 
AT_COMMAND_TST
:

1976 
cid_max
 = 
	`«s_¥oc_gë_pdn_ønge
();

1977 i‡(
cid_max
 > 
AT_CGDCONT_RESP_SIZE
) {

1979 
_«s_u£r_d©a
.
ª•⁄£
.
cgdc⁄t
.
t°
.
n_cid
 =

1980 
AT_CGDCONT_RESP_SIZE
;

1983 
_«s_u£r_d©a
.
ª•⁄£
.
cgdc⁄t
.
t°
.
n_cid
 = 
cid_max
;

1989 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGDCONT commandÅype %d isÇot supported",

1990 
d©a
->
ty≥
);

1991 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

1992 
ªt_code
 = 
RETURNîr‹
;

1996 
	`LOG_FUNC_RETURN
 (
ªt_code
);

1997 
	}
}

2016 
	$_«s_u£r_¥oc_cga˘
(c⁄° 
©_comm™d_t
 *
d©a
)

2018 
LOG_FUNC_IN
;

2020 
ªt_code
 = 
RETURNok
;

2021 
©_cga˘_ª•_t
 *
cga˘
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgact;

2022 
	`mem£t
(
cga˘
, 0, (
©_cga˘_ª•_t
));

2024 
cid
 = -1;

2025 
°©e
 = 
AT_CGACT_STATE_DEFAULT
;

2027 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2028 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2029 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGACT_MASK
;

2030 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2032 
d©a
->
ty≥
) {

2033 
AT_COMMAND_SET
:

2034 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

2035 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

2036 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

2042 i‡(
d©a
->
mask
 & 
AT_CGACT_STATE_MASK
) {

2043 i‡–(
d©a
->
comm™d
.
cga˘
.
°©e
 < 
AT_CGACT_STATE_MIN
) ||

2044 (
d©a
->
comm™d
.
cga˘
.
°©e
 > 
AT_CGACT_STATE_MAX
) ) {

2047 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <state>Öarameter is "

2048 "nŸ vÆid (%d)", 
d©a
->
comm™d
.
cga˘
.
°©e
);

2049 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2050 
ªt_code
 = 
RETURNîr‹
;

2053 
°©e
 = 
d©a
->
comm™d
.
cga˘
.state;

2055 i‡(
d©a
->
mask
 & 
AT_CGACT_CID_MASK
) {

2056 i‡(
d©a
->
comm™d
.
cga˘
.
cid
 < 
AT_CGACT_CID_MIN
) {

2059 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <cid>Öarameter is "

2060 "nŸ vÆid (%d)", 
d©a
->
comm™d
.
cga˘
.
cid
);

2061 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2062 
ªt_code
 = 
RETURNîr‹
;

2065 
cid
 = 
d©a
->
comm™d
.
cga˘
.cid;

2070 
ªt_code
 = 
RETURNîr‹
;

2071 i‡(
°©e
 =
AT_CGACT_DEACTIVATED
) {

2072 
ªt_code
 = 
	`«s_¥oc_dó˘iv©e_pdn
(
cid
);

2073 } i‡(
°©e
 =
AT_CGACT_ACTIVATED
) {

2074 
ªt_code
 = 
	`«s_¥oc_a˘iv©e_pdn
(
cid
);

2076 i‡(
ªt_code
 !
RETURNok
) {

2077 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo %s PDN context "

2079 (
°©e
 !
AT_CGACT_ACTIVATED
)? "deactivate" :

2080 "a˘iv©e", 
°©e
, 
cid
);

2081 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2086 
AT_COMMAND_GET
:

2091 
cga˘
->
n_pdns
 = 
	`«s_¥oc_gë_pdn_°©us
(cga˘->
cid
, cga˘->
°©e
,

2092 
AT_CGACT_RESP_SIZE
);

2093 i‡(
cga˘
->
n_pdns
 == 0) {

2094 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Noány PDN context is defined");

2095 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2099 
AT_COMMAND_TST
:

2107 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGACT commandÅype %d isÇot supported",

2108 
d©a
->
ty≥
);

2109 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2110 
ªt_code
 = 
RETURNîr‹
;

2114 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2115 
	}
}

2134 
	$_«s_u£r_¥oc_cmì
(c⁄° 
©_comm™d_t
 *
d©a
)

2136 
LOG_FUNC_IN
;

2138 
ªt_code
 = 
RETURNok
;

2139 
©_cmì_ª•_t
 *
cmì
 = &
_«s_u£r_d©a
.
ª•⁄£
.cmee;

2140 
	`mem£t
(
cmì
, 0, (
©_cmì_ª•_t
));

2142 
n
 = 
AT_CMEE_N_DEFAULT
;

2144 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2145 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2146 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CMEE_MASK
;

2147 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2149 
d©a
->
ty≥
) {

2150 
AT_COMMAND_ACT
:

2151 
AT_COMMAND_SET
:

2157 i‡(
d©a
->
mask
 & 
AT_CMEE_N_MASK
) {

2158 i‡–(
d©a
->
comm™d
.
cmì
.
n
 < 
AT_CMEE_N_MIN
) ||

2159 (
d©a
->
comm™d
.
cmì
.
n
 > 
AT_CMEE_N_MAX
) ) {

2162 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <n>Öarameter isÇot valid"

2163 " (%d)", 
d©a
->
comm™d
.
cmì
.
n
);

2164 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2165 
ªt_code
 = 
RETURNîr‹
;

2169 
n
 = 
d©a
->
comm™d
.
cmì
.n;

2173 
n
) {

2174 
AT_CMEE_OFF
:

2176 
	`©_îr‹_£t_f‹m©
(
AT_ERROR_OFF
);

2179 
AT_CMEE_NUMERIC
:

2181 
	`©_îr‹_£t_f‹m©
(
AT_ERROR_NUMERIC
);

2184 
AT_CMEE_VERBOSE
:

2186 
	`©_îr‹_£t_f‹m©
(
AT_ERROR_VERBOSE
);

2195 
AT_COMMAND_GET
:

2200 
n
 = 
	`©_îr‹_gë_f‹m©
();

2201 
cmì
->
n
 = ( (¿=
AT_ERROR_OFF
)? 
AT_CMEE_OFF
 :

2202 (
n
 =
AT_ERROR_NUMERIC
)? 
AT_CMEE_NUMERIC
 :

2203 (
n
 =
AT_ERROR_VERBOSE
)? 
AT_CMEE_VERBOSE
 : 
RETURNîr‹
);

2204 i‡(
cmì
->
n
 =
RETURNîr‹
) {

2205 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo get format ofÅhe finalÑesult code");

2206 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2210 
AT_COMMAND_TST
:

2217 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CMEE commandÅype %d isÇot supported",

2218 
d©a
->
ty≥
);

2219 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2220 
ªt_code
 = 
RETURNîr‹
;

2224 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2225 
	}
}

2243 
	$_«s_u£r_¥oc_˛ck
(c⁄° 
©_comm™d_t
 *
d©a
)

2245 
LOG_FUNC_IN
;

2247 
ªt_code
 = 
RETURNok
;

2248 
©_˛ck_ª•_t
 *
˛ck
 = &
_«s_u£r_d©a
.
ª•⁄£
.clck;

2249 
	`mem£t
(
˛ck
, 0, (
©_˛ck_ª•_t
));

2251 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2252 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2253 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CLCK_MASK
;

2254 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2256 
d©a
->
ty≥
) {

2257 
AT_COMMAND_SET
:

2264 i‡(
	`°∫cmp
(
d©a
->
comm™d
.
˛ck
.
Ác
, 
AT_CLCK_SC
,

2265 
AT_CLCK_FAC_SIZE
) != 0) {

2267 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Facility isÇot supported (%s)",

2268 
d©a
->
comm™d
.
˛ck
.
Ác
);

2269 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2270 
ªt_code
 = 
RETURNîr‹
;

2274 i‡(
d©a
->
mask
 & 
AT_CLCK_PASSWD_MASK
) {

2276 i‡(
	`°∫cmp
(
_«s_u£r_nvd©a
.
PIN
,

2277 
d©a
->
comm™d
.
˛ck
.
∑sswd
, 
USER_PIN_SIZE
) != 0) {

2279 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Password isÇot correct "

2280 "(%s)", 
d©a
->
comm™d
.
˛ck
.
∑sswd
);

2281 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PASSWD
;

2282 
ªt_code
 = 
RETURNîr‹
;

2287 
d©a
->
comm™d
.
˛ck
.
mode
) {

2288 
AT_CLCK_UNLOCK
:

2290 i‡–!(
d©a
->
mask
 & 
AT_CLCK_PASSWD_MASK
) ) {

2292 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - unlock mode of operation "

2294 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

2295 
ªt_code
 = 
RETURNîr‹
;

2298 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - unlock mode of operation "

2300 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2301 
ªt_code
 = 
RETURNîr‹
;

2304 
AT_CLCK_LOCK
:

2306 i‡–!(
d©a
->
mask
 & 
AT_CLCK_PASSWD_MASK
) ) {

2308 
	`LOG_TRACE
(
ERROR
, "USR-MAIN -Üock mode of operation "

2310 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

2311 
ªt_code
 = 
RETURNîr‹
;

2314 
	`LOG_TRACE
(
ERROR
, "USR-MAIN -Üock mode of operation "

2316 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2317 
ªt_code
 = 
RETURNîr‹
;

2320 
AT_CLCK_STATUS
:

2322 
˛ck
->
°©us
 = 
AT_CLCK_RESP_STATUS_NOT_ACTIVE
;

2326 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <mode>Öarameter isÇot valid"

2327 " (%d)", 
d©a
->
comm™d
.
˛ck
.
mode
);

2328 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2329 
ªt_code
 = 
RETURNîr‹
;

2334 
AT_COMMAND_TST
:

2341 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CLCK commandÅype %d isÇot supported",

2342 
d©a
->
ty≥
);

2343 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2344 
ªt_code
 = 
RETURNîr‹
;

2348 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2349 
	}
}

2367 
	$_«s_u£r_¥oc_cg∑ddr
(c⁄° 
©_comm™d_t
 *
d©a
)

2369 
LOG_FUNC_IN
;

2371 
ªt_code
 = 
RETURNok
;

2372 
©_cg∑ddr_ª•_t
 *
cg∑ddr
 = &
_«s_u£r_d©a
.
ª•⁄£
.cgpaddr;

2373 
	`mem£t
(
cg∑ddr
, 0, (
©_cg∑ddr_ª•_t
));

2375 
cid
 = -1;

2377 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2378 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2379 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CGPADDR_MASK
;

2380 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2382 
d©a
->
ty≥
) {

2383 
AT_COMMAND_SET
:

2384 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

2385 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

2386 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

2392 i‡(
d©a
->
mask
 & 
AT_CGPADDR_CID_MASK
) {

2393 i‡(
d©a
->
comm™d
.
cg∑ddr
.
cid
 < 
AT_CGPADDR_CID_MIN
) {

2396 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - <cid>Öarameter is "

2397 "nŸ vÆid (%d)", 
d©a
->
comm™d
.
cg∑ddr
.
cid
);

2398 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_INCORRECT_PARAMETERS
;

2399 
ªt_code
 = 
RETURNîr‹
;

2402 
cid
 = 
d©a
->
comm™d
.
cg∑ddr
.cid;

2407 
cg∑ddr
->
n_pdns
 = 
	`«s_¥oc_gë_pdn_addr
(
cid
, cgpaddr->cid,

2408 
cg∑ddr
->
PDP_addr_1
,

2409 
cg∑ddr
->
PDP_addr_2
,

2410 
AT_CGPADDR_RESP_SIZE
);

2411 i‡(
cg∑ddr
->
n_pdns
 == 0) {

2412 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - Noány PDN context is defined");

2413 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2417 
AT_COMMAND_TST
:

2421 
cg∑ddr
->
n_pdns
 = 
	`«s_¥oc_gë_pdn_addr
(
cid
, cgpaddr->cid,

2422 
cg∑ddr
->
PDP_addr_1
,

2423 
cg∑ddr
->
PDP_addr_2
,

2424 
AT_CGPADDR_RESP_SIZE
);

2428 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CGPADDR commandÅype %d is "

2429 "nŸ suµ‹ãd", 
d©a
->
ty≥
);

2430 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2431 
ªt_code
 = 
RETURNîr‹
;

2435 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2436 
	}
}

2454 
	$_«s_u£r_¥oc_˙um
(c⁄° 
©_comm™d_t
 *
d©a
)

2456 
LOG_FUNC_IN
;

2458 
ªt_code
 = 
RETURNok
;

2459 
©_˙um_ª•_t
 *
˙um
 = &
_«s_u£r_d©a
.
ª•⁄£
.cnum;

2460 
	`mem£t
(
˙um
, 0, (
©_˙um_ª•_t
));

2462 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2463 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2464 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CNUM_MASK
;

2465 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2467 
d©a
->
ty≥
) {

2468 
AT_COMMAND_ACT
:

2469 i‡(
_«s_u£r_c⁄ãxt
.
sim_°©us
 !
NAS_USER_READY
) {

2470 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SIM_PIN_REQUIRED
;

2471 
	`LOG_FUNC_RETURN
(
RETURNîr‹
);

2474 
ªt_code
 = 
	`«s_¥oc_gë_msisdn
(
˙um
->
numbî
, &˙um->
ty≥
);

2475 i‡(
ªt_code
 !
RETURNok
) {

2476 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo get MS dialingÇumber");

2477 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2481 
AT_COMMAND_TST
:

2486 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CNUM commandÅype %d is "

2487 "nŸ suµ‹ãd", 
d©a
->
ty≥
);

2488 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2489 
ªt_code
 = 
RETURNîr‹
;

2493 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2494 
	}
}

2512 
	$_«s_u£r_¥oc_˛ac
(c⁄° 
©_comm™d_t
 *
d©a
)

2514 
LOG_FUNC_IN
;

2516 
ªt_code
 = 
RETURNok
;

2517 
©_˛ac_ª•_t
 *
˛ac
 = &
_«s_u£r_d©a
.
ª•⁄£
.clac;

2518 
	`mem£t
(
˛ac
, 0, (
©_˛ac_ª•_t
));

2520 
_«s_u£r_d©a
.
id
 = 
d©a
->id;

2521 
_«s_u£r_d©a
.
ty≥
 = 
d©a
->type;

2522 
_«s_u£r_d©a
.
mask
 = 
AT_RESPONSE_CLAC_MASK
;

2523 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_SUCCESS
;

2525 
d©a
->
ty≥
) {

2526 
AT_COMMAND_ACT
:

2528 
˛ac
->
n_acs
 = 
	`©_comm™d_gë_li°
(˛ac->
ac
, 
AT_CLAC_RESP_SIZE
);

2529 i‡(
˛ac
->
n_acs
 == 0) {

2530 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - FailedÅo getÅheÜist of "

2532 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2536 
AT_COMMAND_TST
:

2541 
	`LOG_TRACE
(
ERROR
, "USR-MAIN - AT+CLAC commandÅype %d is "

2542 "nŸ suµ‹ãd", 
d©a
->
ty≥
);

2543 
_«s_u£r_d©a
.
ˇu£_code
 = 
AT_ERROR_OPERATION_NOT_SUPPORTED
;

2544 
ªt_code
 = 
RETURNîr‹
;

2548 
	`LOG_FUNC_RETURN
 (
ªt_code
);

2549 
	}
}

	@src/nas_user.h

45 #i‚de‡
__NAS_USER_H__


46 
	#__NAS_USER_H__


	)

48 
	~"comm⁄Def.h
"

49 
	~"√tw‹kDef.h
"

67 
«s_u£r_öôülize
(
emm_ödiˇti⁄_ˇŒback_t
 
emm_cb
,

68 
esm_ödiˇti⁄_ˇŒback_t
 
esm_cb
, c⁄° *
vîsi⁄
);

70 
«s_u£r_ª˚ive_™d_¥o˚ss
(* 
fd
, *
mesßge
);

72 
«s_u£r_¥o˚ss_d©a
(c⁄° *
d©a
);

74 c⁄° *
«s_u£r_gë_d©a
();

	@src/util/OctetString.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

33 
	~"TLVEncodî.h
"

34 
	~"TLVDecodî.h
"

35 
	~"O˘ëSåög.h
"

37 
	#DUMP_OUTPUT_SIZE
 1024

	)

38 
	g_dump_ouçut
[
DUMP_OUTPUT_SIZE
];

40 
O˘ëSåög
* 
	$dup_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
)

42 
O˘ëSåög
 *
os_p
 = 
NULL
;

43 i‡(
o˘ë°rög
) {

44 
os_p
 = 
	`ˇŒoc
(1,(
O˘ëSåög
));

45 
os_p
->
Àngth
 = 
o˘ë°rög
->length;

46 
os_p
->
vÆue
 = 
	`mÆloc
(
o˘ë°rög
->
Àngth
+1);

47 
	`mem˝y
(
os_p
->
vÆue
, 
o˘ë°rög
->vÆue, o˘ë°rög->
Àngth
);

48 
os_p
->
vÆue
[
o˘ë°rög
->
Àngth
] = '\0';

51  
os_p
;

52 
	}
}

55 
	$‰ì_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
)

57 i‡(
o˘ë°rög
) {

58 i‡(
o˘ë°rög
->
vÆue
Ë
	`‰ì
(octetstring->value);

59 
o˘ë°rög
->
vÆue
 = 
NULL
;

60 
o˘ë°rög
->
Àngth
 = 0;

61 
	`‰ì
(
o˘ë°rög
);

63 
	}
}

66 
	$ícode_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
buÊí
)

68 
	`CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
buf„r
, 
o˘ë°rög
->
Àngth
, 
buÊí
);

69 
	`mem˝y
((*)
buf„r
, (*)
o˘ë°rög
->
vÆue
, o˘ë°rög->
Àngth
);

70  
o˘ë°rög
->
Àngth
;

71 
	}
}

73 
	$decode_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
, 
uöt16_t
 
pduÀn
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
buÊí
)

75 i‡(
buÊí
 < 
pduÀn
)

77 
o˘ë°rög
->
Àngth
 = 
pduÀn
;

78 
o˘ë°rög
->
vÆue
 = 
	`mÆloc
((
uöt8_t
Ë* (
pduÀn
+1));

79 
	`mem˝y
((*)
o˘ë°rög
->
vÆue
, (*)
buf„r
, 
pduÀn
);

80 
o˘ë°rög
->
vÆue
[
pduÀn
] = '\0';

81  
o˘ë°rög
->
Àngth
;

82 
	}
}

84 * 
	$dump_o˘ë_°rög_xml
–c⁄° 
O˘ëSåög
 * c⁄° 
o˘ë°rög
)

86 
i
;

87 
ªmaöög_size
 = 
DUMP_OUTPUT_SIZE
;

88 
size
 = 0;

89 
size
 = 
	`¢¥ötf
(
_dump_ouçut
, 
ªmaöög_size
, "<Lígth>%u</Lígth>\n\t<vÆues>", 
o˘ë°rög
->
Àngth
);

90 
ªmaöög_size
 -
size
;

91 
i
 = 0; i < 
o˘ë°rög
->
Àngth
; i++) {

92 
size
 +=
	`¢¥ötf
(&
_dump_ouçut
[size], 
ªmaöög_size
, "0x%x ", 
o˘ë°rög
->
vÆue
[
i
]);

93 
ªmaöög_size
 -
size
;

95 
size
 +=
	`¢¥ötf
(&
_dump_ouçut
[size], 
ªmaöög_size
, "</values>\n");

96  
_dump_ouçut
;

97 
	}
}

99 * 
	$dump_o˘ë_°rög
–c⁄° 
O˘ëSåög
 * c⁄° 
o˘ë°rög
)

101 
i
;

102 
ªmaöög_size
 = 
DUMP_OUTPUT_SIZE
;

103 
size
 = 0;

104 
i
 = 0; i < 
o˘ë°rög
->
Àngth
; i++) {

105 
size
 +=
	`¢¥ötf
(&
_dump_ouçut
[size], 
ªmaöög_size
, "0x%x ", 
o˘ë°rög
->
vÆue
[
i
]);

106 
ªmaöög_size
 -
size
;

108  
_dump_ouçut
;

109 
	}
}

	@src/util/OctetString.h

29 
	~<°döt.h
>

30 
	~<as£π.h
>

32 #i‚de‡
OCTET_STRING_H_


33 
	#OCTET_STRING_H_


	)

35 
	sO˘ëSåög_èg
 {

36 
uöt32_t
 
	mÀngth
;

37 
uöt8_t
 *
	mvÆue
;

38 } 
	tO˘ëSåög
;

39 
	#FREE_OCTET_STRING
(
oCTETsTRING
) \

41 i‡((
oCTETsTRING
).
vÆue
 !
NULL
) { \

42 
	`‰ì
((
oCTETsTRING
).
vÆue
); \

43 (
oCTETsTRING
).
vÆue
 = 
NULL
; \

45 (
oCTETsTRING
).
Àngth
 = 0; \

46 } 0);

	)

49 
	#DUP_OCTET_STRING
(
oCTETsTRINGoRIG
,
oCTETsTRINGcOPY
) \

51 i‡((
oCTETsTRINGoRIG
).
vÆue
 =
NULL
) { \

52 (
oCTETsTRINGcOPY
).
Àngth
 = 0; \

53 (
oCTETsTRINGcOPY
).
vÆue
 = 
NULL
; \

56 (
oCTETsTRINGcOPY
).
Àngth
 = 
	`°æí
((c⁄° *)(
oCTETsTRINGoRIG
).
vÆue
);\

57 
	`as£π
((
oCTETsTRINGoRIG
).
Àngth
 =(
oCTETsTRINGcOPY
).length); \

58 (
oCTETsTRINGcOPY
).
vÆue
 = 
	`mÆloc
((
oCTETsTRINGoRIG
).
Àngth
); \

59 
	`mem˝y
((
oCTETsTRINGcOPY
).
vÆue
, \

60 (
oCTETsTRINGoRIG
).
vÆue
, \

61 (
oCTETsTRINGoRIG
).
Àngth
); \

62 } 0);

	)

64 
O˘ëSåög
* 
dup_o˘ë_°rög
(O˘ëSåög*
o˘ë°rög
);

66 
‰ì_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
);

68 
ícode_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
Àn
);

70 
decode_o˘ë_°rög
(
O˘ëSåög
 *
o˘ë°rög
, 
uöt16_t
 
pduÀn
, 
uöt8_t
 *
buf„r
, 
uöt32_t
 
buÊí
);

72 * 
dump_o˘ë_°rög_xml
(c⁄° 
O˘ëSåög
 * c⁄° 
o˘ë°rög
);

74 * 
dump_o˘ë_°rög
(c⁄° 
O˘ëSåög
 * c⁄° 
o˘ë°rög
);

	@src/util/TLVDecoder.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

33 
	~"TLVDecodî.h
"

35 
	gîr‹CodeDecodî
 = 0;

37 c⁄° *
	gîr‹CodeSåögDecodî
[] = {

48 
	$év_decode_≥º‹
()

50 i‡(
îr‹CodeDecodî
 >= 0)

53 
	`¥ötf
("TLV decodîÉº‹: (%d, %s)\n", 
îr‹CodeDecodî
, 
îr‹CodeSåögDecodî
[errorCodeDecoder * -1]);

54 
	}
}

	@src/util/TLVDecoder.h

29 #i‚de‡
TLV_DECODER_H_


30 
	#TLV_DECODER_H_


	)

32 
	~<¨∑/öë.h
>

33 
	~"«s_log.h
"

35 #i‚de‡
NAS_DEBUG


36 
	#NAS_DEBUG
 1

	)

39 
	#DECODE_U8
(
bUFFER
, 
vALUE
, 
sIZE
) \

40 
vALUE
 = *(
uöt8_t
*)(
bUFFER
); \

41 
sIZE
 +(
uöt8_t
)

	)

43 
	#DECODE_U16
(
bUFFER
, 
vALUE
, 
sIZE
) \

44 
vALUE
 = 
	`¡ohs
(*(
uöt16_t
*)(
bUFFER
)); \

45 
sIZE
 +(
uöt16_t
)

	)

47 
	#DECODE_U24
(
bUFFER
, 
vALUE
, 
sIZE
) \

48 
vALUE
 = 
	`¡ohl
(*(
uöt32_t
*)(
bUFFER
)) >> 8; \

49 
sIZE
 +(
uöt8_t
Ë+ (
uöt16_t
)

	)

51 
	#DECODE_U32
(
bUFFER
, 
vALUE
, 
sIZE
) \

52 
vALUE
 = 
	`¡ohl
(*(
uöt32_t
*)(
bUFFER
)); \

53 
sIZE
 +(
uöt32_t
)

	)

55 #i‡(
BYTE_ORDER
 =
LITTLE_ENDIAN
)

56 
	#DECODE_LENGTH_U16
(
bUFFER
, 
vALUE
, 
sIZE
) \

57 
vALUE
 = ((*(
bUFFER
)) << 8) | (*((bUFFER) + 1)); \

58 
sIZE
 +(
uöt16_t
)

	)

60 
	#DECODE_LENGTH_U16
(
bUFFER
, 
vALUE
, 
sIZE
) \

61 
vALUE
 = (*(
bUFFER
)) | (*((bUFFER) + 1) << 8); \

62 
sIZE
 +(
uöt16_t
)

	)

65 
	#IES_DECODE_U8
(
bUFFER
, 
dECODED
, 
vALUE
) \

66 
	`DECODE_U8
(
bUFFER
 + 
dECODED
, 
vALUE
, dECODED)

	)

68 
	#IES_DECODE_U16
(
bUFFER
, 
dECODED
, 
vALUE
) \

69 
	`DECODE_U16
(
bUFFER
 + 
dECODED
, 
vALUE
, dECODED)

	)

71 
	#IES_DECODE_U24
(
bUFFER
, 
dECODED
, 
vALUE
) \

72 
	`DECODE_U24
(
bUFFER
 + 
dECODED
, 
vALUE
, dECODED)

	)

74 
	#IES_DECODE_U32
(
bUFFER
, 
dECODED
, 
vALUE
) \

75 
	`DECODE_U32
(
bUFFER
 + 
dECODED
, 
vALUE
, dECODED)

	)

78 
	mTLV_DECODE_ERROR_OK
 = 0,

79 
	mTLV_DECODE_UNEXPECTED_IEI
 = -1,

80 
	mTLV_DECODE_MANDATORY_FIELD_NOT_PRESENT
 = -2,

81 
	mTLV_DECODE_VALUE_DOESNT_MATCH
 = -3,

84 
	mTLV_DECODE_WRONG_MESSAGE_TYPE
 = -10,

85 
	mTLV_DECODE_PROTOCOL_NOT_SUPPORTED
 = -11,

86 
	mTLV_DECODE_BUFFER_TOO_SHORT
 = -12,

87 
	mTLV_DECODE_BUFFER_NULL
 = -13,

88 
	mTLV_DECODE_MAC_MISMATCH
 = -14,

89 } 
	tév_decodî_îr‹_code
;

93 
	#TLV_DECODE_FATAL_ERROR
 (
TLV_DECODE_VALUE_DOESNT_MATCH
)

	)

95 
îr‹CodeDecodî
;

97 
év_decode_≥º‹
();

99 
	#CHECK_PDU_POINTER_AND_LENGTH_DECODER
(
bUFFER
, 
mINIMUMlENGTH
, 
lENGTH
) \

100 i‡(
bUFFER
 =
NULL
) \

102 
	`¥ötf
("(%s:%d) Got NULLÖointer forÅheÖayload\n", \

103 
__FILE__
, 
__LINE__
); \

104 
îr‹CodeDecodî
 = 
TLV_DECODE_BUFFER_NULL
; \

105 
	`LOG_FUNC_RETURN
(
TLV_DECODE_BUFFER_NULL
); \

107 i‡(
lENGTH
 < 
mINIMUMlENGTH
) \

109 
	`¥ötf
("(%s:%d) ExpectingátÜeast %d bytes, got %d\n", \

110 
__FILE__
, 
__LINE__
, 
mINIMUMlENGTH
, 
lENGTH
); \

111 
îr‹CodeDecodî
 = 
TLV_DECODE_BUFFER_TOO_SHORT
; \

112 
	`LOG_FUNC_RETURN
(
TLV_DECODE_BUFFER_TOO_SHORT
); \

113 }

	)

115 
	#CHECK_LENGTH_DECODER
(
bUFFERlENGTH
, 
lENGTH
) \

116 i‡(
bUFFERlENGTH
 < 
lENGTH
) \

118 
îr‹CodeDecodî
 = 
TLV_DECODE_BUFFER_TOO_SHORT
; \

119 
	`LOG_FUNC_RETURN
(
TLV_DECODE_BUFFER_TOO_SHORT
); \

120 }

	)

122 
	#CHECK_MESSAGE_TYPE
(
mESSAGE_tYPE
, 
bUFFER
) \

124 i‡(
mESSAGE_tYPE
 !
bUFFER
) \

126 
îr‹CodeDecodî
 = 
TLV_DECODE_WRONG_MESSAGE_TYPE
; \

127 
	`LOG_FUNC_RETURN
(
îr‹CodeDecodî
); \

129 }

	)

131 
	#CHECK_IEI_DECODER
(
iEI
, 
bUFFER
) \

132 if(
iEI
 !
bUFFER
) \

134 
	`¥ötf
("IEI is differentÅhanÅhe oneÉxpected." \

135 "(GŸ: 0x%x,Éx≥˘ög: 0x%x\n", 
bUFFER
, 
iEI
); \

136 
îr‹CodeDecodî
 = 
TLV_DECODE_UNEXPECTED_IEI
; \

137 
	`LOG_FUNC_RETURN
(
TLV_DECODE_UNEXPECTED_IEI
); \

138 }

	)

	@src/util/TLVEncoder.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

33 
	~"TLVEncodî.h
"

35 
	gîr‹CodeEncodî
 = 0;

37 c⁄° *
	gîr‹CodeSåögEncodî
[] = {

46 
	$év_ícode_≥º‹
()

48 i‡(
îr‹CodeEncodî
 >= 0)

51 
	`¥ötf
("îr‹: (%d, %s)\n", 
îr‹CodeEncodî
, 
îr‹CodeSåögEncodî
[errorCodeEncoder * -1]);

52 
	}
}

	@src/util/TLVEncoder.h

29 #i‚de‡
TLV_ENCODER_H_


30 
	#TLV_ENCODER_H_


	)

32 
	~<¨∑/öë.h
>

34 
	#ENCODE_U8
(
buf„r
, 
vÆue
, 
size
) \

35 *(
uöt8_t
*)(
buf„r
Ë
vÆue
; \

36 
size
 +(
uöt8_t
)

	)

38 
	#ENCODE_U16
(
buf„r
, 
vÆue
, 
size
) \

39 *(
uöt16_t
*)(
buf„r
Ë
	`ht⁄s
(
vÆue
); \

40 
size
 +(
uöt16_t
)

	)

42 
	#ENCODE_U24
(
buf„r
, 
vÆue
, 
size
) \

43 *(
uöt32_t
*)(
buf„r
Ë
	`ht⁄l
(
vÆue
); \

44 
size
 +(
uöt8_t
Ë+ (
uöt16_t
)

	)

46 
	#ENCODE_U32
(
buf„r
, 
vÆue
, 
size
) \

47 *(
uöt32_t
*)(
buf„r
Ë
	`ht⁄l
(
vÆue
); \

48 
size
 +(
uöt32_t
)

	)

50 
	#IES_ENCODE_U8
(
buf„r
, 
ícoded
, 
vÆue
) \

51 
	`ENCODE_U8
(
buf„r
 + 
ícoded
, 
vÆue
,Éncoded)

	)

53 
	#IES_ENCODE_U16
(
buf„r
, 
ícoded
, 
vÆue
) \

54 
	`ENCODE_U16
(
buf„r
 + 
ícoded
, 
vÆue
,Éncoded)

	)

56 
	#IES_ENCODE_U24
(
buf„r
, 
ícoded
, 
vÆue
) \

57 
	`ENCODE_U24
(
buf„r
 + 
ícoded
, 
vÆue
,Éncoded)

	)

59 
	#IES_ENCODE_U32
(
buf„r
, 
ícoded
, 
vÆue
) \

60 
	`ENCODE_U32
(
buf„r
 + 
ícoded
, 
vÆue
,Éncoded)

	)

63 
	mTLV_ENCODE_ERROR_OK
 = 0,

64 
	mTLV_ENCODE_VALUE_DOESNT_MATCH
 = -1,

66 
	mTLV_ENCODE_OCTET_STRING_TOO_LONG_FOR_IEI
 = -10,

67 
	mTLV_ENCODE_WRONG_MESSAGE_TYPE
 = -11,

68 
	mTLV_ENCODE_PROTOCOL_NOT_SUPPORTED
 = -12,

69 
	mTLV_ENCODE_BUFFER_TOO_SHORT
 = -13,

70 
	mTLV_ENCODE_BUFFER_NULL
 = -14,

71 } 
	tév_ícodî_îr‹_code
;

75 
	#TLV_ENCODE_FATAL_ERROR
 (
TLV_ENCODE_VALUE_DOESNT_MATCH
)

	)

77 
îr‹CodeEncodî
;

79 
év_ícode_≥º‹
();

81 
	#CHECK_PDU_POINTER_AND_LENGTH_ENCODER
(
bUFFER
, 
mINIMUMlENGTH
, 
lENGTH
) \

82 i‡(
bUFFER
 =
NULL
) \

84 
	`¥ötf
("Got NULLÖointer forÅheÖayload\n"); \

85 
îr‹CodeEncodî
 = 
TLV_ENCODE_BUFFER_NULL
; \

86  
TLV_ENCODE_BUFFER_NULL
; \

88 i‡(
lENGTH
 < 
mINIMUMlENGTH
) \

90 
	`¥ötf
("(%s:%d) ExpectingátÜeast %d bytes, got %d\n", \

91 
__FILE__
, 
__LINE__
, 
mINIMUMlENGTH
, 
lENGTH
); \

92 
îr‹CodeEncodî
 = 
TLV_ENCODE_BUFFER_TOO_SHORT
; \

93  
TLV_ENCODE_BUFFER_TOO_SHORT
; \

94 }

	)

96 
	#CHECK_PDU_POINTER_ENCODER
(
bUFFER
) \

97 i‡(
bUFFER
 =
NULL
) \

99 
	`¥ötf
("Got NULLÖointer forÅheÖayload\n"); \

100 
îr‹CodeEncodî
 = 
TLV_ENCODE_BUFFER_NULL
; \

101  
TLV_ENCODE_BUFFER_NULL
; \

102 }

	)

	@src/util/device.c

46 
	~"devi˚.h
"

47 
	~"comm⁄Def.h
"

49 
	~<°dio.h
>

50 
	~<°dlib.h
>

51 
	~<°rög.h
>

52 
	~<uni°d.h
>

54 
	~<sys/°©.h
>

55 
	~<f˙é.h
>

62 
°ty_£t
(
fd
, c⁄° *
∑øms
);

75 
	sdevi˚_id_s
 {

76 
	#DEVICE_PATHNAME_SIZE
 32

	)

77 
	m∑th«me
[
DEVICE_PATHNAME_SIZE
+1];

78 
	mfd
;

103 * 
	$devi˚_›í
(
ty≥
, c⁄° * 
dev∑th
, c⁄° * 
∑øms
)

105 
fd
;

108 i‡(
dev∑th
 =
NULL
) {

109  
NULL
;

111 i‡(
ty≥
 !
DEVICE
) {

112  
NULL
;

116 
fd
 = 
	`›í
(
dev∑th
, 
O_RDWR
);

117 i‡(
fd
 < 0) {

118  
NULL
;

122 
devi˚_id_t
 * 
devid
 = (devi˚_id_à*)
	`mÆloc
((
devi˚_id_s
));

123 i‡(
devid
 !
NULL
) {

124 
	`°∫˝y
(
devid
->
∑th«me
, 
dev∑th
, 
DEVICE_PATHNAME_SIZE
);

125 
devid
->
fd
 = fd;

126 i‡(
∑øms
 !
NULL
) {

128 i‡(
	`°ty_£t
(
fd
, 
∑øms
Ë!
RETURNok
) {

129 
	`devi˚_˛o£
(
devid
);

130 
devid
 = 
NULL
;

134  
devid
;

135 
	}
}

152 
	$devi˚_˛o£
(* 
id
)

154 i‡(
id
) {

155 
	`˛o£
–((
devi˚_id_t
*)
id
)->
fd
 );

156 
	`‰ì
(
id
);

158 
	}
}

177 
ssize_t
 
	$devi˚_ªad
(* 
id
, * 
buf„r
, 
size_t
 
Àn
)

179 c⁄° 
devi˚_id_t
* 
devid
 = (devi˚_id_t*)(
id
);

181 
ssize_t
 
rbyãs
 = 
	`ªad
(
devid
->
fd
, 
buf„r
, 
Àn
);

182 i‡(
rbyãs
 < 0) {

183  
RETURNîr‹
;

188 
ssize_t
 
rbyãs
 = 0;

190 
ssize_t
 
size
 = 
	`ªad
(
devid
->
fd
, 
buf„r
 + 
rbyãs
, 
Àn
 -Ñbytes);

191 i‡(
size
 < 0) {

192  
RETURNîr‹
;

194 
rbyãs
 +
size
;

195 }  (
buf„r
[
rbyãs
-1] != '\r') && (buffer[rbytes-1] != '\n')

196 && (
buf„r
[
rbyãs
-1] != '\0') );

199  
rbyãs
;

200 
	}
}

220 
ssize_t
 
	$devi˚_wrôe
(c⁄° * 
id
, c⁄° * 
buf„r
, 
size_t
 
Àn
)

222 c⁄° 
devi˚_id_t
* 
devid
 = (devi˚_id_t*)(
id
);

223 
ssize_t
 
sbyãs
 = 
	`wrôe
(
devid
->
fd
, 
buf„r
, 
Àn
);

224 
	`fÊush
(
NULL
);

226 i‡(
sbyãs
 !
Àn
) {

227  
RETURNîr‹
;

229  
sbyãs
;

230 
	}
}

247 
	$devi˚_gë_fd
(c⁄° * 
id
)

249 i‡(
id
) {

250  ((
devi˚_id_t
*)
id
)->
fd
;

252  
RETURNîr‹
;

253 
	}
}

	@src/util/device.h

45 #i‚de‡
__DEVICE_H__


46 
	#__DEVICE_H__


	)

48 
	~<sys/ty≥s.h
>

59 
	#DEVICE
 3

	)

62 
devi˚_id_s
 
	tdevi˚_id_t
;

72 * 
devi˚_›í
(
ty≥
, c⁄° * 
dev«me
, c⁄° * 
∑øms
);

73 
devi˚_gë_fd
(c⁄° * 
id
);

75 
ssize_t
 
devi˚_ªad
(* 
id
, * 
buf„r
, 
size_t
 
Àngth
);

76 
ssize_t
 
devi˚_wrôe
(c⁄° * 
id
, c⁄° * 
buf„r
, 
size_t
 
Àngth
);

78 
devi˚_˛o£
(* 
id
);

	@src/util/memory.c

46 
	~"mem‹y.h
"

47 
	~"comm⁄Def.h
"

48 
	~"«s_log.h
"

50 
	~<°dio.h
>

51 
	~<°dlib.h
>

52 
	~<°rög.h
>

85 * 
	$mem‹y_gë_∑th
(c⁄° * 
dú«me
, c⁄° * 
fûíame
)

88 c⁄° * 
∑th
 = 
	`gëív
(
dú«me
);

89 i‡(
∑th
 =
NULL
) {

90 
∑th
 = 
	`gëív
(
DEFAULT_NAS_PATH
);

92 i‡(
∑th
 =
NULL
) {

93 
	`LOG_TRACE
(
WARNING
, "MEMORY - %†™d %†ívú⁄míàv¨übÀ†¨ênŸ deföedÅryögÜoˇ»dúe˘‹y", 
dú«me
, 
DEFAULT_NAS_PATH
);

94 
∑th
 = ".";

98 
size_t
 
size
 = 
	`°æí
(
∑th
Ë+ såÀn(
fûíame
) + 1;

99 * 
d©a_fûíame
 = (*)
	`mÆloc
(
size
+1);

100 i‡(
d©a_fûíame
 !
NULL
) {

101 i‡(
size
 !
	`•rötf
(
d©a_fûíame
, "%s/%s", 
∑th
, 
fûíame
)) {

102 
	`‰ì
(
d©a_fûíame
);

103  
NULL
;

107  
d©a_fûíame
;

108 
	}
}

125 
	$mem‹y_ªad
(c⁄° * 
d©afûe
, * 
d©a
, 
size_t
 
size
)

127 
rc
 = 
RETURNîr‹
;

130 
FILE
* 
Â
 = 
	`f›í
(
d©afûe
, "rb");

131 i‡(
Â
 !
NULL
) {

133 
size_t
 
n
 = 
	`‰ód
(
d©a
, 
size
, 1, 
Â
);

134 i‡(
n
 == 1) {

135 
rc
 = 
RETURNok
;

138 
	`f˛o£
(
Â
);

141  (
rc
);

142 
	}
}

160 
	$mem‹y_wrôe
(c⁄° * 
d©afûe
, c⁄° * 
d©a
, 
size_t
 
size
)

162 
rc
 = 
RETURNîr‹
;

165 
FILE
* 
Â
 = 
	`f›í
(
d©afûe
, "wb");

166 i‡(
Â
 !
NULL
) {

168 
size_t
 
n
 = 
	`fwrôe
(
d©a
, 
size
, 1, 
Â
);

169 i‡(
n
 == 1) {

170 
rc
 = 
RETURNok
;

173 
	`f˛o£
(
Â
);

176  (
rc
);

177 
	}
}

	@src/util/memory.h

45 #i‚de‡
__MEMORY_H__


46 
	#__MEMORY_H__


	)

48 
	~<°ddef.h
>

66 * 
mem‹y_gë_∑th
(c⁄° * 
dú«me
, c⁄° * 
fûíame
);

68 
mem‹y_ªad
(c⁄° * 
d©afûe
, * 
d©a
, 
size_t
 
size
);

70 
mem‹y_wrôe
(c⁄° * 
d©afûe
, c⁄° * 
d©a
, 
size_t
 
size
);

	@src/util/nas_log.c

46 
	~"«s_log.h
"

47 #i‡
deföed
(
UE_BUILD
Ë&& deföed(
NAS_UE
)

48 
	g«s_log_func_ödít
;

50 
	~<°dio.h
>

51 
	~<°d¨g.h
>

58 
	#LOG_BLACK
 "\033[30m"

	)

59 
	#LOG_RED
 "\033[31m"

	)

60 
	#LOG_GREEN
 "\033[32m"

	)

61 
	#LOG_YELLOW
 "\033[33m"

	)

62 
	#LOG_BLUE
 "\033[34m"

	)

63 
	#LOG_MAGENTA
 "\033[35m"

	)

64 
	#LOG_CYAN
 "\033[36m"

	)

65 
	#LOG_WHITE
 "\033[37m"

	)

66 
	#LOG_END
 "\033[0m"

	)

67 
	#LOG_AUTO
 
LOG_END


	)

89 
	#LOG_PREFIX_SIZE
 96

	)

90 
	m¥efix
[
LOG_PREFIX_SIZE
];

91 
	mfûãr
;

92 
	mödít
;

94 * 
	m«me
;

95 
	mmask
;

96 * 
	mcﬁ‹
;

97 } 
	mÀvñ
[];

98 } 
	tlog_c⁄ãxt_t
;

103 
log_c⁄ãxt_t
 
	g_log_c⁄ãxt
 = {

108 { "DEBUG", 
NAS_LOG_DEBUG
, 
LOG_GREEN
 },

109 { "INFO", 
NAS_LOG_INFO
, 
LOG_AUTO
 },

110 { "WARNING", 
NAS_LOG_WARNING
, 
LOG_BLUE
 },

111 { "ERROR", 
NAS_LOG_ERROR
, 
LOG_RED
 },

112 { "", 
NAS_LOG_FUNC
, 
LOG_AUTO
 },

113 { "", 
NAS_LOG_FUNC
, 
LOG_AUTO
 },

118 
	#LOG_DUMP_LINE_SIZE
 16

	)

139 
	$«s_log_öô
(
fûãr
)

141 
_log_c⁄ãxt
.
fûãr
 = filter;

142 
	}
}

159 
	$log_d©a
(c⁄° * 
fûíame
, 
löe
)

161 
	`¢¥ötf
(
_log_c⁄ãxt
.
¥efix
, 
LOG_PREFIX_SIZE
, "%s[%d]", 
fûíame
, 
löe
);

162 
	}
}

178 
	$log_åa˚
(
log_£vîôy_t
 
£vîôy
, c⁄° * 
d©a
, ...)

180 
i
;

183 i‡(
£vîôy
 > 
LOG_SEVERITY_MAX
) ;

186 i‡(
_log_c⁄ãxt
.
Àvñ
[
£vîôy
].
mask
 & _log_c⁄ãxt.
fûãr
)

188 
va_li°
 
¨gp
;

195 
	`Ârötf
(
°dîr
, "%s%-60.58s%-10s", 
_log_c⁄ãxt
.
Àvñ
[
£vîôy
].
cﬁ‹
,

196 
_log_c⁄ãxt
.
¥efix
, _log_c⁄ãxt.
Àvñ
[
£vîôy
].
«me
);

199 i‡(
£vîôy
 =
FUNC_OUT
) {

200 
_log_c⁄ãxt
.
ödít
--;

202 
i
=0; i<
_log_c⁄ãxt
.
ödít
; i++) {

203 
	`Ârötf
(
°dîr
, "\t");

205 i‡(
£vîôy
 =
FUNC_IN
) {

206 
_log_c⁄ãxt
.
ödít
++;

211 
	`va_°¨t
(
¨gp
, 
d©a
);

212 
	`vÂrötf
(
°dîr
, 
d©a
, 
¨gp
);

215 
	`Ârötf
(
°dîr
, "%s\n", 
LOG_END
);

217 
	`va_íd
(
¨gp
);

219 
	}
}

235 
	$log_dump
(c⁄° * 
d©a
, 
Àn
)

237 
i
;

239 i‡–(
Àn
 > 0Ë&& (
NAS_LOG_HEX
 & 
_log_c⁄ãxt
.
fûãr
) )

241 
byãs
 = 0;

243 
	`Ârötf
(
°dîr
, "\n\t");

245 
i
=0; i < 
Àn
; i++)

247 
	`Ârötf
(
°dîr
, "%.2hx ", (c⁄° Ë
d©a
[
i
]);

251 i‡–++
byãs
 > (
LOG_DUMP_LINE_SIZE
 - 1) ) {

252 
byãs
 = 0;

253 
	`Ârötf
(
°dîr
, "\n\t");

257 i‡(
byãs
 % 
LOG_DUMP_LINE_SIZE
) {

258 
	`Ârötf
(
°dîr
, "\n");

261 
	`Ârötf
(
°dîr
, "\n");

262 
	`fÊush
(
°dîr
);

264 
	}
}

	@src/util/nas_log.h

45 #i‚de‡
__NAS_LOG_H__


46 
	#__NAS_LOG_H__


	)

48 #i‡
deföed
(
UE_BUILD
Ë&& deföed(
NAS_UE
)

49 
	~"UTIL/LOG/log.h
"

50 #unde‡
LOG_TRACE


71 
	#NAS_LOG_OFF
 0x00

	)

72 
	#NAS_LOG_DEBUG
 0x01

	)

73 
	#NAS_LOG_INFO
 0x02

	)

74 
	#NAS_LOG_WARNING
 0x04

	)

75 
	#NAS_LOG_ERROR
 0x08

	)

76 
	#NAS_LOG_FUNC
 0x10

	)

77 
	#NAS_LOG_HEX
 0x20

	)

79 
	#NAS_LOG_ON
 0x0F

	)

80 
	#NAS_LOG_ALL
 0xFF

	)

85 
	mDEBUG
,

86 
	mINFO
,

87 
	mWARNING
,

88 
	mERROR
,

89 
	mFUNC_IN
,

90 
	mFUNC_OUT
,

91 
	mLOG_SEVERITY_MAX


92 } 
	tlog_£vîôy_t
;

106 #i‡
deföed
(
UE_BUILD
Ë&& deföed(
NAS_UE
)

107 
	#LOG_TRACE
(
s
, 
x
, 
¨gs
...) \

109 
s
) { \

110 
ERROR
: 
	`LOG_E
(
NAS
, " %s:%d " 
x
 "\n", 
__FILE__
, 
__LINE__
, ##
¨gs
); ; \

111 
WARNING
: 
	`LOG_W
(
NAS
, " %s:%d " 
x
 "\n", 
__FILE__
, 
__LINE__
, ##
¨gs
); ; \

112 
INFO
: 
	`LOG_I
(
NAS
, " %s:%d " 
x
 "\n", 
__FILE__
, 
__LINE__
, ##
¨gs
); ; \

113 : 
	`LOG_D
(
NAS
, " %s:%d " 
x
 "\n", 
__FILE__
, 
__LINE__
, ##
¨gs
); ; \

115 } 0)

	)

117 
	#LOG_DUMP
(
dATA
, 
lEN
) \

119 
buf„r
[3*
lEN
 + 1]; \

120 
i
; \

121 
i
 = 0; i < 
lEN
; i++) \

122 
	`•rötf
 (&
buf„r
[3*
i
], "%02x ", 
dATA
[i]); \

123 
	`LOG_D
(
NAS
, " Dum∞%d: %s\n", 
lEN
, 
buf„r
); \

124 } 0)

	)

126 
	#LOG_FUNC_IN
 \

128 
	`LOG_D
(
NAS
, " %s:%d %*sE¡îög %s()\n", 
__FILE__
, 
__LINE__
, 
«s_log_func_ödít
, "", 
__FUNCTION__
); \

129 
«s_log_func_ödít
 += 4; \

130 } 0)

	)

132 
	#LOG_FUNC_OUT
 \

134 
«s_log_func_ödít
 -= 4; \

135 
	`LOG_D
(
NAS
, " %s:%d %*sLóvög %s()\n", 
__FILE__
, 
__LINE__
, 
«s_log_func_ödít
, "", 
__FUNCTION__
); \

136 } 0)

	)

138 
	#LOG_FUNC_RETURN
(
rETURNcODE
) \

140 
«s_log_func_ödít
 -= 4; \

141 
	`LOG_D
(
NAS
, " %s:%d %*sLóvög %s‘¯%ld)\n", 
__FILE__
, 
__LINE__
, 
«s_log_func_ödít
, "", \

142 
__FUNCTION__
, (Ë
rETURNcODE
); \

143  (
rETURNcODE
); \

144 } 0)

	)

146 
«s_log_func_ödít
;

149 
	#LOG_TRACE
 
	`log_d©a
(
__FILE__
, 
__LINE__
); 
log_åa˚


	)

150 
	#LOG_DUMP
(
a
, 
b
Ë
	`log_dump
(◊),(b));

	)

152 
	#LOG_FUNC_IN
 
	`LOG_TRACE
(
FUNC_IN
, "E¡îög %s()", 
__FUNCTION__
)

	)

153 
	#LOG_FUNC_OUT
 
	`LOG_TRACE
(
FUNC_OUT
, "Lóvög %s()", 
__FUNCTION__
)

	)

154 
	#LOG_FUNC_RETURN
(
rETURNcODE
) \

156 
	`LOG_TRACE
(
FUNC_OUT
, "Lóvög %s‘¯%ld)", 
__FUNCTION__
, \

157 (Ë
rETURNcODE
); \

158  (
rETURNcODE
); \

159 } 0)

	)

161 
«s_log_öô
(
fûãr
);

162 
log_d©a
(c⁄° * 
fûíame
, 
löe
);

163 
log_åa˚
(
log_£vîôy_t
 
£vîôy
, c⁄° * 
d©a
, ...);

164 
log_dump
(c⁄° * 
d©a
, 
Àn
);

	@src/util/nas_timer.c

46 
	~<±hªad.h
>

47 
	~<as£π.h
>

48 
	~<°döt.h
>

50 
	~<°rög.h
>

51 
	~<°dlib.h
>

52 
	~<sys/time.h
>

54 #i‡
deföed
(
ENABLE_ITTI
)

55 
	~"öãπask_öãrÁ˚.h
"

56 
	~"timî.h
"

58 
	~<sig«l.h
>

59 
	~<time.h
>

61 
	~"«s_timî.h
"

62 
	~"comm⁄Def.h
"

79 #i‡
deföed
(
ENABLE_ITTI
)

80 
	mtimî_id
;

82 
±hªad_t
 
	mpid
;

85 
timevÆ
 
	môv
;

86 
timevÆ
 
	mtv
;

88 
«s_timî_ˇŒback_t
 
	mcb
;

89 *
	m¨gs
;

90 } 
	t«s_timî_íåy_t
;

98 
	s_«s_timî_queue_t
 {

99 
	mid
;

100 
«s_timî_íåy_t
 *
	míåy
;

101 
_«s_timî_queue_t
 *
	m¥ev
;

102 
_«s_timî_queue_t
 *
	m√xt
;

103 } 
	ttimî_queue_t
;

111 
	mtimî_id
;

112 
	#TIMER_DATABASE_SIZE
 256

	)

113 
timî_queue_t
 
	mtq
[
TIMER_DATABASE_SIZE
];

114 
timî_queue_t
 *
	mhód
;

116 #i‡!
deföed
(
ENABLE_ITTI
)

117 
±hªad_muãx_t
 
	mmuãx
;

119 } 
	t«s_timî_d©aba£_t
;

124 
«s_timî_d©aba£_t
 
	g_«s_timî_db
 = {

127 
NULL


128 #i‡!
deföed
(
ENABLE_ITTI
)

129 , 
PTHREAD_MUTEX_INITIALIZER


133 #i‡
deföed
(
ENABLE_ITTI
)

134 
	#«s_timî_lock_db
()

	)

135 
	#«s_timî_u∆ock_db
()

	)

137 
	#«s_timî_lock_db
(Ë
	`±hªad_muãx_lock
(&
_«s_timî_db
.
muãx
)

	)

138 
	#«s_timî_u∆ock_db
(Ë
	`±hªad_muãx_u∆ock
(&
_«s_timî_db
.
muãx
)

	)

144 #i‡!
deföed
(
ENABLE_ITTI
)

145 
_«s_timî_h™dÀr
(
sig«l
);

153 
_«s_timî_db_öô
();

155 
_«s_timî_db_gë_id
();

156 
_«s_timî_db_is_a˘ive
(
id
);

157 
«s_timî_íåy_t
 *
_«s_timî_db_¸óã_íåy
(
£c
,

158 
«s_timî_ˇŒback_t
 
cb
, *
¨gs
);

159 
_«s_timî_db_dñëe_íåy
(
id
);

161 
_«s_timî_db_ö£π_íåy
(
id
, 
«s_timî_íåy_t
 *
ã
);

162 
_«s_timî_db_ö£π
(
timî_queue_t
 *
íåy
);

164 
«s_timî_íåy_t
 *
_«s_timî_db_ªmove_íåy
(
id
);

165 
_«s_timî_db_ªmove
(
timî_queue_t
 *
íåy
);

172 
_«s_timî_cmp
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
);

173 
_«s_timî_add
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
,

174 
timevÆ
 *
ªsu…
);

175 
_«s_timî_sub
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
,

176 
timevÆ
 *
ªsu…
);

196 
	$«s_timî_öô
()

199 
	`_«s_timî_db_öô
();

201 #i‡!
	`deföed
(
ENABLE_ITTI
)

203 
siga˘i⁄
 
a˘
;

205 (Ë
	`mem£t
 (&
a˘
, 0,  (act));

206 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

207 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

208 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

209 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

210 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

211 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

212 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

213 #i‚de‡
LINUX


214 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

216 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

217 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

218 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

219 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

221 
a˘
.
ß_h™dÀr
 = 
_«s_timî_h™dÀr
;

222 i‡–
	`siga˘i⁄
 (
SIGALRM
, &
a˘
, 0) < 0 ) {

223  (
RETURNîr‹
);

226  (
RETURNok
);

227 
	}
}

247 
	$«s_timî_°¨t
(
£c
, 
«s_timî_ˇŒback_t
 
cb
, *
¨gs
)

249 
id
;

250 
«s_timî_íåy_t
 *
ã
;

251 #i‡
	`deföed
(
ENABLE_ITTI
)

252 
ªt
;

253 
timî_id
;

257 i‡(
£c
 == 0) {

258  (
NAS_TIMER_INACTIVE_ID
);

262 
id
 = 
	`_«s_timî_db_gë_id
();

263 i‡(
id
 < 0) {

265  (
NAS_TIMER_INACTIVE_ID
);

269 
ã
 = 
	`_«s_timî_db_¸óã_íåy
(
£c
, 
cb
, 
¨gs
);

270 i‡(
ã
 =
NULL
) {

271  (
NAS_TIMER_INACTIVE_ID
);

275 
	`_«s_timî_db_ö£π_íåy
(
id
, 
ã
);

276 #i‡
	`deföed
(
ENABLE_ITTI
)

277 #i‡
	`deföed
(
EPC_BUILD
)

278 
ªt
 = 
	`timî_£tup
(
£c
, 0, 
TASK_NAS_MME
, 
INSTANCE_DEFAULT
, 
TIMER_PERIODIC
, 
¨gs
, &
timî_id
);

280 
ªt
 = 
	`timî_£tup
(
£c
, 0, 
TASK_NAS_UE
, 
INSTANCE_DEFAULT
, 
TIMER_PERIODIC
, 
¨gs
, &
timî_id
);

282 i‡(
ªt
 == -1) {

283  
NAS_TIMER_INACTIVE_ID
;

286 
ã
->
timî_id
 =Åimer_id;

289  (
id
);

290 
	}
}

307 
	$«s_timî_°›
(
id
)

310 i‡(
	`_«s_timî_db_is_a˘ive
(
id
)) {

311 
«s_timî_íåy_t
 *
íåy
;

313 
íåy
 = 
	`_«s_timî_db_ªmove_íåy
(
id
);

314 #i‡
	`deföed
(
ENABLE_ITTI
)

315 
	`timî_ªmove
(
íåy
->
timî_id
);

317 ()
íåy
;

320 
	`_«s_timî_db_dñëe_íåy
(
id
);

321  (
NAS_TIMER_INACTIVE_ID
);

323  (
id
);

324 
	}
}

345 
	$«s_timî_ª°¨t
(
id
)

348 i‡(
	`_«s_timî_db_is_a˘ive
(
id
)) {

350 
«s_timî_íåy_t
 *
ã
 = 
	`_«s_timî_db_ªmove_íåy
(
id
);

352 
ã
->
tv
 =Åe->
ôv
;

354 
	`_«s_timî_db_ö£π_íåy
(
id
, 
ã
);

355  (
id
);

357  (
NAS_TIMER_INACTIVE_ID
);

358 
	}
}

383 #i‡
deföed
(
ENABLE_ITTI
)

384 
	$«s_timî_h™dÀ_sig«l_expúy
(
timî_id
, *
¨g_p
)

387 
«s_timî_íåy_t
 *
ã
 = 
_«s_timî_db
.
hód
->
íåy
;

389 
ã
->
	`cb
—e->
¨gs
);

390 
	}
}

392 
	$_«s_timî_h™dÀr
(
sig«l
)

395 
	`as£π
–(
_«s_timî_db
.
hód
 !
NULL
Ë&& (_«s_timî_db.hód->
íåy
 != NULL) );

398 
«s_timî_íåy_t
 *
ã
 = 
_«s_timî_db
.
hód
->
íåy
;

401 
±hªad_©å_t
 
©å
;

402 
	`±hªad_©å_öô
(&
©å
);

403 
	`±hªad_©å_£tsc›e
(&
©å
, 
PTHREAD_SCOPE_SYSTEM
);

404 
	`±hªad_©å_£tdëach°©e
(&
©å
, 
PTHREAD_CREATE_JOINABLE
);

405 
rc
 = 
	`±hªad_¸óã
 (&
ã
->
pid
, &
©å
,Åe->
cb
,Åe->
¨gs
);

406 
	`±hªad_©å_de°roy
(&
©å
);

409 i‡(
rc
 == 0) {

410 *
ªsu…
 = 
NULL
;

411 (Ë
	`±hªad_joö
(
ã
->
pid
, &
ªsu…
);

413 i‡(
ªsu…
) {

414 
	`‰ì
(
ªsu…
);

417 
	}
}

439 
	$_«s_timî_db_öô
()

441 
i
;

442 
i
 = 0; i < 
TIMER_DATABASE_SIZE
; i++) {

443 
_«s_timî_db
.
tq
[
i
].
id
 = 
NAS_TIMER_INACTIVE_ID
;

445 
	}
}

464 
	$_«s_timî_db_gë_id
()

466 
i
;

468 
i
 = 
_«s_timî_db
.
timî_id
; i < 
TIMER_DATABASE_SIZE
; i++) {

469 i‡(
_«s_timî_db
.
tq
[
i
].
id
 < 0 ) {

470 
_«s_timî_db
.
timî_id
 = 
i
+1;

471  
i
;

475 
i
 = 0; i < 
_«s_timî_db
.
timî_id
; i++) {

476 i‡(
_«s_timî_db
.
tq
[
i
].
id
 < 0 ) {

477 
_«s_timî_db
.
timî_id
 = 
i
+1;

478  
i
;

483 
	}
}

501 
	$_«s_timî_db_is_a˘ive
(
id
)

503  ( (
id
 !
NAS_TIMER_INACTIVE_ID
) &&

504 (
_«s_timî_db
.
tq
[
id
].id !
NAS_TIMER_INACTIVE_ID
) );

505 
	}
}

524 
«s_timî_íåy_t
 *
	$_«s_timî_db_¸óã_íåy
(

525 
£c
, 
«s_timî_ˇŒback_t
 
cb
,

526 *
¨gs
)

528 
«s_timî_íåy_t
 *
ã
 = («s_timî_íåy_à*)
	`mÆloc
((nas_timer_entry_t));

529 i‡(
ã
 !
NULL
) {

530 
ã
->
ôv
.
tv_£c
 = 
£c
;

531 
ã
->
ôv
.
tv_u£c
 = 0;

532 
ã
->
tv
 =Åe->
ôv
;

533 
ã
->
cb
 = cb;

534 
ã
->
¨gs
 =árgs;

536  (
ã
);

537 
	}
}

554 
	$_«s_timî_db_dñëe_íåy
(
id
)

557 
	`as£π
(
_«s_timî_db
.
tq
[
id
].id == id);

560 
_«s_timî_db
.
tq
[
id
].id = 
NAS_TIMER_INACTIVE_ID
;

561 
	`‰ì
(
_«s_timî_db
.
tq
[
id
].
íåy
);

562 
_«s_timî_db
.
tq
[
id
].
íåy
 = 
NULL
;

563 
	}
}

583 
	$_«s_timî_db_ö£π_íåy
(
id
, 
«s_timî_íåy_t
 *
ã
)

585 
ôimîvÆ
 
ô
;

586 
time•ec
 
ts
;

587 
timevÆ
 
cuºít_time
;

588 
ª°¨t
;

591 
_«s_timî_db
.
tq
[
id
].id = id;

592 
_«s_timî_db
.
tq
[
id
].
íåy
 = 
ã
;

595 
ô
.
ô_öãrvÆ
.
tv_£c
 = it.ô_öãrvÆ.
tv_u£c
 = 0;

596 
ô
.
ô_vÆue
 = 
ã
->
tv
;

599 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

600 
cuºít_time
.
tv_£c
 = 
ts
.tv_sec;

601 
cuºít_time
.
tv_u£c
 = 
ts
.
tv_n£c
/1000;

603 
	`_«s_timî_add
(&
ã
->
tv
, &
cuºít_time
, &te->tv);

606 
	`«s_timî_lock_db
();

607 
ª°¨t
 = 
	`_«s_timî_db_ö£π
(&
_«s_timî_db
.
tq
[
id
]);

608 
	`«s_timî_u∆ock_db
();

610 #i‡!
	`deföed
(
ENABLE_ITTI
)

611 i‡(
ª°¨t
) {

614 
	`£tôimî
(
ITIMER_REAL
, &
ô
, 0);

617 ()(
ª°¨t
);

619 
	}
}

621 
	$_«s_timî_db_ö£π
(
timî_queue_t
 *
íåy
)

623 
timî_queue_t
 *
¥ev
, *
√xt
;

628 
¥ev
 = 
NULL
, 
√xt
 = 
_«s_timî_db
.
hód
;Çext != NULL;Çext =Çext->next) {

629 i‡(
	`_«s_timî_cmp
(&
√xt
->
íåy
->
tv
, &entry->entry->tv) > 0) {

632 
¥ev
 = 
√xt
;

636 
íåy
->
¥ev
 =Örev;

637 
íåy
->
√xt
 =Çext;

639 i‡(
íåy
->
√xt
 !
NULL
) {

641 
íåy
->
√xt
->
¥ev
 =Éntry;

644 i‡(
íåy
->
¥ev
 !
NULL
) {

646 
íåy
->
¥ev
->
√xt
 =Éntry;

649 
_«s_timî_db
.
hód
 = 
íåy
;

650  
TRUE
;

653  
FALSE
;

654 
	}
}

673 
«s_timî_íåy_t
 *
	$_«s_timî_db_ªmove_íåy
(
id
)

675 
ª°¨t
;

678 
	`as£π
(
_«s_timî_db
.
tq
[
id
].id == id);

681 
	`«s_timî_lock_db
();

682 
ª°¨t
 = 
	`_«s_timî_db_ªmove
(&
_«s_timî_db
.
tq
[
id
]);

683 
	`«s_timî_u∆ock_db
();

685 i‡(
ª°¨t
) {

686 
rc
;

689 
ôimîvÆ
 
ô
;

690 
timevÆ
 
tv
;

691 
time•ec
 
ts
;

693 
ô
.
ô_öãrvÆ
.
tv_£c
 = it.ô_öãrvÆ.
tv_u£c
 = 0;

695 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

697 
tv
.
tv_£c
 = 
ts
.tv_sec;

698 
tv
.
tv_u£c
 = 
ts
.
tv_n£c
/1000;

700 
rc
 = 
	`_«s_timî_sub
(&
_«s_timî_db
.
hód
->
íåy
->
tv
, &tv, &
ô
.
ô_vÆue
);

702 #i‡
	`deföed
(
ENABLE_ITTI
)

703 
	`timî_ªmove
(
_«s_timî_db
.
hód
->
íåy
->
timî_id
);

704 (Ë(
rc
);

706 i‡(
rc
 < 0) {

708 
	`_«s_timî_h™dÀr
(
SIGALRM
);

711 
	`£tôimî
(
ITIMER_REAL
, &
ô
, 0);

717  (
_«s_timî_db
.
tq
[
id
].
íåy
);

718 
	}
}

720 
	$_«s_timî_db_ªmove
(
timî_queue_t
 *
íåy
)

725 i‡(
íåy
->
√xt
 !
NULL
) {

728 
íåy
->
√xt
->
¥ev
 =Éntry->prev;

731 i‡(
íåy
->
¥ev
 !
NULL
) {

734 
íåy
->
¥ev
->
√xt
 =Éntry->next;

737 
_«s_timî_db
.
hód
 = 
íåy
->
√xt
;

738 i‡(
_«s_timî_db
.
hód
 !
NULL
) {

740  
TRUE
;

742 #i‡!
	`deföed
(
ENABLE_ITTI
)

745 
ôimîvÆ
 
ô
;

746 
ô
.
ô_öãrvÆ
.
tv_£c
 = it.ô_öãrvÆ.
tv_u£c
 = 0;

747 
ô
.
ô_vÆue
.
tv_£c
 = it.ô_vÆue.
tv_u£c
 = 0;

748 
	`£tôimî
(
ITIMER_REAL
, &
ô
, 0);

749  
FALSE
;

754  
FALSE
;

755 
	}
}

777 
	$_«s_timî_cmp
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
)

779 i‡(
a
->
tv_£c
 < 
b
->tv_sec) {

781 } i‡(
a
->
tv_£c
 > 
b
->tv_sec) {

783 } i‡(
a
->
tv_u£c
 < 
b
->tv_usec) {

785 } i‡(
a
->
tv_u£c
 > 
b
->tv_usec) {

789 
	}
}

806 
	$_«s_timî_add
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
,

807 
timevÆ
 *
ªsu…
)

809 
ªsu…
->
tv_£c
 = 
a
->tv_£¯+ 
b
->tv_sec;

810 
ªsu…
->
tv_u£c
 = 
a
->tv_u£¯+ 
b
->tv_usec;

811 i‡(
ªsu…
->
tv_u£c
 > 1000000) {

812 
ªsu…
->
tv_£c
++;

813 
ªsu…
->
tv_u£c
 -= 1000000;

815 
	}
}

832 
	$_«s_timî_sub
(c⁄° 
timevÆ
 *
a
, c⁄° timevÆ *
b
,

833 
timevÆ
 *
ªsu…
)

835 i‡(
	`_«s_timî_cmp
(
a
,
b
) > 0 ) {

836 
ªsu…
->
tv_£c
 = 
a
->tv_£¯- 
b
->tv_sec;

837 
ªsu…
->
tv_u£c
 = 
a
->tv_u£¯- 
b
->tv_usec;

838 i‡(
ªsu…
->
tv_u£c
 < 0) {

839 
ªsu…
->
tv_£c
--;

840 
ªsu…
->
tv_u£c
 += 1000000;

845 
	}
}

	@src/util/nas_timer.h

45 #i‚de‡
__NAS_TIMER_H__


46 
	#__NAS_TIMER_H__


	)

56 
	#NAS_TIMER_INACTIVE_ID
 (-1)

	)

63 
	s«s_timî_t
 {

64 
	mid
;

65 
	m£c
;

69 *(*
	t«s_timî_ˇŒback_t
)(*);

79 
«s_timî_öô
();

80 
«s_timî_°¨t
(
£c
, 
«s_timî_ˇŒback_t
 
cb
, *
¨gs
);

81 
«s_timî_°›
(
id
);

82 
«s_timî_ª°¨t
(
id
);

84 #i‡
deföed
(
EPC_BUILD
)

85 
«s_timî_h™dÀ_sig«l_expúy
(
timî_id
, *
¨g_p
);

	@src/util/parser.c

46 
	~"∑r£r.h
"

47 
	~"comm⁄Def.h
"

49 
	~<°dio.h
>

50 
	~<°rög.h
>

77 
	$∑r£r_¥öt_ußge
(c⁄° 
∑r£r_comm™d_löe_t
* 
comm™d_löe
)

79 
	`Ârötf
(
°dîr
, "Ußge: %s", 
comm™d_löe
->
«me
);

80 
i
=0; i < 
comm™d_löe
->
nb_›ti⁄s
; i++) {

81 
	`Ârötf
(
°dîr
, " [%s %s]",

82 
comm™d_löe
->
›ti⁄s
[
i
].
«me
,

83 
comm™d_löe
->
›ti⁄s
[
i
].
¨gumít
);

85 
	`Ârötf
(
°dîr
, "\n");

86 
i
=0; i < 
comm™d_löe
->
nb_›ti⁄s
; i++) {

87 
	`Ârötf
(
°dîr
, "\t%s\t%s\t(%s)\n",

88 
comm™d_löe
->
›ti⁄s
[
i
].
¨gumít
,

89 
comm™d_löe
->
›ti⁄s
[
i
].
ußge
,

90 
comm™d_löe
->
›ti⁄s
[
i
].
vÆue
);

92 
	}
}

110 
	$∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
,

111 
∑r£r_comm™d_löe_t
* 
comm™d_löe
)

113 
¨gumít_nŸ_found
, 
›ti⁄_nŸ_found
 = 1;

114 
›ti⁄_Àngth
;

117 
	`°∫˝y
(
comm™d_löe
->
«me
, 
¨gv
[0], 
PARSER_COMMAND_NAME_SIZE
);

118 
i
=0; i < 
comm™d_löe
->
nb_›ti⁄s
; i++) {

119 i‡–
	`°rcmp
(
comm™d_löe
->
›ti⁄s
[
i
].
vÆue
, "NULL") ) {

120 
comm™d_löe
->
›ti⁄s
[
i
].
pvÆue
 = comm™d_löe->›ti⁄s[i].
vÆue
;

125 i‡(
¨gc
 == 1) {

126  
RETURNok
;

130 *++
¨gv
 && **argv == '-')

132 
¨gumít_nŸ_found
 = 1;

133 
›ti⁄_nŸ_found
 = 1;

134 
i
=0; i < 
comm™d_löe
->
nb_›ti⁄s
; i++)

136 i‡–!
	`°rcmp
(
comm™d_löe
->
›ti⁄s
[
i
].
«me
, *
¨gv
) )

138 
›ti⁄_nŸ_found
 = 0;

139 i‡(
¨gv
[1] && *argv[1] != '-') {

140 
¨gumít_nŸ_found
 = 0;

141 
›ti⁄_Àngth
 = (Ë
	`°æí
(*++
¨gv
);

142 i‡(
›ti⁄_Àngth
 >
PARSER_OPTION_VALUE_SIZE
) {

143 
	`Ârötf
(
°dîr
, "%s: optionÇameÅooÜong (%d), should beÜessÅhan %d characters\n",

144 *
¨gv
, 
›ti⁄_Àngth
,

145 
PARSER_OPTION_VALUE_SIZE
);

146  
RETURNîr‹
;

148 
	`°r˝y
(
comm™d_löe
->
›ti⁄s
[
i
].
vÆue
, *
¨gv
);

149 i‡(
comm™d_löe
->
›ti⁄s
[
i
].
pvÆue
 =
NULL
) {

150 
comm™d_löe
->
›ti⁄s
[
i
].
pvÆue
 =

151 
comm™d_löe
->
›ti⁄s
[
i
].
vÆue
;

157 i‡(
›ti⁄_nŸ_found
) {

158 i‡–
	`°rcmp
(*
¨gv
, "-?") && strcmp(*argv, "-h") &&

159 
	`°rcmp
(*
¨gv
, "-help") && strcmp(*argv, "--help") )

161 
	`Ârötf
(
°dîr
, "%s: illegal option %s\n",

162 
comm™d_löe
->
«me
, *
¨gv
);

163  
RETURNîr‹
;

166 i‡(
¨gumít_nŸ_found
) {

167 
	`Ârötf
(
°dîr
, "%s: option %sÑequiresánárgument\n",

168 
comm™d_löe
->
«me
, *
¨gv
);

169  
RETURNîr‹
;

173 i‡(
›ti⁄_nŸ_found
)

175  
RETURNîr‹
;

178  
RETURNok
;

179 
	}
}

	@src/util/parser.h

45 #i‚de‡
__PARSER_H__


46 
	#__PARSER_H__


	)

64 c⁄° * 
	m«me
;

65 c⁄° * 
	m¨gumít
;

66 c⁄° * 
	mußge
;

67 
	#PARSER_OPTION_VALUE_SIZE
 32

	)

68 
	mvÆue
[
PARSER_OPTION_VALUE_SIZE
];

69 * 
	mpvÆue
;

70 } 
	t∑r£r_›ti⁄_t
;

80 
	#PARSER_COMMAND_NAME_SIZE
 32

	)

81 
	m«me
[
PARSER_COMMAND_NAME_SIZE
];

82 c⁄° 
	mnb_›ti⁄s
;

83 
∑r£r_›ti⁄_t
 
	m›ti⁄s
[];

84 } 
	t∑r£r_comm™d_löe_t
;

94 
∑r£r_¥öt_ußge
(c⁄° 
∑r£r_comm™d_löe_t
* 
commamd_löe
);

95 
∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
,

96 
∑r£r_comm™d_löe_t
* 
commamd_löe
);

	@src/util/socket.c

46 
	~"sockë.h
"

47 
	~"comm⁄Def.h
"

49 
	~<°dlib.h
>

50 
	~<°rög.h
>

51 
	~<uni°d.h
>

52 
	~<î∫o.h
>

53 
	~<sys/ty≥s.h
>

54 
	~<sys/sockë.h
>

55 
	~<√tdb.h
>

72 
	ssockë_id_s


74 
	mty≥
;

75 
	mp‹t
;

76 
	#SOCKET_HOSTNAME_SIZE
 32

	)

77 
	mrho°
[
SOCKET_HOSTNAME_SIZE
];

78 
sockaddr_°‹age
 
	maddr
;

79 
	mfd
;

83 
_sockë_£t_›ti⁄
(
sfd
);

114 * 
	$sockë_udp_›í
(
ty≥
, c⁄° * 
ho°
, c⁄° * 
p‹t
)

116 
addröfo
 
sockë_öfo
;

117 
addröfo
 *
sockë_addr
, *
•
;

118 
sfd
;

125 i‡(
ho°
 =
NULL
)

127 
ty≥
 = 
SOCKET_SERVER
;

130 i‡(
ty≥
 !
SOCKET_CLIENT
 &&Åy≥ !
SOCKET_SERVER
)

132  
NULL
;

147 
	`mem£t
 (&
sockë_öfo
, 0, (
addröfo
));

148 
sockë_öfo
.
ai_sockty≥
 = 
SOCK_DGRAM
;

149 
sockë_öfo
.
ai_Êags
 = 
AI_NUMERICSERV
;

150 i‡(
ty≥
 !
SOCKET_CLIENT
)

153 
sockë_öfo
.
ai_Ámûy
 = 
AF_INET6
;

155 
sockë_öfo
.
ai_Êags
 |
AI_PASSIVE
;

156 
sockë_öfo
.
ai_Êags
 |
AI_V4MAPPED
;

161 
sockë_öfo
.
ai_Ámûy
 = 
AF_INET
;

172 
rc
 = 
	`gëaddröfo
 (
ho°
, 
p‹t
, &
sockë_öfo
, &
sockë_addr
);

173 i‡(
rc
 != 0)

175 i‡(
rc
 !
EAI_SYSTEM
)

177 
î∫o
 = 
rc
;

179  
NULL
;

185 
•
 = 
sockë_addr
; s∞!
NULL
; s∞•->
ai_√xt
)

188 
sfd
 = 
	`sockë
 (
•
->
ai_Ámûy
, sp->
ai_sockty≥
, sp->
ai_¥Ÿocﬁ
);

189 i‡(
sfd
 < 0)

197 i‡(
ty≥
 =
SOCKET_CLIENT
)

200 i‡(
	`c⁄√˘
 (
sfd
, 
•
->
ai_addr
, sp->
ai_addæí
) != -1)

210 i‡(
ty≥
 =
SOCKET_SERVER
)

213 i‡(
	`_sockë_£t_›ti⁄
 (
sfd
Ë!
RETURNok
)

218 i‡(
	`böd
 (
sfd
, 
•
->
ai_addr
, sp->
ai_addæí
) != -1)

225 
	`˛o£
 (
sfd
);

229 
	`‰ìaddröfo
 (
sockë_addr
);

231 i‡(
•
 =
NULL
)

234  
NULL
;

238 
sockë_id_t
 * 
sid
 = (sockë_id_à*Ë
	`mÆloc
 ((
sockë_id_s
));

239 i‡(
sid
 !
NULL
)

241 
sid
->
ty≥
 =Åype;

242 
sid
->
p‹t
 = 
	`©oi
 (port);

243 
sid
->
fd
 = 
sfd
;

245  
sid
;

246 
	}
}

265 
	$sockë_˛o£
(* 
id
)

267 i‡(
id
)

269 
	`˛o£
 (((
sockë_id_t
*Ë
id
)->
fd
);

270 
	`‰ì
 (
id
);

272 
	}
}

292 
ssize_t
 
	$sockë_ªcv
(* 
id
, * 
buf„r
, 
size_t
 
Àngth
)

294 
sockë_id_t
* 
sid
 = (sockë_id_t*Ë(
id
);

295 
ssize_t
 
rbyãs
 = -1;

297 i‡(
sid
->
ty≥
 =
SOCKET_CLIENT
)

300 
rbyãs
 = 
	`ªcv
 (
sid
->
fd
, 
buf„r
, 
Àngth
, 0);

303 i‡(
sid
->
ty≥
 =
SOCKET_SERVER
)

305 
sockaddr_°‹age
 
addr
;

306 
sockÀn_t
 
addæí
 = (
addr
);

309 
rbyãs
 = 
	`ªcv‰om
 (
sid
->
fd
, 
buf„r
, 
Àngth
, 0, (
sockaddr
 *Ë&
addr
, &
addæí
);

310 
sid
->
addr
 =áddr;

313 i‡(
î∫o
 =
EINTR
)

319 i‡(
rbyãs
 < 0)

322  
RETURNîr‹
;

324  
rbyãs
;

325 
	}
}

345 
ssize_t
 
	$sockë_£nd
(c⁄° * 
id
, c⁄° * 
buf„r
, 
size_t
 
Àngth
)

347 c⁄° 
sockë_id_t
* 
sid
 = (sockë_id_t*Ë(
id
);

348 
ssize_t
 
sbyãs
 = -1;

350 i‡(
sid
->
ty≥
 =
SOCKET_CLIENT
)

353 
sbyãs
 = 
	`£nd
 (
sid
->
fd
, 
buf„r
, 
Àngth
, 0);

356 i‡(
sid
->
ty≥
 =
SOCKET_SERVER
)

359 
sbyãs
 = 
	`£ndto
 (
sid
->
fd
, 
buf„r
, 
Àngth
, 0, (
sockaddr
 *Ë&sid->
addr
, (
sockÀn_t
) (sid->addr));

362 i‡(
î∫o
 =
EINTR
)

368 i‡(
sbyãs
 !
Àngth
)

371  
RETURNîr‹
;

373  
sbyãs
;

374 
	}
}

392 
	$sockë_gë_fd
(c⁄° * 
id
)

394 i‡(
id
)

396  ((
sockë_id_t
*Ë
id
)->
fd
;

398  
RETURNîr‹
;

399 
	}
}

419 
	$_sockë_£t_›ti⁄
(
sfd
)

421 
›tvÆ
;

432 
›tvÆ
 = 
TRUE
;

433 i‡(
	`£tsock›t
 (
sfd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
›tvÆ
, (optval)) < 0)

435  
RETURNîr‹
;

444 
›tvÆ
 = 
FALSE
;

445 i‡(
	`£tsock›t
 (
sfd
, 
IPPROTO_IPV6
, 
IPV6_V6ONLY
, &
›tvÆ
, (optval)) < 0)

447  
RETURNîr‹
;

450  
RETURNok
;

451 
	}
}

	@src/util/socket.h

45 #i‚de‡
__SOCKET_H__


46 
	#__SOCKET_H__


	)

48 
	~<sys/ty≥s.h
>

59 
	#SOCKET_CLIENT
 1

	)

60 
	#SOCKET_SERVER
 2

	)

63 
sockë_id_s
 
	tsockë_id_t
;

73 * 
sockë_udp_›í
(
ty≥
, c⁄° * 
ho°
, c⁄° * 
p‹t
);

74 
sockë_gë_fd
(c⁄° * 
id
);

76 
ssize_t
 
sockë_ªcv
(* 
id
, * 
buf„r
, 
size_t
 
Àngth
);

77 
ssize_t
 
sockë_£nd
(c⁄° * 
id
, c⁄° * 
buf„r
, 
size_t
 
Àngth
);

79 
sockë_˛o£
(* 
id
);

	@src/util/stty.c

46 
	~"comm⁄Def.h
"

48 
	~<ãrmios.h
>

49 
	~<uni°d.h
>

50 
	~<°rög.h
>

51 
	~<°dlib.h
>

62 
	#CFLG
 0

	)

63 
	#IFLG
 1

	)

64 
	#OFLG
 2

	)

65 
	#LFLG
 3

	)

66 
	#RFLG
 4

	)

67 
	#BFLG
 5

	)

70 
	s°ty£t_s
 {

71 *
	m«me
;

72 
	mwhich
;

73 
	mmask
;

74 
	mvÆue
;

75 } 
	t°ty£t_t
;

78 
°ty£t_t
 
	g°ty_∑øms
[] = {

79 { "0", 
BFLG
, 0, 
B0
 },

80 { "50", 
BFLG
, 0, 
B50
 },

81 { "75", 
BFLG
, 0, 
B75
 },

82 { "110", 
BFLG
, 0, 
B110
 },

83 { "134", 
BFLG
, 0, 
B134
 },

84 { "150", 
BFLG
, 0, 
B150
 },

85 { "200", 
BFLG
, 0, 
B200
 },

86 { "300", 
BFLG
, 0, 
B300
 },

87 { "600", 
BFLG
, 0, 
B600
 },

88 { "1200", 
BFLG
, 0, 
B1200
 },

89 { "1800", 
BFLG
, 0, 
B1800
 },

90 { "2400", 
BFLG
, 0, 
B2400
 },

91 { "4800", 
BFLG
, 0, 
B4800
 },

92 { "9600", 
BFLG
, 0, 
B9600
 },

93 { "19200", 
BFLG
, 0, 
B19200
 },

94 { "38400", 
BFLG
, 0, 
B38400
 },

95 #ifde‡
B57600


96 { "57600", 
BFLG
, 0, 
B57600
 },

98 #ifde‡
B115200


99 { "115200", 
BFLG
, 0, 
B115200
 },

101 #ifde‡
B230400


102 { "230400", 
BFLG
, 0, 
B230400
 },

104 { "cs7", 
CFLG
, 
CSIZE
, 
CS7
 },

105 { "cs8", 
CFLG
, 
CSIZE
, 
CS8
 },

106 { "c°›b", 
CFLG
, 
CSTOPB
, CSTOPB },

107 { "¸ód", 
CFLG
, 
CREAD
, CREAD },

108 { "∑ªnb", 
CFLG
, 
PARENB
, PARENB },

109 { "∑rodd", 
CFLG
, 
PARODD
, PARODD },

110 { "hub˛", 
CFLG
, 
HUPCL
, HUPCL },

111 { "˛oˇl", 
CFLG
, 
CLOCAL
, CLOCAL },

112 #ifde‡
CRTSCTS


113 { "¸ts˘s",
CFLG
, 
CRTSCTS
, CRTSCTS },

115 #ifde‡
ORTSFL


116 { "‹tsÊ", 
CFLG
, 
ORTSFL
, ORTSFL },

118 #ifde‡
CTSFLOW


119 { "˘sÊow",
CFLG
, 
CTSFLOW
, CTSFLOW },

121 #ifde‡
RTSFLOW


122 { "πsÊow",
CFLG
, 
RTSFLOW
, RTSFLOW },

124 { "ignbrk", 
IFLG
, 
IGNBRK
, IGNBRK },

125 { "brköt", 
IFLG
, 
BRKINT
, BRKINT },

126 { "ig≈¨", 
IFLG
, 
IGNPAR
, IGNPAR },

127 { "∑rmrk", 
IFLG
, 
PARMRK
, PARMRK },

128 { "öpck", 
IFLG
, 
INPCK
, INPCK },

129 { "i°rù", 
IFLG
, 
ISTRIP
, ISTRIP },

130 { "öl¸", 
IFLG
, 
INLCR
, INLCR },

131 { "ign¸", 
IFLG
, 
IGNCR
, IGNCR },

132 { "i¸∆", 
IFLG
, 
ICRNL
, ICRNL },

133 #ifde‡
IUCLC


134 { "iu˛c", 
IFLG
, 
IUCLC
, IUCLC },

136 { "ix⁄", 
IFLG
, 
IXON
, IXON },

137 { "ix™y", 
IFLG
, 
IXANY
, IXANY },

138 { "ixoff", 
IFLG
, 
IXOFF
, IXOFF },

139 #ifde‡
IMAXBEL


140 { "imaxbñ",
IFLG
, 
IMAXBEL
, IMAXBEL },

142 { "›o°", 
OFLG
, 
OPOST
, OPOST },

143 #ifde‡
ILCUC


144 { "ﬁcuc", 
OFLG
, 
OLCUC
, OLCUC },

146 { "⁄l¸", 
OFLG
, 
ONLCR
, ONLCR },

147 { "o¸∆", 
OFLG
, 
OCRNL
, OCRNL },

148 { "⁄o¸", 
OFLG
, 
ONOCR
, ONOCR },

149 { "⁄Ãë", 
OFLG
, 
ONLRET
, ONLRET },

150 { "ofû", 
OFLG
, 
OFILL
, OFILL },

151 { "ofdñ", 
OFLG
, 
OFDEL
, OFDEL },

152 { "∆0", 
OFLG
, 
NLDLY
, 
NL0
 },

153 { "∆1", 
OFLG
, 
NLDLY
, 
NL1
 },

154 { "¸0", 
OFLG
, 
CRDLY
, 
CR0
 },

155 { "¸1", 
OFLG
, 
CRDLY
, 
CR1
 },

156 { "¸2", 
OFLG
, 
CRDLY
, 
CR2
 },

157 { "¸3", 
OFLG
, 
CRDLY
, 
CR3
 },

158 { "èb0", 
OFLG
, 
TABDLY
, 
TAB0
 },

159 { "èb1", 
OFLG
, 
TABDLY
, 
TAB1
 },

160 { "èb2", 
OFLG
, 
TABDLY
, 
TAB2
 },

161 { "èb3", 
OFLG
, 
TABDLY
, 
TAB3
 },

162 { "bs0", 
OFLG
, 
BSDLY
, 
BS0
 },

163 { "bs1", 
OFLG
, 
BSDLY
, 
BS1
 },

164 { "vt0", 
OFLG
, 
VTDLY
, 
VT0
 },

165 { "vt1", 
OFLG
, 
VTDLY
, 
VT1
 },

166 { "ff0", 
OFLG
, 
FFDLY
, 
FF0
 },

167 { "ff1", 
OFLG
, 
FFDLY
, 
FF1
 },

168 { "isig", 
LFLG
, 
ISIG
, ISIG },

169 { "iˇn⁄", 
LFLG
, 
ICANON
, ICANON },

170 #ifde‡
XCASE


171 { "xˇ£", 
LFLG
, 
XCASE
, XCASE },

173 { "echo", 
LFLG
, 
ECHO
, ECHO },

174 { "ech€", 
LFLG
, 
ECHOE
, ECHOE },

175 { "echok", 
LFLG
, 
ECHOK
, ECHOK },

176 { "ech⁄l", 
LFLG
, 
ECHONL
, ECHONL },

177 { "noÊsh", 
LFLG
, 
NOFLSH
, NOFLSH },

178 { "to°›", 
LFLG
, 
TOSTOP
, TOSTOP },

179 #ifde‡
ECHOCTL


180 { "echo˘l",
LFLG
, 
ECHOCTL
, ECHOCTL },

182 #ifde‡
ECHOPRT


183 { "ech›π",
LFLG
, 
ECHOPRT
, ECHOPRT },

185 #ifde‡
ECHOKE


186 { "echoke", 
LFLG
, 
ECHOKE
, ECHOKE },

188 #ifde‡
FLUSHO


189 { "Êusho", 
LFLG
, 
FLUSHO
, FLUSHO },

191 #ifde‡
PENDIN


192 { "≥ndö", 
LFLG
, 
PENDIN
, PENDIN },

194 { "õxãn", 
LFLG
, 
IEXTEN
, IEXTEN },

195 #ifde‡
TOSTOP


196 { "to°›", 
LFLG
, 
TOSTOP
, TOSTOP },

198 { "øw", 
RFLG
, 0, 0 },

199 { 
NULL
, 0, 0, 0 }

202 
_°ty_£t_this
(
ãrmios
 *
ãrm
, c⁄° 
°ty£t_t
 *
p
, 
tu∫⁄
);

225 
	$°ty_£t
(
fd
, c⁄° *
∑øms
)

227 
rc
 = 
RETURNok
;

229 *
p
;

230 *
s
;

231 
ãrmios
 
ãrm
;

232 
i
;

233 
mode
;

236 i‡–
	`tcgë©å
(
fd
, &
ãrm
) < 0 ) {

237  
RETURNîr‹
;

240 
s
 = 
	`°rdup
(
∑øms
);

241 
p
 = 
	`°πok
(
s
," \t\n");

242 
p
 && (
rc
 !
RETURNîr‹
)) {

243 
mode
 = 1;

244 i‡–*
p
 == '-' ) {

245 
mode
 = 0;

246 
p
++;

248  
i
=0; 
°ty_∑øms
[i].
«me
; i++ ) {

249 i‡–!
	`°rcmp
(
p
, 
°ty_∑øms
[
i
].
«me
) ) {

250 
rc
 = 
	`_°ty_£t_this
(&
ãrm
, &
°ty_∑øms
[
i
], 
mode
);

254 
p
 = 
	`°πok
(
NULL
," \t\n");

256 
	`‰ì
(
s
);

259 i‡(
rc
 !
RETURNîr‹
) {

260 i‡–
	`tc£èâr
(
fd
, 
TCSANOW
, &
ãrm
) < 0 ) {

261 
rc
 = 
RETURNîr‹
;

264  (
rc
);

265 
	}
}

287 
	$_°ty_£t_this
(
ãrmios
 *
ãrm
, c⁄° 
°ty£t_t
 *
p
, 
tu∫⁄
)

289 
rc
 = 
RETURNok
;

291  
p
->
which
 )

293 
CFLG
:

294 
ãrm
->
c_cÊag
 &~(
p
->
mask
);

295 i‡–
tu∫⁄
 )

296 
ãrm
->
c_cÊag
 |
p
->
vÆue
;

298 
IFLG
:

299 
ãrm
->
c_iÊag
 &~(
p
->
mask
);

300 i‡–
tu∫⁄
 )

301 
ãrm
->
c_iÊag
 |
p
->
vÆue
;

303 
OFLG
:

304 
ãrm
->
c_oÊag
 &~(
p
->
mask
);

305 i‡–
tu∫⁄
 )

306 
ãrm
->
c_oÊag
 |
p
->
vÆue
;

308 
LFLG
:

309 
ãrm
->
c_lÊag
 &~(
p
->
mask
);

310 i‡–
tu∫⁄
 )

311 
ãrm
->
c_lÊag
 |
p
->
vÆue
;

313 
RFLG
:

314 
ãrm
->
c_iÊag
 = 0;

315 
ãrm
->
c_oÊag
 = 0;

316 
ãrm
->
c_lÊag
 = 0;

317 
ãrm
->
c_cc
[
VMIN
] = 1;

318 
ãrm
->
c_cc
[
VTIME
] = 0;

320 
BFLG
:

321 i‡(
	`cf£ti•ìd
(
ãrm
, 
p
->
vÆue
) < 0) {

322 
rc
 = 
RETURNîr‹
;

324 i‡(
	`cf£to•ìd
(
ãrm
, 
p
->
vÆue
) < 0) {

325 
rc
 = 
RETURNîr‹
;

329 
rc
 = 
RETURNîr‹
;

332  (
rc
);

333 
	}
}

	@src/util/tst/timer.c

46 
	~"«s_timî.h
"

47 
	~"comm⁄Def.h
"

49 
	~<±hªad.h
>

50 
	~<°dio.h
>

51 
	~<°dlib.h
>

52 
	~<time.h
>

53 
	~<pﬁl.h
>

63 
	#TIMER_1S
 1

	)

64 
	#TIMER_2S
 2

	)

65 
	#TIMER_3S
 3

	)

66 
	#TIMER_4S
 4

	)

69 
	mid
;

70 
	m£c
;

71 
time•ec
 
	m°¨t
;

72 } 
	t_timî_t
;

74 * 
_timî_ˇŒback
(* 
¨gs
);

75 * 
_timî_ˇŒback_joöabÀ
(* 
¨gs
);

77 
±hªad_muãx_t
 
	g_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

79 
	g_nb_timîs
 = 0;

80 
_°¨t
(
_timî_t
* 
timî
, 
£c
);

81 
_°›
(
_timî_t
* 
timî
);

87 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

89 
rc
;

90 
_timî_t
 
timî1
, 
timî2
, 
timî3
, 
timî4
;

92 
	#NB_TIMERS_MAX
 10

	)

93 
_timî_t
 
timî
[
NB_TIMERS_MAX
];

96 
rc
 = 
	`timî_öô
();

97 i‡(
rc
 =
RETURNîr‹
) {

98 
	`¥ötf
("ERROR:Åimer_init() failed\n");

99 
	`exô
 (
EXIT_FAILURE
);

103 
i
=0; i < 
NB_TIMERS_MAX
; i++) {

104 i‡(
	`_°¨t
(&
timî
[
i
], iË!
RETURNok
) {

105 
	`¥ötf
("ERROR:Åimî_°¨t(i=%uËÁûed\n", 
i
);

110 i‡(
	`_°¨t
(&
timî1
, 
TIMER_1S
Ë!
RETURNok
) {

111 
	`¥ötf
("ERROR:Åimer_start() failed\n");

115 i‡(
	`_°¨t
(&
timî2
, 
TIMER_3S
Ë!
RETURNok
) {

116 
	`¥ötf
("ERROR:Åimer_start() failed\n");

120 i‡(
	`_°¨t
(&
timî3
, 
TIMER_2S
Ë!
RETURNok
) {

121 
	`¥ötf
("ERROR:Åimer_start() failed\n");

125 i‡(
	`_°›
(&
timî1
Ë!
RETURNok
) {

126 
	`¥ötf
("ERROR:Åimî_°›(id=%uËÁûed\n", 
timî3
.
id
);

130 
	`pﬁl
(0, 0, -1);

133 i‡(
	`_°¨t
(&
timî4
, 
TIMER_4S
Ë!
RETURNok
) {

134 
	`¥ötf
("ERROR:Åimer_start() failed\n");

138 
_nb_timîs
 > 0) {

139 
	`pﬁl
(0, 0, 10000);

142 
	`exô
(
EXIT_SUCCESS
);

143 
	}
}

149 
	$_time•ec_sub
(
time•ec
* 
a
, time•ec* 
b
, time•ec* 
ªsu…
)

151 i‡(
a
->
tv_£c
 < 
b
->tv_sec)  -1;

152 i‡(
a
->
tv_n£c
 < 
b
->tv_nsec)  -1;

154 
ªsu…
->
tv_£c
 = 
a
->tv_£¯- 
b
->tv_sec;

155 
ªsu…
->
tv_n£c
 = 
a
->tv_n£¯- 
b
->tv_nsec;

156 i‡(
ªsu…
->
tv_n£c
 < 0) {

157 
ªsu…
->
tv_£c
--;

158 
ªsu…
->
tv_n£c
 += 1000000000;

161 
	}
}

163 * 
	$_timî_ˇŒback
(* 
¨gs
)

165 
_timî_t
* 
timî
 = (_timî_t*Ë
¨gs
;

166 
time•ec
 
ts
;

168 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

170 i‡(
	`_time•ec_sub
(&
ts
, &
timî
->
°¨t
, &ts) < 0) {

171 
	`¥ötf
("ERROR:_timespec_sub() failed: %ld.%.9ld > %ld.%.9ld\n",

172 
timî
->
°¨t
.
tv_£c
,Åimî->°¨t.
tv_n£c
,

173 
ts
.
tv_£c
,Ås.
tv_n£c
);

176 
	`¥ötf
("%s\t: Timer %uÉxpiredáfter %ld.%.9ld seconds (%u s)\n",

177 
__FUNCTION__
, 
timî
->
id
, 
ts
.
tv_£c
,Ås.
tv_n£c
,Åimî->
£c
);

178 
timî
->
id
 = 
	`timî_°›
(timer->id);

179 
	`±hªad_muãx_lock
(&
_muãx
);

180 
_nb_timîs
 -= 1;

181 
	`±hªad_muãx_u∆ock
(&
_muãx
);

184  
NULL
;

185 
	}
}

187 * 
	$_timî_ˇŒback_joöabÀ
(* 
¨gs
)

189 
_timî_t
* 
timî
 = (_timî_t*Ë
¨gs
;

190 
time•ec
 
ts
;

191 * 
rc
 = (*)
	`mÆloc
(());

193 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

195 i‡(
	`_time•ec_sub
(&
ts
, &
timî
->
°¨t
, &ts) < 0) {

196 
	`¥ötf
("ERROR:_timespec_sub() failed: %ld.%.9ld > %ld.%.9ld\n",

197 
timî
->
°¨t
.
tv_£c
,Åimî->°¨t.
tv_n£c
,

198 
ts
.
tv_£c
,Ås.
tv_n£c
);

199 *
rc
 = 
RETURNîr‹
;

202 
	`¥ötf
("%s\t: Timer %uÉxpiredáfter %ld.%.9ld seconds (%u s)\n",

203 
__FUNCTION__
, 
timî
->
id
, 
ts
.
tv_£c
,Ås.
tv_n£c
,Åimî->
£c
);

204 
timî
->
id
 = 
	`timî_°›
(timer->id);

205 
	`±hªad_muãx_lock
(&
_muãx
);

206 
_nb_timîs
 -= 1;

207 
	`±hªad_muãx_u∆ock
(&
_muãx
);

208 *
rc
 = 
timî
->
id
;

211  
rc
;

212 
	}
}

214 
	$_°¨t
(
_timî_t
* 
timî
, 
£c
)

216 
rc
 = 
RETURNîr‹
;

218 
timî
->
£c
 = sec;

219 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
timî
->
°¨t
);

220 
timî
->
id
 = 
	`timî_°¨t
—imî->
£c
, 
_timî_ˇŒback_joöabÀ
,

221 (*Ë
timî
);

222 i‡(
timî
->
id
 !
TIMER_INACTIVE_ID
) {

223 
	`¥ötf
("Timer id=%u scheduledÅoÉxpire in %u seconds\n",

224 
timî
->
id
,Åimî->
£c
);

225 
_nb_timîs
 += 1;

226 
rc
 = 
RETURNok
;

228  (
rc
);

229 
	}
}

231 
	$_°›
(
_timî_t
* 
timî
)

233 
rc
 = 
RETURNîr‹
;

235 
	`¥ötf
("St›Åimî id=%u\n", 
timî
->
id
);

236 
timî
->
id
 = 
	`timî_°›
(timer->id);

237 i‡(
timî
->
id
 =
TIMER_INACTIVE_ID
) {

238 
_nb_timîs
 -= 1;

239 
rc
 = 
RETURNok
;

241  (
rc
);

242 
	}
}

	@tools/network.h

45 #i‚de‡
__NETWORK_H__


46 
	#__NETWORK_H__


	)

48 
	~"comm⁄Def.h
"

49 
	~"√tw‹kDef.h
"

55 
	#SFR_PLMN_1
 {0,2,0x0f,8,0,1}

56 
	#SFR_PLMN_2
 {0,2,0x0f,8,1,1}

57 
	#SFR_PLMN_3
 {0,2,0x0f,8,3,1}

58 
	#TM_PLMN_1
 {1,3,0,0,8,2}

59 
	#FCT_PLMN_1
 {1,3,8,0,2,0}

60 
	#VDF_PLMN_1
 {2,2,0x0f,2,0,1}

61 
	#VDF_PLMN_2
 {1,2,0x0f,4,0x0f,1}

62 
	#VDF_PLMN_3
 {1,2,0x0f,4,0x0f,6}

63 
	#VDF_PLMN_4
 {6,2,0x0f,2,0x0f,2}

64 
	#VDF_PLMN_5
 {6,2,0x0f,2,0x0f,4}

65 

	)

74 
	mSFR1
=0,

75 
	mSFR2
,

76 
	mSFR3
,

77 
	mTM1
,

78 
	mFCT1
,

79 
	mVDF1
,

80 
	mVDF2
,

81 
	mVDF3
,

82 
	mVDF4
,

83 
	mVDF5
,

90 
	mnum
;

91 
∂mn_t
 
	m∂mn
;

92 
	mfuŒ«me
[
NET_FORMAT_LONG_SIZE
 + 1];

93 
	msh‹äame
[
NET_FORMAT_SHORT_SIZE
 + 1];

94 
èc_t
 
	mèc_°¨t
;

95 
èc_t
 
	mèc_íd
;

96 } 
	t√tw‹k_ªc‹d_t
;

106 
√tw‹k_ªc‹d_t
 
	g√tw‹k_ªc‹ds
[] = {

107 {20810, 
SFR_PLMN_1
, "SFR France", "SFR", 0x0001, 0xfffd},

108 {20811, 
SFR_PLMN_2
, "SFR France", "SFR", 0x0001, 0xfffd},

109 {20813, 
SFR_PLMN_3
, "SFR France", "SFR", 0x0001, 0xfffd},

110 {310280,
TM_PLMN_1
, "T-Mobile USA", "T-Mobile", 0x0001, 0xfffd},

111 {310028,
FCT_PLMN_1
, "FICTITIOUS USA", "FICTITIO", 0x0001, 0xfffd},

112 {22210, 
VDF_PLMN_1
, "Vodafone Italia", "VODAFONE", 0x0001, 0xfffd},

113 {2141, 
VDF_PLMN_2
, "Vodafone Spain", "VODAFONE", 0x0001, 0xfffd},

114 {2146, 
VDF_PLMN_3
, "Vodafone Spain", "VODAFONE", 0x0001, 0xfffd},

115 {2622, 
VDF_PLMN_4
, "Vodafone Germ", "VODAFONE", 0x0001, 0xfffd},

116 {2624, 
VDF_PLMN_5
, "Vodafone Germ", "VODAFONE", 0x0001, 0xfffd},

	@tools/ue_data.c

47 
	~"u£rDef.h
"

48 
	~"mem‹y.h
"

50 
	~"emmD©a.h
"

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

54 
	~<°rög.h
>

57 
	#SELECTED_PLMN
 
FCT1


	)

63 
	#USER_IMEI
 "35611302209414"

	)

64 
	#USER_MANUFACTURER
 "EURECOM"

	)

65 
	#USER_MODEL
 "LTE Android PC"

	)

68 
	#USER_PIN
 "0000"

	)

70 
	#PRINT_PLMN_DIGIT
(
d
Ëi‡((dË!0xfË
	`¥ötf
("%u", (d))

	)

72 
	#PRINT_PLMN
(
∂mn
) \

73 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô1
); \

74 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô2
); \

75 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô3
); \

76 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô1
); \

77 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô2
); \

78 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô3
)

	)

84 
_di•œy_ußge
(c⁄° * 
comm™d
);

86 
_gí_u£r_d©a
(
u£r_nvd©a_t
* 
d©a
);

87 
_gí_emm_d©a
(
emm_nvd©a_t
* 
d©a
);

89 
_luhn
(c⁄° * 
cc
);

90 
_di•œy_ue_d©a
(c⁄° 
u£r_nvd©a_t
* 
d©a
);

91 
_di•œy_emm_d©a
(c⁄° 
emm_nvd©a_t
* 
d©a
);

97 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

99 
rc
;

100 * 
∑th
;

101 
u£r_nvd©a_t
 
u£r_d©a
;

102 
emm_nvd©a_t
 
emm_d©a
;

104 
gí_d©a
;

111 i‡(
¨gc
 != 2) {

112 
	`Ârötf
(
°dîr
, "InvalidÖarameter\n");

113 
	`_di•œy_ußge
(
¨gv
[0]);

114 
	`exô
(
EXIT_FAILURE
);

116 i‡–(
	`°rcmp
(
¨gv
[1], "--gen") == 0) ||

117 (
	`°rcmp
(
¨gv
[1], "-g") == 0) ) {

119 
gí_d©a
 = 
TRUE
;

121 i‡–(
	`°rcmp
(
¨gv
[1], "--print") == 0) ||

122 (
	`°rcmp
(
¨gv
[1], "-p") == 0) ) {

124 
gí_d©a
 = 
FALSE
;

128 
	`_di•œy_ußge
(
¨gv
[0]);

129 
	`exô
(
EXIT_SUCCESS
);

137 
∑th
 = 
	`mem‹y_gë_∑th
(
USER_NVRAM_DIRNAME
, 
USER_NVRAM_FILENAME
);

138 i‡(
∑th
 =
NULL
) {

139 
	`≥º‹
("ERROR\t: memory_get_path() failed");

140 
	`exô
(
EXIT_FAILURE
);

143 i‡(
gí_d©a
)

148 
	`mem£t
(&
u£r_d©a
, 0, (
u£r_nvd©a_t
));

149 
	`_gí_u£r_d©a
(&
u£r_d©a
);

153 
rc
 = 
	`mem‹y_wrôe
(
∑th
, &
u£r_d©a
, (
u£r_nvd©a_t
));

154 i‡(
rc
 !
RETURNok
) {

155 
	`≥º‹
("ERROR\t: memory_write() failed");

156 
	`‰ì
(
∑th
);

157 
	`exô
(
EXIT_FAILURE
);

163 
	`mem£t
(&
u£r_d©a
, 0, (
u£r_nvd©a_t
));

164 
rc
 = 
	`mem‹y_ªad
(
∑th
, &
u£r_d©a
, (
u£r_nvd©a_t
));

165 i‡(
rc
 !
RETURNok
) {

166 
	`≥º‹
("ERROR\t: memory_read() failed");

167 
	`‰ì
(
∑th
);

168 
	`exô
(
EXIT_FAILURE
);

170 
	`‰ì
(
∑th
);

174 
	`¥ötf
("\nUE'sÇon-volatile data:\n\n");

175 
	`_di•œy_ue_d©a
(&
u£r_d©a
);

182 
∑th
 = 
	`mem‹y_gë_∑th
(
EMM_NVRAM_DIRNAME
, 
EMM_NVRAM_FILENAME
);

183 i‡(
∑th
 =
NULL
) {

184 
	`≥º‹
("ERROR\t: memory_get_path() failed");

185 
	`exô
(
EXIT_FAILURE
);

188 i‡(
gí_d©a
)

193 
	`mem£t
(&
emm_d©a
, 0, (
emm_nvd©a_t
));

194 
	`_gí_emm_d©a
(&
emm_d©a
);

198 
rc
 = 
	`mem‹y_wrôe
(
∑th
, &
emm_d©a
, (
emm_nvd©a_t
));

199 i‡(
rc
 !
RETURNok
) {

200 
	`≥º‹
("ERROR\t: memory_write() failed");

201 
	`‰ì
(
∑th
);

202 
	`exô
(
EXIT_FAILURE
);

208 
	`mem£t
(&
emm_d©a
, 0, (
emm_nvd©a_t
));

209 
rc
 = 
	`mem‹y_ªad
(
∑th
, &
emm_d©a
, (
emm_nvd©a_t
));

210 i‡(
rc
 !
RETURNok
) {

211 
	`≥º‹
("ERROR\t: memory_read() failed ");

212 
	`‰ì
(
∑th
);

213 
	`exô
(
EXIT_FAILURE
);

215 
	`‰ì
(
∑th
);

219 
	`¥ötf
("\nEMMÇon-volatile data:\n\n");

220 
	`_di•œy_emm_d©a
(&
emm_d©a
);

227 
∑th
 = 
	`mem‹y_gë_∑th
(
USER_NVRAM_DIRNAME
, 
USER_NVRAM_FILENAME
);

228 
	`¥ötf
("\nUE idítôy d©®fûe: %s\n", 
∑th
);

229 
	`‰ì
(
∑th
);

230 
∑th
 = 
	`mem‹y_gë_∑th
(
EMM_NVRAM_DIRNAME
, 
EMM_NVRAM_FILENAME
);

231 
	`¥ötf
("EPS Mobûôy M™agemíàd©®fûe: %s\n", 
∑th
);

232 
	`‰ì
(
∑th
);

234 
	`exô
(
EXIT_SUCCESS
);

235 
	}
}

244 
	$_di•œy_ußge
(c⁄° * 
comm™d
)

246 
	`Ârötf
(
°dîr
, "ußge: %†[OPTION]\n", 
comm™d
);

247 
	`Ârötf
(
°dîr
, "\t[--gen|-g]\tGenerateÅhe UE data files\n");

248 
	`Ârötf
(
°dîr
, "\t[--print|-p]\tDisplayÅhe content ofÅhe UE data files\n");

249 
	`Ârötf
(
°dîr
, "\t[--help|-h]\tDisplayÅhis usage\n");

250 c⁄° * 
∑th
 = 
	`gëív
("NVRAM_DIR");

251 i‡(
∑th
 !
NULL
) {

252 
	`Ârötf
(
°dîr
, "NVRAM_DIR = %s\n", 
∑th
);

255 
	`Ârötf
(
°dîr
, "NVRAM_DIRÉnvironment variable isÇot defined\n");

257 
	}
}

262 
	$_gí_u£r_d©a
(
u£r_nvd©a_t
* 
d©a
)

271 
	`¢¥ötf
(
d©a
->
IMEI
, 
USER_IMEI_SIZE
+1, "%s%d",

272 
USER_IMEI
, 
	`_luhn
(USER_IMEI));

276 
	`°∫˝y
(
d©a
->
m™uÁ˘uªr
, 
USER_MANUFACTURER
, 
USER_MANUFACTURER_SIZE
);

280 
	`°∫˝y
(
d©a
->
modñ
, 
USER_MODEL
, 
USER_MODEL_SIZE
);

284 
	`°∫˝y
(
d©a
->
PIN
, 
USER_PIN
, 
USER_PIN_SIZE
);

285 
	}
}

290 
	$_gí_emm_d©a
(
emm_nvd©a_t
* 
d©a
)

299 
d©a
->
imsi
.
Àngth
 = 8;

300 
d©a
->
imsi
.
u
.
num
.
∑rôy
 = 0x0;

301 
d©a
->
imsi
.
u
.
num
.
digô1
 = 3;

302 
d©a
->
imsi
.
u
.
num
.
digô2
 = 1;

303 
d©a
->
imsi
.
u
.
num
.
digô3
 = 0;

304 
d©a
->
imsi
.
u
.
num
.
digô4
 = 0;

305 
d©a
->
imsi
.
u
.
num
.
digô5
 = 2;

306 
d©a
->
imsi
.
u
.
num
.
digô6
 = 8;

307 
d©a
->
imsi
.
u
.
num
.
digô7
 = 9;

308 
d©a
->
imsi
.
u
.
num
.
digô8
 = 0;

309 
d©a
->
imsi
.
u
.
num
.
digô9
 = 8;

310 
d©a
->
imsi
.
u
.
num
.
digô10
 = 3;

311 
d©a
->
imsi
.
u
.
num
.
digô11
 = 2;

312 
d©a
->
imsi
.
u
.
num
.
digô12
 = 1;

313 
d©a
->
imsi
.
u
.
num
.
digô13
 = 5;

314 
d©a
->
imsi
.
u
.
num
.
digô14
 = 0;

315 
d©a
->
imsi
.
u
.
num
.
digô15
 = 0xF;

319 
d©a
->
Ωlmn
.
MCCdigô1
 = 3;

320 
d©a
->
Ωlmn
.
MCCdigô2
 = 1;

321 
d©a
->
Ωlmn
.
MCCdigô3
 = 0;

322 
d©a
->
Ωlmn
.
MNCdigô1
 = 0;

323 
d©a
->
Ωlmn
.
MNCdigô2
 = 2;

324 
d©a
->
Ωlmn
.
MNCdigô3
 = 8;

348 
d©a
->
imsi
.
Àngth
 = 8;

349 
d©a
->
imsi
.
u
.
num
.
∑rôy
 = 0x0;

350 
d©a
->
imsi
.
u
.
num
.
digô1
 = 2;

351 
d©a
->
imsi
.
u
.
num
.
digô2
 = 0;

352 
d©a
->
imsi
.
u
.
num
.
digô3
 = 8;

353 
d©a
->
imsi
.
u
.
num
.
digô4
 = 1;

354 
d©a
->
imsi
.
u
.
num
.
digô5
 = 0;

355 
d©a
->
imsi
.
u
.
num
.
digô6
 = 0;

356 
d©a
->
imsi
.
u
.
num
.
digô7
 = 0;

357 
d©a
->
imsi
.
u
.
num
.
digô8
 = 0;

358 
d©a
->
imsi
.
u
.
num
.
digô9
 = 0;

359 
d©a
->
imsi
.
u
.
num
.
digô10
 = 0;

360 
d©a
->
imsi
.
u
.
num
.
digô11
 = 1;

361 
d©a
->
imsi
.
u
.
num
.
digô12
 = 2;

362 
d©a
->
imsi
.
u
.
num
.
digô13
 = 3;

363 
d©a
->
imsi
.
u
.
num
.
digô14
 = 4;

364 
d©a
->
imsi
.
u
.
num
.
digô15
 = 0xF;

369 
d©a
->
Ωlmn
.
MCCdigô1
 = 2;

370 
d©a
->
Ωlmn
.
MCCdigô2
 = 0;

371 
d©a
->
Ωlmn
.
MCCdigô3
 = 8;

372 
d©a
->
Ωlmn
.
MNCdigô1
 = 1;

373 
d©a
->
Ωlmn
.
MNCdigô2
 = 0;

374 
d©a
->
Ωlmn
.
MNCdigô3
 = 0xf;

379 
d©a
->
ïlmn
.
n_∂mns
 = 0;

380 
	}
}

385 
	$_luhn
(c⁄° * 
cc
)

387 c⁄° 
m
[] = {0,2,4,6,8,1,3,5,7,9};

388 
odd
 = 1, 
sum
 = 0;

390 
i
 = 
	`°æí
(
cc
); i--; 
odd
 = !odd) {

391 
digô
 = 
cc
[
i
] - '0';

392 
sum
 +
odd
 ? 
m
[
digô
] : digit;

395  10 - (
sum
 % 10);

396 
	}
}

401 
	$_di•œy_ue_d©a
(c⁄° 
u£r_nvd©a_t
* 
d©a
)

403 
	`¥ötf
("IMEI\t\t%s\n", 
d©a
->
IMEI
);

404 
	`¥ötf
("m™uÁ˘uªr\t%s\n", 
d©a
->
m™uÁ˘uªr
);

405 
	`¥ötf
("modñ\t\t%s\n", 
d©a
->
modñ
);

406 
	`¥ötf
("PIN\t\t%s\n", 
d©a
->
PIN
);

407 
	}
}

412 
	$_di•œy_emm_d©a
(c⁄° 
emm_nvd©a_t
* 
d©a
)

414 
	`¥ötf
("IMSI\t\t= ");

415 i‡(
d©a
->
imsi
.
u
.
num
.
digô6
 == 0b1111) {

416 i‡(
d©a
->
imsi
.
u
.
num
.
digô15
 == 0b1111) {

417 
	`¥ötf
("%u%u%u.%u%u.%u%u%u%u%u%u%u%u\n",

418 
d©a
->
imsi
.
u
.
num
.
digô1
,

419 
d©a
->
imsi
.
u
.
num
.
digô2
,

420 
d©a
->
imsi
.
u
.
num
.
digô3
,

421 
d©a
->
imsi
.
u
.
num
.
digô4
,

422 
d©a
->
imsi
.
u
.
num
.
digô5
,

424 
d©a
->
imsi
.
u
.
num
.
digô7
,

425 
d©a
->
imsi
.
u
.
num
.
digô8
,

426 
d©a
->
imsi
.
u
.
num
.
digô9
,

427 
d©a
->
imsi
.
u
.
num
.
digô10
,

428 
d©a
->
imsi
.
u
.
num
.
digô11
,

429 
d©a
->
imsi
.
u
.
num
.
digô12
,

430 
d©a
->
imsi
.
u
.
num
.
digô13
,

431 
d©a
->
imsi
.
u
.
num
.
digô14
);

433 
	`¥ötf
("%u%u%u.%u%u.%u%u%u%u%u%u%u%u%u\n",

434 
d©a
->
imsi
.
u
.
num
.
digô1
,

435 
d©a
->
imsi
.
u
.
num
.
digô2
,

436 
d©a
->
imsi
.
u
.
num
.
digô3
,

437 
d©a
->
imsi
.
u
.
num
.
digô4
,

438 
d©a
->
imsi
.
u
.
num
.
digô5
,

440 
d©a
->
imsi
.
u
.
num
.
digô7
,

441 
d©a
->
imsi
.
u
.
num
.
digô8
,

442 
d©a
->
imsi
.
u
.
num
.
digô9
,

443 
d©a
->
imsi
.
u
.
num
.
digô10
,

444 
d©a
->
imsi
.
u
.
num
.
digô11
,

445 
d©a
->
imsi
.
u
.
num
.
digô12
,

446 
d©a
->
imsi
.
u
.
num
.
digô13
,

447 
d©a
->
imsi
.
u
.
num
.
digô14
,

448 
d©a
->
imsi
.
u
.
num
.
digô15
);

451 i‡(
d©a
->
imsi
.
u
.
num
.
digô15
 == 0b1111) {

452 
	`¥ötf
("%u%u%u.%u%u%u.%u%u%u%u%u%u%u%u\n",

453 
d©a
->
imsi
.
u
.
num
.
digô1
,

454 
d©a
->
imsi
.
u
.
num
.
digô2
,

455 
d©a
->
imsi
.
u
.
num
.
digô3
,

456 
d©a
->
imsi
.
u
.
num
.
digô4
,

457 
d©a
->
imsi
.
u
.
num
.
digô5
,

458 
d©a
->
imsi
.
u
.
num
.
digô6
,

460 
d©a
->
imsi
.
u
.
num
.
digô7
,

461 
d©a
->
imsi
.
u
.
num
.
digô8
,

462 
d©a
->
imsi
.
u
.
num
.
digô9
,

463 
d©a
->
imsi
.
u
.
num
.
digô10
,

464 
d©a
->
imsi
.
u
.
num
.
digô11
,

465 
d©a
->
imsi
.
u
.
num
.
digô12
,

466 
d©a
->
imsi
.
u
.
num
.
digô13
,

467 
d©a
->
imsi
.
u
.
num
.
digô14
);

469 
	`¥ötf
("%u%u%u.%u%u%u.%u%u%u%u%u%u%u%u\n",

470 
d©a
->
imsi
.
u
.
num
.
digô1
,

471 
d©a
->
imsi
.
u
.
num
.
digô2
,

472 
d©a
->
imsi
.
u
.
num
.
digô3
,

473 
d©a
->
imsi
.
u
.
num
.
digô4
,

474 
d©a
->
imsi
.
u
.
num
.
digô5
,

475 
d©a
->
imsi
.
u
.
num
.
digô6
,

477 
d©a
->
imsi
.
u
.
num
.
digô7
,

478 
d©a
->
imsi
.
u
.
num
.
digô8
,

479 
d©a
->
imsi
.
u
.
num
.
digô9
,

480 
d©a
->
imsi
.
u
.
num
.
digô10
,

481 
d©a
->
imsi
.
u
.
num
.
digô11
,

482 
d©a
->
imsi
.
u
.
num
.
digô12
,

483 
d©a
->
imsi
.
u
.
num
.
digô13
,

484 
d©a
->
imsi
.
u
.
num
.
digô14
,

485 
d©a
->
imsi
.
u
.
num
.
digô15
);

489 
	`¥ötf
("RPLMN\t\t"); 
	`PRINT_PLMN
(
d©a
->
Ωlmn
);

490 
	`¥ötf
("\n");

492 
i
 = 0; i < 
d©a
->
ïlmn
.
n_∂mns
; i++) {

493 
	`¥ötf
("EPLMN[%d]\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
ïlmn
.
∂mn
[i]);

494 
	`¥ötf
("\n");

496 
	}
}

	@tools/usim_data.c

47 
	~"√tw‹k.h
"

49 
	~"usim_≠i.h
"

50 
	~"mem‹y.h
"

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

54 
	~<°rög.h
>

57 
	#SELECTED_PLMN
 
FCT1


	)

63 
	#KSI
 
USIM_KSI_NOT_AVAILABLE


	)

64 
	#KSI_ASME
 
USIM_KSI_NOT_AVAILABLE


	)

65 
	#INT_ALGO
 
USIM_INT_EIA1


	)

66 
	#ENC_ALGO
 
USIM_ENC_EEA0


	)

67 
	#SECURITY_ALGORITHMS
 (
ENC_ALGO
 | 
INT_ALGO
)

	)

69 
	#MIN_TAC
 0x0000

	)

70 
	#MAX_TAC
 0xFFFE

	)

72 
	#DEFAULT_TMSI
 0x0000000D

	)

73 
	#DEFAULT_P_TMSI
 0x0000000D

	)

74 
	#DEFAULT_M_TMSI
 0x0000000D

	)

75 
	#DEFAULT_LAC
 0xFFFE

	)

76 
	#DEFAULT_RAC
 0x01

	)

77 
	#DEFAULT_TAC
 0x0001

	)

79 
	#DEFAULT_MME_ID
 0x0102

	)

80 
	#DEFAULT_MME_CODE
 0x0F

	)

82 
	#PRINT_PLMN_DIGIT
(
d
Ëi‡((dË!0xfË
	`¥ötf
("%u", (d))

	)

84 
	#PRINT_PLMN
(
∂mn
) \

85 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô1
); \

86 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô2
); \

87 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô3
); \

88 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô1
); \

89 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô2
); \

90 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô3
)

	)

96 
_di•œy_ußge
(c⁄° * 
comm™d
);

98 
_di•œy_usim_d©a
(c⁄° 
usim_d©a_t
* 
d©a
);

104 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

106 
rc
;

107 
usim_d©a_t
 
usim_d©a
;

109 
gí_d©a
;

114 i‡(
¨gc
 != 2) {

115 
	`Ârötf
(
°dîr
, "InvalidÖarameter\n");

116 
	`_di•œy_ußge
(
¨gv
[0]);

117 
	`exô
(
EXIT_FAILURE
);

119 i‡–(
	`°rcmp
(
¨gv
[1], "--gen") == 0) ||

120 (
	`°rcmp
(
¨gv
[1], "-g") == 0) ) {

122 
gí_d©a
 = 
TRUE
;

124 i‡–(
	`°rcmp
(
¨gv
[1], "--print") == 0) ||

125 (
	`°rcmp
(
¨gv
[1], "-p") == 0) ) {

127 
gí_d©a
 = 
FALSE
;

131 
	`_di•œy_ußge
(
¨gv
[0]);

132 
	`exô
(
EXIT_SUCCESS
);

135 i‡(
gí_d©a
)

140 
	`mem£t
(&
usim_d©a
, 0, (
usim_d©a_t
));

149 
usim_d©a
.
imsi
.
Àngth
 = 8;

150 
usim_d©a
.
imsi
.
u
.
num
.
∑rôy
 = 
EVEN_PARITY
;

151 
usim_d©a
.
imsi
.
u
.
num
.
digô1
 = 3;

152 
usim_d©a
.
imsi
.
u
.
num
.
digô2
 = 1;

153 
usim_d©a
.
imsi
.
u
.
num
.
digô3
 = 0;

154 
usim_d©a
.
imsi
.
u
.
num
.
digô4
 = 0;

155 
usim_d©a
.
imsi
.
u
.
num
.
digô5
 = 2;

156 
usim_d©a
.
imsi
.
u
.
num
.
digô6
 = 8;

157 
usim_d©a
.
imsi
.
u
.
num
.
digô7
 = 9;

158 
usim_d©a
.
imsi
.
u
.
num
.
digô8
 = 0;

159 
usim_d©a
.
imsi
.
u
.
num
.
digô9
 = 8;

160 
usim_d©a
.
imsi
.
u
.
num
.
digô10
 = 3;

161 
usim_d©a
.
imsi
.
u
.
num
.
digô11
 = 2;

162 
usim_d©a
.
imsi
.
u
.
num
.
digô12
 = 1;

163 
usim_d©a
.
imsi
.
u
.
num
.
digô13
 = 5;

164 
usim_d©a
.
imsi
.
u
.
num
.
digô14
 = 0;

165 
usim_d©a
.
imsi
.
u
.
num
.
digô15
 = 0b1111;

189 
usim_d©a
.
imsi
.
Àngth
 = 8;

190 
usim_d©a
.
imsi
.
u
.
num
.
∑rôy
 = 0x0;

191 
usim_d©a
.
imsi
.
u
.
num
.
digô1
 = 2;

192 
usim_d©a
.
imsi
.
u
.
num
.
digô2
 = 0;

193 
usim_d©a
.
imsi
.
u
.
num
.
digô3
 = 8;

194 
usim_d©a
.
imsi
.
u
.
num
.
digô4
 = 1;

195 
usim_d©a
.
imsi
.
u
.
num
.
digô5
 = 0;

196 
usim_d©a
.
imsi
.
u
.
num
.
digô6
 = 0;

197 
usim_d©a
.
imsi
.
u
.
num
.
digô7
 = 0;

198 
usim_d©a
.
imsi
.
u
.
num
.
digô8
 = 0;

199 
usim_d©a
.
imsi
.
u
.
num
.
digô9
 = 0;

200 
usim_d©a
.
imsi
.
u
.
num
.
digô10
 = 0;

201 
usim_d©a
.
imsi
.
u
.
num
.
digô11
 = 1;

202 
usim_d©a
.
imsi
.
u
.
num
.
digô12
 = 2;

203 
usim_d©a
.
imsi
.
u
.
num
.
digô13
 = 3;

204 
usim_d©a
.
imsi
.
u
.
num
.
digô14
 = 4;

205 
usim_d©a
.
imsi
.
u
.
num
.
digô15
 = 0xF;

210 
usim_d©a
.
keys
.
ksi
 = 
KSI
;

211 
	`mem£t
(&
usim_d©a
.
keys
.
ck
, 0, 
USIM_CK_SIZE
);

212 
	`mem£t
(&
usim_d©a
.
keys
.
ik
, 0, 
USIM_IK_SIZE
);

217 
usim_d©a
.
hµlmn
 = 0x00;

221 
i
 = 0; i < 
USIM_FPLMN_MAX
; i++) {

222 
	`mem£t
(&
usim_d©a
.
Âlmn
[
i
], 0xff, (
∂mn_t
));

227 
usim_d©a
.
loci
.
tmsi
 = 
DEFAULT_TMSI
;

228 
usim_d©a
.
loci
.
œi
.
∂mn
 = 
√tw‹k_ªc‹ds
[
SELECTED_PLMN
].plmn;

229 
usim_d©a
.
loci
.
œi
.
œc
 = 
DEFAULT_LAC
;

230 
usim_d©a
.
loci
.
°©us
 = 
USIM_LOCI_NOT_UPDATED
;

234 
usim_d©a
.
p¶oci
.
p_tmsi
 = 
DEFAULT_P_TMSI
;

235 
usim_d©a
.
p¶oci
.
sig«tuª
[0] = 0x01;

236 
usim_d©a
.
p¶oci
.
sig«tuª
[1] = 0x02;

237 
usim_d©a
.
p¶oci
.
sig«tuª
[2] = 0x03;

238 
usim_d©a
.
p¶oci
.
øi
.
∂mn
 = 
√tw‹k_ªc‹ds
[
SELECTED_PLMN
].plmn;

239 
usim_d©a
.
p¶oci
.
øi
.
œc
 = 
DEFAULT_LAC
;

240 
usim_d©a
.
p¶oci
.
øi
.
øc
 = 
DEFAULT_RAC
;

241 
usim_d©a
.
p¶oci
.
°©us
 = 
USIM_PSLOCI_NOT_UPDATED
;

245 
usim_d©a
.
ad
.
UE_O≥øti⁄_Mode
 = 
USIM_NORMAL_MODE
;

246 
usim_d©a
.
ad
.
Addôi⁄Æ_Info
 = 0xffff;

247 
usim_d©a
.
ad
.
MNC_Lígth
 = 2;

251 
usim_d©a
.
£curôy˘x
.
Àngth
 = 52;

252 
usim_d©a
.
£curôy˘x
.
KSIasme
.
ty≥
 = 
USIM_KSI_ASME_TAG
;

253 
usim_d©a
.
£curôy˘x
.
KSIasme
.
Àngth
 = 1;

254 
usim_d©a
.
£curôy˘x
.
KSIasme
.
vÆue
[0] = 
KSI_ASME
;

255 
usim_d©a
.
£curôy˘x
.
Kasme
.
ty≥
 = 
USIM_K_ASME_TAG
;

256 
usim_d©a
.
£curôy˘x
.
Kasme
.
Àngth
 = 
USIM_K_ASME_SIZE
;

257 
	`mem£t
(
usim_d©a
.
£curôy˘x
.
Kasme
.
vÆue
, 0,

258 
usim_d©a
.
£curôy˘x
.
Kasme
.
Àngth
);

259 
usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
ty≥
 = 
USIM_UL_NAS_COUNT_TAG
;

260 
usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
Àngth
 = 
USIM_UL_NAS_COUNT_SIZE
;

261 
	`mem£t
(
usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
vÆue
, 0,

262 
usim_d©a
.
£curôy˘x
.
ulNAScou¡
.
Àngth
);

263 
usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
ty≥
 = 
USIM_DL_NAS_COUNT_TAG
;

264 
usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
Àngth
 = 
USIM_DL_NAS_COUNT_SIZE
;

265 
	`mem£t
(
usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
vÆue
, 0,

266 
usim_d©a
.
£curôy˘x
.
dlNAScou¡
.
Àngth
);

267 
usim_d©a
.
£curôy˘x
.
Æg‹ôhmID
.
ty≥
 = 
USIM_INT_ENC_ALGORITHMS_TAG
;

268 
usim_d©a
.
£curôy˘x
.
Æg‹ôhmID
.
Àngth
 = 1;

269 
usim_d©a
.
£curôy˘x
.
Æg‹ôhmID
.
vÆue
[0] = 
SECURITY_ALGORITHMS
;

273 
usim_d©a
.
msisdn
.
Àngth
 = 7;

274 
usim_d©a
.
msisdn
.
numbî
.
ext
 = 1;

275 
usim_d©a
.
msisdn
.
numbî
.
t⁄
 = 
MSISDN_TON_UNKNOWKN
;

276 
usim_d©a
.
msisdn
.
numbî
.
≈i
 = 
MSISDN_NPI_ISDN_TELEPHONY
;

277 
usim_d©a
.
msisdn
.
numbî
.
digô
[0].
msb
 = 3;

278 
usim_d©a
.
msisdn
.
numbî
.
digô
[0].
lsb
 = 3;

279 
usim_d©a
.
msisdn
.
numbî
.
digô
[1].
msb
 = 6;

280 
usim_d©a
.
msisdn
.
numbî
.
digô
[1].
lsb
 = 1;

281 
usim_d©a
.
msisdn
.
numbî
.
digô
[2].
msb
 = 1;

282 
usim_d©a
.
msisdn
.
numbî
.
digô
[2].
lsb
 = 1;

283 
usim_d©a
.
msisdn
.
numbî
.
digô
[3].
msb
 = 2;

284 
usim_d©a
.
msisdn
.
numbî
.
digô
[3].
lsb
 = 3;

285 
usim_d©a
.
msisdn
.
numbî
.
digô
[4].
msb
 = 4;

286 
usim_d©a
.
msisdn
.
numbî
.
digô
[4].
lsb
 = 5;

287 
usim_d©a
.
msisdn
.
numbî
.
digô
[5].
msb
 = 6;

288 
usim_d©a
.
msisdn
.
numbî
.
digô
[5].
lsb
 = 0xf;

289 
usim_d©a
.
msisdn
.
numbî
.
digô
[6].
msb
 = 0xf;

290 
usim_d©a
.
msisdn
.
numbî
.
digô
[6].
lsb
 = 0xf;

291 
usim_d©a
.
msisdn
.
numbî
.
digô
[7].
msb
 = 0xf;

292 
usim_d©a
.
msisdn
.
numbî
.
digô
[7].
lsb
 = 0xf;

293 
usim_d©a
.
msisdn
.
numbî
.
digô
[8].
msb
 = 0xf;

294 
usim_d©a
.
msisdn
.
numbî
.
digô
[8].
lsb
 = 0xf;

295 
usim_d©a
.
msisdn
.
numbî
.
digô
[9].
msb
 = 0xf;

296 
usim_d©a
.
msisdn
.
numbî
.
digô
[9].
lsb
 = 0xf;

297 
usim_d©a
.
msisdn
.
c⁄f1_ªc‹d_id
 = 0xff;

298 
usim_d©a
.
msisdn
.
ext1_ªc‹d_id
 = 0xff;

302 
i
 = 
SFR1
; i < 
VDF2
; i++) {

303 
√tw‹k_ªc‹d_t
 
ªc‹d
 = 
√tw‹k_ªc‹ds
[
i
];

304 
usim_d©a
.
≤n
[
i
].
fuŒ«me
.
ty≥
 = 
USIM_PNN_FULLNAME_TAG
;

305 
usim_d©a
.
≤n
[
i
].
fuŒ«me
.
Àngth
 = 
	`°æí
(
ªc‹d
.fullname);

306 
	`°∫˝y
((*)
usim_d©a
.
≤n
[
i
].
fuŒ«me
.
vÆue
, 
ªc‹d
.fullname,

307 
usim_d©a
.
≤n
[
i
].
fuŒ«me
.
Àngth
);

308 
usim_d©a
.
≤n
[
i
].
sh‹äame
.
ty≥
 = 
USIM_PNN_SHORTNAME_TAG
;

309 
usim_d©a
.
≤n
[
i
].
sh‹äame
.
Àngth
 = 
	`°æí
(
ªc‹d
.shortname);

310 
	`°∫˝y
((*)
usim_d©a
.
≤n
[
i
].
sh‹äame
.
vÆue
, 
ªc‹d
.shortname,

311 
usim_d©a
.
≤n
[
i
].
sh‹äame
.
Àngth
);

312 
usim_d©a
.
›l
[
i
].
∂mn
 = 
ªc‹d
.plmn;

313 
usim_d©a
.
›l
[
i
].
°¨t
 = 
ªc‹d
.
èc_°¨t
;

314 
usim_d©a
.
›l
[
i
].
íd
 = 
ªc‹d
.
èc_íd
;

315 
usim_d©a
.
›l
[
i
].
ªc‹d_id
 = i;

317 
i
 = 
VDF2
; i < 
USIM_OPL_MAX
; i++) {

318 
	`mem£t
(&
usim_d©a
.
›l
[
i
].
∂mn
, 0xff, (
∂mn_t
));

324 
usim_d©a
.
eh∂mn
[0] = 
√tw‹k_ªc‹ds
[
SFR2
].
∂mn
;

325 
usim_d©a
.
eh∂mn
[1] = 
√tw‹k_ªc‹ds
[
SFR3
].
∂mn
;

329 
usim_d©a
.
h∂mn
.
∂mn
 = 
√tw‹k_ªc‹ds
[
SELECTED_PLMN
].plmn;

330 
usim_d©a
.
h∂mn
.
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

334 
i
 = 0; i < 
USIM_PLMN_MAX
; i++) {

335 
	`mem£t
(&
usim_d©a
.
∂mn
[
i
], 0xff, (
∂mn_t
));

340 
usim_d©a
.
›lmn
[0].
∂mn
 = 
√tw‹k_ªc‹ds
[
VDF1
].plmn;

341 
usim_d©a
.
›lmn
[0].
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

342 
usim_d©a
.
›lmn
[1].
∂mn
 = 
√tw‹k_ªc‹ds
[
VDF2
].plmn;

343 
usim_d©a
.
›lmn
[1].
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

344 
usim_d©a
.
›lmn
[2].
∂mn
 = 
√tw‹k_ªc‹ds
[
VDF3
].plmn;

345 
usim_d©a
.
›lmn
[2].
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

346 
usim_d©a
.
›lmn
[3].
∂mn
 = 
√tw‹k_ªc‹ds
[
VDF4
].plmn;

347 
usim_d©a
.
›lmn
[3].
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

348 
usim_d©a
.
›lmn
[4].
∂mn
 = 
√tw‹k_ªc‹ds
[
VDF5
].plmn;

349 
usim_d©a
.
›lmn
[4].
AcT
 = (
USIM_ACT_GSM
 | 
USIM_ACT_UTRAN
 | 
USIM_ACT_EUTRAN
);

350 
i
 = 5; i < 
USIM_OPLMN_MAX
; i++) {

351 
	`mem£t
(&
usim_d©a
.
›lmn
[
i
], 0xff, (
∂mn_t
));

356 
usim_d©a
.
ï¶oci
.
guti
.
gummei
.
∂mn
 = 
√tw‹k_ªc‹ds
[
SELECTED_PLMN
].plmn;

357 
usim_d©a
.
ï¶oci
.
guti
.
gummei
.
MMEgid
 = 
DEFAULT_MME_ID
;

358 
usim_d©a
.
ï¶oci
.
guti
.
gummei
.
MMEcode
 = 
DEFAULT_MME_CODE
;

359 
usim_d©a
.
ï¶oci
.
guti
.
m_tmsi
 = 
DEFAULT_M_TMSI
;

360 
usim_d©a
.
ï¶oci
.
èi
.
∂mn
 = usim_d©a.ï¶oci.
guti
.
gummei
.plmn;

361 
usim_d©a
.
ï¶oci
.
èi
.
èc
 = 
DEFAULT_TAC
;

362 
usim_d©a
.
ï¶oci
.
°©us
 = 
USIM_EPSLOCI_UPDATED
;

366 
usim_d©a
.
«sc⁄fig
.
NAS_Sig«ŒögPri‹ôy
.
ty≥
 = 
USIM_NAS_SIGNALLING_PRIORITY_TAG
;

367 
usim_d©a
.
«sc⁄fig
.
NAS_Sig«ŒögPri‹ôy
.
Àngth
 = 1;

368 
usim_d©a
.
«sc⁄fig
.
NAS_Sig«ŒögPri‹ôy
.
vÆue
[0] = 0x00;

369 
usim_d©a
.
«sc⁄fig
.
NMO_I_Behaviour
.
ty≥
 = 
USIM_NMO_I_BEHAVIOUR_TAG
;

370 
usim_d©a
.
«sc⁄fig
.
NMO_I_Behaviour
.
Àngth
 = 1;

371 
usim_d©a
.
«sc⁄fig
.
NMO_I_Behaviour
.
vÆue
[0] = 0x00;

372 
usim_d©a
.
«sc⁄fig
.
AâachWôhImsi
.
ty≥
 = 
USIM_ATTACH_WITH_IMSI_TAG
;

373 
usim_d©a
.
«sc⁄fig
.
AâachWôhImsi
.
Àngth
 = 1;

374 #i‡
	`deföed
(
START_WITH_GUTI
)

375 
usim_d©a
.
«sc⁄fig
.
AâachWôhImsi
.
vÆue
[0] = 0x00;

377 
usim_d©a
.
«sc⁄fig
.
AâachWôhImsi
.
vÆue
[0] = 0x01;

379 
usim_d©a
.
«sc⁄fig
.
MöimumPîiodicSórchTimî
.
ty≥
 = 
USIM_MINIMUM_PERIODIC_SEARCH_TIMER_TAG
;

380 
usim_d©a
.
«sc⁄fig
.
MöimumPîiodicSórchTimî
.
Àngth
 = 1;

381 
usim_d©a
.
«sc⁄fig
.
MöimumPîiodicSórchTimî
.
vÆue
[0] = 0x00;

382 
usim_d©a
.
«sc⁄fig
.
ExãndedAc˚ssB¨rög
.
ty≥
 = 
USIM_EXTENDED_ACCESS_BARRING_TAG
;

383 
usim_d©a
.
«sc⁄fig
.
ExãndedAc˚ssB¨rög
.
Àngth
 = 1;

384 
usim_d©a
.
«sc⁄fig
.
ExãndedAc˚ssB¨rög
.
vÆue
[0] = 0x00;

385 
usim_d©a
.
«sc⁄fig
.
Timî_T3245_Behaviour
.
ty≥
 = 
USIM_TIMER_T3245_BEHAVIOUR_TAG
;

386 
usim_d©a
.
«sc⁄fig
.
Timî_T3245_Behaviour
.
Àngth
 = 1;

387 
usim_d©a
.
«sc⁄fig
.
Timî_T3245_Behaviour
.
vÆue
[0] = 0x00;

392 
rc
 = 
	`usim_≠i_wrôe
(&
usim_d©a
);

393 i‡(
rc
 !
RETURNok
) {

394 
	`≥º‹
("ERROR\t: usim_api_write() failed");

395 
	`exô
(
EXIT_FAILURE
);

402 
	`mem£t
(&
usim_d©a
, 0, (
usim_d©a_t
));

403 
rc
 = 
	`usim_≠i_ªad
(&
usim_d©a
);

404 i‡(
rc
 !
RETURNok
) {

405 
	`≥º‹
("ERROR\t: usim_api_read() failed");

406 
	`exô
(
EXIT_FAILURE
);

412 
	`¥ötf
("\nUSIM data:\n\n");

413 
	`_di•œy_usim_d©a
(&
usim_d©a
);

418 * 
∑th
 = 
	`mem‹y_gë_∑th
("USIM_DIR", ".usim.nvram");

419 
	`¥ötf
("\nUSIM d©®fûe: %s\n", 
∑th
);

420 
	`‰ì
(
∑th
);

422 
	`exô
(
EXIT_SUCCESS
);

423 
	}
}

432 
	$_di•œy_ußge
(c⁄° * 
comm™d
)

434 
	`Ârötf
(
°dîr
, "ußge: %†[OPTION]\n", 
comm™d
);

435 
	`Ârötf
(
°dîr
, "\t[--gen|-g]\tGenerateÅhe USIM data file\n");

436 
	`Ârötf
(
°dîr
, "\t[--print|-p]\tDisplayÅhe content ofÅhe USIM data file\n");

437 
	`Ârötf
(
°dîr
, "\t[--help|-h]\tDisplayÅhis usage\n");

438 c⁄° * 
∑th
 = 
	`gëív
("USIM_DIR");

439 i‡(
∑th
 !
NULL
) {

440 
	`Ârötf
(
°dîr
, "USIM_DIR = %s\n", 
∑th
);

443 
	`Ârötf
(
°dîr
, "USIM_DIRÉnvironment variable isÇot defined\n");

445 
	}
}

450 
	$_di•œy_usim_d©a
(c⁄° 
usim_d©a_t
* 
d©a
)

452 
digôs
;

454 
	`¥ötf
("Administrative Data:\n");

455 
	`¥ötf
("\tUE_O≥øti⁄_Mode\t0x%.2x\n", 
d©a
->
ad
.
UE_O≥øti⁄_Mode
);

456 
	`¥ötf
("\tAddôi⁄Æ_Info\t\t0x%.4x\n", 
d©a
->
ad
.
Addôi⁄Æ_Info
);

457 
	`¥ötf
("\tMNC_Lígth\t\t%d\n\n", 
d©a
->
ad
.
MNC_Lígth
);

459 
	`¥ötf
("IMSI:\n");

460 
	`¥ötf
("\éígth\t%d\n", 
d©a
->
imsi
.
Àngth
);

461 
	`¥ötf
("\ç¨ôy\t%s\n", 
d©a
->
imsi
.
u
.
num
.
∑rôy
 =
EVEN_PARITY
 ? "Even" : "Odd");

462 
digôs
 = (
d©a
->
imsi
.
Àngth
 * 2Ë- 1 - (d©a->imsi.
u
.
num
.
∑rôy
 =
EVEN_PARITY
 ? 1 : 0);

463 
	`¥ötf
("\tdigôs\t%d\n", 
digôs
);

464 
	`¥ötf
("\tdigits\t= %u%u%u%u%u%x%u%u%u%u",

465 
d©a
->
imsi
.
u
.
num
.
digô1
,

466 
d©a
->
imsi
.
u
.
num
.
digô2
,

467 
d©a
->
imsi
.
u
.
num
.
digô3
,

468 
d©a
->
imsi
.
u
.
num
.
digô4
,

469 
d©a
->
imsi
.
u
.
num
.
digô5
,

470 
d©a
->
imsi
.
u
.
num
.
digô6
,

471 
d©a
->
imsi
.
u
.
num
.
digô7
,

472 
d©a
->
imsi
.
u
.
num
.
digô8
,

473 
d©a
->
imsi
.
u
.
num
.
digô9
,

474 
d©a
->
imsi
.
u
.
num
.
digô10
);

475 i‡(
digôs
 >= 11)

476 
	`¥ötf
("%x", 
d©a
->
imsi
.
u
.
num
.
digô11
);

477 i‡(
digôs
 >= 12)

478 
	`¥ötf
("%x", 
d©a
->
imsi
.
u
.
num
.
digô12
);

479 i‡(
digôs
 >= 13)

480 
	`¥ötf
("%x", 
d©a
->
imsi
.
u
.
num
.
digô13
);

481 i‡(
digôs
 >= 14)

482 
	`¥ötf
("%x", 
d©a
->
imsi
.
u
.
num
.
digô14
);

483 i‡(
digôs
 >= 15)

484 
	`¥ötf
("%x", 
d©a
->
imsi
.
u
.
num
.
digô15
);

485 
	`¥ötf
("\n\n");

487 
	`¥ötf
("Cipheringánd Integrity Keys:\n");

488 
	`¥ötf
("\tKSI\t: 0x%.2x\n", 
d©a
->
keys
.
ksi
);

489 
key
[
USIM_CK_SIZE
+1];

490 
key
[
USIM_CK_SIZE
] = '\0';

491 
	`mem˝y
(
key
, 
d©a
->
keys
.
ck
, 
USIM_CK_SIZE
);

492 
	`¥ötf
("\tCK\t: \"%s\"\n", 
key
);

493 
	`mem˝y
(
key
, 
d©a
->
keys
.
ik
, 
USIM_IK_SIZE
);

494 
	`¥ötf
("\tIK\t: \"%s\"\n", 
key
);

496 
	`¥ötf
("EPS NAS security context:\n");

497 
	`¥ötf
("\tKSIasme\t: 0x%.2x\n", 
d©a
->
£curôy˘x
.
KSIasme
.
vÆue
[0]);

498 
kasme
[
USIM_K_ASME_SIZE
+1];

499 
kasme
[
USIM_K_ASME_SIZE
] = '\0';

500 
	`mem˝y
(
kasme
, 
d©a
->
£curôy˘x
.
Kasme
.
vÆue
, 
USIM_K_ASME_SIZE
);

501 
	`¥ötf
("\tKasme\t: \"%s\"\n", 
kasme
);

502 
	`¥ötf
("\tulNAScount\t: 0x%.8x\n",

503 *(
UI¡32_t
*)
d©a
->
£curôy˘x
.
ulNAScou¡
.
vÆue
);

504 
	`¥ötf
("\tdlNAScount\t: 0x%.8x\n",

505 *(
UI¡32_t
*)
d©a
->
£curôy˘x
.
dlNAScou¡
.
vÆue
);

506 
	`¥ötf
("\talgorithmID\t: 0x%.2x\n\n",

507 
d©a
->
£curôy˘x
.
Æg‹ôhmID
.
vÆue
[0]);

509 
	`¥ötf
("MSISDN\t= %u%u%u %u%u%u%u %u%u%u%u\n\n",

510 
d©a
->
msisdn
.
numbî
.
digô
[0].
msb
,

511 
d©a
->
msisdn
.
numbî
.
digô
[0].
lsb
,

512 
d©a
->
msisdn
.
numbî
.
digô
[1].
msb
,

513 
d©a
->
msisdn
.
numbî
.
digô
[1].
lsb
,

514 
d©a
->
msisdn
.
numbî
.
digô
[2].
msb
,

515 
d©a
->
msisdn
.
numbî
.
digô
[2].
lsb
,

516 
d©a
->
msisdn
.
numbî
.
digô
[3].
msb
,

517 
d©a
->
msisdn
.
numbî
.
digô
[3].
lsb
,

518 
d©a
->
msisdn
.
numbî
.
digô
[4].
msb
,

519 
d©a
->
msisdn
.
numbî
.
digô
[4].
lsb
,

520 
d©a
->
msisdn
.
numbî
.
digô
[5].
msb
);

522 
i
 = 0; i < 
USIM_PNN_MAX
; i++) {

523 
	`¥ötf
("PNN[%d]\t{%s, %s}\n", 
i
,

524 
d©a
->
≤n
[
i
].
fuŒ«me
.
vÆue
, d©a->≤n[i].
sh‹äame
.value);

526 
	`¥ötf
("\n");

528 
i
 = 0; i < 
USIM_OPL_MAX
; i++) {

529 
	`¥ötf
("OPL[%d]\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
›l
[i].
∂mn
);

530 
	`¥ötf
(", TAC = [%.4x - %.4x],Ñecord_id = %d\n",

531 
d©a
->
›l
[
i
].
°¨t
, d©a->›l[i].
íd
, d©a->›l[i].
ªc‹d_id
);

533 
	`¥ötf
("\n");

535 
	`¥ötf
("HPLMN\t\t"); 
	`PRINT_PLMN
(
d©a
->
h∂mn
.
∂mn
);

536 
	`¥ötf
(", AcT = 0x%x\n\n", 
d©a
->
h∂mn
.
AcT
);

538 
i
 = 0; i < 
USIM_FPLMN_MAX
; i++) {

539 
	`¥ötf
("FPLMN[%d]\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
Âlmn
[i]);

540 
	`¥ötf
("\n");

542 
	`¥ötf
("\n");

544 
i
 = 0; i < 
USIM_EHPLMN_MAX
; i++) {

545 
	`¥ötf
("EHPLMN[%d]\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
eh∂mn
[i]);

546 
	`¥ötf
("\n");

548 
	`¥ötf
("\n");

550 
i
 = 0; i < 
USIM_PLMN_MAX
; i++) {

551 
	`¥ötf
("PLMN[%d]\t\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
∂mn
[i].plmn);

552 
	`¥ötf
(", AcTPLMN = 0x%x", 
d©a
->
∂mn
[
i
].
AcT
);

553 
	`¥ötf
("\n");

555 
	`¥ötf
("\n");

557 
i
 = 0; i < 
USIM_OPLMN_MAX
; i++) {

558 
	`¥ötf
("OPLMN[%d]\t", 
i
); 
	`PRINT_PLMN
(
d©a
->
›lmn
[i].
∂mn
);

559 
	`¥ötf
(", AcTPLMN = 0x%x", 
d©a
->
›lmn
[
i
].
AcT
);

560 
	`¥ötf
("\n");

562 
	`¥ötf
("\n");

564 
	`¥ötf
("HPPLMN\t\t0x%.2x (%d möuãs)\n\n", 
d©a
->
hµlmn
, data->hpplmn);

566 
	`¥ötf
("LOCI:\n");

567 
	`¥ötf
("\tTMSI = 0x%.4x\n", 
d©a
->
loci
.
tmsi
);

568 
	`¥ötf
("\tLAI\t: PLMN = "); 
	`PRINT_PLMN
(
d©a
->
loci
.
œi
.
∂mn
);

569 
	`¥ötf
(", LAC = 0x%.2x\n", 
d©a
->
loci
.
œi
.
œc
);

570 
	`¥ötf
("\t°©us\t%d\n\n", 
d©a
->
loci
.
°©us
);

572 
	`¥ötf
("PSLOCI:\n");

573 
	`¥ötf
("\tP-TMSI = 0x%.4x\n", 
d©a
->
p¶oci
.
p_tmsi
);

574 
	`¥ötf
("\tsignature = 0x%x 0x%x 0x%x\n",

575 
d©a
->
p¶oci
.
sig«tuª
[0],

576 
d©a
->
p¶oci
.
sig«tuª
[1],

577 
d©a
->
p¶oci
.
sig«tuª
[2]);

578 
	`¥ötf
("\tRAI\t: PLMN = "); 
	`PRINT_PLMN
(
d©a
->
p¶oci
.
øi
.
∂mn
);

579 
	`¥ötf
(", LAC = 0x%.2x, RAC = 0x%.1x\n",

580 
d©a
->
p¶oci
.
øi
.
œc
, d©a->p¶oci.øi.
øc
);

581 
	`¥ötf
("\t°©us\t%d\n\n", 
d©a
->
p¶oci
.
°©us
);

583 
	`¥ötf
("EPSLOCI:\n");

584 
	`¥ötf
("\tGUTI\t: GUMMEI\t: (PLMN = ");

585 
	`PRINT_PLMN
(
d©a
->
ï¶oci
.
guti
.
gummei
.
∂mn
);

586 
	`¥ötf
(", MMEgid = 0x%.2x, MMEcode = 0x%.1x)",

587 
d©a
->
ï¶oci
.
guti
.
gummei
.
MMEgid
,

588 
d©a
->
ï¶oci
.
guti
.
gummei
.
MMEcode
);

589 
	`¥ötf
(", M-TMSI = 0x%.4x\n", 
d©a
->
ï¶oci
.
guti
.
m_tmsi
);

590 
	`¥ötf
("\tTAI\t: PLMN = ");

591 
	`PRINT_PLMN
(
d©a
->
ï¶oci
.
èi
.
∂mn
);

592 
	`¥ötf
(", TAC = 0x%.2x\n",

593 
d©a
->
ï¶oci
.
èi
.
èc
);

594 
	`¥ötf
("\t°©us\t%d\n\n", 
d©a
->
ï¶oci
.
°©us
);

596 
	`¥ötf
("NASCONFIG:\n");

597 
	`¥ötf
("\tNAS_SignallingPriority\t\t: 0x%.2x\n",

598 
d©a
->
«sc⁄fig
.
NAS_Sig«ŒögPri‹ôy
.
vÆue
[0]);

599 
	`¥ötf
("\tNMO_I_Behaviour\t\t\t: 0x%.2x\n",

600 
d©a
->
«sc⁄fig
.
NMO_I_Behaviour
.
vÆue
[0]);

601 
	`¥ötf
("\tAttachWithImsi\t\t\t: 0x%.2x\n",

602 
d©a
->
«sc⁄fig
.
AâachWôhImsi
.
vÆue
[0]);

603 
	`¥ötf
("\tMinimumPeriodicSearchTimer\t: 0x%.2x\n",

604 
d©a
->
«sc⁄fig
.
MöimumPîiodicSórchTimî
.
vÆue
[0]);

605 
	`¥ötf
("\tExtendedAccessBarring\t\t: 0x%.2x\n",

606 
d©a
->
«sc⁄fig
.
ExãndedAc˚ssB¨rög
.
vÆue
[0]);

607 
	`¥ötf
("\tTimer_T3245_Behaviour\t\t: 0x%.2x\n",

608 
d©a
->
«sc⁄fig
.
Timî_T3245_Behaviour
.
vÆue
[0]);

609 
	}
}

	@tst/as_simulator/as_data.c

22 
	~"as_d©a.h
"

24 
	~"as_mesßge.h
"

26 
	~<°dio.h
>

27 
	~<time.h
>

46 c⁄° * 
	$gëTime
()

48 
	#TIME_BUFFER_SIZE
 16

	)

49 
time_buf„r
[
TIME_BUFFER_SIZE
];

50 
time•ec
 
ts
;

52 
	`˛ock_gëtime
 (
CLOCK_REALTIME
, &
ts
);

53 
	`¢¥ötf
(
time_buf„r
, 
TIME_BUFFER_SIZE
, "%.6ld:%.6ld",

54 
ts
.
tv_£c
 % 3600,Ås.
tv_n£c
 / 1000);

55  (
time_buf„r
);

56 
	}
}

63 c⁄° * 
	$ºcCau£
(
ˇu£
)

65 i‡(
ˇu£
 =
AS_CAUSE_EMERGENCY
) {

67 } i‡(
ˇu£
 =
AS_CAUSE_HIGH_PRIO
) {

69 } i‡(
ˇu£
 =
AS_CAUSE_MT_ACCESS
) {

71 } i‡(
ˇu£
 =
AS_CAUSE_MO_SIGNAL
) {

73 } i‡(
ˇu£
 =
AS_CAUSE_MO_DATA
) {

75 } i‡(
ˇu£
 =
AS_CAUSE_V1020
) {

80 
	}
}

87 c⁄° * 
	$ºcTy≥
(
ty≥
)

89 i‡(
ty≥
 =
AS_TYPE_ORIGINATING_SIGNAL
) {

91 } i‡(
ty≥
 =
AS_TYPE_EMERGENCY_CALLS
) {

93 } i‡(
ty≥
 =
AS_TYPE_ORIGINATING_CALLS
) {

95 } i‡(
ty≥
 =
AS_TYPE_TERMINATING_CALLS
) {

97 } i‡(
ty≥
 =
AS_TYPE_MO_CS_FALLBACK
) {

102 
	}
}

109 c⁄° * 
	$ºcEºCode
(
code
)

111 i‡(
code
 =
AS_SUCCESS
) {

113 } i‡(
code
 =
AS_TERMINATED_NAS
) {

115 } i‡(
code
 =
AS_TERMINATED_AS
) {

117 } i‡(
code
 =
AS_FAILURE
) {

122 
	}
}

129 c⁄° * 
	$ºcRñó£Cau£
(
ˇu£
)

131 i‡(
ˇu£
 =
AS_AUTHENTICATION_FAILURE
) {

133 } i‡(
ˇu£
 =
AS_DETACH
) {

138 
	}
}

	@tst/as_simulator/as_data.h

22 #i‚de‡
__AS_DATA_H__


23 
	#__AS_DATA_H__


	)

32 
	#MSCGEN
(
¨gs
...Ë
	`Ârötf
(
°dîr
, ##¨gs);

	)

33 
	#_ue_id
 "UE"

	)

34 
	#_mme_id
 "MME"

	)

35 
	#_as_id
 "AS"

	)

49 c⁄° * 
gëTime
();

51 c⁄° * 
ºcCau£
(
ˇu£
);

52 c⁄° * 
ºcTy≥
(
ty≥
);

53 c⁄° * 
ºcEºCode
(
code
);

54 c⁄° * 
ºcRñó£Cau£
(
ˇu£
);

	@tst/as_simulator/as_process.c

22 
	~"as_¥o˚ss.h
"

23 
	~"«s_¥o˚ss.h
"

25 
	~"comm⁄Def.h
"

26 
	~"as_d©a.h
"

28 
	~<sys/ty≥s.h
>

29 
	~<°dio.h
>

30 
	~<°rög.h
>

41 
	#MSCGEN_BUFFER_SIZE
 1024

	)

42 
	g_mscgí_buf„r
[
MSCGEN_BUFFER_SIZE
];

45 
	#DEFAULT_TAC
 0xCAFE

46 

	)

48 
	#DEFAULT_CI
 0x01020304

49 

	)

51 
	#DEFAULT_RSRP
 27

	)

54 
	#DEFAULT_RSRQ
 55

	)

56 
ssize_t
 
_¥o˚ss_∂mn
(* 
buf„r
, c⁄° 
∂mn_t
* 
∂mn
, 
size_t
 
Àn
);

57 
_¥o˚ss_dump
(* 
buf„r
, 
Àn
, c⁄° * 
msg
, 
size
);

74 
	$¥o˚ss_˚Œ_öfo_ªq
(
msg_id
, c⁄° 
˚Œ_öfo_ªq_t
* 
ªq
,

75 
˚Œ_öfo_˙f_t
* 
˙f
)

77 
ödex
 = 0;

79 
	`¥ötf
("INFO\t: %†- Pro˚s†˚Œ inf‹m©i⁄Ñeque°\n", 
__FUNCTION__
);

81 
ödex
 +
	`_¥o˚ss_∂mn
(
_mscgí_buf„r
, &
ªq
->
∂mnID
, 
MSCGEN_BUFFER_SIZE
);

82 
	`¢¥ötf
(
_mscgí_buf„r
 + 
ödex
, 
MSCGEN_BUFFER_SIZE
 - index,

83 ",Ñ© = 0x%x%c", 
ªq
->
øt
, '\0');

84 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Cell Information Request (0x%.4x)\\n%s --->][%s]\n",

85 
	`gëTime
(), 
_ue_id
, 
msg_id
, 
_mscgí_buf„r
, 
_as_id
);

88 
˙f
->
îrCode
 = 
AS_SUCCESS
;

89 
˙f
->
èc
 = 
DEFAULT_TAC
;

90 
˙f
->
˚ŒID
 = 
DEFAULT_CI
;

91 
˙f
->
øt
 = 
AS_EUTRAN
;

92 
˙f
->
r§p
 = 
DEFAULT_RSRP
;

93 
˙f
->
r§q
 = 
DEFAULT_RSRQ
;

95 
	`¢¥ötf
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

97 
˙f
->
èc
, cnf->
˚ŒID
, cnf->
øt
, cnf->
r§q
, cnf->
r§p
, '\0');

98 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Cell Information Confirm (0x%.4x)\\n%s --->][%s]\n",

99 
	`gëTime
(), 
_as_id
, 
AS_CELL_INFO_CNF
, 
_mscgí_buf„r
, 
_ue_id
);

101 
	`¥ötf
("INFO\t: %†- Síd cñ»öf‹mti⁄ c⁄fúm\n", 
__FUNCTION__
);

102  (
AS_CELL_INFO_CNF
);

103 
	}
}

110 
	$¥o˚ss_«s_e°ablish_ªq
(
msg_id
, c⁄° 
«s_e°ablish_ªq_t
* 
ªq
,

111 
«s_e°ablish_öd_t
* 
öd
,

112 
«s_e°ablish_˙f_t
* 
˙f
)

114 
byãs
;

116 
	`¥ötf
("INFO\t: %s - Process NAS signalling connectionÉstablishment "

117 "ªque°\n", 
__FUNCTION__
);

124 
	`¢¥ötf
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

126 
	`ºcCau£
(
ªq
->
ˇu£
), 
	`ºcTy≥
‘eq->
ty≥
),

127 
ªq
->
s_tmsi
.
MMEcode
,Ñeq->s_tmsi.
m_tmsi
, '\0');

128 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment Request "

130 
	`gëTime
(), 
_ue_id
, 
msg_id
, 
_mscgí_buf„r
, 
_as_id
);

132 
	`_¥o˚ss_dump
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

133 (*)
ªq
->
öôülNasMsg
.
d©a
,Ñeq->öôülNasMsg.
Àngth
);

134 
	`MSCGEN
("[MSC_RBOX][%s][%s][%s]\n", 
_ue_id
, 
_as_id
, 
_mscgí_buf„r
);

137 
byãs
 = 
	`«s_¥o˚ss
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

138 (*)
ªq
->
öôülNasMsg
.
d©a
,

139 
ªq
->
öôülNasMsg
.
Àngth
);

140 i‡(
byãs
 < 0) {

141 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment "

142 "Indiˇti⁄ (0x%.4x)\\¡a¯0x%.4x\\n%†---x][%s]\n", 
	`gëTime
(),

143 
_as_id
, 
AS_NAS_ESTABLISH_IND
, 
öd
->
èc
, 
_mscgí_buf„r
, 
_mme_id
);

145 
˙f
->
îrCode
 = 
AS_TERMINATED_AS
;

150 
öd
->
UEid
 = 1;

151 
öd
->
èc
 = 
DEFAULT_TAC
;

152 i‡(
ªq
->
öôülNasMsg
.
Àngth
 > 0) {

153 
öd
->
öôülNasMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
ªq
->öôülNasMsg.
Àngth
);

154 i‡(
öd
->
öôülNasMsg
.
d©a
) {

155 
	`mem˝y
(
öd
->
öôülNasMsg
.
d©a
, 
ªq
->initialNasMsg.data,

156 
ªq
->
öôülNasMsg
.
Àngth
);

157 
öd
->
öôülNasMsg
.
Àngth
 = 
ªq
->initialNasMsg.length;

165 
˙f
->
îrCode
 = 
AS_SUCCESS
;

169 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment Indication "

170 "(0x%.4x)\\nUEid = %u,Åa¯0x%.4x\\n%†--->][%s]\n", 
	`gëTime
(),

171 
_as_id
, 
AS_NAS_ESTABLISH_IND
, 
öd
->
UEid
, ind->
èc
, 
_mscgí_buf„r
, 
_mme_id
);

173 
	`¥ötf
("INFO\t: %s - Send NAS signalling connectionÉstablishment "

174 "ödiˇti⁄\n", 
__FUNCTION__
);

175  (
AS_NAS_ESTABLISH_IND
);

176 
	}
}

183 
	$¥o˚ss_ul_öfo_å™s„r_ªq
(
msg_id
, c⁄° 
ul_öfo_å™s„r_ªq_t
* 
ªq
,

184 
ul_öfo_å™s„r_öd_t
* 
öd
,

185 
ul_öfo_å™s„r_˙f_t
* 
˙f
)

187 
byãs
;

189 
	`¥ötf
("INFO\t: %†- Pro˚s†u∂ök d©®å™s„∏ªque°\n", 
__FUNCTION__
);

200 
	`¢¥ötf
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

202 
ªq
->
s_tmsi
.
MMEcode
,Ñeq->s_tmsi.
m_tmsi
, '\0');

203 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Uplink Information Request "

205 
	`gëTime
(), 
_ue_id
, 
msg_id
, 
_mscgí_buf„r
, 
_as_id
);

207 
	`_¥o˚ss_dump
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

208 (*)
ªq
->
«sMsg
.
d©a
,Ñeq->«sMsg.
Àngth
);

209 
	`MSCGEN
("[MSC_RBOX][%s][%s][%s]\n", 
_ue_id
, 
_as_id
, 
_mscgí_buf„r
);

212 
byãs
 = 
	`«s_¥o˚ss
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

213 (*)
ªq
->
«sMsg
.
d©a
,

214 
ªq
->
«sMsg
.
Àngth
);

215 i‡(
byãs
 < 0) {

216 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Uplink Information Indication "

217 "(0x%.4x)\\n%†---x][%s]\n", 
	`gëTime
(),

218 
_as_id
, 
AS_UL_INFO_TRANSFER_IND
, 
_mscgí_buf„r
, 
_mme_id
);

220 
˙f
->
îrCode
 = 
AS_TERMINATED_AS
;

225 
öd
->
UEid
 = 1;

226 i‡(
ªq
->
«sMsg
.
Àngth
 > 0) {

227 
öd
->
«sMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
ªq
->«sMsg.
Àngth
);

228 i‡(
öd
->
«sMsg
.
d©a
) {

229 
	`mem˝y
(
öd
->
«sMsg
.
d©a
, 
ªq
->«sMsg.d©a,Ñeq->«sMsg.
Àngth
);

230 
öd
->
«sMsg
.
Àngth
 = 
ªq
->nasMsg.length;

248 
˙f
->
UEid
 = 0;

249 
˙f
->
îrCode
 = 
AS_SUCCESS
;

255 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Uplink Information Indication "

256 "(0x%.4x), UEid = %u\\n%†--->][%s]\n", 
	`gëTime
(),

257 
_as_id
, 
AS_UL_INFO_TRANSFER_IND
, 
öd
->
UEid
, 
_mscgí_buf„r
, 
_mme_id
);

259 
	`¥ötf
("INFO\t: %†- Síd u∂ök d©®å™s„∏ödiˇti⁄\n", 
__FUNCTION__
);

260  (
AS_UL_INFO_TRANSFER_IND
);

261 
	}
}

268 
	$¥o˚ss_«s_ªÀa£_ªq
(
msg_id
, c⁄° 
«s_ªÀa£_ªq_t
* 
ªq
)

270 
	`¥ötf
("INFO\t: %s - Process NAS signalling connectionÑeleaseÑequest\n",

271 
__FUNCTION__
);

273 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Release Request "

275 "ˇu£ = %†(%uË--->][%s]\n", 
	`gëTime
(), 
_ue_id
, 
msg_id
,

276 
ªq
->
s_tmsi
.
MMEcode
,Ñeq->s_tmsi.
m_tmsi
,

277 
	`ºcRñó£Cau£
(
ªq
->
ˇu£
),Ñeq->ˇu£, 
_as_id
);

278  (
AS_NAS_RELEASE_REQ
);

279 
	}
}

292 
	$¥o˚ss_«s_e°ablish_r•
(
msg_id
, c⁄° 
«s_e°ablish_r•_t
* 
r•
,

293 
«s_e°ablish_˙f_t
* 
˙f
)

295 
byãs
;

297 
	`¥ötf
("INFO\t: %s - Process NAS signalling connectionÉstablishment "

298 "ª•⁄£\n", 
__FUNCTION__
);

308 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment "

310 
	`gëTime
(), 
_mme_id
, 
msg_id
,

311 
	`ºcEºCode
(
r•
->
îrCode
),Ñ•->
UEid
, 
_as_id
);

313 
	`_¥o˚ss_dump
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

314 (*)
r•
->
«sMsg
.
d©a
,Ñ•->«sMsg.
Àngth
);

315 
	`MSCGEN
("[MSC_RBOX][%s][%s][%s]\n", 
_mme_id
, 
_as_id
, 
_mscgí_buf„r
);

321 
byãs
 = 
	`«s_¥o˚ss
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

322 (*)
r•
->
«sMsg
.
d©a
,

323 
r•
->
«sMsg
.
Àngth
);

325 i‡(
byãs
 < 0) {

326 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment "

327 "C⁄fúm (0x%.4x)\\n%†---x][%s]\n", 
	`gëTime
(),

328 
_as_id
, 
AS_NAS_ESTABLISH_CNF
, 
_mscgí_buf„r
, 
_ue_id
);

333 
˙f
->
îrCode
 = 
r•
->errCode;

334 i‡(
r•
->
«sMsg
.
Àngth
 > 0) {

335 
˙f
->
«sMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
r•
->«sMsg.
Àngth
);

336 i‡(
˙f
->
«sMsg
.
d©a
) {

337 
	`mem˝y
(
˙f
->
«sMsg
.
d©a
, 
r•
->nasMsg.data,

338 
r•
->
«sMsg
.
Àngth
);

339 
˙f
->
«sMsg
.
Àngth
 = 
r•
->nasMsg.length;

343 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Establishment "

344 "C⁄fúm (0x%.4x)\\n%†--->][%s]\n", 
	`gëTime
(),

345 
_as_id
, 
AS_NAS_ESTABLISH_CNF
, 
_mscgí_buf„r
, 
_ue_id
);

347 
	`¥ötf
("INFO\t: %s - Send NAS signalling connectionÉstablishment "

348 "c⁄fúm\n", 
__FUNCTION__
);

349  (
AS_NAS_ESTABLISH_CNF
);

350 
	}
}

357 
	$¥o˚ss_dl_öfo_å™s„r_ªq
(
msg_id
, c⁄° 
dl_öfo_å™s„r_ªq_t
* 
ªq
,

358 
dl_öfo_å™s„r_öd_t
* 
öd
,

359 
dl_öfo_å™s„r_˙f_t
* 
˙f
)

361 
byãs
;

363 
	`¥ötf
("INFO\t: %s - Process downlink dataÅransferÑequest\n",

364 
__FUNCTION__
);

375 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Downlink Information Request "

377 
	`gëTime
(), 
_mme_id
, 
msg_id
, 
ªq
->
UEid
, 
_as_id
);

379 
	`_¥o˚ss_dump
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

380 (*)
ªq
->
«sMsg
.
d©a
,Ñeq->«sMsg.
Àngth
);

381 
	`MSCGEN
("[MSC_RBOX][%s][%s][%s]\n", 
_mme_id
, 
_as_id
, 
_mscgí_buf„r
);

384 
byãs
 = 
	`«s_¥o˚ss
(
_mscgí_buf„r
, 
MSCGEN_BUFFER_SIZE
,

385 (*)
ªq
->
«sMsg
.
d©a
,

386 
ªq
->
«sMsg
.
Àngth
);

387 i‡(
byãs
 < 0) {

388 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Downlink Information Indication "

389 "(0x%.4x)\\n%†---x][%s]\n", 
	`gëTime
(),

390 
_as_id
, 
AS_DL_INFO_TRANSFER_IND
, 
_mscgí_buf„r
, 
_ue_id
);

392 
˙f
->
UEid
 = 
ªq
->UEid;

393 
˙f
->
îrCode
 = 
AS_TERMINATED_AS
;

398 i‡(
ªq
->
«sMsg
.
Àngth
 > 0) {

399 
öd
->
«sMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
ªq
->«sMsg.
Àngth
);

400 i‡(
öd
->
«sMsg
.
d©a
) {

401 
	`mem˝y
(
öd
->
«sMsg
.
d©a
, 
ªq
->«sMsg.d©a,Ñeq->«sMsg.
Àngth
);

402 
öd
->
«sMsg
.
Àngth
 = 
ªq
->nasMsg.length;

407 
˙f
->
UEid
 = 
ªq
->UEid;

408 
˙f
->
îrCode
 = 
AS_SUCCESS
;

417 
	`MSCGEN
("[MSC_MSG][%s][%s][--- Downlink Information Indication "

418 "(0x%.4x)\\n%†--->][%s]\n", 
	`gëTime
(),

419 
_as_id
, 
AS_DL_INFO_TRANSFER_IND
, 
_mscgí_buf„r
, 
_ue_id
);

421 
	`¥ötf
("INFO\t: %†- Síd dow∆ök d©®å™s„∏ödiˇti⁄\n", 
__FUNCTION__
);

422  (
AS_DL_INFO_TRANSFER_IND
);

423 
	}
}

430 
	$¥o˚ss_«s_ªÀa£_öd
(
msg_id
, c⁄° 
«s_ªÀa£_ªq_t
* 
ªq
,

431 
«s_ªÀa£_öd_t
* 
öd
)

433 
	`¥ötf
("INFO\t: %s - Process NAS signalling connectionÑeleaseÑequest\n",

434 
__FUNCTION__
);

436 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Release Request "

438 
	`gëTime
(), 
_mme_id
, 
msg_id
, 
ªq
->
UEid
,

439 
	`ºcRñó£Cau£
(
ªq
->
ˇu£
),Ñeq->ˇu£, 
_as_id
);

442 
öd
->
ˇu£
 = 
ªq
->cause;

443 
	`MSCGEN
("[MSC_MSG][%s][%s][--- NAS Signalling Connection Release Indication "

445 
	`gëTime
(), 
_as_id
, 
msg_id
, 
	`ºcRñó£Cau£
(
ªq
->
ˇu£
),

446 
öd
->
ˇu£
, 
_ue_id
);

448 
	`¥ötf
("INFO\t: %s - Send NAS signalling connectionÑelease indication\n",

449 
__FUNCTION__
);

450  (
AS_NAS_RELEASE_IND
);

451 
	}
}

462 
ssize_t
 
	$_¥o˚ss_∂mn
(* 
buf„r
, c⁄° 
∂mn_t
* 
∂mn
, 
size_t
 
Àn
)

464 
ödex
 = 0;

465 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "plmnID = %u%u%u%u%u",

466 
∂mn
->
MCCdigô1
,Ölmn->
MCCdigô2
,Ölmn->
MCCdigô3
,

467 
∂mn
->
MNCdigô1
,Ölmn->
MNCdigô2
);

468 i‡–(
ödex
 < 
Àn
Ë&& (
∂mn
->
MNCdigô3
 != 0xf) ) {

469 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%u", 
∂mn
->
MNCdigô3
);

471  (
ödex
);

472 
	}
}

479 
	$_¥o˚ss_dump
(* 
buf„r
, 
Àn
, c⁄° * 
msg
, 
size
)

481 
ödex
 = 0;

482 
i
 = 0; i < 
size
; i++) {

483 i‡–(
i
%16Ë=0 ) 
ödex
 +
	`¢¥ötf
(
buf„r
 + index,

484 
Àn
 - 
ödex
, "\\n");

485 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

486 " %.2hx", ()(
msg
[
i
]));

488 
buf„r
[
ödex
] = '\0';

489  (
ödex
);

490 
	}
}

	@tst/as_simulator/as_process.h

22 #i‚de‡
__AS_PROCESS_H__


23 
	#__AS_PROCESS_H__


	)

25 
	~"as_mesßge.h
"

49 
¥o˚ss_˚Œ_öfo_ªq
(
msg_id
, c⁄° 
˚Œ_öfo_ªq_t
* 
ªq
,

50 
˚Œ_öfo_˙f_t
* 
˙f
);

51 
¥o˚ss_«s_e°ablish_ªq
(
msg_id
, c⁄° 
«s_e°ablish_ªq_t
* 
ªq
,

52 
«s_e°ablish_öd_t
* 
öd
, 
«s_e°ablish_˙f_t
* 
˙f
);

53 
¥o˚ss_ul_öfo_å™s„r_ªq
(
msg_id
, c⁄° 
ul_öfo_å™s„r_ªq_t
* 
ªq
,

54 
ul_öfo_å™s„r_öd_t
* 
öd
, 
ul_öfo_å™s„r_˙f_t
* 
˙f
);

55 
¥o˚ss_«s_ªÀa£_ªq
(
msg_id
, c⁄° 
«s_ªÀa£_ªq_t
* 
ªq
);

63 
¥o˚ss_«s_e°ablish_r•
(
msg_id
, c⁄° 
«s_e°ablish_r•_t
* 
r•
,

64 
«s_e°ablish_˙f_t
* 
˙f
);

65 
¥o˚ss_dl_öfo_å™s„r_ªq
(
msg_id
, c⁄° 
dl_öfo_å™s„r_ªq_t
* 
ªq
,

66 
dl_öfo_å™s„r_öd_t
* 
öd
, 
dl_öfo_å™s„r_˙f_t
* 
˙f
);

67 
¥o˚ss_«s_ªÀa£_öd
(
msg_id
, c⁄° 
«s_ªÀa£_ªq_t
* 
ªq
,

68 
«s_ªÀa£_öd_t
* 
öd
);

	@tst/as_simulator/as_simulator.c

24 
	~"as_simuœt‹_∑r£r.h
"

26 
	~"as_d©a.h
"

27 
	~"as_¥o˚ss.h
"

29 
	~"comm⁄Def.h
"

30 
	~"sockë.h
"

32 
	~"«s_log.h
"

34 
	~<°dio.h
>

35 
	~<î∫o.h
>

36 
	~<√tdb.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

39 
	~<pﬁl.h
>

40 
	~<sig«l.h
>

41 
	~<±hªad.h
>

51 
	#SLEEP_TIMEOUT
 1000

	)

53 
	#AS_SIMULATOR_NO_TRANSFER
 (0)

	)

54 
	#AS_SIMULATOR_TRANSFER_TO_UE
 (1 << 0)

	)

55 
	#AS_SIMULATOR_TRANSFER_TO_MME
 (1 << 1)

	)

60 
UI¡8_t
 
	g_as_simuœt‹_ue_å™s„r
 = 
AS_SIMULATOR_NO_TRANSFER
;

65 
UI¡8_t
 
	g_as_simuœt‹_mme_å™s„r
 = 
AS_SIMULATOR_NO_TRANSFER
;

70 
	g_as_simuœt‹_ue_size
 = 0;

75 
	g_as_simuœt‹_mme_size
 = 0;

80 
	#AS_SIMULATOR_UE_BUFFER_SIZE
 1024

	)

81 
	g_as_simuœt‹_ue_buf„r
 [
AS_SIMULATOR_UE_BUFFER_SIZE
];

86 
	#AS_SIMULATOR_MME_BUFFER_SIZE
 1024

	)

87 
	g_as_simuœt‹_mme_buf„r
 [
AS_SIMULATOR_MME_BUFFER_SIZE
];

92 
sockë_id_t
 * 
	g_as_simuœt‹_ue_sid
 = 
NULL
;

97 
sockë_id_t
 * 
	g_as_simuœt‹_mme_sid
 = 
NULL
;

102 
	g_as_simuœt‹_ue_is_ru¬ög
 = 
FALSE
;

107 
	g_as_simuœt‹_mme_is_ru¬ög
 = 
FALSE
;

109 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)());

110 
	`_sig«l_h™dÀr
(
sig«l_numbî
);

112 * 
	`_as_simuœt‹_ue_mngr
(*);

113 * 
	`_as_simuœt‹_mme_mngr
(*);

115 
	`_as_simuœt‹_ue_¥o˚ss
(
msg_id
, 
as_mesßge_t
* 
msg
);

116 
	`_as_simuœt‹_mme_¥o˚ss
(
msg_id
, 
as_mesßge_t
* 
msg
);

127 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

132 i‡–
	`as_simuœt‹_∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
Ë!
RETURNok
 )

134 
	`as_simuœt‹_∑r£r_¥öt_ußge
();

135 
	`exô
(
EXIT_FAILURE
);

137 c⁄° * 
uho°
 = 
	`as_simuœt‹_∑r£r_gë_uho°
();

138 c⁄° * 
up‹t
 = 
	`as_simuœt‹_∑r£r_gë_up‹t
();

139 c⁄° * 
mho°
 = 
	`as_simuœt‹_∑r£r_gë_mho°
();

140 c⁄° * 
mp‹t
 = 
	`as_simuœt‹_∑r£r_gë_mp‹t
();

142 
	`«s_log_öô
(0x2f);

147 
_as_simuœt‹_ue_sid
 = 
	`sockë_udp_›í
(
SOCKET_SERVER
, 
uho°
, 
up‹t
);

148 i‡(
_as_simuœt‹_ue_sid
 =
NULL
) {

149 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

150 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

151 
	`¥ötf
("ERROR\t: sockë_udp_›í(ËÁûed: %s\n", 
îr‹
);

152 
	`exô
(
EXIT_FAILURE
);

154 
	`¥ötf
("INFO\t: %s - The RRC Simulator isÇow connectedÅo %s/%s (%d)\n",

155 
__FUNCTION__
, 
uho°
, 
up‹t
, 
	`sockë_gë_fd
(
_as_simuœt‹_ue_sid
));

160 
_as_simuœt‹_mme_sid
 = 
	`sockë_udp_›í
(
SOCKET_CLIENT
, 
mho°
, 
mp‹t
);

161 i‡(
_as_simuœt‹_mme_sid
 =
NULL
) {

162 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

163 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

164 
	`¥ötf
("ERROR\t: sockë_udp_›í(ËÁûed: %s\n", 
îr‹
);

165 
	`sockë_˛o£
(
_as_simuœt‹_ue_sid
);

166 
	`exô
(
EXIT_FAILURE
);

168 
	`¥ötf
("INFO\t: %s - The RRC Simulator isÇow connectedÅo %s/%s (%d)\n",

169 
__FUNCTION__
, 
mho°
, 
mp‹t
, 
	`sockë_gë_fd
(
_as_simuœt‹_mme_sid
));

171 
	`MSCGEN
("[MSC_NEW][%s][AS=%s]\n", 
	`gëTime
(), 
_as_id
);

176 (Ë
	`_£t_sig«l_h™dÀr
(
SIGINT
, 
_sig«l_h™dÀr
);

177 (Ë
	`_£t_sig«l_h™dÀr
(
SIGTERM
, 
_sig«l_h™dÀr
);

179 
±hªad_©å_t
 
©å
;

180 
	`±hªad_©å_öô
(&
©å
);

181 
	`±hªad_©å_£tsc›e
(&
©å
, 
PTHREAD_SCOPE_SYSTEM
);

182 
	`±hªad_©å_£tdëach°©e
(&
©å
, 
PTHREAD_CREATE_DETACHED
);

188 
±hªad_t
 
ue_mngr
;

189 i‡–
	`±hªad_¸óã
 (&
ue_mngr
, &
©å
, 
_as_simuœt‹_ue_mngr
, 
NULL
) != 0 )

191 
	`≥º‹
("ERROR\t: FailedÅo createÅhe UE managementÅhread\n");

192 
	`sockë_˛o£
(
_as_simuœt‹_ue_sid
);

193 
	`sockë_˛o£
(
_as_simuœt‹_mme_sid
);

194 
	`exô
(
EXIT_FAILURE
);

201 
±hªad_t
 
mme_mngr
;

202 i‡–
	`±hªad_¸óã
 (&
mme_mngr
, &
©å
, 
_as_simuœt‹_mme_mngr
, 
NULL
) != 0 )

204 
	`≥º‹
("ERROR\t: FailedÅo createÅhe MME managementÅhread\n");

205 
	`sockë_˛o£
(
_as_simuœt‹_ue_sid
);

206 
	`sockë_˛o£
(
_as_simuœt‹_mme_sid
);

207 
	`exô
(
EXIT_FAILURE
);

209 
	`±hªad_©å_de°roy
(&
©å
);

215 
	`pﬁl
(
NULL
, 0, 
SLEEP_TIMEOUT
);

216 
_as_simuœt‹_ue_is_ru¬ög
 && 
_as_simuœt‹_mme_is_ru¬ög
)

218 
	`pﬁl
(
NULL
, 0, 
SLEEP_TIMEOUT
);

224 
	`¥ötf
("INFO\t: %s - Closing UE's connectionÉndpoint %d\n",

225 
__FUNCTION__
, 
	`sockë_gë_fd
(
_as_simuœt‹_ue_sid
));

226 
	`sockë_˛o£
(
_as_simuœt‹_ue_sid
);

227 
	`¥ötf
("INFO\t: %s - Closing MME's connectionÉndpoint %d\n",

228 
__FUNCTION__
, 
	`sockë_gë_fd
(
_as_simuœt‹_mme_sid
));

229 
	`sockë_˛o£
(
_as_simuœt‹_mme_sid
);

231 
	`¥ötf
("INFO\t: %†- RRC simuœt‹Éxôed\n", 
__FUNCTION__
);

232 
	`exô
(
EXIT_SUCCESS
);

233 
	}
}

244 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)())

246 
siga˘i⁄
 
a˘
;

249 (Ë
	`mem£t
 (&
a˘
, 0,  (act));

250 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

251 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

252 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

253 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

254 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

255 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

256 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

257 #i‚de‡
LINUX


258 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

260 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

261 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

262 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

263 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

266 
a˘
.
ß_h™dÀr
 = 
h™dÀr
;

267 i‡–
	`siga˘i⁄
 (
sig«l
, &
a˘
, 0) < 0 ) {

268  
RETURNîr‹
;

271  
RETURNok
;

272 
	}
}

279 
	$_sig«l_h™dÀr
(
sig«l_numbî
)

281 
	`¥ötf
("\nWARNING\t: %†- Sig«»%dÑe˚ived\n", 
__FUNCTION__
,

282 
sig«l_numbî
);

283 
_as_simuœt‹_ue_is_ru¬ög
 = 
FALSE
;

284 
_as_simuœt‹_mme_is_ru¬ög
 = 
FALSE
;

285 
	}
}

292 * 
	$_as_simuœt‹_ue_mngr
(* 
¨gs
)

294 
msg_id
;

295 
as_mesßge_t
 
msg
;

297 
_as_simuœt‹_ue_is_ru¬ög
 = 
TRUE
;

299 
	`¥ötf
("INFO\t: %†- UE c⁄√˘i⁄ m™agî sèπed\n", 
__FUNCTION__
);

301 
	`MSCGEN
("[MSC_NEW][%s][NAS-UE=%s]\n", 
	`gëTime
(), 
_ue_id
);

304 
_as_simuœt‹_ue_is_ru¬ög
)

306 
rc
, 
rbyãs
, 
sbyãs
;

309 
rbyãs
 = 
	`sockë_ªcv
(
_as_simuœt‹_ue_sid
, 
_as_simuœt‹_ue_buf„r
,

310 
AS_SIMULATOR_UE_BUFFER_SIZE
);

311 i‡(
rbyãs
 =
RETURNîr‹
) {

312 
	`≥º‹
("ERROR\t: socket_recv() failed");

317 
msg_id
 = 
	`as_mesßge_decode
(
_as_simuœt‹_ue_buf„r
, &
msg
, 
rbyãs
);

318 i‡(
msg_id
 =
RETURNîr‹
) {

319 
	`¥ötf
("WARNING\t: %s - FailedÅo decode AS message\n",

320 
__FUNCTION__
);

325 
_as_simuœt‹_ue_size
 = 0;

326 
_as_simuœt‹_mme_size
 = 0;

329 
rc
 = 
	`_as_simuœt‹_ue_¥o˚ss
(
msg_id
, &
msg
);

330 i‡(
rc
 !
RETURNok
) {

331 
	`¥ötf
("WARNING\t: %s - FailedÅoÖrocess AS message (0x%x)\n",

332 
__FUNCTION__
, 
msg_id
);

336 i‡(
_as_simuœt‹_ue_size
 > 0) {

338 
sbyãs
 = 
	`sockë_£nd
(
_as_simuœt‹_ue_sid
,

339 
_as_simuœt‹_ue_buf„r
,

340 
_as_simuœt‹_ue_size
);

341 i‡(
sbyãs
 =
RETURNîr‹
) {

342 
	`≥º‹
("ERROR\t: socket_send() failed");

347 i‡(
_as_simuœt‹_mme_size
 > 0) {

349 
sbyãs
 = 
	`sockë_£nd
(
_as_simuœt‹_mme_sid
,

350 
_as_simuœt‹_mme_buf„r
,

351 
_as_simuœt‹_mme_size
);

352 i‡(
sbyãs
 =
RETURNîr‹
) {

353 
	`≥º‹
("ERROR\t: socket_send() failed");

360 
_as_simuœt‹_ue_is_ru¬ög
 = 
FALSE
;

361 
	`¥ötf
("ERROR\t: The UE connection managerÉxited\n");

362  (
NULL
);

363 
	}
}

370 * 
	$_as_simuœt‹_mme_mngr
(* 
¨gs
)

372 
msg_id
;

373 
as_mesßge_t
 
msg
;

375 
_as_simuœt‹_mme_is_ru¬ög
 = 
TRUE
;

377 
	`¥ötf
("INFO\t: %†- MME c⁄√˘i⁄ m™agî sèπed\n", 
__FUNCTION__
);

379 
	`MSCGEN
("[MSC_NEW][%s][NAS-MME=%s]\n", 
	`gëTime
(), 
_mme_id
);

382 
_as_simuœt‹_mme_is_ru¬ög
)

384 
rc
, 
rbyãs
, 
sbyãs
;

387 
rbyãs
 = 
	`sockë_ªcv
(
_as_simuœt‹_mme_sid
, 
_as_simuœt‹_mme_buf„r
,

388 
AS_SIMULATOR_MME_BUFFER_SIZE
);

389 i‡(
rbyãs
 =
RETURNîr‹
) {

390 
	`≥º‹
("ERROR\t: socket_recv() failed");

395 
msg_id
 = 
	`as_mesßge_decode
(
_as_simuœt‹_mme_buf„r
, &
msg
, 
rbyãs
);

396 i‡(
msg_id
 =
RETURNîr‹
) {

397 
	`¥ötf
("ERROR\t: %†-ás_mesßge_decode(ËÁûed\n", 
__FUNCTION__
);

402 
_as_simuœt‹_ue_size
 = 0;

403 
_as_simuœt‹_mme_size
 = 0;

406 
rc
 = 
	`_as_simuœt‹_mme_¥o˚ss
(
msg_id
, &
msg
);

407 i‡(
rc
 !
RETURNok
) {

408 
	`¥ötf
("WARNING\t: %s - FailedÅoÖrocess AS message (0x%x)\n",

409 
__FUNCTION__
, 
msg_id
);

413 i‡(
_as_simuœt‹_mme_size
 > 0) {

415 
sbyãs
 = 
	`sockë_£nd
(
_as_simuœt‹_mme_sid
,

416 
_as_simuœt‹_mme_buf„r
,

417 
_as_simuœt‹_mme_size
);

418 i‡(
sbyãs
 =
RETURNîr‹
) {

419 
	`≥º‹
("ERROR\t: socket_send() failed");

424 i‡(
_as_simuœt‹_ue_size
 > 0) {

426 
sbyãs
 = 
	`sockë_£nd
(
_as_simuœt‹_ue_sid
,

427 
_as_simuœt‹_ue_buf„r
,

428 
_as_simuœt‹_ue_size
);

429 i‡(
sbyãs
 =
RETURNîr‹
) {

430 
	`≥º‹
("ERROR\t: socket_send() failed");

437 
_as_simuœt‹_mme_is_ru¬ög
 = 
FALSE
;

438 
	`¥ötf
("ERROR\t: %†- ThêMME c⁄√˘i⁄ m™agîÉxôed\n", 
__FUNCTION__
);

439  (
NULL
);

440 
	}
}

447 
	$_as_simuœt‹_ue_¥o˚ss
(
msg_id
, 
as_mesßge_t
* 
msg
)

449 
rc
 = 
RETURNok
;

451 
as_mesßge_t
 
˙f
;

452 
as_mesßge_t
 
öd
;

454 
	`¥ötf
("\nINFO\t: %s - Received AS message 0x%x from UE NASÖrocess\n",

455 
__FUNCTION__
, 
msg_id
);

457 
_as_simuœt‹_ue_å™s„r
 = 
AS_SIMULATOR_NO_TRANSFER
;

459 
	`mem£t
(&
˙f
, 0, (
as_mesßge_t
));

460 
	`mem£t
(&
öd
, 0, (
as_mesßge_t
));

462 
msg_id
)

464 
AS_CELL_INFO_REQ
:

465 
˙f
.
msgID
 = 
	`¥o˚ss_˚Œ_öfo_ªq
(
msg_id
,

466 &
msg
->msg.
˚Œ_öfo_ªq
,

467 &
˙f
.
msg
.
˚Œ_öfo_˙f
);

469 
_as_simuœt‹_ue_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

472 
AS_NAS_ESTABLISH_REQ
:

473 
öd
.
msgID
 = 
	`¥o˚ss_«s_e°ablish_ªq
(
msg_id
,

474 &
msg
->msg.
«s_e°ablish_ªq
,

475 &
öd
.
msg
.
«s_e°ablish_öd
,

476 &
˙f
.
msg
.
«s_e°ablish_˙f
);

477 i‡(
öd
.
msgID
) {

479 
_as_simuœt‹_ue_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_MME
;

482 
˙f
.
msgID
 = 
AS_NAS_ESTABLISH_CNF
;

483 
_as_simuœt‹_ue_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

486 
AS_UL_INFO_TRANSFER_REQ
:

487 
öd
.
msgID
 = 
	`¥o˚ss_ul_öfo_å™s„r_ªq
(
msg_id
,

488 &
msg
->msg.
ul_öfo_å™s„r_ªq
,

489 &
öd
.
msg
.
ul_öfo_å™s„r_öd
,

490 &
˙f
.
msg
.
ul_öfo_å™s„r_˙f
);

491 i‡(
öd
.
msgID
) {

493 
_as_simuœt‹_ue_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_MME
;

496 
˙f
.
msgID
 = 
AS_UL_INFO_TRANSFER_CNF
;

497 
_as_simuœt‹_ue_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

500 
AS_NAS_RELEASE_REQ
:

501 
öd
.
msgID
 = 
	`¥o˚ss_«s_ªÀa£_ªq
(
msg_id
,

502 &
msg
->msg.
«s_ªÀa£_ªq
);

506 
	`¥ötf
("WARNING\t: %s - AS message isÇot valid (0x%x)\n",

507 
__FUNCTION__
, 
msg_id
);

508 
rc
 = 
RETURNîr‹
;

512 i‡(
_as_simuœt‹_ue_å™s„r
 & 
AS_SIMULATOR_TRANSFER_TO_UE
) {

515 
_as_simuœt‹_ue_size
 = 
	`as_mesßge_ícode
(
_as_simuœt‹_ue_buf„r
, &
˙f
,

516 
AS_SIMULATOR_UE_BUFFER_SIZE
);

517 i‡(
_as_simuœt‹_ue_size
 =
RETURNîr‹
) {

518 
_as_simuœt‹_ue_size
 = 0;

519 
rc
 = 
RETURNîr‹
;

523 i‡(
_as_simuœt‹_ue_å™s„r
 & 
AS_SIMULATOR_TRANSFER_TO_MME
) {

526 
_as_simuœt‹_mme_size
 = 
	`as_mesßge_ícode
(
_as_simuœt‹_mme_buf„r
, &
öd
,

527 
AS_SIMULATOR_MME_BUFFER_SIZE
);

528 i‡(
_as_simuœt‹_mme_size
 =
RETURNîr‹
) {

529 
_as_simuœt‹_mme_size
 = 0;

530 
rc
 = 
RETURNîr‹
;

534  (
rc
);

535 
	}
}

542 
	$_as_simuœt‹_mme_¥o˚ss
(
msg_id
, 
as_mesßge_t
* 
msg
)

544 
rc
 = 
RETURNok
;

546 
as_mesßge_t
 
˙f
;

547 
as_mesßge_t
 
öd
;

549 
	`¥ötf
("\nINFO\t: %s - Received AS message 0x%x from MME NASÖrocess\n",

550 
__FUNCTION__
, 
msg_id
);

552 
_as_simuœt‹_mme_å™s„r
 = 
AS_SIMULATOR_NO_TRANSFER
;

554 
	`mem£t
(&
˙f
, 0, (
as_mesßge_t
));

555 
	`mem£t
(&
öd
, 0, (
as_mesßge_t
));

557 
msg_id
)

559 
AS_NAS_ESTABLISH_RSP
:

560 
˙f
.
msgID
 = 
	`¥o˚ss_«s_e°ablish_r•
(
msg_id
,

561 &
msg
->msg.
«s_e°ablish_r•
,

562 &
˙f
.
msg
.
«s_e°ablish_˙f
);

563 i‡(
˙f
.
msgID
) {

565 
_as_simuœt‹_mme_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

569 
AS_DL_INFO_TRANSFER_REQ
:

570 
öd
.
msgID
 = 
	`¥o˚ss_dl_öfo_å™s„r_ªq
(
msg_id
,

571 &
msg
->msg.
dl_öfo_å™s„r_ªq
,

572 &
öd
.
msg
.
dl_öfo_å™s„r_öd
,

573 &
˙f
.
msg
.
dl_öfo_å™s„r_˙f
);

574 i‡(
öd
.
msgID
) {

576 
_as_simuœt‹_mme_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

579 
˙f
.
msgID
 = 
AS_DL_INFO_TRANSFER_CNF
;

580 
_as_simuœt‹_mme_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_MME
;

583 
AS_NAS_RELEASE_REQ
:

584 
öd
.
msgID
 = 
	`¥o˚ss_«s_ªÀa£_öd
(
msg_id
,

585 &
msg
->msg.
«s_ªÀa£_ªq
,

586 &
öd
.
msg
.
«s_ªÀa£_öd
);

588 
_as_simuœt‹_mme_å™s„r
 |
AS_SIMULATOR_TRANSFER_TO_UE
;

592 
	`¥ötf
("WARNING\t: %s - AS message isÇot valid (0x%x)\n",

593 
__FUNCTION__
, 
msg_id
);

594 
rc
 = 
RETURNîr‹
;

598 i‡(
_as_simuœt‹_mme_å™s„r
 & 
AS_SIMULATOR_TRANSFER_TO_UE
) {

599 i‡(
öd
.
msgID
 > 0) {

602 
_as_simuœt‹_ue_size
 = 
	`as_mesßge_ícode
(
_as_simuœt‹_ue_buf„r
,

603 &
öd
, 
AS_SIMULATOR_UE_BUFFER_SIZE
);

605 i‡(
˙f
.
msgID
 > 0) {

608 
_as_simuœt‹_ue_size
 = 
	`as_mesßge_ícode
(
_as_simuœt‹_ue_buf„r
,

609 &
˙f
, 
AS_SIMULATOR_UE_BUFFER_SIZE
);

611 i‡(
_as_simuœt‹_ue_size
 =
RETURNîr‹
) {

612 
_as_simuœt‹_ue_size
 = 0;

613 
rc
 = 
RETURNîr‹
;

617 i‡(
_as_simuœt‹_mme_å™s„r
 & 
AS_SIMULATOR_TRANSFER_TO_MME
) {

620 
_as_simuœt‹_mme_size
 = 
	`as_mesßge_ícode
(
_as_simuœt‹_mme_buf„r
,

621 &
˙f
, 
AS_SIMULATOR_MME_BUFFER_SIZE
);

622 i‡(
_as_simuœt‹_mme_size
 =
RETURNîr‹
) {

623 
_as_simuœt‹_mme_size
 = 0;

624 
rc
 = 
RETURNîr‹
;

628  (
rc
);

629 
	}
}

	@tst/as_simulator/as_simulator_parser.c

21 
	~"as_simuœt‹_∑r£r.h
"

23 
	~"∑r£r.h
"

38 
	mAS_SIMULATOR_PARSER_UE_HOST
,

39 
	mAS_SIMULATOR_PARSER_UE_PORT
,

40 
	mAS_SIMULATOR_PARSER_MME_HOST
,

41 
	mAS_SIMULATOR_PARSER_MME_PORT
,

42 
	mAS_SIMULATOR_PARSER_NB_OPTIONS


54 
∑r£r_comm™d_löe_t
 
	gasP¨£rComm™dLöe
 = {

56 
AS_SIMULATOR_PARSER_NB_OPTIONS
,

59 
AS_SIMULATOR_PARSER_DEFAULT_UE_HOSTNAME
},

61 
AS_SIMULATOR_PARSER_DEFAULT_UE_PORT_NUMBER
},

63 
AS_SIMULATOR_PARSER_DEFAULT_MME_HOSTNAME
},

65 
AS_SIMULATOR_PARSER_DEFAULT_MME_PORT_NUMBER
},

87 
ölöe
 
	$as_simuœt‹_∑r£r_¥öt_ußge
()

89 
	`∑r£r_¥öt_ußge
(&
asP¨£rComm™dLöe
);

90 
	}
}

107 
ölöe
 
	$as_simuœt‹_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
)

109  
	`∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
, &
asP¨£rComm™dLöe
);

110 
	}
}

126 
ölöe
 
	$as_simuœt‹_∑r£r_gë_nb_›ti⁄s
()

128  
asP¨£rComm™dLöe
.
nb_›ti⁄s
;

129 
	}
}

144 
ölöe
 c⁄° * 
	$as_simuœt‹_∑r£r_gë_uho°
()

146  
asP¨£rComm™dLöe
.
›ti⁄s
[
AS_SIMULATOR_PARSER_UE_HOST
].
pvÆue
;

147 
	}
}

162 
ölöe
 c⁄° * 
	$as_simuœt‹_∑r£r_gë_up‹t
()

164  
asP¨£rComm™dLöe
.
›ti⁄s
[
AS_SIMULATOR_PARSER_UE_PORT
].
pvÆue
;

165 
	}
}

180 
ölöe
 c⁄° * 
	$as_simuœt‹_∑r£r_gë_mho°
()

182  
asP¨£rComm™dLöe
.
›ti⁄s
[
AS_SIMULATOR_PARSER_MME_HOST
].
pvÆue
;

183 
	}
}

198 
ölöe
 c⁄° * 
	$as_simuœt‹_∑r£r_gë_mp‹t
()

200  
asP¨£rComm™dLöe
.
›ti⁄s
[
AS_SIMULATOR_PARSER_MME_PORT
].
pvÆue
;

201 
	}
}

	@tst/as_simulator/as_simulator_parser.h

21 #i‚de‡
__AS_SIMULATOR_PARSER_H__


22 
	#__AS_SIMULATOR_PARSER_H__


	)

29 
	#AS_SIMULATOR_PARSER_DEFAULT_UE_HOSTNAME
 "loˇlho°"

	)

32 
	#AS_SIMULATOR_PARSER_DEFAULT_MME_HOSTNAME
 "loˇlho°"

	)

35 
	#AS_SIMULATOR_PARSER_DEFAULT_UE_PORT_NUMBER
 "12000"

	)

38 
	#AS_SIMULATOR_PARSER_DEFAULT_MME_PORT_NUMBER
 "14000"

	)

52 
as_simuœt‹_∑r£r_¥öt_ußge
();

53 
as_simuœt‹_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
);

55 
as_simuœt‹_∑r£r_gë_nb_›ti⁄s
();

56 c⁄° * 
as_simuœt‹_∑r£r_gë_uho°
();

57 c⁄° * 
as_simuœt‹_∑r£r_gë_up‹t
();

58 c⁄° * 
as_simuœt‹_∑r£r_gë_mho°
();

59 c⁄° * 
as_simuœt‹_∑r£r_gë_mp‹t
();

	@tst/as_simulator/nas_data.c

22 
	~"«s_d©a.h
"

24 
	~"emm_msgDef.h
"

25 
	~"esm_msgDef.h
"

27 
	~"emm_ˇu£.h
"

28 
	~"esm_ˇu£.h
"

30 
	~<°dio.h
>

40 
ssize_t
 
imsiIdítôy
(* 
buf„r
, 
size_t
 
Àn
,

41 c⁄° 
ImsiMobûeIdítôy_t
* 
idít
);

42 
ssize_t
 
imeiIdítôy
(* 
buf„r
, 
size_t
 
Àn
,

43 c⁄° 
ImeiMobûeIdítôy_t
* 
idít
);

44 
ssize_t
 
tmsiIdítôy
(* 
buf„r
, 
size_t
 
Àn
,

45 c⁄° 
TmsiMobûeIdítôy_t
* 
idít
);

46 
ssize_t
 
tmgiIdítôy
(* 
buf„r
, 
size_t
 
Àn
,

47 c⁄° 
TmgiMobûeIdítôy_t
* 
idít
);

49 c⁄° * 
timîUnô
(
unô
);

51 
ssize_t
 
ùv4Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
);

52 
ssize_t
 
ùv6Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
);

53 
ssize_t
 
ùv4v6Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
);

64 c⁄° * 
	$emmMsgTy≥
(
ty≥
)

66 i‡(
ty≥
 =
ATTACH_REQUEST
) {

68 } i‡(
ty≥
 =
ATTACH_ACCEPT
) {

70 } i‡(
ty≥
 =
ATTACH_COMPLETE
) {

72 } i‡(
ty≥
 =
ATTACH_REJECT
) {

74 } i‡(
ty≥
 =
DETACH_REQUEST
) {

76 } i‡(
ty≥
 =
DETACH_ACCEPT
) {

78 } i‡(
ty≥
 =
TRACKING_AREA_UPDATE_REQUEST
) {

80 } i‡(
ty≥
 =
TRACKING_AREA_UPDATE_ACCEPT
) {

82 } i‡(
ty≥
 =
TRACKING_AREA_UPDATE_COMPLETE
) {

84 } i‡(
ty≥
 =
TRACKING_AREA_UPDATE_REJECT
) {

86 } i‡(
ty≥
 =
EXTENDED_SERVICE_REQUEST
) {

88 } i‡(
ty≥
 =
SERVICE_REJECT
) {

90 } i‡(
ty≥
 =
GUTI_REALLOCATION_COMMAND
) {

92 } i‡(
ty≥
 =
GUTI_REALLOCATION_COMPLETE
) {

94 } i‡(
ty≥
 =
AUTHENTICATION_REQUEST
) {

96 } i‡(
ty≥
 =
AUTHENTICATION_RESPONSE
) {

98 } i‡(
ty≥
 =
AUTHENTICATION_REJECT
) {

100 } i‡(
ty≥
 =
AUTHENTICATION_FAILURE
) {

102 } i‡(
ty≥
 =
IDENTITY_REQUEST
) {

104 } i‡(
ty≥
 =
IDENTITY_RESPONSE
) {

106 } i‡(
ty≥
 =
SECURITY_MODE_COMMAND
) {

108 } i‡(
ty≥
 =
SECURITY_MODE_COMPLETE
) {

110 } i‡(
ty≥
 =
SECURITY_MODE_REJECT
) {

112 } i‡(
ty≥
 =
EMM_STATUS
) {

114 } i‡(
ty≥
 =
EMM_INFORMATION
) {

116 } i‡(
ty≥
 =
DOWNLINK_NAS_TRANSPORT
) {

118 } i‡(
ty≥
 =
UPLINK_NAS_TRANSPORT
) {

120 } i‡(
ty≥
 =
CS_SERVICE_NOTIFICATION
) {

122 } i‡(
ty≥
 =
SERVICE_REQUEST
) {

127 
	}
}

134 c⁄° * 
	$esmMsgTy≥
(
ty≥
)

136 i‡(
ty≥
 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
) {

138 } i‡(
ty≥
 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
) {

140 } i‡(
ty≥
 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
) {

142 } i‡(
ty≥
 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
) {

144 } i‡(
ty≥
 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
) {

146 } i‡(
ty≥
 =
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
) {

148 } i‡(
ty≥
 =
MODIFY_EPS_BEARER_CONTEXT_REQUEST
) {

150 } i‡(
ty≥
 =
MODIFY_EPS_BEARER_CONTEXT_ACCEPT
) {

152 } i‡(
ty≥
 =
MODIFY_EPS_BEARER_CONTEXT_REJECT
) {

154 } i‡(
ty≥
 =
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
) {

156 } i‡(
ty≥
 =
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
) {

158 } i‡(
ty≥
 =
PDN_CONNECTIVITY_REQUEST
) {

160 } i‡(
ty≥
 =
PDN_CONNECTIVITY_REJECT
) {

162 } i‡(
ty≥
 =
PDN_DISCONNECT_REQUEST
) {

164 } i‡(
ty≥
 =
PDN_DISCONNECT_REJECT
) {

166 } i‡(
ty≥
 =
BEARER_RESOURCE_ALLOCATION_REQUEST
) {

168 } i‡(
ty≥
 =
BEARER_RESOURCE_ALLOCATION_REJECT
) {

170 } i‡(
ty≥
 =
BEARER_RESOURCE_MODIFICATION_REQUEST
) {

172 } i‡(
ty≥
 =
BEARER_RESOURCE_MODIFICATION_REJECT
) {

174 } i‡(
ty≥
 =
ESM_INFORMATION_REQUEST
) {

176 } i‡(
ty≥
 =
ESM_INFORMATION_RESPONSE
) {

178 } i‡(
ty≥
 =
ESM_STATUS
) {

183 
	}
}

190 c⁄° * 
	$emmCau£Code
(
EmmCau£
 
code
)

192 i‡(
code
 =
EMM_CAUSE_SUCCESS
) {

194 } i‡(
code
 =
EMM_CAUSE_IMSI_UNKNOWN_IN_HSS
) {

196 } i‡(
code
 =
EMM_CAUSE_ILLEGAL_UE
) {

198 } i‡(
code
 =
EMM_CAUSE_ILLEGAL_ME
) {

200 } i‡(
code
 =
EMM_CAUSE_INVALID_UE
) {

202 } i‡(
code
 =
EMM_CAUSE_IMPLICITLY_DETACHED
) {

204 } i‡(
code
 =
EMM_CAUSE_IMEI_NOT_ACCEPTED
) {

206 } i‡(
code
 =
EMM_CAUSE_EPS_NOT_ALLOWED
) {

208 } i‡(
code
 =
EMM_CAUSE_BOTH_NOT_ALLOWED
) {

210 } i‡(
code
 =
EMM_CAUSE_PLMN_NOT_ALLOWED
) {

212 } i‡(
code
 =
EMM_CAUSE_TA_NOT_ALLOWED
) {

214 } i‡(
code
 =
EMM_CAUSE_ROAMING_NOT_ALLOWED
) {

216 } i‡(
code
 =
EMM_CAUSE_EPS_NOT_ALLOWED_IN_PLMN
) {

218 } i‡(
code
 =
EMM_CAUSE_NO_SUITABLE_CELLS
) {

220 } i‡(
code
 =
EMM_CAUSE_CSG_NOT_AUTHORIZED
) {

222 } i‡(
code
 =
EMM_CAUSE_NOT_AUTHORIZED_IN_PLMN
) {

224 } i‡(
code
 =
EMM_CAUSE_NO_EPS_BEARER_CTX_ACTIVE
) {

226 } i‡(
code
 =
EMM_CAUSE_MSC_NOT_REACHABLE
) {

228 } i‡(
code
 =
EMM_CAUSE_NETWORK_FAILURE
) {

230 } i‡(
code
 =
EMM_CAUSE_CS_DOMAIN_NOT_AVAILABLE
) {

232 } i‡(
code
 =
EMM_CAUSE_ESM_FAILURE
) {

234 } i‡(
code
 =
EMM_CAUSE_MAC_FAILURE
) {

236 } i‡(
code
 =
EMM_CAUSE_SYNCH_FAILURE
) {

238 } i‡(
code
 =
EMM_CAUSE_CONGESTION
) {

240 } i‡(
code
 =
EMM_CAUSE_UE_SECURITY_MISMATCH
) {

242 } i‡(
code
 =
EMM_CAUSE_SECURITY_MODE_REJECTED
) {

244 } i‡(
code
 =
EMM_CAUSE_NON_EPS_AUTH_UNACCEPTABLE
) {

246 } i‡(
code
 =
EMM_CAUSE_CS_SERVICE_NOT_AVAILABLE
) {

248 } i‡(
code
 =
EMM_CAUSE_SEMANTICALLY_INCORRECT
) {

250 } i‡(
code
 =
EMM_CAUSE_INVALID_MANDATORY_INFO
) {

252 } i‡(
code
 =
EMM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
) {

254 } i‡(
code
 =
EMM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
) {

256 } i‡(
code
 =
EMM_CAUSE_IE_NOT_IMPLEMENTED
) {

258 } i‡(
code
 =
EMM_CAUSE_CONDITIONAL_IE_ERROR
) {

260 } i‡(
code
 =
EMM_CAUSE_MESSAGE_NOT_COMPATIBLE
) {

262 } i‡(
code
 =
EMM_CAUSE_PROTOCOL_ERROR
) {

267 
	}
}

274 c⁄° * 
	$esmCau£Code
(
EsmCau£
 
code
)

276 i‡(
code
 =
ESM_CAUSE_SUCCESS
) {

278 } i‡(
code
 =
ESM_CAUSE_OPERATOR_DETERMINED_BARRING
) {

280 } i‡(
code
 =
ESM_CAUSE_INSUFFICIENT_RESOURCES
) {

282 } i‡(
code
 =
ESM_CAUSE_UNKNOWN_ACCESS_POINT_NAME
) {

284 } i‡(
code
 =
ESM_CAUSE_UNKNOWN_PDN_TYPE
) {

286 } i‡(
code
 =
ESM_CAUSE_USER_AUTHENTICATION_FAILED
) {

288 } i‡(
code
 =
ESM_CAUSE_REQUEST_REJECTED_BY_GW
) {

290 } i‡(
code
 =
ESM_CAUSE_REQUEST_REJECTED_UNSPECIFIED
) {

292 } i‡(
code
 =
ESM_CAUSE_SERVICE_OPTION_NOT_SUPPORTED
) {

294 } i‡(
code
 =
ESM_CAUSE_REQUESTED_SERVICE_OPTION_NOT_SUBSCRIBED
) {

296 } i‡(
code
 =
ESM_CAUSE_SERVICE_OPTION_TEMPORARILY_OUT_OF_ORDER
) {

298 } i‡(
code
 =
ESM_CAUSE_PTI_ALREADY_IN_USE
) {

300 } i‡(
code
 =
ESM_CAUSE_REGULAR_DEACTIVATION
) {

302 } i‡(
code
 =
ESM_CAUSE_EPS_QOS_NOT_ACCEPTED
) {

304 } i‡(
code
 =
ESM_CAUSE_NETWORK_FAILURE
) {

306 } i‡(
code
 =
ESM_CAUSE_REACTIVATION_REQUESTED
) {

308 } i‡(
code
 =
ESM_CAUSE_SEMANTIC_ERROR_IN_THE_TFT_OPERATION
) {

310 } i‡(
code
 =
ESM_CAUSE_SYNTACTICAL_ERROR_IN_THE_TFT_OPERATION
) {

312 } i‡(
code
 =
ESM_CAUSE_INVALID_EPS_BEARER_IDENTITY
) {

314 } i‡(
code
 =
ESM_CAUSE_SEMANTIC_ERRORS_IN_PACKET_FILTER
) {

316 } i‡(
code
 =
ESM_CAUSE_SYNTACTICAL_ERROR_IN_PACKET_FILTER
) {

318 } i‡(
code
 =
ESM_CAUSE_PTI_MISMATCH
) {

320 } i‡(
code
 =
ESM_CAUSE_LAST_PDN_DISCONNECTION_NOT_ALLOWED
) {

322 } i‡(
code
 =
ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
) {

324 } i‡(
code
 =
ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
) {

326 } i‡(
code
 =
ESM_CAUSE_SINGLE_ADDRESS_BEARERS_ONLY_ALLOWED
) {

328 } i‡(
code
 =
ESM_CAUSE_ESM_INFORMATION_NOT_RECEIVED
) {

330 } i‡(
code
 =
ESM_CAUSE_PDN_CONNECTION_DOES_NOT_EXIST
) {

332 } i‡(
code
 =
ESM_CAUSE_MULTIPLE_PDN_CONNECTIONS_NOT_ALLOWED
) {

334 } i‡(
code
 =
ESM_CAUSE_COLLISION_WITH_NETWORK_INITIATED_REQUEST
) {

336 } i‡(
code
 =
ESM_CAUSE_UNSUPPORTED_QCI_VALUE
) {

338 } i‡(
code
 =
ESM_CAUSE_BEARER_HANDLING_NOT_SUPPORTED
) {

340 } i‡(
code
 =
ESM_CAUSE_INVALID_PTI_VALUE
) {

342 } i‡(
code
 =
ESM_CAUSE_APN_RESTRICTION_VALUE_NOT_COMPATIBLE
) {

344 } i‡(
code
 =
ESM_CAUSE_SEMANTICALLY_INCORRECT
) {

346 } i‡(
code
 =
ESM_CAUSE_INVALID_MANDATORY_INFO
) {

348 } i‡(
code
 =
ESM_CAUSE_MESSAGE_TYPE_NOT_IMPLEMENTED
) {

350 } i‡(
code
 =
ESM_CAUSE_MESSAGE_TYPE_NOT_COMPATIBLE
) {

352 } i‡(
code
 =
ESM_CAUSE_IE_NOT_IMPLEMENTED
) {

354 } i‡(
code
 =
ESM_CAUSE_CONDITIONAL_IE_ERROR
) {

356 } i‡(
code
 =
ESM_CAUSE_MESSAGE_NOT_COMPATIBLE
) {

358 } i‡(
code
 =
ESM_CAUSE_PROTOCOL_ERROR
) {

363 
	}
}

370 c⁄° * 
	$©èchTy≥
(c⁄° 
EpsAâachTy≥
* 
ty≥
)

372 i‡(*
ty≥
 =
EPS_ATTACH_TYPE_EPS
) {

374 } i‡(*
ty≥
 =
EPS_ATTACH_TYPE_IMSI
) {

376 } i‡(*
ty≥
 =
EPS_ATTACH_TYPE_EMERGENCY
) {

378 } i‡(*
ty≥
 =
EPS_ATTACH_TYPE_RESERVED
) {

383 
	}
}

390 c⁄° * 
	$dëachTy≥
(c⁄° 
DëachTy≥
* 
ty≥
)

392 i‡(
ty≥
->
swôchoff
 =
DETACH_TYPE_NORMAL_DETACH
)

394 i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_EPS
) {

396 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_IMSI
) {

398 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_EPS_IMSI
) {

400 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_1
) {

402 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_2
) {

408 i‡(
ty≥
->
swôchoff
 =
DETACH_TYPE_SWITCH_OFF
)

410 i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_EPS
) {

412 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_IMSI
) {

414 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_EPS_IMSI
) {

416 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_1
) {

418 } i‡(
ty≥
->
ty≥ofdëach
 =
DETACH_TYPE_RESERVED_2
) {

426 
	}
}

433 
ssize_t
 
	$ïsIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
EpsMobûeIdítôy
* 
idít
)

435 
ödex
 = 0;

437 i‡(
idít
->
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

438 
ödex
 +
	`imsiIdítôy
(
buf„r
 + index, 
Àn
 - index,

439 (
ImsiMobûeIdítôy_t
*)(&
idít
->
imsi
));

441 i‡(
idít
->
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
) {

442 
ödex
 +
	`imeiIdítôy
(
buf„r
 + index, 
Àn
 - index,

443 (
ImeiMobûeIdítôy_t
*)(&
idít
->
imei
));

445 i‡(
idít
->
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) {

446 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "GUTI = {");

447 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

449 
idít
->
guti
.
mccdigô1
, idít->guti.
mccdigô2
,

450 
idít
->
guti
.
mccdigô3
, idít->guti.
mncdigô1
,

451 
idít
->
guti
.
mncdigô2
);

452 i‡(
idít
->
guti
.
mncdigô3
 != 0xf) {

453 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%u",

454 
idít
->
guti
.
mncdigô3
);

456 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

458 
idít
->
guti
.
mmegroupid
, idít->guti.
mmecode
,

459 
idít
->
guti
.
mtmsi
);

462  (
ödex
);

463 
	}
}

470 
ssize_t
 
	$mobûeIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
MobûeIdítôy
* 
idít
)

472 
ödex
 = 0;

474 i‡(
idít
->
imsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMSI
) {

475 
ödex
 +
	`imsiIdítôy
(
buf„r
 + index, 
Àn
 - index, &
idít
->
imsi
);

476 } i‡(
idít
->
imei
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_IMEI
) {

477 
ödex
 +
	`imeiIdítôy
(
buf„r
 + index, 
Àn
 - index, &
idít
->
imei
);

478 } i‡(
idít
->
tmsi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMSI
) {

479 
ödex
 +
	`tmsiIdítôy
(
buf„r
 + index, 
Àn
 - index, &
idít
->
tmsi
);

480 } i‡(
idít
->
tmgi
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_TMGI
) {

481 
ödex
 +
	`tmgiIdítôy
(
buf„r
 + index, 
Àn
 - index, &
idít
->
tmgi
);

482 } i‡(
idít
->
no_id
.
ty≥ofidítôy
 =
MOBILE_IDENTITY_NOT_AVAILABLE
) {

483 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "NOT AVAILABLE");

486  (
ödex
);

487 
	}
}

494 c⁄° * 
	$idítôyTy≥
(c⁄° 
IdítôyTy≥2
* 
ty≥
)

496 i‡(*
ty≥
 =
IDENTITY_TYPE_2_IMSI
) {

498 } i‡(*
ty≥
 =
IDENTITY_TYPE_2_IMEI
) {

500 } i‡(*
ty≥
 =
IDENTITY_TYPE_2_IMEISV
) {

502 } i‡(*
ty≥
 =
IDENTITY_TYPE_2_TMSI
) {

507 
	}
}

514 c⁄° * 
	$ªque°Ty≥
(c⁄° 
Reque°Ty≥
* 
ty≥
)

516 i‡(*
ty≥
 =
REQUEST_TYPE_INITIAL_REQUEST
) {

518 } i‡(*
ty≥
 =
REQUEST_TYPE_HANDOVER
) {

520 } i‡(*
ty≥
 =
REQUEST_TYPE_UNUSED
) {

522 } i‡(*
ty≥
 =
REQUEST_TYPE_EMERGENCY
) {

527 
	}
}

534 c⁄° * 
	$pdnTy≥
(c⁄° 
PdnTy≥
* 
ty≥
)

536 i‡(*
ty≥
 =
PDN_TYPE_IPV4
) {

538 } i‡(*
ty≥
 =
PDN_TYPE_IPV6
) {

540 } i‡(*
ty≥
 =
PDN_TYPE_IPV4V6
) {

542 } i‡(*
ty≥
 =
PDN_TYPE_UNUSED
) {

547 
	}
}

554 
ssize_t
 
	$pdnAddªss
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
PdnAddªss
* 
addr
)

556 
ödex
 = 0;

558 
addr
->
pd¡y≥vÆue
)

560 
PDN_VALUE_TYPE_IPV4
:

562 
ödex
 +
	`ùv4Addr
(
buf„r
 + index, 
Àn
 - index,

563 &
addr
->
pd«ddªssöf‹m©i⁄
);

566 
PDN_VALUE_TYPE_IPV6
:

568 
ödex
 +
	`ùv6Addr
(
buf„r
 + index, 
Àn
 - index,

569 &
addr
->
pd«ddªssöf‹m©i⁄
);

572 
PDN_VALUE_TYPE_IPV4V6
:

574 
ödex
 +
	`ùv4v6Addr
(
buf„r
 + index, 
Àn
 - index,

575 &
addr
->
pd«ddªssöf‹m©i⁄
);

579 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "Unknown");

583  (
ödex
);

584 
	}
}

591 
ssize_t
 
	$«sKeySëIdítifõr
(* 
buf„r
, 
size_t
 
Àn
,

592 c⁄° 
NasKeySëIdítifõr
* 
ksi
)

594 
ödex
 = 0;

596 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "{%s: %d}",

597 (
ksi
->
tsc
 =
NAS_KEY_SET_IDENTIFIER_NATIVE
)? "NATIVE" :

598 (
ksi
->
tsc
 =
NAS_KEY_SET_IDENTIFIER_MAPPED
)? "MAPPED" :

599 "Unknown", 
ksi
->
«skey£tidítifõr
);

601  (
ödex
);

602 
	}
}

609 
ssize_t
 
	$authítiˇti⁄P¨amëî
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
∑øm
)

611 
ödex
 = 0;

613 
i
 = 0; i < 
∑øm
->
Àngth
; i++) {

614 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%.2hx",

615 ()(
∑øm
->
vÆue
[
i
]));

618  (
ödex
);

619 
	}
}

626 c⁄° * 
	$«sCùhîögAlg‹ôhm
(c⁄° 
NasSecurôyAlg‹ôhms
* 
Ægo
)

628 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA0
) {

631 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA1
) {

634 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA2
) {

637 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA3
) {

640 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA4
) {

643 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA5
) {

646 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA6
) {

649 i‡(
Ægo
->
ty≥ofcùhîögÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EEA7
) {

654 
	}
}

661 c⁄° * 
	$«sI¡egrôyAlg‹ôhm
(c⁄° 
NasSecurôyAlg‹ôhms
* 
Ægo
)

663 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA0
) {

666 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA1
) {

669 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA2
) {

672 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA3
) {

675 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA4
) {

678 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA5
) {

681 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA6
) {

684 i‡(
Ægo
->
ty≥oföãgrôyÆg‹ôhm
 =
NAS_SECURITY_ALGORITHMS_EIA7
) {

689 
	}
}

696 
ssize_t
 
	$g¥sTimî
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
G¥sTimî
* 
timî
)

698 
ödex
 = 0;

700 i‡(
timî
->
unô
 !
GPRS_TIMER_UNIT_0S
) {

701 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

703 
	`timîUnô
(
timî
->
unô
),Åimî->
timîvÆue
);

705 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "{Deactivated}");

708  (
ödex
);

709 
	}
}

716 
ssize_t
 
	$èiLi°
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
TøckögAªaIdítôyLi°
* 
èi
)

718 
ödex
 = 0;

720 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "TAI = {%s",

721 (
èi
->
ty≥oÊi°
 =
TRACKING_AREA_IDENTITY_LIST_ONE_PLMN_CONSECUTIVE_TACS
)?

724 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

726 
èi
->
mccdigô1
,Åai->
mccdigô2
,

727 
èi
->
mccdigô3
,Åai->
mncdigô1
,

728 
èi
->
mncdigô2
);

729 i‡(
èi
->
mncdigô3
 != 0xf) {

730 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%u",

731 
èi
->
mncdigô3
);

734 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

738 
èi
->
numbîo„Àmíts
 + 1,

739 
èi
->
èc
);

741 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "}");

743  (
ödex
);

744 
	}
}

755 
ssize_t
 
	$imsiIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
ImsiMobûeIdítôy_t
* 
imsi
)

757 
ödex
 = 0;

759 i‡(
imsi
->
oddeví
 !
MOBILE_IDENTITY_EVEN
) {

760 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

762 
imsi
->
digô1
, imsi->
digô2
, imsi->
digô3
, imsi->
digô4
,

763 
imsi
->
digô5
, imsi->
digô6
, imsi->
digô7
, imsi->
digô8
,

764 
imsi
->
digô9
, imsi->
digô10
, imsi->
digô11
, imsi->
digô12
,

765 
imsi
->
digô13
, imsi->
digô14
);

767 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

769 
imsi
->
digô1
, imsi->
digô2
, imsi->
digô3
, imsi->
digô4
,

770 
imsi
->
digô5
, imsi->
digô7
, imsi->
digô8
, imsi->
digô9
,

771 
imsi
->
digô10
, imsi->
digô11
, imsi->
digô12
,

772 
imsi
->
digô13
, imsi->
digô14
);

774 i‡(
imsi
->
digô15
 != 0xf) {

775 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%u", 
imsi
->
digô15
);

778  (
ödex
);

779 
	}
}

786 
ssize_t
 
	$imeiIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
ImeiMobûeIdítôy_t
* 
imei
)

788 
ödex
 = 0;

790 i‡(
imei
->
oddeví
 !
MOBILE_IDENTITY_EVEN
) {

791 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

793 
imei
->
digô1
, imei->
digô2
, imei->
digô3
, imei->
digô4
,

794 
imei
->
digô5
, imei->
digô6
, imei->
digô7
, imei->
digô8
,

795 
imei
->
digô9
, imei->
digô10
, imei->
digô11
, imei->
digô12
,

796 
imei
->
digô13
, imei->
digô14
, imei->
digô15
);

798 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

800 
imei
->
digô1
, imei->
digô2
, imei->
digô3
, imei->
digô4
,

801 
imei
->
digô5
, imei->
digô6
, imei->
digô7
, imei->
digô8
,

802 
imei
->
digô9
, imei->
digô10
, imei->
digô11
, imei->
digô12
,

803 
imei
->
digô13
, imei->
digô14
);

806  (
ödex
);

807 
	}
}

814 
ssize_t
 
	$tmsiIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
TmsiMobûeIdítôy_t
* 
tmsi
)

816 
ödex
 = 0;

818 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index,

820 
tmsi
->
digô2
,Åmsi->
digô3
,Åmsi->
digô4
,

821 
tmsi
->
digô5
,Åmsi->
digô6
,Åmsi->
digô7
,Åmsi->
digô8
,

822 
tmsi
->
digô9
,Åmsi->
digô10
,Åmsi->
digô11
,Åmsi->
digô12
,

823 
tmsi
->
digô13
,Åmsi->
digô14
,Åmsi->
digô15
);

825  (
ödex
);

826 
	}
}

833 
ssize_t
 
	$tmgiIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
TmgiMobûeIdítôy_t
* 
tmgi
)

835 
ödex
 = 0;

837 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "TMGI = {");

838 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "MBMS service ID = %u",

839 
tmgi
->
mbms£rvi˚id
);

840 i‡(
tmgi
->
mccmncödiˇti⁄
) {

841 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, ", MCC = %u%u%u",

842 
tmgi
->
mccdigô1
,Åmgi->
mccdigô2
,Åmgi->
mccdigô3
);

843 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, ", MNC = %u%u",

844 
tmgi
->
mncdigô1
,Åmgi->
mncdigô2
);

845 i‡(
tmgi
->
mncdigô3
 != 0xf) {

846 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "%u",

847 
tmgi
->
mncdigô3
);

850 i‡(
tmgi
->
mbms£ssi⁄idödiˇti⁄
) {

851 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, ", MBMS session ID = %u",

852 
tmgi
->
mbms£ssi⁄id
);

854 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àn
 - index, "}");

856  (
ödex
);

857 
	}
}

864 c⁄° * 
	$timîUnô
(
unô
)

866 i‡(
unô
 =
GPRS_TIMER_UNIT_2S
) {

868 } i‡(
unô
 =
GPRS_TIMER_UNIT_60S
) {

870 } i‡(
unô
 =
GPRS_TIMER_UNIT_360S
) {

872 } i‡(
unô
 =
GPRS_TIMER_UNIT_0S
) {

877 
	}
}

884 
ssize_t
 
	$ùv4Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
)

886  
	`¢¥ötf
(
buf„r
, 
Àn
, "%u.%u.%u.%u",

887 
addr
->
vÆue
[0],áddr->value[1],

888 
addr
->
vÆue
[2],áddr->value[3]);

889 
	}
}

896 
ssize_t
 
	$ùv6Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
)

898  
	`¢¥ötf
(
buf„r
, 
Àn
, "%x%.2x:%x%.2x:%x%.2x:%x%.2x",

899 
addr
->
vÆue
[0],áddr->value[1],

900 
addr
->
vÆue
[2],áddr->value[3],

901 
addr
->
vÆue
[4],áddr->value[5],

902 
addr
->
vÆue
[6],áddr->value[7]);

903 
	}
}

910 
ssize_t
 
	$ùv4v6Addr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
addr
)

912  
	`¢¥ötf
(
buf„r
, 
Àn
, "%u.%u.%u.%u / %x%.2x:%x%.2x:%x%.2x:%x%.2x",

913 
addr
->
vÆue
[0],áddr->value[1],

914 
addr
->
vÆue
[2],áddr->value[3],

915 
addr
->
vÆue
[4],áddr->value[5],

916 
addr
->
vÆue
[6],áddr->value[7],

917 
addr
->
vÆue
[8],áddr->value[9],

918 
addr
->
vÆue
[10],áddr->value[11]);

919 
	}
}

	@tst/as_simulator/nas_data.h

22 #i‚de‡
__NAS_DATA_H__


23 
	#__NAS_DATA_H__


	)

25 
	~"EpsAâachTy≥.h
"

26 
	~"DëachTy≥.h
"

27 
	~"NasKeySëIdítifõr.h
"

28 
	~"EpsMobûeIdítôy.h
"

29 
	~"MobûeIdítôy.h
"

30 
	~"IdítôyTy≥2.h
"

31 
	~"NasReque°Ty≥.h
"

32 
	~"PdnTy≥.h
"

33 
	~"PdnAddªss.h
"

34 
	~"NasSecurôyAlg‹ôhms.h
"

35 
	~"G¥sTimî.h
"

36 
	~"TøckögAªaIdítôyLi°.h
"

37 
	~"EmmCau£.h
"

38 
	~"EsmCau£.h
"

56 c⁄° * 
emmMsgTy≥
(
ty≥
);

57 c⁄° * 
esmMsgTy≥
(
ty≥
);

59 c⁄° * 
emmCau£Code
(
EmmCau£
 
code
);

60 c⁄° * 
esmCau£Code
(
EsmCau£
 
code
);

62 c⁄° * 
©èchTy≥
(c⁄° 
EpsAâachTy≥
* 
ty≥
);

63 c⁄° * 
dëachTy≥
(c⁄° 
DëachTy≥
* 
ty≥
);

65 
ssize_t
 
ïsIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
EpsMobûeIdítôy
* 
idít
);

66 c⁄° * 
idítôyTy≥
(c⁄° 
IdítôyTy≥2
* 
ty≥
);

67 
ssize_t
 
mobûeIdítôy
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
MobûeIdítôy
* 
idít
);

69 c⁄° * 
ªque°Ty≥
(c⁄° 
Reque°Ty≥
* 
ty≥
);

70 c⁄° * 
pdnTy≥
(c⁄° 
PdnTy≥
* 
ty≥
);

71 
ssize_t
 
pdnAddªss
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
PdnAddªss
* 
addr
);

73 
ssize_t
 
«sKeySëIdítifõr
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
NasKeySëIdítifõr
* 
ksi
);

74 
ssize_t
 
authítiˇti⁄P¨amëî
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
O˘ëSåög
* 
∑øm
);

75 c⁄° * 
«sCùhîögAlg‹ôhm
(c⁄° 
NasSecurôyAlg‹ôhms
* 
Ægo
);

76 c⁄° * 
«sI¡egrôyAlg‹ôhm
(c⁄° 
NasSecurôyAlg‹ôhms
* 
Ægo
);

78 
ssize_t
 
g¥sTimî
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
G¥sTimî
* 
timî
);

79 
ssize_t
 
èiLi°
(* 
buf„r
, 
size_t
 
Àn
, c⁄° 
TøckögAªaIdítôyLi°
* 
èi
);

	@tst/as_simulator/nas_process.c

22 
	~"«s_¥o˚ss.h
"

24 
	~"«s_d©a.h
"

25 
	~"«s_mesßge.h
"

26 
	~"emmD©a.h
"

28 
	~<°dio.h
>

29 
	~<°rög.h
>

44 
_«s_¥o˚ss_emm
(* 
buf„r
, 
Àngth
, c⁄° 
EMM_msg
* 
msg
);

46 
_©èch_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
©èch_ªque°_msg
* 
msg
);

47 
_©èch_ac˚±
(* 
buf„r
, 
Àngth
, c⁄° 
©èch_ac˚±_msg
* 
msg
);

48 
_©èch_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
©èch_ªje˘_msg
* 
msg
);

49 
_©èch_com∂ëe
(* 
buf„r
, 
Àngth
, c⁄° 
©èch_com∂ëe_msg
* 
msg
);

51 
_dëach_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
dëach_ªque°_msg
* 
msg
);

52 
_dëach_ac˚±
(* 
buf„r
, 
Àngth
, c⁄° 
dëach_ac˚±_msg
* 
msg
);

54 
_idítôy_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
idítôy_ªque°_msg
* 
msg
);

55 
_idítôy_ª•⁄£
(* 
buf„r
, 
Àngth
, c⁄° 
idítôy_ª•⁄£_msg
* 
msg
);

57 
_authítiˇti⁄_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
authítiˇti⁄_ªque°_msg
* 
msg
);

58 
_authítiˇti⁄_ª•⁄£
(* 
buf„r
, 
Àngth
, c⁄° 
authítiˇti⁄_ª•⁄£_msg
* 
msg
);

59 
_authítiˇti⁄_Áûuª
(* 
buf„r
, 
Àngth
, c⁄° 
authítiˇti⁄_Áûuª_msg
* 
msg
);

60 
_authítiˇti⁄_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
authítiˇti⁄_ªje˘_msg
* 
msg
);

62 
_£curôy_mode_comm™d
(* 
buf„r
, 
Àngth
, c⁄° 
£curôy_mode_comm™d_msg
* 
msg
);

63 
_£curôy_mode_com∂ëe
(* 
buf„r
, 
Àngth
, c⁄° 
£curôy_mode_com∂ëe_msg
* 
msg
);

64 
_£curôy_mode_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
£curôy_mode_ªje˘_msg
* 
msg
);

66 
_esm_mesßge_c⁄èöî
(* 
buf„r
, 
Àngth
, c⁄° 
EsmMesßgeC⁄èöî
* 
msg
);

68 
_emm_°©us
(* 
buf„r
, 
Àngth
, c⁄° 
emm_°©us_msg
* 
msg
);

75 
_«s_¥o˚ss_esm
(* 
buf„r
, 
Àngth
, c⁄° 
ESM_msg
* 
msg
);

77 
_pdn_c⁄√˘ivôy_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
* 
msg
);

78 
_pdn_c⁄√˘ivôy_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
pdn_c⁄√˘ivôy_ªje˘_msg
* 
msg
);

80 
_pdn_disc⁄√˘_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
pdn_disc⁄√˘_ªque°_msg
* 
msg
);

81 
_pdn_disc⁄√˘_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
pdn_disc⁄√˘_ªje˘_msg
* 
msg
);

83 
_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
);

84 
_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
);

85 
_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
);

87 
_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
);

88 
_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
);

89 
_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(* 
buf„r
, 
Àngth
, c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
);

91 
_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(* 
buf„r
, 
Àngth
, c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
);

92 
_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(* 
buf„r
, 
Àngth
, c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
);

94 
_esm_°©us
(* 
buf„r
, 
Àngth
, c⁄° 
esm_°©us_msg
* 
msg
);

106 
	$«s_¥o˚ss
(

107 * 
buf„r
,

108 
Àngth
,

109 c⁄° * 
msg
,

110 
size
)

112 
ödex
 = 0;

113 
byãs
;

114 
«s_mesßge_t
 
«s_msg
;

117 
	`mem£t
(&
«s_msg
, 0, (
«s_mesßge_t
));

118 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

119 
byãs
 = 
	`«s_mesßge_decode
(
msg
, &
«s_msg
, 
size
, 
£curôy
);

120 i‡(
byãs
 < 0) {

121 
	`¥ötf
("ERROR\t: %s - FailedÅo decode NAS message (err=%d)\n",

122 
__FUNCTION__
, 
byãs
);

123  (
RETURNîr‹
);

126 
¥Ÿocﬁ_dis¸imö©‹
 = 
«s_msg
.
hódî
.protocol_discriminator;

127 i‡(
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_MOBILITY_MANAGEMENT_MESSAGE
) {

129 
ödex
 +
	`_«s_¥o˚ss_emm
(
buf„r
 + index,

130 
Àngth
 - 
ödex
,

131 &
«s_msg
.
∂aö
.
emm
);

133 i‡(
¥Ÿocﬁ_dis¸imö©‹
 =
EPS_SESSION_MANAGEMENT_MESSAGE
) {

135 
ödex
 +
	`_«s_¥o˚ss_esm
(
buf„r
 + index,

136 
Àngth
 - 
ödex
,

137 &
«s_msg
.
∂aö
.
esm
);

140 
	`¥ötf
("ERROR\t: %s - Protocol discriminator isÇot valid (%d)\n",

141 
__FUNCTION__
, 
¥Ÿocﬁ_dis¸imö©‹
);

142  (
RETURNîr‹
);

145 
buf„r
[
ödex
] = '\0';

147  (
byãs
);

148 
	}
}

166 
	$_«s_¥o˚ss_emm
(

167 * 
buf„r
,

168 
Àngth
,

169 c⁄° 
EMM_msg
* 
msg
)

171 
ödex
 = 0;

172 c⁄° 
EsmMesßgeC⁄èöî
* 
esm_c⁄èöî
 = 
NULL
;

174 
	`¥ötf
("INFO\t: Pro˚s†%s\n", 
	`emmMsgTy≥
(
msg
->
hódî
.
mesßge_ty≥
));

175 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "%s (",

176 
	`emmMsgTy≥
(
msg
->
hódî
.
mesßge_ty≥
));

178 
msg
->
hódî
.
mesßge_ty≥
)

180 
ATTACH_REQUEST
:

181 
esm_c⁄èöî
 = &
msg
->
©èch_ªque°
.
esmmesßgec⁄èöî
;

182 
ödex
 +
	`_©èch_ªque°
(
buf„r
 + index, 
Àngth
 - index,

183 &
msg
->
©èch_ªque°
);

186 
ATTACH_ACCEPT
:

187 
esm_c⁄èöî
 = &
msg
->
©èch_ac˚±
.
esmmesßgec⁄èöî
;

188 
ödex
 +
	`_©èch_ac˚±
(
buf„r
 + index, 
Àngth
 - index,

189 &
msg
->
©èch_ac˚±
);

192 
ATTACH_REJECT
:

193 
esm_c⁄èöî
 = &
msg
->
©èch_ªje˘
.
esmmesßgec⁄èöî
;

194 
ödex
 +
	`_©èch_ªje˘
(
buf„r
 + index, 
Àngth
 - index,

195 &
msg
->
©èch_ªje˘
);

198 
ATTACH_COMPLETE
:

199 
esm_c⁄èöî
 = &
msg
->
©èch_com∂ëe
.
esmmesßgec⁄èöî
;

200 
ödex
 +
	`_©èch_com∂ëe
(
buf„r
 + index, 
Àngth
 - index,

201 &
msg
->
©èch_com∂ëe
);

204 
DETACH_REQUEST
:

205 
ödex
 +
	`_dëach_ªque°
(
buf„r
 + index, 
Àngth
 - index,

206 &
msg
->
dëach_ªque°
);

209 
DETACH_ACCEPT
:

210 
ödex
 +
	`_dëach_ac˚±
(
buf„r
 + index, 
Àngth
 - index,

211 &
msg
->
dëach_ac˚±
);

214 
IDENTITY_REQUEST
:

215 
ödex
 +
	`_idítôy_ªque°
(
buf„r
 + index, 
Àngth
 - index,

216 &
msg
->
idítôy_ªque°
);

219 
IDENTITY_RESPONSE
:

220 
ödex
 +
	`_idítôy_ª•⁄£
(
buf„r
 + index, 
Àngth
 - index,

221 &
msg
->
idítôy_ª•⁄£
);

224 
AUTHENTICATION_REQUEST
:

225 
ödex
 +
	`_authítiˇti⁄_ªque°
(
buf„r
 + index, 
Àngth
 - index,

226 &
msg
->
authítiˇti⁄_ªque°
);

229 
AUTHENTICATION_RESPONSE
:

230 
ödex
 +
	`_authítiˇti⁄_ª•⁄£
(
buf„r
 + index, 
Àngth
 - index,

231 &
msg
->
authítiˇti⁄_ª•⁄£
);

234 
AUTHENTICATION_FAILURE
:

235 
ödex
 +
	`_authítiˇti⁄_Áûuª
(
buf„r
 + index, 
Àngth
 - index,

236 &
msg
->
authítiˇti⁄_Áûuª
);

239 
AUTHENTICATION_REJECT
:

240 
ödex
 +
	`_authítiˇti⁄_ªje˘
(
buf„r
 + index, 
Àngth
 - index,

241 &
msg
->
authítiˇti⁄_ªje˘
);

244 
SECURITY_MODE_COMMAND
:

245 
ödex
 +
	`_£curôy_mode_comm™d
(
buf„r
 + index, 
Àngth
 - index,

246 &
msg
->
£curôy_mode_comm™d
);

249 
SECURITY_MODE_COMPLETE
:

250 
ödex
 +
	`_£curôy_mode_com∂ëe
(
buf„r
 + index, 
Àngth
 - index,

251 &
msg
->
£curôy_mode_com∂ëe
);

254 
SECURITY_MODE_REJECT
:

255 
ödex
 +
	`_£curôy_mode_ªje˘
(
buf„r
 + index, 
Àngth
 - index,

256 &
msg
->
£curôy_mode_ªje˘
);

259 
EMM_STATUS
:

260 
ödex
 +
	`_emm_°©us
(
buf„r
 + index, 
Àngth
 - index,

261 &
msg
->
emm_°©us
);

265 
	`¥ötf
("WARNING\t: %s - EMM NAS message isÇot valid (0x%x)\n",

266 
__FUNCTION__
, 
msg
->
hódî
.
mesßge_ty≥
);

270 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ")");

273 i‡(
esm_c⁄èöî
) {

274 
ödex
 +
	`_esm_mesßge_c⁄èöî
(
buf„r
 + index,

275 
Àngth
 - 
ödex
,

276 
esm_c⁄èöî
);

279  (
ödex
);

280 
	}
}

288 
	$_©èch_ªque°
(

289 * 
buf„r
,

290 
Àngth
,

291 c⁄° 
©èch_ªque°_msg
* 
msg
)

293 
ödex
 = 0;

296 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "Type = %s",

297 
	`©èchTy≥
(&
msg
->
ïßâachty≥
));

299 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", KSI = ");

300 
ödex
 +
	`«sKeySëIdítifõr
(
buf„r
 + index, 
Àngth
 - index,

301 &
msg
->
«skey£tidítifõr
);

303 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", ");

304 
ödex
 +
	`ïsIdítôy
(
buf„r
 + index, 
Àngth
 - index,

305 &
msg
->
ﬁdguti‹imsi
);

307  (
ödex
);

308 
	}
}

316 
	$_©èch_ac˚±
(

317 * 
buf„r
,

318 
Àngth
,

319 c⁄° 
©èch_ac˚±_msg
* 
msg
)

321 
ödex
 = 0;

325 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "T3412 = ");

326 
ödex
 +
	`g¥sTimî
(
buf„r
 + index, 
Àngth
 - index, &
msg
->
t3412vÆue
);

328 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", ");

329 
ödex
 +
	`èiLi°
(
buf„r
 + index, 
Àngth
 - index, &
msg
->
èûi°
);

332 i‡(
msg
->
¥e£n˚mask
 & 
ATTACH_ACCEPT_GUTI_PRESENT
) {

333 
ödex
 +
	`ïsIdítôy
(
buf„r
 + index, 
Àngth
 - index, &
msg
->
guti
);

336  (
ödex
);

337 
	}
}

345 
	$_©èch_ªje˘
(

346 * 
buf„r
,

347 
Àngth
,

348 c⁄° 
©èch_ªje˘_msg
* 
msg
)

350 
ödex
 = 0;

353 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "EmmCause = %s (%d)",

354 
	`emmCau£Code
(
msg
->
emmˇu£
), msg->emmcause);

356  (
ödex
);

357 
	}
}

365 
	$_©èch_com∂ëe
(

366 * 
buf„r
,

367 
Àngth
,

368 c⁄° 
©èch_com∂ëe_msg
* 
msg
)

370 
ödex
 = 0;

372  (
ödex
);

373 
	}
}

381 
	$_idítôy_ªque°
(

382 * 
buf„r
,

383 
Àngth
,

384 c⁄° 
idítôy_ªque°_msg
* 
msg
)

386 
ödex
 = 0;

389 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "Type = %s",

390 
	`idítôyTy≥
(&
msg
->
idítôyty≥
));

392  (
ödex
);

393 
	}
}

401 
	$_dëach_ªque°
(

402 * 
buf„r
,

403 
Àngth
,

404 c⁄° 
dëach_ªque°_msg
* 
msg
)

406 
ödex
 = 0;

409 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "Type = %s",

410 
	`dëachTy≥
(&
msg
->
dëachty≥
));

412 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", KSI = ");

413 
ödex
 +
	`«sKeySëIdítifõr
(
buf„r
 + index, 
Àngth
 - index,

414 &
msg
->
«skey£tidítifõr
);

416 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", ");

417 
ödex
 +
	`ïsIdítôy
(
buf„r
 + index, 
Àngth
 - index,

418 &
msg
->
guti‹imsi
);

420  (
ödex
);

421 
	}
}

429 
	$_dëach_ac˚±
(

430 * 
buf„r
,

431 
Àngth
,

432 c⁄° 
dëach_ac˚±_msg
* 
msg
)

434 
ödex
 = 0;

436  (
ödex
);

437 
	}
}

445 
	$_idítôy_ª•⁄£
(

446 * 
buf„r
,

447 
Àngth
,

448 c⁄° 
idítôy_ª•⁄£_msg
* 
msg
)

450 
ödex
 = 0;

453 
ödex
 +
	`mobûeIdítôy
(
buf„r
 + index, 
Àngth
 - index,

454 &
msg
->
mobûeidítôy
);

456  (
ödex
);

457 
	}
}

465 
	$_authítiˇti⁄_ªque°
(

466 * 
buf„r
,

467 
Àngth
,

468 c⁄° 
authítiˇti⁄_ªque°_msg
* 
msg
)

470 
ödex
 = 0;

473 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "KSIasme = ");

474 
ödex
 +
	`«sKeySëIdítifõr
(
buf„r
 + index, 
Àngth
 - index,

475 &
msg
->
«skey£tidítifõøsme
);

477 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "\\nRAND = ");

478 
ödex
 +
	`authítiˇti⁄P¨amëî
(
buf„r
 + index, 
Àngth
 - index,

479 &
msg
->
authítiˇti⁄∑ømëîønd
.
ønd
);

481 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", AUTN = ");

482 
ödex
 +
	`authítiˇti⁄P¨amëî
(
buf„r
 + index, 
Àngth
 - index,

483 &
msg
->
authítiˇti⁄∑ømëîauä
.
auä
);

485  (
ödex
);

486 
	}
}

494 
	$_authítiˇti⁄_ª•⁄£
(

495 * 
buf„r
,

496 
Àngth
,

497 c⁄° 
authítiˇti⁄_ª•⁄£_msg
* 
msg
)

499 
ödex
 = 0;

502 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "RES = ");

503 
ödex
 +
	`authítiˇti⁄P¨amëî
(
buf„r
 + index, 
Àngth
 - index,

504 &
msg
->
authítiˇti⁄ª•⁄£∑ømëî
.
ªs
);

506  (
ödex
);

507 
	}
}

515 
	$_authítiˇti⁄_Áûuª
(

516 * 
buf„r
,

517 
Àngth
,

518 c⁄° 
authítiˇti⁄_Áûuª_msg
* 
msg
)

520 
ödex
 = 0;

523 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "EmmCause = %s (%d)",

524 
	`emmCau£Code
(
msg
->
emmˇu£
), msg->emmcause);

526 i‡(
msg
->
¥e£n˚mask
 &

527 
AUTHENTICATION_FAILURE_AUTHENTICATION_FAILURE_PARAMETER_PRESENT
) {

528 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "AUTS = ");

529 
ödex
 +
	`authítiˇti⁄P¨amëî
(
buf„r
 + index, 
Àngth
 - index,

530 &
msg
->
authítiˇti⁄Áûuª∑ømëî
.
auts
);

533  (
ödex
);

534 
	}
}

542 
	$_authítiˇti⁄_ªje˘
(

543 * 
buf„r
,

544 
Àngth
,

545 c⁄° 
authítiˇti⁄_ªje˘_msg
* 
msg
)

547 
ödex
 = 0;

549  (
ödex
);

550 
	}
}

558 
	$_£curôy_mode_comm™d
(

559 * 
buf„r
,

560 
Àngth
,

561 c⁄° 
£curôy_mode_comm™d_msg
* 
msg
)

563 
ödex
 = 0;

566 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "%s (%d)",

567 
	`«sCùhîögAlg‹ôhm
(&
msg
->
£À˘ed«s£curôyÆg‹ôhms
),

568 
msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥ofcùhîögÆg‹ôhm
);

571 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", %s (%d)",

572 
	`«sI¡egrôyAlg‹ôhm
(&
msg
->
£À˘ed«s£curôyÆg‹ôhms
),

573 
msg
->
£À˘ed«s£curôyÆg‹ôhms
.
ty≥oföãgrôyÆg‹ôhm
);

576 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", KSI = ");

577 
ödex
 +
	`«sKeySëIdítifõr
(
buf„r
 + index, 
Àngth
 - index,

578 &
msg
->
«skey£tidítifõr
);

580  (
ödex
);

581 
	}
}

589 
	$_£curôy_mode_com∂ëe
(

590 * 
buf„r
,

591 
Àngth
,

592 c⁄° 
£curôy_mode_com∂ëe_msg
* 
msg
)

594 
ödex
 = 0;

596  (
ödex
);

597 
	}
}

605 
	$_£curôy_mode_ªje˘
(

606 * 
buf„r
,

607 
Àngth
,

608 c⁄° 
£curôy_mode_ªje˘_msg
* 
msg
)

610 
ödex
 = 0;

613 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "EmmCause = %s (%d)",

614 
	`emmCau£Code
(
msg
->
emmˇu£
), msg->emmcause);

616  (
ödex
);

617 
	}
}

625 
	$_esm_mesßge_c⁄èöî
(

626 * 
buf„r
,

627 
Àngth
,

628 c⁄° 
EsmMesßgeC⁄èöî
* 
msg
)

630 
ödex
 = 0;

631 
byãs
;

633 i‡(
msg
->
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
 > 0)

635 
«s_mesßge_t
 
«s_msg
;

636 
	`mem£t
(&
«s_msg
, 0, (
«s_mesßge_t
));

639 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

640 
byãs
 = 
	`«s_mesßge_decode
((*)
msg
->
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
,

641 &
«s_msg
, 
msg
->
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
, 
£curôy
);

642 i‡(
byãs
 < 0) {

643 
	`¥ötf
("ERROR\t: %s - FailedÅo decode ESM message container "

644 "”º=%d)\n", 
__FUNCTION__
, 
byãs
);

648 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "\\n + ");

651 
ödex
 +
	`_«s_¥o˚ss_esm
(
buf„r
 + index, 
Àngth
 - index,

652 &
«s_msg
.
∂aö
.
esm
);

655  (
ödex
);

656 
	}
}

664 
	$_emm_°©us
(

665 * 
buf„r
,

666 
Àngth
,

667 c⁄° 
emm_°©us_msg
* 
msg
)

669 
ödex
 = 0;

672 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "EmmCause = %s (%d)",

673 
	`emmCau£Code
(
msg
->
emmˇu£
), msg->emmcause);

675  (
ödex
);

676 
	}
}

689 
	$_«s_¥o˚ss_esm
(

690 * 
buf„r
,

691 
Àngth
,

692 c⁄° 
ESM_msg
* 
msg
)

694 
ödex
 = 0;

696 
	`¥ötf
("INFO\t: Pro˚s†%s\n", 
	`esmMsgTy≥
(
msg
->
hódî
.
mesßge_ty≥
));

697 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, "%s (pti=%d,Ébi=%d",

698 
	`esmMsgTy≥
(
msg
->
hódî
.
mesßge_ty≥
),

699 
msg
->
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
,

700 
msg
->
hódî
.
ïs_bóªr_idítôy
);

702 
msg
->
hódî
.
mesßge_ty≥
)

704 
PDN_CONNECTIVITY_REQUEST
:

705 
ödex
 +
	`_pdn_c⁄√˘ivôy_ªque°
(
buf„r
 + index, 
Àngth
 - index,

706 &
msg
->
pdn_c⁄√˘ivôy_ªque°
);

709 
PDN_CONNECTIVITY_REJECT
:

710 
ödex
 +
	`_pdn_c⁄√˘ivôy_ªje˘
(
buf„r
 + index, 
Àngth
 - index,

711 &
msg
->
pdn_c⁄√˘ivôy_ªje˘
);

714 
PDN_DISCONNECT_REQUEST
:

715 
ödex
 +
	`_pdn_disc⁄√˘_ªque°
(
buf„r
 + index, 
Àngth
 - index,

716 &
msg
->
pdn_disc⁄√˘_ªque°
);

719 
PDN_DISCONNECT_REJECT
:

720 
ödex
 +
	`_pdn_disc⁄√˘_ªje˘
(
buf„r
 + index, 
Àngth
 - index,

721 &
msg
->
pdn_disc⁄√˘_ªje˘
);

724 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

725 
ödex
 +
	`_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

726 
buf„r
 + 
ödex
, 
Àngth
 - index,

727 &
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
);

730 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

731 
ödex
 +
	`_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(

732 
buf„r
 + 
ödex
, 
Àngth
 - index,

733 &
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
);

736 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

737 
ödex
 +
	`_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(

738 
buf„r
 + 
ödex
, 
Àngth
 - index,

739 &
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
);

742 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REQUEST
:

743 
ödex
 +
	`_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(

744 
buf„r
 + 
ödex
, 
Àngth
 - index,

745 &
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
);

748 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_ACCEPT
:

749 
ödex
 +
	`_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(

750 
buf„r
 + 
ödex
, 
Àngth
 - index,

751 &
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
);

754 
ACTIVATE_DEDICATED_EPS_BEARER_CONTEXT_REJECT
:

755 
ödex
 +
	`_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(

756 
buf„r
 + 
ödex
, 
Àngth
 - index,

757 &
msg
->
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
);

760 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
:

761 
ödex
 +
	`_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(
buf„r
 + index,

762 
Àngth
 - 
ödex
,

763 &
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
);

766 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

767 
ödex
 +
	`_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(
buf„r
 + index,

768 
Àngth
 - 
ödex
,

769 &
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
);

772 
ESM_STATUS
:

773 
ödex
 +
	`_esm_°©us
(
buf„r
 + index, 
Àngth
 - index,

774 &
msg
->
esm_°©us
);

778 
	`¥ötf
("WARNING\t: %s - ESM NAS message isÇot valid (0x%x)\n",

779 
__FUNCTION__
, 
msg
->
hódî
.
mesßge_ty≥
);

783 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ")");

785  (
ödex
);

786 
	}
}

794 
	$_pdn_c⁄√˘ivôy_ªque°
(

795 * 
buf„r
,

796 
Àngth
,

797 c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
* 
msg
)

799 
ödex
 = 0;

802 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index,

804 
	`ªque°Ty≥
(&
msg
->
ªque°ty≥
),

805 
	`pdnTy≥
(&
msg
->
pd¡y≥
));

807 i‡(
msg
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
)

809 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", APN = %s",

810 (*)
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
.
vÆue
);

813  (
ödex
);

814 
	}
}

822 
	$_pdn_c⁄√˘ivôy_ªje˘
(

823 * 
buf„r
,

824 
Àngth
,

825 c⁄° 
pdn_c⁄√˘ivôy_ªje˘_msg
* 
msg
)

827 
ödex
 = 0;

830 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

831 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

833  (
ödex
);

834 
	}
}

842 
	$_pdn_disc⁄√˘_ªque°
(

843 * 
buf„r
,

844 
Àngth
,

845 c⁄° 
pdn_disc⁄√˘_ªque°_msg
* 
msg
)

847 
ödex
 = 0;

850 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", Linked EBI = %d",

851 
msg
->
lökedïsbóªridítôy
);

853  (
ödex
);

854 
	}
}

862 
	$_pdn_disc⁄√˘_ªje˘
(

863 * 
buf„r
,

864 
Àngth
,

865 c⁄° 
pdn_disc⁄√˘_ªje˘_msg
* 
msg
)

867 
ödex
 = 0;

870 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

871 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

873  (
ödex
);

874 
	}
}

882 
	$_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
(

883 * 
buf„r
,

884 
Àngth
,

885 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
)

887 
ödex
 = 0;

890 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", APN = %s",

891 (*)
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
.
vÆue
);

894 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", PDNáddr = ");

895 
ödex
 +
	`pdnAddªss
(
buf„r
 + index, 
Àngth
 - index, &
msg
->
pd«ddªss
);

897  (
ödex
);

898 
	}
}

906 
	$_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(

907 * 
buf„r
,

908 
Àngth
,

909 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
)

911 
ödex
 = 0;

913  (
ödex
);

914 
	}
}

922 
	$_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(

923 * 
buf„r
,

924 
Àngth
,

925 c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
)

927 
ödex
 = 0;

930 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

931 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

933  (
ödex
);

934 
	}
}

942 
	$_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°
(

943 * 
buf„r
,

944 
Àngth
,

945 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
)

947 
ödex
 = 0;

950 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", Linked EBI = %d",

951 
msg
->
lökedïsbóªridítôy
);

953  (
ödex
);

954 
	}
}

962 
	$_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±
(

963 * 
buf„r
,

964 
Àngth
,

965 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
)

967 
ödex
 = 0;

969  (
ödex
);

970 
	}
}

978 
	$_a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘
(

979 * 
buf„r
,

980 
Àngth
,

981 c⁄° 
a˘iv©e_dediˇãd_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
)

983 
ödex
 = 0;

986 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

987 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

989  (
ödex
);

990 
	}
}

997 
	$_dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
(

998 * 
buf„r
,

999 
Àngth
,

1000 c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
msg
)

1002 
ödex
 = 0;

1005 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

1006 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

1008  (
ödex
);

1009 
	}
}

1017 
	$_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(

1018 * 
buf„r
,

1019 
Àngth
,

1020 c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
)

1022 
ödex
 = 0;

1024  (
ödex
);

1025 
	}
}

1033 
	$_esm_°©us
(

1034 * 
buf„r
,

1035 
Àngth
,

1036 c⁄° 
esm_°©us_msg
* 
msg
)

1038 
ödex
 = 0;

1041 
ödex
 +
	`¢¥ötf
(
buf„r
 + index, 
Àngth
 - index, ", EsmCause = %s (%d)",

1042 
	`esmCau£Code
(
msg
->
esmˇu£
), msg->esmcause);

1044  (
ödex
);

1045 
	}
}

	@tst/as_simulator/nas_process.h

22 #i‚de‡
__NAS_PROCESS_H__


23 
	#__NAS_PROCESS_H__


	)

41 
«s_¥o˚ss
(* 
buf„r
, 
Àngth
, c⁄° * 
msg
, 
size
);

	@tst/network/network_parser.c

21 
	~"√tw‹k_∑r£r.h
"

23 
	~"utû/∑r£r.h
"

38 
	mNETWORK_PARSER_HOST
,

39 
	mNETWORK_PARSER_PORT
,

40 
	mNETWORK_PARSER_NB_OPTIONS


52 
∑r£r_comm™d_löe_t
 
	g√tw‹kP¨£rComm™dLöe
 = {

54 
NETWORK_PARSER_NB_OPTIONS
,

56 {"-ho°", "<ho°>", "RemŸêho°«me\t\t", 
NETWORK_PARSER_DEFAULT_REMOTE_HOSTNAME
},

57 {"-p‹t", "<p‹t>", "RemŸêp‹ànumbî\t", 
NETWORK_PARSER_DEFAULT_REMOTE_PORT_NUMBER
},

79 
ölöe
 
	$√tw‹k_∑r£r_¥öt_ußge
()

81 
	`∑r£r_¥öt_ußge
(&
√tw‹kP¨£rComm™dLöe
);

82 
	}
}

99 
ölöe
 
	$√tw‹k_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
)

101  
	`∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
, &
√tw‹kP¨£rComm™dLöe
);

102 
	}
}

118 
ölöe
 
	$√tw‹k_∑r£r_gë_nb_›ti⁄s
()

120  
√tw‹kP¨£rComm™dLöe
.
nb_›ti⁄s
;

121 
	}
}

136 
ölöe
 c⁄° * 
	$√tw‹k_∑r£r_gë_ho°
()

138  
√tw‹kP¨£rComm™dLöe
.
›ti⁄s
[
NETWORK_PARSER_HOST
].
pvÆue
;

139 
	}
}

154 
ölöe
 c⁄° * 
	$√tw‹k_∑r£r_gë_p‹t
()

156  
√tw‹kP¨£rComm™dLöe
.
›ti⁄s
[
NETWORK_PARSER_PORT
].
pvÆue
;

157 
	}
}

	@tst/network/network_parser.h

21 #i‚de‡
__NETWORK_PARSER_H__


22 
	#__NETWORK_PARSER_H__


	)

29 
	#NETWORK_PARSER_DEFAULT_REMOTE_HOSTNAME
 "loˇlho°"

	)

33 
	#NETWORK_PARSER_DEFAULT_REMOTE_PORT_NUMBER
 "12000"

	)

47 
√tw‹k_∑r£r_¥öt_ußge
();

48 
√tw‹k_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
);

50 
√tw‹k_∑r£r_gë_nb_›ti⁄s
();

51 c⁄° * 
√tw‹k_∑r£r_gë_ho°
();

52 c⁄° * 
√tw‹k_∑r£r_gë_p‹t
();

	@tst/network/network_simulator.c

22 
	~"√tw‹k_∑r£r.h
"

24 
	~"ö˛ude/comm⁄Def.h
"

25 
	~"utû/sockë.h
"

26 
	~"utû/«s_timî.h
"

27 
	~"≠i/√tw‹k/as_mesßge.h
"

28 
	~"≠i/√tw‹k/«s_mesßge.h
"

29 
	~"emm/msg/emm_ˇu£.h
"

30 
	~"esm/msg/esm_ˇu£.h
"

31 
	~"emmD©a.h
"

33 
	~"utû/«s_log.h
"

35 
	~<°dio.h
>

36 
	~<î∫o.h
>

37 
	~<√tdb.h
>

38 
	~<°dlib.h
>

39 
	~<sig«l.h
>

40 
	~<°rög.h
>

41 
	~<uni°d.h
>

58 
	#DEFAULT_TAC
 0xCAFE

59 

	)

61 
	#DEFAULT_CI
 0x01020304

62 

	)

64 
	#DEFAULT_RSRP
 27

	)

67 
	#DEFAULT_RSRQ
 55

	)

70 
	#BIT_RATE_64K
 0x40

	)

71 
	#BIT_RATE_128K
 0x48

	)

72 
	#BIT_RATE_512K
 0x78

	)

73 
	#BIT_RATE_1024K
 0x87

	)

76 c⁄° 
O˘ëSåög
 
	gEURECOM_APN
 = {

77 14, (
uöt8_t
*)("www.eurecom.fr")

82 
uöt8_t
 
	gFIRST_PDN_IPV4_ADDRESS
[] = {

84 
uöt8_t
 
	gFIRST_PDN_IPV6_ADDRESS
[] = {

86 
uöt8_t
 
	gFIRST_PDN_IPV4V6_ADDRESS
[] = {

88 c⁄° 
O˘ëSåög
 
	gFIRST_IPV4_PDN
 = {4, 
FIRST_PDN_IPV4_ADDRESS
};

89 c⁄° 
O˘ëSåög
 
	gFIRST_IPV6_PDN
 = {8, 
FIRST_PDN_IPV6_ADDRESS
};

90 c⁄° 
O˘ëSåög
 
	gFIRST_IPV4V6_PDN
 = {12, 
FIRST_PDN_IPV4V6_ADDRESS
};

94 
uöt8_t
 
	gOTHER_PDN_IPV4_ADDRESS
[] = {

96 
uöt8_t
 
	gOTHER_PDN_IPV6_ADDRESS
[] = {

98 
uöt8_t
 
	gOTHER_PDN_IPV4V6_ADDRESS
[] = {

100 c⁄° 
O˘ëSåög
 
	gOTHER_IPV4_PDN
 = {4, 
OTHER_PDN_IPV4_ADDRESS
};

101 c⁄° 
O˘ëSåög
 
	gOTHER_IPV6_PDN
 = {8, 
OTHER_PDN_IPV6_ADDRESS
};

102 c⁄° 
O˘ëSåög
 
	gOTHER_IPV4V6_PDN
 = {12, 
OTHER_PDN_IPV4V6_ADDRESS
};

105 
	#SLEEP_TIME
 1

	)

113 
	#PRINT_PLMN_DIGIT
(
d
Ëi‡((dË!0xfË
	`¥ötf
("%u", (d))

	)

114 
	#PRINT_PLMN
(
∂mn
) \

115 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô1
); \

116 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô2
); \

117 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MCCdigô3
); \

118 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô1
); \

119 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô2
); \

120 
	`PRINT_PLMN_DIGIT
((
∂mn
).
MNCdigô3
)

	)

131 
	#NETWORK_SIMULATOR_BUFFER_SIZE
 1024

	)

132 
	g_√tw‹k_simuœt‹_buf„r
 [
NETWORK_SIMULATOR_BUFFER_SIZE
];

137 
sockë_id_t
 * 
	g_√tw‹k_simuœt‹_sid
;

142 
	#NETWORK_SIMULATOR_ESM_BUFFER_SIZE
 1024

	)

143 
uöt8_t
 
	g_√tw‹k_simuœt‹_esm_buf„r
[
NETWORK_SIMULATOR_ESM_BUFFER_SIZE
];

148 
	g_√tw‹k_simuœt‹_msg_ªcv
 = 0;

149 
	g_√tw‹k_simuœt‹_msg_£¡
 = 0;

154 
	g_√tw‹k_simuœt‹_ebi
 = 
EPS_BEARER_IDENTITY_FIRST
;

160 
	mNETWORK_IPV4
 = 0,

161 
	mNETWORK_IPV6
,

162 
	mNETWORK_IPV4V6
,

163 
	mNETWORK_IP_MAX


164 } 
	g_√tw‹k_simuœt‹_ù_vîsi⁄
 = 
NETWORK_IPV4V6
;

165 c⁄° 
O˘ëSåög
* 
	g_√tw‹k_simuœt‹_pdn
[
NETWORK_IP_MAX
][2] = {

167 {&
FIRST_IPV4_PDN
, &
OTHER_IPV4_PDN
},

169 {&
FIRST_IPV6_PDN
, &
OTHER_IPV6_PDN
},

171 {&
FIRST_IPV4V6_PDN
, &
OTHER_IPV4V6_PDN
},

180 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)());

181 
	`_sig«l_h™dÀr
(
sig«l_numbî
);

182 
	`_¥o˚ss_mesßge
(
msgID
, c⁄° 
as_mesßge_t
* 
ªq
);

183 
	`_assign_pdn_addªss
(
ue_pdn_ty≥
, 
is_öôül
, * 
pdn_ty≥
, 
O˘ëSåög
* 
pdn
);

186 
	`_¥o˚ss_˚Œ_öfo_ªq
(c⁄° 
˚Œ_öfo_ªq_t
* 
ªq
, 
˚Œ_öfo_˙f_t
* 
r•
);

187 
	`_¥o˚ss_e°ablish_ªq
(c⁄° 
«s_e°ablish_ªq_t
* 
ªq
, 
«s_e°ablish_˙f_t
* 
r•
);

188 
	`_¥o˚ss_ul_öfo_å™s„r_ªq
(c⁄° 
ul_öfo_å™s„r_ªq_t
* 
ªq
, 
ul_öfo_å™s„r_˙f_t
* 
˙f
, 
dl_öfo_å™s„r_öd_t
* 
öd
);

191 
	`_¥o˚ss_emm_msg
(
EMM_msg
* 
msg
);

192 
	`_¥o˚ss_©èch_ªque°
(c⁄° 
©èch_ªque°_msg
* 
msg
, 
EMM_msg
* 
r•
, c⁄° 
∂mn_t
 *
∂mn
);

193 
	`_¥o˚ss_©èch_com∂ëe
(c⁄° 
©èch_com∂ëe_msg
* 
msg
);

196 
	`_¥o˚ss_esm_msg
(
ESM_msg
* 
msg
);

197 
	`_¥o˚ss_pdn_c⁄√˘ivôy_ªque°
(c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
* 
msg
, 
ESM_msg
* 
r•
);

198 
	`_¥o˚ss_pdn_disc⁄√˘_ªque°
(c⁄° 
pdn_disc⁄√˘_ªque°_msg
* 
msg
, 
ESM_msg
* 
r•
);

199 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
);

200 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
);

201 
	`_¥o˚ss_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
);

203 
	$_dump_buf„r
(c⁄° 
Byã_t
* 
buf„r
, 
size_t
 
Àn
)

205 
i
 = 0; i < 
Àn
; i++) {

206 i‡–(
i
%16Ë=0 ) 
	`¥ötf
("\n\t");

207 
	`¥ötf
("%.2hx ", 
buf„r
[
i
]);

209 
	`¥ötf
("\n\n");

210 
	}
}

217 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

222 i‡–
	`√tw‹k_∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
Ë!
RETURNok
 )

224 
	`√tw‹k_∑r£r_¥öt_ußge
();

225 
	`exô
(
EXIT_FAILURE
);

227 c⁄° * 
ho°
 = 
	`√tw‹k_∑r£r_gë_ho°
();

228 c⁄° * 
p‹t
 = 
	`√tw‹k_∑r£r_gë_p‹t
();

230 
	`«s_log_öô
(0x2f);

235 
_√tw‹k_simuœt‹_sid
 = 
	`sockë_udp_›í
(
SOCKET_SERVER
, 
ho°
, 
p‹t
);

236 i‡(
_√tw‹k_simuœt‹_sid
 =
NULL
) {

237 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

238 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

239 
	`¥ötf
("ERROR\t: sockë_udp_›í(ËÁûed: %s\n", 
îr‹
);

240 
	`exô
(
EXIT_FAILURE
);

242 
	`¥ötf
("INFO\t: The Network Simulator isÇow connectedÅo %s/%s (%d)\n",

243 
ho°
, 
p‹t
, 
	`sockë_gë_fd
(
_√tw‹k_simuœt‹_sid
));

248 (Ë
	`_£t_sig«l_h™dÀr
(
SIGINT
, 
_sig«l_h™dÀr
);

249 (Ë
	`_£t_sig«l_h™dÀr
(
SIGTERM
, 
_sig«l_h™dÀr
);

254 
TRUE
)

256 
as_mesßge_t
 
msg
;

259 
rbyãs
 = 
	`sockë_ªcv
(
_√tw‹k_simuœt‹_sid
, 
_√tw‹k_simuœt‹_buf„r
,

260 
NETWORK_SIMULATOR_BUFFER_SIZE
);

261 i‡(
rbyãs
 =
RETURNîr‹
) {

262 
	`≥º‹
("ERROR\t: socket_recv() failed");

265 
_√tw‹k_simuœt‹_buf„r
[
rbyãs
] = '\0';

267 
_√tw‹k_simuœt‹_msg_ªcv
 += 1;

270 
msg_id
 = 
	`as_mesßge_decode
(
_√tw‹k_simuœt‹_buf„r
, &
msg
, 
rbyãs
);

273 
Àn
 = 
	`_¥o˚ss_mesßge
(
msg_id
, &
msg
);

274 i‡(
Àn
 > 0) {

276 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

278 
sbyãs
 = 
	`sockë_£nd
(
_√tw‹k_simuœt‹_sid
, 
_√tw‹k_simuœt‹_buf„r
, 
Àn
);

279 i‡(
sbyãs
 =
RETURNîr‹
) {

280 
	`≥º‹
("ERROR\t: socket_send() failed");

283 
_√tw‹k_simuœt‹_msg_£¡
 += 1;

286 
	`¥ötf
("\nINFO\t: %d messagesÑeceived, %d messages sent\n",

287 
_√tw‹k_simuœt‹_msg_ªcv
, 
_√tw‹k_simuœt‹_msg_£¡
);

293 
	`¥ötf
("INFO\t: ClosögÇëw‹k sockë %d\n", 
	`sockë_gë_fd
(
_√tw‹k_simuœt‹_sid
));

294 
	`sockë_˛o£
(
_√tw‹k_simuœt‹_sid
);

296 
	`¥ötf
("INFO\t: Network simulatorÉxited\n");

297 
	`exô
(
EXIT_SUCCESS
);

298 
	}
}

307 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)())

309 
siga˘i⁄
 
a˘
;

312 (Ë
	`mem£t
 (&
a˘
, 0,  (act));

313 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

314 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

315 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

316 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

317 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

318 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

319 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

320 #i‚de‡
LINUX


321 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

323 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

324 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

325 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

326 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

329 
a˘
.
ß_h™dÀr
 = 
h™dÀr
;

330 i‡–
	`siga˘i⁄
 (
sig«l
, &
a˘
, 0) < 0 ) {

331  
RETURNîr‹
;

334  
RETURNok
;

335 
	}
}

340 
	$_sig«l_h™dÀr
(
sig«l_numbî
)

342 
	`¥ötf
("\nWARNING\t: Sig«»%dÑe˚ived\n", 
sig«l_numbî
);

343 
	`¥ötf
("INFO\t: ClosögÇëw‹k sockë %d\n", 
	`sockë_gë_fd
(
_√tw‹k_simuœt‹_sid
));

344 
	`sockë_˛o£
(
_√tw‹k_simuœt‹_sid
);

345 
	`¥ötf
("INFO\t: Network simulatorÉxited\n");

346 
	`exô
(
EXIT_SUCCESS
);

347 
	}
}

357 
	$_¥o˚ss_mesßge
(
msgID
, c⁄° 
as_mesßge_t
* 
ªq
)

359 
as_mesßge_t
 
r•
;

360 
byãs
 = 0;

362 
	`mem£t
(&
r•
, 0, (
as_mesßge_t
));

364 
msgID
)

366 
AS_CELL_INFO_REQ
:

368 
r•
.
msgID
 = 
	`_¥o˚ss_˚Œ_öfo_ªq
(&
ªq
->
msg
.
˚Œ_öfo_ªq
,

369 &
r•
.
msg
.
˚Œ_öfo_˙f
);

372 
AS_NAS_ESTABLISH_REQ
:

374 
r•
.
msgID
 = 
	`_¥o˚ss_e°ablish_ªq
(&
ªq
->
msg
.
«s_e°ablish_ªq
,

375 &
r•
.
msg
.
«s_e°ablish_˙f
);

378 
AS_UL_INFO_TRANSFER_REQ
:

380 
r•
.
msgID
 = 
	`_¥o˚ss_ul_öfo_å™s„r_ªq
(&
ªq
->
msg
.
ul_öfo_å™s„r_ªq
,

381 &
r•
.
msg
.
ul_öfo_å™s„r_˙f
,

382 &
r•
.
msg
.
dl_öfo_å™s„r_öd
);

386 
	`Ârötf
(
°dîr
, "WARNING\t: Mesßgêty≥ %d i†nŸ vÆid\n", 
msgID
);

390 i‡(
r•
.
msgID
 =
AS_NAS_RELEASE_IND
) {

392 
r•
.
msg
.
«s_ªÀa£_öd
.
ˇu£
 = 
AS_DETACH
;

393 
	`¥ötf
("\nINFO\t: Send NAS connectionÑelease indication: cause = %d\n",

394 
r•
.
msg
.
«s_ªÀa£_öd
.
ˇu£
);

397 i‡(
r•
.
msgID
 > 0) {

399 
byãs
 = 
	`as_mesßge_ícode
(
_√tw‹k_simuœt‹_buf„r
, &
r•
,

400 
NETWORK_SIMULATOR_BUFFER_SIZE
);

403  (
byãs
);

404 
	}
}

409 
	$_¥o˚ss_˚Œ_öfo_ªq
(c⁄° 
˚Œ_öfo_ªq_t
* 
ªq
,

410 
˚Œ_öfo_˙f_t
* 
r•
)

412 
	`¥ötf
("\nINFO\t: Received cell selectionÑequest:ÖlmnID = ");

413 
	`PRINT_PLMN
(
ªq
->
∂mnID
);

414 
	`¥ötf
(",Ñ© = 0x%x\n", 
ªq
->
øt
);

418 
r•
->
îrCode
 = 
AS_SUCCESS
;

419 
r•
->
èc
 = 
DEFAULT_TAC
;

420 
r•
->
˚ŒID
 = 
DEFAULT_CI
;

421 
r•
->
øt
 = 
AS_EUTRAN
;

422 
r•
->
r§p
 = 
DEFAULT_RSRP
;

423 
r•
->
r§q
 = 
DEFAULT_RSRQ
;

424 
	`¥ötf
("\nINFO\t: Send cell selection confirm:ÉrrCode = %s (%d), "

426 (
r•
->
îrCode
 !
AS_SUCCESS
)? "FAILURE" : "SUCCESS",Ñsp->errCode,

427 
r•
->
èc
,Ñ•->
˚ŒID
,Ñ•->
øt
);

429  (
AS_CELL_INFO_CNF
);

430 
	}
}

435 
	$_¥o˚ss_e°ablish_ªq
(c⁄° 
«s_e°ablish_ªq_t
* 
ªq
,

436 
«s_e°ablish_˙f_t
* 
r•
)

438 
rc
 = 
RETURNîr‹
;

440 
	`¥ötf
("\nINFO\t: Received NAS connectionÉstablishÑequest:ÖlmnID = ");

441 
	`PRINT_PLMN
(
ªq
->
∂mnID
);

442 
	`¥ötf
(", S-TMSI = MMEcode <0x%.2x> M-TMSI <0x%.4x>",

443 
ªq
->
s_tmsi
.
MMEcode
,Ñeq->s_tmsi.
m_tmsi
);

444 
	`¥ötf
(", cau£ = %d,Åy≥ = %d\n", 
ªq
->
ˇu£
,Ñeq->
ty≥
);

446 c⁄° 
as_«s_öfo_t
* 
«s_msg
 = &
ªq
->
öôülNasMsg
;

447 
	`¥ötf
("INFO\t: Inôü»NAS mesßgê÷ígth = %d)\n", 
«s_msg
->
Àngth
);

448 
	`_dump_buf„r
(
«s_msg
->
d©a
,Ças_msg->
Àngth
);

451 
«s_mesßge_t
 
l3_msg
;

452 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

453 
rc
 = 
	`«s_mesßge_decode
((*)
«s_msg
->
d©a
, &
l3_msg
,Ças_msg->
Àngth
, 
£curôy
);

454 i‡(
rc
 < 0) {

456 
	`¥ötf
("ERROR\t: FaûedÅÿdecodêNAS mesßgê‘c=%d)", 
rc
);

457 
r•
->
îrCode
 = 
AS_FAILURE
;

458  (
AS_NAS_ESTABLISH_CNF
);

461 
	`¥ötf
("INFO\t: L3 NAS mesßgê0x%.2x\n", 
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
);

462 
	`¥ötf
("INFO\t: PrŸocﬁ Dis¸imö©‹ = %d\n", 
l3_msg
.
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

463 
	`¥ötf
("INFO\t: Securôy Hódî Ty≥ = %d\n", 
l3_msg
.
hódî
.
£curôy_hódî_ty≥
);

464 
	`¥ötf
("INFO\t: EMM message: ");

466 
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
)

468 
ATTACH_REQUEST
:

469 
rc
 = 
	`_¥o˚ss_©èch_ªque°
(&
l3_msg
.
∂aö
.
emm
.
©èch_ªque°
,

470 &
l3_msg
.
∂aö
.
emm
,

471 &
ªq
->
∂mnID
);

475 
	`¥ötf
("ERROR\t: L3 NAS message 0x%x isÇot valid\n",

476 
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
);

480 
_e°ablish_ªq_no_ª•⁄£_cou¡î
 = 0;

481 i‡(
_e°ablish_ªq_no_ª•⁄£_cou¡î
 > 0) {

482 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

483 
_e°ablish_ªq_no_ª•⁄£_cou¡î
 -=1;

489 i‡(
rc
 !
RETURNîr‹
) {

490 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

491 
byãs
 = 
	`«s_mesßge_ícode
(
_√tw‹k_simuœt‹_buf„r
, &
l3_msg
,

492 
NETWORK_SIMULATOR_BUFFER_SIZE
, 
£curôy
);

494 
_e°ablish_ªq_Áûuª_cou¡î
 = 0;

495 i‡(
_e°ablish_ªq_Áûuª_cou¡î
 > 0) {

496 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

497 
_e°ablish_ªq_Áûuª_cou¡î
 -= 1;

499 
byãs
 = 0;

502 i‡(
byãs
 > 0) {

504 
r•
->
îrCode
 = 
AS_SUCCESS
;

505 
r•
->
«sMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
byãs
 * (Byte_t));

506 i‡(
r•
->
«sMsg
.
d©a
) {

507 
r•
->
«sMsg
.
Àngth
 = 
byãs
;

508 
	`mem˝y
((*)(
r•
->
«sMsg
.
d©a
), 
_√tw‹k_simuœt‹_buf„r
, 
byãs
);

513 
r•
->
îrCode
 = 
AS_FAILURE
;

515 
	`¥ötf
("\nINFO\t: Send NAS connectionÉstablish confirm:ÉrrCode = %s (%d)\n",

516 (
r•
->
îrCode
 !
AS_SUCCESS
)? "FAILURE" : "SUCCESS",Ñsp->errCode);

517 i‡(
r•
->
«sMsg
.
Àngth
 > 0) {

518 
	`¥ötf
("INFO\t: NAS message %s (0x%x) (length = %d)\n",

519 (
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
 =
ATTACH_ACCEPT
)? "ATTACH_ACCEPT" :

520 (
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
 =
ATTACH_REJECT
)? "ATTACH_REJECT" :

521 "Unknow¿NAS mesßge", 
l3_msg
.
∂aö
.
emm
.
hódî
.
mesßge_ty≥
,

522 
r•
->
«sMsg
.
Àngth
);

523 
	`_dump_buf„r
(
r•
->
«sMsg
.
d©a
,Ñ•->«sMsg.
Àngth
);

526 
rc
 = 
AS_NAS_ESTABLISH_CNF
;

530 
	`¥ötf
("\nINFO\t: Send NAS connectionÑelease indication\n");

531 
rc
 = 
AS_NAS_RELEASE_IND
;

534  (
rc
);

535 
	}
}

540 
	$_¥o˚ss_ul_öfo_å™s„r_ªq
(c⁄° 
ul_öfo_å™s„r_ªq_t
* 
ªq
,

541 
ul_öfo_å™s„r_˙f_t
* 
˙f
,

542 
dl_öfo_å™s„r_öd_t
* 
öd
)

544 
rc
 = 
RETURNîr‹
;

545 
byãs
;

547 
ESM_msg
 
esm_msg
;

548 
	`mem£t
(&
esm_msg
, 0, (
ESM_msg
));

550 
	`¥ötf
("\nINFO\t: Received uplink informationÅransferÑequest: ");

551 
	`¥ötf
("S-TMSI = MMEcode <0x%.2x> M-TMSI <0x%.4x>\n",

552 
ªq
->
s_tmsi
.
MMEcode
,Ñeq->s_tmsi.
m_tmsi
);

554 c⁄° 
as_«s_öfo_t
* 
«s_msg
 = &
ªq
->
«sMsg
;

555 
	`¥ötf
("INFO\t: NAS mesßgê÷ígth = %d)\n", 
«s_msg
->
Àngth
);

556 
	`_dump_buf„r
(
«s_msg
->
d©a
,Ças_msg->
Àngth
);

559 
«s_mesßge_t
 
l3_msg
;

560 
emm_£curôy_c⁄ãxt_t
 *
£curôy
 = 
NULL
;

561 
rc
 = 
	`«s_mesßge_decode
((*)
«s_msg
->
d©a
, &
l3_msg
,Ças_msg->
Àngth
, 
£curôy
);

562 i‡(
rc
 < 0) {

564 
	`¥ötf
("ERROR\t: FaûedÅÿdecodêNAS mesßgê‘c=%d)", 
rc
);

565 
˙f
->
îrCode
 = 
AS_FAILURE
;

566  (
AS_UL_INFO_TRANSFER_CNF
);

569 i‡(
l3_msg
.
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 !
EPS_SESSION_MANAGEMENT_MESSAGE
) {

570 
byãs
 = 
	`_¥o˚ss_emm_msg
(&
l3_msg
.
∂aö
.
emm
);

572 
byãs
 = 
	`_¥o˚ss_esm_msg
(&
l3_msg
.
∂aö
.
esm
);

575 i‡(
byãs
 < 0) {

577 
˙f
->
îrCode
 = 
AS_FAILURE
;

578 
	`¥ötf
("\nINFO\t: ReturnÅransmission failure indication:ÉrrCode = %s (%d)\n",

579 (
˙f
->
îrCode
 !
AS_SUCCESS
)? "FAILURE" : "SUCCESS", cnf->errCode);

580  (
AS_UL_INFO_TRANSFER_CNF
);

582 i‡(
byãs
 > 0) {

584 
öd
->
«sMsg
.
d©a
 = (
Byã_t
*)
	`mÆloc
(
byãs
 * (Byte_t));

585 i‡(
öd
->
«sMsg
.
d©a
) {

586 
öd
->
«sMsg
.
Àngth
 = 
byãs
;

587 
	`°∫˝y
((*)
öd
->
«sMsg
.
d©a
,

588 (*)
_√tw‹k_simuœt‹_esm_buf„r
, 
byãs
);

591 
	`¥ötf
("INFO\t: Send downlink dataÅransfer indication\n");

592  (
AS_DL_INFO_TRANSFER_IND
);

596 
˙f
->
îrCode
 = 
AS_SUCCESS
;

597 
	`¥ötf
("\nINFO\t: Send uplink dataÅransfer confirm:ÉrrCode = %s (%d)\n",

598 (
˙f
->
îrCode
 !
AS_SUCCESS
)? "FAILURE" : "SUCCESS", cnf->errCode);

599  (
AS_UL_INFO_TRANSFER_CNF
);

601 
	}
}

609 
	$_¥o˚ss_emm_msg
(
EMM_msg
* 
msg
)

611 
byãs
 = -1;

613 
	`¥ötf
("INFO\t: EMM mesßgêid = 0x%.2x\n", 
msg
->
hódî
.
mesßge_ty≥
);

614 
	`¥ötf
("INFO\t: PrŸocﬁ Dis¸imö©‹ = %d\n", 
msg
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

615 
	`¥ötf
("INFO\t: Securôy Hódî Ty≥ = %d\n", 
msg
->
hódî
.
£curôy_hódî_ty≥
);

616 
	`¥ötf
("INFO\t: EMM message: ");

618 
msg
->
hódî
.
mesßge_ty≥
)

620 
ATTACH_COMPLETE
:

621 
byãs
 = 
	`_¥o˚ss_©èch_com∂ëe
(&
msg
->
©èch_com∂ëe
);

625 
	`¥ötf
("ERROR\t: EMM message 0x%x isÇot valid\n",

626 
msg
->
hódî
.
mesßge_ty≥
);

630  (
byãs
);

631 
	}
}

636 
	$_¥o˚ss_©èch_ªque°
(c⁄° 
©èch_ªque°_msg
* 
msg
, 
EMM_msg
* 
r•
,

637 c⁄° 
∂mn_t
 *
∂mn
)

639 
rc
 = 
RETURNîr‹
;

640 
byãs
 = 0;

642 
	`¥ötf
("Attach Request\n");

643 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

644 
	`¥ötf
("INFO\t:\tSecurôyHódîTy≥\t%d\n", 
msg
->
£curôyhódîty≥
);

645 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

646 
	`¥ötf
("INFO\t:\tEpsAâachTy≥\t\t%d\n", 
msg
->
ïßâachty≥
);

647 
	`¥ötf
("INFO\t:\tNasKeySetIdentifier\t= [%d][%d]\n",

648 
msg
->
«skey£tidítifõr
.
tsc
,

649 
msg
->
«skey£tidítifõr
.naskeysetidentifier);

651 
	`¥ötf
("INFO\t:\tEpsMobileIdentity\n");

652 i‡(
msg
->
ﬁdguti‹imsi
.
guti
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_GUTI
) {

653 c⁄° 
GutiEpsMobûeIdítôy_t
* 
guti
 = &
msg
->
ﬁdguti‹imsi
.guti;

654 
	`¥ötf
("INFO\t:\à oddeví\t\t%d\n", 
guti
->
oddeví
);

655 
	`¥ötf
("INFO\t:\àÅy≥ofidítôy\t%d (GUTI)\n", 
guti
->
ty≥ofidítôy
);

656 
	`¥ötf
("INFO\t:\t PLMN\t\t= %d%d%d %d%d%.x\n",

657 
guti
->
mccdigô1
, guti->
mccdigô2
, guti->
mccdigô3
,

658 
guti
->
mncdigô1
, guti->
mncdigô2
, guti->
mncdigô3
);

659 
	`¥ötf
("INFO\t:\à mmegroupid\t\t0x%.4x\n", 
guti
->
mmegroupid
);

660 
	`¥ötf
("INFO\t:\à mmecode\t\t0x%.2x\n", 
guti
->
mmecode
);

661 
	`¥ötf
("INFO\t:\à mtmsi\t\t0x%.8x\n", 
guti
->
mtmsi
);

662 } i‡(
msg
->
ﬁdguti‹imsi
.
imsi
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMSI
) {

663 c⁄° 
ImeiEpsMobûeIdítôy_t
* 
imsi
 = &
msg
->
ﬁdguti‹imsi
.imsi;

664 
	`¥ötf
("INFO\t:\à oddeví\t%d\n", 
imsi
->
oddeví
);

665 
	`¥ötf
("INFO\t:\àÅy≥ofidítôy\t%d (IMSI)\n", 
imsi
->
ty≥ofidítôy
);

666 
	`¥ötf
("INFO\t:\à digô1\t%d\n", 
imsi
->
digô1
);

667 
	`¥ötf
("INFO\t:\à digô2\t%d\n", 
imsi
->
digô2
);

668 
	`¥ötf
("INFO\t:\à digô3\t%d\n", 
imsi
->
digô3
);

669 
	`¥ötf
("INFO\t:\à digô4\t%d\n", 
imsi
->
digô4
);

670 
	`¥ötf
("INFO\t:\à digô5\t%d\n", 
imsi
->
digô5
);

671 
	`¥ötf
("INFO\t:\à digô6\t%d\n", 
imsi
->
digô6
);

672 
	`¥ötf
("INFO\t:\à digô7\t%d\n", 
imsi
->
digô7
);

673 
	`¥ötf
("INFO\t:\à digô8\t%d\n", 
imsi
->
digô8
);

674 
	`¥ötf
("INFO\t:\à digô9\t%d\n", 
imsi
->
digô9
);

675 
	`¥ötf
("INFO\t:\à digô10\t%d\n", 
imsi
->
digô10
);

676 
	`¥ötf
("INFO\t:\à digô11\t%d\n", 
imsi
->
digô11
);

677 
	`¥ötf
("INFO\t:\à digô12\t%d\n", 
imsi
->
digô12
);

678 
	`¥ötf
("INFO\t:\à digô13\t%d\n", 
imsi
->
digô13
);

679 
	`¥ötf
("INFO\t:\à digô14\t%d\n", 
imsi
->
digô14
);

680 
	`¥ötf
("INFO\t:\à digô15\t%d\n", 
imsi
->
digô15
);

681 } i‡(
msg
->
ﬁdguti‹imsi
.
imei
.
ty≥ofidítôy
 =
EPS_MOBILE_IDENTITY_IMEI
) {

682 c⁄° 
ImeiEpsMobûeIdítôy_t
* 
imei
 = &
msg
->
ﬁdguti‹imsi
.imei;

683 
	`¥ötf
("INFO\t:\à oddeví\t%d\n", 
imei
->
oddeví
);

684 
	`¥ötf
("INFO\t:\àÅy≥ofidítôy\t%d (IMEI)\n", 
imei
->
ty≥ofidítôy
);

685 
	`¥ötf
("INFO\t:\à digô1\t%d\n", 
imei
->
digô1
);

686 
	`¥ötf
("INFO\t:\à digô2\t%d\n", 
imei
->
digô2
);

687 
	`¥ötf
("INFO\t:\à digô3\t%d\n", 
imei
->
digô3
);

688 
	`¥ötf
("INFO\t:\à digô4\t%d\n", 
imei
->
digô4
);

689 
	`¥ötf
("INFO\t:\à digô5\t%d\n", 
imei
->
digô5
);

690 
	`¥ötf
("INFO\t:\à digô6\t%d\n", 
imei
->
digô6
);

691 
	`¥ötf
("INFO\t:\à digô7\t%d\n", 
imei
->
digô7
);

692 
	`¥ötf
("INFO\t:\à digô8\t%d\n", 
imei
->
digô8
);

693 
	`¥ötf
("INFO\t:\à digô9\t%d\n", 
imei
->
digô9
);

694 
	`¥ötf
("INFO\t:\à digô10\t%d\n", 
imei
->
digô10
);

695 
	`¥ötf
("INFO\t:\à digô11\t%d\n", 
imei
->
digô11
);

696 
	`¥ötf
("INFO\t:\à digô12\t%d\n", 
imei
->
digô12
);

697 
	`¥ötf
("INFO\t:\à digô13\t%d\n", 
imei
->
digô13
);

698 
	`¥ötf
("INFO\t:\à digô14\t%d\n", 
imei
->
digô14
);

699 
	`¥ötf
("INFO\t:\à digô15\t%d\n", 
imei
->
digô15
);

702 
	`¥ötf
("INFO\t:\tUeNetworkCapability\n");

703 
	`¥ötf
("INFO\t:\àÉó = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
ìa
);

704 
	`¥ötf
("INFO\t:\àÉü = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
eü
);

705 
	`¥ötf
("INFO\t:\à uó = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
uó
);

706 
	`¥ötf
("INFO\t:\à ucs2 = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
ucs2
);

707 
	`¥ötf
("INFO\t:\à uü = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
uü
);

708 
	`¥ötf
("INFO\t:\à s∑ª = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
•¨e
);

709 
	`¥ötf
("INFO\t:\à csfb = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
csfb
);

710 
	`¥ötf
("INFO\t:\àÜµ = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
Õp
);

711 
	`¥ötf
("INFO\t:\àÜc† = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
lcs
);

712 
	`¥ötf
("INFO\t:\à srvc¯%d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
§vcc
);

713 
	`¥ötf
("INFO\t:\àÇ‡ = %d\n", 
msg
->
uíëw‹kˇ∑bûôy
.
nf
);

715 
	`¥ötf
("INFO\t: ESM message container (length = %d)\n",

716 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
);

717 
	`_dump_buf„r
(
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
,

718 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
);

721 
ESM_msg
 
esm_msg
;

722 
rc
 = 
	`esm_msg_decode
(&
esm_msg
, 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
, msg->esmmesßgec⁄èöî.esmmesßgec⁄èöîc⁄ã¡s.
Àngth
);

724 i‡(
rc
 < 0) {

726 
	`¥ötf
("ERROR\t: FaûedÅÿdecodêESM mesßgê‘c=%d)", 
rc
);

727 
rc
 = 
RETURNîr‹
;

730 
	`¥ötf
("INFO\t: L3 ESM mesßgêid = 0x%.2x\n", 
esm_msg
.
hódî
.
mesßge_ty≥
);

731 
	`¥ötf
("INFO\t: PrŸocﬁ Dis¸imö©‹ = %d\n", 
esm_msg
.
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

732 
	`¥ötf
("INFO\t: EPS Bóª∏Idítôy = %d\n", 
esm_msg
.
hódî
.
ïs_bóªr_idítôy
);

733 
	`¥ötf
("INFO\t: Pro˚duª Tønß˘i⁄ Idítôy = %d\n", 
esm_msg
.
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
);

734 
	`¥ötf
("INFO\t: ESM message: ");

737 
esm_msg
.
hódî
.
mesßge_ty≥
)

739 
PDN_CONNECTIVITY_REQUEST
:

740 
rc
 = 
	`_¥o˚ss_pdn_c⁄√˘ivôy_ªque°
(&
esm_msg
.
pdn_c⁄√˘ivôy_ªque°
, &esm_msg);

744 
	`¥ötf
("ERROR\t: Received ESM message 0x%x isÇot valid\n",

745 
esm_msg
.
hódî
.
mesßge_ty≥
);

751 
	`mem£t
(
r•
, 0, (
EMM_msg
));

752 
r•
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 = 
EPS_MOBILITY_MANAGEMENT_MESSAGE
;

753 
r•
->
hódî
.
£curôy_hódî_ty≥
 = 
SECURITY_HEADER_TYPE_NOT_PROTECTED
;

755 
rc
)

757 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
:

758 
r•
->
hódî
.
mesßge_ty≥
 = 
ATTACH_ACCEPT
;

761 
PDN_CONNECTIVITY_REJECT
:

762 
r•
->
hódî
.
mesßge_ty≥
 = 
ATTACH_REJECT
;

766 i‡(
rc
 !
RETURNîr‹
) {

767 
	`¥ötf
("ERROR\t: ESM mesßgê0x%xÅÿbê£¡ i†nŸ vÆid\n", 
rc
);

773 i‡(
rc
 !
RETURNîr‹
) {

774 
byãs
 = 
	`esm_msg_ícode
(&
esm_msg
, 
_√tw‹k_simuœt‹_esm_buf„r
,

775 
NETWORK_SIMULATOR_ESM_BUFFER_SIZE
);

778 i‡(
r•
->
hódî
.
mesßge_ty≥
 !
ATTACH_REJECT
) {

780 
©èch_ac˚±_msg
* 
ac˚±
 = &
r•
->
©èch_ac˚±
;

781 
ac˚±
->
ïßâachªsu…
 = 
EPS_ATTACH_RESULT_EPS
;

782 
ac˚±
->
t3412vÆue
.
unô
 = 
GPRS_TIMER_UNIT_0S
;

783 
ac˚±
->
èûi°
.
ty≥oÊi°
 = 1;

785 
ac˚±
->
èûi°
.
numbîo„Àmíts
 = 4;

786 
ac˚±
->
èûi°
.
mccdigô1
 = 
∂mn
->
MCCdigô1
;

787 
ac˚±
->
èûi°
.
mccdigô2
 = 
∂mn
->
MCCdigô2
;

788 
ac˚±
->
èûi°
.
mccdigô3
 = 
∂mn
->
MCCdigô3
;

789 
ac˚±
->
èûi°
.
mncdigô1
 = 
∂mn
->
MNCdigô1
;

790 
ac˚±
->
èûi°
.
mncdigô2
 = 
∂mn
->
MNCdigô2
;

791 
ac˚±
->
èûi°
.
mncdigô3
 = 
∂mn
->
MNCdigô3
;

792 
ac˚±
->
èûi°
.
èc
 = 
DEFAULT_TAC
;

793 
ac˚±
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
 = 
byãs
;

794 
ac˚±
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
 = 
_√tw‹k_simuœt‹_esm_buf„r
;

798 
©èch_ªje˘_msg
* 
ªje˘
 = &
r•
->
©èch_ªje˘
;

799 i‡(
byãs
 > 0) {

800 
ªje˘
->
emmˇu£
 = 
EMM_CAUSE_ESM_FAILURE
;

801 
ªje˘
->
¥e£n˚mask
 = 
ATTACH_REJECT_ESM_MESSAGE_CONTAINER_PRESENT
;

802 
ªje˘
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
 = 
byãs
;

803 
ªje˘
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
 = 
_√tw‹k_simuœt‹_esm_buf„r
;

806 
ªje˘
->
emmˇu£
 = 
EMM_CAUSE_PROTOCOL_ERROR
;

821 
_©èch_ªque°_ªÀa£_cou¡î
 = 0;

822 i‡(
_©èch_ªque°_ªÀa£_cou¡î
 > 0) {

823 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

824 
_©èch_ªque°_ªÀa£_cou¡î
 -= 1;

826  (
RETURNîr‹
);

828  (
RETURNok
);

829 
	}
}

834 
	$_¥o˚ss_©èch_com∂ëe
(c⁄° 
©èch_com∂ëe_msg
* 
msg
)

836 
byãs
 = -1;

838 
	`¥ötf
("Attach Complete\n");

839 
	`¥ötf
("INFO\t: ESM message container (length = %d)\n",

840 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
);

841 
	`_dump_buf„r
(
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
,

842 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
Àngth
);

845 
ESM_msg
 
esm_msg
;

846 
byãs
 = 
	`esm_msg_decode
(&
esm_msg
, 
msg
->
esmmesßgec⁄èöî
.
esmmesßgec⁄èöîc⁄ã¡s
.
vÆue
, msg->esmmesßgec⁄èöî.esmmesßgec⁄èöîc⁄ã¡s.
Àngth
);

847 i‡(
byãs
 < 0) {

849 
	`¥ötf
("ERROR\t: Transmission failure\n");

850  (
byãs
);

853 
	`¥ötf
("INFO\t: ESM mesßgêid = 0x%.2x\n", 
esm_msg
.
hódî
.
mesßge_ty≥
);

854 
	`¥ötf
("INFO\t: PrŸocﬁ Dis¸imö©‹ = %d\n", 
esm_msg
.
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

855 
	`¥ötf
("INFO\t: EPS Bóª∏Idítôy = %d\n", 
esm_msg
.
hódî
.
ïs_bóªr_idítôy
);

856 
	`¥ötf
("INFO\t: Pro˚duª Tønß˘i⁄ Idítôy = %d\n", 
esm_msg
.
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
);

857 
	`¥ötf
("INFO\t: ESM message: ");

859 
esm_msg
.
hódî
.
mesßge_ty≥
)

861 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

862 
byãs
 = 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(

863 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
);

866 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

867 
byãs
 = 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(

868 &
esm_msg
.
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
);

872 
	`¥ötf
("ERROR\t: ESM mesßgê0x%x i†nŸ vÆid\n", 
esm_msg
.
hódî
.
mesßge_ty≥
);

876 
_©èch_com∂ëe_Áûuª_cou¡î
 = 0;

877 i‡(
_©èch_com∂ëe_Áûuª_cou¡î
 > 0) {

878 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

879 
_©èch_com∂ëe_Áûuª_cou¡î
 -= 1;

883  (
byãs
);

884 
	}
}

892 
	$_¥o˚ss_esm_msg
(
ESM_msg
* 
msg
)

894 
byãs
 = 0;

895 
rc
 = 
RETURNîr‹
;

897 
ESM_msg
 
r•
;

899 
	`¥ötf
("INFO\t: ESM mesßgêid = 0x%.2x\n", 
msg
->
hódî
.
mesßge_ty≥
);

900 
	`¥ötf
("INFO\t: PrŸocﬁ Dis¸imö©‹ = %d\n", 
msg
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
);

901 
	`¥ötf
("INFO\t: EPS Bóª∏Idítôy = %d\n", 
msg
->
hódî
.
ïs_bóªr_idítôy
);

902 
	`¥ötf
("INFO\t: Pro˚duª Tønß˘i⁄ Idítôy = %d\n", 
msg
->
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
);

903 
	`¥ötf
("INFO\t: ESM message: ");

905 
msg
->
hódî
.
mesßge_ty≥
)

907 
PDN_CONNECTIVITY_REQUEST
:

908 
rc
 = 
	`_¥o˚ss_pdn_c⁄√˘ivôy_ªque°
(&
msg
->
pdn_c⁄√˘ivôy_ªque°
,

909 &
r•
);

912 
PDN_DISCONNECT_REQUEST
:

913 
rc
 = 
	`_¥o˚ss_pdn_disc⁄√˘_ªque°
(&
msg
->
pdn_disc⁄√˘_ªque°
,

914 &
r•
);

917 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_ACCEPT
:

918 
rc
 = 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(

919 &
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
);

922 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REJECT
:

923 
rc
 = 
	`_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(

924 &
msg
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
);

927 
DEACTIVATE_EPS_BEARER_CONTEXT_ACCEPT
:

928 
rc
 = 
	`_¥o˚ss_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(

929 &
msg
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
);

933 
	`¥ötf
("ERROR\t: ESM message 0x%x isÇot valid\n",

934 
msg
->
hódî
.
mesßge_ty≥
);

938 i‡(
rc
 > 0) {

940 
byãs
 = 
	`esm_msg_ícode
(&
r•
, 
_√tw‹k_simuœt‹_esm_buf„r
,

941 
NETWORK_SIMULATOR_ESM_BUFFER_SIZE
);

942 
	`¥ötf
("\nINFO\t: Send NAS message %s (0x%x) (length = %d)\n",

943 (
r•
.
hódî
.
mesßge_ty≥
 =
PDN_CONNECTIVITY_REJECT
)? "PDN_CONNECTIVITY_REJECT" :

944 (
r•
.
hódî
.
mesßge_ty≥
 =
PDN_DISCONNECT_REJECT
)? "PDN_DISCONNECT_REJECT" :

945 (
r•
.
hódî
.
mesßge_ty≥
 =
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
)? "ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST" :

946 (
r•
.
hódî
.
mesßge_ty≥
 =
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
)? "DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST" :

947 "Unknow¿NAS mesßge", 
r•
.
hódî
.
mesßge_ty≥
, 
byãs
);

948 
	`_dump_buf„r
(
_√tw‹k_simuœt‹_esm_buf„r
, 
byãs
);

951  (
byãs
);

952 
	}
}

957 
	$_¥o˚ss_pdn_c⁄√˘ivôy_ªque°
(c⁄° 
pdn_c⁄√˘ivôy_ªque°_msg
* 
msg
, 
ESM_msg
* 
r•
)

959 
±i
 = 
msg
->
¥o˚duªå™ß˘i⁄idítôy
;

962 
O˘ëSåög
 
≠n
 = {0, 
NULL
};

963 i‡(
msg
->
¥e£n˚mask
 & 
PDN_CONNECTIVITY_REQUEST_ACCESS_POINT_NAME_PRESENT
) {

964 c⁄° 
O˘ëSåög
* 
≠n_vÆue
 = &
msg
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
;

965 
≠n
.
vÆue
 = (
uöt8_t
*)
	`mÆloc
(
≠n_vÆue
->
Àngth
 * (uint8_t));

966 i‡(
≠n
.
vÆue
 !
NULL
) {

967 
≠n
.
Àngth
 = 
≠n_vÆue
->length;

968 
≠n
.
vÆue
 = (
uöt8_t
*)
	`°∫˝y
((*Ô≤.vÆue, (*)
≠n_vÆue
->vÆue,á≤.
Àngth
);

969 
≠n
.
vÆue
[≠n.
Àngth
] = '\0';

973 
ªque°ed_pdn_ty≥
 = 
msg
->
pd¡y≥
;

975 
	`¥ötf
("PDN Connectivity Request\n");

976 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

977 
	`¥ötf
("INFO\t:\tEpsBóªrIdítôy\t\t%d\n", 
msg
->
ïsbóªridítôy
);

978 
	`¥ötf
("INFO\t:\tPro˚duªTønß˘i⁄Idítôy\t%d\n", 
msg
->
¥o˚duªå™ß˘i⁄idítôy
);

979 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

980 
	`¥ötf
("INFO\t:\tReque°Ty≥\t\t\t%d\n", 
msg
->
ªque°ty≥
);

981 
	`¥ötf
("INFO\t:\tPdnTy≥\t\t\t\t%d\n", 
msg
->
pd¡y≥
);

982 i‡(
≠n
.
Àngth
 > 0) {

983 
	`¥ötf
("INFO\t:\èc˚s•oöäame\t\t\t%s\n", 
≠n
.
vÆue
);

986 
	`mem£t
(
r•
, 0, (
ESM_msg
));

988 
r•
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

989 i‡(
_√tw‹k_simuœt‹_ebi
 > 
EPS_BEARER_IDENTITY_LAST
) {

990 
_√tw‹k_simuœt‹_ebi
 = 
EPS_BEARER_IDENTITY_FIRST
;

992 
r•
->
hódî
.
ïs_bóªr_idítôy
 = 
_√tw‹k_simuœt‹_ebi
++;

993 
r•
->
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
 = 
±i
;

995 
_pdn_c⁄√˘ivôy_ªje˘_cou¡î
 = 0;

996 i‡(
_pdn_c⁄√˘ivôy_ªje˘_cou¡î
 > 0) {

997 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

998 
_pdn_c⁄√˘ivôy_ªje˘_cou¡î
 -= 1;

1000 
pdn_c⁄√˘ivôy_ªje˘_msg
* 
ªje˘
 = &
r•
->
pdn_c⁄√˘ivôy_ªje˘
;

1001 
ªje˘
->
mesßgëy≥
 = 
PDN_CONNECTIVITY_REJECT
;

1002 
ªje˘
->
esmˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

1004 i‡–(
_√tw‹k_simuœt‹_ù_vîsi⁄
 !
NETWORK_IPV4V6
) &&

1005 (
_√tw‹k_simuœt‹_ù_vîsi⁄
 !
ªque°ed_pdn_ty≥
) ) {

1007 
pdn_c⁄√˘ivôy_ªje˘_msg
* 
ªje˘
 = &
r•
->
pdn_c⁄√˘ivôy_ªje˘
;

1008 
ªje˘
->
mesßgëy≥
 = 
PDN_CONNECTIVITY_REJECT
;

1009 i‡(
_√tw‹k_simuœt‹_ù_vîsi⁄
 !
NETWORK_IPV4
) {

1010 
ªje˘
->
esmˇu£
 = 
ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
;

1013 
ªje˘
->
esmˇu£
 = 
ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
;

1017 
pdn_ty≥
;

1018 
esm_ˇu£
;

1020 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
ªque°
 = &
r•
->
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªque°
;

1021 
ªque°
->
mesßgëy≥
 = 
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST
;

1022 
ªque°
->
ïsqos
.
qci
 = 3;

1023 
ªque°
->
ïsqos
.
bôR©esPª£¡
 = 1;

1024 
ªque°
->
ïsqos
.
bôR©es
.
maxBôR©eF‹UL
 = 
BIT_RATE_128K
;

1025 
ªque°
->
ïsqos
.
bôR©es
.
maxBôR©eF‹DL
 = 
BIT_RATE_1024K
;

1026 
ªque°
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹UL
 = 
BIT_RATE_64K
;

1027 
ªque°
->
ïsqos
.
bôR©es
.
gu¨BôR©eF‹DL
 = 
BIT_RATE_512K
;

1029 i‡(
≠n
.
Àngth
 > 0) {

1030 
ªque°
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
 = 
≠n
;

1031 
esm_ˇu£
 = 
	`_assign_pdn_addªss
(
ªque°ed_pdn_ty≥
, 
FALSE
, &
pdn_ty≥
,

1032 &
ªque°
->
pd«ddªss
.
pd«ddªssöf‹m©i⁄
);

1035 
ªque°
->
ac˚s•oöäame
.
ac˚s•oöäamevÆue
 = 
EURECOM_APN
;

1036 
esm_ˇu£
 = 
	`_assign_pdn_addªss
(
ªque°ed_pdn_ty≥
, 
TRUE
, &
pdn_ty≥
,

1037 &
ªque°
->
pd«ddªss
.
pd«ddªssöf‹m©i⁄
);

1039 
ªque°
->
pd«ddªss
.
pd¡y≥vÆue
 = 
pdn_ty≥
;

1040 i‡(
esm_ˇu£
 !
ESM_CAUSE_SUCCESS
) {

1042 
ªque°
->
¥e£n˚mask
 |
ACTIVATE_DEFAULT_EPS_BEARER_CONTEXT_REQUEST_ESM_CAUSE_PRESENT
;

1043 
ªque°
->
esmˇu£
 = 
esm_ˇu£
;

1048  (
r•
->
hódî
.
mesßge_ty≥
);

1049 
	}
}

1054 
	$_¥o˚ss_pdn_disc⁄√˘_ªque°
(c⁄° 
pdn_disc⁄√˘_ªque°_msg
* 
msg
, 
ESM_msg
* 
r•
)

1056 
±i
 = 
msg
->
¥o˚duªå™ß˘i⁄idítôy
;

1057 
ebi
 = 
msg
->
lökedïsbóªridítôy
;

1059 
	`¥ötf
("PDN Disconnect Request\n");

1060 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

1061 
	`¥ötf
("INFO\t:\tEpsBóªrIdítôy\t\t%d\n", 
msg
->
ïsbóªridítôy
);

1062 
	`¥ötf
("INFO\t:\tPro˚duªTønß˘i⁄Idítôy\t%d\n", 
msg
->
¥o˚duªå™ß˘i⁄idítôy
);

1063 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

1064 
	`¥ötf
("INFO\t:\tLökedEpsBóªrIdítôy\t%d\n", 
msg
->
lökedïsbóªridítôy
);

1066 
	`mem£t
(
r•
, 0, (
ESM_msg
));

1068 
r•
->
hódî
.
¥Ÿocﬁ_dis¸imö©‹
 = 
EPS_SESSION_MANAGEMENT_MESSAGE
;

1069 
r•
->
hódî
.
ïs_bóªr_idítôy
 = 
ebi
;

1070 
r•
->
hódî
.
¥o˚duª_å™ß˘i⁄_idítôy
 = 
±i
;

1072 
_pdn_disc⁄√˘_ªje˘_cou¡î
 = 0;

1073 i‡(
_pdn_disc⁄√˘_ªje˘_cou¡î
 > 0) {

1074 
	`¶ìp
(
	`ønd
()%
SLEEP_TIME
);

1075 
_pdn_disc⁄√˘_ªje˘_cou¡î
 -= 1;

1077 
pdn_disc⁄√˘_ªje˘_msg
* 
ªje˘
 = &
r•
->
pdn_disc⁄√˘_ªje˘
;

1078 
ªje˘
->
ïsbóªridítôy
 = 
EPS_BEARER_IDENTITY_UNASSIGNED
;

1079 
ªje˘
->
mesßgëy≥
 = 
PDN_DISCONNECT_REJECT
;

1080 
ªje˘
->
esmˇu£
 = 
ESM_CAUSE_PROTOCOL_ERROR
;

1084 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°_msg
* 
ªque°
 = &
r•
->
dó˘iv©e_ïs_bóªr_c⁄ãxt_ªque°
;

1085 
ªque°
->
mesßgëy≥
 = 
DEACTIVATE_EPS_BEARER_CONTEXT_REQUEST
;

1086 
ªque°
->
esmˇu£
 = 
ESM_CAUSE_REGULAR_DEACTIVATION
;

1089  (
r•
->
hódî
.
mesßge_ty≥
);

1090 
	}
}

1095 
	$_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±
(c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
)

1097 
	`¥ötf
("Activate Default EPS Bearer Context Accept\n");

1098 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

1099 
	`¥ötf
("INFO\t:\tEpsBóªrIdítôy\t\t%d\n", 
msg
->
ïsbóªridítôy
);

1100 
	`¥ötf
("INFO\t:\tPro˚duªTønß˘i⁄Idítôy\t%d\n", 
msg
->
¥o˚duªå™ß˘i⁄idítôy
);

1101 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

1104 
	}
}

1109 
	$_¥o˚ss_a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘
(c⁄° 
a˘iv©e_deÁu…_ïs_bóªr_c⁄ãxt_ªje˘_msg
* 
msg
)

1111 
	`¥ötf
("Activate Default EPS Bearer Context Reject\n");

1112 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

1113 
	`¥ötf
("INFO\t:\tEpsBóªrIdítôy\t\t%d\n", 
msg
->
ïsbóªridítôy
);

1114 
	`¥ötf
("INFO\t:\tPro˚duªTønß˘i⁄Idítôy\t%d\n", 
msg
->
¥o˚duªå™ß˘i⁄idítôy
);

1115 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

1116 
	`¥ötf
("INFO\t:\tESM cau£\t\t\t%d\n", 
msg
->
esmˇu£
);

1119 
	}
}

1124 
	$_¥o˚ss_dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±
(c⁄° 
dó˘iv©e_ïs_bóªr_c⁄ãxt_ac˚±_msg
* 
msg
)

1126 
	`¥ötf
("Deactivate EPS Bearer Context Accept\n");

1127 
	`¥ötf
("INFO\t:\tPrŸocﬁDis¸imö©‹\t\t%d\n", 
msg
->
¥Ÿocﬁdis¸imö©‹
);

1128 
	`¥ötf
("INFO\t:\tEpsBóªrIdítôy\t\t%d\n", 
msg
->
ïsbóªridítôy
);

1129 
	`¥ötf
("INFO\t:\tPro˚duªTønß˘i⁄Idítôy\t%d\n", 
msg
->
¥o˚duªå™ß˘i⁄idítôy
);

1130 
	`¥ötf
("INFO\t:\tMesßgeTy≥\t\t\t0x%.2x\n", 
msg
->
mesßgëy≥
);

1133 
	}
}

1138 
	$_assign_pdn_addªss
(
ue_pdn_ty≥
, 
is_öôül
, * 
pdn_ty≥
, 
O˘ëSåög
* 
pdn
)

1140 i‡(
_√tw‹k_simuœt‹_ù_vîsi⁄
 =
NETWORK_IPV4
) {

1142 *
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV4
;

1143 *
pdn
 = *
_√tw‹k_simuœt‹_pdn
[
NETWORK_IPV4
][
is_öôül
];

1144 i‡(
ue_pdn_ty≥
 =
PDN_TYPE_IPV4V6
) {

1146  (
ESM_CAUSE_PDN_TYPE_IPV4_ONLY_ALLOWED
);

1149 i‡(
_√tw‹k_simuœt‹_ù_vîsi⁄
 =
NETWORK_IPV6
) {

1151 *
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV6
;

1152 *
pdn
 = *
_√tw‹k_simuœt‹_pdn
[
NETWORK_IPV6
][
is_öôül
];

1153 i‡(
ue_pdn_ty≥
 =
PDN_TYPE_IPV4V6
) {

1155  (
ESM_CAUSE_PDN_TYPE_IPV6_ONLY_ALLOWED
);

1160 i‡(
ue_pdn_ty≥
 !
PDN_TYPE_IPV4
) {

1162 *
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV6
;

1163 *
pdn
 = *
_√tw‹k_simuœt‹_pdn
[
NETWORK_IPV6
][
is_öôül
];

1167 *
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV4
;

1168 *
pdn
 = *
_√tw‹k_simuœt‹_pdn
[
NETWORK_IPV4
][
is_öôül
];

1170 i‡(
ue_pdn_ty≥
 =
PDN_TYPE_IPV4V6
) {

1171 *
pdn_ty≥
 = 
PDN_VALUE_TYPE_IPV4V6
;

1172 *
pdn
 = *
_√tw‹k_simuœt‹_pdn
[
NETWORK_IPV4V6
][
is_öôül
];

1177  (
ESM_CAUSE_SUCCESS
);

1178 
	}
}

	@tst/user/user_parser.c

21 
	~"u£r_∑r£r.h
"

23 
	~"utû/∑r£r.h
"

38 
	mUSER_PARSER_HOST
,

39 
	mUSER_PARSER_PORT
,

40 
	mUSER_PARSER_DEVPATH
,

41 
	mUSER_PARSER_DEVATTR
,

42 
	mUSER_PARSER_NB_OPTIONS


54 
∑r£r_comm™d_löe_t
 
	gu£rP¨£rComm™dLöe
 = {

56 
USER_PARSER_NB_OPTIONS
,

58 {"-ho°", "<ho°>", "\tRemŸêho°«me\t\t", 
USER_PARSER_DEFAULT_REMOTE_HOSTNAME
},

59 {"-p‹t", "<p‹t>", "\tRemŸêp‹ànumbî\t", 
USER_PARSER_DEFAULT_REMOTE_PORT_NUMBER
},

83 
	$u£r_∑r£r_¥öt_ußge
()

85 
	`∑r£r_¥öt_ußge
(&
u£rP¨£rComm™dLöe
);

86 
	}
}

103 
	$u£r_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
)

105  
	`∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
, &
u£rP¨£rComm™dLöe
);

106 
	}
}

122 
	$u£r_∑r£r_gë_nb_›ti⁄s
()

124  
u£rP¨£rComm™dLöe
.
nb_›ti⁄s
;

125 
	}
}

140 c⁄° * 
	$u£r_∑r£r_gë_ho°
()

142  
u£rP¨£rComm™dLöe
.
›ti⁄s
[
USER_PARSER_HOST
].
pvÆue
;

143 
	}
}

158 c⁄° * 
	$u£r_∑r£r_gë_p‹t
()

160  
u£rP¨£rComm™dLöe
.
›ti⁄s
[
USER_PARSER_PORT
].
pvÆue
;

161 
	}
}

176 c⁄° * 
	$u£r_∑r£r_gë_dev∑th
()

178  
u£rP¨£rComm™dLöe
.
›ti⁄s
[
USER_PARSER_DEVPATH
].
pvÆue
;

179 
	}
}

194 c⁄° * 
	$u£r_∑r£r_gë_dev©å
()

196  
u£rP¨£rComm™dLöe
.
›ti⁄s
[
USER_PARSER_DEVATTR
].
pvÆue
;

197 
	}
}

	@tst/user/user_parser.h

21 #i‚de‡
__USER_PARSER_H__


22 
	#__USER_PARSER__H__


	)

29 
	#USER_PARSER_DEFAULT_REMOTE_HOSTNAME
 "loˇlho°"

	)

33 
	#USER_PARSER_DEFAULT_REMOTE_PORT_NUMBER
 "10000"

	)

47 
u£r_∑r£r_¥öt_ußge
();

48 
u£r_∑r£r_gë_›ti⁄s
(
¨gc
, c⁄° ** 
¨gv
);

50 
u£r_∑r£r_gë_nb_›ti⁄s
();

51 c⁄° * 
u£r_∑r£r_gë_ho°
();

52 c⁄° * 
u£r_∑r£r_gë_p‹t
();

53 c⁄° * 
u£r_∑r£r_gë_dev∑th
();

54 c⁄° * 
u£r_∑r£r_gë_dev©å
();

	@tst/user/user_simulator.c

22 
	~"u£r_∑r£r.h
"

24 
	~"ö˛ude/comm⁄Def.h
"

25 
	~"utû/sockë.h
"

26 
	~"utû/devi˚.h
"

28 
	~<°dio.h
>

29 
	~<î∫o.h
>

30 
	~<√tdb.h
>

31 
	~<˘y≥.h
>

32 
	~<°dlib.h
>

33 
	~<sig«l.h
>

34 
	~<°rög.h
>

35 
	~<±hªad.h
>

36 
	~<pﬁl.h
>

46 
	#USER_SIMULATOR_BUFFER_SIZE
 1024

	)

51 
	g_u£r_simuœt‹_£nd_buf„r
 [
USER_SIMULATOR_BUFFER_SIZE
];

56 
	g_u£r_simuœt‹_ªcv_buf„r
 [
USER_SIMULATOR_BUFFER_SIZE
];

63 * 
	mídpoöt
;

64 * (*
	m›í
) (, const *, const *);

65 (*
	mgëfd
)(const *);

66 
ssize_t
 (*
ªcv
Ë(*, *, 
	msize_t
);

67 
ssize_t
 (*
£nd
Ë(c⁄° *, c⁄° *, 
	msize_t
);

68 (*
	m˛o£
)(*);

69 } 
	g_u£r_simuœt‹_id
;

72 
	#USER_OPEN
(
a
, 
b
, 
c
Ë
_u£r_simuœt‹_id
.
	`›í
◊, b, c)

	)

73 
	#USER_GETFD
(Ë
_u£r_simuœt‹_id
.
	`gëfd
(_u£r_simuœt‹_id.
ídpoöt
)

	)

74 
	#USER_RECV
(
a
, 
b
Ë
_u£r_simuœt‹_id
.
	`ªcv
(_u£r_simuœt‹_id.
ídpoöt
,á, b)

	)

75 
	#USER_SEND
(
a
, 
b
Ë
_u£r_simuœt‹_id
.
	`£nd
(_u£r_simuœt‹_id.
ídpoöt
,á, b)

	)

76 
	#USER_CLOSE
(Ë
_u£r_simuœt‹_id
.
	`˛o£
(_u£r_simuœt‹_id.
ídpoöt
)

	)

78 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)());

79 
	`_sig«l_h™dÀr
(
sig«l_numbî
);

80 * 
	`_ª˚ive_thªad
(* 
¨g
);

87 
	$maö
 (
¨gc
, c⁄° * 
¨gv
[])

92 i‡–
	`u£r_∑r£r_gë_›ti⁄s
(
¨gc
, 
¨gv
Ë!
RETURNok
 )

94 
	`u£r_∑r£r_¥öt_ußge
();

95 
	`exô
(
EXIT_FAILURE
);

97 c⁄° * 
ho°
 = 
	`u£r_∑r£r_gë_ho°
();

98 c⁄° * 
p‹t
 = 
	`u£r_∑r£r_gë_p‹t
();

99 c⁄° * 
dev∑th
 = 
	`u£r_∑r£r_gë_dev∑th
();

100 c⁄° * 
dev©å
 = 
	`u£r_∑r£r_gë_dev©å
();

102 
	`¥ötf
("%s -host %s -port %s -dev %s -params %s\n",

103 
¨gv
[0], 
ho°
, 
p‹t
, 
dev∑th
, 
dev©å
);

108 i‡(
dev∑th
)

111 
_u£r_simuœt‹_id
.
›í
 = 
devi˚_›í
;

112 
_u£r_simuœt‹_id
.
gëfd
 = 
devi˚_gë_fd
;

113 
_u£r_simuœt‹_id
.
ªcv
 = 
devi˚_ªad
;

114 
_u£r_simuœt‹_id
.
£nd
 = 
devi˚_wrôe
;

115 
_u£r_simuœt‹_id
.
˛o£
 = 
devi˚_˛o£
;

118 
_u£r_simuœt‹_id
.
ídpoöt
 = 
	`USER_OPEN
(
DEVICE
, 
dev∑th
, 
dev©å
);

119 i‡(
_u£r_simuœt‹_id
.
ídpoöt
 =
NULL
) {

120 
	`≥º‹
("ERROR\t: FailedÅo open connectionÉndpoint");

121 
	`exô
(
EXIT_FAILURE
);

124 
	`¥ötf
("INFO\t: The User Simulator isÇow connectedÅo %s (%d)\n",

125 
dev∑th
, 
	`USER_GETFD
());

130 
_u£r_simuœt‹_id
.
›í
 = 
sockë_udp_›í
;

131 
_u£r_simuœt‹_id
.
gëfd
 = 
sockë_gë_fd
;

132 
_u£r_simuœt‹_id
.
ªcv
 = 
sockë_ªcv
;

133 
_u£r_simuœt‹_id
.
£nd
 = 
sockë_£nd
;

134 
_u£r_simuœt‹_id
.
˛o£
 = 
sockë_˛o£
;

137 
_u£r_simuœt‹_id
.
ídpoöt
 = 
	`USER_OPEN
(
SOCKET_CLIENT
, 
ho°
, 
p‹t
);

138 i‡(
_u£r_simuœt‹_id
.
ídpoöt
 =
NULL
) {

139 c⁄° * 
îr‹
 = ( (
î∫o
 < 0) ?

140 
	`gai_°ªº‹
(
î∫o
Ë: 
	`°ªº‹
(errno) );

141 
	`¥ötf
("ERROR\t: FaûedÅÿ›í c⁄√˘i⁄Éndpoöt: %s\n", 
îr‹
);

142 
	`exô
(
EXIT_FAILURE
);

145 
	`¥ötf
("INFO\t: The User Simulator isÇow connectedÅo %s/%s (%d)\n",

146 
ho°
, 
p‹t
, 
	`USER_GETFD
());

153 (Ë
	`_£t_sig«l_h™dÀr
(
SIGINT
, 
_sig«l_h™dÀr
);

154 (Ë
	`_£t_sig«l_h™dÀr
(
SIGTERM
, 
_sig«l_h™dÀr
);

159 
±hªad_©å_t
 
©å
;

160 
±hªad_t
 
thªad_id
;

161 
	`±hªad_©å_öô
(&
©å
);

162 
	`±hªad_©å_£tsc›e
(&
©å
, 
PTHREAD_SCOPE_SYSTEM
);

163 
	`±hªad_©å_£tdëach°©e
(&
©å
, 
PTHREAD_CREATE_DETACHED
);

164 
rc
 = 
	`±hªad_¸óã
 (&
thªad_id
, &
©å
, 
_ª˚ive_thªad
, 
NULL
);

165 i‡(
rc
 != 0) {

166 
	`≥º‹
("ERROR\t:Öthread_create() failed");

167 
	`USER_CLOSE
();

168 
	`exô
(
EXIT_FAILURE
);

174 
TRUE
)

176 
c
;

177 
Àn
;

180 
	`¥ötf
("AT command (qÅo quit) > ");

181 
c
 = 
	`gëch¨
();

182 i‡(
c
 == 'q') ;

183 i‡(
c
 == '\n') ;

185 
Àn
 = 0;

186  (
Àn
 < 
USER_SIMULATOR_BUFFER_SIZE
 - 1Ë&& (
c
 != '\n') ) {

187 i‡(!
	`is•a˚
(
c
)) {

188 
_u£r_simuœt‹_£nd_buf„r
[
Àn
++] = 
c
;

190 
c
 = 
	`gëch¨
();

192 
_u£r_simuœt‹_£nd_buf„r
[
Àn
++] = '\r';

193 
_u£r_simuœt‹_£nd_buf„r
[
Àn
] = '\0';

196 
sbyãs
 = 
	`USER_SEND
(
_u£r_simuœt‹_£nd_buf„r
, 
Àn
);

197 i‡(
sbyãs
 =
RETURNîr‹
) {

198 
	`≥º‹
("ERROR\t: FailedÅo send dataÅoÅhe NAS sublayer");

204 c⁄° * 
pbuf„r
 = 
_u£r_simuœt‹_£nd_buf„r
;

205 *
pbuf„r
) {

206 
sbyãs
 = 
	`USER_SEND
(
pbuf„r
++, 1);

207 i‡(
sbyãs
 =
RETURNîr‹
) {

208 
	`≥º‹
("ERROR\t: FailedÅo send dataÅoÅhe NAS sublayer");

211 ()
	`pﬁl
(0, 0, 10);

215 ()
	`pﬁl
(0, 0, 100);

221 
	`¥ötf
("INFO\t: Closög u£∏ídpoöàdes¸ùt‹ %d\n", 
	`USER_GETFD
());

222 
	`USER_CLOSE
();

224 
	`¥ötf
("INFO\t: User simulatorÉxited\n");

225 
	`exô
(
EXIT_SUCCESS
);

226 
	}
}

235 
_£t_sig«l_h™dÀr
(
sig«l
, (
h™dÀr
)())

237 
siga˘i⁄
 
a˘
;

240 (Ë
	`mem£t
 (&
a˘
, 0,  (act));

241 (Ë
	`sigfûl£t
 (&
a˘
.
ß_mask
);

242 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGHUP
);

243 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGINT
);

244 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTERM
);

245 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGILL
);

246 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGTRAP
);

247 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGIOT
);

248 #i‚de‡
LINUX


249 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGEMT
);

251 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGFPE
);

252 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGBUS
);

253 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSEGV
);

254 (Ë
	`sigdñ£t
 (&
a˘
.
ß_mask
, 
SIGSYS
);

257 
a˘
.
ß_h™dÀr
 = 
h™dÀr
;

258 i‡–
	`siga˘i⁄
 (
sig«l
, &
a˘
, 0) < 0 ) {

259  
RETURNîr‹
;

262  
RETURNok
;

263 
	}
}

268 
	$_sig«l_h™dÀr
(
sig«l_numbî
)

270 
	`¥ötf
("\nWARNING\t: Sig«»%dÑe˚ived\n", 
sig«l_numbî
);

271 
	`¥ötf
("INFO\t: Closög u£∏sockë %d\n", 
	`USER_GETFD
());

272 
	`USER_CLOSE
();

273 
	`¥ötf
("INFO\t: User simulatorÉxited\n");

274 
	`exô
(
EXIT_SUCCESS
);

275 
	}
}

280 * 
	$_ª˚ive_thªad
(* 
¨g
)

282 
TRUE
)

285 
rbyãs
 = 
	`USER_RECV
(
_u£r_simuœt‹_ªcv_buf„r
,

286 
USER_SIMULATOR_BUFFER_SIZE
);

287 i‡(
rbyãs
 != 0) {

288 i‡(
rbyãs
 =
RETURNîr‹
) {

289 
	`≥º‹
("ERROR\t: FailedÅoÑeceive data fromÅhe NAS sublayer");

292 
_u£r_simuœt‹_ªcv_buf„r
[
rbyãs
] = '\0';

295 
	`¥ötf
("%s\n", 
_u£r_simuœt‹_ªcv_buf„r
);

299  (
NULL
);

300 
	}
}

	@/usr/include/arpa/inet.h

19 #i‚de‡
_ARPA_INET_H


20 
	#_ARPA_INET_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<√töë/ö.h
>

26 #i‚de‡
__sockÀn_t_deföed


27 
__sockÀn_t
 
	tsockÀn_t
;

28 
	#__sockÀn_t_deföed


	)

31 
__BEGIN_DECLS


35 
ö_addr_t
 
	$öë_addr
 (
__c⁄°
 *
__˝
Ë
__THROW
;

38 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

42 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

43 
__THROW
;

46 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

50 
ö_addr_t
 
	$öë_√tw‹k
 (
__c⁄°
 *
__˝
Ë
__THROW
;

54 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

59 
	$öë_±⁄
 (
__af
, 
__c⁄°
 *
__ª°ri˘
 
__˝
,

60 *
__ª°ri˘
 
__buf
Ë
__THROW
;

65 
__c⁄°
 *
	$öë_¡›
 (
__af
, 
__c⁄°
 *
__ª°ri˘
 
__˝
,

66 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

67 
__THROW
;

71 #ifde‡
__USE_MISC


74 
	$öë_©⁄
 (
__c⁄°
 *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

78 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

83 *
	$öë_√t_¡›
 (
__af
, 
__c⁄°
 *
__˝
, 
__bôs
,

84 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

89 
	$öë_√t_±⁄
 (
__af
, 
__c⁄°
 *
__˝
,

90 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

95 
	$öë_nßp_addr
 (
__c⁄°
 *
__˝
,

96 *
__buf
, 
__Àn
Ë
__THROW
;

100 *
	$öë_nßp_¡ﬂ
 (
__Àn
, 
__c⁄°
 *
__˝
,

101 *
__buf
Ë
__THROW
;

104 
__END_DECLS


	@/usr/include/assert.h

24 #ifdef 
_ASSERT_H


26 #unde‡
_ASSERT_H


27 #unde‡
as£π


28 #unde‡
__ASSERT_VOID_CAST


30 #ifdef 
__USE_GNU


31 #unde‡
as£π_≥º‹


36 
	#_ASSERT_H
 1

	)

37 
	~<„©uªs.h
>

39 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

40 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

42 
	#__ASSERT_VOID_CAST
 ()

	)

50 #ifdef 
NDEBUG


52 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

60 #ifdef 
__USE_GNU


61 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

66 #i‚de‡
_ASSERT_H_DECLS


67 
	#_ASSERT_H_DECLS


	)

68 
__BEGIN_DECLS


71 
	$__as£π_Áû
 (
__c⁄°
 *
__as£πi⁄
, __c⁄° *
__fûe
,

72 
__löe
, 
__c⁄°
 *
__fun˘i⁄
)

73 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

76 
	$__as£π_≥º‹_Áû
 (
__î∫um
, 
__c⁄°
 *
__fûe
,

77 
__löe
,

78 
__c⁄°
 *
__fun˘i⁄
)

79 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

84 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

85 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

88 
__END_DECLS


91 
	#as£π
(
ex¥
) \

92 ((
ex¥
) \

93 ? 
	`__ASSERT_VOID_CAST
 (0) \

94 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ifdef 
__USE_GNU


97 
	#as£π_≥º‹
(
î∫um
) \

98 (!(
î∫um
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

108 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

109 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

111 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

112 
	#__ASSERT_FUNCTION
 
__func__


	)

114 
	#__ASSERT_FUNCTION
 ((
__c⁄°
 *Ë0)

	)

	@/usr/include/ctype.h

24 #i‚def 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 
	g__BEGIN_DECLS


32 #i‚de‡
_ISbô


41 
	~<ídün.h
>

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

45 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

50 
	m_ISuµî
 = 
_ISbô
 (0),

51 
	m_ISlowî
 = 
_ISbô
 (1),

52 
	m_ISÆpha
 = 
_ISbô
 (2),

53 
	m_ISdigô
 = 
_ISbô
 (3),

54 
	m_ISxdigô
 = 
_ISbô
 (4),

55 
	m_IS•a˚
 = 
_ISbô
 (5),

56 
	m_IS¥öt
 = 
_ISbô
 (6),

57 
	m_ISgøph
 = 
_ISbô
 (7),

58 
	m_ISbœnk
 = 
_ISbô
 (8),

59 
	m_IS˙ål
 = 
_ISbô
 (9),

60 
	m_ISpun˘
 = 
_ISbô
 (10),

61 
	m_ISÆnum
 = 
_ISbô
 (11)

81 
__c⁄°
 **
	$__˘y≥_b_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

83 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

85 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

86 
__THROW
 
	`__©åibuã__
 ((
__c⁄°
));

89 #i‚de‡
__˝lu•lus


90 
	#__is˘y≥
(
c
, 
ty≥
) \

91 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

92 #ñi‡
deföed
 
__USE_EXTERN_INLINES


93 
	#__is˘y≥_f
(
ty≥
) \

94 
__exã∫_ölöe
 \

95 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

97  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

98 
	}

	)
}

101 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

102 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

104 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

106 
__BEGIN_NAMESPACE_STD


112 
__ex˘y≥
 (
iß um
);

113 
__ex˘y≥
 (
ißÕha
);

114 
__ex˘y≥
 (
is˙ål
);

115 
__ex˘y≥
 (
isdigô
);

116 
__ex˘y≥
 (
i¶owî
);

117 
__ex˘y≥
 (
isgøph
);

118 
__ex˘y≥
 (
i•röt
);

119 
__ex˘y≥
 (
i•un˘
);

120 
__ex˘y≥
 (
is•a˚
);

121 
__ex˘y≥
 (
isuµî
);

122 
__ex˘y≥
 (
isxdigô
);

126 
	$tﬁowî
 (
__c
Ë
__THROW
;

129 
	$touµî
 (
__c
Ë
__THROW
;

131 
__END_NAMESPACE_STD


135 #ifdef 
__USE_ISOC99


136 
__BEGIN_NAMESPACE_C99


138 
	`__ex˘y≥
 (
isbœnk
);

140 
__END_NAMESPACE_C99


143 #ifde‡
__USE_GNU


145 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

148 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


152 
	$ißscii
 (
__c
Ë
__THROW
;

156 
	$tﬂscii
 (
__c
Ë
__THROW
;

160 
	`__ex˘y≥
 (
_touµî
);

161 
	`__ex˘y≥
 (
_tﬁowî
);

165 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

166 (
__exãnsi⁄__
 \

167 ({ 
__ªs
; \

168 i‡( (
c
) > 1) \

170 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

172 
__c
 = (
c
); \

173 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

176 
__ªs
 = 
f
 
¨gs
; \

179 
__ªs
 = (
a
)[(Ë(
c
)]; \

180 
__ªs
; 
	}
}))

	)

182 #i‡!
deföed
 
__NO_CTYPE


183 #ifde‡
__is˘y≥_f


184 
	$__is˘y≥_f
 (
Ænum
)

185 
	$__is˘y≥_f
 (
Æpha
)

186 
	$__is˘y≥_f
 (
˙ål
)

187 
	$__is˘y≥_f
 (
digô
)

188 
	$__is˘y≥_f
 (
lowî
)

189 
	$__is˘y≥_f
 (
gøph
)

190 
	$__is˘y≥_f
 (
¥öt
)

191 
	$__is˘y≥_f
 (
pun˘
)

192 
	$__is˘y≥_f
 (
•a˚
)

193 
	$__is˘y≥_f
 (
uµî
)

194 
	$__is˘y≥_f
 (
xdigô
)

195 #ifde‡
__USE_ISOC99


196 
	$__is˘y≥_f
 (
bœnk
)

198 #ñi‡
deföed
 
__is˘y≥


199 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

200 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

201 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

202 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

203 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

204 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

205 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

206 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

207 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

208 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

209 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

210 #ifde‡
__USE_ISOC99


211 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

215 #ifde‡
__USE_EXTERN_INLINES


216 
__exã∫_ölöe
 

217 
	`__NTH
 (
	$tﬁowî
 (
__c
))

219  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

220 
	}
}

222 
__exã∫_ölöe
 

223 
__NTH
 (
	$touµî
 (
__c
))

225  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

226 
	}
}

229 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


230 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

231 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

234 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


235 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

236 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

238 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

239 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

245 #ifde‡
__USE_XOPEN2K8


259 
	~<xloˇÀ.h
>

263 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

264 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

266 
	#__ex˘y≥_l
(
«me
) \

267 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

273 
__ex˘y≥_l
 (
iß um_l
);

274 
__ex˘y≥_l
 (
ißÕha_l
);

275 
__ex˘y≥_l
 (
is˙ål_l
);

276 
__ex˘y≥_l
 (
isdigô_l
);

277 
__ex˘y≥_l
 (
i¶owî_l
);

278 
__ex˘y≥_l
 (
isgøph_l
);

279 
__ex˘y≥_l
 (
i•röt_l
);

280 
__ex˘y≥_l
 (
i•un˘_l
);

281 
__ex˘y≥_l
 (
is•a˚_l
);

282 
__ex˘y≥_l
 (
isuµî_l
);

283 
__ex˘y≥_l
 (
isxdigô_l
);

285 
__ex˘y≥_l
 (
isbœnk_l
);

289 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

290 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

293 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

294 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

296 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


297 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

298 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

299 
	#__touµî_l
(
c
, 
loˇÀ
) \

300 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

301 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

302 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

306 #i‚de‡
__NO_CTYPE


307 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

308 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

309 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

310 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

311 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

312 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

313 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

314 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

315 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

316 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

317 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

319 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

321 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


322 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

323 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

326 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

327 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

328 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

329 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

330 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

331 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

332 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

333 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

334 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

335 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

336 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

338 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

340 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


341 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

342 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

349 
__END_DECLS


	@/usr/include/errno.h

23 #i‚def 
_ERRNO_H


27 #i‚def 
__√ed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<„©uªs.h
>

32 
	g__BEGIN_DECLS


36 
	~<bôs/î∫o.h
>

37 #unde‡
__√ed_Em©h


39 #ifdef 
_ERRNO_H


46 #i‚def 
î∫o


47 
î∫o
;

50 #ifde‡
__USE_GNU


55 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

59 
	g__END_DECLS


67 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


68 #i‚de‡
__îr‹_t_deföed


69 
	tîr‹_t
;

70 
	#__îr‹_t_deföed
 1

	)

72 #unde‡
__√ed_îr‹_t


	@/usr/include/fcntl.h

24 #i‚def 
_FCNTL_H


25 
	#_FCNTL_H
 1

	)

27 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


34 
	~<bôs/f˙é.h
>

37 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


38 
	~<bôs/ty≥s.h
>

39 
	#__√ed_time•ec


	)

40 
	~<time.h
>

41 
	~<bôs/°©.h
>

43 
	#S_IFMT
 
__S_IFMT


	)

44 
	#S_IFDIR
 
__S_IFDIR


	)

45 
	#S_IFCHR
 
__S_IFCHR


	)

46 
	#S_IFBLK
 
__S_IFBLK


	)

47 
	#S_IFREG
 
__S_IFREG


	)

48 #ifde‡
__S_IFIFO


49 
	#S_IFIFO
 
__S_IFIFO


	)

51 #ifde‡
__S_IFLNK


52 
	#S_IFLNK
 
__S_IFLNK


	)

54 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


55 
	#S_IFSOCK
 
__S_IFSOCK


	)

60 
	#S_ISUID
 
__S_ISUID


	)

61 
	#S_ISGID
 
__S_ISGID


	)

63 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


65 
	#S_ISVTX
 
__S_ISVTX


	)

68 
	#S_IRUSR
 
__S_IREAD


	)

69 
	#S_IWUSR
 
__S_IWRITE


	)

70 
	#S_IXUSR
 
__S_IEXEC


	)

72 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

74 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

75 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

76 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

78 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

80 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

81 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

82 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

84 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

87 #ifdef 
__USE_MISC


88 #i‚de‡
R_OK


91 
	#R_OK
 4

	)

92 
	#W_OK
 2

	)

93 
	#X_OK
 1

	)

94 
	#F_OK
 0

	)

99 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


100 
	#SEEK_SET
 0

	)

101 
	#SEEK_CUR
 1

	)

102 
	#SEEK_END
 2

	)

110 
f˙é
 (
__fd
, 
__cmd
, ...);

118 #i‚de‡
__USE_FILE_OFFSET64


119 
	$›í
 (
__c⁄°
 *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

121 #ifde‡
__REDIRECT


122 
	`__REDIRECT
 (
›í
, (
__c⁄°
 *
__fûe
, 
__oÊag
, ...), 
›í64
)

123 
	`__n⁄nuŒ
 ((1));

125 
	#›í
 
›í64


	)

128 #ifde‡
__USE_LARGEFILE64


129 
	$›í64
 (
__c⁄°
 *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

132 #ifde‡
__USE_ATFILE


142 #i‚de‡
__USE_FILE_OFFSET64


143 
	$›í©
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__oÊag
, ...)

144 
	`__n⁄nuŒ
 ((2));

146 #ifde‡
__REDIRECT


147 
	`__REDIRECT
 (
›í©
, (
__fd
, 
__c⁄°
 *
__fûe
, 
__oÊag
,

148 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

150 
	#›í©
 
›í©64


	)

153 #ifde‡
__USE_LARGEFILE64


154 
	$›í©64
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__oÊag
, ...)

155 
	`__n⁄nuŒ
 ((2));

164 #i‚de‡
__USE_FILE_OFFSET64


165 
	$¸ót
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

167 #ifde‡
__REDIRECT


168 
	`__REDIRECT
 (
¸ót
, (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
),

169 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

171 
	#¸ót
 
¸ót64


	)

174 #ifde‡
__USE_LARGEFILE64


175 
	$¸ót64
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

178 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

179 && !
deföed
 
__USE_POSIX
))

188 
	#F_ULOCK
 0

	)

189 
	#F_LOCK
 1

	)

190 
	#F_TLOCK
 2

	)

191 
	#F_TEST
 3

	)

193 #i‚de‡
__USE_FILE_OFFSET64


194 
	`lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
);

196 #ifde‡
__REDIRECT


197 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

199 
	#lockf
 
lockf64


	)

202 #ifde‡
__USE_LARGEFILE64


203 
	`lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
);

207 #ifde‡
__USE_XOPEN2K


210 #i‚de‡
__USE_FILE_OFFSET64


211 
	$posix_Ádvi£
 (
__fd
, 
__off_t
 
__off£t
, __off_à
__Àn
,

212 
__advi£
Ë
__THROW
;

214 #ifde‡
__REDIRECT_NTH


215 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

216 
__off64_t
 
__Àn
, 
__advi£
),

217 
posix_Ádvi£64
);

219 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

222 #ifde‡
__USE_LARGEFILE64


223 
	$posix_Ádvi£64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__Àn
,

224 
__advi£
Ë
__THROW
;

232 #i‚de‡
__USE_FILE_OFFSET64


233 
	`posix_ÁŒoˇã
 (
__fd
, 
__off_t
 
__off£t
, __off_à
__Àn
);

235 #ifde‡
__REDIRECT


236 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

237 
__off64_t
 
__Àn
),

238 
posix_ÁŒoˇã64
);

240 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

243 #ifde‡
__USE_LARGEFILE64


244 
	`posix_ÁŒoˇã64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__Àn
);

250 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe
 \

251 && 
deföed
 
__va_¨g_∑ck_Àn


252 
	~<bôs/f˙é2.h
>

255 
__END_DECLS


	@/usr/include/inttypes.h

23 #i‚de‡
_INTTYPES_H


24 
	#_INTTYPES_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<°döt.h
>

31 #i‚de‡
____gwch¨_t_deföed


32 #ifde‡
__˝lu•lus


33 
	#__gwch¨_t
 
wch¨_t


	)

34 #ñi‡
deföed
 
__WCHAR_TYPE__


35 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

37 
	#__√ed_wch¨_t


	)

38 
	~<°ddef.h
>

39 
wch¨_t
 
	t__gwch¨_t
;

41 
	#____gwch¨_t_deföed
 1

	)

47 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_FORMAT_MACROS


49 #i‡
__WORDSIZE
 == 64

50 
	#__PRI64_PREFIX
 "l"

	)

51 
	#__PRIPTR_PREFIX
 "l"

	)

53 
	#__PRI64_PREFIX
 "Œ"

	)

54 
	#__PRIPTR_PREFIX


	)

60 
	#PRId8
 "d"

	)

61 
	#PRId16
 "d"

	)

62 
	#PRId32
 "d"

	)

63 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

65 
	#PRIdLEAST8
 "d"

	)

66 
	#PRIdLEAST16
 "d"

	)

67 
	#PRIdLEAST32
 "d"

	)

68 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIdFAST8
 "d"

	)

71 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

72 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

73 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

76 
	#PRIi8
 "i"

	)

77 
	#PRIi16
 "i"

	)

78 
	#PRIi32
 "i"

	)

79 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

81 
	#PRIiLEAST8
 "i"

	)

82 
	#PRIiLEAST16
 "i"

	)

83 
	#PRIiLEAST32
 "i"

	)

84 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIiFAST8
 "i"

	)

87 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

88 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

89 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

92 
	#PRIo8
 "o"

	)

93 
	#PRIo16
 "o"

	)

94 
	#PRIo32
 "o"

	)

95 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

97 
	#PRIoLEAST8
 "o"

	)

98 
	#PRIoLEAST16
 "o"

	)

99 
	#PRIoLEAST32
 "o"

	)

100 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIoFAST8
 "o"

	)

103 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

104 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

105 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

108 
	#PRIu8
 "u"

	)

109 
	#PRIu16
 "u"

	)

110 
	#PRIu32
 "u"

	)

111 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

113 
	#PRIuLEAST8
 "u"

	)

114 
	#PRIuLEAST16
 "u"

	)

115 
	#PRIuLEAST32
 "u"

	)

116 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIuFAST8
 "u"

	)

119 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

120 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

121 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

124 
	#PRIx8
 "x"

	)

125 
	#PRIx16
 "x"

	)

126 
	#PRIx32
 "x"

	)

127 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

129 
	#PRIxLEAST8
 "x"

	)

130 
	#PRIxLEAST16
 "x"

	)

131 
	#PRIxLEAST32
 "x"

	)

132 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIxFAST8
 "x"

	)

135 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

136 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

137 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

140 
	#PRIX8
 "X"

	)

141 
	#PRIX16
 "X"

	)

142 
	#PRIX32
 "X"

	)

143 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

145 
	#PRIXLEAST8
 "X"

	)

146 
	#PRIXLEAST16
 "X"

	)

147 
	#PRIXLEAST32
 "X"

	)

148 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

150 
	#PRIXFAST8
 "X"

	)

151 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

152 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

153 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

157 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

158 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

159 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

160 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

161 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

162 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

166 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

167 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

168 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

169 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

170 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

171 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

177 
	#SCNd8
 "hhd"

	)

178 
	#SCNd16
 "hd"

	)

179 
	#SCNd32
 "d"

	)

180 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

182 
	#SCNdLEAST8
 "hhd"

	)

183 
	#SCNdLEAST16
 "hd"

	)

184 
	#SCNdLEAST32
 "d"

	)

185 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNdFAST8
 "hhd"

	)

188 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

189 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

190 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

193 
	#SCNi8
 "hhi"

	)

194 
	#SCNi16
 "hi"

	)

195 
	#SCNi32
 "i"

	)

196 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

198 
	#SCNiLEAST8
 "hhi"

	)

199 
	#SCNiLEAST16
 "hi"

	)

200 
	#SCNiLEAST32
 "i"

	)

201 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNiFAST8
 "hhi"

	)

204 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

205 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

206 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

209 
	#SCNu8
 "hhu"

	)

210 
	#SCNu16
 "hu"

	)

211 
	#SCNu32
 "u"

	)

212 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

214 
	#SCNuLEAST8
 "hhu"

	)

215 
	#SCNuLEAST16
 "hu"

	)

216 
	#SCNuLEAST32
 "u"

	)

217 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNuFAST8
 "hhu"

	)

220 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

221 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

222 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

225 
	#SCNo8
 "hho"

	)

226 
	#SCNo16
 "ho"

	)

227 
	#SCNo32
 "o"

	)

228 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

230 
	#SCNoLEAST8
 "hho"

	)

231 
	#SCNoLEAST16
 "ho"

	)

232 
	#SCNoLEAST32
 "o"

	)

233 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNoFAST8
 "hho"

	)

236 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

237 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

238 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

241 
	#SCNx8
 "hhx"

	)

242 
	#SCNx16
 "hx"

	)

243 
	#SCNx32
 "x"

	)

244 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

246 
	#SCNxLEAST8
 "hhx"

	)

247 
	#SCNxLEAST16
 "hx"

	)

248 
	#SCNxLEAST32
 "x"

	)

249 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

251 
	#SCNxFAST8
 "hhx"

	)

252 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

253 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

254 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

258 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

259 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

260 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

261 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

262 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

265 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

266 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

267 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

268 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

269 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

274 
	g__BEGIN_DECLS


276 #i‡
__WORDSIZE
 == 64

281 
	mquŸ
;

282 
	mªm
;

283 } 
	timaxdiv_t
;

290 
	mquŸ
;

291 
	mªm
;

292 } 
	timaxdiv_t
;

298 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

301 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

302 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

305 
ötmax_t
 
	$°πoimax
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

306 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

309 
uötmax_t
 
	$°πoumax
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

310 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

313 
ötmax_t
 
	$wc°oimax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

314 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

315 
__THROW
;

318 
uötmax_t
 
	$wc°oumax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

319 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

320 
__THROW
;

322 #ifde‡
__USE_EXTERN_INLINES


324 #i‡
__WORDSIZE
 == 64

326 
	$__°πﬁ_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

327 **
__ª°ri˘
 
__íd±r
,

328 
__ba£
, 
__group
)

329 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

331 
__exã∫_ölöe
 
ötmax_t


332 
	`__NTH
 (
	$°πoimax
 (
__c⁄°
 *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

333 
ba£
))

335  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

336 
	}
}

338 
	$__°πoul_öã∫Æ
 (
__c⁄°
 *

339 
__ª°ri˘
 
__≈å
,

340 ** 
__ª°ri˘
 
__íd±r
,

341 
__ba£
, 
__group
)

342 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

344 
__exã∫_ölöe
 
uötmax_t


345 
	`__NTH
 (
	$°πoumax
 (
__c⁄°
 *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

346 
ba£
))

348  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

349 
	}
}

351 
	$__wc°ﬁ_öã∫Æ
 (
__c⁄°
 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

352 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

353 
__ba£
, 
__group
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

356 
__exã∫_ölöe
 
ötmax_t


357 
	`__NTH
 (
	$wc°oimax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

358 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

360  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

361 
	}
}

363 
	$__wc°oul_öã∫Æ
 (
__c⁄°
 
__gwch¨_t
 *

364 
__ª°ri˘
 
__≈å
,

365 
__gwch¨_t
 **

366 
__ª°ri˘
 
__íd±r
,

367 
__ba£
, 
__group
)

368 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

370 
__exã∫_ölöe
 
uötmax_t


371 
	`__NTH
 (
	$wc°oumax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

372 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

374  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

375 
	}
}

379 
__exãnsi⁄__


380 
	$__°πﬁl_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

381 **
__ª°ri˘
 
__íd±r
,

382 
__ba£
, 
__group
)

383 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

385 
__exã∫_ölöe
 
ötmax_t


386 
	`__NTH
 (
	$°πoimax
 (
__c⁄°
 *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

387 
ba£
))

389  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

390 
	}
}

392 
__exãnsi⁄__


393 
	$__°πouŒ_öã∫Æ
 (
__c⁄°
 *

394 
__ª°ri˘
 
__≈å
,

396 
__ª°ri˘
 
__íd±r
,

397 
__ba£
,

398 
__group
)

399 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

401 
__exã∫_ölöe
 
uötmax_t


402 
	`__NTH
 (
	$°πoumax
 (
__c⁄°
 *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

403 
ba£
))

405  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

406 
	}
}

408 
__exãnsi⁄__


409 
	$__wc°ﬁl_öã∫Æ
 (
__c⁄°
 
__gwch¨_t
 *

410 
__ª°ri˘
 
__≈å
,

411 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

412 
__ba£
, 
__group
)

413 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

415 
__exã∫_ölöe
 
ötmax_t


416 
	`__NTH
 (
	$wc°oimax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

417 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

419  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

420 
	}
}

423 
__exãnsi⁄__


424 
	$__wc°ouŒ_öã∫Æ
 (
__c⁄°
 
__gwch¨_t
 *

425 
__ª°ri˘
 
__≈å
,

426 
__gwch¨_t
 **

427 
__ª°ri˘
 
__íd±r
,

428 
__ba£
,

429 
__group
)

430 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

432 
__exã∫_ölöe
 
uötmax_t


433 
	`__NTH
 (
	$wc°oumax
 (
__c⁄°
 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

434 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

436  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

437 
	}
}

442 
	g__END_DECLS


	@/usr/include/memory.h

23 #i‚def 
_MEMORY_H


24 
	#_MEMORY_H
 1

	)

26 
	~<„©uªs.h
>

29 #i‚def 
_STRING_H


30 
	~<°rög.h
>

	@/usr/include/netdb.h

23 #i‚def 
_NETDB_H


24 
	#_NETDB_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<√töë/ö.h
>

29 
	~<°döt.h
>

30 #ifde‡
__USE_MISC


33 
	~<Ωc/√tdb.h
>

36 #ifde‡
__USE_GNU


37 
	#__√ed_sigevít_t


	)

38 
	~<bôs/sigöfo.h
>

39 
	#__√ed_time•ec


	)

40 
	~<time.h
>

43 
	~<bôs/√tdb.h
>

46 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

47 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

48 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

49 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

50 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

51 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

54 
	g__BEGIN_DECLS


56 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


59 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

62 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

66 
	#HOST_NOT_FOUND
 1

	)

67 
	#TRY_AGAIN
 2

	)

69 
	#NO_RECOVERY
 3

	)

71 
	#NO_DATA
 4

	)

74 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


75 
	#NETDB_INTERNAL
 -1

	)

76 
	#NETDB_SUCCESS
 0

	)

77 
	#NO_ADDRESS
 
NO_DATA


	)

80 #ifde‡
__USE_XOPEN2K


82 
	#IPPORT_RESERVED
 1024

	)

85 #ifde‡
__USE_GNU


87 
	#SCOPE_DELIMITER
 '%'

	)

90 #ifde‡
__USE_MISC


93 
	$hîr‹
 (
__c⁄°
 *
__°r
Ë
__THROW
;

96 
__c⁄°
 *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

101 
	sho°ít


103 *
h_«me
;

104 **
h_Æü£s
;

105 
h_addπy≥
;

106 
h_Àngth
;

107 **
h_addr_li°
;

108 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


109 
	#h_addr
 
h_addr_li°
[0]

	)

118 
	`£tho°ít
 (
__°ay_›í
);

124 
	`ídho°ít
 ();

131 
ho°ít
 *
	`gëho°ít
 ();

138 
ho°ít
 *
	`gëho°byaddr
 (
__c⁄°
 *
__addr
, 
__sockÀn_t
 
__Àn
,

139 
__ty≥
);

145 
ho°ít
 *
	`gëho°by«me
 (
__c⁄°
 *
__«me
);

147 #ifde‡
__USE_MISC


156 
ho°ít
 *
	`gëho°by«me2
 (
__c⁄°
 *
__«me
, 
__af
);

168 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

169 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

170 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

171 *
__ª°ri˘
 
__h_î∫›
);

173 
	`gëho°byaddr_r
 (
__c⁄°
 *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

174 
__ty≥
,

175 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

176 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

177 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

178 *
__ª°ri˘
 
__h_î∫›
);

180 
	`gëho°by«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

181 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

182 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

183 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

184 *
__ª°ri˘
 
__h_î∫›
);

186 
	`gëho°by«me2_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
, 
__af
,

187 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

188 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

189 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

190 *
__ª°ri˘
 
__h_î∫›
);

199 
	`£äëít
 (
__°ay_›í
);

205 
	`íd√ã¡
 ();

212 
√ã¡
 *
	`gë√ã¡
 ();

219 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

225 
√ã¡
 *
	`gë√tby«me
 (
__c⁄°
 *
__«me
);

227 #ifdef 
__USE_MISC


238 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

239 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

240 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

241 *
__ª°ri˘
 
__h_î∫›
);

243 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

244 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

245 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

246 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

247 *
__ª°ri˘
 
__h_î∫›
);

249 
	`gë√tby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

250 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

251 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

252 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

253 *
__ª°ri˘
 
__h_î∫›
);

258 
	s£rvít


260 *
s_«me
;

261 **
s_Æü£s
;

262 
s_p‹t
;

263 *
s_¥Ÿo
;

271 
	`£t£rvít
 (
__°ay_›í
);

277 
	`íd£rvít
 ();

284 
£rvít
 *
	`gë£rvít
 ();

291 
£rvít
 *
	`gë£rvby«me
 (
__c⁄°
 *
__«me
,

292 
__c⁄°
 *
__¥Ÿo
);

299 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, 
__c⁄°
 *
__¥Ÿo
);

302 #ifdef 
__USE_MISC


310 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

311 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

312 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

314 
	`gë£rvby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

315 
__c⁄°
 *
__ª°ri˘
 
__¥Ÿo
,

316 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

317 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

318 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

320 
	`gë£rvbyp‹t_r
 (
__p‹t
, 
__c⁄°
 *
__ª°ri˘
 
__¥Ÿo
,

321 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

322 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

323 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

328 
	s¥Ÿ€¡


330 *
p_«me
;

331 **
p_Æü£s
;

332 
p_¥Ÿo
;

340 
	`£çrŸ€¡
 (
__°ay_›í
);

346 
	`íd¥Ÿ€¡
 ();

353 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

359 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (
__c⁄°
 *
__«me
);

365 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

368 #ifdef 
__USE_MISC


376 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

377 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

378 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

380 
	`gë¥Ÿoby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

381 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

382 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

383 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

385 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

386 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

387 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

388 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

397 
	`£äëgª¡
 (
__c⁄°
 *
__√tgroup
);

405 
	`íd√tgª¡
 ();

414 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

415 **
__ª°ri˘
 
__u£Ω
,

416 **
__ª°ri˘
 
__domaöp
);

425 
	`ö√tgr
 (
__c⁄°
 *
__√tgroup
, __c⁄° *
__ho°
,

426 
__c⁄°
 *
__u£r
, __c⁄° *
__domaö
);

434 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

435 **
__ª°ri˘
 
__u£Ω
,

436 **
__ª°ri˘
 
__domaöp
,

437 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

441 #ifde‡
__USE_BSD


453 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

454 
__c⁄°
 *
__ª°ri˘
 
__locu£r
,

455 
__c⁄°
 *
__ª°ri˘
 
__ªmu£r
,

456 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

465 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

466 
__c⁄°
 *
__ª°ri˘
 
__locu£r
,

467 
__c⁄°
 *
__ª°ri˘
 
__ªmu£r
,

468 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

469 
ß_Ámûy_t
 
__af
);

481 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

482 
__c⁄°
 *
__ª°ri˘
 
__«me
,

483 
__c⁄°
 *
__ª°ri˘
 
__∑ss
,

484 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

493 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

494 
__c⁄°
 *
__ª°ri˘
 
__«me
,

495 
__c⁄°
 *
__ª°ri˘
 
__∑ss
,

496 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

497 
ß_Ámûy_t
 
__af
);

507 
	`ru£rok
 (
__c⁄°
 *
__rho°
, 
__su£r
,

508 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
);

517 
	`ru£rok_af
 (
__c⁄°
 *
__rho°
, 
__su£r
,

518 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
,

519 
ß_Ámûy_t
 
__af
);

530 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

531 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
);

541 
	`úu£rok_af
 (
__c⁄°
 *
__øddr
, 
__su£r
,

542 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
,

543 
ß_Ámûy_t
 
__af
);

553 
	`ºesvp‹t
 (*
__Æp‹t
);

562 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

567 #ifdef 
__USE_POSIX


569 
	saddröfo


571 
ai_Êags
;

572 
ai_Ámûy
;

573 
ai_sockty≥
;

574 
ai_¥Ÿocﬁ
;

575 
sockÀn_t
 
ai_addæí
;

576 
sockaddr
 *
ai_addr
;

577 *
ai_ˇn⁄«me
;

578 
addröfo
 *
ai_√xt
;

581 #ifde‡
__USE_GNU


583 
	sgaicb


585 c⁄° *
¨_«me
;

586 c⁄° *
¨_£rvi˚
;

587 c⁄° 
addröfo
 *
¨_ªque°
;

588 
addröfo
 *
¨_ªsu…
;

590 
__ªtu∫
;

591 
__unu£d
[5];

595 
	#GAI_WAIT
 0

	)

596 
	#GAI_NOWAIT
 1

	)

600 
	#AI_PASSIVE
 0x0001

	)

601 
	#AI_CANONNAME
 0x0002

	)

602 
	#AI_NUMERICHOST
 0x0004

	)

603 
	#AI_V4MAPPED
 0x0008

	)

604 
	#AI_ALL
 0x0010

	)

605 
	#AI_ADDRCONFIG
 0x0020

	)

607 #ifde‡
__USE_GNU


608 
	#AI_IDN
 0x0040

	)

611 
	#AI_CANONIDN
 0x0080

	)

612 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

614 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

617 
	#AI_NUMERICSERV
 0x0400

	)

620 
	#EAI_BADFLAGS
 -1

	)

621 
	#EAI_NONAME
 -2

	)

622 
	#EAI_AGAIN
 -3

	)

623 
	#EAI_FAIL
 -4

	)

624 
	#EAI_FAMILY
 -6

	)

625 
	#EAI_SOCKTYPE
 -7

	)

626 
	#EAI_SERVICE
 -8

	)

627 
	#EAI_MEMORY
 -10

	)

628 
	#EAI_SYSTEM
 -11

	)

629 
	#EAI_OVERFLOW
 -12

	)

630 #ifde‡
__USE_GNU


631 
	#EAI_NODATA
 -5

	)

632 
	#EAI_ADDRFAMILY
 -9

	)

633 
	#EAI_INPROGRESS
 -100

	)

634 
	#EAI_CANCELED
 -101

	)

635 
	#EAI_NOTCANCELED
 -102

	)

636 
	#EAI_ALLDONE
 -103

	)

637 
	#EAI_INTR
 -104

	)

638 
	#EAI_IDN_ENCODE
 -105

	)

641 #ifde‡
__USE_MISC


642 
	#NI_MAXHOST
 1025

	)

643 
	#NI_MAXSERV
 32

	)

646 
	#NI_NUMERICHOST
 1

	)

647 
	#NI_NUMERICSERV
 2

	)

648 
	#NI_NOFQDN
 4

	)

649 
	#NI_NAMEREQD
 8

	)

650 
	#NI_DGRAM
 16

	)

651 #ifde‡
__USE_GNU


652 
	#NI_IDN
 32

	)

653 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

655 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

664 
	`gëaddröfo
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

665 
__c⁄°
 *
__ª°ri˘
 
__£rvi˚
,

666 
__c⁄°
 
addröfo
 *
__ª°ri˘
 
__ªq
,

667 
addröfo
 **
__ª°ri˘
 
__∑i
);

670 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

673 
__c⁄°
 *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

679 
	`gë«meöfo
 (
__c⁄°
 
sockaddr
 *
__ª°ri˘
 
__ß
,

680 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

681 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

682 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

685 #ifde‡
__USE_GNU


694 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

695 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

705 
	`gai_su•íd
 (
__c⁄°
 
gaicb
 *__c⁄° 
__li°
[], 
__ít
,

706 
__c⁄°
 
time•ec
 *
__timeout
);

709 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

712 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

715 
__END_DECLS


	@/usr/include/netinet/in.h

20 #i‚def 
_NETINET_IN_H


21 
	#_NETINET_IN_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<°döt.h
>

25 
	~<sys/sockë.h
>

26 
	~<bôs/ty≥s.h
>

29 
__BEGIN_DECLS


34 
	mIPPROTO_IP
 = 0,

35 
	#IPPROTO_IP
 
IPPROTO_IP


	)

36 
	mIPPROTO_HOPOPTS
 = 0,

37 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

38 
	mIPPROTO_ICMP
 = 1,

39 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

40 
	mIPPROTO_IGMP
 = 2,

41 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

42 
	mIPPROTO_IPIP
 = 4,

43 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

44 
	mIPPROTO_TCP
 = 6,

45 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

46 
	mIPPROTO_EGP
 = 8,

47 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

48 
	mIPPROTO_PUP
 = 12,

49 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

50 
	mIPPROTO_UDP
 = 17,

51 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

52 
	mIPPROTO_IDP
 = 22,

53 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

54 
	mIPPROTO_TP
 = 29,

55 
	#IPPROTO_TP
 
IPPROTO_TP


	)

56 
	mIPPROTO_DCCP
 = 33,

57 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

58 
	mIPPROTO_IPV6
 = 41,

59 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

60 
	mIPPROTO_ROUTING
 = 43,

61 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

62 
	mIPPROTO_FRAGMENT
 = 44,

63 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

64 
	mIPPROTO_RSVP
 = 46,

65 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

66 
	mIPPROTO_GRE
 = 47,

67 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

68 
	mIPPROTO_ESP
 = 50,

69 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

70 
	mIPPROTO_AH
 = 51,

71 
	#IPPROTO_AH
 
IPPROTO_AH


	)

72 
	mIPPROTO_ICMPV6
 = 58,

73 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

74 
	mIPPROTO_NONE
 = 59,

75 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

76 
	mIPPROTO_DSTOPTS
 = 60,

77 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

78 
	mIPPROTO_MTP
 = 92,

79 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

80 
	mIPPROTO_ENCAP
 = 98,

81 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

82 
	mIPPROTO_PIM
 = 103,

83 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

84 
	mIPPROTO_COMP
 = 108,

85 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

86 
	mIPPROTO_SCTP
 = 132,

87 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

88 
	mIPPROTO_UDPLITE
 = 136,

89 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


97 
uöt16_t
 
	tö_p‹t_t
;

102 
	mIPPORT_ECHO
 = 7,

103 
	mIPPORT_DISCARD
 = 9,

104 
	mIPPORT_SYSTAT
 = 11,

105 
	mIPPORT_DAYTIME
 = 13,

106 
	mIPPORT_NETSTAT
 = 15,

107 
	mIPPORT_FTP
 = 21,

108 
	mIPPORT_TELNET
 = 23,

109 
	mIPPORT_SMTP
 = 25,

110 
	mIPPORT_TIMESERVER
 = 37,

111 
	mIPPORT_NAMESERVER
 = 42,

112 
	mIPPORT_WHOIS
 = 43,

113 
	mIPPORT_MTP
 = 57,

115 
	mIPPORT_TFTP
 = 69,

116 
	mIPPORT_RJE
 = 77,

117 
	mIPPORT_FINGER
 = 79,

118 
	mIPPORT_TTYLINK
 = 87,

119 
	mIPPORT_SUPDUP
 = 95,

122 
	mIPPORT_EXECSERVER
 = 512,

123 
	mIPPORT_LOGINSERVER
 = 513,

124 
	mIPPORT_CMDSERVER
 = 514,

125 
	mIPPORT_EFSSERVER
 = 520,

128 
	mIPPORT_BIFFUDP
 = 512,

129 
	mIPPORT_WHOSERVER
 = 513,

130 
	mIPPORT_ROUTESERVER
 = 520,

133 
	mIPPORT_RESERVED
 = 1024,

136 
	mIPPORT_USERRESERVED
 = 5000

141 
uöt32_t
 
	tö_addr_t
;

142 
	sö_addr


144 
ö_addr_t
 
	ms_addr
;

153 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

154 
	#IN_CLASSA_NET
 0xff000000

	)

155 
	#IN_CLASSA_NSHIFT
 24

	)

156 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

157 
	#IN_CLASSA_MAX
 128

	)

159 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

160 
	#IN_CLASSB_NET
 0xffff0000

	)

161 
	#IN_CLASSB_NSHIFT
 16

	)

162 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

163 
	#IN_CLASSB_MAX
 65536

	)

165 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

166 
	#IN_CLASSC_NET
 0xffffff00

	)

167 
	#IN_CLASSC_NSHIFT
 8

	)

168 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

170 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

171 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

173 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

174 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

177 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

179 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

181 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

184 
	#IN_LOOPBACKNET
 127

	)

186 #i‚de‡
INADDR_LOOPBACK


187 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

191 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

192 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

193 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

194 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

198 
	sö6_addr


202 
uöt8_t
 
	m__u6_addr8
[16];

203 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


204 
uöt16_t
 
	m__u6_addr16
[8];

205 
uöt32_t
 
	m__u6_addr32
[4];

207 } 
	m__ö6_u
;

208 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

209 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


210 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

211 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

215 c⁄° 
ö6_addr
 
ö6addr_™y
;

216 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

217 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

218 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

220 
	#INET_ADDRSTRLEN
 16

	)

221 
	#INET6_ADDRSTRLEN
 46

	)

225 
	ssockaddr_ö


227 
__SOCKADDR_COMMON
 (
sö_
);

228 
ö_p‹t_t
 
	msö_p‹t
;

229 
ö_addr
 
	msö_addr
;

232 
	msö_zîo
[ (
sockaddr
) -

233 
__SOCKADDR_COMMON_SIZE
 -

234  (
ö_p‹t_t
) -

235  (
ö_addr
)];

239 
	ssockaddr_ö6


241 
__SOCKADDR_COMMON
 (
sö6_
);

242 
ö_p‹t_t
 
	msö6_p‹t
;

243 
uöt32_t
 
	msö6_Êowöfo
;

244 
ö6_addr
 
	msö6_addr
;

245 
uöt32_t
 
	msö6_sc›e_id
;

249 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


251 
	sù_mªq


254 
ö_addr
 
	mimr_mu…üddr
;

257 
ö_addr
 
	mimr_öãrÁ˚
;

260 
	sù_mªq_sour˚


263 
ö_addr
 
	mimr_mu…üddr
;

266 
ö_addr
 
	mimr_öãrÁ˚
;

269 
ö_addr
 
	mimr_sour˚addr
;

275 
	sùv6_mªq


278 
ö6_addr
 
	mùv6mr_mu…üddr
;

281 
	mùv6mr_öãrÁ˚
;

285 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


287 
	sgroup_ªq


290 
uöt32_t
 
	mgr_öãrÁ˚
;

293 
sockaddr_°‹age
 
	mgr_group
;

296 
	sgroup_sour˚_ªq


299 
uöt32_t
 
	mg§_öãrÁ˚
;

302 
sockaddr_°‹age
 
	mg§_group
;

305 
sockaddr_°‹age
 
	mg§_sour˚
;

310 
	sù_msfûãr


313 
ö_addr
 
	mimsf_mu…üddr
;

316 
ö_addr
 
	mimsf_öãrÁ˚
;

319 
uöt32_t
 
	mimsf_fmode
;

322 
uöt32_t
 
	mimsf_num§c
;

324 
ö_addr
 
	mimsf_¶i°
[1];

327 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

328 -  (
ö_addr
) \

329 + (
num§c
Ë*  (
ö_addr
))

	)

331 
	sgroup_fûãr


334 
uöt32_t
 
	mgf_öãrÁ˚
;

337 
sockaddr_°‹age
 
	mgf_group
;

340 
uöt32_t
 
	mgf_fmode
;

343 
uöt32_t
 
	mgf_num§c
;

345 
sockaddr_°‹age
 
	mgf_¶i°
[1];

348 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

349 -  (
sockaddr_°‹age
) \

350 + ((
num§c
) \

351 *  (
sockaddr_°‹age
)))

	)

356 
	~<bôs/ö.h
>

365 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

366 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

367 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

368 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

369 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

370 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

371 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

373 
	~<ídün.h
>

376 
	~<bôs/byãsw≠.h
>

378 #ifde‡
__OPTIMIZE__


382 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


385 
	#¡ohl
(
x
Ë(x)

	)

386 
	#¡ohs
(
x
Ë(x)

	)

387 
	#ht⁄l
(
x
Ë(x)

	)

388 
	#ht⁄s
(
x
Ë(x)

	)

390 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


391 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

392 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

393 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

394 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

399 #ifde‡
__GNUC__


400 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

401 (
__exãnsi⁄__
 \

402 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

403 
__a
->
s6_addr32
[0] == 0 \

404 && 
__a
->
s6_addr32
[1] == 0 \

405 && 
__a
->
s6_addr32
[2] == 0 \

406 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

408 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

409 (
__exãnsi⁄__
 \

410 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

411 
__a
->
s6_addr32
[0] == 0 \

412 && 
__a
->
s6_addr32
[1] == 0 \

413 && 
__a
->
s6_addr32
[2] == 0 \

414 && 
__a
->
s6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

416 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

417 (
__exãnsi⁄__
 \

418 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

419 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

421 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

422 (
__exãnsi⁄__
 \

423 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

424 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

426 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

427 (
__exãnsi⁄__
 \

428 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

429 
__a
->
s6_addr32
[0] == 0 \

430 && 
__a
->
s6_addr32
[1] == 0 \

431 && 
__a
->
s6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

433 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

434 (
__exãnsi⁄__
 \

435 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

436 
__a
->
s6_addr32
[0] == 0 \

437 && 
__a
->
s6_addr32
[1] == 0 \

438 && 
__a
->
s6_addr32
[2] == 0 \

439 && 
	`¡ohl
 (
__a
->
s6_addr32
[3]Ë> 1; }))

	)

441 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

442 (
__exãnsi⁄__
 \

443 ({ 
__c⁄°
 
ö6_addr
 *
__a
 = (__c⁄° ö6_add∏*Ë(
a
); \

444 
__c⁄°
 
ö6_addr
 *
__b
 = (__c⁄° ö6_add∏*Ë(
b
); \

445 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

446 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

447 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

448 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

450 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

451 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0 \

452 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0 \

453 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0 \

454 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =0)

	)

456 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

457 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0 \

458 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0 \

459 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0 \

460 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

462 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

463 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

464 =
	`ht⁄l
 (0x„800000))

	)

466 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

467 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

468 =
	`ht⁄l
 (0x„c00000))

	)

470 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

471 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0) \

472 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0) \

473 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

475 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

476 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0) \

477 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0) \

478 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0) \

479 && (
	`¡ohl
 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

481 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

482 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] =((__c⁄° uöt32_à*Ë(
b
))[0]) \

483 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] =((__c⁄° uöt32_à*Ë(
b
))[1]) \

484 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] =((__c⁄° uöt32_à*Ë(
b
))[2]) \

485 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =((__c⁄° uöt32_à*Ë(
b
))[3]))

	)

488 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((
__c⁄°
 
uöt8_t
 *Ë◊))[0] =0xff)

	)

490 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


492 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

495 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

496 
__THROW
;

500 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

501 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

502 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

504 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

505 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

506 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

508 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

509 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

510 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

512 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

513 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

514 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

516 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

517 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

518 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

521 #ifde‡
__USE_GNU


523 
	sö6_pktöfo


525 
ö6_addr
 
ùi6_addr
;

526 
ùi6_ifödex
;

530 
	sù6_mtuöfo


532 
sockaddr_ö6
 
ù6m_addr
;

533 
uöt32_t
 
ù6m_mtu
;

538 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

539 
__THROW
 
__©åibuã_dïªˇãd__
;

540 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

541 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

542 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

543 
__c⁄°
 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

544 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

545 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

546 
__mu…x
, 
__∂usy
)

547 
__THROW
 
__©åibuã_dïªˇãd__
;

548 
	$öë6_›ti⁄_√xt
 (
__c⁄°
 
cmsghdr
 *
__cmsg
,

549 
uöt8_t
 **
__çåp
)

550 
__THROW
 
__©åibuã_dïªˇãd__
;

551 
	$öë6_›ti⁄_föd
 (
__c⁄°
 
cmsghdr
 *
__cmsg
,

552 
uöt8_t
 **
__çåp
, 
__ty≥
)

553 
__THROW
 
__©åibuã_dïªˇãd__
;

557 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

558 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

559 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

560 **
__d©abuÂ
Ë
__THROW
;

561 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

562 
__THROW
;

563 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

564 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

565 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

566 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

567 **
__d©abuÂ
Ë
__THROW
;

568 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

569 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

570 **
__d©abuÂ
Ë
__THROW
;

571 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

572 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

576 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

577 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

578 
__£gmíts
Ë
__THROW
;

579 
	$öë6_πh_add
 (*
__bp
, 
__c⁄°
 
ö6_addr
 *
__addr
Ë
__THROW
;

580 
	$öë6_πh_ªvî£
 (
__c⁄°
 *
__ö
, *
__out
Ë
__THROW
;

581 
	$öë6_πh_£gmíts
 (
__c⁄°
 *
__bp
Ë
__THROW
;

582 
ö6_addr
 *
	$öë6_πh_gëaddr
 (
__c⁄°
 *
__bp
, 
__ödex
)

583 
__THROW
;

589 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

590 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

591 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

592 
__THROW
;

595 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

596 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

597 
uöt32_t
 
__num§c
,

598 
__c⁄°
 
ö_addr
 *
__¶i°
)

599 
__THROW
;

603 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

604 
__c⁄°
 
sockaddr
 *
__group
,

605 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

606 
uöt32_t
 *
__num§c
,

607 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

610 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

611 
__c⁄°
 
sockaddr
 *
__group
,

612 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

613 
uöt32_t
 
__num§c
,

614 
__c⁄°
 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

617 
__END_DECLS


	@/usr/include/poll.h

1 
	~<sys/pﬁl.h
>

	@/usr/include/pthread.h

20 #i‚de‡
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<ídün.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	~<bôs/±hªadty≥s.h
>

29 
	~<bôs/£tjmp.h
>

30 
	~<bôs/w‹dsize.h
>

36 
	mPTHREAD_CREATE_JOINABLE
,

37 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

38 
	mPTHREAD_CREATE_DETACHED


39 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

46 
	mPTHREAD_MUTEX_TIMED_NP
,

47 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

48 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

49 
	mPTHREAD_MUTEX_ADAPTIVE_NP


50 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


52 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

53 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

54 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

55 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


57 #ifde‡
__USE_GNU


59 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


64 #ifde‡
__USE_XOPEN2K


68 
	mPTHREAD_MUTEX_STALLED
,

69 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

70 
	mPTHREAD_MUTEX_ROBUST
,

71 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


76 #ifde‡
__USE_UNIX98


80 
	mPTHREAD_PRIO_NONE
,

81 
	mPTHREAD_PRIO_INHERIT
,

82 
	mPTHREAD_PRIO_PROTECT


88 #i‡
__WORDSIZE
 == 64

89 
	#PTHREAD_MUTEX_INITIALIZER
 \

90 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

91 #ifde‡
__USE_GNU


92 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

94 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

100 
	#PTHREAD_MUTEX_INITIALIZER
 \

101 { { 0, 0, 0, 0, 0, { 0 } } }

	)

102 #ifde‡
__USE_GNU


103 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

105 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

114 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


124 
	#PTHREAD_RWLOCK_INITIALIZER
 \

125 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

126 #ifde‡
__USE_GNU


127 #i‡
__WORDSIZE
 == 64

128 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

130 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

132 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


133 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

134 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

135 0, 0, 0, 0 } }

	)

137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

139 0 } }

	)

149 
	mPTHREAD_INHERIT_SCHED
,

150 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

151 
	mPTHREAD_EXPLICIT_SCHED


152 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

159 
	mPTHREAD_SCOPE_SYSTEM
,

160 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

161 
	mPTHREAD_SCOPE_PROCESS


162 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

169 
	mPTHREAD_PROCESS_PRIVATE
,

170 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

171 
	mPTHREAD_PROCESS_SHARED


172 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

178 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

182 
	s_±hªad_˛ónup_buf„r


184 (*
	m__routöe
) (*);

185 *
	m__¨g
;

186 
	m__ˇn˚…y≥
;

187 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

193 
	mPTHREAD_CANCEL_ENABLE
,

194 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

195 
	mPTHREAD_CANCEL_DISABLE


196 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

200 
	mPTHREAD_CANCEL_DEFERRED
,

201 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

202 
	mPTHREAD_CANCEL_ASYNCHRONOUS


203 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

205 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

209 
	#PTHREAD_ONCE_INIT
 0

	)

212 #ifde‡
__USE_XOPEN2K


216 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

220 
__BEGIN_DECLS


225 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

226 
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

227 *(*
__°¨t_routöe
) (*),

228 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
__n⁄nuŒ
 ((1, 3));

234 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

242 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

244 #ifde‡
__USE_GNU


247 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

255 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

256 
__c⁄°
 
time•ec
 *
__ab°ime
);

263 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

267 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

270 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
Ë
__THROW
;

278 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

281 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

282 
__THROW
 
	`__n⁄nuŒ
 ((1));

285 
	$±hªad_©å_gëdëach°©e
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

286 *
__dëach°©e
)

287 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

290 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

291 
__dëach°©e
)

292 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$±hªad_©å_gëgu¨dsize
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

297 
size_t
 *
__gu¨dsize
)

298 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

301 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

302 
size_t
 
__gu¨dsize
)

303 
__THROW
 
	`__n⁄nuŒ
 ((1));

307 
	$±hªad_©å_gësched∑øm
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


308 
__©å
,

309 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

310 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

313 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

314 
__c⁄°
 
sched_∑øm
 *
__ª°ri˘


315 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

318 
	$±hªad_©å_gëschedpﬁicy
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


319 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

320 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

323 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

324 
__THROW
 
	`__n⁄nuŒ
 ((1));

327 
	$±hªad_©å_gëöhîôsched
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


328 
__©å
, *
__ª°ri˘
 
__öhîô
)

329 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

332 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

333 
__öhîô
)

334 
__THROW
 
	`__n⁄nuŒ
 ((1));

338 
	$±hªad_©å_gësc›e
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

339 *
__ª°ri˘
 
__sc›e
)

340 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

343 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

344 
__THROW
 
	`__n⁄nuŒ
 ((1));

347 
	$±hªad_©å_gë°ackaddr
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


348 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

349 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

355 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

356 *
__°ackaddr
)

357 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

360 
	$±hªad_©å_gë°acksize
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


361 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

362 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

367 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

368 
size_t
 
__°acksize
)

369 
__THROW
 
	`__n⁄nuŒ
 ((1));

371 #ifde‡
__USE_XOPEN2K


373 
	$±hªad_©å_gë°ack
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

374 **
__ª°ri˘
 
__°ackaddr
,

375 
size_t
 *
__ª°ri˘
 
__°acksize
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

381 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

382 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

385 #ifde‡
__USE_GNU


388 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

389 
size_t
 
__˝u£tsize
,

390 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
)

391 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

395 
	$±hªad_©å_gëafföôy_≈
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

396 
size_t
 
__˝u£tsize
,

397 
˝u_£t_t
 *
__˝u£t
)

398 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

404 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

405 
__THROW
 
	`__n⁄nuŒ
 ((2));

413 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

414 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

415 
__THROW
 
	`__n⁄nuŒ
 ((3));

418 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

419 *
__ª°ri˘
 
__pﬁicy
,

420 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

421 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

424 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

425 
__THROW
;

428 #ifde‡
__USE_GNU


430 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

431 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

435 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, 
__c⁄°
 *
__«me
)

436 
__THROW
 
	`__n⁄nuŒ
 ((2));

440 #ifde‡
__USE_UNIX98


442 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

445 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

448 #ifde‡
__USE_GNU


453 
	$±hªad_yõld
 (Ë
__THROW
;

458 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

459 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
)

460 
__THROW
 
	`__n⁄nuŒ
 ((3));

463 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

464 
˝u_£t_t
 *
__˝u£t
)

465 
__THROW
 
	`__n⁄nuŒ
 ((3));

478 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

479 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

490 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

494 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

497 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

502 
	`±hªad_ã°ˇn˚l
 ();

511 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

512 
__mask_was_ßved
;

513 } 
__ˇn˚l_jmp_buf
[1];

514 *
__∑d
[4];

515 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

518 #i‚de‡
__˛ónup_f˘_©åibuã


519 
	#__˛ónup_f˘_©åibuã


	)

524 
	s__±hªad_˛ónup_‰ame


526 (*
__ˇn˚l_routöe
) (*);

527 *
__ˇn˚l_¨g
;

528 
__do_ô
;

529 
__ˇn˚l_ty≥
;

532 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


533 #ifde‡
__˝lu•lus


535 ˛as†
	c__±hªad_˛ónup_˛ass


537 (*
__ˇn˚l_routöe
) (*);

538 *
__ˇn˚l_¨g
;

539 
__do_ô
;

540 
__ˇn˚l_ty≥
;

542 
public
:

543 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

544 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

545 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

546 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

547 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

548 &
__ˇn˚l_ty≥
); 
	}
}

549 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

559 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

561 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

565 
	#±hªad_˛ónup_p›
(
execuã
) \

566 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

567 } 0)

	)

569 #ifde‡
__USE_GNU


573 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

575 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

576 
__˛‰ame
.
	`__de„r
 ()

	)

581 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

582 
__˛‰ame
.
	`__ª°‹e
 (); \

583 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

584 } 0)

	)

591 
__exã∫_ölöe
 

592 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

594 i‡(
__‰ame
->
__do_ô
)

595 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

596 
	}
}

605 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

607 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

608 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

609 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

610 .
__do_ô
 = 1 };

	)

614 
	#±hªad_˛ónup_p›
(
execuã
) \

615 
__˛‰ame
.
__do_ô
 = (
execuã
); \

616 } 0)

	)

618 #ifde‡
__USE_GNU


622 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

624 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

625 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

626 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

627 .
__do_ô
 = 1 }; \

628 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

629 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

634 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

635 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

636 
__˛‰ame
.
__do_ô
 = (
execuã
); \

637 } 0)

	)

648 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

650 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

651 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

652 *
__ˇn˚l_¨g
 = (
¨g
); \

653 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

654 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

655 i‡(
	`__buûtö_ex≥˘
 (
__nŸ_fú°_ˇŒ
, 0)) \

657 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

658 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

662 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

663 dÿ{

	)

664 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

665 
__˛ónup_f˘_©åibuã
;

669 
	#±hªad_˛ónup_p›
(
execuã
) \

672 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

673 i‡(
execuã
) \

674 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

675 } 0)

	)

676 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

677 
__˛ónup_f˘_©åibuã
;

679 #ifde‡
__USE_GNU


683 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

685 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

686 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

687 *
__ˇn˚l_¨g
 = (
¨g
); \

688 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

689 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

690 i‡(
	`__buûtö_ex≥˘
 (
__nŸ_fú°_ˇŒ
, 0)) \

692 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

693 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

697 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

698 dÿ{

	)

699 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

700 
__˛ónup_f˘_©åibuã
;

705 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

708 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

709 i‡(
execuã
) \

710 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

711 
	}
} 0)

	)

712 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

713 
__˛ónup_f˘_©åibuã
;

717 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

718 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

719 #i‚de‡
SHARED


720 
	`__©åibuã__
 ((
__wók__
))

726 
__jmp_buf_èg
;

727 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROW
;

733 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

734 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx©å
)

735 
__THROW
 
	`__n⁄nuŒ
 ((1));

738 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

739 
__THROW
 
	`__n⁄nuŒ
 ((1));

742 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

743 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

746 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

747 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

749 #ifde‡
__USE_XOPEN2K


751 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

752 
__c⁄°
 
time•ec
 *
__ª°ri˘


753 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

757 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

758 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

762 
	$±hªad_muãx_gë¥io˚ûög
 (
__c⁄°
 
±hªad_muãx_t
 *

763 
__ª°ri˘
 
__muãx
,

764 *
__ª°ri˘
 
__¥io˚ûög
)

765 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

769 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

770 
__¥io˚ûög
,

771 *
__ª°ri˘
 
__ﬁd_˚ûög
)

772 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

775 #ifde‡
__USE_XOPEN2K8


777 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

778 
__THROW
 
	`__n⁄nuŒ
 ((1));

779 #ifde‡
__USE_GNU


780 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

781 
__THROW
 
	`__n⁄nuŒ
 ((1));

790 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1));

794 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

795 
__THROW
 
	`__n⁄nuŒ
 ((1));

798 
	$±hªad_muãx©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_muãx©å_t
 *

799 
__ª°ri˘
 
__©å
,

800 *
__ª°ri˘
 
__psh¨ed
)

801 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

804 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

805 
__psh¨ed
)

806 
__THROW
 
	`__n⁄nuŒ
 ((1));

808 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


810 
	$±hªad_muãx©å_gëty≥
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__ª°ri˘


811 
__©å
, *
__ª°ri˘
 
__köd
)

812 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

817 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

818 
__THROW
 
	`__n⁄nuŒ
 ((1));

822 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (
__c⁄°
 
±hªad_muãx©å_t
 *

823 
__ª°ri˘
 
__©å
,

824 *
__ª°ri˘
 
__¥Ÿocﬁ
)

825 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

829 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

830 
__¥Ÿocﬁ
)

831 
__THROW
 
	`__n⁄nuŒ
 ((1));

834 
	$±hªad_muãx©å_gë¥io˚ûög
 (
__c⁄°
 
±hªad_muãx©å_t
 *

835 
__ª°ri˘
 
__©å
,

836 *
__ª°ri˘
 
__¥io˚ûög
)

837 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

840 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

841 
__¥io˚ûög
)

842 
__THROW
 
	`__n⁄nuŒ
 ((1));

844 #ifde‡
__USE_XOPEN2K


846 
	$±hªad_muãx©å_gërobu°
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__©å
,

847 *
__robu°√ss
)

848 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

849 #ifde‡
__USE_GNU


850 
	$±hªad_muãx©å_gërobu°_≈
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__©å
,

851 *
__robu°√ss
)

852 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

856 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

857 
__robu°√ss
)

858 
__THROW
 
	`__n⁄nuŒ
 ((1));

859 #ifde‡
__USE_GNU


860 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

861 
__robu°√ss
)

862 
__THROW
 
	`__n⁄nuŒ
 ((1));

867 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


872 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

873 
__c⁄°
 
±hªad_rwlock©å_t
 *
__ª°ri˘


874 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

877 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

878 
__THROW
 
	`__n⁄nuŒ
 ((1));

881 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

882 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

885 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

886 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

888 #ifde‡
__USE_XOPEN2K


890 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

891 
__c⁄°
 
time•ec
 *
__ª°ri˘


892 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

896 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

897 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

900 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

901 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

903 #ifde‡
__USE_XOPEN2K


905 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

906 
__c⁄°
 
time•ec
 *
__ª°ri˘


907 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

911 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

912 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

918 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

919 
__THROW
 
	`__n⁄nuŒ
 ((1));

922 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

923 
__THROW
 
	`__n⁄nuŒ
 ((1));

926 
	$±hªad_rwlock©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_rwlock©å_t
 *

927 
__ª°ri˘
 
__©å
,

928 *
__ª°ri˘
 
__psh¨ed
)

929 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

932 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

933 
__psh¨ed
)

934 
__THROW
 
	`__n⁄nuŒ
 ((1));

937 
	$±hªad_rwlock©å_gëköd_≈
 (
__c⁄°
 
±hªad_rwlock©å_t
 *

938 
__ª°ri˘
 
__©å
,

939 *
__ª°ri˘
 
__¥ef
)

940 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

943 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

944 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

952 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

953 
__c⁄°
 
±hªad_c⁄d©å_t
 *
__ª°ri˘


954 
__c⁄d_©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

957 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

958 
__THROW
 
	`__n⁄nuŒ
 ((1));

961 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

962 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

965 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

966 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

973 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

974 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

975 
	`__n⁄nuŒ
 ((1, 2));

984 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

985 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

986 
__c⁄°
 
time•ec
 *
__ª°ri˘


987 
__ab°ime
Ë
	`__n⁄nuŒ
 ((1, 2, 3));

992 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

993 
__THROW
 
	`__n⁄nuŒ
 ((1));

996 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

997 
__THROW
 
	`__n⁄nuŒ
 ((1));

1000 
	$±hªad_c⁄d©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_c⁄d©å_t
 *

1001 
__ª°ri˘
 
__©å
,

1002 *
__ª°ri˘
 
__psh¨ed
)

1003 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1006 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1007 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1009 #ifde‡
__USE_XOPEN2K


1011 
	$±hªad_c⁄d©å_gë˛ock
 (
__c⁄°
 
±hªad_c⁄d©å_t
 *

1012 
__ª°ri˘
 
__©å
,

1013 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1014 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1017 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1018 
__˛ockid_t
 
__˛ock_id
)

1019 
__THROW
 
	`__n⁄nuŒ
 ((1));

1023 #ifde‡
__USE_XOPEN2K


1028 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1029 
__THROW
 
	`__n⁄nuŒ
 ((1));

1032 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1033 
__THROW
 
	`__n⁄nuŒ
 ((1));

1036 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1037 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1040 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1041 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1044 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1045 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1052 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1053 
__c⁄°
 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1054 
__©å
, 
__cou¡
)

1055 
__THROW
 
	`__n⁄nuŒ
 ((1));

1058 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1059 
__THROW
 
	`__n⁄nuŒ
 ((1));

1062 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1063 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1067 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1068 
__THROW
 
	`__n⁄nuŒ
 ((1));

1071 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1072 
__THROW
 
	`__n⁄nuŒ
 ((1));

1075 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (
__c⁄°
 
±hªad_b¨rõøâr_t
 *

1076 
__ª°ri˘
 
__©å
,

1077 *
__ª°ri˘
 
__psh¨ed
)

1078 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1081 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1082 
__psh¨ed
)

1083 
__THROW
 
	`__n⁄nuŒ
 ((1));

1095 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1096 (*
__de°r_fun˘i⁄
) (*))

1097 
__THROW
 
	`__n⁄nuŒ
 ((1));

1100 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1103 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1106 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1107 
__c⁄°
 *
__poöãr
Ë
__THROW
 ;

1110 #ifde‡
__USE_XOPEN2K


1112 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1113 
__˛ockid_t
 *
__˛ock_id
)

1114 
__THROW
 
	`__n⁄nuŒ
 ((2));

1129 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1130 (*
__∑ª¡
) (),

1131 (*
__chûd
Ë()Ë
__THROW
;

1134 #ifde‡
__USE_EXTERN_INLINES


1136 
__exã∫_ölöe
 

1137 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1139  
__thªad1
 =
__thªad2
;

1140 
	}
}

1143 
	g__END_DECLS


	@/usr/include/signal.h

23 #i‚def 
_SIGNAL_H


25 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


33 
	~<bôs/sig£t.h
>

37 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


38 #i‚de‡
__sig_©omic_t_deföed


39 
	#__sig_©omic_t_deföed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #unde‡
__√ed_sig_©omic_t


47 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

48 #i‚de‡
__sig£t_t_deföed


49 
	#__sig£t_t_deföed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #unde‡
__√ed_sig£t_t


55 #ifde‡
_SIGNAL_H


57 
	~<bôs/ty≥s.h
>

58 
	~<bôs/signum.h
>

60 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


61 #i‚de‡
__pid_t_deföed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_deföed


	)

65 #ifde‡
__USE_XOPEN


67 #i‚de‡
__uid_t_deföed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_deföed


	)

73 #ifde‡
__USE_POSIX199309


75 
	#__√ed_time•ec


	)

76 
	~<time.h
>

79 
	~<bôs/sigöfo.h
>

84 (*
	t__sigh™dÀr_t
) ();

89 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

90 
__THROW
;

91 #ifde‡
__USE_GNU


92 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

93 
__THROW
;

99 
__BEGIN_NAMESPACE_STD


100 #ifde‡
__USE_BSD


101 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

102 
__THROW
;

105 #ifde‡
__REDIRECT_NTH


106 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

107 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

108 
__sysv_sig«l
);

110 
	#sig«l
 
__sysv_sig«l


	)

113 
__END_NAMESPACE_STD


115 #ifde‡
__USE_XOPEN


118 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

119 
__THROW
;

125 #ifde‡
__USE_POSIX


126 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

129 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


133 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

136 
__BEGIN_NAMESPACE_STD


138 
	$øi£
 (
__sig
Ë
__THROW
;

139 
__END_NAMESPACE_STD


141 #ifde‡
__USE_SVID


143 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

144 
__THROW
;

145 
	$gsig«l
 (
__sig
Ë
__THROW
;

148 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


150 
	`psig«l
 (
__sig
, 
__c⁄°
 *
__s
);

153 #ifde‡
__USE_XOPEN2K


155 
	`psigöfo
 (
__c⁄°
 
sigöfo_t
 *
__pöfo
, __c⁄° *
__s
);

168 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

170 #ifde‡
__FAVOR_BSD


173 
	$sig∑u£
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

175 #ifde‡
__USE_XOPEN


176 #ifde‡
__GNUC__


177 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

180 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

186 #ifde‡
__USE_BSD


193 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

196 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

199 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

202 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

206 #ifde‡
__USE_MISC


207 
	#NSIG
 
_NSIG


	)

210 #ifde‡
__USE_GNU


211 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

215 #ifde‡
__USE_BSD


216 
__sigh™dÀr_t
 
	tsig_t
;

219 #ifde‡
__USE_POSIX


222 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

225 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

228 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

231 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

234 
	$sigismembî
 (
__c⁄°
 
sig£t_t
 *
__£t
, 
__signo
)

235 
__THROW
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__USE_GNU


239 
	$sigi£m±y£t
 (
__c⁄°
 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

242 
	$sig™d£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

243 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

246 
	$sig‹£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

247 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

252 
	~<bôs/siga˘i⁄.h
>

255 
	$sig¥ocmask
 (
__how
, 
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

256 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

263 
	$sigsu•íd
 (
__c⁄°
 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

266 
	$siga˘i⁄
 (
__sig
, 
__c⁄°
 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

267 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

270 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

277 
	$sigwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

278 
	`__n⁄nuŒ
 ((1, 2));

280 #ifde‡
__USE_POSIX199309


285 
	$sigwaôöfo
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

286 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

293 
	$sigtimedwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

294 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

295 
__c⁄°
 
time•ec
 *
__ª°ri˘
 
__timeout
)

296 
	`__n⁄nuŒ
 ((1));

300 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__c⁄°
 
sigvÆ
 
__vÆ
)

301 
__THROW
;

306 #ifde‡
__USE_BSD


310 
__c⁄°
 *__c⁄° 
_sys_sigli°
[
_NSIG
];

311 
__c⁄°
 *__c⁄° 
sys_sigli°
[
_NSIG
];

314 
	ssigvec


316 
__sigh™dÀr_t
 
sv_h™dÀr
;

317 
sv_mask
;

319 
sv_Êags
;

320 
	#sv_⁄°ack
 
sv_Êags


	)

324 
	#SV_ONSTACK
 (1 << 0)

	)

325 
	#SV_INTERRUPT
 (1 << 1)

	)

326 
	#SV_RESETHAND
 (1 << 2)

	)

334 
	$sigvec
 (
__sig
, 
__c⁄°
 
sigvec
 *
__vec
,

335 
sigvec
 *
__ovec
Ë
__THROW
;

339 
	~<bôs/sigc⁄ãxt.h
>

342 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

347 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


348 
	#__√ed_size_t


	)

349 
	~<°ddef.h
>

354 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

356 
	~<bôs/sig°ack.h
>

357 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


359 
	~<sys/uc⁄ãxt.h
>

365 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

366 
__THROW
 
__©åibuã_dïªˇãd__
;

370 
	$sigÆt°ack
 (
__c⁄°
 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

371 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

375 #ifde‡
__USE_XOPEN_EXTENDED


379 
	$sighﬁd
 (
__sig
Ë
__THROW
;

382 
	$sigªl£
 (
__sig
Ë
__THROW
;

385 
	$sigign‹e
 (
__sig
Ë
__THROW
;

388 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

391 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


394 
	~<bôs/±hªadty≥s.h
>

395 
	~<bôs/sigthªad.h
>

402 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

404 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

408 
__END_DECLS


	@/usr/include/stdint.h

23 #i‚de‡
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/wch¨.h
>

28 
	~<bôs/w‹dsize.h
>

35 #i‚de‡
__öt8_t_deföed


36 
	#__öt8_t_deföed


	)

37 sig√d 
	töt8_t
;

38 
	töt16_t
;

39 
	töt32_t
;

40 #i‡
__WORDSIZE
 == 64

41 
	töt64_t
;

43 
__exãnsi⁄__


44 
	töt64_t
;

49 
	tuöt8_t
;

50 
	tuöt16_t
;

51 #i‚de‡
__uöt32_t_deföed


52 
	tuöt32_t
;

53 
	#__uöt32_t_deföed


	)

55 #i‡
__WORDSIZE
 == 64

56 
	tuöt64_t
;

58 
__exãnsi⁄__


59 
	tuöt64_t
;

66 sig√d 
	töt_Àa°8_t
;

67 
	töt_Àa°16_t
;

68 
	töt_Àa°32_t
;

69 #i‡
__WORDSIZE
 == 64

70 
	töt_Àa°64_t
;

72 
__exãnsi⁄__


73 
	töt_Àa°64_t
;

77 
	tuöt_Àa°8_t
;

78 
	tuöt_Àa°16_t
;

79 
	tuöt_Àa°32_t
;

80 #i‡
__WORDSIZE
 == 64

81 
	tuöt_Àa°64_t
;

83 
__exãnsi⁄__


84 
	tuöt_Àa°64_t
;

91 sig√d 
	töt_Á°8_t
;

92 #i‡
__WORDSIZE
 == 64

93 
	töt_Á°16_t
;

94 
	töt_Á°32_t
;

95 
	töt_Á°64_t
;

97 
	töt_Á°16_t
;

98 
	töt_Á°32_t
;

99 
__exãnsi⁄__


100 
	töt_Á°64_t
;

104 
	tuöt_Á°8_t
;

105 #i‡
__WORDSIZE
 == 64

106 
	tuöt_Á°16_t
;

107 
	tuöt_Á°32_t
;

108 
	tuöt_Á°64_t
;

110 
	tuöt_Á°16_t
;

111 
	tuöt_Á°32_t
;

112 
__exãnsi⁄__


113 
	tuöt_Á°64_t
;

118 #i‡
__WORDSIZE
 == 64

119 #i‚de‡
__öçå_t_deföed


120 
	töçå_t
;

121 
	#__öçå_t_deföed


	)

123 
	tuöçå_t
;

125 #i‚de‡
__öçå_t_deföed


126 
	töçå_t
;

127 
	#__öçå_t_deföed


	)

129 
	tuöçå_t
;

134 #i‡
__WORDSIZE
 == 64

135 
	tötmax_t
;

136 
	tuötmax_t
;

138 
__exãnsi⁄__


139 
	tötmax_t
;

140 
__exãnsi⁄__


141 
	tuötmax_t
;

147 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_LIMIT_MACROS


149 #i‡
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
Ë¯## 
L


	)

151 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

153 
	#__INT64_C
(
c
Ë¯## 
LL


	)

154 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #i‡
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #i‡
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #i‡
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #i‡
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #i‡
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #i‡
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #i‚de‡
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
Ë
	)
c

291 
	#INT16_C
(
c
Ë
	)
c

292 
	#INT32_C
(
c
Ë
	)
c

293 #i‡
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
Ë¯## 
L


	)

296 
	#INT64_C
(
c
Ë¯## 
LL


	)

300 
	#UINT8_C
(
c
Ë
	)
c

301 
	#UINT16_C
(
c
Ë
	)
c

302 
	#UINT32_C
(
c
Ë¯## 
U


	)

303 #i‡
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
Ë¯## 
UL


	)

306 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

310 #i‡
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
Ë¯## 
L


	)

312 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

314 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

315 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/stdio.h

24 #i‚de‡
_STDIO_H


26 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

36 
	~<bôs/ty≥s.h
>

37 
	#__√ed_FILE


	)

38 
	#__√ed___FILE


	)

42 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

52 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

53 || 
deföed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_deföed
 1

	)

59 #unde‡
__√ed_FILE


62 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_deföed
 1

	)

69 #unde‡
__√ed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


78 #ifde‡
__GNUC__


79 #i‚de‡
_VA_LIST_DEFINED


80 
_G_va_li°
 
	tva_li°
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<°d¨g.h
>

88 #ifde‡
__USE_XOPEN2K8


89 #i‚de‡
__off_t_deföed


90 #i‚de‡
__USE_FILE_OFFSET64


91 
__off_t
 
	toff_t
;

93 
__off64_t
 
	toff_t
;

95 
	#__off_t_deföed


	)

97 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


98 
__off64_t
 
	toff64_t
;

99 
	#__off64_t_deföed


	)

102 #i‚de‡
__ssize_t_deföed


103 
__ssize_t
 
	tssize_t
;

104 
	#__ssize_t_deföed


	)

109 
__BEGIN_NAMESPACE_STD


110 #i‚de‡
__USE_FILE_OFFSET64


111 
_G_Âos_t
 
	tÂos_t
;

113 
_G_Âos64_t
 
	tÂos_t
;

115 
__END_NAMESPACE_STD


116 #ifde‡
__USE_LARGEFILE64


117 
_G_Âos64_t
 
	tÂos64_t
;

121 
	#_IOFBF
 0

	)

122 
	#_IOLBF
 1

	)

123 
	#_IONBF
 2

	)

127 #i‚de‡
BUFSIZ


128 
	#BUFSIZ
 
_IO_BUFSIZ


	)

134 #i‚de‡
EOF


135 
	#EOF
 (-1)

	)

141 
	#SEEK_SET
 0

	)

142 
	#SEEK_CUR
 1

	)

143 
	#SEEK_END
 2

	)

144 #ifde‡
__USE_GNU


145 
	#SEEK_DATA
 3

	)

146 
	#SEEK_HOLE
 4

	)

150 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


152 
	#P_tmpdú
 "/tmp"

	)

165 
	~<bôs/°dio_lim.h
>

169 
_IO_FILE
 *
°dö
;

170 
_IO_FILE
 *
°dout
;

171 
_IO_FILE
 *
°dîr
;

173 
	#°dö
 
°dö


	)

174 
	#°dout
 
°dout


	)

175 
	#°dîr
 
°dîr


	)

177 
__BEGIN_NAMESPACE_STD


179 
	$ªmove
 (
__c⁄°
 *
__fûíame
Ë
__THROW
;

181 
	$ª«me
 (
__c⁄°
 *
__ﬁd
, __c⁄° *
__√w
Ë
__THROW
;

182 
__END_NAMESPACE_STD


184 #ifde‡
__USE_ATFILE


186 
	$ª«mót
 (
__ﬁdfd
, 
__c⁄°
 *
__ﬁd
, 
__√wfd
,

187 
__c⁄°
 *
__√w
Ë
__THROW
;

190 
__BEGIN_NAMESPACE_STD


195 #i‚de‡
__USE_FILE_OFFSET64


196 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

198 #ifde‡
__REDIRECT


199 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

201 
	#tmpfûe
 
tmpfûe64


	)

205 #ifde‡
__USE_LARGEFILE64


206 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

210 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

211 
__END_NAMESPACE_STD


213 #ifde‡
__USE_MISC


216 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

220 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


228 *
	$ãm≤am
 (
__c⁄°
 *
__dú
, __c⁄° *
__pfx
)

229 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

233 
__BEGIN_NAMESPACE_STD


238 
	`f˛o£
 (
FILE
 *
__°ªam
);

243 
	`fÊush
 (
FILE
 *
__°ªam
);

244 
__END_NAMESPACE_STD


246 #ifde‡
__USE_MISC


253 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

256 #ifde‡
__USE_GNU


263 
	`f˛o£Æl
 ();

267 
__BEGIN_NAMESPACE_STD


268 #i‚de‡
__USE_FILE_OFFSET64


273 
FILE
 *
	$f›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

274 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

279 
FILE
 *
	$‰e›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

280 
__c⁄°
 *
__ª°ri˘
 
__modes
,

281 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

283 #ifde‡
__REDIRECT


284 
FILE
 *
	`__REDIRECT
 (
f›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

285 
__c⁄°
 *
__ª°ri˘
 
__modes
), 
f›í64
)

286 
__wur
;

287 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

288 
__c⁄°
 *
__ª°ri˘
 
__modes
,

289 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

290 
__wur
;

292 
	#f›í
 
f›í64


	)

293 
	#‰e›í
 
‰e›í64


	)

296 
__END_NAMESPACE_STD


297 #ifde‡
__USE_LARGEFILE64


298 
FILE
 *
	$f›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

299 
__c⁄°
 *
__ª°ri˘
 
__modes
Ë
__wur
;

300 
FILE
 *
	$‰e›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

301 
__c⁄°
 *
__ª°ri˘
 
__modes
,

302 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

305 #ifdef 
__USE_POSIX


307 
FILE
 *
	$fd›í
 (
__fd
, 
__c⁄°
 *
__modes
Ë
__THROW
 
__wur
;

310 #ifdef 
__USE_GNU


313 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

314 
__c⁄°
 *
__ª°ri˘
 
__modes
,

315 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

318 #ifde‡
__USE_XOPEN2K8


320 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, 
__c⁄°
 *
__modes
)

321 
__THROW
 
__wur
;

326 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

330 
__BEGIN_NAMESPACE_STD


333 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

337 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

338 
__modes
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdef 
__USE_BSD


344 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

345 
size_t
 
__size
Ë
__THROW
;

348 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

352 
__BEGIN_NAMESPACE_STD


357 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

358 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

363 
	`¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

365 
	$•rötf
 (*
__ª°ri˘
 
__s
,

366 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

372 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

373 
_G_va_li°
 
__¨g
);

378 
	`v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

380 
	$v•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

381 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

382 
__END_NAMESPACE_STD


384 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


385 
__BEGIN_NAMESPACE_C99


387 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

388 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

389 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

391 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

392 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

393 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

394 
__END_NAMESPACE_C99


397 #ifde‡
__USE_GNU


400 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__f
,

401 
_G_va_li°
 
__¨g
)

402 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

403 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

404 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

405 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

406 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

407 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

408 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

411 #ifde‡
__USE_XOPEN2K8


418 
	$vd¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
,

419 
_G_va_li°
 
__¨g
)

420 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

421 
	$d¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

422 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

426 
__BEGIN_NAMESPACE_STD


431 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

432 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

437 
	$sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

439 
	$ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

440 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

442 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

443 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

444 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

445 #ifde‡
__REDIRECT


449 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

450 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

451 
__isoc99_fsˇnf
Ë
__wur
;

452 
	`__REDIRECT
 (
sˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

453 
__isoc99_sˇnf
Ë
__wur
;

454 
	`__REDIRECT_NTH
 (
ssˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__s
,

455 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...),

456 
__isoc99_ssˇnf
);

458 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

459 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

460 
	$__isoc99_sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

461 
	$__isoc99_ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

462 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

463 
	#fsˇnf
 
__isoc99_fsˇnf


	)

464 
	#sˇnf
 
__isoc99_sˇnf


	)

465 
	#ssˇnf
 
__isoc99_ssˇnf


	)

469 
__END_NAMESPACE_STD


471 #ifdef 
__USE_ISOC99


472 
__BEGIN_NAMESPACE_C99


477 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

478 
_G_va_li°
 
__¨g
)

479 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

485 
	$vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

486 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

489 
	$vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

490 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

491 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

493 #i‡!
deföed
 
__USE_GNU
 \

494 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

495 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

496 #ifde‡
__REDIRECT


500 
	`__REDIRECT
 (
vfsˇnf
,

501 (
FILE
 *
__ª°ri˘
 
__s
,

502 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

503 
__isoc99_vfsˇnf
)

504 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

505 
	`__REDIRECT
 (
vsˇnf
, (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

506 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

507 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

508 
	`__REDIRECT_NTH
 (
vssˇnf
,

509 (
__c⁄°
 *
__ª°ri˘
 
__s
,

510 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

511 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

512 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

514 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

515 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

516 
_G_va_li°
 
__¨g
Ë
__wur
;

517 
	$__isoc99_vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

518 
_G_va_li°
 
__¨g
Ë
__wur
;

519 
	$__isoc99_vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

520 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

521 
_G_va_li°
 
__¨g
Ë
__THROW
;

522 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

523 
	#vsˇnf
 
__isoc99_vsˇnf


	)

524 
	#vssˇnf
 
__isoc99_vssˇnf


	)

528 
__END_NAMESPACE_C99


532 
__BEGIN_NAMESPACE_STD


537 
	`fgëc
 (
FILE
 *
__°ªam
);

538 
	`gëc
 (
FILE
 *
__°ªam
);

544 
	`gëch¨
 ();

545 
__END_NAMESPACE_STD


549 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

551 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


556 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

557 
	`gëch¨_u∆ocked
 ();

560 #ifde‡
__USE_MISC


567 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

571 
__BEGIN_NAMESPACE_STD


579 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

586 
	`putch¨
 (
__c
);

587 
__END_NAMESPACE_STD


591 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

593 #ifde‡
__USE_MISC


600 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


608 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

609 
	`putch¨_u∆ocked
 (
__c
);

613 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

614 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

616 
	`gëw
 (
FILE
 *
__°ªam
);

619 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

623 
__BEGIN_NAMESPACE_STD


628 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

629 
__wur
;

636 *
	$gës
 (*
__s
Ë
__wur
;

637 
__END_NAMESPACE_STD


639 #ifde‡
__USE_GNU


646 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

647 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

651 #ifdef 
__USE_XOPEN2K8


662 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

663 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

664 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

665 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

675 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

676 
size_t
 *
__ª°ri˘
 
__n
,

677 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

681 
__BEGIN_NAMESPACE_STD


686 
	`Âuts
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

692 
	`puts
 (
__c⁄°
 *
__s
);

699 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

706 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

707 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

712 
size_t
 
	`fwrôe
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

713 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

714 
__END_NAMESPACE_STD


716 #ifde‡
__USE_GNU


723 
	`Âuts_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

724 
FILE
 *
__ª°ri˘
 
__°ªam
);

727 #ifde‡
__USE_MISC


734 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

735 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

736 
size_t
 
	`fwrôe_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

737 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

741 
__BEGIN_NAMESPACE_STD


746 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

751 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

756 
	`ªwöd
 (
FILE
 *
__°ªam
);

757 
__END_NAMESPACE_STD


764 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


765 #i‚de‡
__USE_FILE_OFFSET64


770 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

775 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

777 #ifde‡
__REDIRECT


778 
	`__REDIRECT
 (
f£eko
,

779 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

780 
f£eko64
);

781 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

783 
	#f£eko
 
f£eko64


	)

784 
	#·ñlo
 
·ñlo64


	)

789 
__BEGIN_NAMESPACE_STD


790 #i‚de‡
__USE_FILE_OFFSET64


795 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

800 
	`f£ços
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
);

802 #ifde‡
__REDIRECT


803 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

804 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

805 
	`__REDIRECT
 (
f£ços
,

806 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
), 
f£ços64
);

808 
	#fgëpos
 
fgëpos64


	)

809 
	#f£ços
 
f£ços64


	)

812 
__END_NAMESPACE_STD


814 #ifde‡
__USE_LARGEFILE64


815 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

816 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

817 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

818 
	`f£ços64
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos64_t
 *
__pos
);

821 
__BEGIN_NAMESPACE_STD


823 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

825 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

827 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

828 
__END_NAMESPACE_STD


830 #ifde‡
__USE_MISC


832 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

833 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

834 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

838 
__BEGIN_NAMESPACE_STD


843 
	`≥º‹
 (
__c⁄°
 *
__s
);

844 
__END_NAMESPACE_STD


850 
	~<bôs/sys_îæi°.h
>

853 #ifdef 
__USE_POSIX


855 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

858 #ifde‡
__USE_MISC


860 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

864 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

865 
deföed
 
__USE_MISC
)

870 
FILE
 *
	$p›í
 (
__c⁄°
 *
__comm™d
, __c⁄° *
__modes
Ë
__wur
;

876 
	`p˛o£
 (
FILE
 *
__°ªam
);

880 #ifdef 
__USE_POSIX


882 *
	$˘îmid
 (*
__s
Ë
__THROW
;

886 #ifde‡
__USE_XOPEN


888 *
	`cu£rid
 (*
__s
);

892 #ifdef 
__USE_GNU


893 
ob°ack
;

896 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

897 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

898 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

899 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

901 
_G_va_li°
 
__¨gs
)

902 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

906 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


910 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

914 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

917 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

920 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


924 
	#__√ed_gë›t


	)

925 
	~<gë›t.h
>

930 #ifde‡
__USE_EXTERN_INLINES


931 
	~<bôs/°dio.h
>

933 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


934 
	~<bôs/°dio2.h
>

936 #ifde‡
__LDBL_COMPAT


937 
	~<bôs/°dio-ldbl.h
>

940 
__END_DECLS


	@/usr/include/stdlib.h

23 #i‚def 
_STDLIB_H


25 
	~<„©uªs.h
>

28 
	#__√ed_size_t


	)

29 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


30 
	#__√ed_wch¨_t


	)

31 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	g__BEGIN_DECLS


37 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


38 
	#_STDLIB_H
 1

	)

40 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


42 
	~<bôs/waôÊags.h
>

43 
	~<bôs/waô°©us.h
>

45 #ifde‡
__USE_BSD


50 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


51 
	#__WAIT_INT
(
°©us
) \

52 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

53 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

55 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

63 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
waô
 *
	m__u±r
;

71 *
	m__ùå
;

72 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

90 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

91 #ifde‡
__WIFCONTINUED


92 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquŸ
;

101 
	mªm
;

102 } 
	tdiv_t
;

105 #i‚de‡
__ldiv_t_deföed


108 
	mquŸ
;

109 
	mªm
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_deföed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


116 
__BEGIN_NAMESPACE_C99


118 
__exãnsi⁄__
 struct

120 
	mquŸ
;

121 
	mªm
;

122 } 
	tŒdiv_t
;

123 
	#__Œdiv_t_deföed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

140 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__c⁄°
 *
__≈å
)

146 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

148 
	$©oi
 (
__c⁄°
 *
__≈å
)

149 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

151 
	$©ﬁ
 (
__c⁄°
 *
__≈å
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

153 
__END_NAMESPACE_STD


155 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__exãnsi⁄__
 
	$©ﬁl
 (
__c⁄°
 *
__≈å
)

159 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$°πod
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

166 **
__ª°ri˘
 
__íd±r
)

167 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$°πof
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

174 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

176 
	$°πﬁd
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$°πﬁ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

185 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

186 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

188 
	$°πoul
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

189 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

190 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

191 
__END_NAMESPACE_STD


193 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


195 
__exãnsi⁄__


196 
	$°πoq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

197 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

198 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

200 
__exãnsi⁄__


201 
	$°πouq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

202 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

203 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

206 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__exãnsi⁄__


210 
	$°πﬁl
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

211 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

212 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

214 
__exãnsi⁄__


215 
	$°πouŒ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

216 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

217 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

218 
__END_NAMESPACE_C99


222 #ifde‡
__USE_GNU


236 
	~<xloˇÀ.h
>

240 
	$°πﬁ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

241 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

242 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

244 
	$°πoul_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

245 **
__ª°ri˘
 
__íd±r
,

246 
__ba£
, 
__loˇÀ_t
 
__loc
)

247 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

249 
__exãnsi⁄__


250 
	$°πﬁl_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

251 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

252 
__loˇÀ_t
 
__loc
)

253 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

255 
__exãnsi⁄__


256 
	$°πouŒ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

257 **
__ª°ri˘
 
__íd±r
,

258 
__ba£
, 
__loˇÀ_t
 
__loc
)

259 
__THROW
 
	`__n⁄nuŒ
 ((1, 4)Ë
__wur
;

261 
	$°πod_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

262 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

263 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

265 
	$°πof_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

266 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

267 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

269 
	$°πﬁd_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

270 **
__ª°ri˘
 
__íd±r
,

271 
__loˇÀ_t
 
__loc
)

272 
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

276 #ifde‡
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__exã∫_ölöe
 

279 
	`__NTH
 (
	$©of
 (
__c⁄°
 *
__≈å
))

281  
	`°πod
 (
__≈å
, (**Ë
NULL
);

282 
	}
}

283 
__exã∫_ölöe
 

284 
__NTH
 (
	$©oi
 (
__c⁄°
 *
__≈å
))

286  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

287 
	}
}

288 
__exã∫_ölöe
 

289 
__NTH
 (
	$©ﬁ
 (
__c⁄°
 *
__≈å
))

291  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__exãnsi⁄__
 
__exã∫_ölöe
 

298 
__NTH
 (
	$©ﬁl
 (
__c⁄°
 *
__≈å
))

300  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

314 
	$a64l
 (
__c⁄°
 *
__s
)

315 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


320 
	~<sys/ty≥s.h
>

327 
	$øndom
 (Ë
__THROW
;

330 
	$§™dom
 (
__£ed
Ë
__THROW
;

336 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

337 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

341 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

344 #ifde‡
__USE_MISC


349 
	søndom_d©a


351 
öt32_t
 *
Âå
;

352 
öt32_t
 *
Ωå
;

353 
öt32_t
 *
°©e
;

354 
ønd_ty≥
;

355 
ønd_deg
;

356 
ønd_£p
;

357 
öt32_t
 *
íd_±r
;

360 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

361 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

363 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

364 
__THROW
 
	`__n⁄nuŒ
 ((2));

366 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

367 
size_t
 
__°©ñí
,

368 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

369 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

371 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

372 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

373 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$ønd
 (Ë
__THROW
;

382 
	$§™d
 (
__£ed
Ë
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifde‡
__USE_POSIX


387 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

391 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


395 
	$dønd48
 (Ë
__THROW
;

396 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

399 
	$Ã™d48
 (Ë
__THROW
;

400 
	$ƒ™d48
 (
__xsubi
[3])

401 
__THROW
 
	`__n⁄nuŒ
 ((1));

404 
	$mønd48
 (Ë
__THROW
;

405 
	$jønd48
 (
__xsubi
[3])

406 
__THROW
 
	`__n⁄nuŒ
 ((1));

409 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__n⁄nuŒ
 ((1));

412 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

414 #ifde‡
__USE_MISC


418 
	sdønd48_d©a


420 
__x
[3];

421 
__ﬁd_x
[3];

422 
__c
;

423 
__öô
;

424 
__a
;

428 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

429 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$î™d48_r
 (
__xsubi
[3],

431 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

432 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

435 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

436 *
__ª°ri˘
 
__ªsu…
)

437 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$ƒ™d48_r
 (
__xsubi
[3],

439 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

445 *
__ª°ri˘
 
__ªsu…
)

446 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$jønd48_r
 (
__xsubi
[3],

448 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

449 *
__ª°ri˘
 
__ªsu…
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

454 
__THROW
 
	`__n⁄nuŒ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$lc⁄g48_r
 (
__∑øm
[7],

460 
dønd48_d©a
 *
__buf„r
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

467 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


468 
	#__mÆloc_™d_ˇŒoc_deföed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

473 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

474 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

488 
	$‰ì
 (*
__±r
Ë
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$c‰ì
 (*
__±r
Ë
__THROW
;

496 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


497 
	~<Æloˇ.h
>

500 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

501 || 
deföed
 
__USE_BSD


503 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

506 #ifde‡
__USE_XOPEN2K


508 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #ifde‡
__USE_GNU


524 #ifde‡
__˝lu•lus


525 "C++" 
	`©_quick_exô
 ((*
__func
) ())

526 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

528 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

531 
__END_NAMESPACE_STD


533 #ifdef 
__USE_MISC


536 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

537 
__THROW
 
	`__n⁄nuŒ
 ((1));

540 
__BEGIN_NAMESPACE_STD


544 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

546 #ifde‡
__USE_GNU


552 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

554 
__END_NAMESPACE_STD


556 #ifde‡
__USE_ISOC99


557 
__BEGIN_NAMESPACE_C99


560 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

561 
__END_NAMESPACE_C99


565 
__BEGIN_NAMESPACE_STD


567 *
	$gëív
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

568 
__END_NAMESPACE_STD


572 *
	$__£cuª_gëív
 (
__c⁄°
 *
__«me
)

573 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

575 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


579 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

582 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


585 
	$£ãnv
 (
__c⁄°
 *
__«me
, __c⁄° *
__vÆue
, 
__ª∂a˚
)

586 
__THROW
 
	`__n⁄nuŒ
 ((2));

589 
	$un£ãnv
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

592 #ifdef 
__USE_MISC


596 
	$˛óªnv
 (Ë
__THROW
;

600 #i‡
deföed
 
__USE_MISC
 \

601 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (
__c⁄°
 *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (
__c⁄°
 *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
Ë(
	t__c⁄°
 *, __const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
Ë(
	t__c⁄°
 *, __const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (
__c⁄°
 *
__key
, __c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

761 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

762 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

763 #ifde‡
__USE_GNU


764 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

765 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

766 
	`__n⁄nuŒ
 ((1, 4));

771 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

773 
__END_NAMESPACE_STD


775 #ifde‡
__USE_ISOC99


776 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

777 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

781 
__BEGIN_NAMESPACE_STD


785 
div_t
 
	$div
 (
__numî
, 
__díom
)

786 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

787 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

788 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

789 
__END_NAMESPACE_STD


791 #ifde‡
__USE_ISOC99


792 
__BEGIN_NAMESPACE_C99


793 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

794 
__díom
)

795 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

796 
__END_NAMESPACE_C99


800 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

801 || 
deföed
 
__USE_SVID


808 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

809 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

814 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

815 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

820 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

821 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

824 #ifde‡
__USE_MISC


826 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

827 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

828 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

829 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

830 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

831 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

832 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

833 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

838 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

839 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

840 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

841 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

842 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

843 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

846 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

847 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

848 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

857 
__BEGIN_NAMESPACE_STD


860 
	$mbÀn
 (
__c⁄°
 *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

863 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

864 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

867 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

871 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

872 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

874 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

875 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

876 
__THROW
;

877 
__END_NAMESPACE_STD


880 #ifde‡
__USE_SVID


885 
	$Ωm©ch
 (
__c⁄°
 *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

889 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


896 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

897 *
__c⁄°
 *
__ª°ri˘
 
__tokís
,

898 **
__ª°ri˘
 
__vÆuï
)

899 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

903 #ifde‡
__USE_XOPEN


905 
	$£tkey
 (
__c⁄°
 *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

911 #ifde‡
__USE_XOPEN2KXSI


913 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

916 #ifde‡
__USE_XOPEN


921 
	$gø¡±
 (
__fd
Ë
__THROW
;

925 
	$u∆ock±
 (
__fd
Ë
__THROW
;

930 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

933 #ifde‡
__USE_GNU


937 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

938 
__THROW
 
	`__n⁄nuŒ
 ((2));

941 
	`gë±
 ();

944 #ifde‡
__USE_BSD


948 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

949 
__THROW
 
	`__n⁄nuŒ
 ((1));

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/string.h

24 #i‚def 
_STRING_H


25 
	#_STRING_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 
__BEGIN_NAMESPACE_STD


44 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
,

45 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

46 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

49 *
	$memmove
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

50 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

51 
__END_NAMESPACE_STD


56 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


57 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

58 
__c
, 
size_t
 
__n
)

59 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

63 
__BEGIN_NAMESPACE_STD


65 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

68 
	$memcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

72 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


75 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

76 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 
__c⁄°
 *
	`memchr
 (__c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

80 #ifde‡
__OPTIMIZE__


81 
__exã∫_Æways_ölöe
 *

82 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


84  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

87 
__exã∫_Æways_ölöe
 
__c⁄°
 *

88 
	`memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


90  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

93 
	}
}

95 *
	$memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

96 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

98 
__END_NAMESPACE_STD


100 #ifde‡
__USE_GNU


103 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


104 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

105 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 "C++" 
__c⁄°
 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

107 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

109 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
)

110 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

116 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 "C++" 
__c⁄°
 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

120 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

126 
__BEGIN_NAMESPACE_STD


128 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

129 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

131 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

132 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

133 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

137 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

139 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

140 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°rcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

146 
	$°∫cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

147 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
	$°rcﬁl
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

153 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

154 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

155 
__THROW
 
	`__n⁄nuŒ
 ((2));

156 
__END_NAMESPACE_STD


158 #ifde‡
__USE_XOPEN2K8


162 
	~<xloˇÀ.h
>

165 
	$°rcﬁl_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

166 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

168 
size_t
 
	$°rx‰m_l
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
,

169 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

172 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

173 || 
deföed
 
__USE_XOPEN2K8


175 *
	$°rdup
 (
__c⁄°
 *
__s
)

176 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

182 #i‡
deföed
 
__USE_XOPEN2K8


183 *
	$°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

184 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

187 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


189 
	#°rdu∑
(
s
) \

190 (
__exãnsi⁄__
 \

192 
__c⁄°
 *
__ﬁd
 = (
s
); \

193 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

194 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

195 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

196 
	}
}))

	)

199 
	#°∫du∑
(
s
, 
n
) \

200 (
__exãnsi⁄__
 \

202 
__c⁄°
 *
__ﬁd
 = (
s
); \

203 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

204 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

205 
__√w
[
__Àn
] = '\0'; \

206 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

207 }))

	)

210 
	g__BEGIN_NAMESPACE_STD


212 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


215 *
°rchr
 (*
__s
, 
__c
)

216 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 
__c⁄°
 *
°rchr
 (__c⁄° *
__s
, 
__c
)

218 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

220 #ifde‡
__OPTIMIZE__


221 
__exã∫_Æways_ölöe
 *

222 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


224  
__buûtö_°rchr
 (
__s
, 
__c
);

227 
__exã∫_Æways_ölöe
 
__c⁄°
 *

228 
°rchr
 (
__c⁄°
 *
__s
, 
__c
Ë
	g__THROW


230  
__buûtö_°rchr
 (
__s
, 
__c
);

235 *
	$°rchr
 (
__c⁄°
 *
__s
, 
__c
)

236 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

239 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


242 *
	`°ºchr
 (*
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 
__c⁄°
 *
	`°ºchr
 (__c⁄° *
__s
, 
__c
)

245 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

247 #ifde‡
__OPTIMIZE__


248 
__exã∫_Æways_ölöe
 *

249 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


251  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

254 
__exã∫_Æways_ölöe
 
__c⁄°
 *

255 
	`°ºchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


257  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

260 
	}
}

262 *
	$°ºchr
 (
__c⁄°
 *
__s
, 
__c
)

263 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

265 
__END_NAMESPACE_STD


267 #ifde‡
__USE_GNU


270 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


271 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 "C++" 
__c⁄°
 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

274 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

276 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
)

277 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

281 
__BEGIN_NAMESPACE_STD


284 
size_t
 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

285 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 
size_t
 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

289 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

291 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


294 *
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
)

295 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 
__c⁄°
 *
	`°Ωbrk
 (__c⁄° *
__s
, __c⁄° *
__ac˚±
)

297 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

299 #ifde‡
__OPTIMIZE__


300 
__exã∫_Æways_ölöe
 *

301 
	`°Ωbrk
 (*
__s
, 
__c⁄°
 *
__ac˚±
Ë
__THROW


303  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

306 
__exã∫_Æways_ölöe
 
__c⁄°
 *

307 
	`°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
Ë
__THROW


309  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

312 
	}
}

314 *
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

315 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

318 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


321 *
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

322 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 
__c⁄°
 *
	`°r°r
 (__c⁄° *
__hay°ack
,

324 
__c⁄°
 *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 
__c⁄°
 *

335 
	`°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 
__c⁄°
 *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, 
__c⁄°
 *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" 
__c⁄°
 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
,

370 
__c⁄°
 *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (
__c⁄°
 *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 
__c⁄°
 *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (
__c⁄°
 *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (
__c⁄°
 *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2));

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (
__c⁄°
 *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 
__c⁄°
 *
	`ödex
 (__c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 
__c⁄°
 *

482 
	`ödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (
__c⁄°
 *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 
__c⁄°
 *
	`rödex
 (__c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 
__c⁄°
 *

510 
	`rödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (
__c⁄°
 *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 #ifde‡
__GNUC__


530 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

531 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

536 
	$°rˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 
	$°∫ˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

541 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

544 #ifdef 
__USE_GNU


547 
	$°rˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

548 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

551 
	$°∫ˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

552 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

553 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

556 #ifdef 
__USE_BSD


559 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

560 
__c⁄°
 *
__ª°ri˘
 
__dñim
)

561 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

564 #ifdef 
__USE_XOPEN2K8


566 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

569 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

571 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

572 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

576 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

577 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

578 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

579 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

580 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

581 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 #ifdef 
__USE_GNU


586 
	$°rvîscmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

587 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

590 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

595 #i‚de‡
ba£«me


600 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


601 "C++" *
	$ba£«me
 (*
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

603 "C++" 
__c⁄°
 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
)

604 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

606 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

612 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

613 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

614 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


634 
	~<bôs/°rög.h
>

637 
	~<bôs/°rög2.h
>

640 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


642 
	~<bôs/°rög3.h
>

646 
__END_DECLS


	@/usr/include/termios.h

23 #i‚def 
_TERMIOS_H


24 
	#_TERMIOS_H
 1

	)

26 
	~<„©uªs.h
>

27 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


29 
	~<bôs/ty≥s.h
>

30 #i‚de‡
__pid_t_deföed


31 
__pid_t
 
	tpid_t
;

32 
	#__pid_t_deföed


	)

36 
	g__BEGIN_DECLS


40 
	~<bôs/ãrmios.h
>

42 #ifde‡
__USE_BSD


45 
	#CCEQ
(
vÆ
, 
c
Ë((cË=(vÆË&& (vÆË!
_POSIX_VDISABLE
)

	)

49 
•ìd_t
 
	$cfgëo•ìd
 (
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

52 
•ìd_t
 
	$cfgëi•ìd
 (
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

55 
	$cf£to•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

58 
	$cf£ti•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

60 #ifdef 
__USE_BSD


62 
	$cf£t•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

67 
	$tcgë©å
 (
__fd
, 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

71 
	$tc£èâr
 (
__fd
, 
__›ti⁄Æ_a˘i⁄s
,

72 
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

75 #ifdef 
__USE_BSD


77 
	$cfmakîaw
 (
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

81 
	$tc£ndbªak
 (
__fd
, 
__duøti⁄
Ë
__THROW
;

87 
	`tcdøö
 (
__fd
);

91 
	$tcÊush
 (
__fd
, 
__queue_£À˘‹
Ë
__THROW
;

95 
	$tcÊow
 (
__fd
, 
__a˘i⁄
Ë
__THROW
;

98 #ifde‡
__USE_UNIX98


100 
__pid_t
 
	$tcgësid
 (
__fd
Ë
__THROW
;

104 #ifde‡
__USE_BSD


105 
	~<sys/âydeÁu…s.h
>

108 
__END_DECLS


	@/usr/include/time.h

23 #i‚def 
_TIME_H


25 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

26 ! 
deföed
 
	g__√ed_time•ec
)

27 
	#_TIME_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__√ed_size_t


	)

37 
	#__√ed_NULL


	)

38 
	~<°ddef.h
>

42 
	~<bôs/time.h
>

45 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


46 #i‚de‡
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

54 
	#__˛ock_t_deföed
 1

	)

56 
	~<bôs/ty≥s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__˛ock_t
 
	t˛ock_t
;

61 
	g__END_NAMESPACE_STD


62 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

67 #unde‡
__√ed_˛ock_t


69 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

70 
	#__time_t_deföed
 1

	)

72 
	~<bôs/ty≥s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #unde‡
__√ed_time_t


85 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

86 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

87 
	#__˛ockid_t_deföed
 1

	)

89 
	~<bôs/ty≥s.h
>

92 
__˛ockid_t
 
	t˛ockid_t
;

95 #unde‡
__˛ockid_time_t


97 #i‡!
deföed
 
__timî_t_deföed
 && \

98 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

99 
	#__timî_t_deföed
 1

	)

101 
	~<bôs/ty≥s.h
>

104 
__timî_t
 
	ttimî_t
;

107 #unde‡
__√ed_timî_t


110 #i‡!
deföed
 
__time•ec_deföed
 && \

111 ((
deföed
 
_TIME_H
 && \

112 (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
)) || \

113 
deföed
 
__√ed_time•ec
)

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__c⁄°
 *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 
__c⁄°
 *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 
__BEGIN_NAMESPACE_STD


183 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

189 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

190 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

193 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

199 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

200 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

201 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifde‡
__USE_XOPEN


207 *
	$°Ωtime
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

208 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

209 
__THROW
;

212 #ifde‡
__USE_XOPEN2K8


215 
	~<xloˇÀ.h
>

217 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

218 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

219 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

220 
__loˇÀ_t
 
__loc
Ë
__THROW
;

223 #ifde‡
__USE_GNU


224 *
	$°Ωtime_l
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

225 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

237 
tm
 *
	$loˇ…ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

238 
__END_NAMESPACE_STD


240 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

244 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

248 
tm
 *
	$loˇ…ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

249 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$as˘ime
 (
__c⁄°
 
tm
 *
__ç
Ë
__THROW
;

258 *
	$˘ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

259 
__END_NAMESPACE_STD


261 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


266 *
	$as˘ime_r
 (
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

267 *
__ª°ri˘
 
__buf
Ë
__THROW
;

270 *
	$˘ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

271 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
__tz«me
[2];

277 
__daylight
;

278 
__timez⁄e
;

281 #ifdef 
__USE_POSIX


283 *
tz«me
[2];

287 
	$tz£t
 (Ë
__THROW
;

290 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


291 
daylight
;

292 
timez⁄e
;

295 #ifde‡
__USE_SVID


298 
	$°ime
 (
__c⁄°
 
time_t
 *
__whí
Ë
__THROW
;

304 
	#__i¶óp
(
yór
) \

305 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

308 #ifde‡
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

316 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

319 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

323 #ifde‡
__USE_POSIX199309


328 
	`«no¶ìp
 (
__c⁄°
 
time•ec
 *
__ªque°ed_time
,

329 
time•ec
 *
__ªmaöög
);

333 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

336 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

339 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, 
__c⁄°
 
time•ec
 *
__ç
)

340 
__THROW
;

342 #ifde‡
__USE_XOPEN2K


347 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

348 
__c⁄°
 
time•ec
 *
__ªq
,

349 
time•ec
 *
__ªm
);

352 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

357 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

358 
sigevít
 *
__ª°ri˘
 
__evp
,

359 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

362 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

365 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

366 
__c⁄°
 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

367 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

370 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

371 
__THROW
;

374 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

378 #ifde‡
__USE_XOPEN_EXTENDED


390 
gëd©e_îr
;

399 
tm
 *
	`gëd©e
 (
__c⁄°
 *
__°rög
);

402 #ifde‡
__USE_GNU


413 
	`gëd©e_r
 (
__c⁄°
 *
__ª°ri˘
 
__°rög
,

414 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

417 
__END_DECLS


	@/usr/include/unistd.h

23 #i‚def 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


33 #ifde‡
__USE_XOPEN2K8


35 
	#_POSIX_VERSION
 200809L

	)

36 #ñi‡
deföed
 
__USE_XOPEN2K


38 
	#_POSIX_VERSION
 200112L

	)

39 #ñi‡
deföed
 
__USE_POSIX199506


41 
	#_POSIX_VERSION
 199506L

	)

42 #ñi‡
deföed
 
__USE_POSIX199309


44 
	#_POSIX_VERSION
 199309L

	)

47 
	#_POSIX_VERSION
 199009L

	)

53 #ifde‡
__USE_XOPEN2K8


54 
	#__POSIX2_THIS_VERSION
 200809L

	)

56 #ñi‡
deföed
 
__USE_XOPEN2K


58 
	#__POSIX2_THIS_VERSION
 200112L

	)

59 #ñi‡
deföed
 
__USE_POSIX199506


61 
	#__POSIX2_THIS_VERSION
 199506L

	)

64 
	#__POSIX2_THIS_VERSION
 199209L

	)

68 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

72 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

76 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

80 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

84 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

87 #ifde‡
__USE_XOPEN2K8


88 
	#_XOPEN_VERSION
 700

	)

89 #ñi‡
deföed
 
__USE_XOPEN2K


90 
	#_XOPEN_VERSION
 600

	)

91 #ñi‡
deföed
 
__USE_UNIX98


92 
	#_XOPEN_VERSION
 500

	)

94 
	#_XOPEN_VERSION
 4

	)

98 
	#_XOPEN_XCU_VERSION
 4

	)

101 
	#_XOPEN_XPG2
 1

	)

102 
	#_XOPEN_XPG3
 1

	)

103 
	#_XOPEN_XPG4
 1

	)

106 
	#_XOPEN_UNIX
 1

	)

109 
	#_XOPEN_CRYPT
 1

	)

113 
	#_XOPEN_ENH_I18N
 1

	)

116 
	#_XOPEN_LEGACY
 1

	)

203 
	~<bôs/posix_›t.h
>

206 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


207 
	~<bôs/ívú⁄míts.h
>

211 
	#STDIN_FILENO
 0

	)

212 
	#STDOUT_FILENO
 1

	)

213 
	#STDERR_FILENO
 2

	)

218 
	~<bôs/ty≥s.h
>

220 #i‚def 
__ssize_t_deföed


221 
__ssize_t
 
	tssize_t
;

222 
	#__ssize_t_deföed


	)

225 
	#__√ed_size_t


	)

226 
	#__√ed_NULL


	)

227 
	~<°ddef.h
>

229 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


232 #i‚de‡
__gid_t_deföed


233 
__gid_t
 
	tgid_t
;

234 
	#__gid_t_deföed


	)

237 #i‚de‡
__uid_t_deföed


238 
__uid_t
 
	tuid_t
;

239 
	#__uid_t_deföed


	)

242 #i‚de‡
__off_t_deföed


243 #i‚de‡
__USE_FILE_OFFSET64


244 
__off_t
 
	toff_t
;

246 
__off64_t
 
	toff_t
;

248 
	#__off_t_deföed


	)

250 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


251 
__off64_t
 
	toff64_t
;

252 
	#__off64_t_deföed


	)

255 #i‚de‡
__u£c⁄ds_t_deföed


256 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

257 
	#__u£c⁄ds_t_deföed


	)

260 #i‚de‡
__pid_t_deföed


261 
__pid_t
 
	tpid_t
;

262 
	#__pid_t_deföed


	)

266 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


267 #i‚de‡
__öçå_t_deföed


268 
__öçå_t
 
	töçå_t
;

269 
	#__öçå_t_deföed


	)

273 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


274 #i‚de‡
__sockÀn_t_deföed


275 
__sockÀn_t
 
	tsockÀn_t
;

276 
	#__sockÀn_t_deföed


	)

282 
	#R_OK
 4

	)

283 
	#W_OK
 2

	)

284 
	#X_OK
 1

	)

285 
	#F_OK
 0

	)

288 
	$ac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

290 #ifde‡
__USE_GNU


293 
	$euidac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
)

294 
__THROW
 
	`__n⁄nuŒ
 ((1));

297 
	$óc˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
)

298 
__THROW
 
	`__n⁄nuŒ
 ((1));

301 #ifde‡
__USE_ATFILE


305 
	$Ác˚sßt
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__ty≥
, 
__Êag
)

306 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

311 #i‚def 
_STDIO_H


312 
	#SEEK_SET
 0

	)

313 
	#SEEK_CUR
 1

	)

314 
	#SEEK_END
 2

	)

315 #ifde‡
__USE_GNU


316 
	#SEEK_DATA
 3

	)

317 
	#SEEK_HOLE
 4

	)

321 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


323 
	#L_SET
 
SEEK_SET


	)

324 
	#L_INCR
 
SEEK_CUR


	)

325 
	#L_XTND
 
SEEK_END


	)

334 #i‚de‡
__USE_FILE_OFFSET64


335 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

337 #ifde‡
__REDIRECT_NTH


338 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

339 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

340 
l£ek64
);

342 
	#l£ek
 
l£ek64


	)

345 #ifde‡
__USE_LARGEFILE64


346 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

347 
__THROW
;

354 
	`˛o£
 (
__fd
);

361 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

367 
ssize_t
 
	$wrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
Ë
__wur
;

369 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


370 #i‚de‡
__USE_FILE_OFFSET64


377 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

378 
__off_t
 
__off£t
Ë
__wur
;

385 
ssize_t
 
	$pwrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

386 
__off_t
 
__off£t
Ë
__wur
;

388 #ifde‡
__REDIRECT


389 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

390 
__off64_t
 
__off£t
),

391 
¥ód64
Ë
__wur
;

392 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, 
__c⁄°
 *
__buf
,

393 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

394 
pwrôe64
Ë
__wur
;

396 
	#¥ód
 
¥ód64


	)

397 
	#pwrôe
 
pwrôe64


	)

401 #ifde‡
__USE_LARGEFILE64


405 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

406 
__off64_t
 
__off£t
Ë
__wur
;

409 
ssize_t
 
	$pwrôe64
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

410 
__off64_t
 
__off£t
Ë
__wur
;

418 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

420 #ifde‡
__USE_GNU


423 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

433 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

445 
	`¶ìp
 (
__£c⁄ds
);

447 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

448 || 
deföed
 
__USE_BSD


453 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

454 
__THROW
;

461 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

470 
	`∑u£
 ();

474 
	$chown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

475 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

477 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


479 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

484 
	$lchown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

485 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

489 #ifde‡
__USE_ATFILE


492 
	$fchow«t
 (
__fd
, 
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
,

493 
__gid_t
 
__group
, 
__Êag
)

494 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

498 
	$chdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

500 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


502 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

512 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

514 #ifdef 
__USE_GNU


518 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

521 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

522 || 
deföed
 
__USE_BSD


526 *
	$gëwd
 (*
__buf
)

527 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

532 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

535 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

537 #ifde‡
__USE_GNU


540 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

544 **
__ívú⁄
;

545 #ifde‡
__USE_GNU


546 **
ívú⁄
;

552 
	$execve
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[],

553 *
__c⁄°
 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

555 #ifde‡
__USE_XOPEN2K8


558 
	$„xecve
 (
__fd
, *
__c⁄°
 
__¨gv
[], *__c⁄° 
__ívp
[])

559 
__THROW
 
	`__n⁄nuŒ
 ((2));

564 
	$execv
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[])

565 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 
	$exe˛e
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 
	$exe˛
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...)

575 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

579 
	$execvp
 (
__c⁄°
 *
__fûe
, *__c⁄° 
__¨gv
[])

580 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

585 
	$exe˛p
 (
__c⁄°
 *
__fûe
, __c⁄° *
__¨g
, ...)

586 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

588 #ifde‡
__USE_GNU


591 
	$execv≥
 (
__c⁄°
 *
__fûe
, *__c⁄° 
__¨gv
[],

592 *
__c⁄°
 
__ívp
[])

593 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

597 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


599 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

604 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

610 
	~<bôs/c⁄‚ame.h
>

613 
	$∑thc⁄f
 (
__c⁄°
 *
__∑th
, 
__«me
)

614 
__THROW
 
	`__n⁄nuŒ
 ((1));

617 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

620 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

622 #ifdef 
__USE_POSIX2


624 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

629 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

632 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

636 #i‚de‡
__FAVOR_BSD


637 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

639 #ifde‡
__REDIRECT_NTH


640 
__pid_t
 
	`__REDIRECT_NTH
 (
gëpgΩ
, (__pid_à
__pid
), 
__gëpgid
);

642 
	#gëpgΩ
 
__gëpgid


	)

647 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

648 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


649 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

656 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

658 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


669 #i‚de‡
__FAVOR_BSD


673 
	$£çgΩ
 (Ë
__THROW
;

678 #ifde‡
__REDIRECT_NTH


679 
	`__REDIRECT_NTH
 (
£çgΩ
, (
__pid_t
 
__pid
, __pid_à
__pgΩ
), 
£çgid
);

681 
	#£çgΩ
 
£çgid


	)

690 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

692 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


694 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

698 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

701 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

704 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

707 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

712 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

714 #ifdef 
__USE_GNU


716 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

723 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
;

725 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


728 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
;

731 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


733 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
;

740 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
;

742 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


745 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
;

748 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


750 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
;

753 #ifde‡
__USE_GNU


756 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

757 
__THROW
;

761 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

762 
__THROW
;

766 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

767 
__THROW
;

771 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

772 
__THROW
;

779 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

781 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

782 || 
deföed
 
__USE_BSD


787 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

793 *
	$ây«me
 (
__fd
Ë
__THROW
;

797 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

798 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

802 
	$ißây
 (
__fd
Ë
__THROW
;

804 #i‡
deföed
 
__USE_BSD
 \

805 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

808 
	$ây¶Ÿ
 (Ë
__THROW
;

813 
	$lök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
)

814 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

816 #ifde‡
__USE_ATFILE


819 
	$lök©
 (
__‰omfd
, 
__c⁄°
 *
__‰om
, 
__tofd
,

820 
__c⁄°
 *
__to
, 
__Êags
)

821 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

824 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


826 
	$symlök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
)

827 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

832 
ssize_t
 
	$ªadlök
 (
__c⁄°
 *
__ª°ri˘
 
__∑th
,

833 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

834 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

837 #ifde‡
__USE_ATFILE


839 
	$symlök©
 (
__c⁄°
 *
__‰om
, 
__tofd
,

840 
__c⁄°
 *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

843 
ssize_t
 
	$ªadlök©
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__∑th
,

844 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

845 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

849 
	$u∆ök
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

851 #ifde‡
__USE_ATFILE


853 
	$u∆ök©
 (
__fd
, 
__c⁄°
 *
__«me
, 
__Êag
)

854 
__THROW
 
	`__n⁄nuŒ
 ((2));

858 
	$rmdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

862 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

865 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

872 *
	`gëlogö
 ();

873 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


880 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

883 #ifdef 
__USE_BSD


885 
	$£éogö
 (
__c⁄°
 *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

889 #ifdef 
__USE_POSIX2


893 
	#__√ed_gë›t


	)

894 
	~<gë›t.h
>

898 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


902 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

906 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

909 
	$£tho°«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
)

910 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

914 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

920 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

921 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

922 
	$£tdomaö«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
)

923 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

929 
	$vh™gup
 (Ë
__THROW
;

932 
	$ªvoke
 (
__c⁄°
 *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

940 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

941 
size_t
 
__off£t
, 
__sˇÀ
)

942 
__THROW
 
	`__n⁄nuŒ
 ((1));

948 
	$ac˘
 (
__c⁄°
 *
__«me
Ë
__THROW
;

952 *
	$gëu£rshñl
 (Ë
__THROW
;

953 
	$ídu£rshñl
 (Ë
__THROW
;

954 
	$£tu£rshñl
 (Ë
__THROW
;

960 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

964 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

967 
	$chroŸ
 (
__c⁄°
 *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

971 *
	$gë∑ss
 (
__c⁄°
 *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

975 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


980 
	`fsync
 (
__fd
);

984 #ifde‡
__USE_GNU


987 
	$syncfs
 (
__fd
Ë
__THROW
;

991 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


994 
	`gëho°id
 ();

997 
	$sync
 (Ë
__THROW
;

1000 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


1003 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

1008 
	$gëdèbÀsize
 (Ë
__THROW
;

1014 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


1017 #i‚de‡
__USE_FILE_OFFSET64


1018 
	$åunˇã
 (
__c⁄°
 *
__fûe
, 
__off_t
 
__Àngth
)

1019 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1021 #ifde‡
__REDIRECT_NTH


1022 
	`__REDIRECT_NTH
 (
åunˇã
,

1023 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
),

1024 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1026 
	#åunˇã
 
åunˇã64


	)

1029 #ifde‡
__USE_LARGEFILE64


1030 
	$åunˇã64
 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
)

1031 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1036 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1039 #i‚de‡
__USE_FILE_OFFSET64


1040 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1042 #ifde‡
__REDIRECT_NTH


1043 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1044 
·runˇã64
Ë
__wur
;

1046 
	#·runˇã
 
·runˇã64


	)

1049 #ifde‡
__USE_LARGEFILE64


1050 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1056 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1057 || 
deföed
 
__USE_MISC


1061 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1067 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1071 #ifde‡
__USE_MISC


1082 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1087 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1099 
	#F_ULOCK
 0

	)

1100 
	#F_LOCK
 1

	)

1101 
	#F_TLOCK
 2

	)

1102 
	#F_TEST
 3

	)

1104 #i‚de‡
__USE_FILE_OFFSET64


1105 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1107 #ifde‡
__REDIRECT


1108 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1109 
lockf64
Ë
__wur
;

1111 
	#lockf
 
lockf64


	)

1114 #ifde‡
__USE_LARGEFILE64


1115 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1120 #ifde‡
__USE_GNU


1125 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1126 (
__exãnsi⁄__
 \

1127 ({ 
__ªsu…
; \

1128 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1129 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1130 
__ªsu…
; 
	}
}))

	)

1133 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1136 
fd©async
 (
__fûdes
);

1142 #ifdef 
__USE_XOPEN


1144 *
	$¸y±
 (
__c⁄°
 *
__key
, __c⁄° *
__ß…
)

1145 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1149 
	$í¸y±
 (*
__libc_block
, 
__edÊag
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1156 
	$swab
 (
__c⁄°
 *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1157 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1163 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


1165 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1170 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


1171 
	~<bôs/uni°d.h
>

1174 
__END_DECLS


	@/usr/include/alloca.h

19 #i‚def 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

27 
	g__BEGIN_DECLS


30 #unde‡
Æloˇ


33 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

35 #ifdef 
__GNUC__


36 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

39 
__END_DECLS


	@/usr/include/endian.h

19 #i‚def 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<„©uªs.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<bôs/ídün.h
>

41 #i‚de‡
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

54 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

59 #ifde‡
__USE_BSD


61 
	~<bôs/byãsw≠.h
>

63 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


64 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

65 
	#htﬁe16
(
x
Ë(x)

	)

66 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

67 
	#À16toh
(
x
Ë(x)

	)

69 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

70 
	#htﬁe32
(
x
Ë(x)

	)

71 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

72 
	#À32toh
(
x
Ë(x)

	)

74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

20 #i‚def 
_FEATURES_H


21 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC99


99 #unde‡
__USE_ISOC95


100 #unde‡
__USE_POSIX


101 #unde‡
__USE_POSIX2


102 #unde‡
__USE_POSIX199309


103 #unde‡
__USE_POSIX199506


104 #unde‡
__USE_XOPEN


105 #unde‡
__USE_XOPEN_EXTENDED


106 #unde‡
__USE_UNIX98


107 #unde‡
__USE_XOPEN2K


108 #unde‡
__USE_XOPEN2KXSI


109 #unde‡
__USE_XOPEN2K8


110 #unde‡
__USE_XOPEN2K8XSI


111 #unde‡
__USE_LARGEFILE


112 #unde‡
__USE_LARGEFILE64


113 #unde‡
__USE_FILE_OFFSET64


114 #unde‡
__USE_BSD


115 #unde‡
__USE_SVID


116 #unde‡
__USE_MISC


117 #unde‡
__USE_ATFILE


118 #unde‡
__USE_GNU


119 #unde‡
__USE_REENTRANT


120 #unde‡
__USE_FORTIFY_LEVEL


121 #unde‡
__FAVOR_BSD


122 #unde‡
__KERNEL_STRICT_NAMES


126 #i‚de‡
_LOOSE_KERNEL_NAMES


127 
	#__KERNEL_STRICT_NAMES


	)

131 
	#__USE_ANSI
 1

	)

140 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


141 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

142 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

144 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

149 #i‡
deföed
 
_BSD_SOURCE
 && \

150 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

151 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

152 
	#__FAVOR_BSD
 1

	)

156 #ifde‡
_GNU_SOURCE


157 #unde‡
_ISOC95_SOURCE


158 
	#_ISOC95_SOURCE
 1

	)

159 #unde‡
_ISOC99_SOURCE


160 
	#_ISOC99_SOURCE
 1

	)

161 #unde‡
_POSIX_SOURCE


162 
	#_POSIX_SOURCE
 1

	)

163 #unde‡
_POSIX_C_SOURCE


164 
	#_POSIX_C_SOURCE
 200809L

	)

165 #unde‡
_XOPEN_SOURCE


166 
	#_XOPEN_SOURCE
 700

	)

167 #unde‡
_XOPEN_SOURCE_EXTENDED


168 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

169 #unde‡
_LARGEFILE64_SOURCE


170 
	#_LARGEFILE64_SOURCE
 1

	)

171 #unde‡
_BSD_SOURCE


172 
	#_BSD_SOURCE
 1

	)

173 #unde‡
_SVID_SOURCE


174 
	#_SVID_SOURCE
 1

	)

175 #unde‡
_ATFILE_SOURCE


176 
	#_ATFILE_SOURCE
 1

	)

181 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

182 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

183 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

184 
	#_BSD_SOURCE
 1

	)

185 
	#_SVID_SOURCE
 1

	)

192 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

193 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

194 
	#__USE_ISOC99
 1

	)

198 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

199 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

200 
	#__USE_ISOC95
 1

	)

205 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

206 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

207 
	#_POSIX_SOURCE
 1

	)

208 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

209 
	#_POSIX_C_SOURCE
 2

	)

210 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

211 
	#_POSIX_C_SOURCE
 199506L

	)

212 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

213 
	#_POSIX_C_SOURCE
 200112L

	)

215 
	#_POSIX_C_SOURCE
 200809L

	)

217 
	#__USE_POSIX_IMPLICITLY
 1

	)

220 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


221 
	#__USE_POSIX
 1

	)

224 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


225 
	#__USE_POSIX2
 1

	)

228 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

229 
	#__USE_POSIX199309
 1

	)

232 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

233 
	#__USE_POSIX199506
 1

	)

236 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

237 
	#__USE_XOPEN2K
 1

	)

238 #unde‡
__USE_ISOC95


239 
	#__USE_ISOC95
 1

	)

240 #unde‡
__USE_ISOC99


241 
	#__USE_ISOC99
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

245 
	#__USE_XOPEN2K8
 1

	)

246 #unde‡
_ATFILE_SOURCE


247 
	#_ATFILE_SOURCE
 1

	)

250 #ifdef 
_XOPEN_SOURCE


251 
	#__USE_XOPEN
 1

	)

252 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

253 
	#__USE_XOPEN_EXTENDED
 1

	)

254 
	#__USE_UNIX98
 1

	)

255 #unde‡
_LARGEFILE_SOURCE


256 
	#_LARGEFILE_SOURCE
 1

	)

257 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

258 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

259 
	#__USE_XOPEN2K8
 1

	)

260 
	#__USE_XOPEN2K8XSI
 1

	)

262 
	#__USE_XOPEN2K
 1

	)

263 
	#__USE_XOPEN2KXSI
 1

	)

264 #unde‡
__USE_ISOC95


265 
	#__USE_ISOC95
 1

	)

266 #unde‡
__USE_ISOC99


267 
	#__USE_ISOC99
 1

	)

270 #ifde‡
_XOPEN_SOURCE_EXTENDED


271 
	#__USE_XOPEN_EXTENDED
 1

	)

276 #ifde‡
_LARGEFILE_SOURCE


277 
	#__USE_LARGEFILE
 1

	)

280 #ifde‡
_LARGEFILE64_SOURCE


281 
	#__USE_LARGEFILE64
 1

	)

284 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

285 
	#__USE_FILE_OFFSET64
 1

	)

288 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


289 
	#__USE_MISC
 1

	)

292 #ifdef 
_BSD_SOURCE


293 
	#__USE_BSD
 1

	)

296 #ifdef 
_SVID_SOURCE


297 
	#__USE_SVID
 1

	)

300 #ifdef 
_ATFILE_SOURCE


301 
	#__USE_ATFILE
 1

	)

304 #ifdef 
_GNU_SOURCE


305 
	#__USE_GNU
 1

	)

308 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


309 
	#__USE_REENTRANT
 1

	)

312 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

313 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

314 #i‡
_FORTIFY_SOURCE
 > 1

315 
	#__USE_FORTIFY_LEVEL
 2

	)

317 
	#__USE_FORTIFY_LEVEL
 1

	)

320 
	#__USE_FORTIFY_LEVEL
 0

	)

324 
	~<bôs/¥edefs.h
>

327 
	#__STDC_ISO_10646__
 200009L

	)

335 #unde‡
__GNU_LIBRARY__


336 
	#__GNU_LIBRARY__
 6

	)

340 
	#__GLIBC__
 2

	)

341 
	#__GLIBC_MINOR__
 15

	)

343 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

344 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

347 #i‡
deföed
 
__GNUC__
 \

348 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

349 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

350 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

351 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

355 #i‚de‡
__ASSEMBLER__


356 #i‚de‡
_SYS_CDEFS_H


357 
	~<sys/cdefs.h
>

362 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


363 
	#__USE_LARGEFILE
 1

	)

364 
	#__USE_LARGEFILE64
 1

	)

370 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

371 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

372 && 
deföed
 
	g__exã∫_ölöe


373 
	#__USE_EXTERN_INLINES
 1

	)

378 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

379 && (
deföed
 
	g_LIBC
 || !deföed 
	g__OPTIMIZE_SIZE__
Ë&& !deföed 
	g__NO_INLINE__
 \

380 && 
deföed
 
	g__exã∫_ölöe


381 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

389 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

21 #i‚de‡
_GETOPT_H


23 #i‚de‡
__√ed_gë›t


24 
	#_GETOPT_H
 1

	)

34 #i‡!
deföed
 
__GNU_LIBRARY__


35 
	~<˘y≥.h
>

38 #i‚de‡
__THROW


39 #i‚de‡
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

42 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__˝lu•lus


59 *
›èrg
;

73 
›töd
;

78 
›ãº
;

82 
›t›t
;

84 #i‚de‡
__√ed_gë›t


106 
	s›ti⁄


108 c⁄° *
	g«me
;

111 
	ghas_¨g
;

112 *
	gÊag
;

113 
	gvÆ
;

118 
	#no_¨gumít
 0

	)

119 
	#ªquúed_¨gumít
 1

	)

120 
	#›ti⁄Æ_¨gumít
 2

	)

148 #ifde‡
__GNU_LIBRARY__


152 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

153 
__THROW
;

155 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

156 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


160 #ifde‡
__REDIRECT


161 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

162 c⁄° *
__sh‹t›ts
),

163 
__posix_gë›t
);

165 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

166 c⁄° *
__sh‹t›ts
Ë
__THROW
;

167 
	#gë›t
 
__posix_gë›t


	)

171 
gë›t
 ();

174 #i‚de‡
__√ed_gë›t


175 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

176 c⁄° *
__sh‹t›ts
,

177 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

178 
__THROW
;

179 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

180 c⁄° *
__sh‹t›ts
,

181 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

182 
__THROW
;

186 #ifdef 
__˝lu•lus


191 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_pos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos_t
 
_G_Âos_t


	)

36 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li°
 
_G_va_li°


	)

48 
	#_IO_wöt_t
 
_G_wöt_t


	)

50 #ifde‡
_G_NEED_STDARG_H


52 
	#__√ed___va_li°


	)

53 
	~<°d¨g.h
>

54 #ifde‡
__GNUC_VA_LIST


55 #unde‡
_IO_va_li°


56 
	#_IO_va_li°
 
__gnuc_va_li°


	)

60 #i‚de‡
__P


61 #i‡
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifde‡
__STDC__


65 
	#__P
(
p
Ë
	)
p

66 
	#__PMT
(
p
Ë
	)
p

68 
	#__P
(
p
Ë()

	)

69 
	#__PMT
(
p
Ë()

	)

75 #i‚de‡
_PARAMS


76 
	#_PARAMS
(
¥Ÿos
Ë
	`__P
’rŸos)

	)

79 #i‚de‡
__STDC__


81 c⁄°

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #i‚de‡
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #i‚de‡
EOF


90 
	#EOF
 (-1)

	)

92 #i‚de‡
NULL


93 #i‡
deföed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuŒ
)

	)

97 #i‡!
deföed
(
__˝lu•lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifde‡
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifde‡
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

148 
	#_IO_FLAGS2_NOCLOSE
 32

	)

149 
	#_IO_FLAGS2_CLOEXEC
 64

	)

153 
	#_IO_SKIPWS
 01

	)

154 
	#_IO_LEFT
 02

	)

155 
	#_IO_RIGHT
 04

	)

156 
	#_IO_INTERNAL
 010

	)

157 
	#_IO_DEC
 020

	)

158 
	#_IO_OCT
 040

	)

159 
	#_IO_HEX
 0100

	)

160 
	#_IO_SHOWBASE
 0200

	)

161 
	#_IO_SHOWPOINT
 0400

	)

162 
	#_IO_UPPERCASE
 01000

	)

163 
	#_IO_SHOWPOS
 02000

	)

164 
	#_IO_SCIENTIFIC
 04000

	)

165 
	#_IO_FIXED
 010000

	)

166 
	#_IO_UNITBUF
 020000

	)

167 
	#_IO_STDIO
 040000

	)

168 
	#_IO_DONT_CLOSE
 0100000

	)

169 
	#_IO_BOOLALPHA
 0200000

	)

172 
_IO_jump_t
; 
	g_IO_FILE
;

175 #ifde‡
_IO_MTSAFE_IO


176 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

177 
	~<bôs/°dio-lock.h
>

182 
	t_IO_lock_t
;

188 
	s_IO_m¨kî
 {

189 
_IO_m¨kî
 *
	m_√xt
;

190 
_IO_FILE
 *
	m_sbuf
;

194 
	m_pos
;

196 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

197 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

198 
	mpublic
:

199 
°ªamm¨kî
(
°ªambuf
 *
sb
);

200 ~
°ªamm¨kî
();

201 
ßvög
(Ë{  
	m_•os
 == -2; }

202 
dñè
(
°ªamm¨kî
&);

203 
dñè
();

208 
	e__codecvt_ªsu…


210 
	m__codecvt_ok
,

211 
	m__codecvt_∑πül
,

212 
	m__codecvt_îr‹
,

213 
	m__codecvt_noc⁄v


216 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


219 
	s_IO_codecvt


221 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

222 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

223 
	m__mb°©e_t
 *,

224 c⁄° 
	mwch¨_t
 *,

225 c⁄° 
	mwch¨_t
 *,

226 c⁄° 
	mwch¨_t
 **, *,

228 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

229 
	m__mb°©e_t
 *, *,

231 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

232 
	m__mb°©e_t
 *,

234 c⁄° **, 
	mwch¨_t
 *,

235 
	mwch¨_t
 *, wchar_t **);

236 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

237 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

238 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

239 c⁄° *, c⁄° *, 
	m_IO_size_t
);

240 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

242 
_IO_ic⁄v_t
 
	m__cd_ö
;

243 
_IO_ic⁄v_t
 
	m__cd_out
;

247 
	s_IO_wide_d©a


249 
wch¨_t
 *
	m_IO_ªad_±r
;

250 
wch¨_t
 *
	m_IO_ªad_íd
;

251 
wch¨_t
 *
	m_IO_ªad_ba£
;

252 
wch¨_t
 *
	m_IO_wrôe_ba£
;

253 
wch¨_t
 *
	m_IO_wrôe_±r
;

254 
wch¨_t
 *
	m_IO_wrôe_íd
;

255 
wch¨_t
 *
	m_IO_buf_ba£
;

256 
wch¨_t
 *
	m_IO_buf_íd
;

258 
wch¨_t
 *
	m_IO_ßve_ba£
;

259 
wch¨_t
 *
	m_IO_backup_ba£
;

261 
wch¨_t
 *
	m_IO_ßve_íd
;

263 
__mb°©e_t
 
	m_IO_°©e
;

264 
__mb°©e_t
 
	m_IO_œ°_°©e
;

265 
_IO_codecvt
 
	m_codecvt
;

267 
wch¨_t
 
	m_sh‹tbuf
[1];

269 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

273 
	s_IO_FILE
 {

274 
	m_Êags
;

275 
	#_IO_fûe_Êags
 
_Êags


	)

279 * 
	m_IO_ªad_±r
;

280 * 
	m_IO_ªad_íd
;

281 * 
	m_IO_ªad_ba£
;

282 * 
	m_IO_wrôe_ba£
;

283 * 
	m_IO_wrôe_±r
;

284 * 
	m_IO_wrôe_íd
;

285 * 
	m_IO_buf_ba£
;

286 * 
	m_IO_buf_íd
;

288 *
	m_IO_ßve_ba£
;

289 *
	m_IO_backup_ba£
;

290 *
	m_IO_ßve_íd
;

292 
_IO_m¨kî
 *
	m_m¨kîs
;

294 
_IO_FILE
 *
	m_chaö
;

296 
	m_fûío
;

298 
	m_blksize
;

300 
	m_Êags2
;

302 
_IO_off_t
 
	m_ﬁd_off£t
;

304 
	#__HAVE_COLUMN


	)

306 
	m_cur_cﬁumn
;

307 sig√d 
	m_vèbÀ_off£t
;

308 
	m_sh‹tbuf
[1];

312 
_IO_lock_t
 *
	m_lock
;

313 #ifde‡
_IO_USE_OLD_IO_FILE


316 
	s_IO_FILE_com∂ëe


318 
_IO_FILE
 
	m_fûe
;

320 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

321 
_IO_off64_t
 
	m_off£t
;

322 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


324 
_IO_codecvt
 *
	m_codecvt
;

325 
_IO_wide_d©a
 *
	m_wide_d©a
;

326 
_IO_FILE
 *
	m_‰ìªs_li°
;

327 *
	m_‰ìªs_buf
;

328 
size_t
 
	m_‰ìªs_size
;

330 *
	m__∑d1
;

331 *
	m__∑d2
;

332 *
	m__∑d3
;

333 *
	m__∑d4
;

334 
size_t
 
	m__∑d5
;

336 
	m_mode
;

338 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

342 #i‚de‡
__˝lu•lus


343 
_IO_FILE
 
	t_IO_FILE
;

346 
	g_IO_FILE_∂us
;

348 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

349 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

350 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

351 #i‚de‡
_LIBC


352 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

353 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

354 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

356 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

357 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

358 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

366 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

374 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, 
	t__c⁄°
 *
	t__buf
,

375 
	tsize_t
 
	t__n
);

383 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

386 
	t__io_˛o£_‚
 (*
	t__cookõ
);

389 #ifde‡
_GNU_SOURCE


391 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

392 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

393 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

394 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

399 
__io_ªad_‚
 *
	mªad
;

400 
__io_wrôe_‚
 *
	mwrôe
;

401 
__io_£ek_‚
 *
	m£ek
;

402 
__io_˛o£_‚
 *
	m˛o£
;

403 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

404 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

406 
	g_IO_cookõ_fûe
;

409 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

410 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

414 #ifde‡
__˝lu•lus


418 
__undîÊow
 (
_IO_FILE
 *);

419 
__uÊow
 (
_IO_FILE
 *);

420 
__ovîÊow
 (
_IO_FILE
 *, );

421 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


422 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

423 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

424 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

427 #i‡ 
__GNUC__
 >= 3

428 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

430 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

433 
	#_IO_gëc_u∆ocked
(
_Â
) \

434 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

435 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

436 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

437 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

438 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

439 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

440 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

441 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

442 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

443 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

445 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


446 
	#_IO_gëwc_u∆ocked
(
_Â
) \

447 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

448 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

449 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

450 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

451 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

452 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

453 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

454 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

455 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

456 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

459 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

460 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

462 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

463 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

464 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

465 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

467 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

470 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

471 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

473 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

474 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

475 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

477 #ifde‡
_IO_MTSAFE_IO


478 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

479 
	#_IO_Êockfûe
(
_Â
) \

480 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

481 
	#_IO_fu∆ockfûe
(
_Â
) \

482 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

484 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

485 
	#_IO_Êockfûe
(
_Â
Ë

	)

486 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

487 
	#_IO_·rylockfûe
(
_Â
Ë

	)

488 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

489 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

492 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

493 
_IO_va_li°
, *
__ª°ri˘
);

494 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

495 
_IO_va_li°
);

496 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

497 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

499 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

500 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

502 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

504 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


505 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

506 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

507 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

508 #i‡
__GNUC__
 >= 2

511 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


512 
	~<shlib-com∑t.h
>

513 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

514 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

515 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

516 c⁄° 
_IO_°dö_u£d
;

517 
wók_exã∫
 (
_IO_°dö_u£d
);

520 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


521 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

525 
	#_IO_fwide
(
__Â
, 
__mode
) \

526 ({ 
__ªsu…
 = (
__mode
); \

527 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

529 i‡((
__Â
)->
_mode
 == 0) \

531 (
__Â
)->
_mode
 = -1; \

532 
__ªsu…
 = (
__Â
)->
_mode
; \

534 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

535 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

537 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

538 
__ªsu…
; })

	)

541 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

542 
_IO_va_li°
, *
__ª°ri˘
);

543 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

544 
_IO_va_li°
);

545 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

546 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

549 #ifde‡
__LDBL_COMPAT


550 
	~<bôs/libio-ldbl.h
>

553 #ifde‡
__˝lu•lus


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (
__c⁄°
 *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (
__c⁄°
 *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/sched.h

21 #i‚def 
_SCHED_H


22 
	#_SCHED_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 
	#__√ed_size_t


	)

30 
	~<°ddef.h
>

32 
	#__√ed_time_t


	)

33 
	#__√ed_time•ec


	)

34 
	~<time.h
>

36 #i‚de‡
__pid_t_deföed


37 
__pid_t
 
	tpid_t
;

38 
	#__pid_t_deföed


	)

43 
	~<bôs/sched.h
>

45 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

48 
__BEGIN_DECLS


51 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

52 
__THROW
;

55 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

58 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

59 
__c⁄°
 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

62 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

65 
	$sched_yõld
 (Ë
__THROW
;

68 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

71 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

74 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

77 #ifde‡
__USE_GNU


79 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

80 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

81 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

82 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

83 
˝u£ç
)

	)

84 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

85 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

87 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

88 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

89 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

90 
˝u£ç
)

	)

91 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

92 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

94 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

95 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

96 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

97 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

99 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

100 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

101 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

102 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

103 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

104 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

105 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

107 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

109 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

110 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

112 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

113 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

114 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

118 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

119 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

122 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

123 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

126 
__END_DECLS


	@/usr/include/xlocale.h

21 #i‚de‡
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loˇÀ_°ru˘


31 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

34 c⁄° *
	m__˘y≥_b
;

35 c⁄° *
	m__˘y≥_tﬁowî
;

36 c⁄° *
	m__˘y≥_touµî
;

39 c⁄° *
	m__«mes
[13];

40 } *
	t__loˇÀ_t
;

43 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb°©e_t
 
	m__°©e
;

26 } 
	t_G_Âos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb°©e_t
 
	m__°©e
;

31 } 
	t_G_Âos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¨_t
 
wch¨_t


	)

38 
	#_G_wöt_t
 
wöt_t


	)

39 
	#_G_°©64
 
°©64


	)

40 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gc⁄v.h
>

44 
__gc⁄v_öfo
 
	m__cd
;

47 
__gc⁄v_öfo
 
	m__cd
;

48 
__gc⁄v_°ï_d©a
 
	m__d©a
;

49 } 
	m__comböed
;

50 } 
	t_G_ic⁄v_t
;

53 
	t_G_öt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_öt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_uöt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_uöt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li°
 
__gnuc_va_li°


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__›í64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm≠64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
Ë
	`__fx°©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #i‡
deföed
 
__˝lu•lus
 || deföed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
Ë
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
Ë()

	)

	@/usr/include/gconv.h

23 #i‚de‡
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<„©uªs.h
>

27 
	#__√ed_mb°©e_t


	)

28 
	#__√ed_wöt_t


	)

29 
	~<wch¨.h
>

30 
	#__√ed_size_t


	)

31 
	#__√ed_wch¨_t


	)

32 
	~<°ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

60 
	m__GCONV_SWAP
 = 0x0004

65 
	g__gc⁄v_°ï
;

66 
	g__gc⁄v_°ï_d©a
;

67 
	g__gc⁄v_lﬂded_obje˘
;

68 
	g__gc⁄v_å™s_d©a
;

72 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 
	t__c⁄°
 **, __const *,

74 **, 
	tsize_t
 *, , );

77 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

80 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

81 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

85 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

86 
	t__gc⁄v_°ï_d©a
 *, *,

87 
	t__c⁄°
 *,

88 
	t__c⁄°
 **,

89 
	t__c⁄°
 *, **,

90 
	tsize_t
 *);

93 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
Ë(*, 
	t__c⁄°
 *,

94 
	t__c⁄°
 *,

98 (*
	t__gc⁄v_å™s_quîy_f˘
Ë(
	t__c⁄°
 *, __const ***,

99 
	tsize_t
 *);

102 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

103 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

105 
	s__gc⁄v_å™s_d©a


108 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

109 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

110 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

111 *
__d©a
;

112 
__gc⁄v_å™s_d©a
 *
__√xt
;

117 
	s__gc⁄v_°ï


119 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

120 
__c⁄°
 *
__mod«me
;

122 
__cou¡î
;

124 *
__‰om_«me
;

125 *
__to_«me
;

127 
__gc⁄v_f˘
 
__f˘
;

128 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

129 
__gc⁄v_öô_f˘
 
__öô_f˘
;

130 
__gc⁄v_íd_f˘
 
__íd_f˘
;

134 
__mö_√eded_‰om
;

135 
__max_√eded_‰om
;

136 
__mö_√eded_to
;

137 
__max_√eded_to
;

140 
__°©eful
;

142 *
__d©a
;

147 
	s__gc⁄v_°ï_d©a


149 *
__outbuf
;

150 *
__outbu„nd
;

154 
__Êags
;

158 
__övoˇti⁄_cou¡î
;

162 
__öã∫Æ_u£
;

164 
__mb°©e_t
 *
__°©ï
;

165 
__mb°©e_t
 
__°©e
;

169 
__gc⁄v_å™s_d©a
 *
__å™s
;

174 
	s__gc⁄v_öfo


176 
size_t
 
__n°ïs
;

177 
__gc⁄v_°ï
 *
__°ïs
;

178 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

179 } *
	t__gc⁄v_t
;

	@/usr/include/wchar.h

24 #i‚de‡
_WCHAR_H


26 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<„©uªs.h
>

31 #ifde‡
_WCHAR_H


33 
	#__√ed___FILE


	)

34 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


35 
	#__√ed_FILE


	)

37 
	~<°dio.h
>

39 
	#__√ed___va_li°


	)

40 
	~<°d¨g.h
>

42 
	~<bôs/wch¨.h
>

45 
	#__√ed_size_t


	)

46 
	#__√ed_wch¨_t


	)

47 
	#__√ed_NULL


	)

49 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


50 #unde‡
__√ed_wöt_t


51 
	#__√ed_wöt_t


	)

52 
	~<°ddef.h
>

56 #i‚de‡
_WINT_T


61 
	#_WINT_T


	)

62 
	twöt_t
;

66 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

67 && 
deföed
 
__WINT_TYPE__


68 
__BEGIN_NAMESPACE_STD


69 
__WINT_TYPE__
 
	twöt_t
;

70 
	g__END_NAMESPACE_STD


75 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

76 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

80 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
__mb°©e_t_deföed


81 
	#__mb°©e_t_deföed
 1

	)

85 
	m__cou¡
;

88 #ifde‡
__WINT_TYPE__


89 
__WINT_TYPE__
 
	m__wch
;

91 
wöt_t
 
	m__wch
;

93 
	m__wchb
[4];

94 } 
	m__vÆue
;

95 } 
	t__mb°©e_t
;

97 #unde‡
__√ed_mb°©e_t


102 #ifde‡
_WCHAR_H


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 #ifde‡
__USE_GNU


109 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

112 #i‚de‡
WCHAR_MIN


114 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

115 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

118 #i‚de‡
WEOF


119 
	#WEOF
 (0xffffffffu)

	)

124 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


125 
	~<w˘y≥.h
>

129 
__BEGIN_DECLS


131 
__BEGIN_NAMESPACE_STD


134 
tm
;

135 
__END_NAMESPACE_STD


139 
	$__USING_NAMESPACE_STD
(
tm
)

142 
__BEGIN_NAMESPACE_STD


144 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

147 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

149 
__THROW
;

152 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

153 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

155 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

157 
__THROW
;

160 
	$wcscmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
)

161 
__THROW
 
__©åibuã_puª__
;

163 
	$wc¢cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

164 
__THROW
 
__©åibuã_puª__
;

165 
__END_NAMESPACE_STD


167 #ifde‡
__USE_XOPEN2K8


169 
	$wcsˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

172 
	$wc¢ˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

173 
size_t
 
__n
Ë
__THROW
;

177 
	~<xloˇÀ.h
>

179 
	$wcsˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

180 
__loˇÀ_t
 
__loc
Ë
__THROW
;

182 
	$wc¢ˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

183 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

186 
__BEGIN_NAMESPACE_STD


189 
	$wcscﬁl
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

193 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

194 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

195 
__END_NAMESPACE_STD


197 #ifde‡
__USE_XOPEN2K8


203 
	$wcscﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

204 
__loˇÀ_t
 
__loc
Ë
__THROW
;

209 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
,

210 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

213 
wch¨_t
 *
	$wcsdup
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

216 
__BEGIN_NAMESPACE_STD


218 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


219 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

220 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

221 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

222 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
__©åibuã_puª__
;

228 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


229 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

230 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

231 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

232 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
__©åibuã_puª__
;

237 
__END_NAMESPACE_STD


239 #ifde‡
__USE_GNU


242 
wch¨_t
 *
	$wcsch∫ul
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__wc
)

243 
__THROW
 
__©åibuã_puª__
;

246 
__BEGIN_NAMESPACE_STD


249 
size_t
 
	$wcsc•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ªje˘
)

250 
__THROW
 
__©åibuã_puª__
;

253 
size_t
 
	$wcs•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

254 
__THROW
 
__©åibuã_puª__
;

256 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


257 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, 
__c⁄°
 wch¨_à*
__ac˚±
)

258 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

259 "C++" 
__c⁄°
 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
,

260 
__c⁄°
 
wch¨_t
 *
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

263 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

264 
__THROW
 
__©åibuã_puª__
;

267 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


268 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

269 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

270 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

271 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

274 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

275 
__THROW
 
__©åibuã_puª__
;

279 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

280 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

281 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

284 
size_t
 
	$wc¶í
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

285 
__END_NAMESPACE_STD


287 #ifde‡
__USE_XOPEN


289 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


290 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, 
__c⁄°
 wch¨_à*
__√edÀ
)

291 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

292 "C++" 
__c⁄°
 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
,

293 
__c⁄°
 
wch¨_t
 *
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

296 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

297 
__THROW
 
__©åibuã_puª__
;

301 #ifde‡
__USE_XOPEN2K8


303 
size_t
 
	$wc¢Àn
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

304 
__THROW
 
__©åibuã_puª__
;

308 
__BEGIN_NAMESPACE_STD


310 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


311 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

312 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

313 "C++" 
__c⁄°
 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
,

314 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

317 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

318 
__THROW
 
__©åibuã_puª__
;

322 
	$wmemcmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

323 
__THROW
 
__©åibuã_puª__
;

326 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

327 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

331 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
, 
size_t
 
__n
)

332 
__THROW
;

335 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

336 
__END_NAMESPACE_STD


338 #ifde‡
__USE_GNU


341 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

342 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

343 
__THROW
;

347 
__BEGIN_NAMESPACE_STD


350 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

354 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

358 
	$mbsöô
 (
__c⁄°
 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

362 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

363 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

364 
mb°©e_t
 *
__p
Ë
__THROW
;

367 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

368 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

371 
size_t
 
	$__mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

372 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

373 
size_t
 
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

374 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

375 
__END_NAMESPACE_STD


377 #ifde‡
__USE_EXTERN_INLINES


383 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

384 
__exã∫_ölöe
 
wöt_t


385 
	`__NTH
 (
	$btowc
 (
__c
))

386 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

387 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

389 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

390 
__exã∫_ölöe
 

391 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

392 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

393 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

395 
__exã∫_ölöe
 
size_t


396 
__NTH
 (
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

397 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

398 {  (
__ps
 !
NULL


399 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

402 
__BEGIN_NAMESPACE_STD


405 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

406 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

407 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

411 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

412 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

413 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
__END_NAMESPACE_STD


417 #ifdef 
__USE_XOPEN2K8


420 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

421 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

422 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

426 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

427 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

428 
size_t
 
__nwc
, size_à
__Àn
,

429 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

434 #ifde‡
__USE_XOPEN


436 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

440 
	$wcswidth
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

444 
__BEGIN_NAMESPACE_STD


447 
	$wc°od
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

448 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

449 
__END_NAMESPACE_STD


451 #ifde‡
__USE_ISOC99


452 
__BEGIN_NAMESPACE_C99


454 
	$wc°of
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

455 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

456 
	$wc°ﬁd
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

457 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

458 
__END_NAMESPACE_C99


462 
__BEGIN_NAMESPACE_STD


465 
	$wc°ﬁ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

466 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

470 
	$wc°oul
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

471 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

472 
__THROW
;

473 
__END_NAMESPACE_STD


475 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

476 
__BEGIN_NAMESPACE_C99


479 
__exãnsi⁄__


480 
	$wc°ﬁl
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

481 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

482 
__THROW
;

486 
__exãnsi⁄__


487 
	$wc°ouŒ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

488 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

489 
__ba£
Ë
__THROW
;

490 
__END_NAMESPACE_C99


493 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


496 
__exãnsi⁄__


497 
	$wc°oq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

498 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

499 
__THROW
;

503 
__exãnsi⁄__


504 
	$wc°ouq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

505 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

506 
__ba£
Ë
__THROW
;

509 #ifde‡
__USE_GNU


523 
	~<xloˇÀ.h
>

527 
	$wc°ﬁ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

528 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

529 
__loˇÀ_t
 
__loc
Ë
__THROW
;

531 
	$wc°oul_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

532 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

533 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

535 
__exãnsi⁄__


536 
	$wc°ﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

537 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

538 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

540 
__exãnsi⁄__


541 
	$wc°ouŒ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

542 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

543 
__ba£
, 
__loˇÀ_t
 
__loc
)

544 
__THROW
;

546 
	$wc°od_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

547 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

548 
__THROW
;

550 
	$wc°of_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

551 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

552 
__THROW
;

554 
	$wc°ﬁd_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

555 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

556 
__loˇÀ_t
 
__loc
Ë
__THROW
;

560 #ifde‡
__USE_XOPEN2K8


563 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

564 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

568 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

569 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

570 
__THROW
;

577 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

580 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


581 
__BEGIN_NAMESPACE_STD


584 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

591 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

592 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

598 
	`w¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

602 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

603 
__THROW
 ;

609 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

610 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

611 
__gnuc_va_li°
 
__¨g
)

617 
	`vw¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

618 
__gnuc_va_li°
 
__¨g
)

622 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

623 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

624 
__gnuc_va_li°
 
__¨g
)

625 
__THROW
 ;

632 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

633 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

639 
	`wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	$swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

643 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

644 
__THROW
 ;

646 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

647 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

648 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

649 #ifde‡
__REDIRECT


653 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

654 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

655 
__isoc99_fwsˇnf
)

657 
	`__REDIRECT
 (
wsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_wsˇnf
)

660 
	`__REDIRECT_NTH
 (
swsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

661 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

662 ...), 
__isoc99_swsˇnf
)

665 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

666 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

667 
	`__isoc99_wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

668 
	$__isoc99_swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

669 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

670 
__THROW
;

671 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

672 
	#wsˇnf
 
__isoc99_wsˇnf


	)

673 
	#swsˇnf
 
__isoc99_swsˇnf


	)

677 
__END_NAMESPACE_STD


680 #ifde‡
__USE_ISOC99


681 
__BEGIN_NAMESPACE_C99


686 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

687 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

688 
__gnuc_va_li°
 
__¨g
)

694 
	`vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

695 
__gnuc_va_li°
 
__¨g
)

698 
	$vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

699 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

700 
__gnuc_va_li°
 
__¨g
)

701 
__THROW
 ;

703 #i‡!
deföed
 
__USE_GNU
 \

704 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

705 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

706 #ifde‡
__REDIRECT


707 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

708 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

709 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

711 
	`__REDIRECT
 (
vwsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

714 
	`__REDIRECT_NTH
 (
vswsˇnf
, (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

715 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

716 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

719 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

720 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

721 
__gnuc_va_li°
 
__¨g
);

722 
	`__isoc99_vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

723 
__gnuc_va_li°
 
__¨g
);

724 
	$__isoc99_vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

725 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

727 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

728 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

729 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

733 
__END_NAMESPACE_C99


737 
__BEGIN_NAMESPACE_STD


742 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

743 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

749 
wöt_t
 
	`gëwch¨
 ();

756 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

757 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

763 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

771 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

772 
__FILE
 *
__ª°ri˘
 
__°ªam
);

778 
	`Âutws
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

779 
__FILE
 *
__ª°ri˘
 
__°ªam
);

786 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

787 
__END_NAMESPACE_STD


790 #ifde‡
__USE_GNU


798 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

799 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

807 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

815 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

824 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

825 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

834 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

835 
__FILE
 *
__ª°ri˘
 
__°ªam
);

843 
	`Âutws_u∆ocked
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

844 
__FILE
 *
__ª°ri˘
 
__°ªam
);

848 
__BEGIN_NAMESPACE_C99


852 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

853 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

854 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

855 
__END_NAMESPACE_C99


857 #ifde‡
__USE_GNU


858 
	~<xloˇÀ.h
>

862 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

863 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

864 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

865 
__loˇÀ_t
 
__loc
Ë
__THROW
;

874 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


875 
	#__√ed_iswxxx


	)

876 
	~<w˘y≥.h
>

880 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


881 
	~<bôs/wch¨2.h
>

884 #ifde‡
__LDBL_COMPAT


885 
	~<bôs/wch¨-ldbl.h
>

888 
__END_DECLS


896 #unde‡
__√ed_mb°©e_t


897 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

24 #i‚de‡
_WCTYPE_H


26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 #i‚de‡
__√ed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__√ed_wöt_t


	)

34 
	~<wch¨.h
>

38 #i‚de‡
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #unde‡
__√ed_iswxxx


47 #i‚de‡
__iswxxx_deföed


48 
	#__iswxxx_deföed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	tw˘y≥_t
;

54 
	g__END_NAMESPACE_C99


56 #i‚de‡
_ISwbô


61 
	~<ídün.h
>

62 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


63 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

65 
	#_ISwbô
(
bô
) \

66 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

74 
	m__ISwuµî
 = 0,

75 
	m__ISwlowî
 = 1,

76 
	m__ISwÆpha
 = 2,

77 
	m__ISwdigô
 = 3,

78 
	m__ISwxdigô
 = 4,

79 
	m__ISw•a˚
 = 5,

80 
	m__ISw¥öt
 = 6,

81 
	m__ISwgøph
 = 7,

82 
	m__ISwbœnk
 = 8,

83 
	m__ISw˙ål
 = 9,

84 
	m__ISwpun˘
 = 10,

85 
	m__ISwÆnum
 = 11,

87 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

88 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

89 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

90 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

91 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

92 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

93 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

94 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

95 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

96 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

97 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

98 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

118 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

121 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

125 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

129 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

134 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

137 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

142 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

147 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

152 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

157 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

162 #ifde‡
__USE_ISOC99


163 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

172 
w˘y≥_t
 
	$w˘y≥
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

176 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__c⁄°
 
	t__öt32_t
 *
	tw˘øns_t
;

188 
__END_NAMESPACE_C99


189 #ifde‡
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifde‡
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
w˘øns_t
 
	$w˘øns
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

222 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifde‡
__USE_XOPEN2K8


227 
	~<xloˇÀ.h
>

231 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

237 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

240 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

244 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

248 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

253 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

256 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

261 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

266 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

271 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

276 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

281 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

285 
w˘y≥_t
 
	$w˘y≥_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

286 
__THROW
;

290 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

291 
__THROW
;

299 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

302 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

306 
w˘øns_t
 
	$w˘øns_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

307 
__THROW
;

310 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

311 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

315 
__END_DECLS


	@
1
.
1
/usr/include
455
13276
src/MMEprocess.c
src/UEprocess.c
src/api/mme/mme_api.c
src/api/mme/mme_api.h
src/api/network/as_message.c
src/api/network/l2_message.h
src/api/network/nas_message.c
src/api/network/nas_message.h
src/api/network/network_api.c
src/api/network/network_api.h
src/api/user/at_command.c
src/api/user/at_command.h
src/api/user/at_error.c
src/api/user/at_error.h
src/api/user/at_response.c
src/api/user/at_response.h
src/api/user/tst/at_parser.c
src/api/user/user_api.c
src/api/user/user_api.h
src/api/user/user_indication.c
src/api/user/user_indication.h
src/api/usim/aka_functions.c
src/api/usim/aka_functions.h
src/api/usim/usim_api.c
src/api/usim/usim_api.h
src/emm/Attach.c
src/emm/Authentication.c
src/emm/Detach.c
src/emm/EmmCommon.c
src/emm/EmmCommon.h
src/emm/EmmStatusHdl.c
src/emm/Identification.c
src/emm/IdleMode.c
src/emm/IdleMode.h
src/emm/LowerLayer.c
src/emm/LowerLayer.h
src/emm/SecurityModeControl.c
src/emm/ServiceRequestHdl.c
src/emm/TrackingAreaUpdate.c
src/emm/emmData.h
src/emm/emm_data_ctx.c
src/emm/emm_main.c
src/emm/emm_main.h
src/emm/emm_proc.h
src/emm/msg/AttachAccept.c
src/emm/msg/AttachAccept.h
src/emm/msg/AttachComplete.c
src/emm/msg/AttachComplete.h
src/emm/msg/AttachReject.c
src/emm/msg/AttachReject.h
src/emm/msg/AttachRequest.c
src/emm/msg/AttachRequest.h
src/emm/msg/AuthenticationFailure.c
src/emm/msg/AuthenticationFailure.h
src/emm/msg/AuthenticationReject.c
src/emm/msg/AuthenticationReject.h
src/emm/msg/AuthenticationRequest.c
src/emm/msg/AuthenticationRequest.h
src/emm/msg/AuthenticationResponse.c
src/emm/msg/AuthenticationResponse.h
src/emm/msg/CsServiceNotification.c
src/emm/msg/CsServiceNotification.h
src/emm/msg/DetachAccept.c
src/emm/msg/DetachAccept.h
src/emm/msg/DetachRequest.c
src/emm/msg/DetachRequest.h
src/emm/msg/DownlinkNasTransport.c
src/emm/msg/DownlinkNasTransport.h
src/emm/msg/EmmInformation.c
src/emm/msg/EmmInformation.h
src/emm/msg/EmmStatus.c
src/emm/msg/EmmStatus.h
src/emm/msg/ExtendedServiceRequest.c
src/emm/msg/ExtendedServiceRequest.h
src/emm/msg/GutiReallocationCommand.c
src/emm/msg/GutiReallocationCommand.h
src/emm/msg/GutiReallocationComplete.c
src/emm/msg/GutiReallocationComplete.h
src/emm/msg/IdentityRequest.c
src/emm/msg/IdentityRequest.h
src/emm/msg/IdentityResponse.c
src/emm/msg/IdentityResponse.h
src/emm/msg/NASSecurityModeCommand.h
src/emm/msg/NASSecurityModeComplete.h
src/emm/msg/SecurityModeCommand.c
src/emm/msg/SecurityModeComplete.c
src/emm/msg/SecurityModeReject.c
src/emm/msg/SecurityModeReject.h
src/emm/msg/ServiceReject.c
src/emm/msg/ServiceReject.h
src/emm/msg/ServiceRequest.c
src/emm/msg/ServiceRequest.h
src/emm/msg/TrackingAreaUpdateAccept.c
src/emm/msg/TrackingAreaUpdateAccept.h
src/emm/msg/TrackingAreaUpdateComplete.c
src/emm/msg/TrackingAreaUpdateComplete.h
src/emm/msg/TrackingAreaUpdateReject.c
src/emm/msg/TrackingAreaUpdateReject.h
src/emm/msg/TrackingAreaUpdateRequest.c
src/emm/msg/TrackingAreaUpdateRequest.h
src/emm/msg/UplinkNasTransport.c
src/emm/msg/UplinkNasTransport.h
src/emm/msg/emm_cause.h
src/emm/msg/emm_msg.c
src/emm/msg/emm_msg.h
src/emm/msg/emm_msgDef.h
src/emm/sap/EmmCommonProcedureInitiated.c
src/emm/sap/EmmDeregistered.c
src/emm/sap/EmmDeregisteredAttachNeeded.c
src/emm/sap/EmmDeregisteredAttemptingToAttach.c
src/emm/sap/EmmDeregisteredInitiated.c
src/emm/sap/EmmDeregisteredLimitedService.c
src/emm/sap/EmmDeregisteredNoCellAvailable.c
src/emm/sap/EmmDeregisteredNoImsi.c
src/emm/sap/EmmDeregisteredNormalService.c
src/emm/sap/EmmDeregisteredPlmnSearch.c
src/emm/sap/EmmNull.c
src/emm/sap/EmmRegistered.c
src/emm/sap/EmmRegisteredAttemptingToUpdate.c
src/emm/sap/EmmRegisteredImsiDetachInitiated.c
src/emm/sap/EmmRegisteredInitiated.c
src/emm/sap/EmmRegisteredLimitedService.c
src/emm/sap/EmmRegisteredNoCellAvailable.c
src/emm/sap/EmmRegisteredNormalService.c
src/emm/sap/EmmRegisteredPlmnSearch.c
src/emm/sap/EmmRegisteredUpdateNeeded.c
src/emm/sap/EmmServiceRequestInitiated.c
src/emm/sap/EmmTrackingAreaUpdatingInitiated.c
src/emm/sap/emm_as.c
src/emm/sap/emm_as.h
src/emm/sap/emm_asDef.h
src/emm/sap/emm_cn.c
src/emm/sap/emm_cn.h
src/emm/sap/emm_cnDef.h
src/emm/sap/emm_esm.c
src/emm/sap/emm_esm.h
src/emm/sap/emm_esmDef.h
src/emm/sap/emm_fsm.c
src/emm/sap/emm_fsm.h
src/emm/sap/emm_recv.c
src/emm/sap/emm_recv.h
src/emm/sap/emm_reg.c
src/emm/sap/emm_reg.h
src/emm/sap/emm_regDef.h
src/emm/sap/emm_sap.c
src/emm/sap/emm_sap.h
src/emm/sap/emm_send.c
src/emm/sap/emm_send.h
src/esm/DedicatedEpsBearerContextActivation.c
src/esm/DefaultEpsBearerContextActivation.c
src/esm/EpsBearerContextDeactivation.c
src/esm/EsmStatusHdl.c
src/esm/PdnConnectivity.c
src/esm/PdnDisconnect.c
src/esm/esmData.h
src/esm/esm_ebr.c
src/esm/esm_ebr.h
src/esm/esm_ebr_context.c
src/esm/esm_ebr_context.h
src/esm/esm_ip.c
src/esm/esm_main.c
src/esm/esm_main.h
src/esm/esm_proc.h
src/esm/esm_pt.c
src/esm/esm_pt.h
src/esm/msg/ActivateDedicatedEpsBearerContextAccept.c
src/esm/msg/ActivateDedicatedEpsBearerContextAccept.h
src/esm/msg/ActivateDedicatedEpsBearerContextReject.c
src/esm/msg/ActivateDedicatedEpsBearerContextReject.h
src/esm/msg/ActivateDedicatedEpsBearerContextRequest.c
src/esm/msg/ActivateDedicatedEpsBearerContextRequest.h
src/esm/msg/ActivateDefaultEpsBearerContextAccept.c
src/esm/msg/ActivateDefaultEpsBearerContextAccept.h
src/esm/msg/ActivateDefaultEpsBearerContextReject.c
src/esm/msg/ActivateDefaultEpsBearerContextReject.h
src/esm/msg/ActivateDefaultEpsBearerContextRequest.c
src/esm/msg/ActivateDefaultEpsBearerContextRequest.h
src/esm/msg/BearerResourceAllocationReject.c
src/esm/msg/BearerResourceAllocationReject.h
src/esm/msg/BearerResourceAllocationRequest.c
src/esm/msg/BearerResourceAllocationRequest.h
src/esm/msg/BearerResourceModificationReject.c
src/esm/msg/BearerResourceModificationReject.h
src/esm/msg/BearerResourceModificationRequest.c
src/esm/msg/BearerResourceModificationRequest.h
src/esm/msg/DeactivateEpsBearerContextAccept.c
src/esm/msg/DeactivateEpsBearerContextAccept.h
src/esm/msg/DeactivateEpsBearerContextRequest.c
src/esm/msg/DeactivateEpsBearerContextRequest.h
src/esm/msg/EsmInformationRequest.c
src/esm/msg/EsmInformationRequest.h
src/esm/msg/EsmInformationResponse.c
src/esm/msg/EsmInformationResponse.h
src/esm/msg/EsmStatus.c
src/esm/msg/EsmStatus.h
src/esm/msg/ModifyEpsBearerContextAccept.c
src/esm/msg/ModifyEpsBearerContextAccept.h
src/esm/msg/ModifyEpsBearerContextReject.c
src/esm/msg/ModifyEpsBearerContextReject.h
src/esm/msg/ModifyEpsBearerContextRequest.c
src/esm/msg/ModifyEpsBearerContextRequest.h
src/esm/msg/PdnConnectivityReject.c
src/esm/msg/PdnConnectivityReject.h
src/esm/msg/PdnConnectivityRequest.c
src/esm/msg/PdnConnectivityRequest.h
src/esm/msg/PdnDisconnectReject.c
src/esm/msg/PdnDisconnectReject.h
src/esm/msg/PdnDisconnectRequest.c
src/esm/msg/PdnDisconnectRequest.h
src/esm/msg/esm_cause.h
src/esm/msg/esm_msg.c
src/esm/msg/esm_msg.h
src/esm/msg/esm_msgDef.h
src/esm/sap/esm_recv.c
src/esm/sap/esm_recv.h
src/esm/sap/esm_sap.c
src/esm/sap/esm_sap.h
src/esm/sap/esm_sapDef.h
src/esm/sap/esm_send.c
src/esm/sap/esm_send.h
src/ies/AccessPointName.c
src/ies/AccessPointName.h
src/ies/AdditionalUpdateResult.c
src/ies/AdditionalUpdateResult.h
src/ies/AdditionalUpdateType.c
src/ies/AdditionalUpdateType.h
src/ies/ApnAggregateMaximumBitRate.c
src/ies/ApnAggregateMaximumBitRate.h
src/ies/AuthenticationFailureParameter.c
src/ies/AuthenticationFailureParameter.h
src/ies/AuthenticationParameterAutn.c
src/ies/AuthenticationParameterAutn.h
src/ies/AuthenticationParameterRand.c
src/ies/AuthenticationParameterRand.h
src/ies/AuthenticationResponseParameter.c
src/ies/AuthenticationResponseParameter.h
src/ies/CipheringKeySequenceNumber.c
src/ies/CipheringKeySequenceNumber.h
src/ies/Cli.c
src/ies/Cli.h
src/ies/CsfbResponse.c
src/ies/CsfbResponse.h
src/ies/DaylightSavingTime.c
src/ies/DaylightSavingTime.h
src/ies/DetachType.c
src/ies/DetachType.h
src/ies/DrxParameter.c
src/ies/DrxParameter.h
src/ies/EmergencyNumberList.c
src/ies/EmergencyNumberList.h
src/ies/EmmCause.c
src/ies/EmmCause.h
src/ies/EpsAttachResult.c
src/ies/EpsAttachResult.h
src/ies/EpsAttachType.c
src/ies/EpsAttachType.h
src/ies/EpsBearerContextStatus.c
src/ies/EpsBearerContextStatus.h
src/ies/EpsBearerIdentity.c
src/ies/EpsBearerIdentity.h
src/ies/EpsMobileIdentity.c
src/ies/EpsMobileIdentity.h
src/ies/EpsNetworkFeatureSupport.c
src/ies/EpsNetworkFeatureSupport.h
src/ies/EpsQualityOfService.c
src/ies/EpsQualityOfService.h
src/ies/EpsUpdateResult.c
src/ies/EpsUpdateResult.h
src/ies/EpsUpdateType.c
src/ies/EpsUpdateType.h
src/ies/EsmCause.c
src/ies/EsmCause.h
src/ies/EsmInformationTransferFlag.c
src/ies/EsmInformationTransferFlag.h
src/ies/EsmMessageContainer.c
src/ies/EsmMessageContainer.h
src/ies/GprsTimer.c
src/ies/GprsTimer.h
src/ies/GutiType.c
src/ies/GutiType.h
src/ies/IdentityType2.c
src/ies/IdentityType2.h
src/ies/ImeisvRequest.c
src/ies/ImeisvRequest.h
src/ies/KsiAndSequenceNumber.c
src/ies/KsiAndSequenceNumber.h
src/ies/LcsClientIdentity.c
src/ies/LcsClientIdentity.h
src/ies/LcsIndicator.c
src/ies/LcsIndicator.h
src/ies/LinkedEpsBearerIdentity.c
src/ies/LinkedEpsBearerIdentity.h
src/ies/LlcServiceAccessPointIdentifier.c
src/ies/LlcServiceAccessPointIdentifier.h
src/ies/LocationAreaIdentification.c
src/ies/LocationAreaIdentification.h
src/ies/MessageType.c
src/ies/MessageType.h
src/ies/MobileIdentity.c
src/ies/MobileIdentity.h
src/ies/MobileStationClassmark2.c
src/ies/MobileStationClassmark2.h
src/ies/MobileStationClassmark3.c
src/ies/MobileStationClassmark3.h
src/ies/MsNetworkCapability.c
src/ies/MsNetworkCapability.h
src/ies/NasKeySetIdentifier.c
src/ies/NasKeySetIdentifier.h
src/ies/NasMessageContainer.c
src/ies/NasMessageContainer.h
src/ies/NasRequestType.c
src/ies/NasRequestType.h
src/ies/NasSecurityAlgorithms.c
src/ies/NasSecurityAlgorithms.h
src/ies/NetworkName.c
src/ies/NetworkName.h
src/ies/Nonce.c
src/ies/Nonce.h
src/ies/PTmsiSignature.c
src/ies/PTmsiSignature.h
src/ies/PacketFlowIdentifier.c
src/ies/PacketFlowIdentifier.h
src/ies/PagingIdentity.c
src/ies/PagingIdentity.h
src/ies/PdnAddress.c
src/ies/PdnAddress.h
src/ies/PdnType.c
src/ies/PdnType.h
src/ies/PlmnList.c
src/ies/PlmnList.h
src/ies/ProcedureTransactionIdentity.c
src/ies/ProcedureTransactionIdentity.h
src/ies/ProtocolConfigurationOptions.c
src/ies/ProtocolConfigurationOptions.h
src/ies/ProtocolDiscriminator.c
src/ies/ProtocolDiscriminator.h
src/ies/QualityOfService.c
src/ies/QualityOfService.h
src/ies/RadioPriority.c
src/ies/RadioPriority.h
src/ies/SecurityHeaderType.c
src/ies/SecurityHeaderType.h
src/ies/ServiceType.c
src/ies/ServiceType.h
src/ies/ShortMac.c
src/ies/ShortMac.h
src/ies/SsCode.c
src/ies/SsCode.h
src/ies/SupportedCodecList.c
src/ies/SupportedCodecList.h
src/ies/TimeZone.c
src/ies/TimeZone.h
src/ies/TimeZoneAndTime.c
src/ies/TimeZoneAndTime.h
src/ies/TmsiStatus.c
src/ies/TmsiStatus.h
src/ies/TrackingAreaIdentity.c
src/ies/TrackingAreaIdentity.h
src/ies/TrackingAreaIdentityList.c
src/ies/TrackingAreaIdentityList.h
src/ies/TrafficFlowAggregateDescription.c
src/ies/TrafficFlowAggregateDescription.h
src/ies/TrafficFlowTemplate.c
src/ies/TrafficFlowTemplate.h
src/ies/TransactionIdentifier.c
src/ies/TransactionIdentifier.h
src/ies/UeNetworkCapability.c
src/ies/UeNetworkCapability.h
src/ies/UeRadioCapabilityInformationUpdateNeeded.c
src/ies/UeRadioCapabilityInformationUpdateNeeded.h
src/ies/UeSecurityCapability.c
src/ies/UeSecurityCapability.h
src/ies/VoiceDomainPreferenceAndUeUsageSetting.c
src/ies/VoiceDomainPreferenceAndUeUsageSetting.h
src/include/securityDef.h
src/include/userDef.h
src/nas_network.c
src/nas_network.h
src/nas_parser.c
src/nas_parser.h
src/nas_proc.c
src/nas_proc.h
src/nas_user.c
src/nas_user.h
src/util/OctetString.c
src/util/OctetString.h
src/util/TLVDecoder.c
src/util/TLVDecoder.h
src/util/TLVEncoder.c
src/util/TLVEncoder.h
src/util/device.c
src/util/device.h
src/util/memory.c
src/util/memory.h
src/util/nas_log.c
src/util/nas_log.h
src/util/nas_timer.c
src/util/nas_timer.h
src/util/parser.c
src/util/parser.h
src/util/socket.c
src/util/socket.h
src/util/stty.c
src/util/tst/timer.c
tools/network.h
tools/ue_data.c
tools/usim_data.c
tst/as_simulator/as_data.c
tst/as_simulator/as_data.h
tst/as_simulator/as_process.c
tst/as_simulator/as_process.h
tst/as_simulator/as_simulator.c
tst/as_simulator/as_simulator_parser.c
tst/as_simulator/as_simulator_parser.h
tst/as_simulator/nas_data.c
tst/as_simulator/nas_data.h
tst/as_simulator/nas_process.c
tst/as_simulator/nas_process.h
tst/network/network_parser.c
tst/network/network_parser.h
tst/network/network_simulator.c
tst/user/user_parser.c
tst/user/user_parser.h
tst/user/user_simulator.c
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/inttypes.h
/usr/include/memory.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/poll.h
/usr/include/pthread.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/rpc/netdb.h
/usr/include/sched.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
